public class ImportManager {
  public ImportManager(  ImportLogDao pImportLogDao){
    super();
    importLogDao=pImportLogDao;
  }
  private ImportLogDao importLogDao=null;
  public void startImportProcess(  int importType,  Date date){
    ImportLogBean importLogBean=null;
    try {
      importLogBean=createResume(importType,date);
      if (isOkToImport(importType,date)) {
        importLogBean.setStatus(2);
      }
 else {
        importLogBean.setStatus(9);
      }
    }
 catch (    Exception e) {
      if (importLogBean != null)       importLogBean.setStatus(9);
    }
 finally {
      if (importLogBean != null)       finalizeResume(importLogBean);
    }
  }
  private boolean isOkToImport(  int importType,  Date date){
    return importLogDao.anyImportRunningOrRunnedToday(importType,date);
  }
  private ImportLogBean createResume(  int importType,  Date date){
    ImportLogBean importLogBean=new ImportLogBean(date,importType);
    importLogBean.setStatus(1);
    importLogDao.include(importLogBean);
    return importLogBean;
  }
  private void finalizeResume(  ImportLogBean importLogBean){
    importLogDao.alter(importLogBean);
  }
}
