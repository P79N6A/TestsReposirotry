public class OneLinerStubStressTest {
public class OneLinerStubTestClass {
    public String getStuff(){
      return "A";
    }
  }
  private static String generateLargeString(){
    final int length=2000000;
    final StringBuilder stringBuilder=new StringBuilder(length);
    for (int i=0; i <= length; i++) {
      stringBuilder.append("B");
    }
    return stringBuilder.toString();
  }
  @Test public void call_a_lot_of_mocks_using_one_line_stubbing(){
    final String returnValue=generateLargeString();
    for (int i=0; i < 50000; i++) {
      final OneLinerStubTestClass mock=when(mock(OneLinerStubTestClass.class).getStuff()).thenReturn(returnValue).getMock();
      assertEquals(returnValue,mock.getStuff());
    }
  }
}
