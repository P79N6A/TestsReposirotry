/** 
 * @version 
 */
public class JmsPollEnrichTest extends CamelTestSupport {
  @Test public void testPollEnrichJms() throws Exception {
    template.sendBody("jms:queue:foo","Bye World");
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedBodiesReceived("Bye World");
    template.sendBody("direct:start","Hello World");
    assertMockEndpointsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure(){
        from("direct:start").pollEnrich("jms:queue:foo",5000).to("mock:result");
      }
    }
;
  }
  @Override protected Context createJndiContext() throws Exception {
    deleteDirectory("activemq-data");
    JndiContext answer=new JndiContext();
    ConnectionFactory connectionFactory=CamelJmsTestHelper.createPersistentConnectionFactory();
    JmsComponent amq=jmsComponentAutoAcknowledge(connectionFactory);
    amq.setCamelContext(context);
    answer.bind("jms",amq);
    return answer;
  }
}
