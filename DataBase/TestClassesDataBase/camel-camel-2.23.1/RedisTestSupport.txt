@RunWith(MockitoJUnitRunner.class) public class RedisTestSupport extends CamelTestSupport {
  @Mock protected RedisTemplate<String,String> redisTemplate;
  @Produce(uri="direct:start") protected ProducerTemplate template;
  @Override protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      public void configure(){
        from("direct:start").to("spring-redis://localhost:6379?redisTemplate=#redisTemplate");
      }
    }
;
  }
  protected Object sendHeaders(  final Object... headers){
    Exchange exchange=template.send(new Processor(){
      public void process(      Exchange exchange) throws Exception {
        Message in=exchange.getIn();
        for (int i=0; i < headers.length; i=i + 2) {
          in.setHeader(headers[i].toString(),headers[i + 1]);
        }
      }
    }
);
    return exchange.getIn().getBody();
  }
}
