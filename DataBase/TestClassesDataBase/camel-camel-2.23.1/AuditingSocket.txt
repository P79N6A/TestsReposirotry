/** 
 * {@link Socket} which counts connect()/close() invocations
 */
private class AuditingSocket extends Socket {
  @Override public void connect(  SocketAddress endpoint,  int timeout) throws IOException {
    super.connect(endpoint,timeout);
    boolean[] value=socketAudits.get(System.identityHashCode(this));
    value[0]=true;
  }
  @Override public synchronized void close() throws IOException {
    super.close();
    boolean[] value=socketAudits.get(System.identityHashCode(this));
    value[1]=true;
  }
}
