/** 
 */
public class TimerListenerManagerTest extends ContextTestSupport {
  private final MyTask task=new MyTask();
  @Override public boolean isUseRouteBuilder(){
    return false;
  }
  @Test public void testTimerListenerManager() throws Exception {
    ScheduledExecutorService executor=Executors.newScheduledThreadPool(1);
    TimerListenerManager manager=new TimerListenerManager();
    manager.setCamelContext(context);
    manager.addTimerListener(task);
    manager.start();
    assertTrue("Should be invoked",task.await());
    manager.stop();
    manager.removeTimerListener(task);
    executor.shutdown();
  }
private class MyTask implements TimerListener {
    private CountDownLatch latch=new CountDownLatch(1);
    @Override public void onTimer(){
      latch.countDown();
    }
    public boolean await() throws InterruptedException {
      return latch.await(5,TimeUnit.SECONDS);
    }
  }
}
