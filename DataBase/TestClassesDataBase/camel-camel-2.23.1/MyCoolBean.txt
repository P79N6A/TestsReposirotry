public static class MyCoolBean {
  private int count;
  private ConsumerTemplate consumer;
  private ProducerTemplate producer;
  public void setConsumer(  ConsumerTemplate consumer){
    this.consumer=consumer;
  }
  public void setProducer(  ProducerTemplate producer){
    this.producer=producer;
  }
  public void someBusinessLogic(){
    while (true) {
      String msg=consumer.receiveBody("activemq:queue.in",2000,String.class);
      if (msg == null) {
        break;
      }
      msg="Hello " + msg;
      producer.sendBodyAndHeader("activemq:queue.out",msg,"number",count++);
    }
  }
}
