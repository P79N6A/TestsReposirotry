@RunWith(Arquillian.class) @ImportResource("imported-context.xml") public class XmlServiceExporterTest {
  @Deployment public static Archive<?> deployment(){
    return ShrinkWrap.create(JavaArchive.class).addPackage(CdiCamelExtension.class.getPackage()).addAsResource(Paths.get("src/test/resources/camel-context-export.xml").toFile(),"imported-context.xml").addAsManifestResource(EmptyAsset.INSTANCE,"beans.xml");
  }
  @Test public void sendMessageToService(  ProducerTemplate service){
    String response=service.requestBody("direct:service","request",String.class);
    assertThat("Response is incorrect!",response,is(equalTo("test response to [request]")));
  }
  @Test public void invokeService(  @Named("service") Service service){
    String response=service.service("request");
    assertThat("Response is incorrect!",response,is(equalTo("test response to [request]")));
  }
@Named("implementation") static class TestService implements Service {
    @Override public String service(    String request){
      return "test response to [" + request + "]";
    }
  }
}
