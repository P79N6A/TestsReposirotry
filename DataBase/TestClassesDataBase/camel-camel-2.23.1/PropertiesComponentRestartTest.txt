/** 
 * @version 
 */
public class PropertiesComponentRestartTest extends ContextTestSupport {
  private int resolvedCount;
  @Test public void testPropertiesComponentCacheClearedOnStop() throws Exception {
    context.start();
    context.resolvePropertyPlaceholders("{{cool.end}}");
    context.resolvePropertyPlaceholders("{{cool.end}}");
    context.resolvePropertyPlaceholders("{{cool.end}}");
    assertEquals(1,resolvedCount);
    context.stop();
    context.start();
    context.resolvePropertyPlaceholders("{{cool.end}}");
    context.resolvePropertyPlaceholders("{{cool.end}}");
    context.resolvePropertyPlaceholders("{{cool.end}}");
    assertEquals(2,resolvedCount);
  }
  @Override protected CamelContext createCamelContext() throws Exception {
    final PropertiesComponent pc=new PropertiesComponent("classpath:org/apache/camel/component/properties/myproperties.properties");
    pc.setPropertiesResolver(new PropertiesResolver(){
      public Properties resolveProperties(      CamelContext context,      boolean ignoreMissingLocation,      List<PropertiesLocation> locations) throws Exception {
        resolvedCount++;
        return new DefaultPropertiesResolver(pc).resolveProperties(context,ignoreMissingLocation,locations);
      }
    }
);
    SimpleRegistry registry=new SimpleRegistry();
    registry.put("properties",pc);
    return new DefaultCamelContext(registry);
  }
}
