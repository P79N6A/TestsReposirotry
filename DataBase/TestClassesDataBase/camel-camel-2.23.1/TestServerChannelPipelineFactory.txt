public class TestServerChannelPipelineFactory extends ServerInitializerFactory {
  private int maxLineSize=1024;
  private NettyConsumer consumer;
  public TestServerChannelPipelineFactory(  NettyConsumer consumer){
    this.consumer=consumer;
  }
  protected void initChannel(  Channel ch) throws Exception {
    ChannelPipeline channelPipeline=ch.pipeline();
    serverInvoked=true;
    channelPipeline.addLast("encoder-SD",new StringEncoder(CharsetUtil.UTF_8));
    channelPipeline.addLast("decoder-DELIM",new DelimiterBasedFrameDecoder(maxLineSize,true,Delimiters.lineDelimiter()));
    channelPipeline.addLast("decoder-SD",new StringDecoder(CharsetUtil.UTF_8));
    channelPipeline.addLast("handler",new ServerChannelHandler(consumer));
  }
  @Override public ServerInitializerFactory createPipelineFactory(  NettyConsumer consumer){
    return new TestServerChannelPipelineFactory(consumer);
  }
}
