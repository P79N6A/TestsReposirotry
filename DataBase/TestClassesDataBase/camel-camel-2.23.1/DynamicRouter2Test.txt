/** 
 * @version 
 */
public class DynamicRouter2Test extends ContextTestSupport {
  @Test public void testDynamicRouter() throws Exception {
    getMockEndpoint("mock:a").expectedBodiesReceived("Hello World");
    getMockEndpoint("mock:b").expectedBodiesReceived("Hello World");
    getMockEndpoint("mock:result").expectedBodiesReceived("Hello World");
    template.sendBody("direct:start","Hello World");
    assertMockEndpointsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:start").dynamicRouter().method(DynamicRouter2Test.class,"slip");
      }
    }
;
  }
  /** 
 * Use this method to compute dynamic where we should route next.
 * @param body the message body
 * @param previous the previous slip
 * @return endpoints to go, or <tt>null</tt> to indicate the end
 */
  public String slip(  String body,  @Header(Exchange.SLIP_ENDPOINT) String previous){
    if (previous == null) {
      return "mock:a";
    }
 else     if ("mock://a".equals(previous)) {
      return "mock:b";
    }
 else     if ("mock://b".equals(previous)) {
      return "mock:result";
    }
    return null;
  }
}
