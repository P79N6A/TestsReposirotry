public class SpringXmlRpcDataFormatTest extends CamelSpringTestSupport {
  @Test public void testRequestMessage() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:request");
    mock.expectedMessageCount(1);
    XmlRpcRequest result=template.requestBody("direct:request",new XmlRpcRequestImpl("greet",new Object[]{"you",2}),XmlRpcRequest.class);
    assertNotNull(result);
    assertEquals("Get a wrong request operation name","greet",result.getMethodName());
    assertEquals("Get a wrong request parameter size",2,result.getParameterCount());
    assertEquals("Get a wrong request parameter",2,result.getParameter(1));
    assertMockEndpointsSatisfied();
  }
  @Test public void testResponseMessage() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:response");
    mock.expectedBodiesReceived("GreetMe from XmlRPC");
    template.sendBody("direct:response","GreetMe from XmlRPC");
    assertMockEndpointsSatisfied();
  }
  @Override protected AbstractApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext("org/apache/camel/dataformat/xmlrpc/SpringXmlRpcDataFormatTest.xml");
  }
}
