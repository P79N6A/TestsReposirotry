/** 
 * Order service as a plain POJO class
 */
public static class OrderService {
  /** 
 * This method handle our order input and return the order
 * @param in      the in headers
 * @param payload the in payload
 * @param out     the out headers
 * @return the out payload
 * @throws OrderFailedException is thrown if the order cannot be processed
 */
  public Object handleOrder(  @Headers Map<?,?> in,  @Body String payload,  @OutHeaders Map<String,Object> out) throws OrderFailedException {
    out.put("customerid",in.get("customerid"));
    if ("Order: kaboom".equals(payload)) {
      throw new OrderFailedException("Cannot order: kaboom");
    }
 else {
      out.put("orderid","123");
      return "Order OK";
    }
  }
  /** 
 * This method creates the response to the caller if the order could not be processed
 * @param in      the in headers
 * @param payload the in payload
 * @param out     the out headers
 * @return the out payload
 */
  public Object orderFailed(  @Headers Map<?,?> in,  @Body String payload,  @OutHeaders Map<String,Object> out){
    out.put("customerid",in.get("customerid"));
    out.put("orderid","failed");
    return "Order ERROR";
  }
}
