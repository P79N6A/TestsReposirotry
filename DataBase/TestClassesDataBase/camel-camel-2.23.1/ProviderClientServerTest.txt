public class ProviderClientServerTest extends CamelSpringTestSupport {
  int port;
  @Test public void testClientInvocation() throws Exception {
    Client client=new Client("http://localhost:" + port + "/GreeterContext/SOAPMessageService");
    String response=client.invoke();
    assertEquals("Get a wrong response","Greetings from Apache Camel!!!! Request was  Hello Camel!!",response);
  }
  @Override protected AbstractXmlApplicationContext createApplicationContext(){
    port=AvailablePortFinder.getNextAvailable();
    System.setProperty("port",String.valueOf(port));
    return new ClassPathXmlApplicationContext(new String[]{"/META-INF/spring/CamelCXFProviderRouteConfig.xml"});
  }
}
