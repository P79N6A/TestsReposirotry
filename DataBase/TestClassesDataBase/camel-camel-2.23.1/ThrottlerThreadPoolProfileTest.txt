public class ThrottlerThreadPoolProfileTest extends ContextTestSupport {
  protected boolean canTest(){
    return !isPlatform("windows");
  }
  @Test public void testThreadPool() throws Exception {
    if (!canTest()) {
      return;
    }
    getMockEndpoint("mock:result").expectedMessageCount(2);
    template.sendBody("direct:start","Hello");
    template.sendBody("direct:start","World");
    assertMockEndpointsSatisfied();
  }
  protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      public void configure(){
        ThreadPoolProfile profile=new ThreadPoolProfileBuilder("myPool").poolSize(2).maxPoolSize(5).maxQueueSize(10).build();
        context.getExecutorServiceManager().registerThreadPoolProfile(profile);
        from("direct:start").throttle(constant(2)).executorServiceRef("myPool").to("mock:result");
      }
    }
;
  }
}
