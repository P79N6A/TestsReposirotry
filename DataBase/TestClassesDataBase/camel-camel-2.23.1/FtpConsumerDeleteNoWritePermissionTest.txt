/** 
 * User does not have write permissions so can't deleted consumed file.
 */
public class FtpConsumerDeleteNoWritePermissionTest extends FtpServerTestSupport {
  private String getFtpUrl(){
    return "ftp://dummy@localhost:" + getPort() + "/deletenoperm?password=foo"+ "&delete=true&consumer.delay=5000";
  }
  @Override @Before public void setUp() throws Exception {
    super.setUp();
    prepareFtpServer();
  }
  @Test public void testConsumerDeleteNoWritePermission() throws Exception {
    PollingConsumer consumer=context.getEndpoint(getFtpUrl()).createPollingConsumer();
    consumer.start();
    Exchange out=consumer.receive(3000);
    assertNotNull("Should get the file",out);
    try {
      Thread.sleep(1000);
      consumer.stop();
    }
 catch (    GenericFileOperationFailedException fofe) {
    }
  }
  private void prepareFtpServer() throws Exception {
    String ftpUrl="ftp://admin@localhost:" + getPort() + "/deletenoperm/?password=admin";
    template.sendBodyAndHeader(ftpUrl,"Hello World",Exchange.FILE_NAME,"hello.txt");
  }
}
