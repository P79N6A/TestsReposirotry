/** 
 * XPath with namespace test
 */
public class ExtractXPathWithNamespaceTest extends ContextTestSupport {
  @Test public void testXPathWithNamespace() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedBodiesReceived("<number xmlns=\"http://acme.com/cheese\">55</number>");
    mock.expectedHeaderReceived("foo",55);
    template.sendBody("direct:in","<number xmlns=\"http://acme.com/cheese\">55</number>");
    mock.assertIsSatisfied();
  }
  @Test public void testXPathWithNamespaceOther() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedBodiesReceived("<number xmlns=\"http://acme.com/cheese\">99</number>");
    mock.expectedHeaderReceived("foo",99);
    template.sendBody("direct:in","<number xmlns=\"http://acme.com/cheese\">99</number>");
    mock.assertIsSatisfied();
  }
  @Test public void testXPathWithNamespaceDifferentNamespace() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedBodiesReceived("<number xmlns=\"http://acme.com/cake\">55</number>");
    template.sendBody("direct:in","<number xmlns=\"http://acme.com/cake\">55</number>");
    mock.assertIsSatisfied();
    assertNull(mock.getExchanges().get(0).getIn().getHeader("foo"));
  }
  protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        Namespaces ns=new Namespaces("c","http://acme.com/cheese");
        from("direct:in").setHeader("foo").xpath("/c:number",Integer.class,ns).to("mock:result");
      }
    }
;
  }
}
