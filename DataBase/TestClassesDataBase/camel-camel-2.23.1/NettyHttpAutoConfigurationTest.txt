/** 
 * Testing the servlet mapping
 */
@RunWith(SpringRunner.class) @DirtiesContext @SpringBootApplication @SpringBootTest(properties={"camel.component.netty-http.configuration.compression=true"}) public class NettyHttpAutoConfigurationTest {
  @Autowired private ProducerTemplate producerTemplate;
  @Test public void testEndpoint() throws Exception {
    String result=producerTemplate.requestBody("http://localhost:" + getPort(),null,String.class);
    assertEquals("Hello",result);
  }
  @Test public void testConfigOverride() throws Exception {
    Exchange exchange=producerTemplate.request("http://localhost:" + getPort(),x -> x.getIn().setHeader("Accept-Encoding","gzip"));
    Assert.assertEquals("gzip",exchange.getOut().getHeader("Content-Encoding"));
  }
@Component public static class TestRoutes extends RouteBuilder {
    @Override public void configure() throws Exception {
      from("netty-http:http://localhost:" + getPort()).transform().constant("Hello");
    }
  }
}
