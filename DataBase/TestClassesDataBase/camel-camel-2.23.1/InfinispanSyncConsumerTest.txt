public class InfinispanSyncConsumerTest extends InfinispanTestSupport {
  @EndpointInject(uri="mock:result") private MockEndpoint mockResult;
  @Test public void consumerReceivedPreAndPostEntryCreatedEventNotifications() throws Exception {
    mockResult.expectedMessageCount(2);
    mockResult.setResultMinimumWaitTime(900);
    currentCache().put(KEY_ONE,VALUE_ONE);
    mockResult.assertIsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure(){
        from("infinispan?cacheContainer=#cacheContainer&sync=false&eventTypes=CACHE_ENTRY_CREATED").delayer(500).to("mock:result");
      }
    }
;
  }
}
