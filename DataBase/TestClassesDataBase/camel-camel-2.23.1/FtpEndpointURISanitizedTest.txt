/** 
 * Test to ensure the FtpEndpoint URI is sanitized.
 */
public class FtpEndpointURISanitizedTest extends FtpServerTestSupport {
  private String password="secret";
  protected String getFtpUrl(){
    return "ftp://admin@localhost:" + getPort() + "/////foo?password="+ password+ "&delay=5000";
  }
  @Test public void testFtpDirectoryRelative() throws Exception {
    Endpoint endpoint=context.getEndpoint(getFtpUrl());
    assertThat(((FtpEndpoint<?>)endpoint).getConfiguration().getDirectoryName(),equalTo("foo"));
  }
  @Test public void testFtpConsumerUriSanitized() throws Exception {
    Endpoint endpoint=context.getEndpoint(getFtpUrl());
    Consumer consumer=endpoint.createConsumer(null);
    assertFalse(consumer.toString().contains(password));
  }
  @Test public void testFtpProducerUriSanitized() throws Exception {
    Endpoint endpoint=context.getEndpoint(getFtpUrl());
    Producer producer=endpoint.createProducer();
    assertFalse(producer.toString().contains(password));
  }
}
