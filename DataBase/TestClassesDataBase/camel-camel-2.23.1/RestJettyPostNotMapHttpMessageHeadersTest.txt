public class RestJettyPostNotMapHttpMessageHeadersTest extends BaseJettyTest {
  @Test public void testPostNotMapHttpMessageHeadersTest() throws Exception {
    Map<String,Object> headers=new HashMap<>();
    headers.put(Exchange.HTTP_METHOD,"POST");
    headers.put(Exchange.CONTENT_TYPE,"application/x-www-form-urlencoded");
    String out=template.requestBodyAndHeaders("http://localhost:" + getPort() + "/rest/test","{\"msg\": \"TEST\"}",headers,String.class);
    assertEquals("\"OK\"",out);
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        restConfiguration().component("jetty").host("localhost").port(getPort()).bindingMode(RestBindingMode.json).endpointProperty("mapHttpMessageBody","false").endpointProperty("mapHttpMessageHeaders","false");
        rest("/rest").post("/test").produces("application/json").to("direct:test");
        from("direct:test").log("*** ${body}").removeHeaders("Content-Type*").setBody().simple("OK");
      }
    }
;
  }
}
