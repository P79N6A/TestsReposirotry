/** 
 */
public class SqlResourceTest extends CamelTestSupport {
  @Test public void testSqlResource() throws Exception {
    getMockEndpoint("mock:result").expectedMessageCount(1);
    getMockEndpoint("mock:result").expectedHeaderReceived("foo",123);
    getMockEndpoint("mock:name").expectedBodiesReceived("Hiram");
    template.sendBody("direct:start",createBody());
    assertMockEndpointsSatisfied();
  }
  @SuppressWarnings({"rawtypes"}) private List createBody(){
    List<Person> list=new ArrayList<>();
    list.add(new Person("James","London"));
    list.add(new Person("Guillaume","Normandy"));
    list.add(new Person("Hiram","Tampa"));
    list.add(new Person("Rob","London"));
    return list;
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:start").setHeader("foo",constant(123)).transform().sql("resource:classpath:myjosql.txt").to("mock:result").transform().simple("${body[0][0]}").to("mock:name");
      }
    }
;
  }
}
