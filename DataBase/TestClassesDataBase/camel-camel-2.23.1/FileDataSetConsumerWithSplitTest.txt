/** 
 * @version 
 */
public class FileDataSetConsumerWithSplitTest extends ContextTestSupport {
  protected FileDataSet dataSet;
  final String testDataFileName="src/test/data/file-dataset-test.txt";
  final int testDataFileRecordCount=10;
  final String resultUri="mock://result";
  final String dataSetName="foo";
  final String dataSetUri="dataset://" + dataSetName;
  @Test public void testDefaultListDataSet() throws Exception {
    MockEndpoint result=getMockEndpoint(resultUri);
    result.expectedMinimumMessageCount((int)dataSet.getSize());
    result.assertIsSatisfied();
  }
  @Test public void testDefaultListDataSetWithSizeGreaterThanListSize() throws Exception {
    MockEndpoint result=getMockEndpoint(resultUri);
    dataSet.setSize(20);
    result.expectedMinimumMessageCount((int)dataSet.getSize());
    result.assertIsSatisfied();
  }
  @Override @Before public void setUp() throws Exception {
    dataSet=new FileDataSet(testDataFileName,"\n");
    assertEquals("Unexpected DataSet size",testDataFileRecordCount,dataSet.getSize());
    super.setUp();
  }
  @Override protected Context createJndiContext() throws Exception {
    Context context=super.createJndiContext();
    context.bind(dataSetName,dataSet);
    return context;
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from(dataSetUri).to("mock://result");
      }
    }
;
  }
}
