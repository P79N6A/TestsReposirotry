public class SaxonExtensionFunctionsTest extends CamelTestSupport {
  private static final String XSLT_PATH="org/apache/camel/component/xslt/extensions/extensions.xslt";
  private static final String XSLT_RESULT="<?xml version=\"1.0\" encoding=\"UTF-8\"?><Test1>3</Test1><Test2>abccde</Test2><Test3>xyz</Test3>";
  @Test public void testExtensions(){
    String result=template().requestBody("direct:extensions","<dummy/>",String.class);
    assertNotNull(result);
    assertEquals(XSLT_RESULT,result);
  }
  @Override protected JndiRegistry createRegistry() throws Exception {
    JndiRegistry registry=new JndiRegistry(createJndiContext());
    registry.bind("function1",new MyExtensionFunction1());
    registry.bind("function2",new MyExtensionFunction2());
    return registry;
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:extensions").toF("xslt:%s?saxonExtensionFunctions=#function1,#function2",XSLT_PATH).to("log:org.apache.camel.component.xslt.extensions?level=INFO");
      }
    }
;
  }
}
