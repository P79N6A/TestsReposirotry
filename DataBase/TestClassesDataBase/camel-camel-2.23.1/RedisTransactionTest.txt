@RunWith(MockitoJUnitRunner.class) public class RedisTransactionTest extends RedisTestSupport {
  @Mock private RedisTemplate<String,?> redisTemplate;
  @Override protected JndiRegistry createRegistry() throws Exception {
    JndiRegistry registry=super.createRegistry();
    registry.bind("redisTemplate",redisTemplate);
    return registry;
  }
  @Test public void shouldExecuteMULTI() throws Exception {
    sendHeaders(RedisConstants.COMMAND,"MULTI");
    verify(redisTemplate).multi();
  }
  @Test public void shouldExecuteDISCARD() throws Exception {
    sendHeaders(RedisConstants.COMMAND,"DISCARD");
    verify(redisTemplate).discard();
  }
  @Test public void shouldExecuteEXEC() throws Exception {
    sendHeaders(RedisConstants.COMMAND,"EXEC");
    verify(redisTemplate).exec();
  }
  @Test public void shouldExecuteUNWATCH() throws Exception {
    sendHeaders(RedisConstants.COMMAND,"UNWATCH");
    verify(redisTemplate).unwatch();
  }
  @Test public void shouldExecuteWATCH() throws Exception {
    List<String> keys=new ArrayList<>();
    keys.add("key");
    sendHeaders(RedisConstants.COMMAND,"WATCH",RedisConstants.KEYS,keys);
    verify(redisTemplate).watch(keys);
  }
}
