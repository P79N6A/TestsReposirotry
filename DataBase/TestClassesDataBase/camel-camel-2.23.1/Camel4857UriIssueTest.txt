/** 
 * CAMEL-4857 issue test
 */
public class Camel4857UriIssueTest extends ContextTestSupport {
  /** 
 * An URI of Camel Beanstalk component consists of a hostname, port and a list of tube names. Tube names are separated by "+" character (which is more or less usually used on the Web to make lists), but every tube name may contain URI special characters like ? or +
 */
class MyEndpoint extends DefaultEndpoint {
    String uri;
    String remaining;
    MyEndpoint(    final String uri,    final String remaining){
      this.uri=uri;
      this.remaining=remaining;
    }
    public Producer createProducer() throws Exception {
      throw new UnsupportedOperationException("Not supported yet.");
    }
    public Consumer createConsumer(    Processor processor) throws Exception {
      throw new UnsupportedOperationException("Not supported yet.");
    }
    public boolean isSingleton(){
      return true;
    }
    public String getUri(){
      return uri;
    }
  }
class MyComponent extends DefaultComponent {
    @Override protected Endpoint createEndpoint(    final String uri,    final String remaining,    final Map<String,Object> parameters) throws Exception {
      return new MyEndpoint(uri,remaining);
    }
    @Override public boolean useRawUri(){
      return true;
    }
  }
  @Override @Before public void setUp() throws Exception {
    super.setUp();
    context.addComponent("my",new MyComponent());
  }
  @Test public void testExclamationInUri(){
    MyEndpoint endpoint=context.getEndpoint("my:host:11303/tube1+tube%2B+tube%3F",MyEndpoint.class);
    assertNotNull("endpoint",endpoint);
    assertEquals("my:host:11303/tube1+tube%2B+tube%3F",endpoint.getUri());
  }
  @Test public void testPath(){
    MyEndpoint endpoint=context.getEndpoint("my:host:11303/tube1+tube%2B",MyEndpoint.class);
    assertEquals("Path contains several tube names, every tube name may have + or ? characters","host:11303/tube1+tube%2B",endpoint.remaining);
  }
}
