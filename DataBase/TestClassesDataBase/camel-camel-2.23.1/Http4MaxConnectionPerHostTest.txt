@ContextConfiguration public class Http4MaxConnectionPerHostTest extends AbstractJUnit4SpringContextTests {
  protected static HttpTestServer localServer;
  @Autowired protected CamelContext camelContext;
  @EndpointInject(uri="direct:start") protected ProducerTemplate producer;
  @EndpointInject(uri="mock:result") protected MockEndpoint mock;
  @BeforeClass public static void setUp() throws Exception {
    localServer=new HttpTestServer(null,null);
    localServer.register("/",new HttpRequestHandler(){
      public void handle(      HttpRequest request,      HttpResponse response,      HttpContext context) throws HttpException, IOException {
        response.setStatusCode(HttpStatus.SC_OK);
        response.setEntity(new StringEntity("OK",Consts.ISO_8859_1));
      }
    }
);
    localServer.start();
  }
  @AfterClass public static void tearDown() throws Exception {
    if (localServer != null) {
      localServer.stop();
    }
  }
  @Test public void testMocksIsValid() throws Exception {
    mock.expectedMessageCount(1);
    producer.sendBody(null);
    mock.assertIsSatisfied();
  }
}
