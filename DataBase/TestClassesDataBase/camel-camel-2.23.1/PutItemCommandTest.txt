public class PutItemCommandTest {
  private PutItemCommand command;
  private AmazonDDBClientMock ddbClient;
  private DdbConfiguration configuration;
  private Exchange exchange;
  @Before public void setUp(){
    ddbClient=new AmazonDDBClientMock();
    configuration=new DdbConfiguration();
    configuration.setTableName("DOMAIN1");
    exchange=new DefaultExchange(new DefaultCamelContext());
    command=new PutItemCommand(ddbClient,configuration,exchange);
  }
  @Test public void execute(){
    Map<String,AttributeValue> attributeMap=new HashMap<>();
    AttributeValue attributeValue=new AttributeValue("test value");
    attributeMap.put("name",attributeValue);
    exchange.getIn().setHeader(DdbConstants.ITEM,attributeMap);
    Map<String,ExpectedAttributeValue> expectedAttributeValueMap=new HashMap<>();
    expectedAttributeValueMap.put("name",new ExpectedAttributeValue(attributeValue));
    exchange.getIn().setHeader(DdbConstants.UPDATE_CONDITION,expectedAttributeValueMap);
    command.execute();
    assertEquals("DOMAIN1",ddbClient.putItemRequest.getTableName());
    assertEquals(attributeMap,ddbClient.putItemRequest.getItem());
    assertEquals(expectedAttributeValueMap,ddbClient.putItemRequest.getExpected());
    assertEquals(new AttributeValue("attrValue"),exchange.getIn().getHeader(DdbConstants.ATTRIBUTES,Map.class).get("attrName"));
  }
}
