public class CxfConusmerNamespacePayLoadTest extends CxfConsumerPayloadTest {
  private static final String ECHO_RESPONSE="<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">" + "<soap:Body><ns1:echoResponse xmlns:ns1=\"http://cxf.component.camel.apache.org/\">" + "<return xmlns=\"http://cxf.component.camel.apache.org/\">echo Hello World!</return>"+ "</ns1:echoResponse></soap:Body></soap:Envelope>";
  private static final String ECHO_REQUEST="<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" " + "xmlns:ns1=\"http://cxf.component.camel.apache.org/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" " + "xmlns:ns2=\"http://cxf.component.camel.apache.org/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"><soap:Body>"+ "<ns1:echo><ns2:arg0 xsi:type=\"xsd:string\">Hello World!</ns2:arg0></ns1:echo></soap:Body></soap:Envelope>";
  protected void checkRequest(  String expect,  String request){
    if (expect.equals(ECHO_REQUEST)) {
      assertTrue("Expect to find the namesapce",request.indexOf("xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"") > 0);
    }
  }
  @Test public void testInvokingServiceFromClient() throws Exception {
    HttpPost post=new HttpPost(simpleEndpointAddress);
    post.addHeader("Accept","text/xml");
    StringEntity entity=new StringEntity(ECHO_REQUEST,ContentType.create("text/xml","ISO-8859-1"));
    post.setEntity(entity);
    CloseableHttpClient httpclient=HttpClientBuilder.create().build();
    try {
      HttpResponse response=httpclient.execute(post);
      assertEquals(200,response.getStatusLine().getStatusCode());
      String responseBody=EntityUtils.toString(response.getEntity());
      assertEquals("Get a wrong response",ECHO_RESPONSE,responseBody);
    }
  finally {
      httpclient.close();
    }
  }
}
