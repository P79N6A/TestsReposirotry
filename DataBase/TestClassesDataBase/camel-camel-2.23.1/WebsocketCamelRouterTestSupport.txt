public class WebsocketCamelRouterTestSupport extends CamelTestSupport {
  public static final String CONTEXT="/mycontext";
  public static final String CONTEXT_URL="http://localhost/mycontext";
  protected static final int PORT=AvailablePortFinder.getNextAvailable();
  protected boolean startCamelContext=true;
  protected Server server;
  protected ServletHolder servletHolder;
  @Before public void setUp() throws Exception {
    server=new Server(PORT);
    ServletContextHandler context=new ServletContextHandler(ServletContextHandler.SESSIONS);
    context.setContextPath("/");
    server.setHandler(context);
    if (startCamelContext) {
      super.setUp();
    }
    servletHolder=new ServletHolder(new CamelWebSocketServlet());
    servletHolder.setName("CamelWsServlet");
    context.addServlet(servletHolder,"/*");
    server.start();
  }
  @After public void tearDown() throws Exception {
    if (startCamelContext) {
      super.tearDown();
    }
    server.stop();
    server.destroy();
  }
}
