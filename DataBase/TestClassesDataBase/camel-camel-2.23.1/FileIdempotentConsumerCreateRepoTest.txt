public class FileIdempotentConsumerCreateRepoTest extends Assert {
  File store;
  @Test public void shouldCreateParentOfRepositoryFileStore() throws Exception {
    File parentDirectory=new File("target/repositoryParent_" + randomUUID());
    store=new File(parentDirectory,"store");
    assertStoreExists(store);
  }
  @Test public void shouldUseCurrentDirIfHasNoParentFile() throws Exception {
    String storeFileName="store" + randomUUID();
    store=new File(storeFileName);
    assertStoreExists(store);
  }
  private void assertStoreExists(  File store) throws Exception {
    IdempotentRepository<String> repo=fileIdempotentRepository(store);
    repo.start();
    repo.add("anyKey");
    assertTrue(store.exists());
    repo.stop();
  }
  @After public void after(){
    FileUtil.deleteFile(this.store);
  }
}
