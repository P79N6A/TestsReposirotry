/** 
 * Test the empty responses.
 */
public class TelegramConsumerEmptyResponseTest extends TelegramTestSupport {
  @EndpointInject(uri="mock:telegram") private MockEndpoint endpoint;
  @Before public void mockAPIs(){
    TelegramService api=mockTelegramService();
    UpdateResult defaultRes=getJSONResource("messages/updates-empty.json",UpdateResult.class);
    when(api.getUpdates(any(),any(),any(),any())).thenAnswer((i) -> defaultRes);
  }
  @Test(expected=AssertionError.class) public void testBehaviourWithEmptyUpdates() throws Exception {
    endpoint.setResultWaitTime(500L);
    endpoint.expectedMinimumMessageCount(1);
    endpoint.assertIsSatisfied();
  }
  @Override protected RoutesBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("telegram:bots/mock-token").to("mock:telegram");
      }
    }
;
  }
}
