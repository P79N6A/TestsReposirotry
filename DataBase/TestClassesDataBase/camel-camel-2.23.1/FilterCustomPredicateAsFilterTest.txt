/** 
 * @version 
 */
public class FilterCustomPredicateAsFilterTest extends ContextTestSupport {
  private MyFiler filter=new MyFiler();
private static class MyFiler implements Predicate {
    private List<String> bodies=new ArrayList<>();
    public boolean matches(    Exchange exchange){
      String body=exchange.getIn().getBody(String.class);
      bodies.add(body);
      return !"secret".equals(body);
    }
    public List<String> getBodies(){
      return bodies;
    }
  }
  @Test public void testFilterCustomPredicateAsFilter() throws Exception {
    getMockEndpoint("mock:good").expectedBodiesReceived("Hello World","Bye World");
    template.sendBody("direct:start","Hello World");
    template.sendBody("direct:start","secret");
    template.sendBody("direct:start","Bye World");
    assertMockEndpointsSatisfied();
    assertEquals("Hello World",filter.getBodies().get(0));
    assertEquals("secret",filter.getBodies().get(1));
    assertEquals("Bye World",filter.getBodies().get(2));
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:start").filter(filter).to("mock:good").end();
      }
    }
;
  }
}
