/** 
 * A strategy to enrich JMS message with their original destination if the Camel route originates from a JMS destination. <p/> This implementation uses ActiveMQ specific code which can be moved to activemq-camel when it supports Camel 2.16
 */
private class OriginalDestinationPropagateStrategy implements MessageCreatedStrategy {
  @Override public void onMessageCreated(  Message message,  Session session,  Exchange exchange,  Throwable cause){
    if (exchange.getIn() instanceof JmsMessage) {
      JmsMessage msg=exchange.getIn(JmsMessage.class);
      Message jms=msg.getJmsMessage();
      if (message instanceof ActiveMQMessage) {
        ActiveMQMessage amq=(ActiveMQMessage)jms;
        ActiveMQDestination from=amq.getDestination();
        if (from != null && message instanceof ActiveMQMessage) {
          ((ActiveMQMessage)message).setOriginalDestination(from);
        }
      }
    }
  }
}
