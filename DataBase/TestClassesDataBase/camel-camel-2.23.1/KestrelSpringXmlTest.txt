@ContextConfiguration @RunWith(SpringJUnit4ClassRunner.class) @Ignore("Manual test as you need to start a Kestrel broker") public class KestrelSpringXmlTest extends AbstractJUnit4SpringContextTests {
  @EndpointInject(uri="mock:result") protected MockEndpoint mock;
  @EndpointInject(uri="kestrel://cameltest3") private ProducerTemplate producerTemplate;
  @DirtiesContext @Test public void testProduceAndConsume() throws Exception {
    List<String> bodies=new ArrayList<>();
    for (int k=0; k < 10; ++k) {
      bodies.add("this is body #" + k);
    }
    mock.expectedMinimumMessageCount(bodies.size());
    mock.expectedBodiesReceivedInAnyOrder(bodies);
    for (    String body : bodies) {
      producerTemplate.sendBody(body);
    }
    mock.assertIsSatisfied();
  }
}
