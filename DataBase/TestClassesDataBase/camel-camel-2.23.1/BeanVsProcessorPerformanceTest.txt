/** 
 */
public class BeanVsProcessorPerformanceTest extends ContextTestSupport {
  private final int size=100000;
  @Override protected JndiRegistry createRegistry() throws Exception {
    JndiRegistry jndi=super.createRegistry();
    jndi.bind("myLittleBean",new MyLittleBean());
    return jndi;
  }
  @Test public void testProcessor() throws Exception {
    StopWatch watch=new StopWatch();
    for (int i=0; i < size; i++) {
      Object out=template.requestBody("direct:a","" + i);
      assertEquals("Bye " + i,out);
    }
    log.info("Processor took {} ms ",watch.taken());
  }
  @Test public void testBean() throws Exception {
    StopWatch watch=new StopWatch();
    for (int i=0; i < size; i++) {
      Object out=template.requestBody("direct:b","" + i);
      assertEquals("Bye " + i,out);
    }
    log.info("Bean took {} ms ",watch.taken());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:a").process(new MyLittleProcessor());
        from("direct:b").bean("myLittleBean","bye");
      }
    }
;
  }
}
