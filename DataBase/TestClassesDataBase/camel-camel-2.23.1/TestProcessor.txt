public static class TestProcessor implements Processor {
  static final byte[] MAGIC={(byte)0xca,0x3e,0x1e};
  public void process(  Exchange exchange) throws Exception {
    assertEquals("Don't get the right MEP",ExchangePattern.InOnly,exchange.getPattern());
    String msg=exchange.getIn().getBody(String.class);
    ByteArrayOutputStream bos=new ByteArrayOutputStream();
    bos.write(MAGIC);
    bos.write(msg.getBytes());
    exchange.getIn().setBody(bos.toByteArray());
    exchange.getUnitOfWork().addSynchronization(new Synchronization(){
      @Override public void onComplete(      Exchange exchange){
        onCompeletedCalled=true;
      }
      @Override public void onFailure(      Exchange exchange){
      }
    }
);
  }
}
