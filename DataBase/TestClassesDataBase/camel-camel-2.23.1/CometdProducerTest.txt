@RunWith(MockitoJUnitRunner.class) public class CometdProducerTest {
  private CometdProducer testObj;
  @Mock private CometdEndpoint endpoint;
  @Mock private BayeuxServerImpl bayeuxServerImpl;
  @Mock private LocalSession localSession;
  @Before public void before(){
    when(bayeuxServerImpl.newLocalSession(ArgumentMatchers.isNull())).thenReturn(localSession);
    testObj=new CometdProducer(endpoint);
    testObj.setBayeux(bayeuxServerImpl);
  }
  @Test public void testStartDoesNotCreateNewProducerService() throws Exception {
    testObj.start();
    ProducerService expectedService=testObj.getProducerService();
    testObj.start();
    ProducerService result=testObj.getProducerService();
    assertEquals(expectedService,result);
  }
}
