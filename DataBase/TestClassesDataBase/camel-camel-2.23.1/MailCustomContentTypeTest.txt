/** 
 * Unit test for contentType option.
 */
public class MailCustomContentTypeTest extends CamelTestSupport {
  @Test public void testSendHtmlMail() throws Exception {
    Mailbox.clearAll();
    sendBody("direct:a","<html><body><h1>Hello</h1>World</body></html>");
    Mailbox box=Mailbox.get("claus@localhost");
    Message msg=box.get(0);
    assertTrue(msg.getContentType().startsWith("text/html"));
    assertEquals("text/html; charset=UTF-8",msg.getContentType());
    assertEquals("<html><body><h1>Hello</h1>World</body></html>",msg.getContent());
  }
  @Test public void testSendHtmlMailIso88591() throws Exception {
    Mailbox.clearAll();
    sendBody("direct:c","<html><body><h1>Hello</h1>World</body></html>");
    Mailbox box=Mailbox.get("claus@localhost");
    Message msg=box.get(0);
    assertTrue(msg.getContentType().startsWith("text/html"));
    assertEquals("text/html; charset=iso-8859-1",msg.getContentType());
    assertEquals("<html><body><h1>Hello</h1>World</body></html>",msg.getContent());
  }
  @Test public void testNullBody() throws Exception {
    Mailbox.clearAll();
    template.sendBodyAndHeader("direct:b",null,"contentType","text/plain; charset=iso-8859-1");
    Mailbox box=Mailbox.get("claus@localhost");
    Message msg=box.get(0);
    assertEquals("text/plain; charset=iso-8859-1",msg.getContentType());
    assertEquals("",msg.getContent());
  }
  @Test public void testSendPlainMailContentTypeInHeader() throws Exception {
    Mailbox.clearAll();
    template.sendBodyAndHeader("direct:b","Hello World","contentType","text/plain; charset=iso-8859-1");
    Mailbox box=Mailbox.get("claus@localhost");
    Message msg=box.get(0);
    assertEquals("text/plain; charset=iso-8859-1",msg.getContentType());
    assertEquals("Hello World",msg.getContent());
  }
  @Test public void testSendPlainMailContentTypeInHeader2() throws Exception {
    Mailbox.clearAll();
    template.sendBodyAndHeader("direct:b","Hello World",Exchange.CONTENT_TYPE,"text/plain; charset=iso-8859-1");
    Mailbox box=Mailbox.get("claus@localhost");
    Message msg=box.get(0);
    assertEquals("text/plain; charset=iso-8859-1",msg.getContentType());
    assertEquals("Hello World",msg.getContent());
  }
  @Test public void testSendPlainMailContentTypeTinyTypeInHeader() throws Exception {
    Mailbox.clearAll();
    template.sendBodyAndHeader("direct:b","Hello World","contentType","text/plain;charset=iso-8859-1");
    Mailbox box=Mailbox.get("claus@localhost");
    Message msg=box.get(0);
    assertEquals("text/plain; charset=iso-8859-1",msg.getContentType());
    assertEquals("Hello World",msg.getContent());
  }
  protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from("direct:a").to("smtp://claus@localhost?contentType=text/html;charset=UTF-8");
        from("direct:b").to("smtp://claus@localhost");
        from("direct:c").to("smtp://claus@localhost?contentType=text/html;charset=iso-8859-1");
      }
    }
;
  }
}
