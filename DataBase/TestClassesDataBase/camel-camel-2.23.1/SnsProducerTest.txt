@RunWith(MockitoJUnitRunner.class) public class SnsProducerTest {
  @Mock private Exchange exchange;
  @Mock private SnsEndpoint endpoint;
  private SnsProducer producer;
  @Before public void setUp(){
    producer=new SnsProducer(endpoint);
    when(endpoint.getHeaderFilterStrategy()).thenReturn(new SnsHeaderFilterStrategy());
  }
  @Test public void translateAttributes(){
    Map<String,Object> headers=new HashMap<>();
    headers.put("key1",null);
    headers.put("key2","");
    headers.put("key3","value3");
    Map<String,MessageAttributeValue> translateAttributes=producer.translateAttributes(headers,exchange);
    assertThat(translateAttributes.size(),is(1));
    assertThat(translateAttributes.get("key3").getDataType(),is("String"));
    assertThat(translateAttributes.get("key3").getStringValue(),is("value3"));
  }
}
