@ContextConfiguration public class BindySimpleKeyValuePairMarshallDslTest extends AbstractJUnit4SpringContextTests {
  private List<Map<String,Object>> models=new ArrayList<>();
  private String result="1=BE.CHM.00111=CHM0001-0122=448=BE0001245678" + "54=158=this is a camel - bindy test777=17-02-2011 23:29:59\r\n";
  @Produce(uri="direct:start") private ProducerTemplate template;
  @EndpointInject(uri="mock:result") private MockEndpoint resultEndpoint;
  @Test public void testMarshallMessage() throws Exception {
    resultEndpoint.expectedBodiesReceived(result);
    template.sendBody(generateModel());
    resultEndpoint.assertIsSatisfied();
  }
  public List<Map<String,Object>> generateModel(){
    Map<String,Object> modelObjects=new HashMap<>();
    Order order=new Order();
    order.setAccount("BE.CHM.001");
    order.setClOrdId("CHM0001-01");
    order.setIDSource("4");
    order.setSecurityId("BE0001245678");
    order.setSide("1");
    order.setText("this is a camel - bindy test");
    Calendar calendar=Calendar.getInstance(TimeZone.getTimeZone("GMT"));
    calendar.set(2011,1,18,2,29,59);
    order.setCreated(calendar.getTime());
    modelObjects.put(order.getClass().getName(),order);
    models.add(modelObjects);
    return models;
  }
public static class ContextConfig extends RouteBuilder {
    public void configure(){
      from("direct:start").marshal().bindy(BindyType.KeyValue,org.apache.camel.dataformat.bindy.model.fix.simple.Order.class).to("mock:result");
    }
  }
}
