@Configuration public static class ChildBatchConfig {
  @Autowired JobBuilderFactory jobs;
  @Autowired StepBuilderFactory steps;
  @Autowired ConsumerTemplate consumerTemplate;
  @Autowired ProducerTemplate producerTemplate;
  @Bean protected ItemReader<Object> reader() throws Exception {
    return new CamelItemReader<>(consumerTemplate,"seda:inputQueue");
  }
  @Bean protected ItemWriter<Object> writer() throws Exception {
    return new CamelItemWriter<>(producerTemplate,"mock:output");
  }
  @Bean protected ItemProcessor<Object,Object> processor() throws Exception {
    return new CamelItemProcessor<>(producerTemplate,"direct:processor");
  }
  @Bean protected JobExecutionListener jobExecutionListener() throws Exception {
    return new CamelJobExecutionListener(producerTemplate,"mock:jobExecutionEventsQueue");
  }
  @Bean public Job echoJob() throws Exception {
    return this.jobs.get("echoJob").start(echoStep()).build();
  }
  @Bean protected Step echoStep() throws Exception {
    return this.steps.get("echoStep").chunk(3).reader(reader()).processor(processor()).writer(writer()).build();
  }
}
