public class XsltMessageTerminateTest extends ContextTestSupport {
  @Test public void testXsltTerminate() throws Exception {
    getMockEndpoint("mock:result").expectedMessageCount(0);
    getMockEndpoint("mock:dead").expectedMessageCount(1);
    assertMockEndpointsSatisfied();
    Exchange out=getMockEndpoint("mock:dead").getReceivedExchanges().get(0);
    assertNotNull(out);
    Exception cause=out.getProperty(Exchange.EXCEPTION_CAUGHT,Exception.class);
    assertNotNull(cause);
    Exception warning=out.getProperty(Exchange.XSLT_WARNING,Exception.class);
    assertNotNull(warning);
    assertEquals("Error: DOB is an empty string!",warning.getMessage());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        errorHandler(deadLetterChannel("mock:dead"));
        from("file:src/test/data/?fileName=terminate.xml&noop=true&initialDelay=0&delay=10").to("xslt:org/apache/camel/component/xslt/terminate.xsl").to("log:foo").to("mock:result");
      }
    }
;
  }
}
