/** 
 * Unit test for testing request timeout with a InOut exchange.
 */
public class JmsRouteTimeoutCheckerIntervalTest extends CamelTestSupport {
  @Test public void testTimeout() throws Exception {
    try {
      template.requestBody("activemq:queue:slow?requestTimeout=1000","Hello World");
      fail("Should have timed out with an exception");
    }
 catch (    RuntimeCamelException e) {
      assertTrue("Should have timed out with an exception",e.getCause() instanceof ExchangeTimedOutException);
    }
  }
  @Test public void testNoTimeout() throws Exception {
    Object out=template.requestBody("activemq:queue:slow?requestTimeout=5000","Hello World");
    assertEquals("Bye World",out);
  }
  protected CamelContext createCamelContext() throws Exception {
    CamelContext camelContext=super.createCamelContext();
    ConnectionFactory connectionFactory=CamelJmsTestHelper.createConnectionFactory();
    JmsComponent activmq=jmsComponentAutoAcknowledge(connectionFactory);
    activmq.setRequestTimeoutCheckerInterval(250);
    camelContext.addComponent("activemq",activmq);
    return camelContext;
  }
  protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from("activemq:queue:slow").delay(3000).transform(constant("Bye World"));
      }
    }
;
  }
}
