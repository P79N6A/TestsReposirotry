/** 
 */
public class DumpModelAsXmlSplitNestedChoiceEndRouteTest extends ContextTestSupport {
  @Test public void testDumpModelAsXml() throws Exception {
    String xml=ModelHelper.dumpModelAsXml(context,context.getRouteDefinition("myRoute"));
    assertNotNull(xml);
    log.info(xml);
    Document doc=new XmlConverter().toDOMDocument(xml);
    NodeList nodes=doc.getElementsByTagName("split");
    assertEquals(1,nodes.getLength());
    Element node=(Element)nodes.item(0);
    Element last=(Element)node.getNextSibling().getNextSibling();
    assertEquals("mock:last",last.getAttribute("uri"));
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:start").routeId("myRoute").split().body().to("mock:sub").id("myMock").choice().when(header("foo")).to("mock:foo").when(header("bar")).to("mock:bar").otherwise().to("mock:other").end().end().to("mock:last");
      }
    }
;
  }
}
