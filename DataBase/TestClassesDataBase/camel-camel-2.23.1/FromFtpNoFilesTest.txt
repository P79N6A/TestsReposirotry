/** 
 * Unit test to verify polling a server with no files to poll.
 */
public class FromFtpNoFilesTest extends FtpServerTestSupport {
  private String getFtpUrl(){
    return "ftp://admin@localhost:" + getPort() + "/slowfile?password=admin&binary=false&readLock=rename&consumer.delay=2000";
  }
  @Test public void testPoolIn3SecondsButNoFiles() throws Exception {
    deleteDirectory(FTP_ROOT_DIR);
    createDirectory(FTP_ROOT_DIR + "slowfile");
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedMessageCount(0);
    Thread.sleep(3 * 1000L);
    mock.assertIsSatisfied();
  }
  protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from(getFtpUrl()).to("mock:result");
      }
    }
;
  }
}
