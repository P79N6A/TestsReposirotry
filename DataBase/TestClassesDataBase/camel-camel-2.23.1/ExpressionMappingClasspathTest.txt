@RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration public class ExpressionMappingClasspathTest {
  @EndpointInject(uri="mock:result") private MockEndpoint resultEndpoint;
  @Produce(uri="direct:start") private ProducerTemplate startEndpoint;
  @Autowired private CamelContext camelContext;
  @After public void tearDown(){
    resultEndpoint.reset();
  }
  @Test public void testExpressionMappingScript() throws Exception {
    resultEndpoint.expectedMessageCount(1);
    Map<String,Object> headers=new HashMap<>();
    final String customerNumber="CAFE-345";
    final String orderNumber="ABC-001";
    headers.put("customerNumber",customerNumber);
    headers.put("orderNumber",orderNumber);
    ABCOrder abcOrder=new ABCOrder();
    startEndpoint.sendBodyAndHeaders(abcOrder,headers);
    resultEndpoint.assertIsSatisfied();
    XYZOrder result=resultEndpoint.getExchanges().get(0).getIn().getBody(XYZOrder.class);
    Assert.assertEquals(customerNumber,result.getCustId());
    Assert.assertEquals(orderNumber,result.getOrderId());
  }
}
