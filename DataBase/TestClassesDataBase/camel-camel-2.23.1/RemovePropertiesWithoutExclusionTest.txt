public class RemovePropertiesWithoutExclusionTest extends ContextTestSupport {
  private MockEndpoint end;
  private MockEndpoint mid;
  private String propertyName="foo";
  private String expectedPropertyValue="bar";
  private String propertyName1="fee";
  private String expectedPropertyValue1="bar1";
  private String pattern="f*";
  @Test public void testSetExchangePropertiesMidRouteThenRemoveWithPattern() throws Exception {
    mid.expectedMessageCount(1);
    end.expectedMessageCount(1);
    template.sendBody("direct:start","message");
    assertMockEndpointsSatisfied();
    List<Exchange> midExchanges=mid.getExchanges();
    Exchange midExchange=midExchanges.get(0);
    String actualPropertyValue=midExchange.getProperty(propertyName,String.class);
    String actualPropertyValue1=midExchange.getProperty(propertyName1,String.class);
    assertEquals(expectedPropertyValue,actualPropertyValue);
    assertEquals(expectedPropertyValue1,actualPropertyValue1);
    List<Exchange> endExchanges=end.getExchanges();
    Exchange endExchange=endExchanges.get(0);
    assertNull(endExchange.getProperty(propertyName,String.class));
    assertNull(endExchange.getProperty(propertyName1,String.class));
  }
  @Override @Before public void setUp() throws Exception {
    super.setUp();
    end=getMockEndpoint("mock:end");
    mid=getMockEndpoint("mock:mid");
  }
  protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      public void configure(){
        from("direct:start").setProperty(propertyName).constant(expectedPropertyValue).setProperty(propertyName1).constant(expectedPropertyValue1).to("mock:mid").removeProperties(pattern).to("mock:end");
      }
    }
;
  }
}
