public class BindyBigDecimalGroupingUnmarshallTest extends CamelTestSupport {
  private static final String URI_MOCK_RESULT="mock:result";
  private static final String URI_DIRECT_START="direct:start";
  @Produce(uri=URI_DIRECT_START) private ProducerTemplate template;
  @EndpointInject(uri=URI_MOCK_RESULT) private MockEndpoint result;
  private String record;
  @Test public void testBigDecimalPattern() throws Exception {
    record="'123.456,234'";
    String bigDecimal="123456.24";
    template.sendBody(record);
    result.expectedMessageCount(1);
    result.assertIsSatisfied();
    NumberModel bd=(NumberModel)result.getExchanges().get(0).getIn().getBody();
    Assert.assertEquals(bigDecimal,bd.getGrouping().toString());
  }
  @Override protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        BindyDataFormat bindy=new BindyDataFormat();
        bindy.setType(BindyType.Csv);
        bindy.setClassType(NumberModel.class);
        bindy.setLocale("en");
        from(URI_DIRECT_START).unmarshal(bindy).to(URI_MOCK_RESULT);
      }
    }
;
  }
@CsvRecord(separator=",",quote="'") public static class NumberModel {
    @DataField(pos=1,precision=2,rounding="CEILING",pattern="###,###.###",decimalSeparator=",",groupingSeparator=".") private BigDecimal grouping;
    public BigDecimal getGrouping(){
      return grouping;
    }
    public void setGrouping(    BigDecimal grouping){
      this.grouping=grouping;
    }
    @Override public String toString(){
      return "bigDecimal grouping : " + this.grouping;
    }
  }
}
