public class ArtemisAmqpIntTest extends CamelBlueprintTestSupport {
  @Override protected String getBlueprintDescriptor(){
    return "/OSGI-INF/blueprint/camel-context.xml," + "/OSGI-INF/blueprint/embedded-broker.xml";
  }
  @Override @SuppressWarnings({"unchecked","rawtypes"}) protected String useOverridePropertiesWithConfigAdmin(  Dictionary props){
    int port=AvailablePortFinder.getNextAvailable(9090);
    if (port != 9090) {
      props.put("netty.port","" + port);
      return "my-placeholders";
    }
 else {
      return null;
    }
  }
  @Test public void testEmbeddedBroker() throws Exception {
    String response=template.requestBody("netty4-http:http://localhost:{{netty.port}}/message",null,String.class);
    assertEquals("not expected","Hello from Camel's AMQP example",response);
  }
}
