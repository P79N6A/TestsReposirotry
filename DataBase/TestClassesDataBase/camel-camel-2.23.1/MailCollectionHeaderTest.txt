/** 
 * @version 
 */
public class MailCollectionHeaderTest extends CamelTestSupport {
  @Test public void testMailHeaderWithCollection() throws Exception {
    Mailbox.clearAll();
    String[] foo=new String[]{"Carlsberg","Heineken"};
    template.sendBodyAndHeader("direct:a","Hello World","beers",foo);
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedMessageCount(1);
    mock.expectedBodiesReceived("Hello World");
    mock.message(0).header("beers").isNotNull();
    mock.assertIsSatisfied();
    Object beers=mock.getReceivedExchanges().get(0).getIn().getHeader("beers");
    assertNotNull(beers);
    List<?> list=assertIsInstanceOf(List.class,beers);
    assertEquals("Carlsberg",list.get(0));
    assertEquals("Heineken",list.get(1));
  }
  protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from("direct:a").to("smtp://localhost?username=james@localhost");
        from("pop3://localhost?username=james&password=secret&consumer.initialDelay=100&consumer.delay=100").to("mock:result");
      }
    }
;
  }
}
