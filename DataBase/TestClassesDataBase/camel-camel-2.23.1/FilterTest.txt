/** 
 * Tests filtering using Spring Test and XML Config
 * @version 
 */
@ContextConfiguration public class FilterTest extends SpringRunWithTestSupport {
  @EndpointInject(uri="mock:result") protected MockEndpoint resultEndpoint;
  @Produce(uri="direct:start") protected ProducerTemplate template;
  @DirtiesContext @Test public void testSendMatchingMessage() throws Exception {
    String expectedBody="<matched/>";
    resultEndpoint.expectedBodiesReceived(expectedBody);
    template.sendBodyAndHeader(expectedBody,"foo","bar");
    resultEndpoint.assertIsSatisfied();
  }
  @DirtiesContext @Test public void testSendNotMatchingMessage() throws Exception {
    resultEndpoint.expectedMessageCount(0);
    template.sendBodyAndHeader("<notMatched/>","foo","notMatchedHeaderValue");
    resultEndpoint.assertIsSatisfied();
  }
}
