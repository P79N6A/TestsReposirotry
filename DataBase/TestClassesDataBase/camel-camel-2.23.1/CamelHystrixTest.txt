@RunWith(PaxExam.class) @Ignore("Weird osgi linkage error") public class CamelHystrixTest extends AbstractFeatureTest {
  @Test public void testCamelHystrix() throws Exception {
    URL url=ObjectHelper.loadResourceAsURL("org/apache/camel/itest/CamelHystrixTest.xml",CamelHystrixTest.class.getClassLoader());
    installBlueprintAsBundle("CamelHystrixTest",url,true);
    CamelContext camel=getOsgiService(bundleContext,CamelContext.class);
    MockEndpoint mock=camel.getEndpoint("mock:result",MockEndpoint.class);
    mock.expectedBodiesReceived("Fallback message");
    camel.createProducerTemplate().sendBody("direct:start","Hello World");
    mock.assertIsSatisfied();
  }
  @Configuration public Option[] configure(){
    return CamelKarafTestSupport.configure("camel-test-karaf","camel-hystrix");
  }
}
