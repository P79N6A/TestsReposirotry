public class SetPropertyTest extends ContextTestSupport {
  private MockEndpoint end;
  private String propertyName="foo";
  private String expectedPropertyValue="bar";
  @Test public void testSetExchangePropertyMidRoute() throws Exception {
    end.expectedMessageCount(1);
    template.sendBody("direct:start","<blah/>");
    assertMockEndpointsSatisfied();
    List<Exchange> exchanges=end.getExchanges();
    Exchange exchange=exchanges.get(0);
    String actualPropertyValue=exchange.getProperty(propertyName,String.class);
    assertEquals(expectedPropertyValue,actualPropertyValue);
  }
  @Override @Before public void setUp() throws Exception {
    super.setUp();
    end=getMockEndpoint("mock:end");
  }
  protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      public void configure(){
        from("direct:start").setProperty(propertyName).constant(expectedPropertyValue).to("mock:end");
      }
    }
;
  }
}
