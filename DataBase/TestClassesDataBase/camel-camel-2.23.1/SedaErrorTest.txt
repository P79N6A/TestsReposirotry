public class SedaErrorTest extends ContextTestSupport {
  @Test public void testErrorHandle() throws InterruptedException {
    MockEndpoint mockDLC=getMockEndpoint("mock:dlc");
    mockDLC.expectedMessageCount(1);
    for (int i=0; i < 3; i++) {
      template.send("direct:start",ExchangeBuilder.anExchange(context).withBody("msg" + i).build());
    }
    assertMockEndpointsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        errorHandler(deadLetterChannel("mock:dlc"));
        from("direct:start").log("start: ${body}").to("seda:seda1?size=2&blockWhenFull=false").log("after: ${body}");
      }
    }
;
  }
}
