public class NettyHttpHeaderCaseTest extends BaseNettyTest {
  @Test public void testHttpHeaderCase() throws Exception {
    HttpClient client=new HttpClient();
    HttpMethod method=new PostMethod("http://localhost:" + getPort() + "/myapp/mytest");
    method.setRequestHeader("clientHeader","fooBAR");
    method.setRequestHeader("OTHER","123");
    method.setRequestHeader("beer","Carlsberg");
    client.executeMethod(method);
    assertEquals("Bye World",method.getResponseBodyAsString());
    assertEquals("aBc123",method.getResponseHeader("MyCaseHeader").getValue());
    assertEquals("456DEf",method.getResponseHeader("otherCaseHeader").getValue());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from("netty4-http:http://localhost:{{port}}/myapp/mytest").process(new Processor(){
          public void process(          Exchange exchange) throws Exception {
            Map<String,Object> map=new LinkedHashMap<>();
            map.putAll(exchange.getIn().getHeaders());
            assertEquals("123",map.get("OTHER"));
            assertEquals(null,map.get("other"));
            assertEquals("Carlsberg",map.get("beer"));
            assertEquals(null,map.get("Beer"));
            exchange.getOut().setBody("Bye World");
            exchange.getOut().setHeader("MyCaseHeader","aBc123");
            exchange.getOut().setHeader("otherCaseHeader","456DEf");
          }
        }
);
      }
    }
;
  }
}
