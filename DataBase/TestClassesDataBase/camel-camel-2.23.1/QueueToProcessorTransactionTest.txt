/** 
 * Test case derived from: http://camel.apache.org/transactional-client.html and Martin Krasser's sample: http://www.nabble.com/JMS-Transactions---How-To-td15168958s22882.html#a15198803 NOTE: had to split into separate test classes as I was unable to fully tear down and isolate the test cases, I'm not sure why, but as soon as we know the Transaction classes can be joined into one.
 */
public class QueueToProcessorTransactionTest extends AbstractTransactionTest {
  @Test public void testRollbackUsingXmlQueueToProcessor() throws Exception {
    context.addRoutes(new SpringRouteBuilder(){
      @Override public void configure() throws Exception {
        Policy required=lookup("PROPAGATION_REQUIRED_POLICY",SpringTransactionPolicy.class);
        from("activemq:queue:foo").policy(required).process(new ConditionalExceptionProcessor());
      }
    }
);
    assertResult();
  }
}
