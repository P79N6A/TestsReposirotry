@ContextConfiguration public class CxfToJmsInOutTest extends AbstractJUnit4SpringContextTests {
  private static int port=AvailablePortFinder.getNextAvailable(20005);
static {
    System.setProperty("CxfToJmsInOutTest.port",Integer.toString(port));
  }
  @Autowired protected ProducerTemplate template;
  @EndpointInject(uri="mock:cxf.input") protected MockEndpoint inputEndpoint;
  @EndpointInject(uri="mock:jms.output") protected MockEndpoint outputEndpoint;
  @Test public void testCxfToJmsInOut() throws Exception {
    assertNotNull(template);
    assertNotNull(inputEndpoint);
    assertNotNull(outputEndpoint);
    inputEndpoint.expectedBodiesReceived("Willem");
    outputEndpoint.expectedBodiesReceived("Hello Willem");
    String out=template.requestBodyAndHeader("cxf://bean:serviceEndpoint","Willem",CxfConstants.OPERATION_NAME,"greetMe",String.class);
    assertEquals("Hello Willem",out);
    inputEndpoint.assertIsSatisfied();
    outputEndpoint.assertIsSatisfied();
  }
}
