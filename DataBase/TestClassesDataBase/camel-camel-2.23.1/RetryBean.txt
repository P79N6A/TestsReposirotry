/** 
 * Bean used as dead letter queue, that decides what to do with the message
 */
public static class RetryBean {
  @RecipientList public String handleError(  Exchange exchange){
    int attempts=exchange.getProperty("attempts",0,int.class);
    attempts++;
    exchange.setProperty("attempts",attempts);
    if (attempts <= 4) {
      return "seda:retry";
    }
 else {
      return "log:giveup";
    }
  }
}
