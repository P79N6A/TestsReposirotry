public class DeadLetterChannelNewExceptionTest extends ContextTestSupport {
public static class BadErrorHandler {
    @Handler public void onException(    Exchange exchange,    Exception exception) throws Exception {
      throw new RuntimeException("error in errorhandler");
    }
  }
  @Test public void testDeadLetterChannelNewException() throws Exception {
    template.sendBody("direct:start","Hello World");
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        errorHandler(deadLetterChannel("bean:" + BadErrorHandler.class.getName()));
        from("direct:start").log("Incoming ${body}").throwException(new IllegalArgumentException("Forced"));
      }
    }
;
  }
}
