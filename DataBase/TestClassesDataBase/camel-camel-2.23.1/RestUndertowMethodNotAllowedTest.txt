public class RestUndertowMethodNotAllowedTest extends BaseUndertowTest {
  @Test public void testMethodNotAllowed(){
    try {
      template.sendBody("http://localhost:" + getPort() + "/users/123/basic","body");
      fail("Shall not pass!");
    }
 catch (    Exception e) {
      HttpOperationFailedException hofe=assertIsInstanceOf(HttpOperationFailedException.class,e.getCause());
      assertEquals(405,hofe.getStatusCode());
    }
  }
  @Test public void testMethodAllowed(){
    try {
      template.sendBodyAndHeader("http://localhost:" + getPort() + "/users/123/basic","body",Exchange.HTTP_METHOD,"GET");
    }
 catch (    Exception e) {
      fail("Shall pass with GET http method!");
    }
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure(){
        restConfiguration().component("undertow").host("localhost").port(getPort());
        rest("/users/").get("{id}/basic").route().to("mock:input").process(exchange -> {
          String id=exchange.getIn().getHeader("id",String.class);
          exchange.getOut().setBody(id + ";Donald Duck");
        }
);
      }
    }
;
  }
}
