public class RestNettyHttpPojoInOutTest extends BaseNettyTest {
  @Test public void testNettyPojoInOut() throws Exception {
    String body="{\"id\": 123, \"name\": \"Donald Duck\"}";
    String out=template.requestBody("netty4-http:http://localhost:" + getPort() + "/users/lives",body,String.class);
    assertNotNull(out);
    assertEquals("{\"iso\":\"EN\",\"country\":\"England\"}",out);
  }
  @Test public void testNettyGetRequest() throws Exception {
    String out=template.requestBody("netty4-http:http://localhost:" + getPort() + "/users/lives",null,String.class);
    assertNotNull(out);
    assertEquals("{\"iso\":\"EN\",\"country\":\"England\"}",out);
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        restConfiguration().component("netty4-http").host("localhost").port(getPort()).bindingMode(RestBindingMode.auto);
        rest("/users/").get("lives").to("direct:start").post("lives").type(UserPojo.class).outType(CountryPojo.class).route().bean(new UserService(),"livesWhere");
        CountryPojo country=new CountryPojo();
        country.setIso("EN");
        country.setCountry("England");
        from("direct:start").transform().constant(country);
      }
    }
;
  }
}
