/** 
 * @version 
 */
public class AdviceWithInterceptTest extends ContextTestSupport {
  @Test public void testAdviceIntercept() throws Exception {
    getMockEndpoint("mock:advice").expectedMessageCount(1);
    context.getRouteDefinition("main").adviceWith(context,new AdviceWithRouteBuilder(){
      @Override public void configure() throws Exception {
        weaveAddFirst().to("direct:advice");
      }
    }
);
    template.sendBody("direct:main","Hello World");
    assertMockEndpointsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        intercept().log("Intercept ${body}");
        from("direct:advice").log("Advice ${body}").to("mock:advice");
        from("direct:main").routeId("main").log("Main ${body}");
      }
    }
;
  }
}
