@RunWith(SpringRunner.class) @DirtiesContext @SpringBootApplication @SpringBootTest(classes={CacheManagerCustomizerOverrideTest.TestConfiguration.class},properties={"debug=false","camel.component.ehcache.customizer.cache-manager.enabled=true","camel.component.ehcache.customizer.cache-manager.override=true"}) public class CacheManagerCustomizerOverrideTest {
  private static final CacheManager CACHE_MANAGER=CacheManagerBuilder.newCacheManagerBuilder().build();
  @Autowired CacheManager cacheManager;
  @Autowired EhcacheComponent component;
  @Test public void testComponentConfiguration() throws Exception {
    Assert.assertNotNull(cacheManager);
    Assert.assertNotNull(component);
    Assert.assertNotNull(component.getCacheManager());
    Assert.assertEquals(cacheManager,component.getCacheManager());
  }
@Configuration @AutoConfigureAfter(CamelAutoConfiguration.class) @AutoConfigureBefore(EhcacheComponentAutoConfiguration.class) public static class TestConfiguration {
    @Order(Ordered.HIGHEST_PRECEDENCE) @Bean public ComponentCustomizer<EhcacheComponent> customizer(){
      return new ComponentCustomizer<EhcacheComponent>(){
        @Override public void customize(        EhcacheComponent component){
          component.setCacheManager(CACHE_MANAGER);
        }
      }
;
    }
    @Bean(initMethod="init",destroyMethod="close") public CacheManager cacheManager(){
      return CacheManagerBuilder.newCacheManagerBuilder().build();
    }
  }
}
