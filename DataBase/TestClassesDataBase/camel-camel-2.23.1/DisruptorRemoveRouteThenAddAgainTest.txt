/** 
 * @version
 */
public class DisruptorRemoveRouteThenAddAgainTest extends CamelTestSupport {
  @Test public void testRemoveRouteAndThenAddAgain() throws Exception {
    MockEndpoint out=getMockEndpoint("mock:out");
    out.expectedMessageCount(1);
    out.expectedBodiesReceived("before removing the route");
    template.sendBody("disruptor:in","before removing the route");
    out.assertIsSatisfied();
    context.stopRoute("disruptorToMock");
    context.removeRoute("disruptorToMock");
    context.addRoutes(createRouteBuilder());
    template.stop();
    out=getMockEndpoint("mock:out");
    out.expectedMessageCount(1);
    out.expectedBodiesReceived("after removing the route");
    template.start();
    template.sendBody("disruptor:in","after removing the route");
    out.assertIsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("disruptor:in").routeId("disruptorToMock").to("mock:out");
      }
    }
;
  }
}
