public class RoutingSlipCreateProducerFailedTest extends ContextTestSupport {
  @Test public void testRoutingSlipCreateProducerFailed() throws Exception {
    assertEquals(0,context.getInflightRepository().size());
    template.sendBodyAndHeader("direct:start","Hello World","foo","log:foo");
    assertEquals(0,context.getInflightRepository().size());
    try {
      template.sendBodyAndHeader("direct:start","Hello World","foo","file://target/test?fileExist=Append&tempPrefix=hello");
      fail("Should fail");
    }
 catch (    CamelExecutionException e) {
      assertIsInstanceOf(FailedToCreateProducerException.class,e.getCause());
    }
    assertEquals(0,context.getInflightRepository().size());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:start").routingSlip(header("foo"));
      }
    }
;
  }
}
