public class EndpointTest extends CamelTestSupport {
  private static final String HOST="my.host.me";
  private static final Integer PORT=4000;
  private static final String DIRECTORY="directory";
  private static final String CLUSTERID="clusterId";
  private static final DrillConnectionMode MODE=DrillConnectionMode.ZK;
  @Test public void testZKJdbcURL() throws Exception {
    Endpoint endpoint=context.getEndpoint("drill://" + HOST + "?port="+ PORT+ "&directory="+ DIRECTORY+ "&clusterId="+ CLUSTERID+ "&mode="+ MODE);
    final String uri="jdbc:drill:zk=" + HOST + ":"+ PORT+ "/"+ DIRECTORY+ "/"+ CLUSTERID;
    assertTrue(endpoint instanceof DrillEndpoint);
    assertEquals(HOST,((DrillEndpoint)endpoint).getHost());
    assertEquals(PORT,((DrillEndpoint)endpoint).getPort());
    assertEquals(DIRECTORY,((DrillEndpoint)endpoint).getDirectory());
    assertEquals(CLUSTERID,((DrillEndpoint)endpoint).getClusterId());
    assertEquals(MODE,((DrillEndpoint)endpoint).getMode());
    assertEquals(uri,((DrillEndpoint)endpoint).toJDBCUri());
  }
}
