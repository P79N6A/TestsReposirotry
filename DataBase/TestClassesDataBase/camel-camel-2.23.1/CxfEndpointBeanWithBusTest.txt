/** 
 * Unit test for testing CXF bus injection.
 * @version 
 */
public class CxfEndpointBeanWithBusTest extends AbstractSpringBeanTestSupport {
  static int port1=CXFTestSupport.getPort1();
  static int port2=CXFTestSupport.getPort2();
  protected String[] getApplicationContextFiles(){
    return new String[]{"org/apache/camel/component/cxf/spring/CxfEndpointBeansRouterWithBus.xml"};
  }
  @Test public void testBusInjectedBySpring() throws Exception {
    CamelContext camelContext=ctx.getBean("camel",CamelContext.class);
    CxfEndpoint endpoint=camelContext.getEndpoint("cxf:bean:routerEndpoint",CxfEndpoint.class);
    assertTrue(endpoint.getBus().getInInterceptors().size() >= 1);
    for (    Interceptor<?> i : endpoint.getBus().getInInterceptors()) {
      if (i instanceof LoggingInInterceptor) {
        return;
      }
    }
    fail("Could not find the LoggingInInterceptor on the bus. " + endpoint.getBus().getInInterceptors());
  }
  @Test public void testCxfEndpointBeanDefinitionParser(){
    CxfEndpoint routerEndpoint=ctx.getBean("routerEndpoint",CxfEndpoint.class);
    assertEquals("Got the wrong endpoint address","http://localhost:" + port1 + "/CxfEndpointBeanWithBusTest/router/",routerEndpoint.getAddress());
    assertEquals("Got the wrong endpont service class","org.apache.camel.component.cxf.HelloService",routerEndpoint.getServiceClass().getName());
  }
}
