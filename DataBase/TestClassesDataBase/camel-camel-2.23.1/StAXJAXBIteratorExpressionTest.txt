public class StAXJAXBIteratorExpressionTest extends CamelTestSupport {
  @EndpointInject(uri="mock:records") private MockEndpoint recordsEndpoint;
  @BeforeClass public static void initRouteExample(){
    RecordsUtil.createXMLFile();
  }
  @Override public RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("file:target/in").split(stax(Record.class)).streaming().to("mock:records");
      }
    }
;
  }
  @Test public void testStaxExpression() throws InterruptedException {
    recordsEndpoint.expectedMessageCount(10);
    recordsEndpoint.allMessages().body().isInstanceOf(Record.class);
    recordsEndpoint.assertIsSatisfied();
    Record five=recordsEndpoint.getReceivedExchanges().get(4).getIn().getBody(Record.class);
    assertEquals("4",five.getKey());
    assertEquals("#4",five.getValue());
  }
}
