public class SpringJsonPathSplitWriteAsStringTest extends CamelSpringTestSupport {
  @Override protected AbstractApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext("org/apache/camel/jsonpath/SpringJsonPathSplitWriteAsStringTest.xml");
  }
  @Test public void testSplitToJSon() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:line");
    mock.expectedMessageCount(2);
    mock.allMessages().body().isInstanceOf(String.class);
    mock.message(0).body().isEqualTo("{\"action\":\"CU\",\"id\":123,\"modifiedTime\":\"2015-07-28T11:40:09.520+02:00\"}");
    mock.message(1).body().isEqualTo("{\"action\":\"CU\",\"id\":456,\"modifiedTime\":\"2015-07-28T11:42:29.510+02:00\"}");
    template.sendBody("direct:start",new File("src/test/resources/content.json"));
    assertMockEndpointsSatisfied();
  }
}
