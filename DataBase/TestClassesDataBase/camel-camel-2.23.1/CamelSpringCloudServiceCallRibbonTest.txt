@DirtiesContext @RunWith(SpringRunner.class) @SpringBootApplication @SpringBootTest(classes={CamelAutoConfiguration.class,CamelCloudAutoConfiguration.class,CamelSpringCloudServiceCallRibbonTest.TestConfiguration.class},properties={"spring.main.banner-mode=off","ribbon.eureka.enabled=false","ribbon.listOfServers=localhost:9090,localhost:9092","ribbon.ServerListRefreshInterval=15000"}) public class CamelSpringCloudServiceCallRibbonTest {
  @Autowired private ProducerTemplate template;
  @Test public void testServiceCall() throws Exception {
    Assert.assertEquals("9090",template.requestBody("direct:start",null,String.class));
    Assert.assertEquals("9092",template.requestBody("direct:start",null,String.class));
  }
@Configuration public static class TestConfiguration {
    @Bean public RouteBuilder myRouteBuilder(){
      return new RouteBuilder(){
        @Override public void configure() throws Exception {
          from("direct:start").serviceCall().name("custom-svc-list/hello").end();
          from("jetty:http://localhost:9090/hello").transform().constant("9090");
          from("jetty:http://localhost:9091/hello").transform().constant("9091");
          from("jetty:http://localhost:9092/hello").transform().constant("9092");
        }
      }
;
    }
  }
}
