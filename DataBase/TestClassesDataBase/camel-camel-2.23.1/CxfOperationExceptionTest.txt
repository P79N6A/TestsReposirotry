public class CxfOperationExceptionTest extends CamelSpringTestSupport {
  private static final int PORT1=CXFTestSupport.getPort1();
  @Override protected AbstractXmlApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext("org/apache/camel/component/cxf/jaxrs/CxfOperationException.xml");
  }
  @Test(expected=CamelExecutionException.class) public void testRestServerDirectlyAddCustomer(){
    Customer input=new Customer();
    input.setName("Donald Duck");
    String response=template.requestBodyAndHeader("cxfrs:http://localhost:" + PORT1 + "/CxfOperationExceptionTest/customerservice/customers?throwExceptionOnFailure=true",input,Exchange.HTTP_METHOD,"POST",String.class);
    assertNotNull(response);
    assertTrue(response.endsWith("<name>Donald Duck</name></Customer>"));
  }
  @Test public void testRestServerDirectlyAddCustomerWithExceptionsTurnedOff(){
    Customer input=new Customer();
    input.setName("Donald Duck");
    String response=template.requestBodyAndHeader("cxfrs:bean:rsClient?throwExceptionOnFailure=false",input,Exchange.HTTP_METHOD,"POST",String.class);
    assertNotNull(response);
    assertTrue(response.contains("Problem accessing /CxfOperationExceptionTest/rest"));
  }
}
