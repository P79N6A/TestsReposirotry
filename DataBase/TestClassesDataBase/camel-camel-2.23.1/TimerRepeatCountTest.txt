/** 
 * Unit test for fired time exchange property
 */
public class TimerRepeatCountTest extends ContextTestSupport {
  @Test public void testRepeatCount() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedMessageCount(3);
    mock.setAssertPeriod(100);
    mock.message(0).header(Exchange.TIMER_COUNTER).isEqualTo(1);
    mock.message(1).header(Exchange.TIMER_COUNTER).isEqualTo(2);
    mock.message(2).header(Exchange.TIMER_COUNTER).isEqualTo(3);
    context.startAllRoutes();
    assertMockEndpointsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from("timer://hello?delay=0&repeatCount=3&period=10").noAutoStartup().to("mock:result");
      }
    }
;
  }
}
