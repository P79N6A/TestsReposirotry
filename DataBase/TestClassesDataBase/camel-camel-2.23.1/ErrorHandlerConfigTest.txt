/** 
 * @version 
 */
@ContextConfiguration public class ErrorHandlerConfigTest extends SpringRunWithTestSupport {
  @Autowired protected ProducerTemplate template;
  @Autowired protected CamelContext context;
  protected Object expectedBody="<hello>world!</hello>";
  @Test public void testRouteInheritsConfiguredErrorHandler() throws Exception {
    assertReceivedMessageWithErrorHandlerValue("defaultErrorHandler","defaultErrorHandler");
  }
  @Test public void testRouteConfiguredErrorHandler() throws Exception {
    assertReceivedMessageWithErrorHandlerValue("customErrorHandler","customErrorHandler");
  }
  protected void assertReceivedMessageWithErrorHandlerValue(  String name,  String value) throws InterruptedException {
    template.sendBody("direct:" + name,expectedBody);
    MockEndpoint endpoint=MockEndpoint.resolve(context,"mock:" + name);
    endpoint.expectedMessageCount(1);
    endpoint.message(0).header(DummyErrorHandlerBuilder.PROPERTY_NAME).isEqualTo(value);
    endpoint.assertIsSatisfied();
  }
}
