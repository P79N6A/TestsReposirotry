public class FromRestApiTest extends ContextTestSupport {
  @Override protected JndiRegistry createRegistry() throws Exception {
    JndiRegistry jndi=super.createRegistry();
    jndi.bind("dummy-rest",new DummyRestConsumerFactory());
    jndi.bind("dummy-rest-api",new DummyRestProcessorFactory());
    return jndi;
  }
  @Test public void testFromRestModel() throws Exception {
    assertEquals(1,context.getRestDefinitions().size());
    RestDefinition rest=context.getRestDefinitions().get(0);
    assertNotNull(rest);
    assertEquals("/say/hello",rest.getPath());
    assertEquals(1,rest.getVerbs().size());
    ToDefinition to=assertIsInstanceOf(ToDefinition.class,rest.getVerbs().get(0).getTo());
    assertEquals("log:hello",to.getUri());
    assertEquals(2,context.getRoutes().size());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        restConfiguration().host("localhost").component("dummy-rest").apiContextPath("/api");
        rest("/say/hello").get().to("log:hello");
      }
    }
;
  }
}
