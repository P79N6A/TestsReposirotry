/** 
 * To test timeout.
 */
public class Mina2ExchangeTimeOutTest extends BaseMina2Test {
  @Test public void testUsingTimeoutParameter() throws Exception {
    Endpoint endpoint=context.getEndpoint(String.format("mina2:tcp://localhost:%1$s?textline=true&sync=true&timeout=500",getPort()));
    Producer producer=endpoint.createProducer();
    producer.start();
    Exchange exchange=endpoint.createExchange();
    exchange.getIn().setBody("Hello World");
    try {
      producer.process(exchange);
      fail("Should have thrown an ExchangeTimedOutException wrapped in a RuntimeCamelException");
    }
 catch (    Exception e) {
      assertTrue("Should have thrown an ExchangeTimedOutException",e instanceof ExchangeTimedOutException);
    }
    producer.stop();
  }
  protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      public void configure(){
        from(String.format("mina2:tcp://localhost:%1$s?textline=true&sync=true&timeout=30000",getPort())).process(new Processor(){
          public void process(          Exchange e) throws Exception {
            assertEquals("Hello World",e.getIn().getBody(String.class));
            Thread.sleep(2000);
            e.getOut().setBody("Okay I will be faster in the future");
          }
        }
);
      }
    }
;
  }
}
