public class JdbcAggregationRepositoryAlotDataTest extends AbstractJdbcAggregationTestSupport {
  @Test public void testWithAlotOfDataSameKey(){
    for (int i=0; i < 100; i++) {
      Exchange exchange1=new DefaultExchange(context);
      exchange1.getIn().setBody("counter:" + i);
      repo.add(context,"foo",exchange1);
    }
    Exchange actual=repo.get(context,"foo");
    assertEquals("counter:99",actual.getIn().getBody());
  }
  @Test public void testWithAlotOfDataTwoKeys(){
    for (int i=0; i < 100; i++) {
      Exchange exchange1=new DefaultExchange(context);
      exchange1.getIn().setBody("counter:" + i);
      String key=i % 2 == 0 ? "foo" : "bar";
      repo.add(context,key,exchange1);
    }
    Exchange actual=repo.get(context,"foo");
    assertEquals("counter:98",actual.getIn().getBody());
    actual=repo.get(context,"bar");
    assertEquals("counter:99",actual.getIn().getBody());
  }
  @Test public void testWithAlotOfDataWithDifferentKeys(){
    for (int i=0; i < 100; i++) {
      Exchange exchange1=new DefaultExchange(context);
      exchange1.getIn().setBody("counter:" + i);
      String key="key" + i;
      repo.add(context,key,exchange1);
    }
    for (int i=0; i < 100; i++) {
      Exchange actual=repo.get(context,"key" + i);
      assertEquals("counter:" + i,actual.getIn().getBody());
    }
  }
}
