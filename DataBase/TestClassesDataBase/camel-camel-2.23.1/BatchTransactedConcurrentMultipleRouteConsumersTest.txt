/** 
 * Verify that batch transactions are processed correctly when dealing with multiple routes consuming from a single destination.
 */
public class BatchTransactedConcurrentMultipleRouteConsumersTest extends TransactedConsumerSupport {
  private static final String BROKER_URI="vm://btcmrc_test_broker?broker.persistent=false&broker.useJmx=false";
  /** 
 * We want to verify that when consuming from a single destination with multiple routes that we are thread safe and behave accordingly.
 * @throws Exception
 */
  @Test public void testRoute() throws Exception {
    final String destinationName="sjms:queue:one.consumer.two.route.batch.tx.test";
    int routeCount=2;
    int consumerCount=1;
    int batchCount=5;
    int messageCount=20;
    int maxAttemptsCount=10;
    int totalRedeliverdFalse=10;
    int totalRedeliveredTrue=5;
    runTest(destinationName,routeCount,messageCount,totalRedeliverdFalse,totalRedeliveredTrue,batchCount,consumerCount,maxAttemptsCount);
  }
  @Override public String getBrokerUri(){
    return BROKER_URI;
  }
}
