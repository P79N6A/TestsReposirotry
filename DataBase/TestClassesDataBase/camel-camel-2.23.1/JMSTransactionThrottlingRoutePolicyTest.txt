public class JMSTransactionThrottlingRoutePolicyTest extends CamelSpringTestSupport {
  private int size=200;
  protected ClassPathXmlApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext("/org/apache/camel/component/jms/tx/JMSTransactionThrottlingRoutePolicyTest.xml");
  }
  @Override @Before public void setUp() throws Exception {
    deleteDirectory("activemq-data");
    super.setUp();
  }
  @Test public void testJmsTransactedThrottlingRoutePolicy() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedMinimumMessageCount(size);
    for (int i=0; i < size; i++) {
      template.sendBody("activemq-sender:queue:foo","Message " + i);
    }
    assertMockEndpointsSatisfied();
  }
}
