public class TestClientChannelPipelineFactory extends ClientInitializerFactory {
  private int maxLineSize=1024;
  private NettyProducer producer;
  public TestClientChannelPipelineFactory(  NettyProducer producer){
    this.producer=producer;
  }
  @Override protected void initChannel(  Channel ch) throws Exception {
    ChannelPipeline channelPipeline=ch.pipeline();
    clientInvoked=true;
    channelPipeline.addLast("decoder-DELIM",new DelimiterBasedFrameDecoder(maxLineSize,true,Delimiters.lineDelimiter()));
    channelPipeline.addLast("decoder-SD",new StringDecoder(CharsetUtil.UTF_8));
    channelPipeline.addLast("encoder-SD",new StringEncoder(CharsetUtil.UTF_8));
    channelPipeline.addLast("handler",new ClientChannelHandler(producer));
  }
  @Override public ClientInitializerFactory createPipelineFactory(  NettyProducer producer){
    return new TestClientChannelPipelineFactory(producer);
  }
}
