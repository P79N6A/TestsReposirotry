public class QuartzManagementTest extends BaseQuartzTest {
  protected MBeanServer getMBeanServer(){
    return context.getManagementStrategy().getManagementAgent().getMBeanServer();
  }
  @Test public void testQuartzRoute() throws Exception {
    if (isPlatform("aix")) {
      return;
    }
    getMockEndpoint("mock:result").expectedMessageCount(2);
    assertMockEndpointsSatisfied();
    MBeanServer mbeanServer=getMBeanServer();
    String name=String.format("quartz:type=QuartzScheduler,name=DefaultQuartzScheduler-%s,instance=NON_CLUSTERED",context.getManagementName());
    ObjectName on=ObjectName.getInstance(name);
    assertTrue(mbeanServer.isRegistered(on));
    Boolean started=(Boolean)mbeanServer.getAttribute(on,"Started");
    assertEquals(true,started);
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("quartz://myGroup/myTimerName?trigger.repeatInterval=2&trigger.repeatCount=1").routeId("myRoute").to("mock:result");
      }
    }
;
  }
}
