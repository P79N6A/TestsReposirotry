/** 
 * @version 
 */
public class GenerateXmlTest extends XmlTestSupport {
  @Test public void testCreateSimpleXml() throws Exception {
    RoutesDefinition context=new RoutesDefinition();
    RouteDefinition route=context.route();
    route.from("seda:a");
    route.filter(new XQueryExpression("in.header.foo == 'bar'")).to("seda:b");
    route.description(null,"This is a description of the route","en");
    dump(context);
  }
  @Test public void testGroovyFilterXml() throws Exception {
    RoutesDefinition context=new RoutesDefinition();
    RouteDefinition route=context.route();
    route.from("seda:a");
    route.filter(new GroovyExpression("in.headers.any { h -> h.startsWith('foo') }")).to("seda:b");
    route.description(null,"This is a description of the route","en");
    List<?> list=route.getOutputs();
    assertEquals("Size of list: " + list,1,list.size());
    dump(context);
  }
  protected void dump(  RouteContainer context) throws Exception {
    Marshaller marshaller=jaxbContext.createMarshaller();
    marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT,Boolean.TRUE);
    StringWriter buffer=new StringWriter();
    marshaller.marshal(context,buffer);
    log.info("Created: " + buffer);
    assertNotNull(buffer);
    String out=buffer.toString();
    assertTrue("Should contain the description",out.indexOf("This is a description of the route") > 0);
  }
}
