public class CamelSalesforceMojoIntegrationTest {
  @Rule public TemporaryFolder temp=new TemporaryFolder();
  @Test public void testExecute() throws Exception {
    final GenerateMojo mojo=createMojo();
    mojo.execute();
    final Path packagePath=temp.getRoot().toPath().resolve("test").resolve("dto");
    assertThat(packagePath).as("Package directory was not created").exists();
    final List<JavaFileObject> sources=Files.list(packagePath).map(p -> {
      try {
        return JavaFileObjects.forResource(p.toUri().toURL());
      }
 catch (      final MalformedURLException e) {
        throw new IllegalArgumentException(e);
      }
    }
).collect(Collectors.toList());
    final Compilation compilation=Compiler.javac().compile(sources);
    assertThat(compilation.status()).isEqualTo(Status.SUCCESS);
  }
  GenerateMojo createMojo() throws IOException {
    final GenerateMojo mojo=new GenerateMojo();
    setup(mojo);
    mojo.version=SalesforceEndpointConfig.DEFAULT_VERSION;
    mojo.outputDirectory=temp.getRoot();
    mojo.packageName="test.dto";
    mojo.includePattern="(.*__c)|(PushTopic)|(Document)|(Account)";
    return mojo;
  }
}
