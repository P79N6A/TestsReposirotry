public class FtpProducerReplyStringTest extends FtpServerTestSupport {
  private String getFtpUrl(){
    return "ftp://admin@localhost:" + getPort() + "/reply?password=admin";
  }
  @Test public void testReplyCodeAndString() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedBodiesReceived("Bye World");
    mock.expectedHeaderReceived(FtpConstants.FTP_REPLY_CODE,226);
    mock.expectedHeaderReceived(FtpConstants.FTP_REPLY_STRING,"226 Transfer complete.\r\n");
    template.requestBodyAndHeader("direct:start","Bye World",Exchange.FILE_NAME,"hello.txt");
    assertMockEndpointsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:start").to(getFtpUrl()).to("mock:result");
      }
    }
;
  }
}
