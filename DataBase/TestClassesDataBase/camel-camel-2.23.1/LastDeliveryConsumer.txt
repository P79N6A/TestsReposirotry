private static final class LastDeliveryConsumer extends DefaultConsumer {
  private byte[] lastBody;
  private LastDeliveryConsumer(  Channel channel){
    super(channel);
  }
  @Override public void handleDelivery(  String consumerTag,  Envelope envelope,  AMQP.BasicProperties properties,  byte[] body) throws IOException {
    lastBody=body;
    super.handleDelivery(consumerTag,envelope,properties,body);
  }
  public byte[] getLastBody(){
    return lastBody;
  }
  public String getLastBodyAsString(){
    return lastBody == null ? null : new String(lastBody);
  }
}
