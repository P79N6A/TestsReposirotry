public class Camel10165BugTest extends CamelTestSupport {
  private static final int PORT1=CXFTestSupport.getPort("Camel10165BugTest.1");
  @Test public void testCallServiceWithBasePath() throws Exception {
    String request="abc";
    String response=template.requestBody("http://localhost:" + PORT1 + "/basePath/echo",request,String.class);
    assertEquals(request,response);
  }
  @Test public void testCallServiceWithoutBasePath() throws Exception {
    String request="abc";
    String response=template.requestBody("http://localhost:" + PORT1 + "/echo",request,String.class);
    assertEquals(request,response);
  }
  @Override protected RoutesBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("jetty:http://localhost:" + PORT1 + "/?matchOnUriPrefix=true").to("cxfbean:echoService");
        from("jetty:http://localhost:" + PORT1 + "/basePath/?matchOnUriPrefix=true").to("cxfbean:echoService");
      }
    }
;
  }
  @Override protected JndiRegistry createRegistry() throws Exception {
    JndiRegistry registry=super.createRegistry();
    registry.bind("echoService",new EchoService());
    return registry;
  }
@Path("echo") public class EchoService {
    @POST public String echo(    String request){
      return request;
    }
  }
}
