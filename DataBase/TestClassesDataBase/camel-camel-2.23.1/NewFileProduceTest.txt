/** 
 * Simple unit test to produce a new file
 */
public class NewFileProduceTest extends ContextTestSupport {
  @Override @Before public void setUp() throws Exception {
    deleteDirectory("target/producefile");
    super.setUp();
  }
  @Override public boolean isUseRouteBuilder(){
    return false;
  }
  @Test public void testNewFileProducer() throws Exception {
    FileComponent comp=new FileComponent();
    comp.setCamelContext(context);
    Endpoint endpoint=comp.createEndpoint("file://target/producefile","target/producefile",new HashMap<String,Object>());
    template.send(endpoint,new Processor(){
      public void process(      Exchange exchange) throws Exception {
        exchange.getIn().setHeader(Exchange.FILE_NAME,"bye.txt");
        exchange.getIn().setBody("Bye World");
      }
    }
);
    File file=new File("target/producefile/bye.txt");
    assertTrue("The file should have been created",file.exists());
  }
}
