public class IBatisTestSupport extends CamelTestSupport {
  protected boolean createTestData(){
    return true;
  }
  protected String getStatement(){
    return "create table ACCOUNT ( ACC_ID INTEGER , ACC_FIRST_NAME VARCHAR(255), ACC_LAST_NAME VARCHAR(255), ACC_EMAIL VARCHAR(255)  )";
  }
  @Override @Before public void setUp() throws Exception {
    super.setUp();
    Connection connection=createConnection();
    Statement statement=connection.createStatement();
    statement.execute(getStatement());
    connection.commit();
    connection.close();
    if (createTestData()) {
      Account account1=new Account();
      account1.setId(123);
      account1.setFirstName("James");
      account1.setLastName("Strachan");
      account1.setEmailAddress("TryGuessing@gmail.com");
      Account account2=new Account();
      account2.setId(456);
      account2.setFirstName("Claus");
      account2.setLastName("Ibsen");
      account2.setEmailAddress("Noname@gmail.com");
      template.sendBody("ibatis:insertAccount?statementType=Insert",new Account[]{account1,account2});
    }
  }
  @Override @After public void tearDown() throws Exception {
    super.tearDown();
    try {
      new EmbeddedDriver().connect("jdbc:derby:memory:ibatis;drop=true",new Properties());
    }
 catch (    SQLException ex) {
      if (!"08006".equals(ex.getSQLState())) {
        throw ex;
      }
    }
  }
  private Connection createConnection() throws Exception {
    IBatisEndpoint endpoint=resolveMandatoryEndpoint("ibatis:Account",IBatisEndpoint.class);
    return endpoint.getSqlMapClient().getDataSource().getConnection();
  }
}
