/** 
 * @version 
 */
public class HttpProducerQueryParamTest extends BaseJettyTest {
  private String url="http://127.0.0.1:" + getPort() + "/cheese";
  @Test public void testQueryParameters() throws Exception {
    Exchange exchange=template.request(url + "?quote=Camel%20rocks",null);
    assertNotNull(exchange);
    String body=exchange.getOut().getBody(String.class);
    Map<?,?> headers=exchange.getOut().getHeaders();
    assertEquals("Bye World",body);
    assertEquals("Carlsberg",headers.get("beer"));
  }
  @Test public void testQueryParametersWithHeader() throws Exception {
    Exchange exchange=template.request(url,new Processor(){
      public void process(      Exchange exchange) throws Exception {
        exchange.getIn().setHeader(Exchange.HTTP_QUERY,"quote=Camel rocks");
      }
    }
);
    assertNotNull(exchange);
    String body=exchange.getOut().getBody(String.class);
    Map<?,?> headers=exchange.getOut().getHeaders();
    assertEquals("Bye World",body);
    assertEquals("Carlsberg",headers.get("beer"));
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("jetty:" + url).process(new Processor(){
          public void process(          Exchange exchange) throws Exception {
            String quote=exchange.getIn().getHeader("quote",String.class);
            assertEquals("Camel rocks",quote);
            exchange.getOut().setBody("Bye World");
            exchange.getOut().setHeader("beer","Carlsberg");
          }
        }
);
      }
    }
;
  }
}
