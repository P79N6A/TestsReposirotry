/** 
 * @version 
 */
public class SchedulerRouteTest extends ContextTestSupport {
  private static final Logger LOG=LoggerFactory.getLogger(SchedulerRouteTest.class);
  private MyBean bean=new MyBean();
  @Test public void testSchedulerInvokesBeanMethod() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedMinimumMessageCount(2);
    assertMockEndpointsSatisfied();
    assertTrue("Should have fired 2 or more times was: " + bean.counter.get(),bean.counter.get() >= 2);
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure(){
        from("scheduler://foo?delay=100").log("Fired scheduler").to("bean:myBean","mock:result");
      }
    }
;
  }
  @Override protected Context createJndiContext() throws Exception {
    JndiContext answer=new JndiContext();
    answer.bind("myBean",bean);
    return answer;
  }
public static class MyBean {
    public AtomicInteger counter=new AtomicInteger(0);
    public void someMethod(){
      LOG.debug("Invoked someMethod()");
      counter.incrementAndGet();
    }
  }
}
