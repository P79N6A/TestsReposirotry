/** 
 * Tests for JCR type conversions ( {@link JcrConverter})
 */
public class JcrConverterTest extends Assert {
  protected TypeConverter converter;
  @Before public void init() throws Exception {
    converter=new DefaultTypeConverter(new DefaultPackageScanClassResolver(),new ReflectionInjector(),new DefaultFactoryFinderResolver().resolveDefaultFactoryFinder(new DefaultClassResolver()),true);
    ServiceHelper.startService(converter);
  }
  @Test public void testBooleanValueConverter() throws Exception {
    assertJcrConverterAvailable(BooleanValue.class,Boolean.TRUE);
  }
  @Test public void testBinaryValueConverter() throws Exception {
    assertJcrConverterAvailable(BinaryValue.class,new ByteArrayInputStream("test".getBytes()));
  }
  @Test public void testDateValueConverter() throws Exception {
    assertJcrConverterAvailable(DateValue.class,Calendar.getInstance());
  }
  @Test public void testStringValueConverter() throws Exception {
    assertJcrConverterAvailable(StringValue.class,"plain text");
  }
  private void assertJcrConverterAvailable(  Class<?> expected,  Object object){
    Value value=converter.convertTo(Value.class,object);
    assertNotNull(value);
    assertTrue(expected.isAssignableFrom(value.getClass()));
  }
}
