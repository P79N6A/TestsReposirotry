/** 
 */
public class JettyXsltHttpTemplateTest extends CamelTestSupport {
  private int port;
  @Test public void testXsltHttpTemplate() throws Exception {
    Thread.sleep(1000);
    String xml=template.requestBody("xslt:http://0.0.0.0:" + port + "/myxslt","<mail><subject>Hey</subject><body>Hello world!</body></mail>",String.class);
    assertNotNull("The transformed XML should not be null",xml);
    assertTrue(xml.indexOf("transformed") > -1);
    assertTrue(xml.indexOf("cheese") > -1);
    assertTrue(xml.indexOf("<subject>Hey</subject>") > -1);
    assertTrue(xml.indexOf("<body>Hello world!</body>") > -1);
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    port=AvailablePortFinder.getNextAvailable(8000);
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("jetty:http://0.0.0.0:" + port + "/myxslt").pollEnrich("file://src/test/resources/org/apache/camel/itest/jetty/?fileName=transform.xsl&noop=true&readLock=none",2000).convertBodyTo(String.class).to("log:transform");
      }
    }
;
  }
}
