/** 
 * Unit test allowing end users to set additional mail.xxx properties.
 */
public class AdditionalMailPropertiesTest extends CamelTestSupport {
  @Test public void testAdditionalMailProperties() throws Exception {
    Mailbox.clearAll();
    MailEndpoint endpoint=context.getEndpoint("pop3://localhost?username=james&mail.pop3.forgettopheaders=true&consumer.initialDelay=100&consumer.delay=100",MailEndpoint.class);
    Properties prop=endpoint.getConfiguration().getAdditionalJavaMailProperties();
    assertEquals("true",prop.get("mail.pop3.forgettopheaders"));
  }
  @Test public void testConsumeWithAdditionalProperties() throws Exception {
    Mailbox.clearAll();
    MockEndpoint mock=getMockEndpoint("mock:result");
    template.sendBodyAndHeader("smtp://james@localhost","Hello james how are you?","subject","Hello");
    mock.expectedBodiesReceived("Hello james how are you?");
    mock.expectedHeaderReceived("subject","Hello");
    assertMockEndpointsSatisfied();
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("pop3://james@localhost?mail.pop3.forgettopheaders=true&consumer.initialDelay=100&consumer.delay=100").to("mock:result");
      }
    }
;
  }
}
