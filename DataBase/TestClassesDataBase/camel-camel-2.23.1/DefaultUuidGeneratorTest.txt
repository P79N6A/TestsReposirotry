/** 
 * Tests the  {@link DefaultUuidGenerator}. <p/> Thanks to this SO answer: https://stackoverflow.com/questions/30485856/how-to-run-jmh-from-inside-junit-tests
 */
public class DefaultUuidGeneratorTest {
  @Test public void launchBenchmark() throws Exception {
    Options opt=new OptionsBuilder().include(this.getClass().getName() + ".*").mode(Mode.All).timeUnit(TimeUnit.MICROSECONDS).warmupTime(TimeValue.seconds(1)).warmupIterations(2).measurementTime(TimeValue.seconds(1)).measurementIterations(2).threads(2).forks(1).shouldFailOnError(true).shouldDoGC(true).build();
    new Runner(opt).run();
  }
@State(Scope.Thread) public static class BenchmarkState {
    DefaultUuidGenerator uuid;
    @Setup(Level.Trial) public void initialize(){
      uuid=new DefaultUuidGenerator();
    }
  }
  @Benchmark @Measurement(batchSize=1000000) public void benchmark(  BenchmarkState state,  Blackhole bh){
    String id=state.uuid.generateUuid();
    bh.consume(id);
  }
}
