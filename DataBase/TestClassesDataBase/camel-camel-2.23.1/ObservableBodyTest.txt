public class ObservableBodyTest extends CamelTestSupport {
  protected MyObservableBody observableBody=new MyObservableBody();
  @EndpointInject(uri="mock:result") protected MockEndpoint resultEndpoint;
  @Produce(uri="direct:start") protected ProducerTemplate template;
  @Test public void testUseObservableInRoute() throws Exception {
    resultEndpoint.expectedBodiesReceived("Hello James","Hello Claus");
    template.sendBody("James");
    template.sendBody("Claus");
    assertMockEndpointsSatisfied();
  }
public class MyObservableBody extends ObservableBody<String> {
    public MyObservableBody(){
      super(String.class);
    }
    @Override protected void configure(    Observable<String> observable){
      observable.map(body -> "Hello " + body).subscribe(body -> {
        template.sendBody(resultEndpoint,body);
      }
);
    }
  }
  @Override protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      @Override public void configure(){
        from("direct:start").process(observableBody);
      }
    }
;
  }
}
