public class ControlBusRestartRouteTest extends ContextTestSupport {
  private MyRoutePolicy myRoutePolicy=new MyRoutePolicy();
  @Test public void testControlBusRestart() throws Exception {
    assertEquals(1,myRoutePolicy.getStart());
    assertEquals(0,myRoutePolicy.getStop());
    assertEquals("Started",context.getRouteStatus("foo").name());
    template.sendBody("controlbus:route?routeId=foo&action=restart&restartDelay=0",null);
    assertEquals("Started",context.getRouteStatus("foo").name());
    assertEquals(2,myRoutePolicy.getStart());
    assertEquals(1,myRoutePolicy.getStop());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("seda:foo").routeId("foo").routePolicy(myRoutePolicy).to("mock:foo");
      }
    }
;
  }
private final class MyRoutePolicy extends RoutePolicySupport {
    private int start;
    private int stop;
    @Override public void onStart(    Route route){
      start++;
    }
    @Override public void onStop(    Route route){
      stop++;
    }
    public int getStart(){
      return start;
    }
    public int getStop(){
      return stop;
    }
  }
}
