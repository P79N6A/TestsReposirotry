/** 
 * Unit test for wiki demonstration.
 */
public class JettyRouteWithSocketPropertiesTest extends BaseJettyTest {
  @Test public void testSendToJetty() throws Exception {
    Object response=template.requestBody("http://localhost:{{port}}/myapp/myservice","bookid=123");
    String body=context.getTypeConverter().convertTo(String.class,response);
    assertEquals("<html><body>Book 123 is Camel in Action</body></html>",body);
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        Map<String,Object> properties=new HashMap<>();
        properties.put("acceptors",4);
        properties.put("statsOn","false");
        properties.put("soLingerTime","5000");
        JettyHttpComponent jetty=getContext().getComponent("jetty",JettyHttpComponent.class);
        jetty.setSocketConnectorProperties(properties);
        from("jetty:http://localhost:{{port}}/myapp/myservice").process(new MyBookService());
      }
    }
;
  }
public class MyBookService implements Processor {
    public void process(    Exchange exchange) throws Exception {
      String body=exchange.getIn().getBody(String.class);
      HttpServletRequest req=exchange.getIn().getBody(HttpServletRequest.class);
      assertNotNull(req);
      assertEquals("bookid=123",body);
      exchange.getOut().setBody("<html><body>Book 123 is Camel in Action</body></html>");
    }
  }
}
