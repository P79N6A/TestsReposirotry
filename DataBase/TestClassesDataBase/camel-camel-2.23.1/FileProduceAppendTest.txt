/** 
 * Unit test to verify the append option
 */
public class FileProduceAppendTest extends ContextTestSupport {
  @Test public void testAppendText() throws Exception {
    MockEndpoint mock=getMockEndpoint("mock:result");
    mock.expectedMessageCount(1);
    mock.expectedFileExists("target/test-file-append/hello.txt","Hello World");
    template.sendBody("direct:start"," World");
    assertMockEndpointsSatisfied();
  }
  @Override @Before public void setUp() throws Exception {
    deleteDirectory("target/test-file-append");
    super.setUp();
    template.sendBodyAndHeader("file://target/test-file-append","Hello",Exchange.FILE_NAME,"hello.txt");
    template.sendBodyAndHeader("file://target/test-file-append"," World",Exchange.FILE_NAME,"world.txt");
  }
  @Override protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      public void configure(){
        from("direct:start").setHeader(Exchange.FILE_NAME,constant("hello.txt")).to("file://target/test-file-append?fileExist=Append","mock:result");
      }
    }
;
  }
}
