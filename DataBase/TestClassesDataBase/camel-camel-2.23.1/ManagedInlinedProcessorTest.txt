/** 
 * @version 
 */
public class ManagedInlinedProcessorTest extends ManagementTestSupport {
  @Test public void testManageInlinedProcessor() throws Exception {
    if (isPlatform("aix")) {
      return;
    }
    MBeanServer mbeanServer=getMBeanServer();
    ObjectName on=ObjectName.getInstance("org.apache.camel:context=camel-1,type=processors,name=\"custom\"");
    getMockEndpoint("mock:result").expectedMessageCount(1);
    template.sendBody("direct:start","Hello World");
    assertMockEndpointsSatisfied();
    Long counter=(Long)mbeanServer.getAttribute(on,"ExchangesCompleted");
    assertEquals(1L,counter.longValue());
    ManagedProcessorMBean mb=context.getManagedProcessor("custom",ManagedProcessorMBean.class);
    assertNotNull(mb);
    assertEquals(1L,mb.getExchangesCompleted());
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:start").routeId("foo").process(new Processor(){
          @Override public void process(          Exchange exchange) throws Exception {
            exchange.getOut().setBody("Bye World");
          }
        }
).id("custom").to("mock:result");
      }
    }
;
  }
}
