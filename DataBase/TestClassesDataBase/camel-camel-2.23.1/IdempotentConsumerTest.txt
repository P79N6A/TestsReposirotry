/** 
 * @version 
 */
public class IdempotentConsumerTest extends CamelSpringTestSupport {
  @Override protected AbstractXmlApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext("org/apache/camel/itest/idempotent/IdempotentConsumerTest.xml");
  }
  @Test public void testDuplicateMessagesAreFilteredOut() throws Exception {
    getMockEndpoint("mock:result").expectedBodiesReceived("one","two","three");
    template.sendBodyAndHeader("direct:start","one","messageId",1);
    template.sendBodyAndHeader("direct:start","two","messageId",2);
    template.sendBodyAndHeader("direct:start","one","messageId",1);
    template.sendBodyAndHeader("direct:start","two","messageId",2);
    template.sendBodyAndHeader("direct:start","three","messageId",3);
    assertMockEndpointsSatisfied();
  }
}
