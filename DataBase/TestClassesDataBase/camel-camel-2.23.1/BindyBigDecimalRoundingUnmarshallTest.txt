public class BindyBigDecimalRoundingUnmarshallTest extends CamelTestSupport {
  private static final String URI_MOCK_RESULT="mock:result";
  private static final String URI_DIRECT_START="direct:start";
  @Produce(uri=URI_DIRECT_START) private ProducerTemplate template;
  @EndpointInject(uri=URI_MOCK_RESULT) private MockEndpoint result;
  private String record;
  @Test public void testBigDecimalRoundingUp() throws Exception {
    record="'12345.789'";
    String bigDecimal="12345.79";
    template.sendBody(record);
    result.expectedMessageCount(1);
    result.assertIsSatisfied();
    NumberModel bd=(NumberModel)result.getExchanges().get(0).getIn().getBody();
    Assert.assertEquals(bigDecimal,bd.getRoundingUp().toString());
  }
  @Override protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        BindyDataFormat bindy=new BindyDataFormat();
        bindy.setType(BindyType.Csv);
        bindy.setClassType(NumberModel.class);
        bindy.setLocale("en");
        from(URI_DIRECT_START).unmarshal(bindy).to(URI_MOCK_RESULT);
      }
    }
;
  }
@CsvRecord(separator=",",quote="'") public static class NumberModel {
    @DataField(pos=1,precision=2,rounding="UP",pattern="#####,##") private BigDecimal roundingUp;
    public BigDecimal getRoundingUp(){
      return roundingUp;
    }
    public void setRoundingUp(    BigDecimal roundingUp){
      this.roundingUp=roundingUp;
    }
    @Override public String toString(){
      return "BigDecimal rounding : " + this.roundingUp;
    }
  }
}
