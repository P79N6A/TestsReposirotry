/** 
 * Useful base class for JT400 secured component unit tests. It creates a mock secured connection pool, registers it under the ID  {@code "mockPool"} and releases itafter the test runs.
 */
public abstract class Jt400SecureTestSupport extends CamelTestSupport {
  private AS400ConnectionPool connectionPool;
  protected Jt400SecureTestSupport(){
  }
  @Before public void setUp() throws Exception {
    connectionPool=new MockAS400SecureConnectionPool();
    super.setUp();
  }
  @After public void tearDown() throws Exception {
    super.tearDown();
    if (connectionPool != null) {
      connectionPool.close();
    }
  }
  @Override protected JndiRegistry createRegistry() throws Exception {
    ObjectHelper.notNull(connectionPool,"connectionPool");
    JndiRegistry registry=super.createRegistry();
    registry.bind("mockPool",connectionPool);
    return registry;
  }
  /** 
 * Returns the mock connection pool.
 * @return the mock connection pool
 */
  public AS400ConnectionPool getConnectionPool(){
    return connectionPool;
  }
}
