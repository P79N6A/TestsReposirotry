/** 
 * Tests the XPath annotation 'header' value which when set will cause the XPath to be evaluated on the required header, otherwise it will be applied to the body
 */
public class BeanWithXPathInjectionUsingHeaderValueTest extends ContextTestSupport {
  protected MyBean myBean=new MyBean();
  @Test public void testConstantXPathHeaders() throws Exception {
    template.sendBodyAndHeader("bean:myBean","<response>OK</response>","invoiceDetails","<invoice><person><name>Alan</name><date>26/08/2012</date></person></invoice>");
    assertEquals("bean response:  " + myBean,"OK",myBean.response);
    assertEquals("bean userName: " + myBean,"Alan",myBean.userName);
    assertEquals("bean date:  " + myBean,"26/08/2012",myBean.date);
  }
  @Override protected Context createJndiContext() throws Exception {
    JndiContext answer=new JndiContext();
    answer.bind("myBean",myBean);
    return answer;
  }
public static class MyBean {
    public String userName;
    public String date;
    public String response;
    @Handler public void handler(    @XPath("//response/text()") String response,    @XPath(headerName="invoiceDetails",value="//invoice/person/name/text()") String userName,    @XPath(headerName="invoiceDetails",value="//invoice/person/date",resultType=String.class) String date){
      this.response=response;
      this.userName=userName;
      this.date=date;
    }
  }
}
