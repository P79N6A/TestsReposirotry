/** 
 * @version 
 */
public class XPathTest extends CamelTestSupport {
  @Test public void testXPathUsingSaxon() throws Exception {
    XPathFactory fac=new XPathFactoryImpl();
    XPathBuilder builder=XPathBuilder.xpath("foo/bar").factory(fac);
    String name=builder.evaluate(context,"<foo><bar id=\"1\">cheese</bar></foo>",String.class);
    assertEquals("<bar id=\"1\">cheese</bar>",name);
    name=builder.evaluate(context,"<foo><bar id=\"1\">cheese</bar></foo>");
    assertEquals("cheese",name);
  }
  @Test public void testXPathFunctionSubstringUsingSaxon() throws Exception {
    String xml="<foo><bar>Hello World</bar></foo>";
    XPathFactory fac=new XPathFactoryImpl();
    XPathBuilder builder=XPathBuilder.xpath("substring(/foo/bar, 7)").factory(fac);
    String result=builder.resultType(String.class).evaluate(context,xml,String.class);
    assertEquals("World",result);
    result=builder.evaluate(context,xml);
    assertEquals("World",result);
  }
  @Test public void testXPathFunctionTokenizeUsingSaxonXPathFactory() throws Exception {
    XPathFactory fac=new net.sf.saxon.xpath.XPathFactoryImpl();
    XPathBuilder builder=XPathBuilder.xpath("tokenize(/foo/bar, '_')[2]").factory(fac);
    String result=builder.evaluate(context,"<foo><bar>abc_def_ghi</bar></foo>");
    assertEquals("def",result);
  }
  @Ignore("See http://www.saxonica.com/documentation/index.html#!xpath-api/jaxp-xpath/factory") @Test public void testXPathFunctionTokenizeUsingObjectModel() throws Exception {
    XPathBuilder builder=XPathBuilder.xpath("tokenize(/foo/bar, '_')[2]").objectModel("http://saxon.sf.net/jaxp/xpath/om");
    String result=builder.evaluate(context,"<foo><bar>abc_def_ghi</bar></foo>");
    assertEquals("def",result);
  }
  @Test public void testXPathFunctionTokenizeUsingSaxon() throws Exception {
    XPathBuilder builder=XPathBuilder.xpath("tokenize(/foo/bar, '_')[2]").saxon();
    String result=builder.evaluate(context,"<foo><bar>abc_def_ghi</bar></foo>");
    assertEquals("def",result);
  }
  @Test public void testXPathFunctionTokenizeUsingSystemProperty() throws Exception {
    System.setProperty(XPathFactory.DEFAULT_PROPERTY_NAME + ":" + "http://saxon.sf.net/jaxp/xpath/om","net.sf.saxon.xpath.XPathFactoryImpl");
    XPathBuilder builder=XPathBuilder.xpath("tokenize(/foo/bar, '_')[2]");
    String result=builder.evaluate(context,"<foo><bar>abc_def_ghi</bar></foo>");
    assertEquals("def",result);
  }
}
