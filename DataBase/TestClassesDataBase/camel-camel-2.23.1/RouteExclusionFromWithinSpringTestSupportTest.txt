public class RouteExclusionFromWithinSpringTestSupportTest extends SpringTestSupport {
  @Override protected AbstractXmlApplicationContext createApplicationContext(){
    return new ClassPathXmlApplicationContext(new String[]{"org/apache/camel/spring/config/scan/componentScan.xml"},getRouteExcludingApplicationContext());
  }
  @Test public void testRouteExcluded() throws InterruptedException {
    assertEquals(1,context.getRoutes().size());
    MockEndpoint mock=getMockEndpoint("mock:definitelyShouldNeverReceiveExchange");
    mock.expectedMessageCount(0);
    sendBody("seda:shouldNeverRecieveExchange","dropped like a hot rock");
    mock.await(500,TimeUnit.MILLISECONDS);
    mock.assertIsSatisfied();
  }
  @Test public void testRoutesNotExcludedWorkNormally() throws InterruptedException {
    template.sendBody("direct:start","request");
    MockEndpoint mock=getMockEndpoint("mock:end");
    mock.expectedMessageCount(1);
    mock.assertIsSatisfied();
  }
  @Override protected Class<?> excludeRoute(){
    return MyExcludedRouteBuilder.class;
  }
}
