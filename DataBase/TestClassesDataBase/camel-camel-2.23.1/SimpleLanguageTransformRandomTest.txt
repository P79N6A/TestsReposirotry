/** 
 * Unit test routing with simple language using random function which will reuse cached expressions.
 */
public class SimpleLanguageTransformRandomTest extends ContextTestSupport {
  @Test public void testSimpleTransform() throws Exception {
    int out=template.requestBodyAndHeader("direct:start","Random number","max","5",int.class);
    assertTrue(out <= 5);
    out=template.requestBodyAndHeader("direct:start","Random number","max","20",int.class);
    assertTrue(out <= 20);
    out=template.requestBodyAndHeader("direct:start","Random number","max","30",int.class);
    assertTrue(out <= 30);
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      public void configure() throws Exception {
        from("direct:start").transform().simple("${random(1,${header.max})}");
      }
    }
;
  }
}
