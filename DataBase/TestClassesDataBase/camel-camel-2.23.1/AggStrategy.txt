public static final class AggStrategy implements AggregationStrategy {
  private final int batchSize=1000;
  @SuppressWarnings("unchecked") public Exchange aggregate(  Exchange oldExchange,  Exchange newExchange){
    String str=newExchange.getIn().getBody(String.class);
    if (oldExchange == null) {
      List<String> list=new ArrayList<>(batchSize);
      list.add(str);
      newExchange.getIn().setBody(list);
      return newExchange;
    }
    List<String> list=oldExchange.getIn().getBody(List.class);
    list.add(str);
    return oldExchange;
  }
}
