public class TwoService2Test extends CamelAwsXRayTestSupport {
  public TwoService2Test(){
    super(TestDataBuilder.createTrace().inRandomOrder().withSegment(TestDataBuilder.createSegment("route1").withSubsegment(TestDataBuilder.createSubsegment("direct:ServiceB").withSubsegment(TestDataBuilder.createSubsegment("route2")))));
  }
  @Test public void testRoute() throws Exception {
    NotifyBuilder notify=new NotifyBuilder(context).whenDone(1).create();
    template.requestBody("direct:ServiceA","Hello");
    assertThat("Not all exchanges were fully processed",notify.matches(10,TimeUnit.SECONDS),is(equalTo(true)));
    verify();
  }
  @Override protected RoutesBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("direct:ServiceA").log("ServiceA has been called").delay(simple("${random(1000,2000)}")).to("direct:ServiceB");
        from("direct:ServiceB").log("ServiceB has been called").delay(simple("${random(0,500)}"));
      }
    }
;
  }
}
