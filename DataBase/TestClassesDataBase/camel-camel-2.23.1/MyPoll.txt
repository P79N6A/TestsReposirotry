private class MyPoll implements PollingConsumerPollStrategy {
  public boolean begin(  Consumer consumer,  Endpoint endpoint){
    return true;
  }
  public void commit(  Consumer consumer,  Endpoint endpoint,  int polledMessages){
  }
  public boolean rollback(  Consumer consumer,  Endpoint endpoint,  int retryCounter,  Exception cause) throws Exception {
    GenericFileOperationFailedException e=assertIsInstanceOf(GenericFileOperationFailedException.class,cause);
    assertEquals(530,e.getCode());
    consumer.stop();
    latch.countDown();
    return false;
  }
}
