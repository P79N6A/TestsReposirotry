/** 
 * @version 
 */
public class ManagedBrowsableEndpointAsXmlFileTest extends ManagementTestSupport {
  @Override @Before public void setUp() throws Exception {
    deleteDirectory("target/files");
    super.setUp();
  }
  @Test public void testBrowseableEndpointAsXmlAllIncludeBody() throws Exception {
    if (isPlatform("aix")) {
      return;
    }
    template.sendBodyAndHeader("direct:start","Hello World",Exchange.FILE_NAME,"hello.txt");
    MBeanServer mbeanServer=getMBeanServer();
    ObjectName name=ObjectName.getInstance("org.apache.camel:context=camel-1,type=endpoints,name=\"file://target/files\"");
    String out=(String)mbeanServer.invoke(name,"browseAllMessagesAsXml",new Object[]{true},new String[]{"java.lang.Boolean"});
    assertNotNull(out);
    log.info(out);
    assertTrue("Should contain the body",out.contains("Hello World</body>"));
  }
  @Override protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        context.setUseBreadcrumb(false);
        from("direct:start").to("file:target/files");
      }
    }
;
  }
}
