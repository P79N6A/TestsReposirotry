public class MllpConfigurationBeanBlueprintTest extends CamelBlueprintTestSupport {
  @EndpointInject(uri="mock://target") MockEndpoint received;
  @Override protected void addServicesOnStartup(  Map<String,KeyValueHolder<Object,Dictionary>> services){
    ComponentResolver testResolver=new DefaultComponentResolver();
    services.put(ComponentResolver.class.getName(),asService(testResolver,"component","mllp"));
  }
  @Override protected String getBlueprintDescriptor(){
    return "OSGI-INF/blueprint/mllp-configuration-bean-test.xml";
  }
  @Test public void testReceiveMultipleMessages() throws Exception {
    int sendMessageCount=5;
    received.expectedMinimumMessageCount(5);
    for (int i=1; i <= sendMessageCount; ++i) {
      template.sendBody("direct://source","Message " + i);
    }
    assertMockEndpointsSatisfied(10,TimeUnit.SECONDS);
  }
}
