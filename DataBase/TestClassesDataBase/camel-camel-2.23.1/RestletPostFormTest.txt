/** 
 * @version 
 */
public class RestletPostFormTest extends RestletTestSupport {
  @Override protected RouteBuilder createRouteBuilder(){
    return new RouteBuilder(){
      @Override public void configure() throws Exception {
        from("restlet:http://localhost:" + portNum + "/users?restletMethod=POST").process(new PostProcessor());
      }
    }
;
  }
class PostProcessor implements Processor {
    public void process(    Exchange exchange) throws Exception {
      assertEquals("bar",exchange.getIn().getHeader("foo",String.class));
      exchange.getIn().setBody("OK");
      exchange.getIn().setHeader(Exchange.CONTENT_TYPE,"text/plain");
    }
  }
  @Test public void testPostBody() throws Exception {
    HttpUriRequest method=new HttpPost("http://localhost:" + portNum + "/users");
    List<NameValuePair> urlParameters=new ArrayList<>();
    urlParameters.add(new BasicNameValuePair("foo","bar"));
    ((HttpEntityEnclosingRequestBase)method).setEntity(new UrlEncodedFormEntity(urlParameters));
    HttpResponse response=doExecute(method);
    assertHttpResponse(response,200,"text/plain");
  }
}
