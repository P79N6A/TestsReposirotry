public class UtilityTest extends FacebookTestCase {
  @Test public void testStringMapToParcel(){
    assertNull(roundtrip(null));
    HashMap<String,String> map=new HashMap<>();
    assertEquals(0,roundtrip(map).size());
    map.put("a","100");
    map.put("b",null);
    map.put("c","hello");
    Map<String,String> result=roundtrip(map);
    assertEquals(3,result.size());
    assertEquals(map,result);
    assertEquals("100",result.get("a"));
    assertNull(result.get("b"));
    assertEquals("hello",result.get("c"));
  }
  private Map<String,String> roundtrip(  Map<String,String> input){
    Parcel parcel=Parcel.obtain();
    try {
      Utility.writeStringMapToParcel(parcel,input);
      parcel.setDataPosition(0);
      return Utility.readStringMapFromParcel(parcel);
    }
  finally {
      parcel.recycle();
    }
  }
}
