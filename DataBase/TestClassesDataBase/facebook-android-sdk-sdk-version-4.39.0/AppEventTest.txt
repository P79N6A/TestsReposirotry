public class AppEventTest extends FacebookTestCase {
  @Before public void init(){
    FacebookSdk.setApplicationId("123456789");
    FacebookSdk.setAutoLogAppEventsEnabled(false);
    FacebookSdk.sdkInitialize(RuntimeEnvironment.application);
  }
  @Test public void testChecksumOfAppEventName() throws Exception {
    AppEvent appEvent=AppEventTestUtilities.getTestAppEvent();
    String eventNameMd5=appEvent.getJSONObject().getString(Constants.EVENT_NAME_MD5_EVENT_KEY);
    Assert.assertEquals("e0cf6877da9df873a85a2137fb5d2e26",eventNameMd5);
  }
  @Test public void testChecksumOfAppEvent() throws Exception {
    AppEvent appEvent=AppEventTestUtilities.getTestAppEvent();
    Assert.assertTrue(appEvent.isChecksumValid());
    appEvent.getJSONObject().put("new_key","corrupted");
    Assert.assertFalse(appEvent.isChecksumValid());
  }
  @Test public void testAppEventSerializedChecksum() throws Exception {
    AppEvent appEvent1=AppEventTestUtilities.getTestAppEvent();
    ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
    ObjectOutputStream objectOutputStream=new ObjectOutputStream(byteArrayOutputStream);
    objectOutputStream.writeObject(appEvent1);
    ByteArrayInputStream byteArrayInputStream=new ByteArrayInputStream(byteArrayOutputStream.toByteArray());
    ObjectInputStream objectInputStream=new ObjectInputStream(byteArrayInputStream);
    AppEvent appEvent2=(AppEvent)objectInputStream.readObject();
    Assert.assertTrue(appEvent2.isChecksumValid());
    Assert.assertTrue(appEvent1.getJSONObject().toString().equals(appEvent2.getJSONObject().toString()));
  }
}
