/** 
 * Custom argument matcher to match a  {@link ScanRequest} on the segment number.
 */
private static class SegmentArgumentMatcher extends ArgumentMatcher<ScanRequest> {
  private final int matchingSegmentNumber;
  private SegmentArgumentMatcher(  int matchingSegmentNumber){
    this.matchingSegmentNumber=matchingSegmentNumber;
  }
  @Override public boolean matches(  Object argument){
    if (!(argument instanceof ScanRequest)) {
      return false;
    }
    return matchingSegmentNumber == ((ScanRequest)argument).getSegment();
  }
}
