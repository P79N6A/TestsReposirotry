/** 
 * Test suite for nd4j. This will run every combination of every unit test provided that the backend's ordering and test line up.
 * @author Adam Gibson
 */
public class Nd4jTestSuite extends BlockJUnit4ClassRunner {
  public final static String BACKENDS_TO_LOAD="backends";
  private static List<Nd4jBackend> backends;
static {
    ServiceLoader<Nd4jBackend> loadedBackends=ServiceLoader.load(Nd4jBackend.class);
    Iterator<Nd4jBackend> backendIterator=loadedBackends.iterator();
    backends=new ArrayList<>();
    while (backendIterator.hasNext())     backends.add(backendIterator.next());
  }
  /** 
 * Only called reflectively. Do not use programmatically.
 * @param klass
 */
  public Nd4jTestSuite(  Class<?> klass) throws Throwable {
    super(klass);
  }
  /** 
 * Based on the jvm arguments, an empty list is returned if all backends should be run. If only certain backends should run, please pass a csv to the jvm as follows: -Dorg.nd4j.linalg.tests.backendstorun=your.class1,your.class2
 * @return the list of backends to run
 */
  public static List<String> backendsToRun(){
    List<String> ret=new ArrayList<>();
    String val=System.getProperty(BACKENDS_TO_LOAD,"");
    if (val.isEmpty())     return ret;
    String[] clazzes=val.split(",");
    for (    String s : clazzes)     ret.add(s);
    return ret;
  }
}
