/** 
 * @author Max Pumperla
 */
public class KerasSpatialDropout2DTest {
  String LAYER_NAME="spatial_dropout_2d";
  private final double RATE_KERAS=0.3;
  private final double RATE_DL4J=1 - RATE_KERAS;
  private Integer keras1=1;
  private Integer keras2=2;
  private Keras1LayerConfiguration conf1=new Keras1LayerConfiguration();
  private Keras2LayerConfiguration conf2=new Keras2LayerConfiguration();
  @Test public void testSpatialDropoutLayer() throws Exception {
    buildSpatialDropoutLayer(conf1,keras1);
    buildSpatialDropoutLayer(conf2,keras2);
  }
  private void buildSpatialDropoutLayer(  KerasLayerConfiguration conf,  Integer kerasVersion) throws Exception {
    Map<String,Object> layerConfig=new HashMap<>();
    layerConfig.put(conf.getLAYER_FIELD_CLASS_NAME(),conf.getLAYER_CLASS_NAME_SPATIAL_DROPOUT_2D());
    Map<String,Object> config=new HashMap<>();
    config.put(conf.getLAYER_FIELD_NAME(),LAYER_NAME);
    config.put(conf.getLAYER_FIELD_RATE(),RATE_KERAS);
    layerConfig.put(conf.getLAYER_FIELD_CONFIG(),config);
    layerConfig.put(conf.getLAYER_FIELD_KERAS_VERSION(),kerasVersion);
    DropoutLayer layer=new KerasSpatialDropout(layerConfig).getSpatialDropoutLayer();
    assertEquals(LAYER_NAME,layer.getLayerName());
    assertEquals(new SpatialDropout(RATE_DL4J),layer.getIDropout());
  }
}
