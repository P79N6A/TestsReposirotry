/** 
 * Created by Alex on 09/09/2016.
 */
public class CustomPreprocessorTest extends BaseDL4JTest {
  @Test public void testCustomPreprocessor(){
    MultiLayerConfiguration conf=new NeuralNetConfiguration.Builder().list().layer(0,new DenseLayer.Builder().nIn(10).nOut(10).build()).layer(1,new OutputLayer.Builder(LossFunctions.LossFunction.MCXENT).nIn(10).activation(Activation.SOFTMAX).nOut(10).build()).inputPreProcessor(0,new MyCustomPreprocessor()).build();
    String json=conf.toJson();
    String yaml=conf.toYaml();
    System.out.println(json);
    MultiLayerConfiguration confFromJson=MultiLayerConfiguration.fromJson(json);
    assertEquals(conf,confFromJson);
    MultiLayerConfiguration confFromYaml=MultiLayerConfiguration.fromYaml(yaml);
    assertEquals(conf,confFromYaml);
    assertTrue(confFromJson.getInputPreProcess(0) instanceof MyCustomPreprocessor);
  }
}
