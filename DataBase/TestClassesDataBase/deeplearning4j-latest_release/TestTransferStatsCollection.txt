/** 
 * Created by Alex on 07/04/2017.
 */
public class TestTransferStatsCollection {
  @Rule public TemporaryFolder testDir=new TemporaryFolder();
  @Test public void test() throws IOException {
    MultiLayerConfiguration conf=new NeuralNetConfiguration.Builder().list().layer(0,new DenseLayer.Builder().nIn(10).nOut(10).build()).layer(1,new OutputLayer.Builder().activation(Activation.SOFTMAX).nIn(10).nOut(10).build()).build();
    MultiLayerNetwork net=new MultiLayerNetwork(conf);
    net.init();
    MultiLayerNetwork net2=new TransferLearning.Builder(net).fineTuneConfiguration(new FineTuneConfiguration.Builder().updater(new Sgd(0.01)).build()).setFeatureExtractor(0).build();
    File f=testDir.newFile("dl4jTestTransferStatsCollection.bin");
    f.delete();
    net2.setListeners(new StatsListener(new FileStatsStorage(f)));
    net2.fit(new DataSet(Nd4j.rand(8,10),Nd4j.rand(8,10)));
    f.deleteOnExit();
  }
}
