/** 
 * Created by Alex on 19/05/2017.
 */
public class TestWritablesToStringFunctions {
  @Test public void testWritablesToString() throws Exception {
    List<Writable> l=Arrays.<Writable>asList(new DoubleWritable(1.5),new Text("someValue"));
    String expected=l.get(0).toString() + "," + l.get(1).toString();
    assertEquals(expected,new WritablesToStringFunction(",").apply(l));
  }
  @Test public void testSequenceWritablesToString() throws Exception {
    List<List<Writable>> l=Arrays.asList(Arrays.<Writable>asList(new DoubleWritable(1.5),new Text("someValue")),Arrays.<Writable>asList(new DoubleWritable(2.5),new Text("otherValue")));
    String expected=l.get(0).get(0).toString() + "," + l.get(0).get(1).toString()+ "\n"+ l.get(1).get(0).toString()+ ","+ l.get(1).get(1).toString();
    assertEquals(expected,new SequenceWritablesToStringFunction(",").apply(l));
  }
}
