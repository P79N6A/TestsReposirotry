public class PartitionerTests {
  @Test public void testRecordsPerFilePartition(){
    Partitioner partitioner=new NumberOfRecordsPartitioner();
    File tmpDir=Files.createTempDir();
    FileSplit fileSplit=new FileSplit(tmpDir);
    assertTrue(fileSplit.needsBootstrapForWrite());
    fileSplit.bootStrapForWrite();
    partitioner.init(fileSplit);
    assertEquals(1,partitioner.numPartitions());
  }
  @Test public void testInputAddFile() throws Exception {
    Partitioner partitioner=new NumberOfRecordsPartitioner();
    File tmpDir=Files.createTempDir();
    FileSplit fileSplit=new FileSplit(tmpDir);
    assertTrue(fileSplit.needsBootstrapForWrite());
    fileSplit.bootStrapForWrite();
    Configuration configuration=new Configuration();
    configuration.set(NumberOfRecordsPartitioner.RECORDS_PER_FILE_CONFIG,String.valueOf(5));
    partitioner.init(configuration,fileSplit);
    partitioner.updatePartitionInfo(PartitionMetaData.builder().numRecordsUpdated(5).build());
    assertTrue(partitioner.needsNewPartition());
    OutputStream os=partitioner.openNewStream();
    os.close();
    assertNotNull(os);
    partitioner.updatePartitionInfo(PartitionMetaData.builder().numRecordsUpdated(5).build());
    os=partitioner.openNewStream();
    os.close();
    assertNotNull(os);
  }
}
