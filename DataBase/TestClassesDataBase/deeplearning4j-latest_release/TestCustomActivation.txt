/** 
 * Created by Alex on 19/12/2016.
 */
public class TestCustomActivation extends BaseDL4JTest {
  @Test public void testCustomActivationFn(){
    MultiLayerConfiguration conf=new NeuralNetConfiguration.Builder().updater(new Sgd(0.1)).list().layer(0,new DenseLayer.Builder().nIn(10).nOut(10).activation(new CustomActivation()).build()).layer(1,new OutputLayer.Builder(LossFunctions.LossFunction.MCXENT).activation(Activation.SOFTMAX).nIn(10).nOut(10).build()).build();
    String json=conf.toJson();
    String yaml=conf.toYaml();
    System.out.println(json);
    MultiLayerConfiguration confFromJson=MultiLayerConfiguration.fromJson(json);
    assertEquals(conf,confFromJson);
    MultiLayerConfiguration confFromYaml=MultiLayerConfiguration.fromYaml(yaml);
    assertEquals(conf,confFromYaml);
  }
}
