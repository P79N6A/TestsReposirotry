/** 
 * Tests for new Spark Word2Vec implementation
 * @author raver119@gmail.com
 */
public class SparkWord2VecTest {
  private static List<String> sentences;
  private JavaSparkContext sc;
  @Before public void setUp() throws Exception {
    if (sentences == null) {
      sentences=new ArrayList<>();
      sentences.add("one two thee four");
      sentences.add("some once again");
      sentences.add("one another sentence");
    }
    SparkConf sparkConf=new SparkConf().setMaster("local[8]").setAppName("SeqVecTests");
    sc=new JavaSparkContext(sparkConf);
  }
  @After public void tearDown() throws Exception {
    sc.stop();
  }
  @Test public void testStringsTokenization1() throws Exception {
    JavaRDD<String> rddSentences=sc.parallelize(sentences);
    SparkWord2Vec word2Vec=new SparkWord2Vec();
    word2Vec.fitSentences(rddSentences);
    VocabCache<ShallowSequenceElement> vocabCache=word2Vec.getShallowVocabCache();
    assertNotEquals(null,vocabCache);
    assertEquals(9,vocabCache.numWords());
    assertEquals(2.0,vocabCache.wordFor(SequenceElement.getLongHash("one")).getElementFrequency(),1e-5);
    assertEquals(1.0,vocabCache.wordFor(SequenceElement.getLongHash("two")).getElementFrequency(),1e-5);
  }
}
