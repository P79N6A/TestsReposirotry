/** 
 * @author raver119@gmail.com
 */
public class VirtualDataSetIteratorTest {
  @Before public void setUp() throws Exception {
  }
  @Test public void testSimple1() throws Exception {
    List<Iterator<DataSet>> iterators=new ArrayList<>();
    List<DataSet> first=new ArrayList<>();
    List<DataSet> second=new ArrayList<>();
    for (int i=0; i < 100; i++) {
      INDArray features=Nd4j.create(100).assign(i);
      INDArray labels=Nd4j.create(10).assign(i);
      DataSet ds=new DataSet(features,labels);
      if (i < 25)       first.add(ds);
 else       second.add(ds);
    }
    iterators.add(first.iterator());
    iterators.add(second.iterator());
    VirtualDataSetIterator vdsi=new VirtualDataSetIterator(iterators);
    int cnt=0;
    while (vdsi.hasNext()) {
      DataSet ds=vdsi.next();
      assertEquals((double)cnt,ds.getFeatures().meanNumber().doubleValue(),0.0001);
      assertEquals((double)cnt,ds.getLabels().meanNumber().doubleValue(),0.0001);
      cnt++;
    }
    assertEquals(100,cnt);
  }
}
