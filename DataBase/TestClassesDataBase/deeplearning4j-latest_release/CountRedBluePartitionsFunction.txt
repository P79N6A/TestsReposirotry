class CountRedBluePartitionsFunction implements Function2<Integer,Iterator<String>,Iterator<Tuple2<Integer,Integer>>> {
  @Override public Iterator<Tuple2<Integer,Integer>> call(  Integer v1,  Iterator<String> v2) throws Exception {
    int redCount=0;
    int blueCount=0;
    while (v2.hasNext()) {
      String elem=v2.next();
      if (elem.equals("red"))       redCount++;
 else       blueCount++;
    }
    return Collections.singletonList(new Tuple2<>(redCount,blueCount)).iterator();
  }
}
