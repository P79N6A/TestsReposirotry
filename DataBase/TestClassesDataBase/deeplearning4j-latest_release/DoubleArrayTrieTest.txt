public class DoubleArrayTrieTest {
  @Test public void testSparseTrie() throws IOException {
    testSimpleTrie(false);
  }
  @Test public void testCompactTrie() throws IOException {
    testSimpleTrie(false);
  }
  private void testSimpleTrie(  boolean compact) throws IOException {
    Trie trie=makeTrie();
    File costsFile=File.createTempFile("kuromoji-doublearraytrie-",".bin");
    costsFile.deleteOnExit();
    DoubleArrayTrie doubleArrayTrie=new DoubleArrayTrie(compact);
    doubleArrayTrie.build(trie);
    OutputStream output=new FileOutputStream(costsFile);
    doubleArrayTrie.write(output);
    output.close();
    doubleArrayTrie=DoubleArrayTrie.read(new FileInputStream(costsFile));
    assertEquals(0,doubleArrayTrie.lookup("a"));
    assertTrue(doubleArrayTrie.lookup("abc") > 0);
    assertTrue(doubleArrayTrie.lookup("あいう") > 0);
    assertTrue(doubleArrayTrie.lookup("xyz") < 0);
  }
  private Trie makeTrie(){
    Trie trie=new Trie();
    trie.add("abc");
    trie.add("abd");
    trie.add("あああ");
    trie.add("あいう");
    return trie;
  }
}
