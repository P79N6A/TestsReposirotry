public class WordVectorsImplTest {
  private VocabCache vocabCache;
  private WeightLookupTable weightLookupTable;
  private WordVectorsImpl<SequenceElement> wordVectors;
  @Before public void init() throws Exception {
    vocabCache=Mockito.mock(VocabCache.class);
    weightLookupTable=Mockito.mock(WeightLookupTable.class);
    wordVectors=new WordVectorsImpl<>();
  }
  @Test public void getWordVectors_HaveTwoWordsNotInVocabAndOneIn_ExpectAllNonWordsRemoved(){
    INDArray wordVector=Nd4j.create(1,1);
    wordVector.putScalar(0,5);
    when(vocabCache.indexOf("word")).thenReturn(0);
    when(vocabCache.containsWord("word")).thenReturn(true);
    when(weightLookupTable.getWeights()).thenReturn(wordVector);
    wordVectors.setVocab(vocabCache);
    wordVectors.setLookupTable(weightLookupTable);
    INDArray indArray=wordVectors.getWordVectors(Lists.newArrayList("word","here","is"));
    assertEquals(wordVector,indArray);
  }
}
