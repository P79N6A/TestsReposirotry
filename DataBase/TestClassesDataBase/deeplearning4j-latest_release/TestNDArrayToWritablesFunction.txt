/** 
 * Unit tests for NDArrayToWritablesFunction.
 * @author dave@skymind.io
 */
public class TestNDArrayToWritablesFunction {
  @Test public void testNDArrayToWritablesScalars() throws Exception {
    INDArray arr=Nd4j.arange(5);
    List<Writable> expected=new ArrayList<>();
    for (int i=0; i < 5; i++)     expected.add(new DoubleWritable(i));
    List<Writable> actual=new NDArrayToWritablesFunction().apply(arr);
    assertEquals(expected,actual);
  }
  @Test public void testNDArrayToWritablesArray() throws Exception {
    INDArray arr=Nd4j.arange(5);
    List<Writable> expected=Arrays.asList((Writable)new NDArrayWritable(arr));
    List<Writable> actual=new NDArrayToWritablesFunction(true).apply(arr);
    assertEquals(expected,actual);
  }
}
