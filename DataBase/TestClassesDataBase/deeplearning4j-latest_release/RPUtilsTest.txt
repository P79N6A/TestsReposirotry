public class RPUtilsTest {
  @Test public void testDistanceComputeBatch(){
    INDArray x=Nd4j.linspace(1,4,4);
    INDArray y=Nd4j.linspace(1,16,16).reshape(4,4);
    INDArray result=Nd4j.create(4);
    INDArray distances=RPUtils.computeDistanceMulti("euclidean",x,y,result);
    INDArray scalarResult=Nd4j.scalar(1.0);
    for (int i=0; i < result.length(); i++) {
      double dist=RPUtils.computeDistance("euclidean",x,y.slice(i),scalarResult);
      assertEquals(dist,distances.getDouble(i),1e-3);
    }
  }
}
