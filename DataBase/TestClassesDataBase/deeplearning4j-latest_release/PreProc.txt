@AllArgsConstructor public static class PreProc implements DataSetPreProcessor {
  protected ROCScoreFunction.ROCType rocType;
  @Override public void preProcess(  DataSet toPreProcess){
switch (rocType) {
case ROC:
      long mb=toPreProcess.getLabels().size(0);
    INDArray argMax=Nd4j.argMax(toPreProcess.getLabels(),1);
  INDArray newLabel=Nd4j.create(mb,2);
for (int i=0; i < mb; i++) {
  int idx=(int)argMax.getDouble(i,0);
  newLabel.putScalar(i,(idx < 5 ? 0 : 1),1.0);
}
toPreProcess.setLabels(newLabel);
break;
case BINARY:
case MULTICLASS:
break;
default :
throw new RuntimeException();
}
}
}
