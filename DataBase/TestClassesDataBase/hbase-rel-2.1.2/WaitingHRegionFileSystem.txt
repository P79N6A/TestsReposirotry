private class WaitingHRegionFileSystem extends HRegionFileSystem {
  public WaitingHRegionFileSystem(  final Configuration conf,  final FileSystem fs,  final Path tableDir,  final RegionInfo regionInfo){
    super(conf,fs,tableDir,regionInfo);
  }
  @Override public void removeStoreFiles(  String familyName,  Collection<HStoreFile> storeFiles) throws IOException {
    super.removeStoreFiles(familyName,storeFiles);
    archived.set(true);
synchronized (archived) {
      archived.notifyAll();
    }
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException ie) {
      throw new InterruptedIOException("Interrupted waiting for latch");
    }
  }
}
