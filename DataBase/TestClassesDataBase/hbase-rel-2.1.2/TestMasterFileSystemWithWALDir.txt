/** 
 * Test the master filesystem in a local cluster
 */
@Category({MasterTests.class,MediumTests.class}) public class TestMasterFileSystemWithWALDir {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestMasterFileSystemWithWALDir.class);
  private static final HBaseTestingUtility UTIL=new HBaseTestingUtility();
  @BeforeClass public static void setupTest() throws Exception {
    UTIL.startMiniCluster(true);
  }
  @AfterClass public static void teardownTest() throws Exception {
    UTIL.shutdownMiniCluster();
  }
  @Test public void testFsUriSetProperly() throws Exception {
    HMaster master=UTIL.getMiniHBaseCluster().getMaster();
    MasterFileSystem fs=master.getMasterFileSystem();
    Path masterRoot=FSUtils.getRootDir(fs.getConfiguration());
    Path rootDir=FSUtils.getRootDir(fs.getFileSystem().getConf());
    assertEquals(masterRoot,rootDir);
    assertEquals(FSUtils.getWALRootDir(UTIL.getConfiguration()),fs.getWALRootDir());
  }
}
