@Category({RegionServerTests.class,MediumTests.class}) public class TestWALReplay extends AbstractTestWALReplay {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestWALReplay.class);
  @BeforeClass public static void setUpBeforeClass() throws Exception {
    Configuration conf=AbstractTestWALReplay.TEST_UTIL.getConfiguration();
    conf.set(WALFactory.WAL_PROVIDER,"filesystem");
    AbstractTestWALReplay.setUpBeforeClass();
  }
  @Override protected WAL createWAL(  Configuration c,  Path hbaseRootDir,  String logName) throws IOException {
    FSHLog wal=new FSHLog(FileSystem.get(c),hbaseRootDir,logName,c);
    HBaseTestingUtility.setMaxRecoveryErrorCount(wal.getOutputStream(),1);
    return wal;
  }
}
