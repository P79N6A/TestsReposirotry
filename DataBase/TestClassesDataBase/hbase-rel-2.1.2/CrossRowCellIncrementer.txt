/** 
 * Increments a random row's Cell <code>count</code> times.
 */
private static class CrossRowCellIncrementer extends Thread {
  private final int count;
  private final HRegion region;
  private final Increment[] increments;
  CrossRowCellIncrementer(  final int i,  final int count,  final HRegion region,  final int range){
    super("" + i);
    setDaemon(true);
    this.count=count;
    this.region=region;
    this.increments=new Increment[range];
    for (int ii=0; ii < range; ii++) {
      this.increments[ii]=new Increment(Bytes.toBytes(i));
      this.increments[ii].addColumn(INCREMENT_BYTES,INCREMENT_BYTES,1);
    }
  }
  @Override public void run(){
    for (int i=0; i < this.count; i++) {
      try {
        int index=ThreadLocalRandom.current().nextInt(0,this.increments.length);
        this.region.increment(this.increments[index]);
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
}
