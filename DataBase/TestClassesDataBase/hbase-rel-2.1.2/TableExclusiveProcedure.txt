public static class TableExclusiveProcedure extends NoopProcedure<TestEnv> implements TableProcedureInterface {
  private final Semaphore latch=new Semaphore(0);
  @Override protected Procedure<TestEnv>[] execute(  TestEnv env) throws ProcedureYieldException, ProcedureSuspendedException, InterruptedException {
    latch.acquire();
    return null;
  }
  @Override protected LockState acquireLock(  TestEnv env){
    if (env.getScheduler().waitTableExclusiveLock(this,getTableName())) {
      return LockState.LOCK_EVENT_WAIT;
    }
    return LockState.LOCK_ACQUIRED;
  }
  @Override protected void releaseLock(  TestEnv env){
    env.getScheduler().wakeTableExclusiveLock(this,getTableName());
  }
  @Override protected boolean holdLock(  TestEnv env){
    return true;
  }
  @Override public TableName getTableName(){
    return TABLE_NAME;
  }
  @Override public TableOperationType getTableOperationType(){
    return TableOperationType.EDIT;
  }
}
