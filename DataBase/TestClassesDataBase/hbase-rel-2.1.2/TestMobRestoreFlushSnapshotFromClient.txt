/** 
 * Test clone/restore snapshots from the client TODO This is essentially a clone of TestRestoreSnapshotFromClient.  This is worth refactoring this because there will be a few more flavors of snapshots that need to run these tests.
 */
@Category({ClientTests.class,LargeTests.class}) public class TestMobRestoreFlushSnapshotFromClient extends TestRestoreFlushSnapshotFromClient {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestMobRestoreFlushSnapshotFromClient.class);
  final Logger LOG=LoggerFactory.getLogger(getClass());
  @BeforeClass public static void setupCluster() throws Exception {
    setupConf(UTIL.getConfiguration());
    UTIL.startMiniCluster(3);
  }
  protected static void setupConf(  Configuration conf){
    TestRestoreFlushSnapshotFromClient.setupConf(conf);
    UTIL.getConfiguration().setInt(MobConstants.MOB_FILE_CACHE_SIZE_KEY,0);
  }
  @Override protected void createTable() throws Exception {
    MobSnapshotTestingUtils.createMobTable(UTIL,tableName,1,FAMILY);
  }
  @Override protected void verifyRowCount(  final HBaseTestingUtility util,  final TableName tableName,  long expectedRows) throws IOException {
    MobSnapshotTestingUtils.verifyMobRowCount(util,tableName,expectedRows);
  }
  @Override protected int countRows(  final Table table,  final byte[]... families) throws IOException {
    return MobSnapshotTestingUtils.countMobRows(table,families);
  }
}
