@Category({MediumTests.class}) public class TestChangeSplitPolicyAction extends Action {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestChangeSplitPolicyAction.class);
  private final static IntegrationTestingUtility TEST_UTIL=new IntegrationTestingUtility();
  private static ChangeSplitPolicyAction action;
  private Admin admin;
  private TableName tableName=TableName.valueOf("ChangeSplitPolicyAction");
  @BeforeClass public static void setUpBeforeClass() throws Exception {
    TEST_UTIL.startMiniCluster(2);
  }
  @AfterClass public static void tearDownAfterClass() throws Exception {
    TEST_UTIL.shutdownMiniCluster();
  }
  @Before public void setUp() throws Exception {
    this.admin=TEST_UTIL.getAdmin();
    TableDescriptorBuilder builder=TableDescriptorBuilder.newBuilder(tableName);
    admin.createTable(builder.setColumnFamily(ColumnFamilyDescriptorBuilder.of("fam")).build());
  }
  @Test public void testChangeSplitPolicyAction() throws Exception {
    ActionContext ctx=Mockito.mock(ActionContext.class);
    Mockito.when(ctx.getHBaseIntegrationTestingUtility()).thenReturn(TEST_UTIL);
    Mockito.when(ctx.getHBaseCluster()).thenReturn(TEST_UTIL.getHBaseCluster());
    action=new ChangeSplitPolicyAction(tableName);
    action.init(ctx);
    action.perform();
  }
}
