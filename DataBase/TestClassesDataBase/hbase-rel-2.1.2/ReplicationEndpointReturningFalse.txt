public static class ReplicationEndpointReturningFalse extends ReplicationEndpointForTest {
  static int COUNT=10;
  static AtomicReference<Exception> ex=new AtomicReference<>(null);
  static AtomicBoolean replicated=new AtomicBoolean(false);
  @Override public boolean replicate(  ReplicateContext replicateContext){
    try {
      doAssert(row);
    }
 catch (    Exception e) {
      ex.set(e);
    }
    super.replicate(replicateContext);
    LOG.info("Replicated " + Bytes.toString(row) + ", count="+ replicateCount.get());
    replicated.set(replicateCount.get() > COUNT);
    return replicated.get();
  }
}
