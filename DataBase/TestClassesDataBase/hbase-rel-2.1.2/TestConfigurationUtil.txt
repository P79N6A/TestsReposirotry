@Category({SmallTests.class}) public class TestConfigurationUtil {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestConfigurationUtil.class);
  private Configuration conf;
  private Map<String,String> keyValues;
  private String key;
  @Before public void setUp() throws Exception {
    this.conf=new Configuration();
    this.keyValues=ImmutableMap.of("k1","v1","k2","v2");
    this.key="my_conf_key";
  }
  public void callSetKeyValues(){
    ConfigurationUtil.setKeyValues(conf,key,keyValues.entrySet());
  }
  public List<Map.Entry<String,String>> callGetKeyValues(){
    return ConfigurationUtil.getKeyValues(conf,key);
  }
  @Test public void testGetAndSetKeyValuesWithValues() throws Exception {
    callSetKeyValues();
    assertEquals(Lists.newArrayList(this.keyValues.entrySet()),callGetKeyValues());
  }
  @Test public void testGetKeyValuesWithUnsetKey() throws Exception {
    assertNull(callGetKeyValues());
  }
}
