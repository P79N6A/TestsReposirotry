/** 
 * The customized Distributed File System Implementation
 */
static class FaultyDistributedFileSystem extends DistributedFileSystem {
  private volatile boolean throwException=false;
  public FaultyDistributedFileSystem(){
    super();
  }
  public void setThrowException(  boolean throwException){
    this.throwException=throwException;
  }
  @Override public boolean rename(  Path src,  Path dst) throws IOException {
    if (throwException) {
      throw new IOException("No more files allowed");
    }
    return super.rename(src,dst);
  }
}
