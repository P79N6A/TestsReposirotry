/** 
 * Custom reversed KV Heap that can be configured to sleep in between retrievals of column family cells.
 */
private static final class HeartbeatReversedKVHeap extends ReversedKeyValueHeap {
  public HeartbeatReversedKVHeap(  List<? extends KeyValueScanner> scanners,  CellComparatorImpl comparator) throws IOException {
    super(scanners,comparator);
  }
  @Override public boolean next(  List<Cell> result,  ScannerContext context) throws IOException {
    if (HeartbeatHRegion.sleepBeforeColumnFamily)     HeartbeatHRegion.columnFamilySleep();
    boolean moreRows=super.next(result,context);
    if (!HeartbeatHRegion.sleepBeforeColumnFamily)     HeartbeatHRegion.columnFamilySleep();
    return moreRows;
  }
}
