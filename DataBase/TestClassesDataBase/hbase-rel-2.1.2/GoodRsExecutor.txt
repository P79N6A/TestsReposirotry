private class GoodRsExecutor extends NoopRsExecutor {
  @Override protected RegionOpeningState execOpenRegion(  ServerName server,  RegionOpenInfo openReq) throws IOException {
    sendTransitionReport(server,openReq.getRegion(),TransitionCode.OPENED);
    SortedSet<byte[]> regions=regionsToRegionServers.get(server);
    if (regions == null) {
      regions=new ConcurrentSkipListSet<byte[]>(Bytes.BYTES_COMPARATOR);
      regionsToRegionServers.put(server,regions);
    }
    RegionInfo hri=ProtobufUtil.toRegionInfo(openReq.getRegion());
    if (regions.contains(hri.getRegionName())) {
      throw new UnsupportedOperationException(hri.getRegionNameAsString());
    }
    regions.add(hri.getRegionName());
    return RegionOpeningState.OPENED;
  }
  @Override protected CloseRegionResponse execCloseRegion(  ServerName server,  byte[] regionName) throws IOException {
    RegionInfo hri=am.getRegionInfo(regionName);
    sendTransitionReport(server,ProtobufUtil.toRegionInfo(hri),TransitionCode.CLOSED);
    return CloseRegionResponse.newBuilder().setClosed(true).build();
  }
}
