public static class BlockCompactionsInCompletionHStore extends HStore {
  CompactionBlockerRegion r;
  protected BlockCompactionsInCompletionHStore(  HRegion region,  ColumnFamilyDescriptor family,  Configuration confParam) throws IOException {
    super(region,family,confParam);
    r=(CompactionBlockerRegion)region;
  }
  @Override protected void completeCompaction(  Collection<HStoreFile> compactedFiles) throws IOException {
    try {
      r.compactionsWaiting.countDown();
      r.compactionsBlocked.await();
    }
 catch (    InterruptedException ex) {
      throw new IOException(ex);
    }
    super.completeCompaction(compactedFiles);
  }
}
