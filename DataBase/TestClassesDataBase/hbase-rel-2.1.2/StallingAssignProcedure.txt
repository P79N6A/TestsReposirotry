/** 
 * An AssignProcedure that Stalls just before the finish.
 */
public static class StallingAssignProcedure extends AssignProcedure {
  public final CountDownLatch latch=new CountDownLatch(2);
  public StallingAssignProcedure(){
    super();
  }
  public StallingAssignProcedure(  RegionInfo regionInfo){
    super(regionInfo);
  }
  @Override void setTransitionState(  MasterProcedureProtos.RegionTransitionState state){
    if (state == MasterProcedureProtos.RegionTransitionState.REGION_TRANSITION_DISPATCH) {
      try {
        LOG.info("LATCH2 {}",this.latch.getCount());
        this.latch.await();
        LOG.info("LATCH3 {}",this.latch.getCount());
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
 else     if (state == MasterProcedureProtos.RegionTransitionState.REGION_TRANSITION_QUEUE) {
      LOG.info("LATCH1 {}",this.latch.getCount());
      this.latch.countDown();
    }
    super.setTransitionState(state);
  }
}
