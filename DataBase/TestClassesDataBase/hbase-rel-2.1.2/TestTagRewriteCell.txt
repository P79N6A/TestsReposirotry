@Category(SmallTests.class) public class TestTagRewriteCell {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestTagRewriteCell.class);
  @Test public void testHeapSize(){
    Cell originalCell=CellUtil.createCell(Bytes.toBytes("row"),Bytes.toBytes("value"));
    final int fakeTagArrayLength=10;
    Cell trCell=PrivateCellUtil.createCell(originalCell,new byte[fakeTagArrayLength]);
    long trCellHeapSize=((HeapSize)trCell).heapSize();
    Cell trCell2=PrivateCellUtil.createCell(trCell,new byte[fakeTagArrayLength]);
    assertTrue("TagRewriteCell containing a TagRewriteCell's heapsize should be " + "larger than a single TagRewriteCell's heapsize",trCellHeapSize < ((HeapSize)trCell2).heapSize());
    assertTrue("TagRewriteCell should have had nulled out tags array",((HeapSize)trCell).heapSize() < trCellHeapSize);
  }
}
