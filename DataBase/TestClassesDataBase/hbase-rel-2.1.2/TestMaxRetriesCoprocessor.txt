public static class TestMaxRetriesCoprocessor implements MasterCoprocessor, MasterObserver {
  AtomicLong retryNum=new AtomicLong(0);
  public TestMaxRetriesCoprocessor(){
  }
  @Override public Optional<MasterObserver> getMasterObserver(){
    return Optional.of(this);
  }
  @Override public void preGetNamespaceDescriptor(  ObserverContext<MasterCoprocessorEnvironment> ctx,  String namespace) throws IOException {
    if (retryNum.getAndIncrement() < DEFAULT_RETRIES_NUMBER) {
      throw new IOException("call fail");
    }
  }
}
