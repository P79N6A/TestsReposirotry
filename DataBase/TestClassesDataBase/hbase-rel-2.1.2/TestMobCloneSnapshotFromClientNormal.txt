@Category({LargeTests.class,ClientTests.class}) public class TestMobCloneSnapshotFromClientNormal extends CloneSnapshotFromClientNormalTestBase {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestMobCloneSnapshotFromClientNormal.class);
  protected static void setupConfiguration(){
    CloneSnapshotFromClientTestBase.setupConfiguration();
    TEST_UTIL.getConfiguration().setLong(TimeToLiveHFileCleaner.TTL_CONF_KEY,0);
    TEST_UTIL.getConfiguration().setInt(MobConstants.MOB_FILE_CACHE_SIZE_KEY,0);
  }
  @BeforeClass public static void setUpBeforeClass() throws Exception {
    setupConfiguration();
    TEST_UTIL.startMiniCluster(3);
  }
  @Override protected void createTable() throws IOException, InterruptedException {
    MobSnapshotTestingUtils.createMobTable(TEST_UTIL,tableName,SnapshotTestingUtils.getSplitKeys(),getNumReplicas(),FAMILY);
  }
  @Override protected int numRowsToLoad(){
    return 20;
  }
  @Override protected int countRows(  Table table) throws IOException {
    return MobSnapshotTestingUtils.countMobRows(table);
  }
  @Override protected void verifyRowCount(  final HBaseTestingUtility util,  final TableName tableName,  long expectedRows) throws IOException {
    MobSnapshotTestingUtils.verifyMobRowCount(util,tableName,expectedRows);
  }
}
