/** 
 * Test the master filesystem in a local cluster
 */
@Category({MasterTests.class,MediumTests.class}) public class TestMasterFileSystem {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestMasterFileSystem.class);
  private static final Logger LOG=LoggerFactory.getLogger(TestMasterFileSystem.class);
  private static final HBaseTestingUtility UTIL=new HBaseTestingUtility();
  @BeforeClass public static void setupTest() throws Exception {
    UTIL.startMiniCluster();
  }
  @AfterClass public static void teardownTest() throws Exception {
    UTIL.shutdownMiniCluster();
  }
  @Test public void testFsUriSetProperly() throws Exception {
    HMaster master=UTIL.getMiniHBaseCluster().getMaster();
    MasterFileSystem fs=master.getMasterFileSystem();
    Path masterRoot=FSUtils.getRootDir(fs.getConfiguration());
    Path rootDir=FSUtils.getRootDir(fs.getFileSystem().getConf());
    LOG.debug("from fs uri:" + FileSystem.getDefaultUri(fs.getFileSystem().getConf()));
    LOG.debug("from configuration uri:" + FileSystem.getDefaultUri(fs.getConfiguration()));
    assertEquals(masterRoot,rootDir);
  }
}
