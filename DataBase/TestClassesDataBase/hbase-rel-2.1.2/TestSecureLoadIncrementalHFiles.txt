/** 
 * Reruns TestLoadIncrementalHFiles using LoadIncrementalHFiles in secure mode. This suite is unable to verify the security handoff/turnover as miniCluster is running as system user thus has root privileges and delegation tokens don't seem to work on miniDFS. <p> Thus SecureBulkload can only be completely verified by running integration tests against a secure cluster. This suite is still invaluable as it verifies the other mechanisms that need to be supported as part of a LoadIncrementalFiles call.
 */
@Category({MiscTests.class,LargeTests.class}) public class TestSecureLoadIncrementalHFiles extends TestLoadIncrementalHFiles {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestSecureLoadIncrementalHFiles.class);
  @BeforeClass public static void setUpBeforeClass() throws Exception {
    UserProvider.setUserProviderForTesting(util.getConfiguration(),HadoopSecurityEnabledUserProviderForTesting.class);
    SecureTestUtil.enableSecurity(util.getConfiguration());
    util.getConfiguration().setInt(LoadIncrementalHFiles.MAX_FILES_PER_REGION_PER_FAMILY,MAX_FILES_PER_REGION_PER_FAMILY);
    util.getConfiguration().set(HConstants.RPC_CODEC_CONF_KEY,KeyValueCodecWithTags.class.getCanonicalName());
    util.startMiniCluster();
    util.waitTableEnabled(AccessControlLists.ACL_TABLE_NAME);
    setupNamespace();
  }
}
