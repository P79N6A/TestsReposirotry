/** 
 * This is an integration test for showing a simple usage of how to use  {@link Monkeys}to control  {@link ChaosMonkeyRunner}.
 */
@Category(IntegrationTests.class) public class IntegrationTestMonkeys extends ChaosMonkeyRunner {
  private static final int RUN_SECS=15 * 1000;
  private static final int WAIT_SECS=10 * 1000;
  @Override protected int doWork() throws Exception {
    super.setUpCluster();
    runMonkeys();
    return 0;
  }
  @Test public void runMonkeys() throws Exception {
    try (Monkeys monkeys=new Monkeys()){
      for (int i=0; i < 2; i++) {
        monkeys.startChaos();
        Thread.sleep(RUN_SECS);
        monkeys.stopChaos();
        Thread.sleep(WAIT_SECS);
      }
    }
   }
  public static void main(  String[] args) throws Exception {
    Configuration conf=HBaseConfiguration.create();
    IntegrationTestingUtility.setUseDistributedCluster(conf);
    int exitCode=ToolRunner.run(conf,new IntegrationTestMonkeys(),args);
    System.exit(exitCode);
  }
}
