/** 
 * Custom KV Heap that can be configured to sleep/wait in between retrievals of column family cells. Useful for testing
 */
private static final class HeartbeatKVHeap extends KeyValueHeap {
  public HeartbeatKVHeap(  List<? extends KeyValueScanner> scanners,  CellComparator comparator) throws IOException {
    super(scanners,comparator);
  }
  HeartbeatKVHeap(  List<? extends KeyValueScanner> scanners,  KVScannerComparator comparator) throws IOException {
    super(scanners,comparator);
  }
  @Override public boolean next(  List<Cell> result,  ScannerContext context) throws IOException {
    if (HeartbeatHRegion.sleepBeforeColumnFamily)     HeartbeatHRegion.columnFamilySleep();
    boolean moreRows=super.next(result,context);
    if (!HeartbeatHRegion.sleepBeforeColumnFamily)     HeartbeatHRegion.columnFamilySleep();
    return moreRows;
  }
}
