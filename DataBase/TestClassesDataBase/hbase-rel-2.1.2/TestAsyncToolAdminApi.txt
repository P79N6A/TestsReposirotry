/** 
 * Test the admin operations for Balancer, Normalizer, CleanerChore, and CatalogJanitor.
 */
@RunWith(Parameterized.class) @Category({MediumTests.class,ClientTests.class}) public class TestAsyncToolAdminApi extends TestAsyncAdminBase {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestAsyncToolAdminApi.class);
  @Test public void testBalancer() throws Exception {
    boolean initialState=admin.isBalancerEnabled().get();
    boolean prevState=admin.balancerSwitch(!initialState).get();
    assertEquals(initialState,prevState);
    assertEquals(!initialState,admin.isBalancerEnabled().get());
    prevState=admin.balancerSwitch(initialState).get();
    assertEquals(!initialState,prevState);
    assertEquals(initialState,admin.isBalancerEnabled().get());
  }
  @Test public void testNormalizer() throws Exception {
    boolean initialState=admin.isNormalizerEnabled().get();
    boolean prevState=admin.normalizerSwitch(!initialState).get();
    assertEquals(initialState,prevState);
    assertEquals(!initialState,admin.isNormalizerEnabled().get());
    prevState=admin.normalizerSwitch(initialState).get();
    assertEquals(!initialState,prevState);
    assertEquals(initialState,admin.isNormalizerEnabled().get());
  }
  @Test public void testCleanerChore() throws Exception {
    boolean initialState=admin.isCleanerChoreEnabled().get();
    boolean prevState=admin.cleanerChoreSwitch(!initialState).get();
    assertEquals(initialState,prevState);
    assertEquals(!initialState,admin.isCleanerChoreEnabled().get());
    prevState=admin.cleanerChoreSwitch(initialState).get();
    assertEquals(!initialState,prevState);
    assertEquals(initialState,admin.isCleanerChoreEnabled().get());
  }
  @Test public void testCatalogJanitor() throws Exception {
    boolean initialState=admin.isCatalogJanitorEnabled().get();
    boolean prevState=admin.catalogJanitorSwitch(!initialState).get();
    assertEquals(initialState,prevState);
    assertEquals(!initialState,admin.isCatalogJanitorEnabled().get());
    prevState=admin.catalogJanitorSwitch(initialState).get();
    assertEquals(!initialState,prevState);
    assertEquals(initialState,admin.isCatalogJanitorEnabled().get());
  }
}
