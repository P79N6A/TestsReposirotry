@Category({MiscTests.class,SmallTests.class}) public class TestThrottledInputStream {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestThrottledInputStream.class);
  @Test public void testCalSleepTimeMs(){
    assertEquals(0,ThrottledInputStream.calSleepTimeMs(0,10000,1000));
    assertEquals(0,ThrottledInputStream.calSleepTimeMs(Long.MAX_VALUE,0,1000));
    assertEquals(0,ThrottledInputStream.calSleepTimeMs(Long.MAX_VALUE,-1,1000));
    assertEquals(1500,ThrottledInputStream.calSleepTimeMs(5,2,1000));
    assertEquals(500,ThrottledInputStream.calSleepTimeMs(5,2,2000));
    assertEquals(6500,ThrottledInputStream.calSleepTimeMs(15,2,1000));
    assertEquals(0,ThrottledInputStream.calSleepTimeMs(1,2,1000));
    assertEquals(0,ThrottledInputStream.calSleepTimeMs(2,2,2000));
    assertEquals(0,ThrottledInputStream.calSleepTimeMs(1,2,1000));
  }
}
