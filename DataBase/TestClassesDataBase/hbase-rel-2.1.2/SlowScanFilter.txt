/** 
 * Filter which makes sleeps for a second between each row of a scan. This can be useful for manual testing of bugs like HBASE-5973. For example: <code> create 't1', 'f1' 1.upto(100)  { |x| put 't1', 'r' + x.to_s, 'f1:q1', 'hi' } import org.apache.hadoop.hbase.filter.TestFilter scan 't1', { FILTER => TestFilter::SlowScanFilter.new(), CACHE => 50 } </code>
 */
public static class SlowScanFilter extends FilterBase {
  private static Thread ipcHandlerThread=null;
  @Override public byte[] toByteArray(){
    return null;
  }
  @Override public ReturnCode filterCell(  final Cell ignored) throws IOException {
    return ReturnCode.INCLUDE;
  }
  @Override public boolean filterRow() throws IOException {
    ipcHandlerThread=Thread.currentThread();
    try {
      LOG.info("Handler thread " + ipcHandlerThread + " sleeping in filter...");
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      Throwables.propagate(e);
    }
    return super.filterRow();
  }
}
