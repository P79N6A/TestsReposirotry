private static final class CompactorInternalScanner extends DelegatingInternalScanner {
  public CompactorInternalScanner(  InternalScanner scanner){
    super(scanner);
  }
  @Override public boolean next(  List<Cell> result,  ScannerContext scannerContext) throws IOException {
    boolean next=scanner.next(result,scannerContext);
    for (    Cell cell : result) {
      if (CellComparatorImpl.COMPARATOR.compareRows(cell,ROW2,0,ROW2.length) == 0) {
        try {
          doScan.compareAndSet(false,true);
          compactReadLatch.await();
        }
 catch (        InterruptedException e) {
        }
      }
    }
    return next;
  }
}
