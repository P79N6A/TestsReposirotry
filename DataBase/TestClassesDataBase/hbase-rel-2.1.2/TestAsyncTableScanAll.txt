@RunWith(Parameterized.class) @Category({MediumTests.class,ClientTests.class}) public class TestAsyncTableScanAll extends AbstractTestAsyncTableScan {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestAsyncTableScanAll.class);
  @Parameter(0) public String tableType;
  @Parameter(1) public Supplier<AsyncTable<?>> getTable;
  @Parameter(2) public String scanType;
  @Parameter(3) public Supplier<Scan> scanCreator;
  @Parameters(name="{index}: table={0}, scan={2}") public static List<Object[]> params(){
    return getTableAndScanCreatorParams();
  }
  @Override protected Scan createScan(){
    return scanCreator.get();
  }
  @Override protected List<Result> doScan(  Scan scan) throws Exception {
    List<Result> results=getTable.get().scanAll(scan).get();
    if (scan.getBatch() > 0) {
      results=convertFromBatchResult(results);
    }
    return results;
  }
}
