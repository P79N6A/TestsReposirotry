public static class TestFaultyRollback extends SequentialProcedure<Void> {
  private int retries=0;
  public TestFaultyRollback(){
  }
  @Override protected Procedure<Void>[] execute(  Void env){
    setFailure("faulty-rollback-test",new TestProcedureException("test faulty rollback"));
    return null;
  }
  @Override protected void rollback(  Void env) throws IOException {
    if (++retries < 3) {
      LOG.info("inject rollback failure " + retries);
      throw new IOException("injected failure number " + retries);
    }
    LOG.info("execute non faulty rollback step retries=" + retries);
  }
  @Override protected boolean abort(  Void env){
    return false;
  }
}
