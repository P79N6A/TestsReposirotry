/** 
 * Tests to make sure that the default environment edge conforms to appropriate behaviour.
 */
@Category({MiscTests.class,MediumTests.class}) public class TestDefaultEnvironmentEdge {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestDefaultEnvironmentEdge.class);
  @Test public void testGetCurrentTimeUsesSystemClock(){
    DefaultEnvironmentEdge edge=new DefaultEnvironmentEdge();
    long systemTime=System.currentTimeMillis();
    long edgeTime=edge.currentTime();
    assertTrue("System time must be either the same or less than the edge time",systemTime < edgeTime || systemTime == edgeTime);
    try {
      Thread.sleep(1);
    }
 catch (    InterruptedException e) {
      fail(e.getMessage());
    }
    long secondEdgeTime=edge.currentTime();
    assertTrue("Second time must be greater than the first",secondEdgeTime > edgeTime);
  }
}
