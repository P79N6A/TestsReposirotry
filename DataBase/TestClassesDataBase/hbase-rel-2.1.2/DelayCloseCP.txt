public static class DelayCloseCP implements RegionCoprocessor, RegionObserver {
  @Override public void preClose(  ObserverContext<RegionCoprocessorEnvironment> c,  boolean abortRequested) throws IOException {
    try {
      if (!c.getEnvironment().getRegion().getRegionInfo().getTable().isSystemTable()) {
        LOG.error("begin to sleep");
        countDownLatch.countDown();
        Thread.sleep(10000);
        LOG.error("finish sleep");
      }
    }
 catch (    Throwable t) {
    }
  }
  @Override public Optional<RegionObserver> getRegionObserver(){
    return Optional.of(this);
  }
}
