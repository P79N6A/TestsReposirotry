public static class ScanRegionCoprocessor implements RegionCoprocessor, RegionObserver {
  @Override public Optional<RegionObserver> getRegionObserver(){
    return Optional.of(this);
  }
  @Override public void postOpen(  ObserverContext<RegionCoprocessorEnvironment> c){
    RegionCoprocessorEnvironment env=c.getEnvironment();
    Region region=env.getRegion();
    try {
      putData(region);
      RegionScanner scanner=region.getScanner(new Scan());
      List<Cell> result=new LinkedList<>();
      while (scanner.next(result)) {
        result.clear();
      }
    }
 catch (    Exception e) {
      LOG.warn("Got exception in coprocessor",e);
    }
  }
  private void putData(  Region region) throws Exception {
    Put put=new Put(ROW1);
    put.addColumn(CF1,COL1,VAL1);
    region.put(put);
    put=new Put(ROW2);
    put.addColumn(CF1,COL1,VAL1);
    region.put(put);
    put=new Put(ROW3);
    put.addColumn(CF1,COL1,VAL1);
    region.put(put);
  }
}
