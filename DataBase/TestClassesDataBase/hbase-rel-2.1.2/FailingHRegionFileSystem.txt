static class FailingHRegionFileSystem extends HRegionFileSystem {
  boolean fail=false;
  FailingHRegionFileSystem(  Configuration conf,  FileSystem fs,  Path tableDir,  RegionInfo regionInfo){
    super(conf,fs,tableDir,regionInfo);
  }
  @Override public Collection<StoreFileInfo> getStoreFiles(  String familyName) throws IOException {
    if (fail) {
      throw new IOException("simulating FS failure");
    }
    return super.getStoreFiles(familyName);
  }
}
