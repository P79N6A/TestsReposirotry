/** 
 * Custom coprocessor that just copies the write to another table.
 */
public static class SendToOtherTableCoprocessor implements RegionCoprocessor, RegionObserver {
  @Override public Optional<RegionObserver> getRegionObserver(){
    return Optional.of(this);
  }
  @Override public void prePut(  final ObserverContext<RegionCoprocessorEnvironment> e,  final Put put,  final WALEdit edit,  final Durability durability) throws IOException {
    try (Table table=e.getEnvironment().getConnection().getTable(otherTable)){
      table.put(put);
      completed[0]=true;
    }
   }
}
