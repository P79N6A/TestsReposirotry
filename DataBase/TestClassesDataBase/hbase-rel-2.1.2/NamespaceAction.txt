private abstract class NamespaceAction extends MasterAction {
  final String nsTestConfigKey="hbase.namespace.testKey";
  protected NamespaceDescriptor selectNamespace(  ConcurrentHashMap<String,NamespaceDescriptor> namespaceMap){
synchronized (namespaceMap) {
      if (namespaceMap.isEmpty()) {
        return null;
      }
      ArrayList<String> namespaceList=new ArrayList<>(namespaceMap.keySet());
      String randomKey=namespaceList.get(RandomUtils.nextInt(0,namespaceList.size()));
      NamespaceDescriptor randomNsd=namespaceMap.get(randomKey);
      namespaceMap.remove(randomKey);
      return randomNsd;
    }
  }
}
