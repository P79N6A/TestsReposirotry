static class CountingThreadFactory implements ThreadFactory {
  final AtomicInteger nbThreads;
  ThreadFactory realFactory=Threads.newDaemonThreadFactory("test-TestAsyncProcess");
  @Override public Thread newThread(  Runnable r){
    nbThreads.incrementAndGet();
    return realFactory.newThread(r);
  }
  CountingThreadFactory(  AtomicInteger nbThreads){
    this.nbThreads=nbThreads;
  }
}
