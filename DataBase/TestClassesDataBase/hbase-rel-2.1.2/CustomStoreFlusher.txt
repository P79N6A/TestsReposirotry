public static class CustomStoreFlusher extends DefaultStoreFlusher {
  static final AtomicBoolean throwExceptionWhenFlushing=new AtomicBoolean(false);
  public CustomStoreFlusher(  Configuration conf,  HStore store){
    super(conf,store);
  }
  @Override public List<Path> flushSnapshot(  MemStoreSnapshot snapshot,  long cacheFlushId,  MonitoredTask status,  ThroughputController throughputController,  FlushLifeCycleTracker tracker) throws IOException {
    if (throwExceptionWhenFlushing.get()) {
      throw new IOException("Simulated exception by tests");
    }
    return super.flushSnapshot(snapshot,cacheFlushId,status,throughputController,tracker);
  }
}
