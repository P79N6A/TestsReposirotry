/** 
 * ProtobufLogWriter that simulates higher latencies in sync() call 
 */
public static class HighLatencySyncWriter extends ProtobufLogWriter {
  @Override public void sync(  boolean forceSync) throws IOException {
    Threads.sleep(ThreadLocalRandom.current().nextInt(10));
    super.sync(forceSync);
    Threads.sleep(ThreadLocalRandom.current().nextInt(10));
  }
}
