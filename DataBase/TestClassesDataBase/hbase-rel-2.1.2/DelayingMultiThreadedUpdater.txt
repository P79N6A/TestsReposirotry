/** 
 * This extends MultiThreadedWriter to add a configurable delay to the keys written by the writer threads to become available to the MultiThradedReader threads. We add this delay because of the async nature of the wal replication to region replicas.
 */
public static class DelayingMultiThreadedUpdater extends MultiThreadedUpdater {
  private long delayMs;
  public DelayingMultiThreadedUpdater(  LoadTestDataGenerator dataGen,  Configuration conf,  TableName tableName,  double updatePercent) throws IOException {
    super(dataGen,conf,tableName,updatePercent);
  }
  @Override protected BlockingQueue<Long> createWriteKeysQueue(  Configuration conf){
    this.delayMs=conf.getLong(String.format("%s.%s",IntegrationTestRegionReplicaReplication.class.getSimpleName(),OPT_READ_DELAY_MS),5000);
    return new ConstantDelayQueue<>(TimeUnit.MILLISECONDS,delayMs);
  }
}
