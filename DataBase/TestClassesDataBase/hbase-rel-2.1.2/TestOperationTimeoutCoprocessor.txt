public static class TestOperationTimeoutCoprocessor implements MasterCoprocessor, MasterObserver {
  AtomicLong sleepTime=new AtomicLong(0);
  public TestOperationTimeoutCoprocessor(){
  }
  @Override public Optional<MasterObserver> getMasterObserver(){
    return Optional.of(this);
  }
  @Override public void preGetNamespaceDescriptor(  ObserverContext<MasterCoprocessorEnvironment> ctx,  String namespace) throws IOException {
    Threads.sleep(DEFAULT_RPC_TIMEOUT / 2);
    if (sleepTime.addAndGet(DEFAULT_RPC_TIMEOUT / 2) < DEFAULT_OPERATION_TIMEOUT) {
      throw new IOException("call fail");
    }
  }
}
