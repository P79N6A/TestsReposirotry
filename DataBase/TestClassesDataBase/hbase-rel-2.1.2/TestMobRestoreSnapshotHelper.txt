/** 
 * Test the restore/clone operation from a file-system point of view.
 */
@Category(MediumTests.class) public class TestMobRestoreSnapshotHelper extends TestRestoreSnapshotHelper {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestMobRestoreSnapshotHelper.class);
  final Logger LOG=LoggerFactory.getLogger(getClass());
  @Override protected void setupConf(  Configuration conf){
    conf.setInt(MobConstants.MOB_FILE_CACHE_SIZE_KEY,0);
  }
  @Override protected SnapshotMock createSnapshotMock() throws IOException {
    return new SnapshotMock(TEST_UTIL.getConfiguration(),fs,rootDir);
  }
  @Override protected void createTableAndSnapshot(  TableName tableName,  String snapshotName) throws IOException {
    byte[] column=Bytes.toBytes("A");
    Table table=MobSnapshotTestingUtils.createMobTable(TEST_UTIL,tableName,column);
    TEST_UTIL.loadTable(table,column);
    TEST_UTIL.getAdmin().snapshot(snapshotName,tableName);
  }
}
