@Category({MasterTests.class,SmallTests.class}) public class TestRegionPlan {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestRegionPlan.class);
  private final ServerName SRC=ServerName.valueOf("source",1234,2345);
  private final ServerName DEST=ServerName.valueOf("dest",1234,2345);
  @Rule public TestName name=new TestName();
  @Test public void testCompareTo(){
    RegionInfo hri=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName())).build();
    RegionPlan a=new RegionPlan(hri,null,null);
    RegionPlan b=new RegionPlan(hri,null,null);
    assertEquals(0,a.compareTo(b));
    a=new RegionPlan(hri,SRC,null);
    b=new RegionPlan(hri,null,null);
    assertEquals(1,a.compareTo(b));
    a=new RegionPlan(hri,null,null);
    b=new RegionPlan(hri,SRC,null);
    assertEquals(-1,a.compareTo(b));
    a=new RegionPlan(hri,SRC,null);
    b=new RegionPlan(hri,SRC,null);
    assertEquals(0,a.compareTo(b));
    a=new RegionPlan(hri,SRC,null);
    b=new RegionPlan(hri,SRC,DEST);
    assertEquals(-1,a.compareTo(b));
    a=new RegionPlan(hri,SRC,DEST);
    b=new RegionPlan(hri,SRC,DEST);
    assertEquals(0,a.compareTo(b));
  }
  @Test public void testEqualsWithNulls(){
    RegionInfo hri=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName())).build();
    RegionPlan a=new RegionPlan(hri,null,null);
    RegionPlan b=new RegionPlan(hri,null,null);
    assertTrue(a.equals(b));
    a=new RegionPlan(hri,SRC,null);
    b=new RegionPlan(hri,null,null);
    assertFalse(a.equals(b));
    a=new RegionPlan(hri,SRC,null);
    b=new RegionPlan(hri,SRC,null);
    assertTrue(a.equals(b));
    a=new RegionPlan(hri,SRC,null);
    b=new RegionPlan(hri,SRC,DEST);
    assertFalse(a.equals(b));
  }
  @Test public void testEquals(){
    RegionInfo hri=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName())).build();
    RegionPlan plan=new RegionPlan(hri,SRC,DEST);
    assertEquals(plan.hashCode(),new RegionPlan(hri,SRC,DEST).hashCode());
    assertEquals(plan,new RegionPlan(hri,SRC,DEST));
    RegionInfo other=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName() + "other")).build();
    assertNotEquals(plan.hashCode(),new RegionPlan(other,SRC,DEST).hashCode());
    assertNotEquals(plan,new RegionPlan(other,SRC,DEST));
  }
}
