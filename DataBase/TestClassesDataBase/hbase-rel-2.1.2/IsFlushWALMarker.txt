static class IsFlushWALMarker implements ArgumentMatcher<WALEdit> {
  volatile FlushAction[] actions;
  public IsFlushWALMarker(  FlushAction... actions){
    this.actions=actions;
  }
  @Override public boolean matches(  WALEdit edit){
    List<Cell> cells=edit.getCells();
    if (cells.isEmpty()) {
      return false;
    }
    if (WALEdit.isMetaEditFamily(cells.get(0))) {
      FlushDescriptor desc;
      try {
        desc=WALEdit.getFlushDescriptor(cells.get(0));
      }
 catch (      IOException e) {
        LOG.warn(e.toString(),e);
        return false;
      }
      if (desc != null) {
        for (        FlushAction action : actions) {
          if (desc.getAction() == action) {
            return true;
          }
        }
      }
    }
    return false;
  }
  public IsFlushWALMarker set(  FlushAction... actions){
    this.actions=actions;
    return this;
  }
}
