public static class TTLCheckingObserver implements RegionCoprocessor, RegionObserver {
  @Override public Optional<RegionObserver> getRegionObserver(){
    return Optional.of(this);
  }
  @Override public void prePut(  ObserverContext<RegionCoprocessorEnvironment> e,  Put put,  WALEdit edit,  Durability durability) throws IOException {
    Region region=e.getEnvironment().getRegion();
    if (!region.getRegionInfo().isMetaRegion() && !region.getRegionInfo().getTable().isSystemTable()) {
      if (put.getTTL() != Long.MAX_VALUE) {
        return;
      }
      throw new IOException("Operation does not have TTL set");
    }
  }
}
