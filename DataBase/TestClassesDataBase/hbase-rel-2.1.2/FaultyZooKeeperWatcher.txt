static class FaultyZooKeeperWatcher extends ZKWatcher {
  private RecoverableZooKeeper zk;
  public FaultyZooKeeperWatcher(  Configuration conf,  String identifier,  Abortable abortable) throws ZooKeeperConnectionException, IOException {
    super(conf,identifier,abortable);
  }
  public void init() throws Exception {
    this.zk=spy(super.getRecoverableZooKeeper());
    doThrow(new KeeperException.ConnectionLossException()).when(zk).getData("/hbase/replication/hfile-refs",null,new Stat());
  }
  @Override public RecoverableZooKeeper getRecoverableZooKeeper(){
    return zk;
  }
}
