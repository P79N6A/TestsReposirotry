/** 
 * Very basic tests.
 * @see TestMultiVersionConcurrencyControl for more.
 */
@Category({RegionServerTests.class,SmallTests.class}) public class TestMultiVersionConcurrencyControlBasic {
  @ClassRule public static final HBaseClassTestRule CLASS_RULE=HBaseClassTestRule.forClass(TestMultiVersionConcurrencyControlBasic.class);
  @Test public void testSimpleMvccOps(){
    MultiVersionConcurrencyControl mvcc=new MultiVersionConcurrencyControl();
    long readPoint=mvcc.getReadPoint();
    MultiVersionConcurrencyControl.WriteEntry writeEntry=mvcc.begin();
    mvcc.completeAndWait(writeEntry);
    assertEquals(readPoint + 1,mvcc.getReadPoint());
    writeEntry=mvcc.begin();
    mvcc.complete(writeEntry);
    assertEquals(readPoint + 2,mvcc.getWritePoint());
  }
}
