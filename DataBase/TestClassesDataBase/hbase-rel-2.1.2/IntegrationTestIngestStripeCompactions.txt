/** 
 * A test class that does the same things as IntegrationTestIngest but with stripe compactions. Can be used with ChaosMonkey in the same manner.
 */
@Category(IntegrationTests.class) public class IntegrationTestIngestStripeCompactions extends IntegrationTestIngest {
  @Override protected void initTable() throws IOException {
    HTableDescriptor htd=new HTableDescriptor(getTablename());
    htd.setConfiguration(StoreEngine.STORE_ENGINE_CLASS_KEY,StripeStoreEngine.class.getName());
    htd.setConfiguration(HStore.BLOCKING_STOREFILES_KEY,"100");
    HColumnDescriptor hcd=new HColumnDescriptor(HFileTestUtil.DEFAULT_COLUMN_FAMILY);
    HBaseTestingUtility.createPreSplitLoadTestTable(util.getConfiguration(),htd,hcd);
  }
  public static void main(  String[] args) throws Exception {
    Configuration conf=HBaseConfiguration.create();
    IntegrationTestingUtility.setUseDistributedCluster(conf);
    int ret=ToolRunner.run(conf,new IntegrationTestIngestStripeCompactions(),args);
    System.exit(ret);
  }
}
