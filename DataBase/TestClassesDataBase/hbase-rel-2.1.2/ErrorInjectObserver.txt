public static final class ErrorInjectObserver implements RegionCoprocessor, RegionObserver {
  @Override public Optional<RegionObserver> getRegionObserver(){
    return Optional.of(this);
  }
  @Override public void preGetOp(  ObserverContext<RegionCoprocessorEnvironment> e,  Get get,  List<Cell> results) throws IOException {
    if (e.getEnvironment().getRegionInfo().getEndKey().length == 0) {
      throw new DoNotRetryRegionException("Inject Error");
    }
  }
}
