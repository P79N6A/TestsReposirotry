/** 
 * Callable used to make sure the cluster has some load on it. This callable uses LoadTest tool to
 */
public static class LoadCallable implements Callable<Boolean> {
  private final Future<?> future;
  public LoadCallable(  Future<?> f){
    future=f;
  }
  @Override public Boolean call() throws Exception {
    int colsPerKey=10;
    int numServers=util.getHBaseClusterInterface().getInitialClusterMetrics().getLiveServerMetrics().size();
    int numKeys=numServers * 5000;
    int writeThreads=10;
    do {
      int ret=loadTool.run(new String[]{"-tn",loadTableName.getNameAsString(),"-write",String.format("%d:%d:%d",colsPerKey,500,writeThreads),"-num_keys",String.valueOf(numKeys),"-skip_init"});
      assertEquals("Load failed",0,ret);
    }
 while (!future.isDone());
    return true;
  }
}
