static class FaultyInputStream extends FSDataInputStream {
  boolean faultsStarted=false;
  public FaultyInputStream(  InputStream in) throws IOException {
    super(in);
  }
  public void startFaults(){
    faultsStarted=true;
  }
  @Override public int read(  long position,  byte[] buffer,  int offset,  int length) throws IOException {
    injectFault();
    return ((PositionedReadable)in).read(position,buffer,offset,length);
  }
  private void injectFault() throws IOException {
    if (faultsStarted) {
      throw new IOException("Fault injected");
    }
  }
}
