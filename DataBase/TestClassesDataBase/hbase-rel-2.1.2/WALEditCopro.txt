public static class WALEditCopro implements WALCoprocessor, WALObserver {
  public WALEditCopro(){
    entries.clear();
  }
  @Override public Optional<WALObserver> getWALObserver(){
    return Optional.of(this);
  }
  @Override public void postWALWrite(  ObserverContext<? extends WALCoprocessorEnvironment> ctx,  RegionInfo info,  WALKey logKey,  WALEdit logEdit) throws IOException {
    if (logKey.getTableName().equals(tableName) && info.getReplicaId() == 0) {
      entries.add(new Entry((WALKeyImpl)logKey,logEdit));
    }
  }
}
