private class BulkLoadAccessTestAction implements AccessTestAction {
  private FsPermission filePermission;
  private Path testDataDir;
  public BulkLoadAccessTestAction(  FsPermission perm,  Path testDataDir){
    this.filePermission=perm;
    this.testDataDir=testDataDir;
  }
  @Override public Object run() throws Exception {
    FileSystem fs=TEST_UTIL.getTestFileSystem();
    fs.mkdirs(testDataDir);
    fs.setPermission(testDataDir,FS_PERMISSION_ALL);
    byte[][][] hfileRanges={{{(byte)0},{(byte)9}}};
    Path bulkLoadBasePath=new Path(testDataDir,new Path(User.getCurrent().getName()));
    new BulkLoadHelper(bulkLoadBasePath).initHFileData(TEST_FAMILY,TEST_QUALIFIER,hfileRanges,3,filePermission).bulkLoadHFile(TEST_TABLE);
    return null;
  }
}
