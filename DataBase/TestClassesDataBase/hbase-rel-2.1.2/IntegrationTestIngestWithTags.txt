@Category(IntegrationTests.class) public class IntegrationTestIngestWithTags extends IntegrationTestIngest {
  private static final char COLON=':';
  private int minTagsPerKey=1, maxTagsPerKey=10;
  private int minTagLength=16, maxTagLength=512;
  @Override public void setUpCluster() throws Exception {
    getTestingUtil(conf).getConfiguration().setInt(HFile.FORMAT_VERSION_KEY,3);
    super.setUpCluster();
  }
  @Override protected String[] getArgsForLoadTestTool(  String mode,  String modeSpecificArg,  long startKey,  long numKeys){
    String[] args=super.getArgsForLoadTestTool(mode,modeSpecificArg,startKey,numKeys);
    List<String> tmp=new ArrayList<>(Arrays.asList(args));
    tmp.add(HIPHEN + LoadTestTool.OPT_GENERATOR);
    StringBuilder sb=new StringBuilder(LoadTestDataGeneratorWithTags.class.getName());
    sb.append(COLON);
    sb.append(minTagsPerKey);
    sb.append(COLON);
    sb.append(maxTagsPerKey);
    sb.append(COLON);
    sb.append(minTagLength);
    sb.append(COLON);
    sb.append(maxTagLength);
    tmp.add(sb.toString());
    return tmp.toArray(new String[tmp.size()]);
  }
}
