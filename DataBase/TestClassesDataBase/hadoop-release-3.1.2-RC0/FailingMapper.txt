private static class FailingMapper extends Mapper<LongWritable,Text,LongWritable,Text> {
  /** 
 * Map method with different behavior based on the thread id 
 */
  public void map(  LongWritable key,  Text val,  Context c) throws IOException, InterruptedException {
    throw new IOException("TestMapperReducerCleanup");
  }
  protected void cleanup(  Context context) throws IOException, InterruptedException {
    mapCleanup=true;
    super.cleanup(context);
  }
}
