/** 
 * Tests for  {@link RetryCacheMetrics}
 */
public class TestRetryCacheMetrics {
  static final String cacheName="NameNodeRetryCache";
  @Test public void testNames(){
    RetryCache cache=mock(RetryCache.class);
    when(cache.getCacheName()).thenReturn(cacheName);
    RetryCacheMetrics metrics=RetryCacheMetrics.create(cache);
    metrics.incrCacheHit();
    metrics.incrCacheCleared();
    metrics.incrCacheCleared();
    metrics.incrCacheUpdated();
    metrics.incrCacheUpdated();
    metrics.incrCacheUpdated();
    checkMetrics(1,2,3);
  }
  private void checkMetrics(  long hit,  long cleared,  long updated){
    MetricsRecordBuilder rb=getMetrics("RetryCache." + cacheName);
    assertCounter("CacheHit",hit,rb);
    assertCounter("CacheCleared",cleared,rb);
    assertCounter("CacheUpdated",updated,rb);
  }
}
