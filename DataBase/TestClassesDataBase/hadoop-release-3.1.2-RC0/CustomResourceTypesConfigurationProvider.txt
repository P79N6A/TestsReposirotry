private static class CustomResourceTypesConfigurationProvider extends LocalConfigurationProvider {
  @Override public InputStream getConfigurationInputStream(  Configuration bootstrapConf,  String name) throws YarnException, IOException {
    if (YarnConfiguration.RESOURCE_TYPES_CONFIGURATION_FILE.equals(name)) {
      return new ByteArrayInputStream(("<configuration>\n" + " <property>\n" + "   <name>yarn.resource-types</name>\n"+ "   <value>a-custom-resource</value>\n"+ " </property>\n"+ " <property>\n"+ "   <name>yarn.resource-types.a-custom-resource.units</name>\n"+ "   <value>G</value>\n"+ " </property>\n"+ "</configuration>\n").getBytes());
    }
 else {
      return super.getConfigurationInputStream(bootstrapConf,name);
    }
  }
}
