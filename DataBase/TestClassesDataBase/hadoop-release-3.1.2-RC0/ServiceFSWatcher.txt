/** 
 * Watcher to initialize yarn service base path under target and deletes the the test directory when finishes.
 */
public static class ServiceFSWatcher extends TestWatcher {
  private YarnConfiguration conf;
  private SliderFileSystem fs;
  private java.nio.file.Path serviceBasePath;
  @Override protected void starting(  Description description){
    conf=new YarnConfiguration();
    delete(description);
    serviceBasePath=Paths.get("target",description.getClassName(),description.getMethodName());
    conf.set(YARN_SERVICE_BASE_PATH,serviceBasePath.toString());
    try {
      fs=new SliderFileSystem(conf);
      fs.setAppDir(new Path(serviceBasePath.toString()));
    }
 catch (    IOException e) {
      Throwables.propagate(e);
    }
  }
  @Override protected void finished(  Description description){
    delete(description);
  }
  private void delete(  Description description){
    FileUtils.deleteQuietly(Paths.get("target",description.getClassName()).toFile());
  }
  /** 
 * Returns the yarn conf.
 */
  public YarnConfiguration getConf(){
    return conf;
  }
  /** 
 * Returns the file system.
 */
  public SliderFileSystem getFs(){
    return fs;
  }
  /** 
 * Returns the test service base path.
 */
  public java.nio.file.Path getServiceBasePath(){
    return serviceBasePath;
  }
}
