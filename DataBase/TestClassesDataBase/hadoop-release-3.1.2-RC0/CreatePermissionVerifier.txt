private class CreatePermissionVerifier extends PermissionVerifier {
  private OpType opType;
  private boolean cleanup=true;
  protected void set(  Path path,  OpType opType,  short ancestorPermission,  short parentPermission){
    super.set(path,ancestorPermission,parentPermission,NULL_MASK);
    setOpType(opType);
  }
  void setCleanup(  boolean cleanup){
    this.cleanup=cleanup;
  }
  void setOpType(  OpType opType){
    this.opType=opType;
  }
  @Override void setOpPermission(){
    this.opParentPermission=SEARCH_MASK | WRITE_MASK;
  }
  @Override void call() throws IOException {
    create(opType,path);
    if (cleanup) {
      fs.delete(path,true);
    }
  }
}
