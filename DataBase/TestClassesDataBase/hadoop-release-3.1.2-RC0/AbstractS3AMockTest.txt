/** 
 * Abstract base class for S3A unit tests using a mock S3 client and a null metadata store.
 */
public abstract class AbstractS3AMockTest {
  protected static final String BUCKET="mock-bucket";
  protected static final AmazonServiceException NOT_FOUND;
static {
    NOT_FOUND=new AmazonServiceException("Not Found");
    NOT_FOUND.setStatusCode(404);
  }
  @Rule public ExpectedException exception=ExpectedException.none();
  protected S3AFileSystem fs;
  protected AmazonS3 s3;
  @Before public void setup() throws Exception {
    Configuration conf=new Configuration();
    conf.setClass(S3_CLIENT_FACTORY_IMPL,MockS3ClientFactory.class,S3ClientFactory.class);
    conf.setClass(S3_METADATA_STORE_IMPL,NullMetadataStore.class,MetadataStore.class);
    conf.setBoolean(CommitConstants.MAGIC_COMMITTER_ENABLED,true);
    fs=new S3AFileSystem();
    URI uri=URI.create(FS_S3A + "://" + BUCKET);
    fs.initialize(uri,conf);
    s3=fs.getAmazonS3ClientForTesting("mocking");
  }
  @After public void teardown() throws Exception {
    if (fs != null) {
      fs.close();
    }
  }
}
