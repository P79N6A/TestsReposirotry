static class NewByteArrayWithLimit extends ByteArrayManager {
  private final int maxCount;
  private int count=0;
  NewByteArrayWithLimit(  int maxCount){
    this.maxCount=maxCount;
  }
  @Override public synchronized byte[] newByteArray(  int size) throws InterruptedException {
    for (; count >= maxCount; ) {
      wait();
    }
    count++;
    return new byte[size];
  }
  @Override public synchronized int release(  byte[] array){
    if (count == maxCount) {
      notifyAll();
    }
    count--;
    return 0;
  }
}
