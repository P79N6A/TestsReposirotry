private class FaultyLoggerFactory implements AsyncLogger.Factory {
  @Override public AsyncLogger createLogger(  Configuration conf,  NamespaceInfo nsInfo,  String journalId,  String nameServiceId,  InetSocketAddress addr){
    AsyncLogger ch=IPCLoggerChannel.FACTORY.createLogger(conf,nsInfo,journalId,nameServiceId,addr);
    AsyncLogger spy=Mockito.spy(ch);
    Mockito.doAnswer(new SometimesFaulty<Long>(0.10f)).when(spy).getJournalState();
    Mockito.doAnswer(new SometimesFaulty<Void>(0.40f)).when(spy).newEpoch(Mockito.anyLong());
    return spy;
  }
}
