/** 
 * fake FileSystem  overwrites three methods 1. getDelegationToken() - generates a token 2. renewDelegataionToken - counts number of calls, and remembers  most recently renewed token. 3. cancelToken -cancels token (subsequent renew will cause IllegalToken  exception
 */
static class MyFS extends DistributedFileSystem {
  private static AtomicInteger instanceCounter=new AtomicInteger();
  public MyFS(){
    instanceCounter.incrementAndGet();
  }
  public void close(){
    instanceCounter.decrementAndGet();
  }
  public static int getInstanceCounter(){
    return instanceCounter.get();
  }
  @Override public void initialize(  URI uri,  Configuration conf) throws IOException {
  }
  @Override public MyToken getDelegationToken(  String renewer) throws IOException {
    MyToken result=createTokens(new Text(renewer));
    LOG.info("Called MYDFS.getdelegationtoken " + result);
    return result;
  }
  public Token<?>[] addDelegationTokens(  final String renewer,  Credentials credentials) throws IOException {
    return new Token<?>[0];
  }
}
