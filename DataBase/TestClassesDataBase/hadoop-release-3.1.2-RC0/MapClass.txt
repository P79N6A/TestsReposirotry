/** 
 * Test Mapper. This is executed in separate process, and must not make any assumptions about external state.
 */
public static class MapClass extends Mapper<LongWritable,Text,LongWritable,Text> {
  private int operations;
  private String id="";
  private LongWritable l=new LongWritable();
  private Text t=new Text();
  @Override protected void setup(  Context context) throws IOException, InterruptedException {
    super.setup(context);
    org.apache.log4j.BasicConfigurator.configure();
    boolean scaleMap=context.getConfiguration().getBoolean(KEY_SCALE_TESTS_ENABLED,false);
    operations=scaleMap ? 1000 : 10;
    id=context.getTaskAttemptID().toString();
  }
  @Override protected void map(  LongWritable key,  Text value,  Context context) throws IOException, InterruptedException {
    for (int i=0; i < operations; i++) {
      l.set(i);
      t.set(String.format("%s:%05d",id,i));
      context.write(l,t);
    }
  }
}
