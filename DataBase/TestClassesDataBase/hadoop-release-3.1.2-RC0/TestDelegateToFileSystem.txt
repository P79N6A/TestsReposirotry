public class TestDelegateToFileSystem {
  private static final String FTP_DUMMYHOST="ftp://dummyhost";
  private static final URI FTP_URI_NO_PORT=URI.create(FTP_DUMMYHOST);
  private static final URI FTP_URI_WITH_PORT=URI.create(FTP_DUMMYHOST + ":" + FTP.DEFAULT_PORT);
  private void testDefaultUriInternal(  String defaultUri) throws UnsupportedFileSystemException {
    final Configuration conf=new Configuration();
    FileSystem.setDefaultUri(conf,defaultUri);
    final AbstractFileSystem ftpFs=AbstractFileSystem.get(FTP_URI_NO_PORT,conf);
    Assert.assertEquals(FTP_URI_WITH_PORT,ftpFs.getUri());
  }
  @Test public void testDefaultURIwithOutPort() throws Exception {
    testDefaultUriInternal("hdfs://dummyhost");
  }
  @Test public void testDefaultURIwithPort() throws Exception {
    testDefaultUriInternal("hdfs://dummyhost:8020");
  }
}
