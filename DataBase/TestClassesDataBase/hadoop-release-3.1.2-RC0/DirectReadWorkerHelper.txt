/** 
 * Uses read(ByteBuffer...) style APIs
 */
static class DirectReadWorkerHelper implements ReadWorkerHelper {
  @Override public int read(  DFSInputStream dis,  byte[] target,  int startOff,  int len) throws IOException {
    ByteBuffer bb=ByteBuffer.allocateDirect(target.length);
    int cnt=0;
synchronized (dis) {
      dis.seek(startOff);
      while (cnt < len) {
        int read=dis.read(bb);
        if (read == -1) {
          return read;
        }
        cnt+=read;
      }
    }
    bb.clear();
    bb.get(target);
    return cnt;
  }
  @Override public int pRead(  DFSInputStream dis,  byte[] target,  int startOff,  int len) throws IOException {
    return read(dis,target,startOff,len);
  }
}
