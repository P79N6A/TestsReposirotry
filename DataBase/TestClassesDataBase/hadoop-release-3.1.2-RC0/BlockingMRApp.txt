static class BlockingMRApp extends MRApp {
  private CountDownLatch latch;
  BlockingMRApp(  int maps,  int reduces,  CountDownLatch latch){
    super(maps,reduces,true,"testKill",true);
    this.latch=latch;
  }
  @Override protected void attemptLaunched(  TaskAttemptId attemptID){
    if (attemptID.getTaskId().getId() == 0 && attemptID.getId() == 0) {
      try {
        latch.await();
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
 else {
      getContext().getEventHandler().handle(new TaskAttemptEvent(attemptID,TaskAttemptEventType.TA_DONE));
    }
  }
}
