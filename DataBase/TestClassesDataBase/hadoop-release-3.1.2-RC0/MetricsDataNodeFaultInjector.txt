private static class MetricsDataNodeFaultInjector extends DataNodeFaultInjector {
  public static final long DELAY=2000;
  private long delayMs=0;
  private final String err="Interrupted while sleeping. Bailing out.";
  private long delayTries=1;
  void delayOnce() throws IOException {
    if (delayTries > 0) {
      delayTries--;
      try {
        Thread.sleep(DELAY);
      }
 catch (      InterruptedException ie) {
        throw new IOException(err);
      }
    }
  }
  long getDelayMs(){
    return delayMs;
  }
  void logDelay(  final long duration){
    if (duration >= DELAY) {
      this.delayMs=duration;
    }
  }
}
