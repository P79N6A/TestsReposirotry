/** 
 * addCachePool 
 */
class AddCachePoolOp extends AtMostOnceOp {
  private final String pool;
  AddCachePoolOp(  DFSClient client,  String pool){
    super("addCachePool",client);
    this.pool=pool;
  }
  @Override void prepare() throws Exception {
  }
  @Override void invoke() throws Exception {
    expectedUpdateCount++;
    client.addCachePool(new CachePoolInfo(pool));
  }
  @Override boolean checkNamenodeBeforeReturn() throws Exception {
    for (int i=0; i < CHECKTIMES; i++) {
      RemoteIterator<CachePoolEntry> iter=dfs.listCachePools();
      if (iter.hasNext()) {
        return true;
      }
      Thread.sleep(1000);
    }
    return false;
  }
  @Override Object getResult(){
    return null;
  }
}
