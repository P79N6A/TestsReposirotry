/** 
 * A simple FileRegion BlockAliasMap for tests.
 */
public static class TestFileRegionBlockAliasMap extends BlockAliasMap<FileRegion> {
  private Configuration conf;
  private int minId;
  private int numBlocks;
  private Iterator<FileRegion> suppliedIterator;
  TestFileRegionBlockAliasMap(){
    this(null,MIN_BLK_ID,NUM_PROVIDED_BLKS);
  }
  TestFileRegionBlockAliasMap(  Iterator<FileRegion> iterator,  int minId,  int numBlocks){
    this.suppliedIterator=iterator;
    this.minId=minId;
    this.numBlocks=numBlocks;
  }
  @Override public Reader<FileRegion> getReader(  Reader.Options opts,  String blockPoolId) throws IOException {
    if (!blockPoolId.equals(BLOCK_POOL_IDS[CHOSEN_BP_ID])) {
      return null;
    }
    BlockAliasMap.Reader<FileRegion> reader=new BlockAliasMap.Reader<FileRegion>(){
      @Override public Iterator<FileRegion> iterator(){
        if (suppliedIterator == null) {
          return new TestFileRegionIterator(providedBasePath,minId,numBlocks);
        }
 else {
          return suppliedIterator;
        }
      }
      @Override public void close() throws IOException {
      }
      @Override public Optional<FileRegion> resolve(      Block ident) throws IOException {
        return null;
      }
    }
;
    return reader;
  }
  @Override public Writer<FileRegion> getWriter(  Writer.Options opts,  String blockPoolId) throws IOException {
    return null;
  }
  @Override public void refresh() throws IOException {
  }
  @Override public void close() throws IOException {
  }
}
