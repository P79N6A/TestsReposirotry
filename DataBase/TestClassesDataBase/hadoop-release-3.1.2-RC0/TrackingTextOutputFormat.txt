@SuppressWarnings("rawtypes") public static class TrackingTextOutputFormat extends TextOutputFormat {
public static class TrackingRecordWriter extends LineRecordWriter {
    public TrackingRecordWriter(    DataOutputStream out){
      super(out);
    }
    @Override public synchronized void close(    TaskAttemptContext context) throws IOException {
      recordWriterCleanup=true;
      super.close(context);
    }
  }
  @Override public RecordWriter getRecordWriter(  TaskAttemptContext job) throws IOException, InterruptedException {
    Configuration conf=job.getConfiguration();
    Path file=getDefaultWorkFile(job,"");
    FileSystem fs=file.getFileSystem(conf);
    FSDataOutputStream fileOut=fs.create(file,false);
    return new TrackingRecordWriter(fileOut);
  }
}
