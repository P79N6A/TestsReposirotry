/** 
 * Appending a specified length to an existing file but not close the file
 */
static class FileAppendNotClose extends FileAppend {
  HdfsDataOutputStream out;
  FileAppendNotClose(  Path file,  FileSystem fs,  int len){
    super(file,fs,len);
  }
  @Override void modify() throws Exception {
    assertTrue(fs.exists(file));
    byte[] toAppend=new byte[appendLen];
    random.nextBytes(toAppend);
    out=(HdfsDataOutputStream)fs.append(file);
    out.write(toAppend);
    out.hsync(EnumSet.of(HdfsDataOutputStream.SyncFlag.UPDATE_LENGTH));
  }
}
