/** 
 * Test atomic renaming.
 */
public class ITestNativeAzureFileSystemAtomicRenameDirList extends AbstractWasbTestBase {
  private static final String HBASE_ROOT_DIR_CONF_STRING="hbase.rootdir";
  private static final String HBASE_ROOT_DIR_VALUE_ON_DIFFERENT_FS="wasb://somedifferentfilesystem.blob.core.windows.net/hbase";
  @Override protected AzureBlobStorageTestAccount createTestAccount() throws Exception {
    return AzureBlobStorageTestAccount.create();
  }
  @Test public void testAtomicRenameKeyDoesntNPEOnInitializingWithNonDefaultURI() throws IOException {
    NativeAzureFileSystem azureFs=fs;
    AzureNativeFileSystemStore azureStore=azureFs.getStore();
    Configuration conf=fs.getConf();
    conf.set(HBASE_ROOT_DIR_CONF_STRING,HBASE_ROOT_DIR_VALUE_ON_DIFFERENT_FS);
    URI uri=fs.getUri();
    fs.initialize(uri,conf);
    azureStore.isAtomicRenameKey("anyrandomkey");
  }
}
