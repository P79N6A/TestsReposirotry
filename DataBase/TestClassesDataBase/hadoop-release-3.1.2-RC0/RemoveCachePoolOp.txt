/** 
 * removeCachePool 
 */
class RemoveCachePoolOp extends AtMostOnceOp {
  private final String pool;
  RemoveCachePoolOp(  DFSClient client,  String pool){
    super("removeCachePool",client);
    this.pool=pool;
  }
  @Override void prepare() throws Exception {
    expectedUpdateCount++;
    client.addCachePool(new CachePoolInfo(pool));
  }
  @Override void invoke() throws Exception {
    expectedUpdateCount++;
    client.removeCachePool(pool);
  }
  @Override boolean checkNamenodeBeforeReturn() throws Exception {
    for (int i=0; i < CHECKTIMES; i++) {
      RemoteIterator<CachePoolEntry> iter=dfs.listCachePools();
      if (!iter.hasNext()) {
        return true;
      }
      Thread.sleep(1000);
    }
    return false;
  }
  @Override Object getResult(){
    return null;
  }
}
