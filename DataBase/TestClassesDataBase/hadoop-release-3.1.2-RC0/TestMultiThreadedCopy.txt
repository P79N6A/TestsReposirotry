private class TestMultiThreadedCopy extends CopyFromLocal {
  public static final String NAME="testCopyFromLocal";
  private int expectedThreads;
  private int expectedCompletedTaskCount;
  TestMultiThreadedCopy(  int expectedThreads,  int expectedCompletedTaskCount){
    this.expectedThreads=expectedThreads;
    this.expectedCompletedTaskCount=expectedCompletedTaskCount;
  }
  @Override protected void processArguments(  LinkedList<PathData> args) throws IOException {
    Assert.assertEquals(expectedThreads,getNumThreads());
    super.processArguments(args);
    ThreadPoolExecutor executor=getExecutor();
    Assert.assertEquals(expectedCompletedTaskCount,executor.getCompletedTaskCount());
    Assert.assertEquals(0,executor.getActiveCount());
    Assert.assertTrue(executor.isTerminated());
  }
}
