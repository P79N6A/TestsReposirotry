@SuppressWarnings("unchecked") static class ProgressCheckerReducer extends Reducer<Text,Text,Text,Text> {
  private int recordCount=0;
  private final float REDUCE_PROGRESS_RANGE=1.0f / 3;
  private final float SHUFFLE_PROGRESS_RANGE=1 - REDUCE_PROGRESS_RANGE;
  protected void setup(  final Reducer.Context context) throws IOException, InterruptedException {
    float reducePhaseProgress=((float)++recordCount) / INPUT_LINES;
    float weightedReducePhaseProgress=REDUCE_PROGRESS_RANGE * reducePhaseProgress;
    assertEquals("Invalid progress in reduce setup",SHUFFLE_PROGRESS_RANGE + weightedReducePhaseProgress,context.getProgress(),0.01f);
  }
  public void reduce(  Text key,  Iterator<Text> values,  Context context) throws IOException, InterruptedException {
    float reducePhaseProgress=((float)++recordCount) / INPUT_LINES;
    float weightedReducePhaseProgress=REDUCE_PROGRESS_RANGE * reducePhaseProgress;
    assertEquals("Invalid progress in reduce",SHUFFLE_PROGRESS_RANGE + weightedReducePhaseProgress,context.getProgress(),0.01f);
  }
  protected void cleanup(  Reducer.Context context) throws IOException, InterruptedException {
    assertEquals("Invalid progress in reduce cleanup",1.0f,context.getProgress(),0f);
  }
}
