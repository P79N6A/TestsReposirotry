/** 
 * Test class to hold all WASB authorization caching related tests.
 */
public class ITestNativeAzureFSAuthorizationCaching extends TestNativeAzureFileSystemAuthorization {
  private static final int DUMMY_TTL_VALUE=5000;
  @Override public Configuration createConfiguration(){
    Configuration conf=super.createConfiguration();
    conf.set(KEY_AUTH_SERVICE_CACHING_ENABLE,"true");
    return conf;
  }
  /** 
 * Test to verify cache behavior -- assert that PUT overwrites value if present
 */
  @Test public void testCachePut() throws Throwable {
    CachingAuthorizer<String,Integer> cache=new CachingAuthorizer<>(DUMMY_TTL_VALUE,"TEST");
    cache.init(createConfiguration());
    cache.put("TEST",1);
    cache.put("TEST",3);
    int result=cache.get("TEST");
    assertEquals("Cache returned unexpected result",3,result);
  }
}
