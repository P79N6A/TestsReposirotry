public class TestGroupsService extends HTestCase {
  @Test @TestDir public void service() throws Exception {
    String dir=TestDirHelper.getTestDir().getAbsolutePath();
    Configuration conf=new Configuration(false);
    conf.set("server.services",StringUtils.join(",",Arrays.asList(GroupsService.class.getName())));
    Server server=new Server("server",dir,dir,dir,dir,conf);
    server.init();
    Groups groups=server.get(Groups.class);
    assertNotNull(groups);
    List<String> g=groups.getGroups(System.getProperty("user.name"));
    assertNotSame(g.size(),0);
    server.destroy();
  }
  @Test(expected=RuntimeException.class) @TestDir public void invalidGroupsMapping() throws Exception {
    String dir=TestDirHelper.getTestDir().getAbsolutePath();
    Configuration conf=new Configuration(false);
    conf.set("server.services",StringUtils.join(",",Arrays.asList(GroupsService.class.getName())));
    conf.set("server.groups.hadoop.security.group.mapping",String.class.getName());
    Server server=new Server("server",dir,dir,dir,dir,conf);
    server.init();
  }
}
