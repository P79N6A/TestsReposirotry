private final class MRAppWithSpiedJob extends MRApp {
  private JobImpl spiedJob;
  private MRAppWithSpiedJob(  int maps,  int reduces,  boolean autoComplete,  String testName,  boolean cleanOnStart){
    super(maps,reduces,autoComplete,testName,cleanOnStart);
  }
  @Override protected Job createJob(  Configuration conf,  JobStateInternal forcedState,  String diagnostic){
    spiedJob=spy((JobImpl)super.createJob(conf,forcedState,diagnostic));
    ((AppContext)getContext()).getAllJobs().put(spiedJob.getID(),spiedJob);
    return spiedJob;
  }
}
