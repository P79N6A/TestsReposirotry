public static class SpillReducer extends Reducer<KeyWritable,ValWritable,NullWritable,NullWritable> {
  private int numrecs;
  private int expected;
  @Override protected void setup(  Context job){
    numrecs=0;
    expected=job.getConfiguration().getInt("test.spillmap.records",100);
  }
  @Override protected void reduce(  KeyWritable k,  Iterable<ValWritable> values,  Context context) throws IOException, InterruptedException {
    for (    ValWritable val : values) {
      ++numrecs;
    }
  }
  @Override protected void cleanup(  Context context) throws IOException, InterruptedException {
    assertEquals("Unexpected record count",expected,numrecs);
  }
}
