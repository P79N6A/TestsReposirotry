/** 
 * Mock answer for heartbeats which returns an empty set of commands and the HA status for the chosen NN from the {@link TestBPOfferService#mockHaStatuses} array.
 */
private class HeartbeatAnswer implements Answer<HeartbeatResponse> {
  private final int nnIdx;
  public HeartbeatAnswer(  int nnIdx){
    this.nnIdx=nnIdx;
  }
  @Override public HeartbeatResponse answer(  InvocationOnMock invocation) throws Throwable {
    heartbeatCounts[nnIdx]++;
    HeartbeatResponse heartbeatResponse=new HeartbeatResponse(datanodeCommands[nnIdx],mockHaStatuses[nnIdx],null,ThreadLocalRandom.current().nextLong() | 1L);
    datanodeCommands[nnIdx]=new DatanodeCommand[0];
    return heartbeatResponse;
  }
}
