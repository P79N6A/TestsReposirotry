public static class TrackingTextInputFormat extends TextInputFormat {
public static class TrackingRecordReader extends LineRecordReader {
    @Override public synchronized void close() throws IOException {
      recordReaderCleanup=true;
      super.close();
    }
  }
  @Override public RecordReader<LongWritable,Text> createRecordReader(  InputSplit split,  TaskAttemptContext context){
    return new TrackingRecordReader();
  }
}
