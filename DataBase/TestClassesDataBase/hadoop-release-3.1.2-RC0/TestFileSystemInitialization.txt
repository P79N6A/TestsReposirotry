public class TestFileSystemInitialization {
  /** 
 * Check if FileSystem can be properly initialized if URLStreamHandlerFactory is registered.
 */
  @Test public void testInitializationWithRegisteredStreamFactory(){
    Configuration conf=new Configuration();
    URL.setURLStreamHandlerFactory(new FsUrlStreamHandlerFactory(conf));
    try {
      FileSystem.getFileSystemClass("file",conf);
    }
 catch (    IOException ok) {
      assertFalse(false);
    }
  }
  @Test public void testMissingLibraries(){
    try {
      Configuration conf=new Configuration();
      Class<? extends FileSystem> fs=FileSystem.getFileSystemClass("s3a",conf);
      fail("Expected an exception, got a filesystem: " + fs);
    }
 catch (    Exception|ServiceConfigurationError expected) {
    }
  }
}
