static class MRAppWithHistoryWithFailedAndKilledTask extends MRAppWithHistory {
  MRAppWithHistoryWithFailedAndKilledTask(  int maps,  int reduces,  boolean autoComplete,  String testName,  boolean cleanOnStart){
    super(maps,reduces,autoComplete,testName,cleanOnStart);
  }
  @Override protected void attemptLaunched(  TaskAttemptId attemptID){
    final int taskId=attemptID.getTaskId().getId();
    final TaskType taskType=attemptID.getTaskId().getTaskType();
    if (taskType == TaskType.MAP && taskId == 0) {
      getContext().getEventHandler().handle(new TaskEvent(attemptID.getTaskId(),TaskEventType.T_KILL));
    }
 else     if (taskType == TaskType.MAP && taskId == 1) {
      getContext().getEventHandler().handle(new TaskAttemptFailEvent(attemptID));
    }
 else     if (taskType == TaskType.REDUCE && taskId == 0) {
      getContext().getEventHandler().handle(new TaskAttemptFailEvent(attemptID));
    }
 else     if (taskType == TaskType.REDUCE && taskId == 1) {
      getContext().getEventHandler().handle(new TaskEvent(attemptID.getTaskId(),TaskEventType.T_KILL));
    }
 else {
      getContext().getEventHandler().handle(new TaskAttemptEvent(attemptID,TaskAttemptEventType.TA_DONE));
    }
  }
}
