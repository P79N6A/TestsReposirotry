class AddBlockPoolThread extends Thread {
  private int id;
  private IOException ioe;
  public AddBlockPoolThread(  int id){
    super();
    this.id=id;
  }
  public void test() throws InterruptedException, IOException {
    this.join();
    if (ioe != null) {
      throw ioe;
    }
  }
  public void run(){
    for (int i=0; i < 10000; i++) {
      String newbpid=bpids[id] + i;
      fsdataset.addBlockPool(newbpid,conf);
      ExtendedBlock block=new ExtendedBlock(newbpid,1);
      try {
        fsdataset.createTemporary(StorageType.DEFAULT,null,block,false);
      }
 catch (      IOException ioe) {
        this.ioe=ioe;
      }
      assert (fsdataset.getReplicaString(newbpid,1) != "null");
    }
  }
}
