/** 
 * MRapp with special HistoryEventHandler that writes events only during stop. This is to simulate events that don't get written by the eventHandling thread due to say a slow DFS and verify that they are flushed during stop.
 */
private static class MRAppWithSpecialHistoryHandler extends MRApp {
  public MRAppWithSpecialHistoryHandler(  int maps,  int reduces,  boolean autoComplete,  String testName,  boolean cleanOnStart){
    super(maps,reduces,autoComplete,testName,cleanOnStart);
  }
  @Override protected EventHandler<JobHistoryEvent> createJobHistoryHandler(  AppContext context){
    return new JobHistoryEventHandler(context,getStartCount()){
      @Override protected void serviceStart(){
        super.eventHandlingThread=new Thread();
        super.eventHandlingThread.start();
      }
    }
;
  }
}
