public class TestNodeResourceMonitor extends BaseContainerManagerTest {
  public TestNodeResourceMonitor() throws UnsupportedFileSystemException {
    super();
  }
  @Before public void setup() throws IOException {
    conf.set(YarnConfiguration.NM_MON_RESOURCE_CALCULATOR,MockResourceCalculatorPlugin.class.getCanonicalName());
    super.setup();
  }
  @Test public void testMetricsUpdate() throws Exception {
    Context spyContext=spy(context);
    NodeResourceMonitor nrm=new NodeResourceMonitorImpl(spyContext);
    nrm.init(conf);
    nrm.start();
    Mockito.verify(spyContext,timeout(500).atLeastOnce()).getNodeManagerMetrics();
  }
}
