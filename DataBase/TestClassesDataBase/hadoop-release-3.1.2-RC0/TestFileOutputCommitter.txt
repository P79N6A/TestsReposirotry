/** 
 * The class provides a custom implementation of output committer setupTask and isRecoverySupported methods, which determines if recovery supported based on config property.
 */
public static class TestFileOutputCommitter extends org.apache.hadoop.mapred.FileOutputCommitter {
  private boolean abortJobCalled;
  @Override public boolean isRecoverySupported(  org.apache.hadoop.mapred.JobContext jobContext){
    boolean isRecoverySupported=false;
    if (jobContext != null && jobContext.getConfiguration() != null) {
      isRecoverySupported=jobContext.getConfiguration().getBoolean("want.am.recovery",false);
    }
    return isRecoverySupported;
  }
  @Override public void abortJob(  JobContext context,  int runState) throws IOException {
    super.abortJob(context,runState);
    this.abortJobCalled=true;
  }
  private boolean isAbortJobCalled(){
    return this.abortJobCalled;
  }
}
