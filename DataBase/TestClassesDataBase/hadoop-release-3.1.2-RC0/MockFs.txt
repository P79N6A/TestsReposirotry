static class MockFs extends ChRootedFs {
  private static Map<String,AbstractFileSystem> fsCache=new HashMap<>();
  MockFs(  URI uri,  Configuration conf) throws URISyntaxException {
    super(getMockFs(uri),new Path("/"));
  }
  static AbstractFileSystem getMockFs(  URI uri){
    AbstractFileSystem mockFs=fsCache.get(uri.getAuthority());
    if (mockFs == null) {
      mockFs=mock(AbstractFileSystem.class);
      when(mockFs.getUri()).thenReturn(uri);
      when(mockFs.getUriDefaultPort()).thenReturn(1);
      when(mockFs.getUriPath(any(Path.class))).thenCallRealMethod();
      when(mockFs.isValidName(anyString())).thenReturn(true);
      fsCache.put(uri.getAuthority(),mockFs);
    }
    return mockFs;
  }
}
