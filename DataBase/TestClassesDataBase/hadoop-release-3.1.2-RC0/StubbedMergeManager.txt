private static class StubbedMergeManager extends MergeManagerImpl<Text,Text> {
  private TestMergeThread mergeThread;
  public StubbedMergeManager(  JobConf conf,  ExceptionReporter reporter,  CyclicBarrier mergeStart,  CyclicBarrier mergeComplete){
    super(null,conf,mock(LocalFileSystem.class),null,null,null,null,null,null,null,null,reporter,null,mock(MapOutputFile.class));
    mergeThread.setSyncBarriers(mergeStart,mergeComplete);
  }
  @Override protected MergeThread<InMemoryMapOutput<Text,Text>,Text,Text> createInMemoryMerger(){
    mergeThread=new TestMergeThread(this,getExceptionReporter());
    return mergeThread;
  }
  public int getNumMerges(){
    return mergeThread.getNumMerges();
  }
}
