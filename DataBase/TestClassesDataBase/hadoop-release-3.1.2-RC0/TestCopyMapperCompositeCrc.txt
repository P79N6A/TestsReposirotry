/** 
 * End-to-end tests for COMPOSITE_CRC combine mode.
 */
public class TestCopyMapperCompositeCrc extends TestCopyMapper {
  @BeforeClass public static void setup() throws Exception {
    Configuration configuration=TestCopyMapper.getConfigurationForCluster();
    configuration.set(HdfsClientConfigKeys.DFS_CHECKSUM_COMBINE_MODE_KEY,"COMPOSITE_CRC");
    TestCopyMapper.setCluster(new MiniDFSCluster.Builder(configuration).numDataNodes(1).format(true).build());
  }
  @Override protected boolean expectDifferentBlockSizesMultipleBlocksToSucceed(){
    return true;
  }
  @Override protected boolean expectDifferentBytesPerCrcToSucceed(){
    return true;
  }
}
