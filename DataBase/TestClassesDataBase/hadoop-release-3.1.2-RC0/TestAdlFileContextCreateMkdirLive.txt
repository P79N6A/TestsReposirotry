/** 
 * Test file context Create/Mkdir operation.
 */
public class TestAdlFileContextCreateMkdirLive extends FileContextCreateMkdirBaseTest {
  private static final String KEY_FILE_SYSTEM="test.fs.adl.name";
  @BeforeClass public static void skipTestCheck(){
    Assume.assumeTrue(AdlStorageConfiguration.isContractTestEnabled());
  }
  @Override public void setUp() throws Exception {
    Configuration conf=AdlStorageConfiguration.getConfiguration();
    String fileSystem=conf.get(KEY_FILE_SYSTEM);
    if (fileSystem == null || fileSystem.trim().length() == 0) {
      throw new Exception("Default file system not configured.");
    }
    URI uri=new URI(fileSystem);
    FileSystem fs=AdlStorageConfiguration.createStorageConnector();
    fc=FileContext.getFileContext(new DelegateToFileSystem(uri,fs,conf,fs.getScheme(),false){
    }
,conf);
    super.setUp();
  }
  @Override protected FileContextTestHelper createFileContextHelper(){
    return new FileContextTestHelper(UUID.randomUUID().toString());
  }
}
