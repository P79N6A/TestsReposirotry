public static class IDReduce extends Reducer<LongWritable,Text,LongWritable,Text> {
  private String name;
  private String prop;
  public IDReduce(  String name,  String prop){
    this.name=name;
    this.prop=prop;
  }
  public void setup(  Context context) throws IOException, InterruptedException {
    Configuration conf=context.getConfiguration();
    assertEquals(prop,conf.get("a"));
    writeFlag(conf,"reduce.setup." + name);
  }
  public void reduce(  LongWritable key,  Iterable<Text> values,  Context context) throws IOException, InterruptedException {
    for (    Text value : values) {
      writeFlag(context.getConfiguration(),"reduce." + name + ".value."+ value);
      context.write(key,new Text(value + name));
    }
  }
  public void cleanup(  Context context) throws IOException, InterruptedException {
    writeFlag(context.getConfiguration(),"reduce.cleanup." + name);
  }
}
