class WriterRunnable implements Runnable {
  private final int id;
  private final Path paths[];
  private final int seed;
  private CountDownLatch latch;
  private AtomicBoolean bFail;
  public WriterRunnable(  int threadIndex,  Path[] paths,  int seed,  CountDownLatch latch,  AtomicBoolean bFail){
    id=threadIndex;
    this.paths=paths;
    this.seed=seed;
    this.latch=latch;
    this.bFail=bFail;
    System.out.println("Creating Writer: " + id);
  }
  public void run(){
    System.out.println("Writer " + id + " starting... ");
    int i=0;
    try {
      for (i=0; i < paths.length; i++) {
        makeRandomTestFile(paths[i],BLOCK_SIZE,true,seed);
      }
    }
 catch (    IOException e) {
      bFail.set(true);
      LOG.error("Writer exception: writer id:" + id + " testfile: "+ paths[i].toString()+ " "+ e);
    }
 finally {
      latch.countDown();
    }
  }
}
