private class TransientErrorInjector extends StorageEvent<SendingRequestEvent> {
  private final ConnectionRecognizer connectionRecognizer;
  private boolean injectedErrorOnce=false;
  public TransientErrorInjector(  ConnectionRecognizer connectionRecognizer){
    this.connectionRecognizer=connectionRecognizer;
  }
  @Override public void eventOccurred(  SendingRequestEvent eventArg){
    HttpURLConnection connection=(HttpURLConnection)eventArg.getConnectionObject();
    if (!connectionRecognizer.isTargetConnection(connection)) {
      return;
    }
    if (!injectedErrorOnce) {
      connection.setReadTimeout(1);
      connection.disconnect();
      injectedErrorOnce=true;
    }
  }
}
