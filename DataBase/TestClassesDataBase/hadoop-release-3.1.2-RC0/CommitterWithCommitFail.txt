static class CommitterWithCommitFail extends FileOutputCommitter {
  public void commitTask(  TaskAttemptContext context) throws IOException {
    Path taskOutputPath=getTaskAttemptPath(context);
    TaskAttemptID attemptId=context.getTaskAttemptID();
    JobConf job=context.getJobConf();
    if (taskOutputPath != null) {
      FileSystem fs=taskOutputPath.getFileSystem(job);
      if (fs.exists(taskOutputPath)) {
        throw new IOException();
      }
    }
  }
}
