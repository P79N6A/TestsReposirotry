/** 
 * Catch the exception and preserve it for later queries.
 */
private static final class CatchCallback implements Retried {
  private IOException lastException;
  @Override public void onFailure(  String text,  IOException exception,  int retries,  boolean idempotent){
    lastException=exception;
  }
}
