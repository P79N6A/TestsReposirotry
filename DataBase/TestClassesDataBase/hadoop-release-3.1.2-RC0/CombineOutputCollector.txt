private class CombineOutputCollector<K,V extends Object> implements OutputCollector<K,V> {
  private Writer<K,V> writer;
  private Counters.Counter outCounter;
  private Progressable progressable;
  public CombineOutputCollector(  Counters.Counter outCounter,  Progressable progressable){
    this.outCounter=outCounter;
    this.progressable=progressable;
  }
  public synchronized void setWriter(  Writer<K,V> writer){
    this.writer=writer;
  }
  public synchronized void collect(  K key,  V value) throws IOException {
    outCounter.increment(1);
    writer.append(key,value);
    progressable.progress();
  }
}
