/** 
 * Aliyun OSS contract seeking tests.
 */
public class TestAliyunOSSContractSeek extends AbstractContractSeekTest {
  @Override protected AbstractFSContract createContract(  Configuration conf){
    return new AliyunOSSContract(conf);
  }
  @Test public void testSeekBeyondDownloadSize() throws Throwable {
    describe("seek and read beyond download size.");
    Path byteFile=path("byte_file.txt");
    byte[] block=dataset(100 * 1024 + 10,0,255);
    FileSystem fs=getFileSystem();
    createFile(fs,byteFile,true,block);
    FSDataInputStream instream=getFileSystem().open(byteFile);
    instream.seek(100 * 1024 - 1);
    assertEquals(100 * 1024 - 1,instream.getPos());
    assertEquals(144,instream.read());
    instream.seek(100 * 1024 + 1);
    assertEquals(100 * 1024 + 1,instream.getPos());
    assertEquals(146,instream.read());
  }
}
