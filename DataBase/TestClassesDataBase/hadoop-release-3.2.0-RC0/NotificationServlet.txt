public static class NotificationServlet extends HttpServlet {
  public static volatile int counter=0;
  public static volatile int failureCounter=0;
  private static final long serialVersionUID=1L;
  protected void doGet(  HttpServletRequest req,  HttpServletResponse res) throws ServletException, IOException {
    String queryString=req.getQueryString();
switch (counter) {
case 0:
      verifyQuery(queryString,"SUCCEEDED");
    break;
case 2:
  verifyQuery(queryString,"KILLED");
break;
case 4:
verifyQuery(queryString,"FAILED");
break;
}
if (counter % 2 == 0) {
res.sendError(HttpServletResponse.SC_BAD_REQUEST,"forcing error");
}
 else {
res.setStatus(HttpServletResponse.SC_OK);
}
counter++;
}
protected void verifyQuery(String query,String expected) throws IOException {
if (query.contains(expected)) {
return;
}
failureCounter++;
assertTrue("The request (" + query + ") does not contain "+ expected,false);
}
}
