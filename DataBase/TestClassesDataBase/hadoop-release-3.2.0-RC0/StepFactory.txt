public static class StepFactory extends RecordFactory {
  public int prekey;
  public int postkey;
  public int preval;
  public int postval;
  public int steprec;
  public void setConf(  Configuration conf){
    prekey=conf.getInt("test.stepfactory.prekey",0);
    postkey=conf.getInt("test.stepfactory.postkey",0);
    preval=conf.getInt("test.stepfactory.preval",0);
    postval=conf.getInt("test.stepfactory.postval",0);
    steprec=conf.getInt("test.stepfactory.steprec",0);
  }
  public static void setLengths(  Configuration conf,  int prekey,  int postkey,  int preval,  int postval,  int steprec){
    conf.setInt("test.stepfactory.prekey",prekey);
    conf.setInt("test.stepfactory.postkey",postkey);
    conf.setInt("test.stepfactory.preval",preval);
    conf.setInt("test.stepfactory.postval",postval);
    conf.setInt("test.stepfactory.steprec",steprec);
  }
  public int keyLen(  int i){
    return i > steprec ? postkey : prekey;
  }
  public int valLen(  int i){
    return i > steprec ? postval : preval;
  }
}
