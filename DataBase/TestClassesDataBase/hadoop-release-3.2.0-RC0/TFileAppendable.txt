static class TFileAppendable implements KVAppendable {
  private FSDataOutputStream fsdos;
  private TFile.Writer writer;
  public TFileAppendable(  FileSystem fs,  Path path,  String compress,  int minBlkSize,  int osBufferSize,  Configuration conf) throws IOException {
    this.fsdos=fs.create(path,true,osBufferSize);
    this.writer=new TFile.Writer(fsdos,minBlkSize,compress,null,conf);
  }
  @Override public void append(  BytesWritable key,  BytesWritable value) throws IOException {
    writer.append(key.getBytes(),0,key.getLength(),value.getBytes(),0,value.getLength());
  }
  @Override public void close() throws IOException {
    writer.close();
    fsdos.close();
  }
}
