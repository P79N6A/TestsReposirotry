private class SometimesFaulty<T> implements Answer<ListenableFuture<T>> {
  private final float faultProbability;
  public SometimesFaulty(  float faultProbability){
    this.faultProbability=faultProbability;
  }
  @SuppressWarnings("unchecked") @Override public ListenableFuture<T> answer(  InvocationOnMock invocation) throws Throwable {
    if (r.nextFloat() < faultProbability) {
      return Futures.immediateFailedFuture(new IOException("Injected fault"));
    }
    return (ListenableFuture<T>)invocation.callRealMethod();
  }
}
