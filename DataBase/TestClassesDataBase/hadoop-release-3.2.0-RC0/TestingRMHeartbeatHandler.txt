private static class TestingRMHeartbeatHandler implements RMHeartbeatHandler {
  private long lastHeartbeatTime=0;
  private ConcurrentLinkedQueue<Runnable> callbacks=new ConcurrentLinkedQueue<Runnable>();
  @Override public long getLastHeartbeatTime(){
    return lastHeartbeatTime;
  }
  @Override public void runOnNextHeartbeat(  Runnable callback){
    callbacks.add(callback);
  }
  public void setLastHeartbeatTime(  long timestamp){
    lastHeartbeatTime=timestamp;
    Runnable callback=null;
    while ((callback=callbacks.poll()) != null) {
      callback.run();
    }
  }
  public int getNumCallbacks(){
    return callbacks.size();
  }
}
