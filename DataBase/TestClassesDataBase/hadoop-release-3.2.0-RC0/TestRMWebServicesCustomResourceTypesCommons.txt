public class TestRMWebServicesCustomResourceTypesCommons {
  static void verifyAppsXML(  NodeList appArray,  RMApp app,  ResourceManager rm){
    for (int i=0; i < appArray.getLength(); i++) {
      Element element=(Element)appArray.item(i);
      AppInfoXmlVerifications.verify(element,app);
      NodeList resourceRequests=element.getElementsByTagName("resourceRequests");
      assertEquals(1,resourceRequests.getLength());
      Node resourceRequest=resourceRequests.item(0);
      ResourceRequest rr=((AbstractYarnScheduler)rm.getRMContext().getScheduler()).getApplicationAttempt(app.getCurrentAppAttempt().getAppAttemptId()).getAppSchedulingInfo().getAllResourceRequests().get(0);
      ResourceRequestsXmlVerifications.verifyWithCustomResourceTypes((Element)resourceRequest,rr,CustomResourceTypesConfigurationProvider.getCustomResourceTypes());
    }
  }
  static void verifyAppInfoJson(  JSONObject info,  RMApp app,  ResourceManager rm) throws JSONException {
    int expectedNumberOfElements=getExpectedNumberOfElements(app);
    assertEquals("incorrect number of elements",expectedNumberOfElements,info.length());
    AppInfoJsonVerifications.verify(info,app);
    JSONArray resourceRequests=info.getJSONArray("resourceRequests");
    JSONObject requestInfo=resourceRequests.getJSONObject(0);
    ResourceRequest rr=((AbstractYarnScheduler)rm.getRMContext().getScheduler()).getApplicationAttempt(app.getCurrentAppAttempt().getAppAttemptId()).getAppSchedulingInfo().getAllResourceRequests().get(0);
    ResourceRequestsJsonVerifications.verifyWithCustomResourceTypes(requestInfo,rr,CustomResourceTypesConfigurationProvider.getCustomResourceTypes());
  }
  static int getExpectedNumberOfElements(  RMApp app){
    int expectedNumberOfElements=40 + 2;
    if (app.getApplicationSubmissionContext().getNodeLabelExpression() != null) {
      expectedNumberOfElements++;
    }
    if (app.getAMResourceRequests().get(0).getNodeLabelExpression() != null) {
      expectedNumberOfElements++;
    }
    if (AppInfo.getAmRPCAddressFromRMAppAttempt(app.getCurrentAppAttempt()) != null) {
      expectedNumberOfElements++;
    }
    return expectedNumberOfElements;
  }
}
