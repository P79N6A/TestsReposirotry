private static class ClientCallable implements Callable<Writable> {
  private final InetSocketAddress address;
  private final Configuration conf;
  final byte[] requestBytes;
  private ClientCallable(  InetSocketAddress address,  Configuration conf,  byte[] requestBytes){
    this.address=address;
    this.conf=conf;
    this.requestBytes=requestBytes;
  }
  @Override public Writable call() throws Exception {
    Client client=new Client(BytesWritable.class,conf);
    Writable param=new BytesWritable(requestBytes);
    final Client.ConnectionId remoteId=Client.ConnectionId.getConnectionId(address,null,null,0,null,conf);
    Writable result=client.call(RPC.RpcKind.RPC_BUILTIN,param,remoteId,new AtomicBoolean(false));
    return result;
  }
}
