public class TestTaskAttemptReport {
  @Test public void testSetRawCounters(){
    TaskAttemptReport report=Records.newRecord(TaskAttemptReport.class);
    org.apache.hadoop.mapreduce.Counters rCounters=MockJobs.newCounters();
    report.setRawCounters(rCounters);
    Counters counters=report.getCounters();
    assertNotEquals(null,counters);
  }
  @Test public void testBuildImplicitRawCounters(){
    TaskAttemptReportPBImpl report=new TaskAttemptReportPBImpl();
    org.apache.hadoop.mapreduce.Counters rCounters=MockJobs.newCounters();
    report.setRawCounters(rCounters);
    MRProtos.TaskAttemptReportProto protoVal=report.getProto();
    Counters counters=report.getCounters();
    assertTrue(protoVal.hasCounters());
  }
  @Test public void testCountersOverRawCounters(){
    TaskAttemptReport report=Records.newRecord(TaskAttemptReport.class);
    org.apache.hadoop.mapreduce.Counters rCounters=MockJobs.newCounters();
    Counters altCounters=TypeConverter.toYarn(rCounters);
    report.setRawCounters(rCounters);
    report.setCounters(altCounters);
    Counters counters=report.getCounters();
    assertNotEquals(null,counters);
    assertNotEquals(rCounters,altCounters);
    assertEquals(counters,altCounters);
  }
  @Test public void testUninitializedCounters(){
    TaskAttemptReport report=Records.newRecord(TaskAttemptReport.class);
    assertEquals(null,report.getCounters());
    assertEquals(null,report.getRawCounters());
  }
  @Test public void testSetRawCountersToNull(){
    TaskAttemptReport report=Records.newRecord(TaskAttemptReport.class);
    report.setRawCounters(null);
    assertEquals(null,report.getCounters());
    assertEquals(null,report.getRawCounters());
  }
  @Test public void testSetCountersToNull(){
    TaskAttemptReport report=Records.newRecord(TaskAttemptReport.class);
    report.setCounters(null);
    assertEquals(null,report.getCounters());
    assertEquals(null,report.getRawCounters());
  }
  @Test public void testSetNonNullCountersToNull(){
    TaskAttemptReport report=Records.newRecord(TaskAttemptReport.class);
    org.apache.hadoop.mapreduce.Counters rCounters=MockJobs.newCounters();
    report.setRawCounters(rCounters);
    Counters counters=report.getCounters();
    assertNotEquals(null,counters);
    report.setCounters(null);
    assertEquals(null,report.getCounters());
    assertEquals(null,report.getRawCounters());
  }
  @Test public void testSetNonNullRawCountersToNull(){
    TaskAttemptReport report=Records.newRecord(TaskAttemptReport.class);
    org.apache.hadoop.mapreduce.Counters rCounters=MockJobs.newCounters();
    report.setRawCounters(rCounters);
    Counters counters=report.getCounters();
    assertNotEquals(null,counters);
    report.setRawCounters(null);
    assertEquals(null,report.getCounters());
    assertEquals(null,report.getRawCounters());
  }
}
