/** 
 * Monitor containers running on NMs
 */
class NMContainerMonitor implements Runnable {
  final static int SAMPLING_INTERVAL_MS=500;
  int[] maxRunningContainersOnNMs=new int[NUM_NMS];
  @Override public void run(){
    while (true) {
      for (int i=0; i < NUM_NMS; i++) {
        int nContainers=distShellTest.yarnCluster.getNodeManager(i).getNMContext().getContainers().size();
        if (nContainers > maxRunningContainersOnNMs[i]) {
          maxRunningContainersOnNMs[i]=nContainers;
        }
      }
      try {
        Thread.sleep(SAMPLING_INTERVAL_MS);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
        break;
      }
    }
  }
  public int[] getMaxRunningContainersReport(){
    return maxRunningContainersOnNMs;
  }
}
