/** 
 * File deletion
 */
static class FileDeletion extends Modification {
  private final HashMap<Path,Boolean> snapshotFileExistenceMap;
  FileDeletion(  Path file,  FileSystem fs){
    super(file,fs,"deletion");
    snapshotFileExistenceMap=new HashMap<Path,Boolean>();
  }
  @Override void loadSnapshots() throws Exception {
    for (    Path snapshotRoot : snapshotList) {
      boolean existence=SnapshotTestHelper.getSnapshotFile(snapshotRoot,file) != null;
      snapshotFileExistenceMap.put(snapshotRoot,existence);
    }
  }
  @Override void modify() throws Exception {
    fs.delete(file,true);
  }
  @Override void checkSnapshots() throws Exception {
    for (    Path snapshotRoot : snapshotList) {
      boolean currentSnapshotFileExist=SnapshotTestHelper.getSnapshotFile(snapshotRoot,file) != null;
      boolean originalSnapshotFileExist=snapshotFileExistenceMap.get(snapshotRoot);
      assertEquals(currentSnapshotFileExist,originalSnapshotFileExist);
    }
  }
}
