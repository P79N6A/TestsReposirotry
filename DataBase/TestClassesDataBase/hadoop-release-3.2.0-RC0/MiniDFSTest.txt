/** 
 * Provides setup/teardown of a MiniDFSCluster for tests that need one.
 */
public static class MiniDFSTest extends HadoopTestBase {
  private static MiniDFSClusterService hdfs;
  private static JobConf conf=null;
  protected static JobConf getConfiguration(){
    return conf;
  }
  protected static FileSystem getDFS(){
    return hdfs.getClusterFS();
  }
  /** 
 * Setup the mini HDFS cluster.
 * @throws IOException Failure
 */
  @BeforeClass @SuppressWarnings("deprecation") public static void setupHDFS() throws IOException {
    if (hdfs == null) {
      JobConf c=new JobConf();
      hdfs=new MiniDFSClusterService();
      hdfs.init(c);
      hdfs.start();
      conf=c;
    }
  }
  @SuppressWarnings("ThrowableNotThrown") @AfterClass public static void teardownFS() throws IOException {
    ServiceOperations.stopQuietly(hdfs);
    conf=null;
    hdfs=null;
  }
}
