private static class WaitingOutputCommitter extends TestingOutputCommitter {
  public WaitingOutputCommitter(  CyclicBarrier syncBarrier,  boolean shouldSucceed){
    super(syncBarrier,shouldSucceed);
  }
  @Override public void commitJob(  JobContext jobContext) throws IOException {
    try {
      syncBarrier.await();
    }
 catch (    BrokenBarrierException e) {
    }
catch (    InterruptedException e) {
    }
    while (!Thread.interrupted()) {
      try {
synchronized (this) {
          wait();
        }
      }
 catch (      InterruptedException e) {
        break;
      }
    }
  }
}
