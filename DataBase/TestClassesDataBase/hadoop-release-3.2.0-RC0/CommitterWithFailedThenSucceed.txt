/** 
 * The class provides a overrided implementation of commitJobInternal which causes the commit failed for the first time then succeed.
 */
public static class CommitterWithFailedThenSucceed extends FileOutputCommitter {
  boolean firstTimeFail=true;
  public CommitterWithFailedThenSucceed(  Path outputPath,  JobContext context) throws IOException {
    super(outputPath,context);
  }
  @Override protected void commitJobInternal(  JobContext context) throws IOException {
    super.commitJobInternal(context);
    if (firstTimeFail) {
      firstTimeFail=false;
      throw new IOException();
    }
 else {
    }
  }
}
