class FakeContainerLocalizerWrapper extends ContainerLocalizerWrapper {
  private int heartbeatResponse=0;
  public FakeContainerLocalizer init() throws Exception {
    FileContext fs=FileContext.getLocalFSFileContext();
    FakeContainerLocalizer localizer=setupContainerLocalizerForTest();
    List<Path> privCacheList=new ArrayList<Path>();
    for (    Path p : localDirs) {
      Path base=new Path(new Path(p,ContainerLocalizer.USERCACHE),appUser);
      Path privcache=new Path(base,ContainerLocalizer.FILECACHE);
      privCacheList.add(privcache);
    }
    ResourceLocalizationSpec rsrc=getMockRsrc(random,LocalResourceVisibility.PRIVATE,privCacheList.get(0));
    doAnswer(new Answer<MockLocalizerHeartbeatResponse>(){
      @Override public MockLocalizerHeartbeatResponse answer(      InvocationOnMock invocationOnMock) throws Throwable {
        if (heartbeatResponse == 0) {
          return new MockLocalizerHeartbeatResponse(LocalizerAction.LIVE,Collections.singletonList(rsrc));
        }
 else         if (heartbeatResponse < 2) {
          return new MockLocalizerHeartbeatResponse(LocalizerAction.LIVE,Collections.<ResourceLocalizationSpec>emptyList());
        }
 else {
          return new MockLocalizerHeartbeatResponse(LocalizerAction.DIE,null);
        }
      }
    }
).when(nmProxy).heartbeat(isA(LocalizerStatus.class));
    return localizer;
  }
}
