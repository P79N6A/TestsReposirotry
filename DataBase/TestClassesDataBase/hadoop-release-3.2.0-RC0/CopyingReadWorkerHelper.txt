/** 
 * Uses the read(byte[]...) style APIs
 */
static class CopyingReadWorkerHelper implements ReadWorkerHelper {
  @Override public int read(  DFSInputStream dis,  byte[] target,  int startOff,  int len) throws IOException {
    int cnt=0;
synchronized (dis) {
      dis.seek(startOff);
      while (cnt < len) {
        int read=dis.read(target,cnt,len - cnt);
        if (read == -1) {
          return read;
        }
        cnt+=read;
      }
    }
    return cnt;
  }
  @Override public int pRead(  DFSInputStream dis,  byte[] target,  int startOff,  int len) throws IOException {
    int cnt=0;
    while (cnt < len) {
      int read=dis.read(startOff,target,cnt,len - cnt);
      if (read == -1) {
        return read;
      }
      cnt+=read;
    }
    return cnt;
  }
}
