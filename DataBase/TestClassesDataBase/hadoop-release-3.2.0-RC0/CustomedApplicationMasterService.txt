private class CustomedApplicationMasterService extends ApplicationMasterService {
  public CustomedApplicationMasterService(  RMContext rmContext,  YarnScheduler scheduler){
    super(rmContext,scheduler);
  }
  @Override public AllocateResponse allocate(  AllocateRequest request) throws YarnException, IOException {
    resetStartFailoverFlag(true);
    Assert.assertTrue(waittingForFailOver());
    return createFakeAllocateResponse();
  }
  @Override public RegisterApplicationMasterResponse registerApplicationMaster(  RegisterApplicationMasterRequest request) throws YarnException, IOException {
    resetStartFailoverFlag(true);
    Assert.assertTrue(waittingForFailOver());
    return createFakeRegisterApplicationMasterResponse();
  }
  @Override public FinishApplicationMasterResponse finishApplicationMaster(  FinishApplicationMasterRequest request) throws YarnException, IOException {
    resetStartFailoverFlag(true);
    Assert.assertTrue(waittingForFailOver());
    return createFakeFinishApplicationMasterResponse();
  }
}
