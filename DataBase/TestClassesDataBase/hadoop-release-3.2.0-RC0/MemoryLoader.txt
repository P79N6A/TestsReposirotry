/** 
 * Increases the JVM's heap usage to the specified target value.
 */
static class MemoryLoader {
  private static final int DEFAULT_UNIT_LOAD_SIZE=10 * 1024 * 1024;
  private long targetValue;
  private List<String> loadObjects=new ArrayList<String>();
  MemoryLoader(  long targetValue){
    this.targetValue=targetValue;
  }
  /** 
 * Loads the memory to the target value.
 */
  void load(){
    while (Runtime.getRuntime().totalMemory() < targetValue) {
      System.out.println("Loading memory with " + DEFAULT_UNIT_LOAD_SIZE + " characters. Current usage : "+ Runtime.getRuntime().totalMemory());
      loadObjects.add(RandomStringUtils.random(DEFAULT_UNIT_LOAD_SIZE));
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException ie) {
      }
    }
  }
}
