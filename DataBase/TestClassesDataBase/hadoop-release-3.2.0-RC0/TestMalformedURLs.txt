public class TestMalformedURLs {
  private MiniDFSCluster cluster;
  Configuration config;
  @Before public void setUp() throws Exception {
    Configuration.addDefaultResource("hdfs-site.malformed.xml");
    config=new Configuration();
  }
  @Test public void testTryStartingCluster() throws Exception {
    assertNotEquals(config.get(DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY),config.getTrimmed(DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY));
    cluster=new MiniDFSCluster.Builder(config).build();
    cluster.waitActive();
  }
  @After public void tearDown() throws Exception {
    if (cluster != null) {
      cluster.shutdown();
      cluster=null;
    }
  }
}
