/** 
 * Tests for ACL operation through FileContext APIs
 */
public class TestFileContextAcl extends FSAclBaseTest {
  @BeforeClass public static void init() throws Exception {
    conf=new Configuration();
    startCluster();
  }
  @Override protected FileSystem createFileSystem() throws Exception {
    FileContextFS fcFs=new FileContextFS();
    fcFs.initialize(FileSystem.getDefaultUri(conf),conf);
    return fcFs;
  }
public static class FileContextFS extends DistributedFileSystem {
    private FileContext fc;
    @Override public void initialize(    URI uri,    Configuration conf) throws IOException {
      super.initialize(uri,conf);
      fc=FileContext.getFileContext(conf);
    }
    @Override public void modifyAclEntries(    Path path,    List<AclEntry> aclSpec) throws IOException {
      fc.modifyAclEntries(path,aclSpec);
    }
    @Override public void removeAclEntries(    Path path,    List<AclEntry> aclSpec) throws IOException {
      fc.removeAclEntries(path,aclSpec);
    }
    @Override public void removeDefaultAcl(    Path path) throws IOException {
      fc.removeDefaultAcl(path);
    }
    @Override public void removeAcl(    Path path) throws IOException {
      fc.removeAcl(path);
    }
    @Override public void setAcl(    Path path,    List<AclEntry> aclSpec) throws IOException {
      fc.setAcl(path,aclSpec);
    }
    @Override public AclStatus getAclStatus(    Path path) throws IOException {
      return fc.getAclStatus(path);
    }
  }
}
