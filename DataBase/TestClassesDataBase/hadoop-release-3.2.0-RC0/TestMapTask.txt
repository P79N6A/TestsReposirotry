/** 
 * Map Task that overrides run method and uses TestTaskReporter instead of TaskReporter and uses FakeUmbilical.
 */
class TestMapTask extends MapTask {
  public TestMapTask(  String jobFile,  TaskAttemptID taskId,  int partition,  TaskSplitIndex splitIndex,  int numSlotsRequired){
    super(jobFile,taskId,partition,splitIndex,numSlotsRequired);
  }
  /** 
 * Create a TestTaskReporter and use it for validating map phase progress
 */
  @Override TaskReporter startReporter(  final TaskUmbilicalProtocol umbilical){
    TaskReporter reporter=new TestTaskReporter(map);
    return reporter;
  }
}
