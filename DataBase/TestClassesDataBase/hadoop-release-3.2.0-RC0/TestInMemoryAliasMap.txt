/** 
 * TestInMemoryAliasMap tests the initialization of an AliasMap. Most of the rest of the tests are in ITestInMemoryAliasMap since the tests are not thread safe (there is competition for the port).
 */
public class TestInMemoryAliasMap {
  @Test public void testInit(){
    String nonExistingDirectory="non-existing-directory";
    Configuration conf=new Configuration();
    conf.set(DFSConfigKeys.DFS_PROVIDED_ALIASMAP_INMEMORY_LEVELDB_DIR,nonExistingDirectory);
    assertThatExceptionOfType(IOException.class).isThrownBy(() -> InMemoryAliasMap.init(conf,"bpid")).withMessage(InMemoryAliasMap.createPathErrorMessage(nonExistingDirectory));
  }
}
