/** 
 * Subclass of  {@link HadoopYarnProtoRPC} which captures the current UGI ina static variable.  Used by  {@link #testProxyUserCorrectUGI()}.
 */
public static class UGICapturingHadoopYarnProtoRPC extends HadoopYarnProtoRPC {
  static UserGroupInformation lastCurrentUser=null;
  @Override public Object getProxy(  Class protocol,  InetSocketAddress addr,  Configuration conf){
    UserGroupInformation currentUser=null;
    try {
      currentUser=UserGroupInformation.getCurrentUser();
    }
 catch (    IOException ioe) {
      Assert.fail("Unable to get current user\n" + StringUtils.stringifyException(ioe));
    }
    lastCurrentUser=currentUser;
    return super.getProxy(protocol,addr,conf);
  }
}
