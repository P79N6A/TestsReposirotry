/** 
 * Class to verify HADOOP-11932. Instead of reading from HTTP, going in loop until closed.
 */
private static class TestClosableSink implements MetricsSink, Closeable {
  boolean closed=false;
  CountDownLatch collectingLatch;
  public TestClosableSink(  CountDownLatch collectingLatch){
    this.collectingLatch=collectingLatch;
  }
  @Override public void init(  SubsetConfiguration conf){
  }
  @Override public void close() throws IOException {
    closed=true;
  }
  @Override public void putMetrics(  MetricsRecord record){
    while (!closed) {
      collectingLatch.countDown();
    }
  }
  @Override public void flush(){
  }
}
