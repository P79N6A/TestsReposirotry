/** 
 * Dummy class to extend CombineFileInputFormat. It allows testing with files having missing blocks without actually removing replicas.
 */
public static class MissingBlockFileSystem extends DistributedFileSystem {
  String fileWithMissingBlocks;
  @Override public void initialize(  URI name,  Configuration conf) throws IOException {
    fileWithMissingBlocks="";
    super.initialize(name,conf);
  }
  @Override public BlockLocation[] getFileBlockLocations(  FileStatus stat,  long start,  long len) throws IOException {
    if (stat.isDirectory()) {
      return null;
    }
    System.out.println("File " + stat.getPath());
    String name=stat.getPath().toUri().getPath();
    BlockLocation[] locs=super.getFileBlockLocations(stat,start,len);
    if (name.equals(fileWithMissingBlocks)) {
      System.out.println("Returning missing blocks for " + fileWithMissingBlocks);
      locs[0]=new HdfsBlockLocation(new BlockLocation(new String[0],new String[0],locs[0].getOffset(),locs[0].getLength()),null);
    }
    return locs;
  }
  public void setFileWithMissingBlocks(  String f){
    fileWithMissingBlocks=f;
  }
}
