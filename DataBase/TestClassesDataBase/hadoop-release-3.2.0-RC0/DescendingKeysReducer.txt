/** 
 * Checks whether keys are in ascending order.  
 */
static class DescendingKeysReducer implements Reducer<IntWritable,Writable,IntWritable,Text> {
  public void configure(  JobConf job){
  }
  private int lastKey=Integer.MAX_VALUE;
  public void reduce(  IntWritable key,  Iterator<Writable> values,  OutputCollector<IntWritable,Text> out,  Reporter reporter) throws IOException {
    int currentKey=key.get();
    if (currentKey > lastKey) {
      fail("Keys not in sorted descending order");
    }
    lastKey=currentKey;
    out.collect(key,new Text("success"));
  }
  public void close(){
  }
}
