/** 
 * Closeable which can be used to safely close writers in a try-with-resources block..
 */
protected static class CloseWriter implements AutoCloseable {
  private final RecordWriter writer;
  private final TaskAttemptContext context;
  public CloseWriter(  RecordWriter writer,  TaskAttemptContext context){
    this.writer=writer;
    this.context=context;
  }
  @Override public void close(){
    try {
      writer.close(context);
    }
 catch (    IOException|InterruptedException e) {
      LOG.error("When closing {} on context {}",writer,context,e);
    }
  }
}
