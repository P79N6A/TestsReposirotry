private static class MyRetriableCommand extends RetriableCommand {
  private int succeedAfter;
  private int retryCount=0;
  public MyRetriableCommand(  int succeedAfter){
    super("MyRetriableCommand");
    this.succeedAfter=succeedAfter;
  }
  public MyRetriableCommand(  int succeedAfter,  RetryPolicy retryPolicy){
    super("MyRetriableCommand",retryPolicy);
    this.succeedAfter=succeedAfter;
  }
  @Override protected Object doExecute(  Object... arguments) throws Exception {
    if (++retryCount < succeedAfter)     throw new Exception("Transient failure#" + retryCount);
    return 0;
  }
}
