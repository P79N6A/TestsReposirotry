/** 
 * Each record received by this mapper is a number 'n'. Emit the values [0..n-1]
 */
public static class SequenceMapper extends Mapper<LongWritable,Text,Text,NullWritable> {
  public void map(  LongWritable k,  Text v,  Context c) throws IOException, InterruptedException {
    int max=Integer.valueOf(v.toString());
    for (int i=0; i < max; i++) {
      c.write(new Text("" + i),NullWritable.get());
    }
  }
}
