static class MyOutputFormatWithCustomAbort<K,V> extends TextOutputFormat<K,V> {
  private OutputCommitter committer=null;
  public synchronized OutputCommitter getOutputCommitter(  TaskAttemptContext context) throws IOException {
    if (committer == null) {
      Path output=getOutputPath(context);
      committer=new CommitterWithCustomAbort(output,context);
    }
    return committer;
  }
}
