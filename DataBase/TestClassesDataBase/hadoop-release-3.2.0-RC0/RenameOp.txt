/** 
 * rename 
 */
class RenameOp extends AtMostOnceOp {
  private final String oldName;
  private final String newName;
  private boolean renamed;
  RenameOp(  DFSClient client,  String oldName,  String newName){
    super("rename",client);
    this.oldName=oldName;
    this.newName=newName;
  }
  @Override void prepare() throws Exception {
    final Path filePath=new Path(oldName);
    if (!dfs.exists(filePath)) {
      DFSTestUtil.createFile(dfs,filePath,BlockSize,DataNodes,0);
    }
  }
  @SuppressWarnings("deprecation") @Override void invoke() throws Exception {
    this.renamed=client.rename(oldName,newName);
  }
  @Override boolean checkNamenodeBeforeReturn() throws Exception {
    Path targetPath=new Path(newName);
    boolean renamed=dfs.exists(targetPath);
    for (int i=0; i < CHECKTIMES && !renamed; i++) {
      Thread.sleep(1000);
      renamed=dfs.exists(targetPath);
    }
    return renamed;
  }
  @Override Object getResult(){
    return new Boolean(renamed);
  }
}
