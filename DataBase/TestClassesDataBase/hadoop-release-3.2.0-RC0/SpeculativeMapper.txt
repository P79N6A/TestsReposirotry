public static class SpeculativeMapper extends Mapper<Object,Text,Text,IntWritable> {
  public void map(  Object key,  Text value,  Context context) throws IOException, InterruptedException {
    TaskAttemptID taid=context.getTaskAttemptID();
    long sleepTime=100;
    Configuration conf=context.getConfiguration();
    boolean test_speculate_map=conf.getBoolean(MRJobConfig.MAP_SPECULATIVE,false);
    if ((taid.getTaskType() == TaskType.MAP) && test_speculate_map && (taid.getTaskID().getId() == 0)&& (taid.getId() == 0)) {
      sleepTime=10000;
    }
    try {
      Thread.sleep(sleepTime);
    }
 catch (    InterruptedException ie) {
    }
    context.write(value,new IntWritable(1));
  }
}
