@SuppressWarnings("unchecked") static class ProgressCheckerMapper extends Mapper<LongWritable,Text,Text,Text> {
  private int recordCount=0;
  private float progressRange=0;
  @Override protected void setup(  Context context) throws IOException {
    assertEquals("Invalid progress in map setup",0.0f,context.getProgress(),0f);
    if (context.getNumReduceTasks() == 0) {
      progressRange=1f;
    }
 else {
      progressRange=0.667f;
    }
  }
  @Override protected void map(  LongWritable key,  Text value,  org.apache.hadoop.mapreduce.Mapper.Context context) throws IOException, InterruptedException {
    float mapPhaseProgress=((float)++recordCount) / INPUT_LINES;
    float weightedMapProgress=progressRange * mapPhaseProgress;
    assertEquals("Invalid progress in map",weightedMapProgress,context.getProgress(),0f);
    context.write(new Text(value.toString() + recordCount),value);
  }
  protected void cleanup(  Mapper.Context context) throws IOException, InterruptedException {
    assertEquals("Invalid progress in map cleanup",progressRange,context.getProgress(),0f);
  }
}
