class LeveldbStateStoreTester implements RMStateStoreHelper {
  @Override public RMStateStore getRMStateStore() throws Exception {
    if (stateStore != null) {
      stateStore.close();
    }
    stateStore=new LeveldbRMStateStore();
    stateStore.init(conf);
    stateStore.start();
    stateStore.dispatcher.disableExitOnDispatchException();
    return stateStore;
  }
  @Override public boolean isFinalStateValid() throws Exception {
    return stateStore.getNumEntriesInDatabase() == 6;
  }
  @Override public void writeVersion(  Version version) throws Exception {
    stateStore.dbStoreVersion(version);
  }
  @Override public Version getCurrentVersion() throws Exception {
    return stateStore.getCurrentVersion();
  }
  @Override public boolean appExists(  RMApp app) throws Exception {
    if (stateStore.isClosed()) {
      getRMStateStore();
    }
    return stateStore.loadRMAppState(app.getApplicationId()) != null;
  }
  @Override public boolean attemptExists(  RMAppAttempt attempt) throws Exception {
    if (stateStore.isClosed()) {
      getRMStateStore();
    }
    return stateStore.loadRMAppAttemptState(attempt.getAppAttemptId()) != null;
  }
}
