/** 
 * This test replicates the condition os MAPREDUCE-3431 -a failure during startup triggered an NPE during shutdown
 */
public class TestDelegationTokenRenewerLifecycle {
  @Test public void testStartupFailure() throws Exception {
    Configuration conf=new Configuration();
    DelegationTokenRenewer delegationTokenRenewer=new DelegationTokenRenewer();
    RMContext mockContext=mock(RMContext.class);
    ClientRMService mockClientRMService=mock(ClientRMService.class);
    when(mockContext.getClientRMService()).thenReturn(mockClientRMService);
    delegationTokenRenewer.setRMContext(mockContext);
    delegationTokenRenewer.init(conf);
    delegationTokenRenewer.stop();
  }
}
