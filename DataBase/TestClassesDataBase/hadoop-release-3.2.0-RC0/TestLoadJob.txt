public class TestLoadJob extends CommonJobTest {
  public static final Logger LOG=getLogger(Gridmix.class);
static {
    GenericTestUtils.setLogLevel(getLogger("org.apache.hadoop.mapred.gridmix"),Level.DEBUG);
    GenericTestUtils.setLogLevel(getLogger(StressJobFactory.class),Level.DEBUG);
  }
  @BeforeClass public static void init() throws IOException {
    GridmixTestUtils.initCluster(TestLoadJob.class);
  }
  @AfterClass public static void shutDown() throws IOException {
    GridmixTestUtils.shutdownCluster();
  }
  @Test(timeout=500000) public void testSerialSubmit() throws Exception {
    policy=GridmixJobSubmissionPolicy.SERIAL;
    LOG.info("Serial started at " + System.currentTimeMillis());
    doSubmission(JobCreator.LOADJOB.name(),false);
    LOG.info("Serial ended at " + System.currentTimeMillis());
  }
  @Test(timeout=500000) public void testReplaySubmit() throws Exception {
    policy=GridmixJobSubmissionPolicy.REPLAY;
    LOG.info(" Replay started at " + System.currentTimeMillis());
    doSubmission(JobCreator.LOADJOB.name(),false);
    LOG.info(" Replay ended at " + System.currentTimeMillis());
  }
}
