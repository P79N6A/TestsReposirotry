public class KeyValueIterator implements RawKeyValueIterator {
  int count=0;
  BytesWritable key;
  BytesWritable value;
  @Override public DataInputBuffer getKey() throws IOException {
    return convert(key);
  }
  @Override public DataInputBuffer getValue() throws IOException {
    return convert(value);
  }
  private DataInputBuffer convert(  BytesWritable b) throws IOException {
    final ByteArrayOutputStream out=new ByteArrayOutputStream();
    b.write(new DataOutputStream(out));
    final byte[] array=out.toByteArray();
    final DataInputBuffer result=new DataInputBuffer();
    result.reset(array,array.length);
    return result;
  }
  @Override public boolean next() throws IOException {
    if (count < INPUT_KV_COUNT) {
      key=dataInput[count].key;
      value=dataInput[count].key;
      count++;
      return true;
    }
    return false;
  }
  @Override public void close() throws IOException {
  }
  @Override public Progress getProgress(){
    return null;
  }
}
