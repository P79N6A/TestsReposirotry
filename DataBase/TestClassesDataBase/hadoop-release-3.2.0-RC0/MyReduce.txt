private static class MyReduce extends IdentityReducer {
  private JobConf conf;
  private boolean compressInput;
  private boolean first=true;
  @Override public void configure(  JobConf conf){
    this.conf=conf;
    compressInput=conf.getCompressMapOutput();
  }
  public void reduce(  WritableComparable key,  Iterator values,  OutputCollector output,  Reporter reporter) throws IOException {
    if (first) {
      first=false;
      MapOutputFile mapOutputFile=new MROutputFiles();
      mapOutputFile.setConf(conf);
      Path input=mapOutputFile.getInputFile(0);
      FileSystem fs=FileSystem.get(conf);
      assertTrue("reduce input exists " + input,fs.exists(input));
      SequenceFile.Reader rdr=new SequenceFile.Reader(fs,input,conf);
      assertEquals("is reduce input compressed " + input,compressInput,rdr.isCompressed());
      rdr.close();
    }
  }
}
