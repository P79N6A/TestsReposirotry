/** 
 * To test proper closing of underlying stream of CryptoOutputStream.
 */
public class TestCryptoOutputStreamClosing {
  private static CryptoCodec codec;
  @BeforeClass public static void init() throws Exception {
    codec=CryptoCodec.getInstance(new Configuration());
  }
  @Test public void testOutputStreamClosing() throws Exception {
    OutputStream outputStream=mock(OutputStream.class);
    CryptoOutputStream cos=new CryptoOutputStream(outputStream,codec,new byte[16],new byte[16],0L,true);
    cos.close();
    verify(outputStream).close();
  }
  @Test public void testOutputStreamNotClosing() throws Exception {
    OutputStream outputStream=mock(OutputStream.class);
    CryptoOutputStream cos=new CryptoOutputStream(outputStream,codec,new byte[16],new byte[16],0L,false);
    cos.close();
    verify(outputStream,never()).close();
  }
}
