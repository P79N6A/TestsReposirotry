/** 
 * Abstract test of task commits. 
 */
public abstract static class TaskCommitterTest<C extends OutputCommitter> extends JobCommitterTest<C> {
  private static final TaskAttemptID AID=new TaskAttemptID(new TaskID(JobCommitterTest.JOB_ID,TaskType.REDUCE,2),3);
  private C jobCommitter=null;
  private TaskAttemptContext tac=null;
  private File tempDir;
  @Before public void setupTask() throws Exception {
    this.jobCommitter=newJobCommitter();
    jobCommitter.setupJob(getJob());
    this.tac=new TaskAttemptContextImpl(new Configuration(getJob().getConfiguration()),AID);
    String tmp=System.getProperty(StagingCommitterConstants.JAVA_IO_TMPDIR);
    tempDir=new File(tmp);
    tac.getConfiguration().set(Constants.BUFFER_DIR,tmp + "/buffer");
    tac.getConfiguration().set(CommitConstants.FS_S3A_COMMITTER_STAGING_TMP_PATH,tmp + "/cluster");
  }
  protected C getJobCommitter(){
    return jobCommitter;
  }
  protected TaskAttemptContext getTAC(){
    return tac;
  }
  abstract C newTaskCommitter() throws Exception ;
  protected File getTempDir(){
    return tempDir;
  }
}
