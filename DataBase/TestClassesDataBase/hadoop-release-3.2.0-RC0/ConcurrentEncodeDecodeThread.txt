private class ConcurrentEncodeDecodeThread extends Thread {
  public ConcurrentEncodeDecodeThread(  String name){
    super(name);
  }
  @Override public void run(){
    final String name=this.getName();
    DataOutputBuffer out=new DataOutputBuffer();
    DataInputBuffer in=new DataInputBuffer();
    for (int i=0; i < 1000; ++i) {
      try {
        out.reset();
        WritableUtils.writeString(out,name);
        in.reset(out.getData(),out.getLength());
        String s=WritableUtils.readString(in);
        assertEquals("input buffer reset contents = " + name,name,s);
      }
 catch (      Exception ioe) {
        throw new RuntimeException(ioe);
      }
    }
  }
}
