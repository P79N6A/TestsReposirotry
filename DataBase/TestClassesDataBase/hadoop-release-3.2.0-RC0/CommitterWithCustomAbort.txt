/** 
 * Committer with abort making a _failed/_killed in the output folder
 */
static class CommitterWithCustomAbort extends FileOutputCommitter {
  public CommitterWithCustomAbort(  Path outputPath,  TaskAttemptContext context) throws IOException {
    super(outputPath,context);
  }
  @Override public void abortJob(  JobContext context,  JobStatus.State state) throws IOException {
    Path outputPath=FileOutputFormat.getOutputPath(context);
    FileSystem fs=outputPath.getFileSystem(context.getConfiguration());
    String fileName=(state.equals(JobStatus.State.FAILED)) ? ABORT_FAILED_FILE_NAME : ABORT_KILLED_FILE_NAME;
    fs.create(new Path(outputPath,fileName)).close();
  }
}
