public class MySqlWallPermitTableTest extends TestCase {
  public void test_default_true() throws Exception {
    Assert.assertTrue(WallUtils.isValidateMySql("select * from t union select benchmark( 500000, sha1( 'test' ) ) FROM X"));
  }
  public void test_default_false() throws Exception {
    Assert.assertFalse(WallUtils.isValidateMySql("select * from t where fid = 1 union select benchmark( 500000, sha1( 'test' ) ) FROM X"));
  }
  public void test_allow() throws Exception {
    WallConfig config=new WallConfig();
    config.setTableCheck(false);
    Assert.assertTrue(WallUtils.isValidateMySql("select benchmark( 500000, sha1( 'test' ) ) FROM X",config));
  }
}
