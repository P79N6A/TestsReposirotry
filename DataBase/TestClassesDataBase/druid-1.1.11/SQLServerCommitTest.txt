public class SQLServerCommitTest extends TestCase {
  public void test_0(){
    String sql="COMMIT WORK";
    SQLServerStatementParser parser=new SQLServerStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    Assert.assertEquals(1,stmtList.size());
    String text=SQLUtils.toSQLString(stmtList,JdbcUtils.SQL_SERVER);
    Assert.assertEquals("COMMIT WORK",text);
  }
  public void test_1(){
    String sql="COMMIT TRAN";
    SQLServerStatementParser parser=new SQLServerStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    Assert.assertEquals(1,stmtList.size());
    String text=SQLUtils.toSQLString(stmtList,JdbcUtils.SQL_SERVER);
    Assert.assertEquals("COMMIT TRANSACTION",text);
  }
  public void test_2(){
    String sql="COMMIT TRANSACTION @tran_name_variable  WITH ( DELAYED_DURABILITY = OFF )";
    SQLServerStatementParser parser=new SQLServerStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    Assert.assertEquals(1,stmtList.size());
    String text=SQLUtils.toSQLString(stmtList,JdbcUtils.SQL_SERVER);
    Assert.assertEquals("COMMIT TRANSACTION @tran_name_variable WITH ( DELAYED_DURABILITY = OFF )",text);
  }
}
