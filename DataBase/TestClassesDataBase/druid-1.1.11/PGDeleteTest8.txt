public class PGDeleteTest8 extends PGTest {
  public void test_0() throws Exception {
    String sql="WITH RECURSIVE included_parts(sub_part, part) AS (" + "    SELECT sub_part, part FROM parts WHERE part = 'our_product'" + "  UNION ALL"+ "    SELECT p.sub_part, p.part"+ "    FROM included_parts pr, parts p"+ "    WHERE p.part = pr.sub_part"+ "  )"+ "DELETE FROM parts\n"+ "  WHERE part IN (SELECT part FROM included_parts);";
    PGSQLStatementParser parser=new PGSQLStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement stmt=statementList.get(0);
    System.out.println(stmt);
    assertEquals(1,statementList.size());
    PGSchemaStatVisitor visitor=new PGSchemaStatVisitor();
    stmt.accept(visitor);
    System.out.println("Tables : " + visitor.getTables());
    System.out.println("fields : " + visitor.getColumns());
    assertTrue(visitor.getTables().containsKey(new TableStat.Name("parts")));
    assertEquals(2,visitor.getColumns().size());
    assertTrue(visitor.containsColumn("parts","sub_part"));
    assertTrue(visitor.containsColumn("parts","sub_part"));
  }
}
