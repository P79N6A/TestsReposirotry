public class MySqlCreateTableTest51 extends MysqlTest {
  public void test_0() throws Exception {
    String sql="CREATE TABLE `test` (" + "`Id` int(11) NOT NULL," + "`text` text CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL"+ ") ENGINE=InnoDB DEFAULT CHARSET=gbk";
    MySqlStatementParser parser=new MySqlStatementParser(sql);
    SQLStatement stmt=parser.parseCreateTable();
    MySqlSchemaStatVisitor visitor=new MySqlSchemaStatVisitor();
    stmt.accept(visitor);
    Assert.assertEquals(1,visitor.getTables().size());
    Assert.assertEquals(2,visitor.getColumns().size());
    Assert.assertEquals(0,visitor.getConditions().size());
    Assert.assertTrue(visitor.getTables().containsKey(new TableStat.Name("test")));
    String output=SQLUtils.toMySqlString(stmt);
    Assert.assertEquals("CREATE TABLE `test` (" + "\n\t`Id` int(11) NOT NULL," + "\n\t`text` text CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL"+ "\n) ENGINE = InnoDB CHARSET = gbk",output);
  }
}
