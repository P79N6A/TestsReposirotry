public class MySqlParameterizedOutputVisitorTest2 extends TestCase {
  public void test_0() throws Exception {
    String sql="SELECT * FROM T WHERE ID = ?";
    for (int i=0; i < 10000; ++i) {
      sql+=" OR ID = ?";
    }
    validate(sql,"SELECT *\nFROM T\nWHERE ID = ?");
    validateOracle(sql,"SELECT *\nFROM T\nWHERE ID = ?");
  }
  void validate(  String sql,  String expect){
    MySqlStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement stmt=statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    StringBuilder out=new StringBuilder();
    MySqlOutputVisitor visitor=new MySqlOutputVisitor(out,true);
    stmt.accept(visitor);
    Assert.assertEquals(expect,out.toString());
  }
  void validateOracle(  String sql,  String expect){
    OracleStatementParser parser=new OracleStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement stmt=statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    StringBuilder out=new StringBuilder();
    OracleParameterizedOutputVisitor visitor=new OracleParameterizedOutputVisitor(out,false);
    stmt.accept(visitor);
    Assert.assertEquals(expect,out.toString());
  }
}
