public class PGSelectTest42 extends PGTest {
  public void test_0() throws Exception {
    String sql="UPDATE sys_account AS a SET online = 2 FROM auto_handler_online o WHERE a.id = o.account_id AND a.online != 2";
    PGSQLStatementParser parser=new PGSQLStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement stmt=statementList.get(0);
    Assert.assertEquals("UPDATE sys_account a\n" + "SET online = 2\n" + "FROM auto_handler_online o\n"+ "WHERE a.id = o.account_id\n"+ "\tAND a.online != 2",SQLUtils.toPGString(stmt));
    Assert.assertEquals("update sys_account a\n" + "set online = 2\n" + "from auto_handler_online o\n"+ "where a.id = o.account_id\n"+ "\tand a.online != 2",SQLUtils.toPGString(stmt,SQLUtils.DEFAULT_LCASE_FORMAT_OPTION));
    Assert.assertEquals(1,statementList.size());
    PGSchemaStatVisitor visitor=new PGSchemaStatVisitor();
    stmt.accept(visitor);
    System.out.println("Tables : " + visitor.getTables());
    System.out.println("fields : " + visitor.getColumns());
    Assert.assertEquals(3,visitor.getColumns().size());
    Assert.assertEquals(2,visitor.getTables().size());
    assertTrue(visitor.containsColumn("sys_account","online"));
    assertTrue(visitor.containsColumn("sys_account","id"));
    assertTrue(visitor.containsColumn("auto_handler_online","account_id"));
  }
}
