public class SQLServerCreateTableTest_7 extends TestCase {
  public void test_0() throws Exception {
    String sql="create table leave_jpa (" + " id bigint identity not null, " + " user_id varchar(255), "+ " primary key (id)"+ ")";
    SQLServerStatementParser parser=new SQLServerStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLCreateTableStatement stmt=(SQLCreateTableStatement)statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    String output=SQLUtils.toSQLString(stmt,JdbcConstants.SQL_SERVER);
    Assert.assertEquals("CREATE TABLE leave_jpa (" + "\n\tid bigint DEFAULT NULL IDENTITY," + "\n\tuser_id varchar(255),"+ "\n\tPRIMARY KEY (id)"+ "\n)",output);
    SQLServerSchemaStatVisitor visitor=new SQLServerSchemaStatVisitor();
    stmt.accept(visitor);
    Assert.assertEquals(1,visitor.getTables().size());
    Assert.assertEquals(2,visitor.getColumns().size());
    Assert.assertEquals(0,visitor.getConditions().size());
    Assert.assertTrue(visitor.getTables().containsKey(new TableStat.Name("leave_jpa")));
    Assert.assertTrue(visitor.getColumns().contains(new Column("leave_jpa","id")));
    Assert.assertTrue(visitor.getColumns().contains(new Column("leave_jpa","user_id")));
  }
}
