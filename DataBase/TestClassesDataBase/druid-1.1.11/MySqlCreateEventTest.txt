public class MySqlCreateEventTest extends MysqlTest {
  @Test public void test_one() throws Exception {
    String sql="create definer = current_user event if not exists someevent on schedule at current_timestamp + interval 30 minute\n" + "on completion preserve do begin insert into test.t1 values (33), (111);select * from test.t1; end; -- //";
    List<SQLStatement> stmtList=SQLUtils.toStatementList(sql,JdbcConstants.MYSQL);
    SQLStatement stmt=stmtList.get(0);
    MySqlSchemaStatVisitor visitor=new MySqlSchemaStatVisitor();
    stmt.accept(visitor);
    String output=SQLUtils.toMySqlString(stmt);
    Assert.assertEquals("CREATE DEFINER = EVENT IF NOT EXISTS someevent ON SCHEDULE AT current_timestamp + INTERVAL 30 MINUTE\n" + "DO\n" + "BEGIN\n"+ "\tINSERT INTO test.t1\n"+ "\tVALUES (33),\n"+ "\t\t(111);\n"+ "\tSELECT *\n"+ "\tFROM test.t1;\n"+ "END;",output);
  }
}
