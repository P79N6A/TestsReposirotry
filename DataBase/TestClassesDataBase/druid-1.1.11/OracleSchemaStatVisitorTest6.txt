public class OracleSchemaStatVisitorTest6 extends TestCase {
  public void test_0() throws Exception {
    String sql="SELECT 'SYS_B_0',COUNT('$SYS_B_1') AS DEVICECOUNT " + "FROM (" + "     SELECT OID,SSJG,OID "+ "     FROM ("+ "         SELECT A.OID,A.SSJG,A.OID "+ "         FROM T_TX_ZLSB_ZLDYHGQ A "+ "         WHERE (A.VERSIONID IS NULL OR A.VERSIONID='$SYS_B_2')"+ "     ) T1 JOIN ("+ "         SELECT B.OID,B.SSJG,B.OID "+ "         FROM T_TX_ZLSB_ZLDYHGQ_VER B WHERE B.ADDFLAG<'SYS_B_3'"+ "     ) T2 ON T1.OID=T2.OID"+ ") WHERE SSJG='$SYS_B_4'";
    OracleStatementParser parser=new OracleStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement statemen=statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    OracleSchemaStatVisitor visitor=new OracleSchemaStatVisitor();
    statemen.accept(visitor);
    System.out.println(sql);
    System.out.println("Tables : " + visitor.getTables());
    System.out.println("fields : " + visitor.getColumns());
    System.out.println("relationShip : " + visitor.getRelationships());
    System.out.println("where : " + visitor.getConditions());
    System.out.println("groupBy : " + visitor.getGroupByColumns());
  }
}
