public class MySqlSelectTest_18 extends MysqlTest {
  public void test_0() throws Exception {
    String sql="SELECT host.id as id" + ",   host.item_id as itemId" + ",   host.node_id as nodeId"+ ",   host.node_type as nodeType"+ ",   host.begin_time as beginTime"+ ",   host.end_time as endTime"+ ",   host.gmt_create as gmtCreate"+ ",   host.gmt_modify as gmtModify"+ ",   host.reason as reason"+ ",   host.creator_id as creatorId"+ ",   host.modifier_id as modifierId"+ ",   user.name as creator"+ ",   user.name as modifier"+ ",   user.nick_name as nickName   "+ " FROM notice_close_node host left join sys_user user on user.id = host.modifier_id";
    MySqlStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement statemen=statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    MySqlSchemaStatVisitor visitor=new MySqlSchemaStatVisitor();
    statemen.accept(visitor);
    System.out.println("Tables : " + visitor.getTables());
    System.out.println("fields : " + visitor.getColumns());
    Assert.assertEquals(2,visitor.getTables().size());
    Assert.assertEquals(14,visitor.getColumns().size());
    Assert.assertEquals(2,visitor.getConditions().size());
    Assert.assertTrue(visitor.getColumns().contains(new Column("sys_user","id")));
    Assert.assertTrue(visitor.getColumns().contains(new Column("notice_close_node","modifier_id")));
  }
}
