/** 
 * 这个场景，检测可疑的Having条件
 * @author wenshao
 */
public class WallReadOnlyTest2 extends TestCase {
  private WallConfig config=new WallConfig();
  protected void setUp() throws Exception {
    config.addReadOnlyTable("members");
  }
  private String sql="SELECT F1, F2 members";
  private String insert_sql="INSERT INTO members (FID, FNAME) VALUES (?, ?)";
  private String update_sql="UPDATE members SET FNAME = ? WHERe FID = ?";
  private String delete_sql="DELETE members WHERE FID = ?";
  public void testMySql() throws Exception {
    MySqlWallProvider provider=new MySqlWallProvider(config);
    Assert.assertTrue(provider.checkValid(sql));
    Assert.assertFalse(provider.checkValid(insert_sql));
    Assert.assertFalse(provider.checkValid(update_sql));
    Assert.assertFalse(provider.checkValid(delete_sql));
  }
  public void testORACLE() throws Exception {
    OracleWallProvider provider=new OracleWallProvider(config);
    Assert.assertTrue(provider.checkValid(sql));
    Assert.assertFalse(provider.checkValid(insert_sql));
    Assert.assertFalse(provider.checkValid(update_sql));
    Assert.assertFalse(provider.checkValid(delete_sql));
  }
}
