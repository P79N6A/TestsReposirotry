public class OceanbaseCreateTableTest_subPartition4 extends MysqlTest {
  public void test_0() throws Exception {
    String sql="CREATE TABLE ts (id INT, purchased DATE) " + "PARTITION BY RANGE(YEAR(purchased)) " + "SUBPARTITION BY HASH(TO_DAYS(purchased)) "+ "( PARTITION p0 VALUES LESS THAN (1990) ( SUBPARTITION s0, SUBPARTITION s1 ), "+ "PARTITION p1 VALUES LESS THAN (2000) ( SUBPARTITION s0, SUBPARTITION s1 ), "+ "PARTITION p2 VALUES LESS THAN MAXVALUE ( SUBPARTITION s0, SUBPARTITION s1 ) )";
    MySqlStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    SQLStatement stmt=stmtList.get(0);
    String result=SQLUtils.toMySqlString(stmt);
    Assert.assertEquals("CREATE TABLE ts (\n" + "\tid INT,\n" + "\tpurchased DATE\n"+ ")\n"+ "PARTITION BY RANGE (YEAR(purchased))\n"+ "SUBPARTITION BY HASH (TO_DAYS(purchased)) (\n"+ "\tPARTITION p0 VALUES LESS THAN (1990) (\n"+ "\t\tSUBPARTITION s0,\n"+ "\t\tSUBPARTITION s1\n"+ "\t),\n"+ "\tPARTITION p1 VALUES LESS THAN (2000) (\n"+ "\t\tSUBPARTITION s0,\n"+ "\t\tSUBPARTITION s1\n"+ "\t),\n"+ "\tPARTITION p2 VALUES LESS THAN MAXVALUE (\n"+ "\t\tSUBPARTITION s0,\n"+ "\t\tSUBPARTITION s1\n"+ "\t)\n"+ ")",result);
    print(stmtList);
    Assert.assertEquals(1,stmtList.size());
    MySqlSchemaStatVisitor visitor=new MySqlSchemaStatVisitor();
    stmt.accept(visitor);
    System.out.println("Tables : " + visitor.getTables());
    System.out.println("fields : " + visitor.getColumns());
    System.out.println("coditions : " + visitor.getConditions());
    System.out.println("orderBy : " + visitor.getOrderByColumns());
    Assert.assertEquals(1,visitor.getTables().size());
    Assert.assertEquals(2,visitor.getColumns().size());
    Assert.assertEquals(0,visitor.getConditions().size());
  }
}
