/** 
 * @author wenshao
 */
public class WallHavingTest6 extends TestCase {
  private String sql="SELECT region, SUM(population), SUM(area) FROM bbc GROUP BY region HAVING SUM(area)>1000000 or 1 = 1 --";
  private String sql1="SELECT region, SUM(population), SUM(area) FROM bbc GROUP BY region HAVING SUM(area)>1000000 or 1 = 1 #and c=1";
  public void test_check_true() throws Exception {
    WallConfig config=new WallConfig();
    config.setSelectHavingAlwayTrueCheck(true);
    config.setConditionAndAlwayTrueAllow(true);
    config.setCommentAllow(true);
    Assert.assertFalse(WallUtils.isValidateMySql(sql,config));
    Assert.assertFalse(WallUtils.isValidateMySql(sql1,config));
  }
  public void test_check_false() throws Exception {
    WallConfig config=new WallConfig();
    config.setSelectHavingAlwayTrueCheck(false);
    config.setConditionAndAlwayTrueAllow(true);
    config.setCommentAllow(true);
    Assert.assertTrue(WallUtils.isValidateMySql(sql,config));
    Assert.assertTrue(WallUtils.isValidateMySql(sql1,config));
  }
}
