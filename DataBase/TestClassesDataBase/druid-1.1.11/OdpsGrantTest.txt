public class OdpsGrantTest extends TestCase {
  public void test_0() throws Exception {
    String sql="grant update, Select on table adl_register_baseline_sdt to user DXP_71074213@aliyun.com";
    OdpsStatementParser parser=new OdpsStatementParser(sql);
    SQLStatement stmt=parser.parseStatementList().get(0);
    parser.match(Token.EOF);
    String output=SQLUtils.toOdpsString(stmt);
    Assert.assertEquals("GRANT UPDATE, SELECT ON TABLE adl_register_baseline_sdt TO USER DXP_71074213@aliyun.com",output);
  }
  public void test_1() throws Exception {
    String sql="grant role_project_admin to aliyun$DXP_xxxxx@aliyun.com";
    OdpsStatementParser parser=new OdpsStatementParser(sql);
    SQLStatement stmt=parser.parseStatementList().get(0);
    parser.match(Token.EOF);
    String output=SQLUtils.toOdpsString(stmt);
    Assert.assertEquals("GRANT role_project_admin TO aliyun$DXP_xxxxx@aliyun.com",output);
  }
  public void test_2() throws Exception {
    String sql="grant super Write to user aliyun$DXP_xxxxx@aliyun.com";
    OdpsStatementParser parser=new OdpsStatementParser(sql);
    SQLStatement stmt=parser.parseStatementList().get(0);
    parser.match(Token.EOF);
    String output=SQLUtils.toOdpsString(stmt);
    Assert.assertEquals("GRANT SUPER WRITE TO USER aliyun$DXP_xxxxx@aliyun.com",output);
  }
  public void test_3() throws Exception {
    String sql="grant label 2 on table adl_register_baseline_sdt(c1, c2) to user aliyun$DXP_xxxxx@aliyun.com with exp 5";
    OdpsStatementParser parser=new OdpsStatementParser(sql);
    SQLStatement stmt=parser.parseStatementList().get(0);
    parser.match(Token.EOF);
    String output=SQLUtils.toOdpsString(stmt);
    Assert.assertEquals("GRANT LABEL 2 ON TABLE adl_register_baseline_sdt(c1, c2) TO USER aliyun$DXP_xxxxx@aliyun.com WITH EXP 5",output);
  }
  public void test_4() throws Exception {
    String sql="grant CreateInstance, CreateResource, CreateFunction, CreateTable, List ON PROJECT test_project TO ROLE worker";
    OdpsStatementParser parser=new OdpsStatementParser(sql);
    SQLStatement stmt=parser.parseStatementList().get(0);
    parser.match(Token.EOF);
    String output=SQLUtils.toOdpsString(stmt);
    Assert.assertEquals("GRANT CreateInstance, CreateResource, CreateFunction, CreateTable, LIST ON PROJECT test_project TO ROLE worker",output);
  }
}
