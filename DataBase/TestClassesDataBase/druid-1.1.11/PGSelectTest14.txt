public class PGSelectTest14 extends PGTest {
  public void test_0() throws Exception {
    String sql="WITH RECURSIVE included_parts(sub_part, part, quantity) AS (" + "    SELECT sub_part, part, quantity FROM parts WHERE part = 'our_product'" + "  UNION ALL"+ "    SELECT p.sub_part, p.part, p.quantity"+ "    FROM included_parts pr, parts p"+ "    WHERE p.part = pr.sub_part"+ "  )\n"+ "SELECT sub_part, SUM(quantity) as total_quantity\n"+ "FROM included_parts\n"+ "GROUP BY sub_part";
    PGSQLStatementParser parser=new PGSQLStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement stmt=statementList.get(0);
    assertEquals(1,statementList.size());
    PGSchemaStatVisitor visitor=new PGSchemaStatVisitor();
    stmt.accept(visitor);
    System.out.println("Tables : " + visitor.getTables());
    System.out.println("fields : " + visitor.getColumns());
    assertEquals(3,visitor.getColumns().size());
    assertEquals(1,visitor.getTables().size());
  }
}
