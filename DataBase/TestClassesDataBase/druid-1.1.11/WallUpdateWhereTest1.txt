/** 
 * @author wenshao
 */
public class WallUpdateWhereTest1 extends TestCase {
  private String sql="update wx_shop set shop_view = shop_view + 1 where id = 118 OR 69=69 LIMIT 100 --";
  private String sql1="update wx_shop set shop_view = shop_view + 1 where id = 118 OR 69=69 LIMIT 100 #and c=1";
  public void test_check_true() throws Exception {
    WallConfig config=new WallConfig();
    config.setUpdateWhereAlayTrueCheck(true);
    config.setConditionAndAlwayTrueAllow(true);
    config.setCommentAllow(true);
    Assert.assertFalse(WallUtils.isValidateMySql(sql,config));
    Assert.assertFalse(WallUtils.isValidateMySql(sql1,config));
  }
  public void test_check_false() throws Exception {
    WallConfig config=new WallConfig();
    config.setUpdateWhereAlayTrueCheck(false);
    config.setConditionAndAlwayTrueAllow(true);
    config.setCommentAllow(true);
    Assert.assertTrue(WallUtils.isValidateMySql(sql,config));
    Assert.assertTrue(WallUtils.isValidateMySql(sql1,config));
  }
}
