public class TestOracleWall extends TestCase {
  private DruidDataSource dataSource;
  protected void setUp() throws Exception {
    dataSource=new DruidDataSource();
    dataSource.setOracle(true);
    dataSource.setUrl("jdbc:mock:xxx");
    dataSource.setDriver(new OracleMockDriver());
    dataSource.setPoolPreparedStatements(true);
    dataSource.setConnectionProperties("defaultRowPrefetch=50");
    dataSource.setFilters("stat,wall");
    dataSource.setDbType("oracle");
  }
  protected void tearDown() throws Exception {
    JdbcUtils.close(dataSource);
  }
  public void test_oracle() throws Exception {
    String sql="SELECT 1";
{
      Connection conn=dataSource.getConnection();
      PreparedStatement stmt=conn.prepareStatement(sql);
      ResultSet rs=stmt.executeQuery();
      rs.next();
      rs.close();
      stmt.close();
      conn.close();
    }
{
      Connection conn=dataSource.getConnection();
      PreparedStatement stmt=conn.prepareStatement(sql);
      ResultSet rs=stmt.executeQuery();
      rs.next();
      rs.close();
      stmt.close();
      conn.close();
    }
    Assert.assertEquals(1,dataSource.getCachedPreparedStatementCount());
  }
}
