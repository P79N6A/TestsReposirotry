/** 
 * 这个场景测试访问Oracle系统对象
 * @author admin
 */
public class OracleWallPermitFunctionTest extends TestCase {
  public void test_permitTable() throws Exception {
    Assert.assertFalse(WallUtils.isValidateOracle("select * from t where fid = 1 union select SYS_CONTEXT ('USERENV', 'CURRENT_USER') from X"));
  }
  public void test_permitTable_allow() throws Exception {
    WallConfig config=new WallConfig();
    config.setFunctionCheck(false);
    Assert.assertTrue(WallUtils.isValidateOracle("select SYS_CONTEXT ('USERENV', 'CURRENT_USER') from X",config));
  }
}
