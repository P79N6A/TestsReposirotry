public class SchemaStatTest8 extends TestCase {
  public void test_schemaStat() throws Exception {
    String sql="SELECT * FROM AQLQCAT " + "JOIN AQLQCATB " + "   ON AQLQCAT.ZZ = AQLQCATB.RR "+ "       AND trim(AQLQCAT.BB) = AQLQCATB.DD "+ "WHERE AQLQCAT.MANDT = 'A0' "+ "   AND AQLQCATB.NUM = 'A1'";
    String dbType=JdbcConstants.ORACLE;
    SQLStatementParser parser=SQLParserUtils.createSQLStatementParser(sql,dbType);
    SQLStatement stmt=parser.parseStatementList().get(0);
    SchemaStatVisitor statVisitor=SQLUtils.createSchemaStatVisitor(dbType);
    stmt.accept(statVisitor);
    System.out.println("relationships : " + statVisitor.getRelationships());
    assertEquals(8,statVisitor.getColumns().size());
    assertEquals(6,statVisitor.getConditions().size());
  }
}
