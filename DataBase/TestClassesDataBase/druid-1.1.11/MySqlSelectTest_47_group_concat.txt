public class MySqlSelectTest_47_group_concat extends MysqlTest {
  public void test_0() throws Exception {
    String sql="SELECT student_name,\n" + "    GROUP_CONCAT(DISTINCT test_score\n" + "            ORDER BY test_score DESC SEPARATOR ' ')\n"+ "    FROM student\n"+ "    GROUP BY student_name;";
    List<SQLStatement> statementList=SQLUtils.parseStatements(sql,JdbcConstants.MYSQL,true);
    SQLStatement stmt=statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    SchemaStatVisitor visitor=SQLUtils.createSchemaStatVisitor(JdbcConstants.MYSQL);
    stmt.accept(visitor);
{
      String output=SQLUtils.toMySqlString(stmt);
      Assert.assertEquals("SELECT student_name, GROUP_CONCAT(DISTINCT test_score ORDER BY test_score DESC SEPARATOR ' ')\n" + "FROM student\n" + "GROUP BY student_name;",output);
    }
{
      String output=SQLUtils.toMySqlString(stmt,SQLUtils.DEFAULT_LCASE_FORMAT_OPTION);
      Assert.assertEquals("select student_name, group_concat(DISTINCT test_score order by test_score desc separator ' ')\n" + "from student\n" + "group by student_name;",output);
    }
{
      String output=SQLUtils.toMySqlString(stmt,new SQLUtils.FormatOption(true,true,true));
      Assert.assertEquals("SELECT student_name, GROUP_CONCAT(DISTINCT test_score ORDER BY test_score DESC SEPARATOR ' ')\n" + "FROM student\n" + "GROUP BY student_name;",output);
    }
  }
}
