public class MySqlCreateTableTest69 extends MysqlTest {
  @Test public void test_one() throws Exception {
    String sql="CREATE TABLE t1 (" + "  s1 INT," + "  s2 INT AS (EXP(s1)) STORED"+ ")"+ "PARTITION BY LIST (s2) ("+ "  PARTITION p1 VALUES IN (1)"+ ");";
    MySqlStatementParser parser=new MySqlStatementParser(sql);
    SQLStatement stmt=parser.parseCreateTable();
    MySqlSchemaStatVisitor visitor=new MySqlSchemaStatVisitor();
    stmt.accept(visitor);
{
      String output=SQLUtils.toMySqlString(stmt);
      Assert.assertEquals("CREATE TABLE t1 (\n" + "\ts1 INT,\n" + "\ts2 INT AS (EXP(s1)) SORTED\n"+ ")\n"+ "PARTITION BY LIST (s2) (\n"+ "\tPARTITION p1 VALUES IN (1)\n"+ ")",output);
    }
{
      String output=SQLUtils.toMySqlString(stmt,SQLUtils.DEFAULT_LCASE_FORMAT_OPTION);
      Assert.assertEquals("create table t1 (\n" + "\ts1 INT,\n" + "\ts2 INT as (EXP(s1)) sorted\n"+ ")\n"+ "partition by list (s2) (\n"+ "\tpartition p1 values in (1)\n"+ ")",output);
    }
  }
}
