public class SQLServerRowNumberTest extends TestCase {
  public void test_isEmpty() throws Exception {
    String sql="SELECT c.FirstName, c.LastName" + "    ,ROW_NUMBER() OVER(ORDER BY SalesYTD DESC) AS 'Row Number'" + "    ,s.SalesYTD, a.PostalCode "+ "FROM Sales.SalesPerson s "+ "    INNER JOIN Person.Contact c "+ "        ON s.SalesPersonID = c.ContactID"+ "    INNER JOIN Person.Address a "+ "        ON a.AddressID = c.ContactID "+ "WHERE TerritoryID IS NOT NULL "+ "    AND SalesYTD <> 0;";
    String expect="SELECT c.FirstName, c.LastName, ROW_NUMBER() OVER (ORDER BY SalesYTD DESC) AS 'Row Number', s.SalesYTD, a.PostalCode" + "\nFROM Sales.SalesPerson s" + "\n\tINNER JOIN Person.Contact c ON s.SalesPersonID = c.ContactID"+ "\n\tINNER JOIN Person.Address a ON a.AddressID = c.ContactID"+ "\nWHERE TerritoryID IS NOT NULL"+ "\n\tAND SalesYTD <> 0;";
    SQLServerStatementParser parser=new SQLServerStatementParser(sql);
    SQLStatement stmt=parser.parseStatementList().get(0);
    String text=TestUtils.outputSqlServer(stmt);
    Assert.assertEquals(expect,text);
  }
}
