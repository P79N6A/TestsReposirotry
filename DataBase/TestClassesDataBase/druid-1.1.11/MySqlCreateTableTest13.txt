public class MySqlCreateTableTest13 extends MysqlTest {
  public void test_0() throws Exception {
    String sql="CREATE TABLE `xx_video` (" + "`id` int(11) NOT NULL AUTO_INCREMENT," + "`video_url` varchar(500) DEFAULT NULL,"+ "`video_title` varchar(200) DEFAULT NULL,"+ "`video_des` varchar(500) DEFAULT NULL,"+ "`video_type` varchar(11) NOT NULL,"+ "`delete_flag` int(11) DEFAULT '0',"+ "`create_date` datetime DEFAULT NULL,"+ "`last_update` datetime DEFAULT NULL,"+ "PRIMARY KEY (`id`)"+ ") ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=gbk;";
    MySqlStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement statemen=statementList.get(0);
    Assert.assertEquals(1,statementList.size());
    MySqlSchemaStatVisitor visitor=new MySqlSchemaStatVisitor();
    statemen.accept(visitor);
    Assert.assertEquals(1,visitor.getTables().size());
    Assert.assertEquals(8,visitor.getColumns().size());
    Assert.assertEquals(0,visitor.getConditions().size());
    Assert.assertTrue(visitor.getTables().containsKey(new TableStat.Name("xx_video")));
    Assert.assertTrue(visitor.containsColumn("xx_video","id"));
    Assert.assertTrue(visitor.containsColumn("xx_video","video_url"));
  }
}
