/** 
 * User: carvin Date: 12-11-13 Time: 下午7:16 Test OralceOutputVisitor and start with ... connect by parser.
 */
public class OracleOutputVisitorTest_PrettyFormat {
  @Test public void testConnectByParserAndPrettyFormatOutput(){
    String sql="select * from ge_rms_company start with comcode = '00' connect by nocycle prior comcode = uppercomcode";
    SQLStatementParser parser=SQLParserUtils.createSQLStatementParser(sql,JdbcUtils.ORACLE);
    List<SQLStatement> stmtList=parser.parseStatementList();
    StringBuilder out=new StringBuilder();
    SQLASTOutputVisitor visitor=new OracleOutputVisitor(out);
    for (    SQLStatement statement : stmtList) {
      statement.accept(visitor);
    }
    String expectResult="SELECT *\nFROM ge_rms_company\nSTART WITH comcode = '00'\nCONNECT BY NOCYCLE PRIOR comcode = uppercomcode";
    Assert.assertEquals(expectResult,out.toString());
    out.setLength(0);
    visitor=new OracleOutputVisitor(out);
    visitor.setPrettyFormat(false);
    for (    SQLStatement statement : stmtList) {
      statement.accept(visitor);
    }
    expectResult="SELECT * FROM ge_rms_company START WITH comcode = '00' CONNECT BY NOCYCLE PRIOR comcode = uppercomcode";
    Assert.assertEquals(expectResult,out.toString());
  }
}
