public class ControlFlowFunctionsTest extends TestCase {
  public void test_0() throws Exception {
    String sql="SELECT CASE 1 WHEN 1 THEN 'one' WHEN 2 THEN 'two' ELSE 'more' END;";
    SQLStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    String text=output(stmtList);
    Assert.assertEquals("SELECT CASE 1\n" + "\t\tWHEN 1 THEN 'one'\n" + "\t\tWHEN 2 THEN 'two'\n"+ "\t\tELSE 'more'\n"+ "\tEND;",text);
  }
  public void test_1() throws Exception {
    String sql="SELECT IF(1>2,2,3);";
    SQLStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    String text=output(stmtList);
    Assert.assertEquals("SELECT IF(1 > 2, 2, 3);",text);
  }
  public void test_2() throws Exception {
    String sql="SELECT IF(1<2,'yes','no');";
    SQLStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    String text=output(stmtList);
    Assert.assertEquals("SELECT IF(1 < 2, 'yes', 'no');",text);
  }
  public void test_3() throws Exception {
    String sql="SELECT IF(STRCMP('test','test1'),'no','yes');";
    SQLStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    String text=output(stmtList);
    Assert.assertEquals("SELECT IF(STRCMP('test', 'test1'), 'no', 'yes');",text);
  }
  public void test_4() throws Exception {
    String sql="SELECT IFNULL(1,0);";
    SQLStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    String text=output(stmtList);
    Assert.assertEquals("SELECT IFNULL(1, 0);",text);
  }
  public void test_5() throws Exception {
    String sql="SELECT IFNULL(1/0,'yes');";
    SQLStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> stmtList=parser.parseStatementList();
    String text=output(stmtList);
    Assert.assertEquals("SELECT IFNULL(1 / 0, 'yes');",text);
  }
  private String output(  List<SQLStatement> stmtList){
    return SQLUtils.toSQLString(stmtList,JdbcConstants.MYSQL);
  }
}
