public class MySqlUpdateTest_9 extends MysqlTest {
  public void test_0() throws Exception {
    String sql="update tb1 a , tb2 b set a.name='abc' where a.id=b.id";
    MySqlStatementParser parser=new MySqlStatementParser(sql);
    List<SQLStatement> statementList=parser.parseStatementList();
    SQLStatement stmt=statementList.get(0);
    print(statementList);
    Assert.assertEquals(1,statementList.size());
    MySqlSchemaStatVisitor visitor=new MySqlSchemaStatVisitor();
    stmt.accept(visitor);
    Assert.assertEquals(2,visitor.getTables().size());
    Assert.assertEquals(3,visitor.getColumns().size());
    Assert.assertTrue(visitor.containsTable("tb1"));
    Assert.assertTrue(visitor.containsTable("tb2"));
    Assert.assertTrue(visitor.getColumns().contains(new Column("tb1","id")));
    Assert.assertTrue(visitor.getColumns().contains(new Column("tb1","name")));
    Assert.assertTrue(visitor.getColumns().contains(new Column("tb2","id")));
{
      String output=SQLUtils.toMySqlString(stmt);
      Assert.assertEquals("UPDATE tb1 a, tb2 b\n" + "SET a.name = 'abc'\n" + "WHERE a.id = b.id",output);
    }
{
      String output=SQLUtils.toMySqlString(stmt,SQLUtils.DEFAULT_LCASE_FORMAT_OPTION);
      Assert.assertEquals("update tb1 a, tb2 b\n" + "set a.name = 'abc'\n" + "where a.id = b.id",output);
    }
  }
}
