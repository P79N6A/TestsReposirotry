public class SchemaStatTest10 extends TestCase {
  public void test_schemaStat() throws Exception {
    String sql="select a.id, b.name from table1 a inner join table2 b on a.id = b.id";
    String dbType=JdbcConstants.ORACLE;
    SQLStatementParser parser=SQLParserUtils.createSQLStatementParser(sql,dbType);
    SQLStatement stmt=parser.parseStatementList().get(0);
    SchemaStatVisitor statVisitor=SQLUtils.createSchemaStatVisitor(dbType);
    stmt.accept(statVisitor);
    Set<TableStat.Relationship> relationships=statVisitor.getRelationships();
    for (    TableStat.Relationship relationship : relationships) {
      System.out.println(relationship);
    }
    System.out.println("relationships : " + statVisitor.getRelationships());
    Assert.assertEquals(3,statVisitor.getColumns().size());
    Assert.assertEquals(2,statVisitor.getConditions().size());
    assertEquals(0,statVisitor.getFunctions().size());
  }
}
