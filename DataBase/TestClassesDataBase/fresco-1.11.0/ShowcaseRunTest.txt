@RunWith(AndroidJUnit4.class) @LargeTest public class ShowcaseRunTest {
  @Rule public ActivityTestRule<MainActivity> mActivityRule=new ActivityTestRule<>(MainActivity.class);
  @Test public void testRunTheShowcaseApp(){
    openScreenFromMenu(R.string.welcome_nav_title);
    onView(withId(R.id.content_main)).check(matches(isDisplayed()));
    onView(withId(R.id.toolbar)).check(matches(isDisplayed()));
    onView(allOf(isAssignableFrom(TextView.class),withParent(withId(R.id.toolbar)))).check(matches(withText(R.string.welcome_title)));
  }
  @Test @Ignore public void testShowImage(){
    openScreenFromMenu(R.string.drawee_simple_title);
    onView(withId(R.id.drawee_view)).perform(waitFor(5000));
    onView(withId(R.id.drawee_view)).check(matches(hasImage()));
  }
  private void openScreenFromMenu(  int title){
    onView(withContentDescription(R.string.navigation_drawer_open)).perform(click());
    onView(allOf(withParent(isAssignableFrom(NavigationMenuItemView.class)),withText(title))).perform(click());
  }
  private static ViewAction waitFor(  final long millis){
    return new ViewAction(){
      @Override public Matcher<View> getConstraints(){
        return withId(R.id.drawee_view);
      }
      @Override public String getDescription(){
        return "Waiting for " + millis + " milliseconds.";
      }
      @Override public void perform(      UiController uiController,      final View view){
        uiController.loopMainThreadForAtLeast(millis);
      }
    }
;
  }
}
