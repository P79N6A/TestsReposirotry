private static class TestJobRunnable implements JobScheduler.JobRunnable {
private static class Job {
    public final EncodedImage encodedImage;
    public final @Consumer.Status int status;
    public Job(    EncodedImage encodedImage,    @Consumer.Status int status){
      this.encodedImage=EncodedImage.cloneOrNull(encodedImage);
      this.status=status;
    }
  }
  public final AtomicBoolean running=new AtomicBoolean();
  public final AtomicBoolean wait=new AtomicBoolean();
  public final AtomicBoolean fail=new AtomicBoolean();
  public final ArrayList<Job> jobs=new ArrayList<>();
  @Override public void run(  EncodedImage encodedImage,  @Consumer.Status int status){
    running.set(true);
    try {
      waitForCondition(wait,false);
      if (fail.get()) {
        throw new RuntimeException();
      }
 else {
        jobs.add(new Job(encodedImage,status));
      }
    }
  finally {
      running.set(false);
    }
  }
}
