public class AutoformatProducesOneUndoActionTest extends AbstractGUITest {
  public static final String SOURCE_BEFORE="void setup() {\n" + "              // put your setup code here, to run once:\n" + "\n"+ "}\n"+ "\n"+ "void loop() {\n"+ "  // put your main code here, to run repeatedly:\n"+ "\n"+ "}";
  public static final String SOURCE_AFTER="void setup() {\n" + "  // put your setup code here, to run once:\n" + "\n"+ "}\n"+ "\n"+ "void loop() {\n"+ "  // put your main code here, to run repeatedly:\n"+ "\n"+ "}";
  @Test public void shouldSaveCaretPositionAfterAutoformat(){
    JMenuItemFixture menuEditUndo=window.menuItem("menuEditUndo");
    menuEditUndo.requireDisabled();
    JMenuItemFixture menuToolsAutoFormat=window.menuItem("menuToolsAutoFormat");
    menuToolsAutoFormat.requireEnabled();
    SketchTextAreaFixture editor=window.textArea("editor");
    editor.setText(SOURCE_BEFORE);
    editor.setCaretPosition(29);
    menuToolsAutoFormat.click();
    String formattedText=editor.getText();
    assertEquals(SOURCE_AFTER,formattedText);
    assertEquals(29,editor.getCaretPosition());
    menuEditUndo.requireEnabled();
    menuEditUndo.click();
    assertEquals(SOURCE_BEFORE,editor.getText());
  }
}
