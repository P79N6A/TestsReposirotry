public class GPGDetachedSignatureVerifierTest {
  private GPGDetachedSignatureVerifier GPGDetachedSignatureVerifier;
  @Before public void setUp() throws Exception {
    GPGDetachedSignatureVerifier=new GPGDetachedSignatureVerifier();
  }
  @Test public void testSignatureSuccessfulVerification() throws Exception {
    File signedFile=new File(GPGDetachedSignatureVerifierTest.class.getResource("./package_index.json").getFile());
    File sign=new File(GPGDetachedSignatureVerifierTest.class.getResource("./package_index.json.sig").getFile());
    File publickKey=new File(GPGDetachedSignatureVerifierTest.class.getResource("./public.gpg.key").getFile());
    assertTrue(GPGDetachedSignatureVerifier.verify(signedFile,sign,publickKey));
  }
  @Test public void testSignatureFailingVerification() throws Exception {
    File fakeSignedFile=File.createTempFile("fakeSigned","txt");
    fakeSignedFile.deleteOnExit();
    File sign=new File(GPGDetachedSignatureVerifierTest.class.getResource("./package_index.json.sig").getFile());
    File publickKey=new File(GPGDetachedSignatureVerifierTest.class.getResource("./public.gpg.key").getFile());
    assertFalse(GPGDetachedSignatureVerifier.verify(fakeSignedFile,sign,publickKey));
  }
}
