public class ClassImportRuleTest {
  @Test public void testClassImportRule(){
    final ClassImportRule rule=new ClassImportRule(true,false,"pkg.a",false);
    assertNotNull("Class import rule should not be null",rule);
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("asda"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("p"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkga"));
    assertEquals("Invalid access result",AccessResult.ALLOWED,rule.verifyImport("pkg.a"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkg.a.b"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkg"));
  }
  @Test public void testClassImportRuleRegexpSimple(){
    final ClassImportRule rule=new ClassImportRule(true,false,"pkg.a",true);
    assertNotNull("Class import rule should not be null",rule);
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("asda"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("p"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkga"));
    assertEquals("Invalid access result",AccessResult.ALLOWED,rule.verifyImport("pkg.a"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkg.a.b"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkg"));
  }
  @Test public void testClassImportRuleRegexp(){
    final ClassImportRule rule=new ClassImportRule(true,false,"pk[gx]\\.a",true);
    assertNotNull("Class import rule should not be null",rule);
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("asda"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("p"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkga"));
    assertEquals("Invalid access result",AccessResult.ALLOWED,rule.verifyImport("pkg.a"));
    assertEquals("Invalid access result",AccessResult.ALLOWED,rule.verifyImport("pkx.a"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkg.a.b"));
    assertEquals("Invalid access result",AccessResult.UNKNOWN,rule.verifyImport("pkg"));
  }
}
