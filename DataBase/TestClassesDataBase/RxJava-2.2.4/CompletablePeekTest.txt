public class CompletablePeekTest {
  @Test public void onAfterTerminateCrashes(){
    List<Throwable> errors=TestHelper.trackPluginErrors();
    try {
      Completable.complete().doAfterTerminate(new Action(){
        @Override public void run() throws Exception {
          throw new TestException();
        }
      }
).test().assertResult();
      TestHelper.assertUndeliverable(errors,0,TestException.class);
    }
  finally {
      RxJavaPlugins.reset();
    }
  }
  @Test public void disposed(){
    TestHelper.checkDisposed(CompletableSubject.create().doOnComplete(Functions.EMPTY_ACTION));
  }
}
