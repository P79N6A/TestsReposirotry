private static final class CapturingUncaughtExceptionHandler implements Thread.UncaughtExceptionHandler {
  int count;
  Throwable caught;
  CountDownLatch completed=new CountDownLatch(1);
  @Override public void uncaughtException(  Thread t,  Throwable e){
    count++;
    caught=e;
    completed.countDown();
  }
}
