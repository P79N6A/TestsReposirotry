/** 
 * A simple executor which queues tasks and executes them one-by-one if executeOne() is called. 
 */
static final class TestExecutor implements Executor {
  final ConcurrentLinkedQueue<Runnable> queue=new ConcurrentLinkedQueue<Runnable>();
  @Override public void execute(  Runnable command){
    queue.offer(command);
  }
  public void executeOne(){
    Runnable r=queue.poll();
    if (r != null) {
      r.run();
    }
  }
  public void executeAll(){
    Runnable r;
    while ((r=queue.poll()) != null) {
      r.run();
    }
  }
}
