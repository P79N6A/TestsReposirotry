/** 
 * Observer for listener on seperate thread. 
 */
static final class AsyncSubscriber<T> extends DefaultSubscriber<T> {
  protected CountDownLatch latch=new CountDownLatch(1);
  protected Subscriber<T> target;
  /** 
 * Wrap existing Observer.
 * @param target the target subscriber
 */
  AsyncSubscriber(  Subscriber<T> target){
    this.target=target;
  }
  /** 
 * Wait. 
 */
  public void await(){
    try {
      latch.await();
    }
 catch (    InterruptedException e) {
      fail("Test interrupted");
    }
  }
  @Override public void onComplete(){
    target.onComplete();
    latch.countDown();
  }
  @Override public void onError(  Throwable t){
    target.onError(t);
    latch.countDown();
  }
  @Override public void onNext(  T v){
    target.onNext(v);
  }
}
