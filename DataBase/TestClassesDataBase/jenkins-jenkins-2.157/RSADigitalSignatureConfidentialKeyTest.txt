public class RSADigitalSignatureConfidentialKeyTest {
  @Rule public ConfidentialStoreRule store=new ConfidentialStoreRule();
  private final RSADigitalSignatureConfidentialKey key=new RSADigitalSignatureConfidentialKey("test");
  @Test public void dsigSignAndVerify() throws Exception {
    String plainText="Hello world";
    String msg=key.sign(plainText);
    System.out.println(msg);
    Signature sig=Signature.getInstance("SHA256withRSA");
    sig.initVerify(key.getPublicKey());
    sig.update(plainText.getBytes("UTF-8"));
    assertTrue(sig.verify(Base64.decode(msg)));
  }
}
