/** 
 * User property that need update User object reference for InnerUserClass.
 */
public static class SetUserUserProperty extends UserProperty {
  private InnerUserClass innerUserClass=new InnerUserClass();
  @DataBoundConstructor public SetUserUserProperty(){
  }
  public InnerUserClass getInnerUserClass(){
    return innerUserClass;
  }
  public User getOwner(){
    return user;
  }
  @Override protected void setUser(  User u){
    super.setUser(u);
    innerUserClass.setUser(u);
  }
  public Object readResolve(){
    if (innerUserClass == null) {
      innerUserClass=new InnerUserClass();
    }
    return this;
  }
@TestExtension public static class DescriptorImpl extends UserPropertyDescriptor {
    @Override public UserProperty newInstance(    User user){
      if (user.getId().equals("nesteduserreference")) {
        return new SetUserUserProperty();
      }
      return null;
    }
  }
}
