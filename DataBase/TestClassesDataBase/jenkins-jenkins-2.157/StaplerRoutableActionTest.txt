@Issue("SECURITY-400") @For({StaplerDispatchable.class,StaplerNotDispatchable.class,DoActionFilter.class}) public class StaplerRoutableActionTest extends StaplerAbstractTest {
@TestExtension public static class TestNewRulesRoutableAction extends AbstractUnprotectedRootAction {
    @StaplerDispatchable public void notDoName(){
      replyOk();
    }
    @StaplerDispatchable public void doWebMethod1(){
      replyOk();
    }
    public void doWebMethod2(){
      replyOk();
    }
    public void doWebMethod3() throws HttpResponses.HttpResponseException {
      replyOk();
    }
    public void doWebMethod4(    StaplerRequest request){
      replyOk();
    }
    public void doWebMethod5(    @QueryParameter String foo){
      replyOk();
    }
  }
  @Test public void testNewRulesRoutableAction_notDoName() throws Exception {
    assertNotReachable("testNewRulesRoutableAction/notDoName/");
    assertNotReachable("testNewRulesRoutableAction/tDoName/");
  }
  @Test public void testNewRulesRoutableAction_webMethod1() throws Exception {
    assertReachable("testNewRulesRoutableAction/webMethod1/");
  }
  @Test public void testNewRulesRoutableAction_webMethod3Through5() throws Exception {
    assertReachable("testNewRulesRoutableAction/webMethod3/");
    assertReachable("testNewRulesRoutableAction/webMethod4/");
    assertReachable("testNewRulesRoutableAction/webMethod5/");
  }
  @Test public void testNewRulesRoutableAction_webMethod2() throws Exception {
    assertNotReachable("testNewRulesRoutableAction/webMethod2/");
    assertDoActionRequestWasBlockedAndResetFlag();
  }
@TestExtension public static class TestNewRulesNonroutableAction extends AbstractUnprotectedRootAction {
    @StaplerNotDispatchable public void doWebMethod1(){
      replyOk();
    }
    @StaplerNotDispatchable @WebMethod(name="webMethod2") public void doWebMethod2(){
      replyOk();
    }
  }
  @Test public void testNewRulesNonroutableAction_webMethod1() throws Exception {
    assertNotReachable("testNewRulesNonroutableAction/webMethod1/");
    assertDoActionRequestWasBlockedAndResetFlag();
  }
  @Test public void testNewRulesNonroutableAction_webMethod2() throws Exception {
    assertNotReachable("testNewRulesNonroutableAction/webMethod2/");
    assertDoActionRequestWasBlockedAndResetFlag();
  }
}
