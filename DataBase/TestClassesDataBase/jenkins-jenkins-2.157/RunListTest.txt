/** 
 * @author Ignacio Albors
 */
@RunWith(PowerMockRunner.class) @PowerMockIgnore({"com.sun.org.apache.xerces.*","javax.xml.*","org.xml.*"}) public class RunListTest {
  private RunList rlist;
  private void setUpByTimestampRuns(){
    Run r1=PowerMockito.mock(Run.class);
    Run r2=PowerMockito.mock(Run.class);
    when(r1.getNumber()).thenReturn(1);
    when(r2.getNumber()).thenReturn(2);
    when(r1.getTimeInMillis()).thenReturn(200L);
    when(r2.getTimeInMillis()).thenReturn(300L);
    ArrayList<Run> list=new ArrayList<Run>();
    list.add(r2);
    list.add(r1);
    rlist=RunList.fromRuns(list);
  }
  @PrepareForTest({Run.class}) @Test public void byTimestampAllRuns(){
    setUpByTimestampRuns();
    RunList<Run> tested=rlist.byTimestamp(0,400);
    assertEquals(2,tested.toArray().length);
  }
  @Issue("JENKINS-21159") @PrepareForTest({Run.class}) @Test public void byTimestampFirstRun(){
    setUpByTimestampRuns();
    RunList<Run> tested=rlist.byTimestamp(150,250);
    assertEquals(1,tested.toArray().length);
    assertEquals(1,tested.getFirstBuild().getNumber());
  }
  @PrepareForTest({Run.class}) @Test public void byTimestampLastRun(){
    setUpByTimestampRuns();
    RunList<Run> tested=rlist.byTimestamp(250,350);
    assertEquals(1,tested.toArray().length);
    assertEquals(2,tested.getFirstBuild().getNumber());
  }
}
