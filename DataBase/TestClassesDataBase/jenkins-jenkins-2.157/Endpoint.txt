@TestExtension("smokes") public static class Endpoint implements RootAction {
  private transient final Map<UUID,FullDuplexHttpService> duplexServices=new HashMap<>();
  @Override public String getUrlName(){
    return "test";
  }
  @Override public String getIconFileName(){
    return null;
  }
  @Override public String getDisplayName(){
    return null;
  }
  public HttpResponse doIndex(){
    return new FullDuplexHttpService.Response(duplexServices){
      @Override protected FullDuplexHttpService createService(      StaplerRequest req,      UUID uuid) throws IOException, InterruptedException {
        return new FullDuplexHttpService(uuid){
          @Override protected void run(          InputStream upload,          OutputStream download) throws IOException, InterruptedException {
            int x=upload.read();
            download.write(x * 2);
          }
        }
;
      }
    }
;
  }
}
