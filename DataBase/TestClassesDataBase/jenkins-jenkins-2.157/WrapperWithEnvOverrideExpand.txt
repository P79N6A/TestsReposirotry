public static class WrapperWithEnvOverrideExpand extends SimpleBuildWrapper {
  @Override public void setUp(  Context context,  Run<?,?> build,  FilePath workspace,  Launcher launcher,  TaskListener listener,  EnvVars initialEnvironment) throws IOException, InterruptedException {
    assertEquals("/opt/jdk/bin:/usr/bin:/bin",initialEnvironment.get("PATH"));
    assertEquals("/home/jenkins",initialEnvironment.get("HOME"));
    context.env("EXTRA","${HOME}/extra");
    context.env("PATH+EXTRA","${EXTRA}/bin");
  }
@TestExtension("envOverrideExpand") public static class DescriptorImpl extends BuildWrapperDescriptor {
    @Override public boolean isApplicable(    AbstractProject<?,?> item){
      return true;
    }
  }
}
