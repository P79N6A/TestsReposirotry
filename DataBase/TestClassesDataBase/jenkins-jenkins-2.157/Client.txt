class Client extends PlainCLIProtocol.ClientSide {
  int code=-1;
  final ByteArrayOutputStream stdout=new ByteArrayOutputStream();
  Client() throws IOException {
    super(new PipedInputStream(download),upload);
  }
  @Override protected synchronized void onExit(  int code){
    this.code=code;
    notifyAll();
  }
  @Override protected void onStdout(  byte[] chunk) throws IOException {
    stdout.write(chunk);
  }
  @Override protected void onStderr(  byte[] chunk) throws IOException {
  }
  @Override protected void handleClose(){
  }
  void send() throws IOException {
    sendArg("command");
    sendStart();
    streamStdin().write("hello".getBytes());
  }
  void newop() throws IOException {
    dos.writeInt(0);
    dos.writeByte(99);
    dos.flush();
  }
}
