@RunWith(Parameterized.class) public class JdkOpenSslEngineInteroptTest extends SSLEngineTest {
  @Parameterized.Parameters(name="{index}: bufferType = {0}, combo = {1}") public static Collection<Object[]> data(){
    List<Object[]> params=new ArrayList<Object[]>();
    for (    BufferType type : BufferType.values()) {
      params.add(new Object[]{type,ProtocolCipherCombo.tlsv12()});
      if (PlatformDependent.javaVersion() >= 11 && OpenSsl.isTlsv13Supported()) {
        params.add(new Object[]{type,ProtocolCipherCombo.tlsv13()});
      }
    }
    return params;
  }
  public JdkOpenSslEngineInteroptTest(  BufferType type,  ProtocolCipherCombo protocolCipherCombo){
    super(type,protocolCipherCombo);
  }
  @BeforeClass public static void checkOpenSsl(){
    assumeTrue(OpenSsl.isAvailable());
  }
  @Override protected SslProvider sslClientProvider(){
    return SslProvider.JDK;
  }
  @Override protected SslProvider sslServerProvider(){
    return SslProvider.OPENSSL;
  }
  @Override @Test public void testMutualAuthInvalidIntermediateCASucceedWithOptionalClientAuth() throws Exception {
    checkShouldUseKeyManagerFactory();
    super.testMutualAuthInvalidIntermediateCASucceedWithOptionalClientAuth();
  }
  @Override @Test public void testMutualAuthInvalidIntermediateCAFailWithOptionalClientAuth() throws Exception {
    checkShouldUseKeyManagerFactory();
    super.testMutualAuthInvalidIntermediateCAFailWithOptionalClientAuth();
  }
  @Override @Test public void testMutualAuthInvalidIntermediateCAFailWithRequiredClientAuth() throws Exception {
    checkShouldUseKeyManagerFactory();
    super.testMutualAuthInvalidIntermediateCAFailWithRequiredClientAuth();
  }
  @Override @Test public void testMutualAuthValidClientCertChainTooLongFailOptionalClientAuth() throws Exception {
    checkShouldUseKeyManagerFactory();
    super.testMutualAuthValidClientCertChainTooLongFailOptionalClientAuth();
  }
  @Override @Test public void testMutualAuthValidClientCertChainTooLongFailRequireClientAuth() throws Exception {
    checkShouldUseKeyManagerFactory();
    super.testMutualAuthValidClientCertChainTooLongFailRequireClientAuth();
  }
  @Override protected void mySetupMutualAuthServerInitSslHandler(  SslHandler handler){
    ReferenceCountedOpenSslEngine engine=(ReferenceCountedOpenSslEngine)handler.engine();
    engine.setVerify(SSL_CVERIFY_IGNORED,1);
  }
  @Override protected boolean mySetupMutualAuthServerIsValidClientException(  Throwable cause){
    return super.mySetupMutualAuthServerIsValidClientException(cause) || causedBySSLException(cause);
  }
  @Override protected SSLEngine wrapEngine(  SSLEngine engine){
    return Java8SslTestUtils.wrapSSLEngineForTesting(engine);
  }
}
