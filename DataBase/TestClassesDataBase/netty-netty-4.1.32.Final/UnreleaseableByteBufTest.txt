public class UnreleaseableByteBufTest {
  @Test public void testCantRelease(){
    ByteBuf buf=Unpooled.unreleasableBuffer(Unpooled.copyInt(1));
    assertEquals(1,buf.refCnt());
    assertFalse(buf.release());
    assertEquals(1,buf.refCnt());
    assertFalse(buf.release());
    assertEquals(1,buf.refCnt());
    buf.retain(5);
    assertEquals(1,buf.refCnt());
    buf.retain();
    assertEquals(1,buf.refCnt());
    assertTrue(buf.unwrap().release());
    assertEquals(0,buf.refCnt());
  }
  @Test public void testWrappedReadOnly(){
    ByteBuf buf=Unpooled.unreleasableBuffer(buffer(1).asReadOnly());
    assertSame(buf,buf.asReadOnly());
    assertTrue(buf.unwrap().release());
  }
}
