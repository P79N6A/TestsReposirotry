private static final class HttpResponseDelegator extends SimpleChannelInboundHandler<HttpObject> {
  private final HttpResponseListener listener;
  private final CountDownLatch latch;
  private final CountDownLatch latch2;
  HttpResponseDelegator(  HttpResponseListener listener,  CountDownLatch latch,  CountDownLatch latch2){
    super(false);
    this.listener=listener;
    this.latch=latch;
    this.latch2=latch2;
  }
  @Override protected void channelRead0(  ChannelHandlerContext ctx,  HttpObject msg) throws Exception {
    listener.messageReceived(msg);
    latch.countDown();
    latch2.countDown();
  }
}
