/** 
 * This is a  {@link SslHandler} that will call {@code release()} on the {@link SslContext} whenthe client disconnects.
 * @see SniHandlerTest#testReplaceHandler()
 */
private static class CustomSslHandler extends SslHandler {
  private final SslContext sslContext;
  public CustomSslHandler(  SslContext sslContext,  SSLEngine sslEngine){
    super(sslEngine);
    this.sslContext=ObjectUtil.checkNotNull(sslContext,"sslContext");
  }
  @Override public void handlerRemoved0(  ChannelHandlerContext ctx) throws Exception {
    super.handlerRemoved0(ctx);
    ReferenceCountUtil.release(sslContext);
  }
}
