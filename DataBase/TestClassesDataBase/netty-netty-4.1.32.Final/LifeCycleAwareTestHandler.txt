/** 
 * Test handler to validate life-cycle aware behavior. 
 */
private static final class LifeCycleAwareTestHandler extends ChannelHandlerAdapter {
  private final String name;
  private boolean afterAdd;
  private boolean afterRemove;
  /** 
 * Constructs life-cycle aware test handler.
 * @param name Handler name to display in assertion messages.
 */
  private LifeCycleAwareTestHandler(  String name){
    this.name=name;
  }
  public void validate(  boolean afterAdd,  boolean afterRemove){
    assertEquals(name,afterAdd,this.afterAdd);
    assertEquals(name,afterRemove,this.afterRemove);
  }
  @Override public void handlerAdded(  ChannelHandlerContext ctx){
    validate(false,false);
    afterAdd=true;
  }
  @Override public void handlerRemoved(  ChannelHandlerContext ctx){
    validate(true,false);
    afterRemove=true;
  }
}
