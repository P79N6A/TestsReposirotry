private class EchoClientHandler extends EchoHandler {
  EchoClientHandler(  AtomicInteger recvCounter,  AtomicInteger negoCounter,  AtomicReference<Throwable> exception){
    super(recvCounter,negoCounter,exception);
  }
  @Override public void channelRead0(  ChannelHandlerContext ctx,  ByteBuf in) throws Exception {
    byte[] actual=new byte[in.readableBytes()];
    in.readBytes(actual);
    int lastIdx=recvCounter.get();
    for (int i=0; i < actual.length; i++) {
      assertEquals(data[i + lastIdx],actual[i]);
    }
    recvCounter.addAndGet(actual.length);
  }
}
