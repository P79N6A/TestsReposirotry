private static class AutoReadInitializer extends ChannelInitializer<Channel> {
  final AutoReadHandler autoReadHandler;
  volatile Channel channel;
  AutoReadInitializer(  boolean readInEventLoop){
    autoReadHandler=new AutoReadHandler(readInEventLoop);
  }
  @Override protected void initChannel(  Channel ch) throws Exception {
    channel=ch;
    ch.pipeline().addLast(autoReadHandler);
  }
}
