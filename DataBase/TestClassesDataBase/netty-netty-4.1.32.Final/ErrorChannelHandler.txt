private static final class ErrorChannelHandler extends ChannelHandlerAdapter {
  private final AtomicReference<Throwable> error;
  ErrorChannelHandler(  AtomicReference<Throwable> error){
    this.error=error;
  }
  @Override public void handlerAdded(  ChannelHandlerContext ctx) throws Exception {
    error.set(new AssertionError());
  }
  @Override public void handlerRemoved(  ChannelHandlerContext ctx) throws Exception {
    error.set(new AssertionError());
  }
}
