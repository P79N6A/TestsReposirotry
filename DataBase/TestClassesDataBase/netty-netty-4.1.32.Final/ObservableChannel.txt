private static class ObservableChannel extends EmbeddedChannel {
  public ObservableChannel(  ChannelHandler... handlers){
    super(handlers);
  }
  @Override protected void doWrite(  ChannelOutboundBuffer in) throws Exception {
  }
  public Object consume(){
    ChannelOutboundBuffer buf=unsafe().outboundBuffer();
    if (buf != null) {
      Object msg=buf.current();
      if (msg != null) {
        ReferenceCountUtil.retain(msg);
        buf.remove();
        return msg;
      }
    }
    return null;
  }
}
