public class WebSocket00FrameEncoderTest {
  @Test public void testMultipleWebSocketCloseFrames(){
    EmbeddedChannel channel=new EmbeddedChannel(new WebSocket00FrameEncoder());
    Assert.assertTrue(channel.writeOutbound(new CloseWebSocketFrame()));
    Assert.assertTrue(channel.writeOutbound(new CloseWebSocketFrame()));
    Assert.assertTrue(channel.finish());
    assertCloseWebSocketFrame(channel);
    assertCloseWebSocketFrame(channel);
    Assert.assertNull(channel.readOutbound());
  }
  private static void assertCloseWebSocketFrame(  EmbeddedChannel channel){
    ByteBuf buf=channel.readOutbound();
    Assert.assertEquals(2,buf.readableBytes());
    Assert.assertEquals((byte)0xFF,buf.readByte());
    Assert.assertEquals((byte)0x00,buf.readByte());
    buf.release();
  }
}
