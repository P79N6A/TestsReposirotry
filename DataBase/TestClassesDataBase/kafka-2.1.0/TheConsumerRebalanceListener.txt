private static class TheConsumerRebalanceListener implements ConsumerRebalanceListener {
  private final List<String> assignedTopics;
  private final ConsumerRebalanceListener listener;
  TheConsumerRebalanceListener(  final List<String> assignedTopics,  final ConsumerRebalanceListener listener){
    this.assignedTopics=assignedTopics;
    this.listener=listener;
  }
  @Override public void onPartitionsRevoked(  final Collection<TopicPartition> partitions){
    assignedTopics.clear();
    listener.onPartitionsRevoked(partitions);
  }
  @Override public void onPartitionsAssigned(  final Collection<TopicPartition> partitions){
    for (    final TopicPartition partition : partitions) {
      assignedTopics.add(partition.topic());
    }
    Collections.sort(assignedTopics);
    listener.onPartitionsAssigned(partitions);
  }
}
