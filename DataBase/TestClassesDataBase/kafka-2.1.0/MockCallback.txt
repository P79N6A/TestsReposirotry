private static class MockCallback implements Callback {
  private int invocations=0;
  private RecordMetadata metadata;
  private Exception exception;
  @Override public void onCompletion(  RecordMetadata metadata,  Exception exception){
    invocations++;
    this.metadata=metadata;
    this.exception=exception;
  }
}
