static class FaultyConverter extends JsonConverter {
  private static final Logger log=LoggerFactory.getLogger(FaultyConverter.class);
  private int invocations=0;
  public byte[] fromConnectData(  String topic,  Schema schema,  Object value){
    if (value == null) {
      return super.fromConnectData(topic,schema,null);
    }
    invocations++;
    if (invocations % 3 == 0) {
      log.debug("Succeeding record: {} where invocations={}",value,invocations);
      return super.fromConnectData(topic,schema,value);
    }
 else {
      log.debug("Failing record: {} at invocations={}",value,invocations);
      throw new RetriableException("Bad invocations " + invocations + " for mod 3");
    }
  }
}
