public class CompressionTypeTest {
  @Test public void testLZ4FramingMagicV0(){
    ByteBuffer buffer=ByteBuffer.allocate(256);
    KafkaLZ4BlockOutputStream out=(KafkaLZ4BlockOutputStream)CompressionType.LZ4.wrapForOutput(new ByteBufferOutputStream(buffer),RecordBatch.MAGIC_VALUE_V0);
    assertTrue(out.useBrokenFlagDescriptorChecksum());
    buffer.rewind();
    KafkaLZ4BlockInputStream in=(KafkaLZ4BlockInputStream)CompressionType.LZ4.wrapForInput(buffer,RecordBatch.MAGIC_VALUE_V0,BufferSupplier.NO_CACHING);
    assertTrue(in.ignoreFlagDescriptorChecksum());
  }
  @Test public void testLZ4FramingMagicV1(){
    ByteBuffer buffer=ByteBuffer.allocate(256);
    KafkaLZ4BlockOutputStream out=(KafkaLZ4BlockOutputStream)CompressionType.LZ4.wrapForOutput(new ByteBufferOutputStream(buffer),RecordBatch.MAGIC_VALUE_V1);
    assertFalse(out.useBrokenFlagDescriptorChecksum());
    buffer.rewind();
    KafkaLZ4BlockInputStream in=(KafkaLZ4BlockInputStream)CompressionType.LZ4.wrapForInput(buffer,RecordBatch.MAGIC_VALUE_V1,BufferSupplier.create());
    assertFalse(in.ignoreFlagDescriptorChecksum());
  }
}
