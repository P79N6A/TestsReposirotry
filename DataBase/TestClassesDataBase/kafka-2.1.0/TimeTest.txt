public class TimeTest {
  private static final GregorianCalendar EPOCH;
  private static final GregorianCalendar EPOCH_PLUS_DATE_COMPONENT;
  private static final GregorianCalendar EPOCH_PLUS_TEN_THOUSAND_MILLIS;
static {
    EPOCH=new GregorianCalendar(1970,Calendar.JANUARY,1,0,0,0);
    EPOCH.setTimeZone(TimeZone.getTimeZone("UTC"));
    EPOCH_PLUS_TEN_THOUSAND_MILLIS=new GregorianCalendar(1970,Calendar.JANUARY,1,0,0,0);
    EPOCH_PLUS_TEN_THOUSAND_MILLIS.setTimeZone(TimeZone.getTimeZone("UTC"));
    EPOCH_PLUS_TEN_THOUSAND_MILLIS.add(Calendar.MILLISECOND,10000);
    EPOCH_PLUS_DATE_COMPONENT=new GregorianCalendar(1970,Calendar.JANUARY,1,0,0,0);
    EPOCH_PLUS_DATE_COMPONENT.setTimeZone(TimeZone.getTimeZone("UTC"));
    EPOCH_PLUS_DATE_COMPONENT.add(Calendar.DATE,10000);
  }
  @Test public void testBuilder(){
    Schema plain=Time.SCHEMA;
    assertEquals(Time.LOGICAL_NAME,plain.name());
    assertEquals(1,(Object)plain.version());
  }
  @Test public void testFromLogical(){
    assertEquals(0,Time.fromLogical(Time.SCHEMA,EPOCH.getTime()));
    assertEquals(10000,Time.fromLogical(Time.SCHEMA,EPOCH_PLUS_TEN_THOUSAND_MILLIS.getTime()));
  }
  @Test(expected=DataException.class) public void testFromLogicalInvalidSchema(){
    Time.fromLogical(Time.builder().name("invalid").build(),EPOCH.getTime());
  }
  @Test(expected=DataException.class) public void testFromLogicalInvalidHasDateComponents(){
    Time.fromLogical(Time.SCHEMA,EPOCH_PLUS_DATE_COMPONENT.getTime());
  }
  @Test public void testToLogical(){
    assertEquals(EPOCH.getTime(),Time.toLogical(Time.SCHEMA,0));
    assertEquals(EPOCH_PLUS_TEN_THOUSAND_MILLIS.getTime(),Time.toLogical(Time.SCHEMA,10000));
  }
  @Test(expected=DataException.class) public void testToLogicalInvalidSchema(){
    Time.toLogical(Time.builder().name("invalid").build(),0);
  }
}
