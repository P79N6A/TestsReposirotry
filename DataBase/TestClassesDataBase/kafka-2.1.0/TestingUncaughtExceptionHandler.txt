private static final class TestingUncaughtExceptionHandler implements Thread.UncaughtExceptionHandler {
  boolean correctExceptionThrown=false;
  @Override public void uncaughtException(  final Thread t,  final Throwable e){
    assertThat(e.getClass().getSimpleName(),is("StreamsException"));
    assertThat(e.getCause().getClass().getSimpleName(),is("NoOffsetForPartitionException"));
    correctExceptionThrown=true;
  }
}
