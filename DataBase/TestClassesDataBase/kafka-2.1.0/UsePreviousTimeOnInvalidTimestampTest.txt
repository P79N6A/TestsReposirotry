public class UsePreviousTimeOnInvalidTimestampTest extends TimestampExtractorTest {
  @Test public void extractMetadataTimestamp(){
    testExtractMetadataTimestamp(new UsePreviousTimeOnInvalidTimestamp());
  }
  @Test public void usePreviousTimeOnInvalidTimestamp(){
    final long previousTime=42;
    final TimestampExtractor extractor=new UsePreviousTimeOnInvalidTimestamp();
    final long timestamp=extractor.extract(new ConsumerRecord<>("anyTopic",0,0,null,null),previousTime);
    assertThat(timestamp,is(previousTime));
  }
  @Test public void shouldThrowStreamsException(){
    final TimestampExtractor extractor=new UsePreviousTimeOnInvalidTimestamp();
    final ConsumerRecord record=new ConsumerRecord<>("anyTopic",0,0,null,null);
    try {
      extractor.extract(record,-1);
      fail("should have thrown StreamsException");
    }
 catch (    final StreamsException expected) {
    }
  }
}
