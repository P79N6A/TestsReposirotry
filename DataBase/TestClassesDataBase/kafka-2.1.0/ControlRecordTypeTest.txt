public class ControlRecordTypeTest {
  @Test public void testParseUnknownType(){
    ByteBuffer buffer=ByteBuffer.allocate(32);
    buffer.putShort(ControlRecordType.CURRENT_CONTROL_RECORD_KEY_VERSION);
    buffer.putShort((short)337);
    buffer.flip();
    ControlRecordType type=ControlRecordType.parse(buffer);
    assertEquals(ControlRecordType.UNKNOWN,type);
  }
  @Test public void testParseUnknownVersion(){
    ByteBuffer buffer=ByteBuffer.allocate(32);
    buffer.putShort((short)5);
    buffer.putShort(ControlRecordType.ABORT.type);
    buffer.putInt(23432);
    buffer.flip();
    ControlRecordType type=ControlRecordType.parse(buffer);
    assertEquals(ControlRecordType.ABORT,type);
  }
}
