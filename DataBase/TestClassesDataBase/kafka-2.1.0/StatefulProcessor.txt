/** 
 * A processor that stores each key-value pair in an in-memory key-value store registered with the context.
 */
protected static class StatefulProcessor extends AbstractProcessor<String,String> {
  private KeyValueStore<String,String> store;
  private final String storeName;
  StatefulProcessor(  final String storeName){
    this.storeName=storeName;
  }
  @Override @SuppressWarnings("unchecked") public void init(  final ProcessorContext context){
    super.init(context);
    store=(KeyValueStore<String,String>)context.getStateStore(storeName);
  }
  @Override public void process(  final String key,  final String value){
    store.put(key,value);
  }
  @Override public void close(){
    store.close();
  }
}
