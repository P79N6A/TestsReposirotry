/** 
 * Non-parameterized MemoryRecords tests.
 */
public class SimpleMemoryRecordsTest {
  @Test public void testToStringIfLz4ChecksumIsCorrupted(){
    long timestamp=1000000;
    MemoryRecords memoryRecords=MemoryRecords.withRecords(CompressionType.LZ4,new SimpleRecord(timestamp,"key1".getBytes(),"value1".getBytes()),new SimpleRecord(timestamp + 1,"key2".getBytes(),"value2".getBytes()));
    int lz4ChecksumOffset=6;
    memoryRecords.buffer().array()[DefaultRecordBatch.RECORD_BATCH_OVERHEAD + lz4ChecksumOffset]=0;
    assertEquals("[(record=CORRUPTED)]",memoryRecords.toString());
  }
}
