private class ConcurrentMetricOperation implements Runnable {
  private final AtomicBoolean alive;
  private final String opName;
  private final Runnable op;
  ConcurrentMetricOperation(  AtomicBoolean alive,  String opName,  Runnable op){
    this.alive=alive;
    this.opName=opName;
    this.op=op;
  }
  public void run(){
    try {
      while (alive.get()) {
        op.run();
      }
    }
 catch (    Throwable t) {
      log.error("Metric {} failed with exception",opName,t);
    }
  }
}
