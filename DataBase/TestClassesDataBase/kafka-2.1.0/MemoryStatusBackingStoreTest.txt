public class MemoryStatusBackingStoreTest {
  @Test public void putAndGetConnectorStatus(){
    MemoryStatusBackingStore store=new MemoryStatusBackingStore();
    ConnectorStatus status=new ConnectorStatus("connector",ConnectorStatus.State.RUNNING,"localhost:8083",0);
    store.put(status);
    assertEquals(status,store.get("connector"));
  }
  @Test public void putAndGetTaskStatus(){
    MemoryStatusBackingStore store=new MemoryStatusBackingStore();
    ConnectorTaskId taskId=new ConnectorTaskId("connector",0);
    TaskStatus status=new TaskStatus(taskId,ConnectorStatus.State.RUNNING,"localhost:8083",0);
    store.put(status);
    assertEquals(status,store.get(taskId));
    assertEquals(Collections.singleton(status),store.getAll("connector"));
  }
  @Test public void deleteConnectorStatus(){
    MemoryStatusBackingStore store=new MemoryStatusBackingStore();
    store.put(new ConnectorStatus("connector",ConnectorStatus.State.RUNNING,"localhost:8083",0));
    store.put(new ConnectorStatus("connector",ConnectorStatus.State.DESTROYED,"localhost:8083",0));
    assertNull(store.get("connector"));
  }
  @Test public void deleteTaskStatus(){
    MemoryStatusBackingStore store=new MemoryStatusBackingStore();
    ConnectorTaskId taskId=new ConnectorTaskId("connector",0);
    store.put(new TaskStatus(taskId,ConnectorStatus.State.RUNNING,"localhost:8083",0));
    store.put(new TaskStatus(taskId,ConnectorStatus.State.DESTROYED,"localhost:8083",0));
    assertNull(store.get(taskId));
  }
}
