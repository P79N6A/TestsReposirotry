private static class RetainNonNullKeysFilter extends MemoryRecords.RecordFilter {
  @Override protected BatchRetention checkBatchRetention(  RecordBatch batch){
    return BatchRetention.DELETE_EMPTY;
  }
  @Override public boolean shouldRetainRecord(  RecordBatch batch,  Record record){
    return record.hasKey();
  }
}
