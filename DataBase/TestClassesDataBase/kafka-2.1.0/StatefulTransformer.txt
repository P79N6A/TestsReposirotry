private static class StatefulTransformer implements ValueTransformerWithKey<String,String,Integer> {
  private int counter;
  @Override public void init(  final ProcessorContext context){
  }
  @Override public Integer transform(  final String readOnlyKey,  final String value){
    return ++counter;
  }
  @Override public void close(){
  }
}
