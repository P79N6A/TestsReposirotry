public static class KeyValueStoreProcessor implements Processor<Integer,Integer> {
  private String topic;
  private final CountDownLatch processorLatch;
  private KeyValueStore<Integer,Integer> store;
  public KeyValueStoreProcessor(  final String topic,  final CountDownLatch processorLatch){
    this.topic=topic;
    this.processorLatch=processorLatch;
  }
  @Override public void init(  final ProcessorContext context){
    this.store=(KeyValueStore<Integer,Integer>)context.getStateStore(topic);
  }
  @Override public void process(  final Integer key,  final Integer value){
    if (key != null) {
      store.put(key,value);
      processorLatch.countDown();
    }
  }
  @Override public void close(){
  }
}
