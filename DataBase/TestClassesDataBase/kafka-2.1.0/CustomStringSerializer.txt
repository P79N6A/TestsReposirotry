private static class CustomStringSerializer extends StringSerializer {
  private boolean isKey;
  private CustomStringSerializer(){
  }
  @Override public void configure(  final Map<String,?> configs,  final boolean isKey){
    this.isKey=isKey;
    super.configure(configs,isKey);
  }
  @Override public byte[] serialize(  final String topic,  final Headers headers,  final String data){
    if (isKey) {
      headers.add(new RecordHeader("key","key".getBytes()));
    }
 else {
      headers.add(new RecordHeader("value","value".getBytes()));
    }
    return serialize(topic,data);
  }
}
