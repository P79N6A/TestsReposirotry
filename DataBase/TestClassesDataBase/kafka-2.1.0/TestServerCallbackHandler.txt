public static class TestServerCallbackHandler extends PlainServerCallbackHandler {
  static final String USERNAME="TestServerCallbackHandler-user";
  static final String PASSWORD="TestServerCallbackHandler-password";
  private volatile boolean configured;
  @Override public void configure(  Map<String,?> configs,  String mechanism,  List<AppConfigurationEntry> jaasConfigEntries){
    if (configured)     throw new IllegalStateException("Server callback handler configured twice");
    configured=true;
    super.configure(configs,mechanism,jaasConfigEntries);
  }
  @Override protected boolean authenticate(  String username,  char[] password){
    if (!configured)     throw new IllegalStateException("Server callback handler not configured");
    return USERNAME.equals(username) && new String(password).equals(PASSWORD);
  }
}
