private class RepartitionTopicCreatedWithExpectedConfigs implements TestCondition {
  @Override final public boolean conditionMet(){
    try {
      final Set<String> topics=adminClient.listTopics().names().get();
      if (!topics.contains(REPARTITION_TOPIC)) {
        return false;
      }
    }
 catch (    final Exception e) {
      return false;
    }
    try {
      final ConfigResource resource=new ConfigResource(ConfigResource.Type.TOPIC,REPARTITION_TOPIC);
      final Config config=adminClient.describeConfigs(Collections.singleton(resource)).values().get(resource).get();
      return config.get(TopicConfig.CLEANUP_POLICY_CONFIG).value().equals(TopicConfig.CLEANUP_POLICY_DELETE) && config.get(TopicConfig.SEGMENT_MS_CONFIG).value().equals(purgeIntervalMs.toString()) && config.get(TopicConfig.SEGMENT_BYTES_CONFIG).value().equals(purgeSegmentBytes.toString());
    }
 catch (    final Exception e) {
      return false;
    }
  }
}
