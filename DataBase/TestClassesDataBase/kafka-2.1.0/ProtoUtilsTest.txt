public class ProtoUtilsTest {
  @Test public void testDelayedAllocationSchemaDetection() throws Exception {
    for (    ApiKeys key : ApiKeys.values()) {
      if (key == ApiKeys.PRODUCE || key == ApiKeys.JOIN_GROUP || key == ApiKeys.SYNC_GROUP || key == ApiKeys.SASL_AUTHENTICATE || key == ApiKeys.EXPIRE_DELEGATION_TOKEN || key == ApiKeys.RENEW_DELEGATION_TOKEN) {
        assertTrue(key + " should require delayed allocation",key.requiresDelayedAllocation);
      }
 else {
        assertFalse(key + " should not require delayed allocation",key.requiresDelayedAllocation);
      }
    }
  }
}
