private static class NonOverflowingByteBufferChannel extends org.apache.kafka.common.requests.ByteBufferChannel {
  private NonOverflowingByteBufferChannel(  long size){
    super(size);
  }
  @Override public long write(  ByteBuffer[] srcs) throws IOException {
    if (!buffer().hasRemaining())     return 0;
    return super.write(srcs);
  }
}
