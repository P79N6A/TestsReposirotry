public static class SemanticAnalysisHook implements HiveSemanticAnalyzerHook {
  public static String userName;
  public static String command;
  public static HiveOperation commandType;
  public static String ipAddress;
  public static Throwable preAnalyzeError;
  public static Throwable postAnalyzeError;
  @Override public ASTNode preAnalyze(  HiveSemanticAnalyzerHookContext context,  ASTNode ast) throws SemanticException {
    try {
      userName=context.getUserName();
      ipAddress=context.getIpAddress();
      command=context.getCommand();
      commandType=context.getHiveOperation();
    }
 catch (    Throwable t) {
      LOG.error("Error in semantic analysis hook preAnalyze: " + t,t);
      preAnalyzeError=t;
    }
    return ast;
  }
  @Override public void postAnalyze(  HiveSemanticAnalyzerHookContext context,  List<Task<? extends Serializable>> rootTasks) throws SemanticException {
    try {
      userName=context.getUserName();
      ipAddress=context.getIpAddress();
      command=context.getCommand();
      commandType=context.getHiveOperation();
    }
 catch (    Throwable t) {
      LOG.error("Error in semantic analysis hook postAnalyze: " + t,t);
      postAnalyzeError=t;
    }
  }
}
