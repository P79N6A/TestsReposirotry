public static class OrcTestMapper2 extends Mapper<Object,Text,Object,Writable> {
  private final TypeInfo typeInfo=TypeInfoUtils.getTypeInfoFromTypeString("struct<a:int,b:string>");
  private final ObjectInspector oip=TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(typeInfo);
  private final OrcSerde serde=new OrcSerde();
  private Writable row;
  @Override public void map(  Object key,  Text value,  Context context) throws IOException, InterruptedException {
    String[] items=value.toString().split(",");
    List<Object> struct=new ArrayList<Object>(2);
    struct.add(0,Integer.parseInt(items[0]));
    struct.add(1,items[1]);
    row=serde.serialize(struct,oip);
    context.write(null,row);
  }
}
