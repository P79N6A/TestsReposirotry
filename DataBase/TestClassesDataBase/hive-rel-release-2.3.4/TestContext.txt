public class TestContext {
  private static HiveConf conf=new HiveConf();
  private Context context;
  @Before public void setUp() throws IOException {
    SessionState.start(conf);
    SessionState.detachSession();
    context=new Context(conf);
  }
  @Test public void testGetScratchDirectoriesForPaths() throws IOException {
    Context spyContext=spy(context);
    Path mrTmpPath=new Path("hdfs://hostname/tmp/scratch");
    doReturn(mrTmpPath).when(spyContext).getMRTmpPath();
    assertEquals(mrTmpPath,spyContext.getTempDirForPath(new Path("s3a://bucket/dir")));
    assertEquals(mrTmpPath,spyContext.getTempDirForPath(new Path("file:/user")));
    assertEquals(mrTmpPath,spyContext.getTempDirForPath(new Path("file:///user")));
    Path tmpPathRelTo=new Path("hdfs://hostname/user");
    doReturn(tmpPathRelTo).when(spyContext).getExtTmpPathRelTo(any(Path.class));
    assertEquals(tmpPathRelTo,spyContext.getTempDirForPath(new Path("/user")));
  }
}
