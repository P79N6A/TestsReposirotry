public class TestGenMapRedUtilsUsePartitionColumnsNegative {
  @Test(expected=NullPointerException.class) public void testUsePartitionColumnsNoPartColNames(){
    Properties p=new Properties();
    GenMapRedUtils.usePartitionColumns(p,Arrays.asList("p1"));
  }
  @Test(expected=IllegalArgumentException.class) public void testUsePartitionColumnsNamesTypesMismatch(){
    Properties p=new Properties();
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,"p1/p2");
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES,"t1");
    GenMapRedUtils.usePartitionColumns(p,Arrays.asList("p1"));
  }
  @Test(expected=IllegalArgumentException.class) public void testUsePartitionColumnsNoPartitionsToRetain(){
    Properties p=new Properties();
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,"p1");
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES,"t1");
    GenMapRedUtils.usePartitionColumns(p,Collections.EMPTY_LIST);
  }
  @Test(expected=RuntimeException.class) public void testUsePartitionColumnsWrongPartColName(){
    Properties p=new Properties();
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,"p1");
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES,"t1");
    GenMapRedUtils.usePartitionColumns(p,Arrays.asList("p2"));
  }
  @Test(expected=IllegalArgumentException.class) public void testUsePartitionColumnsDuplicatePartColNameInArgument(){
    Properties p=new Properties();
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,"p1/p2");
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES,"t1:t2");
    GenMapRedUtils.usePartitionColumns(p,Arrays.asList("p1","p2","p1"));
  }
  @Test(expected=IllegalArgumentException.class) public void testUsePartitionColumnsDuplicatePartColNameInConfiguration(){
    Properties p=new Properties();
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,"p1/p2/p1");
    p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES,"t1:t2:t3");
    GenMapRedUtils.usePartitionColumns(p,Arrays.asList("p1"));
  }
}
