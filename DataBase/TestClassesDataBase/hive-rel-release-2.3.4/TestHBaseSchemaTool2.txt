/** 
 * This is in a separate class because install tests shouldn't set up the metastore first.
 */
public class TestHBaseSchemaTool2 extends HBaseIntegrationTests {
  private String lsep=System.getProperty("line.separator");
  @BeforeClass public static void startup() throws Exception {
    HBaseIntegrationTests.startMiniCluster();
  }
  @AfterClass public static void shutdown() throws Exception {
    HBaseIntegrationTests.shutdownMiniCluster();
  }
  @Test public void install(){
    ByteArrayOutputStream outStr=new ByteArrayOutputStream();
    PrintStream out=new PrintStream(outStr);
    ByteArrayOutputStream errStr=new ByteArrayOutputStream();
    PrintStream err=new PrintStream(errStr);
    HBaseSchemaTool tool=new HBaseSchemaTool();
    tool.install(conf,err);
    tool.go(true,null,null,null,conf,out,err);
    Assert.assertEquals(StringUtils.join(HBaseReadWrite.tableNames,lsep) + lsep,outStr.toString());
  }
}
