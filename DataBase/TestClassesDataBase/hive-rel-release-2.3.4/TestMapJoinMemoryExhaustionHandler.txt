public class TestMapJoinMemoryExhaustionHandler {
  private static final Logger LOG=LoggerFactory.getLogger(TestMapJoinMemoryExhaustionHandler.class);
  private LogHelper logHelper;
  @Before public void setup(){
    logHelper=new LogHelper(LOG);
  }
  @Test(expected=MapJoinMemoryExhaustionException.class) public void testAbort() throws MapJoinMemoryExhaustionException {
    MapJoinMemoryExhaustionHandler handler=new MapJoinMemoryExhaustionHandler(logHelper,0.01d);
    List<byte[]> memoryConsumer=new ArrayList<byte[]>();
    while (true) {
      handler.checkMemoryStatus(1,1);
      memoryConsumer.add(new byte[5 * 1024 * 1024]);
    }
  }
}
