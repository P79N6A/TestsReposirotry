public class TestGenericUDFOPNegative {
  @Test public void testByte() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    ByteWritable input=new ByteWritable((byte)4);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.writableByteObjectInspector};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.byteTypeInfo,oi.getTypeInfo());
    ByteWritable res=(ByteWritable)udf.evaluate(args);
    Assert.assertEquals((byte)-4,res.get());
  }
  @Test public void testShort() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    ShortWritable input=new ShortWritable((short)74);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.writableShortObjectInspector};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.shortTypeInfo,oi.getTypeInfo());
    ShortWritable res=(ShortWritable)udf.evaluate(args);
    Assert.assertEquals((short)-74,res.get());
  }
  @Test public void testInt() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    IntWritable input=new IntWritable(747);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.writableIntObjectInspector};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.intTypeInfo,oi.getTypeInfo());
    IntWritable res=(IntWritable)udf.evaluate(args);
    Assert.assertEquals(-747,res.get());
  }
  @Test public void testLong() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    LongWritable input=new LongWritable(3234747);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.writableLongObjectInspector};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.longTypeInfo,oi.getTypeInfo());
    LongWritable res=(LongWritable)udf.evaluate(args);
    Assert.assertEquals(-3234747L,res.get());
  }
  @Test public void testFloat() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    FloatWritable input=new FloatWritable(323.4747f);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.writableFloatObjectInspector};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.floatTypeInfo,oi.getTypeInfo());
    FloatWritable res=(FloatWritable)udf.evaluate(args);
    Assert.assertEquals(new Float(-323.4747f),new Float(res.get()));
  }
  @Test public void testDouble() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    DoubleWritable input=new DoubleWritable(32300.004747);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.writableDoubleObjectInspector};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
    DoubleWritable res=(DoubleWritable)udf.evaluate(args);
    Assert.assertEquals(new Double(-32300.004747),new Double(res.get()));
  }
  @Test public void testDecimal() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    HiveDecimalWritable input=new HiveDecimalWritable(HiveDecimal.create("32300.004747"));
    DecimalTypeInfo inputTypeInfo=TypeInfoFactory.getDecimalTypeInfo(11,6);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(inputTypeInfo,oi.getTypeInfo());
    HiveDecimalWritable res=(HiveDecimalWritable)udf.evaluate(args);
    Assert.assertEquals(HiveDecimal.create("-32300.004747"),res.getHiveDecimal());
  }
  @Test public void testString() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    Text input=new Text("32300.004747");
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.writableStringObjectInspector};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
    DoubleWritable res=(DoubleWritable)udf.evaluate(args);
    Assert.assertEquals(new Double(-32300.004747),new Double(res.get()));
  }
  @Test public void testVarchar() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    HiveVarchar vc=new HiveVarchar("32300.004747",12);
    HiveVarcharWritable input=new HiveVarcharWritable(vc);
    VarcharTypeInfo inputTypeInfo=TypeInfoFactory.getVarcharTypeInfo(12);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
    DoubleWritable res=(DoubleWritable)udf.evaluate(args);
    Assert.assertEquals(new Double(-32300.004747),new Double(res.get()));
  }
  @Test public void testChar() throws HiveException {
    GenericUDFOPNegative udf=new GenericUDFOPNegative();
    HiveChar vc=new HiveChar("32300.004747",12);
    HiveCharWritable input=new HiveCharWritable(vc);
    CharTypeInfo inputTypeInfo=TypeInfoFactory.getCharTypeInfo(12);
    ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
    DeferredObject[] args={new DeferredJavaObject(input)};
    PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
    Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
    DoubleWritable res=(DoubleWritable)udf.evaluate(args);
    Assert.assertEquals(new Double(-32300.004747),new Double(res.get()));
  }
}
