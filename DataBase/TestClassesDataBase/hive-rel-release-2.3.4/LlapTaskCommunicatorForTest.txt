private static class LlapTaskCommunicatorForTest extends LlapTaskCommunicator {
  private final LlapProtocolClientProxy llapProxy;
  public LlapTaskCommunicatorForTest(  TaskCommunicatorContext taskCommunicatorContext){
    this(taskCommunicatorContext,mock(LlapProtocolClientProxy.class));
  }
  public LlapTaskCommunicatorForTest(  TaskCommunicatorContext taskCommunicatorContext,  LlapProtocolClientProxy llapProxy){
    super(taskCommunicatorContext);
    this.llapProxy=llapProxy;
  }
  @Override protected void startRpcServer(){
  }
  @Override protected LlapProtocolClientProxy createLlapProtocolClientProxy(  int numThreads,  Configuration conf){
    return llapProxy;
  }
  @Override public InetSocketAddress getAddress(){
    return InetSocketAddress.createUnresolved("localhost",15001);
  }
  @Override public String getAmHostString(){
    return "localhost";
  }
}
