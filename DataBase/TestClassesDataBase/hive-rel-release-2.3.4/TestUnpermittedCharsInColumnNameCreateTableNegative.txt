/** 
 * Parser tests for unpermitted chars in column names. Please find more information in HIVE-10120
 */
public class TestUnpermittedCharsInColumnNameCreateTableNegative {
  private static HiveConf conf;
  private ParseDriver pd;
  @BeforeClass public static void initialize(){
    conf=new HiveConf(SemanticAnalyzer.class);
    SessionState.start(conf);
  }
  @Before public void setup() throws SemanticException, IOException {
    pd=new ParseDriver();
  }
  ASTNode parse(  String query) throws ParseException {
    ASTNode nd=null;
    try {
      nd=pd.parse(query,new Context(conf));
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
    return (ASTNode)nd.getChild(0);
  }
  @Test public void testDotInCreateTable(){
    try {
      parse("CREATE TABLE testTable (`emp.no` STRING)");
      Assert.assertFalse("Expected ParseException",true);
    }
 catch (    ParseException ex) {
      Assert.assertEquals("Failure didn't match.","line 1:39 Failed to recognize predicate ')'. Failed rule: '[., :] can not be used in column name in create table statement.' in column specification",ex.getMessage());
    }
  }
  @Test public void testColonInCreateTable(){
    try {
      parse("CREATE TABLE testTable (`emp:no` STRING)");
      Assert.assertFalse("Expected ParseException",true);
    }
 catch (    ParseException ex) {
      Assert.assertEquals("Failure didn't match.","line 1:39 Failed to recognize predicate ')'. Failed rule: '[., :] can not be used in column name in create table statement.' in column specification",ex.getMessage());
    }
  }
}
