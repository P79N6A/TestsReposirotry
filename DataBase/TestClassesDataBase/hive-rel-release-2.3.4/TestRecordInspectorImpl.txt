public class TestRecordInspectorImpl {
  private static final int ROW_ID_COLUMN=2;
  private RecordInspectorImpl inspector=new RecordInspectorImpl(ObjectInspectorFactory.getReflectionObjectInspector(MutableRecord.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA),ROW_ID_COLUMN);
  @Test public void testExtractRecordIdentifier(){
    RecordIdentifier recordIdentifier=new RecordIdentifier(10L,4,20L);
    MutableRecord record=new MutableRecord(1,"hello",recordIdentifier);
    assertThat(inspector.extractRecordIdentifier(record),is(recordIdentifier));
  }
  @Test(expected=IllegalArgumentException.class) public void testNotAStructObjectInspector(){
    new RecordInspectorImpl(PrimitiveObjectInspectorFactory.javaBooleanObjectInspector,2);
  }
}
