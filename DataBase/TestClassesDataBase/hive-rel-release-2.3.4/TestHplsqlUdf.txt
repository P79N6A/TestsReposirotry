public class TestHplsqlUdf {
  StringObjectInspector queryOI=PrimitiveObjectInspectorFactory.javaStringObjectInspector;
  ObjectInspector argOI=PrimitiveObjectInspectorFactory.javaStringObjectInspector;
  /** 
 * test evaluate for exec init and setParameters
 */
  @Test public void testEvaluateWithoutRun() throws HiveException {
    Udf udf=new Udf();
    ObjectInspector[] initArguments={queryOI,argOI};
    udf.initialize(initArguments);
    DeferredObject queryObj=new DeferredJavaObject("hello(:1)");
    DeferredObject argObj=new DeferredJavaObject("name");
    DeferredObject[] argumentsObj={queryObj,argObj};
    udf.initExec(argumentsObj);
    udf.setParameters(argumentsObj);
    Var var=udf.exec.findVariable(":1");
    Assert.assertNotNull(var);
    String val=(String)var.value;
    Assert.assertEquals(val,"name");
  }
}
