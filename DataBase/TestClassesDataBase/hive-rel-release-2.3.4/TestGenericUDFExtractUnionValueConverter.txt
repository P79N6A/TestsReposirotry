public class TestGenericUDFExtractUnionValueConverter {
  private final StandardUnionObjectInspector unionObjectInspector=ObjectInspectorFactory.getStandardUnionObjectInspector(Arrays.<ObjectInspector>asList(PrimitiveObjectInspectorFactory.javaStringObjectInspector,PrimitiveObjectInspectorFactory.javaIntObjectInspector));
  private final Object union=new StandardUnion((byte)0,"foo");
  private final ValueConverter underTest=new ValueConverter();
  @Test public void convertValue(){
    ObjectInspector inspector=PrimitiveObjectInspectorFactory.javaStringObjectInspector;
    Object value="foo";
    Object result=underTest.convert(value,inspector);
    assertThat(result,is((Object)"foo"));
  }
  @Test public void convertList(){
    ObjectInspector inspector=ObjectInspectorFactory.getStandardListObjectInspector(unionObjectInspector);
    Object value=Arrays.asList(union);
    @SuppressWarnings("unchecked") List<Object> result=(List<Object>)underTest.convert(value,inspector);
    assertThat(result.size(),is(1));
    assertThat(result.get(0),is((Object)Arrays.asList("foo",null)));
  }
  @Test public void convertMap(){
    ObjectInspector inspector=ObjectInspectorFactory.getStandardMapObjectInspector(PrimitiveObjectInspectorFactory.javaStringObjectInspector,unionObjectInspector);
    Object value=Collections.singletonMap("bar",union);
    @SuppressWarnings("unchecked") Map<String,Object> result=(Map<String,Object>)underTest.convert(value,inspector);
    assertThat(result.size(),is(1));
    assertThat(result.get("bar"),is((Object)Arrays.asList("foo",null)));
  }
  @Test public void convertStruct(){
    ObjectInspector inspector=ObjectInspectorFactory.getStandardStructObjectInspector(Arrays.asList("foo"),Arrays.<ObjectInspector>asList(unionObjectInspector));
    Object value=Arrays.asList(union);
    @SuppressWarnings("unchecked") List<Object> result=(List<Object>)underTest.convert(value,inspector);
    assertThat(result.size(),is(1));
    assertThat(result.get(0),is((Object)Arrays.asList("foo",null)));
  }
  @Test public void convertUnion(){
    @SuppressWarnings("unchecked") List<Object> result=(List<Object>)underTest.convert(union,unionObjectInspector);
    assertThat(result.size(),is(2));
    assertThat(result.get(0),is((Object)"foo"));
    assertThat(result.get(1),is(nullValue()));
  }
}
