public class TestLogDirectoryCleaner {
  @Rule public TemporaryFolder baseDir=new TemporaryFolder();
  @org.junit.Test public void testClean() throws Exception {
    File dir=create("a-0","a-1","a-2","malformed","b-0","c-0","c-5");
    LogDirectoryCleaner cleaner=new LogDirectoryCleaner(dir,1);
    cleaner.run();
    List<String> remaining=Lists.newArrayList(dir.list());
    Collections.sort(remaining);
    Assert.assertEquals(Lists.newArrayList("a-1","a-2","b-0","c-5","malformed"),remaining);
  }
  private File create(  String... names){
    File root=baseDir.getRoot();
    Preconditions.checkState(root.isDirectory(),root.toString());
    for (    String name : names) {
      File dir=new File(root,name);
      Preconditions.checkState(dir.mkdirs(),dir.toString());
    }
    return root;
  }
}
