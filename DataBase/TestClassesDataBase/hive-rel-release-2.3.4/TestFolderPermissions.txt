public class TestFolderPermissions extends FolderPermissionBase {
  @BeforeClass public static void setup() throws Exception {
    conf=new HiveConf(TestFolderPermissions.class);
    conf.setVar(HiveConf.ConfVars.HIVEMAPREDMODE,"nonstrict");
    baseSetup();
  }
  public FsPermission[] expected=new FsPermission[]{FsPermission.createImmutable((short)0777),FsPermission.createImmutable((short)0766)};
  @Override public void setPermission(  String locn,  int permIndex) throws Exception {
    fs.setPermission(new Path(locn),expected[permIndex]);
  }
  @Override public void verifyPermission(  String locn,  int permIndex) throws Exception {
    FsPermission actual=fs.getFileStatus(new Path(locn)).getPermission();
    Assert.assertEquals(expected[permIndex],actual);
  }
}
