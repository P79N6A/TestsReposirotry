private final static class FsWithHash {
  private FileSplit fs;
  public FsWithHash(  FileSplit fs){
    this.fs=fs;
  }
  @Override public int hashCode(){
    if (fs == null)     return 0;
    final int prime=31;
    int result=prime * 1 + fs.getPath().hashCode();
    result=prime * result + Long.valueOf(fs.getStart()).hashCode();
    return prime * result + Long.valueOf(fs.getLength()).hashCode();
  }
  @Override public boolean equals(  Object obj){
    if (this == obj)     return true;
    if (!(obj instanceof FsWithHash))     return false;
    FsWithHash other=(FsWithHash)obj;
    if ((fs == null) != (other.fs == null))     return false;
    if (fs == null && other.fs == null)     return true;
    return fs.getStart() == other.fs.getStart() && fs.getLength() == other.fs.getLength() && fs.getPath().equals(other.fs.getPath());
  }
}
