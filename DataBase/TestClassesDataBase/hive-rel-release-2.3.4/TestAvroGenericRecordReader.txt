public class TestAvroGenericRecordReader {
  @Mock private JobConf jobConf;
  @Mock private FileSplit emptyFileSplit;
  @Mock private Reporter reporter;
  @Before public void setup(){
    MockitoAnnotations.initMocks(this);
    when(emptyFileSplit.getLength()).thenReturn(0l);
  }
  @Test public void emptyFile() throws IOException {
    AvroGenericRecordReader reader=new AvroGenericRecordReader(jobConf,emptyFileSplit,reporter);
    Assert.assertEquals(false,reader.next(null,null));
    Assert.assertEquals(0,reader.getPos());
    reader.close();
  }
}
