private static class RowCollector implements RowProcessor {
  ArrayList<String[]> rows=new ArrayList<String[]>();
  Schema schema=null;
  int numColumns=0;
  public void process(  Row row){
    if (schema == null) {
      schema=row.getSchema();
      numColumns=schema.getColumns().size();
    }
    String[] arr=new String[numColumns];
    for (int idx=0; idx < numColumns; ++idx) {
      arr[idx]=row.getValue(idx).toString();
    }
    rows.add(arr);
  }
}
