public class TestHiveMetastoreCli {
  private static final String[] CLI_ARGUMENTS={"9999"};
  @Test public void testDefaultCliPortValue(){
    HiveConf configuration=new HiveConf();
    HiveMetaStore.HiveMetastoreCli cli=new HiveMetaStore.HiveMetastoreCli(configuration);
    assert (cli.getPort() == HiveConf.getIntVar(configuration,HiveConf.ConfVars.METASTORE_SERVER_PORT));
  }
  @Test public void testOverriddenCliPortValue(){
    HiveConf configuration=new HiveConf();
    HiveMetaStore.HiveMetastoreCli cli=new HiveMetaStore.HiveMetastoreCli(configuration);
    cli.parse(TestHiveMetastoreCli.CLI_ARGUMENTS);
    assert (cli.getPort() == 9999);
  }
  @Test public void testOverriddenMetastoreServerPortValue(){
    HiveConf configuration=new HiveConf();
    HiveConf.setIntVar(configuration,HiveConf.ConfVars.METASTORE_SERVER_PORT,12345);
    HiveMetaStore.HiveMetastoreCli cli=new HiveMetaStore.HiveMetastoreCli(configuration);
    assert (cli.getPort() == 12345);
  }
  @Test public void testCliOverridesConfiguration(){
    HiveConf configuration=new HiveConf();
    HiveConf.setIntVar(configuration,HiveConf.ConfVars.METASTORE_SERVER_PORT,12345);
    HiveMetaStore.HiveMetastoreCli cli=new HiveMetaStore.HiveMetastoreCli(configuration);
    cli.parse(CLI_ARGUMENTS);
    assert (cli.getPort() == 9999);
  }
}
