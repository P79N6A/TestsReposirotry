private static class CounterIncrementJob implements Job<String>, VoidFunction<Integer> {
  private SparkCounters counters;
  @Override public String call(  JobContext jc){
    counters=new SparkCounters(jc.sc());
    counters.createCounter("group1","counter1");
    counters.createCounter("group2","counter2");
    jc.monitor(jc.sc().parallelize(Arrays.asList(1,2,3,4,5),5).foreachAsync(this),counters,null);
    return null;
  }
  @Override public void call(  Integer l) throws Exception {
    counters.getCounter("group1","counter1").increment(l.longValue());
    counters.getCounter("group2","counter2").increment(l.longValue());
  }
}
