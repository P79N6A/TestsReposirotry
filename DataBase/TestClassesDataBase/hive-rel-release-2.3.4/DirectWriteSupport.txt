public static class DirectWriteSupport extends WriteSupport<Void> {
  private RecordConsumer recordConsumer;
  private final MessageType type;
  private final DirectWriter writer;
  private final Map<String,String> metadata;
  private DirectWriteSupport(  MessageType type,  DirectWriter writer,  Map<String,String> metadata){
    this.type=type;
    this.writer=writer;
    this.metadata=metadata;
  }
  @Override public WriteContext init(  Configuration configuration){
    return new WriteContext(type,metadata);
  }
  @Override public void prepareForWrite(  RecordConsumer recordConsumer){
    this.recordConsumer=recordConsumer;
  }
  @Override public void write(  Void record){
    writer.write(recordConsumer);
  }
}
