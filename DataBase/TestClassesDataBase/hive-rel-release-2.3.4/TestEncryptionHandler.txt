private static class TestEncryptionHandler implements KryoMessageCodec.EncryptionHandler {
  private static final byte KEY=0x42;
  private final boolean encrypt;
  private final boolean decrypt;
  TestEncryptionHandler(  boolean encrypt,  boolean decrypt){
    this.encrypt=encrypt;
    this.decrypt=decrypt;
  }
  public byte[] wrap(  byte[] data,  int offset,  int len) throws IOException {
    return encrypt ? transform(data,offset,len) : data;
  }
  public byte[] unwrap(  byte[] data,  int offset,  int len) throws IOException {
    return decrypt ? transform(data,offset,len) : data;
  }
  public void dispose() throws IOException {
  }
  private byte[] transform(  byte[] data,  int offset,  int len){
    byte[] dest=new byte[len];
    for (int i=0; i < len; i++) {
      dest[i]=(byte)(data[offset + i] ^ KEY);
    }
    return dest;
  }
}
