/** 
 */
public class TestAccumuloConnectionParameters {
  @Test public void testInstantiatesWithNullConfiguration(){
    AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(null);
    try {
      cnxnParams.getAccumuloInstanceName();
      Assert.fail("Should have gotten an NPE");
    }
 catch (    NullPointerException e) {
    }
  }
  @Test(expected=IllegalArgumentException.class) public void testMissingInstanceName(){
    Configuration conf=new Configuration(false);
    conf.set(AccumuloConnectionParameters.ZOOKEEPERS,"localhost:2181");
    conf.set(AccumuloConnectionParameters.USER_NAME,"user");
    conf.set(AccumuloConnectionParameters.USER_PASS,"password");
    AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(conf);
    cnxnParams.getInstance();
  }
  @Test(expected=IllegalArgumentException.class) public void testMissingZooKeepers(){
    Configuration conf=new Configuration(false);
    conf.set(AccumuloConnectionParameters.INSTANCE_NAME,"accumulo");
    conf.set(AccumuloConnectionParameters.USER_NAME,"user");
    conf.set(AccumuloConnectionParameters.USER_PASS,"password");
    AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(conf);
    cnxnParams.getInstance();
  }
  @Test(expected=IllegalArgumentException.class) public void testMissingUserName() throws AccumuloException, AccumuloSecurityException {
    Configuration conf=new Configuration(false);
    conf.set(AccumuloConnectionParameters.INSTANCE_NAME,"accumulo");
    conf.set(AccumuloConnectionParameters.ZOOKEEPERS,"localhost:2181");
    conf.set(AccumuloConnectionParameters.USER_PASS,"password");
    Instance instance=Mockito.mock(Instance.class);
    AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(conf);
    cnxnParams.getConnector(instance);
  }
  @Test(expected=IllegalArgumentException.class) public void testMissingPassword() throws AccumuloException, AccumuloSecurityException {
    Configuration conf=new Configuration(false);
    conf.set(AccumuloConnectionParameters.INSTANCE_NAME,"accumulo");
    conf.set(AccumuloConnectionParameters.ZOOKEEPERS,"localhost:2181");
    conf.set(AccumuloConnectionParameters.USER_NAME,"user");
    Instance instance=Mockito.mock(Instance.class);
    AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(conf);
    cnxnParams.getConnector(instance);
  }
  public void testSasl(){
    Configuration conf=new Configuration(false);
    AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(conf);
    assertFalse(cnxnParams.useSasl());
    conf.set(AccumuloConnectionParameters.SASL_ENABLED,"true");
    cnxnParams=new AccumuloConnectionParameters(conf);
    assertTrue(cnxnParams.useSasl());
    conf.set(AccumuloConnectionParameters.SASL_ENABLED,"false");
    assertFalse(cnxnParams.useSasl());
  }
}
