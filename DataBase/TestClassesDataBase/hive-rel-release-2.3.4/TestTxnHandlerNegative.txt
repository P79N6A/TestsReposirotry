public class TestTxnHandlerNegative {
  static final private Logger LOG=LoggerFactory.getLogger(TestTxnHandlerNegative.class);
  /** 
 * this intentionally sets a bad URL for connection to test error handling logic in TxnHandler
 * @throws Exception
 */
  @Test public void testBadConnection() throws Exception {
    HiveConf conf=new HiveConf();
    conf.setVar(HiveConf.ConfVars.METASTORECONNECTURLKEY,"blah");
    RuntimeException e=null;
    try {
      TxnUtils.getTxnStore(conf);
    }
 catch (    RuntimeException ex) {
      LOG.info("Expected error: " + ex.getMessage(),ex);
      e=ex;
    }
    assertNotNull(e);
    assertTrue(e.getMessage().contains("No suitable driver found for blah") || e.getMessage().contains("Failed to get driver instance for jdbcUrl=blah"));
  }
}
