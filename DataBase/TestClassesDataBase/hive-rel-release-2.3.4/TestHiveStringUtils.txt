public class TestHiveStringUtils {
  @Test public void testSplitAndUnEscape() throws Exception {
    splitAndUnEscapeTestCase(null,null);
    splitAndUnEscapeTestCase("'single element'",new String[]{"'single element'"});
    splitAndUnEscapeTestCase("yyyy-MM-dd'T'HH:mm:ss,yyyy-MM-dd'T'HH:mm:ss.S",new String[]{"yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.S"});
    splitAndUnEscapeTestCase("single\\,element",new String[]{"single,element"});
    splitAndUnEscapeTestCase("element\\,one\\\\,element\\\\two\\\\\\,",new String[]{"element,one\\","element\\two\\,"});
  }
  public void splitAndUnEscapeTestCase(  String testValue,  String[] expectedResults) throws Exception {
    String[] testResults=HiveStringUtils.splitAndUnEscape(testValue);
    assertTrue(Arrays.toString(expectedResults) + " == " + Arrays.toString(testResults),Arrays.equals(expectedResults,testResults));
  }
}
