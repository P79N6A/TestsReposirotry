public class TestSemanticAnalyzerFactory {
  private QueryState queryState;
  private HiveConf conf;
  @Before public void setup() throws Exception {
    queryState=new QueryState(null);
    conf=queryState.getConf();
  }
  @Test public void testCreate() throws Exception {
    BaseSemanticAnalyzer analyzer=SemanticAnalyzerFactory.get(queryState,new ASTNode(new CommonToken(HiveParser.TOK_CREATEMACRO)));
    Assert.assertTrue(analyzer.getClass().getSimpleName(),analyzer instanceof MacroSemanticAnalyzer);
  }
  @Test public void testDrop() throws Exception {
    BaseSemanticAnalyzer analyzer=SemanticAnalyzerFactory.get(queryState,new ASTNode(new CommonToken(HiveParser.TOK_DROPMACRO)));
    Assert.assertTrue(analyzer.getClass().getSimpleName(),analyzer instanceof MacroSemanticAnalyzer);
  }
}
