public class TestMiniHiveKdc {
  private static File baseDir;
  private MiniHiveKdc miniHiveKdc;
  private HiveConf hiveConf;
  @BeforeClass public static void beforeTest() throws Exception {
    baseDir=Files.createTempDir();
    baseDir.deleteOnExit();
  }
  @Before public void setUp() throws Exception {
    hiveConf=new HiveConf();
    miniHiveKdc=MiniHiveKdc.getMiniHiveKdc(hiveConf);
  }
  @After public void tearDown() throws Exception {
    miniHiveKdc.shutDown();
  }
  @Test public void testLogin() throws Exception {
    String servicePrinc=miniHiveKdc.getHiveServicePrincipal();
    assertNotNull(servicePrinc);
    miniHiveKdc.loginUser(servicePrinc);
    assertTrue(UserGroupInformation.isLoginKeytabBased());
    UserGroupInformation ugi=Utils.getUGI();
    assertEquals(MiniHiveKdc.HIVE_SERVICE_PRINCIPAL,ugi.getShortUserName());
  }
  @AfterClass public static void afterTest() throws Exception {
  }
}
