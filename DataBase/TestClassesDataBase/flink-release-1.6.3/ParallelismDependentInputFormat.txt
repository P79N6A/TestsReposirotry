private static class ParallelismDependentInputFormat extends GenericInputFormat<Integer> {
  private transient boolean emitted;
  @Override public GenericInputSplit[] createInputSplits(  int numSplits) throws IOException {
    assertEquals(PARALLELISM,numSplits);
    return super.createInputSplits(numSplits);
  }
  @Override public boolean reachedEnd(){
    return emitted;
  }
  @Override public Integer nextRecord(  Integer reuse){
    if (emitted) {
      return null;
    }
    emitted=true;
    return 1;
  }
}
