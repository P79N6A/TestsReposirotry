private static class KeyedStateSettingFlatMap extends RichFlatMapFunction<Tuple2<Long,Long>,Tuple2<Long,Long>> {
  private static final long serialVersionUID=1L;
  private final ValueStateDescriptor<Long> stateDescriptor=new ValueStateDescriptor<Long>("state-name",LongSerializer.INSTANCE);
  @Override public void flatMap(  Tuple2<Long,Long> value,  Collector<Tuple2<Long,Long>> out) throws Exception {
    out.collect(value);
    getRuntimeContext().getState(stateDescriptor).update(value.f1);
  }
}
