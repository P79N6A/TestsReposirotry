public static final class CountingOutputCollector<OUT> implements Collector<OUT> {
  private int num;
  @Override public void collect(  OUT record){
    this.num++;
  }
  @Override public void close(){
  }
  public int getNumberOfRecords(){
    return this.num;
  }
}
