private static class CheckpointedUdfOperator extends AbstractUdfStreamOperator<Tuple2<Long,Long>,FlatMapFunction<Tuple2<Long,Long>,Tuple2<Long,Long>>> implements OneInputStreamOperator<Tuple2<Long,Long>,Tuple2<Long,Long>> {
  private static final long serialVersionUID=1L;
  private static final String CHECKPOINTED_STRING="Oh my, that's nice!";
  public CheckpointedUdfOperator(  FlatMapFunction<Tuple2<Long,Long>,Tuple2<Long,Long>> userFunction){
    super(userFunction);
  }
  @Override public void processElement(  StreamRecord<Tuple2<Long,Long>> element) throws Exception {
    userFunction.flatMap(element.getValue(),new TimestampedCollector<>(output));
  }
  @Override public void processWatermark(  Watermark mark) throws Exception {
    output.emitWatermark(mark);
  }
}
