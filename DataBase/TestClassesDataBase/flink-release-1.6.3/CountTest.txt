/** 
 * Tests for  {@link Count}.
 */
public class CountTest {
  private ExecutionEnvironment env;
  @Before public void setup() throws Exception {
    env=ExecutionEnvironment.createCollectionsEnvironment();
    env.getConfig().enableObjectReuse();
  }
  @Test public void testList() throws Exception {
    List<Long> list=Arrays.asList(ArrayUtils.toObject(new long[]{0,1,2,3,4,5,6,7,8,9}));
    DataSet<Long> dataset=env.fromCollection(list);
    long count=new Count<Long>().run(dataset).execute();
    assertEquals(list.size(),count);
  }
  @Test public void testEmptyList() throws Exception {
    DataSet<Long> dataset=env.fromCollection(Collections.emptyList(),Types.LONG);
    long count=new Count<Long>().run(dataset).execute();
    assertEquals(0,count);
  }
}
