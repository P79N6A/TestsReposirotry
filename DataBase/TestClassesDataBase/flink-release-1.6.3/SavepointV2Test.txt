public class SavepointV2Test {
  /** 
 * Simple test of savepoint methods.
 */
  @Test public void testSavepointV2() throws Exception {
    final Random rnd=new Random();
    final long checkpointId=rnd.nextInt(Integer.MAX_VALUE) + 1;
    final int numTaskStates=4;
    final int numSubtaskStates=16;
    final int numMasterStates=7;
    Collection<OperatorState> taskStates=CheckpointTestUtils.createOperatorStates(rnd,numTaskStates,numSubtaskStates);
    Collection<MasterState> masterStates=CheckpointTestUtils.createRandomMasterStates(rnd,numMasterStates);
    SavepointV2 checkpoint=new SavepointV2(checkpointId,taskStates,masterStates);
    assertEquals(2,checkpoint.getVersion());
    assertEquals(checkpointId,checkpoint.getCheckpointId());
    assertEquals(taskStates,checkpoint.getOperatorStates());
    assertEquals(masterStates,checkpoint.getMasterStates());
    assertFalse(checkpoint.getOperatorStates().isEmpty());
    assertFalse(checkpoint.getMasterStates().isEmpty());
    checkpoint.dispose();
    assertTrue(checkpoint.getOperatorStates().isEmpty());
    assertTrue(checkpoint.getMasterStates().isEmpty());
  }
}
