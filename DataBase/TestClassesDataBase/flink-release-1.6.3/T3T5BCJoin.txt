private static class T3T5BCJoin extends RichFlatJoinFunction<Tuple3<Integer,Long,String>,Tuple5<Integer,Long,Integer,String,Long>,Tuple3<String,String,Integer>> {
  private int broadcast;
  @Override public void open(  Configuration config){
    Collection<Integer> ints=this.getRuntimeContext().getBroadcastVariable("ints");
    int sum=0;
    for (    Integer i : ints) {
      sum+=i;
    }
    broadcast=sum;
  }
  @Override public void join(  Tuple3<Integer,Long,String> first,  Tuple5<Integer,Long,Integer,String,Long> second,  Collector<Tuple3<String,String,Integer>> out) throws Exception {
    out.collect(new Tuple3<String,String,Integer>(first.f2,second.f3,broadcast));
  }
}
