private static class TestOpenCloseFilterFunction extends RichFilterFunction<String> {
  private static final long serialVersionUID=1L;
  public static boolean openCalled=false;
  public static boolean closeCalled=false;
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    if (closeCalled) {
      Assert.fail("Close called before open.");
    }
    openCalled=true;
  }
  @Override public void close() throws Exception {
    super.close();
    if (!openCalled) {
      Assert.fail("Open was not called before close.");
    }
    closeCalled=true;
  }
  @Override public boolean filter(  String value) throws Exception {
    if (!openCalled) {
      Assert.fail("Open was not called before run.");
    }
    return value.startsWith("foo");
  }
}
