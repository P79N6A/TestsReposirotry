private static class OpenCloseTestSource extends RichSourceFunction<String> {
  private static final long serialVersionUID=1L;
  public static boolean openCalled=false;
  public static boolean closeCalled=false;
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    if (closeCalled) {
      Assert.fail("Close called before open.");
    }
    openCalled=true;
  }
  @Override public void close() throws Exception {
    super.close();
    if (!openCalled) {
      Assert.fail("Open was not called before close.");
    }
    closeCalled=true;
  }
  @Override public void run(  SourceContext<String> ctx) throws Exception {
    if (!openCalled) {
      Assert.fail("Open was not called before run.");
    }
    for (int i=0; i < 10; i++) {
      ctx.collect("Hello" + i);
    }
  }
  @Override public void cancel(){
  }
}
