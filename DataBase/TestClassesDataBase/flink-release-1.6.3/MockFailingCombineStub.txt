public static final class MockFailingCombineStub implements GroupReduceFunction<Record,Record>, GroupCombineFunction<Record,Record> {
  private static final long serialVersionUID=1L;
  private int cnt=0;
  @Override public void reduce(  Iterable<Record> records,  Collector<Record> out) throws Exception {
    if (++this.cnt >= 5) {
      throw new RuntimeException("Expected Test Exception");
    }
    for (    Record r : records) {
      out.collect(r);
    }
  }
  @Override public void combine(  Iterable<Record> values,  Collector<Record> out) throws Exception {
    reduce(values,out);
  }
}
