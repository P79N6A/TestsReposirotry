public static class CancelSequenceActorGateway extends BaseTestingActorGateway {
  private final int successfulOperations;
  private int index=-1;
  public CancelSequenceActorGateway(  ExecutionContext executionContext,  int successfulOperations){
    super(executionContext);
    this.successfulOperations=successfulOperations;
  }
  @Override public Object handleMessage(  Object message) throws Exception {
    Object result;
    if (message instanceof SubmitTask) {
      result=Acknowledge.get();
    }
 else     if (message instanceof CancelTask) {
      index++;
      if (index >= successfulOperations) {
        throw new IOException("RPC call failed.");
      }
 else {
        result=Acknowledge.get();
      }
    }
 else {
      result=null;
    }
    return result;
  }
}
