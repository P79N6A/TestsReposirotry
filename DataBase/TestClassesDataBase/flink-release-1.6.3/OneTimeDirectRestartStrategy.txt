private static final class OneTimeDirectRestartStrategy implements RestartStrategy {
  private boolean hasRestarted=false;
  @Override public boolean canRestart(){
    return !hasRestarted;
  }
  @Override public void restart(  RestartCallback restarter,  ScheduledExecutor executor){
    hasRestarted=true;
    restarter.triggerFullRecovery();
  }
}
