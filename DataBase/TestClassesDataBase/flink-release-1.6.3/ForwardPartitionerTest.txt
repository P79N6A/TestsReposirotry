/** 
 * Tests for  {@link ForwardPartitioner}.
 */
public class ForwardPartitionerTest {
  private ForwardPartitioner<Tuple> forwardPartitioner;
  private StreamRecord<Tuple> streamRecord=new StreamRecord<Tuple>(null);
  private SerializationDelegate<StreamRecord<Tuple>> sd=new SerializationDelegate<StreamRecord<Tuple>>(null);
  @Before public void setPartitioner(){
    forwardPartitioner=new ForwardPartitioner<Tuple>();
  }
  @Test public void testSelectChannelsLength(){
    sd.setInstance(streamRecord);
    assertEquals(1,forwardPartitioner.selectChannels(sd,1).length);
    assertEquals(1,forwardPartitioner.selectChannels(sd,2).length);
    assertEquals(1,forwardPartitioner.selectChannels(sd,1024).length);
  }
  @Test public void testSelectChannelsInterval(){
    sd.setInstance(streamRecord);
    assertEquals(0,forwardPartitioner.selectChannels(sd,1)[0]);
    assertEquals(0,forwardPartitioner.selectChannels(sd,2)[0]);
    assertEquals(0,forwardPartitioner.selectChannels(sd,1024)[0]);
  }
}
