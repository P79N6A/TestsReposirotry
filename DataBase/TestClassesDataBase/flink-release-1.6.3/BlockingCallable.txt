static class BlockingCallable implements Callable<SnapshotResult<OperatorStateHandle>> {
  @Override public SnapshotResult<OperatorStateHandle> call() throws Exception {
    CHECKPOINTING_LATCH.trigger();
    CLEANUP_LATCH.await();
    throw new FlinkException("Checkpointing operation failed");
  }
}
