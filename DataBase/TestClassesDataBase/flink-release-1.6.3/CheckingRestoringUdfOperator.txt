private static class CheckingRestoringUdfOperator extends AbstractUdfStreamOperator<Tuple2<Long,Long>,FlatMapFunction<Tuple2<Long,Long>,Tuple2<Long,Long>>> implements OneInputStreamOperator<Tuple2<Long,Long>,Tuple2<Long,Long>> {
  private static final long serialVersionUID=1L;
  public static final String SUCCESSFUL_RESTORE_CHECK_ACCUMULATOR=CheckingRestoringUdfOperator.class + "_RESTORE_CHECK";
  private String restoredState;
  public CheckingRestoringUdfOperator(  FlatMapFunction<Tuple2<Long,Long>,Tuple2<Long,Long>> userFunction){
    super(userFunction);
  }
  @Override public void open() throws Exception {
    super.open();
    getRuntimeContext().addAccumulator(SUCCESSFUL_RESTORE_CHECK_ACCUMULATOR,new IntCounter());
  }
  @Override public void processElement(  StreamRecord<Tuple2<Long,Long>> element) throws Exception {
    userFunction.flatMap(element.getValue(),new TimestampedCollector<>(output));
    getRuntimeContext().getAccumulator(SUCCESSFUL_RESTORE_CHECK_ACCUMULATOR).add(1);
  }
  @Override public void processWatermark(  Watermark mark) throws Exception {
    output.emitWatermark(mark);
  }
}
