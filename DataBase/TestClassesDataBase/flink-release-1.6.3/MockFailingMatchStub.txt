public static final class MockFailingMatchStub implements FlatJoinFunction<Record,Record,Record> {
  private static final long serialVersionUID=1L;
  private int cnt=0;
  @Override public void join(  Record record1,  Record record2,  Collector<Record> out) throws Exception {
    if (++this.cnt >= 10) {
      throw new ExpectedTestException();
    }
    out.collect(record1);
  }
}
