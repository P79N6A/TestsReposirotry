private static class StaticForwardFactory implements StreamFactory {
  static CheckpointStreamFactory factory;
  StaticForwardFactory(  CheckpointStreamFactory factory){
    StaticForwardFactory.factory=factory;
  }
  @Override public CheckpointStateOutputStream get() throws IOException {
    return factory.createCheckpointStateOutputStream(CheckpointedStateScope.EXCLUSIVE);
  }
}
