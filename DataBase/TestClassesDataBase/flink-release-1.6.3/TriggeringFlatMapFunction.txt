private static class TriggeringFlatMapFunction extends ProcessFunction<Integer,Integer> {
  private static final long serialVersionUID=1L;
  private final TimeDomain timeDomain;
  public TriggeringFlatMapFunction(  TimeDomain timeDomain){
    this.timeDomain=timeDomain;
  }
  @Override public void processElement(  Integer value,  Context ctx,  Collector<Integer> out) throws Exception {
    out.collect(value);
    if (timeDomain.equals(TimeDomain.EVENT_TIME)) {
      ctx.timerService().registerEventTimeTimer(ctx.timerService().currentWatermark() + 5);
    }
 else {
      ctx.timerService().registerProcessingTimeTimer(ctx.timerService().currentProcessingTime() + 5);
    }
  }
  @Override public void onTimer(  long timestamp,  OnTimerContext ctx,  Collector<Integer> out) throws Exception {
    assertEquals(this.timeDomain,ctx.timeDomain());
    out.collect(1777);
  }
}
