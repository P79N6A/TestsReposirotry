private class KeyedCombReducer implements CombineFunction<Tuple3<String,Integer,Boolean>,Tuple3<String,Integer,Boolean>>, GroupReduceFunction<Tuple3<String,Integer,Boolean>,Tuple3<String,Integer,Boolean>> {
  @Override public Tuple3<String,Integer,Boolean> combine(  Iterable<Tuple3<String,Integer,Boolean>> values) throws Exception {
    String key=null;
    int sum=0;
    boolean flag=true;
    for (    Tuple3<String,Integer,Boolean> tuple : values) {
      key=(key == null) ? tuple.f0 : key;
      sum+=tuple.f1;
      flag&=!tuple.f2;
    }
    return new Tuple3<>(key,sum,flag);
  }
  @Override public void reduce(  Iterable<Tuple3<String,Integer,Boolean>> values,  Collector<Tuple3<String,Integer,Boolean>> out) throws Exception {
    String key=null;
    int sum=0;
    boolean flag=true;
    for (    Tuple3<String,Integer,Boolean> tuple : values) {
      key=(key == null) ? tuple.f0 : key;
      sum+=tuple.f1;
      flag&=tuple.f2;
    }
    out.collect(new Tuple3<>(key,sum,flag));
  }
}
