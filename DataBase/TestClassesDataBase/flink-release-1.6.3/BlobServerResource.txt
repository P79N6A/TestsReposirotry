/** 
 * A simple  {@link ExternalResource} to be used by tests that require a {@link BlobServer}.
 */
public class BlobServerResource extends ExternalResource {
  private static final Logger LOG=LoggerFactory.getLogger(BlobServerResource.class);
  private final TemporaryFolder temporaryFolder=new TemporaryFolder();
  private BlobServer blobServer;
  protected void before() throws Throwable {
    temporaryFolder.create();
    Configuration config=new Configuration();
    config.setString(BlobServerOptions.STORAGE_DIRECTORY,temporaryFolder.newFolder().getAbsolutePath());
    blobServer=new BlobServer(config,new VoidBlobStore());
    blobServer.start();
  }
  protected void after(){
    temporaryFolder.delete();
    try {
      blobServer.close();
    }
 catch (    IOException e) {
      LOG.error("Exception while shutting down blob server.",e);
    }
  }
  public int getBlobServerPort(){
    return blobServer.getPort();
  }
}
