private static class AsyncCheckpointOperator extends AbstractStreamOperator<String> implements OneInputStreamOperator<String,String> {
  @Override public void open() throws Exception {
    super.open();
    ValueState<String> state=getPartitionedState(VoidNamespace.INSTANCE,VoidNamespaceSerializer.INSTANCE,new ValueStateDescriptor<>("count",StringSerializer.INSTANCE));
  }
  @Override public void processElement(  StreamRecord<String> element) throws Exception {
    ValueState<String> state=getPartitionedState(VoidNamespace.INSTANCE,VoidNamespaceSerializer.INSTANCE,new ValueStateDescriptor<>("count",StringSerializer.INSTANCE));
    state.update(element.getValue());
  }
}
