/** 
 * Test that mesos config are extracted correctly from the configuration.
 */
public class LaunchableMesosWorkerTest extends TestLogger {
  @Test public void canGetPortKeys(){
    Set<String> additionalPorts=new HashSet<>(Arrays.asList("someport.here","anotherport"));
    Configuration config=new Configuration();
    config.setString(PORT_ASSIGNMENTS,String.join(",",additionalPorts));
    Set<String> portKeys=LaunchableMesosWorker.extractPortKeys(config);
    Set<String> expectedPorts=new HashSet<>(LaunchableMesosWorker.TM_PORT_KEYS);
    expectedPorts.addAll(additionalPorts);
    assertThat(portKeys,is(equalTo(expectedPorts)));
  }
  @Test public void canGetNoPortKeys(){
    Configuration config=new Configuration();
    Set<String> portKeys=LaunchableMesosWorker.extractPortKeys(config);
    assertThat(portKeys,is(equalTo(LaunchableMesosWorker.TM_PORT_KEYS)));
  }
}
