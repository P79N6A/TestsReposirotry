/** 
 * Allows the tests to use  {@link ExecutionEnvironment#getExecutionEnvironment()} but with aconfiguration that limits the maximum memory used for network buffers since the current defaults are too high for Travis-CI.
 */
private abstract static class LimitNetworkBuffersTestEnvironment extends ExecutionEnvironment {
  public static void setAsContext(){
    Configuration config=new Configuration();
    config.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MAX,String.valueOf(80L << 20));
    final LocalEnvironment le=new LocalEnvironment(config);
    initializeContextEnvironment(new ExecutionEnvironmentFactory(){
      @Override public ExecutionEnvironment createExecutionEnvironment(){
        return le;
      }
    }
);
  }
  public static void unsetAsContext(){
    resetContextEnvironment();
  }
}
