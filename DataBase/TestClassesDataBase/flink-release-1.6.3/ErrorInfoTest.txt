/** 
 * Simple test for the  {@link ErrorInfo}.
 */
public class ErrorInfoTest {
  @Test public void testSerializationWithExceptionOutsideClassLoader() throws Exception {
    final ErrorInfo error=new ErrorInfo(new ExceptionWithCustomClassLoader(),System.currentTimeMillis());
    final ErrorInfo copy=CommonTestUtils.createCopySerializable(error);
    assertEquals(error.getTimestamp(),copy.getTimestamp());
    assertEquals(error.getExceptionAsString(),copy.getExceptionAsString());
    assertEquals(error.getException().getMessage(),copy.getException().getMessage());
  }
private static final class ExceptionWithCustomClassLoader extends Exception {
    private static final long serialVersionUID=42L;
    private static final ClassLoader CUSTOM_LOADER=new URLClassLoader(new URL[0]);
    @SuppressWarnings("unused") private final Serializable outOfClassLoader=CommonTestUtils.createObjectForClassNotInClassPath(CUSTOM_LOADER);
    public ExceptionWithCustomClassLoader(){
      super("tada");
    }
  }
}
