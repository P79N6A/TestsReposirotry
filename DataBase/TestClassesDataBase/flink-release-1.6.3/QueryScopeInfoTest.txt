/** 
 * Tests for the  {@link QueryScopeInfo} classes.
 */
public class QueryScopeInfoTest {
  @Test public void testJobManagerQueryScopeInfo(){
    QueryScopeInfo.JobManagerQueryScopeInfo info=new QueryScopeInfo.JobManagerQueryScopeInfo();
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JM,info.getCategory());
    assertEquals("",info.scope);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JM,info.getCategory());
    assertEquals("world",info.scope);
    info=new QueryScopeInfo.JobManagerQueryScopeInfo("hello");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JM,info.getCategory());
    assertEquals("hello",info.scope);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JM,info.getCategory());
    assertEquals("hello.world",info.scope);
  }
  @Test public void testTaskManagerQueryScopeInfo(){
    QueryScopeInfo.TaskManagerQueryScopeInfo info=new QueryScopeInfo.TaskManagerQueryScopeInfo("tmid");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TM,info.getCategory());
    assertEquals("",info.scope);
    assertEquals("tmid",info.taskManagerID);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TM,info.getCategory());
    assertEquals("world",info.scope);
    assertEquals("tmid",info.taskManagerID);
    info=new QueryScopeInfo.TaskManagerQueryScopeInfo("tmid","hello");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TM,info.getCategory());
    assertEquals("hello",info.scope);
    assertEquals("tmid",info.taskManagerID);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TM,info.getCategory());
    assertEquals("hello.world",info.scope);
    assertEquals("tmid",info.taskManagerID);
  }
  @Test public void testJobQueryScopeInfo(){
    QueryScopeInfo.JobQueryScopeInfo info=new QueryScopeInfo.JobQueryScopeInfo("jobid");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JOB,info.getCategory());
    assertEquals("",info.scope);
    assertEquals("jobid",info.jobID);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JOB,info.getCategory());
    assertEquals("world",info.scope);
    assertEquals("jobid",info.jobID);
    info=new QueryScopeInfo.JobQueryScopeInfo("jobid","hello");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JOB,info.getCategory());
    assertEquals("hello",info.scope);
    assertEquals("jobid",info.jobID);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_JOB,info.getCategory());
    assertEquals("hello.world",info.scope);
    assertEquals("jobid",info.jobID);
  }
  @Test public void testTaskQueryScopeInfo(){
    QueryScopeInfo.TaskQueryScopeInfo info=new QueryScopeInfo.TaskQueryScopeInfo("jobid","taskid",2);
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TASK,info.getCategory());
    assertEquals("",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals(2,info.subtaskIndex);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TASK,info.getCategory());
    assertEquals("world",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals(2,info.subtaskIndex);
    info=new QueryScopeInfo.TaskQueryScopeInfo("jobid","taskid",2,"hello");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TASK,info.getCategory());
    assertEquals("hello",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals(2,info.subtaskIndex);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_TASK,info.getCategory());
    assertEquals("hello.world",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals(2,info.subtaskIndex);
  }
  @Test public void testOperatorQueryScopeInfo(){
    QueryScopeInfo.OperatorQueryScopeInfo info=new QueryScopeInfo.OperatorQueryScopeInfo("jobid","taskid",2,"opname");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_OPERATOR,info.getCategory());
    assertEquals("",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals("opname",info.operatorName);
    assertEquals(2,info.subtaskIndex);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_OPERATOR,info.getCategory());
    assertEquals("world",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals("opname",info.operatorName);
    assertEquals(2,info.subtaskIndex);
    info=new QueryScopeInfo.OperatorQueryScopeInfo("jobid","taskid",2,"opname","hello");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_OPERATOR,info.getCategory());
    assertEquals("hello",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals("opname",info.operatorName);
    assertEquals(2,info.subtaskIndex);
    info=info.copy("world");
    assertEquals(QueryScopeInfo.INFO_CATEGORY_OPERATOR,info.getCategory());
    assertEquals("hello.world",info.scope);
    assertEquals("jobid",info.jobID);
    assertEquals("taskid",info.vertexID);
    assertEquals("opname",info.operatorName);
    assertEquals(2,info.subtaskIndex);
  }
}
