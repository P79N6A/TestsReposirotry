private static class ValidatingOperator extends AbstractStreamOperator<String> implements OneInputStreamOperator<String,String> {
  private static final long serialVersionUID=1L;
  static final long CHECKPOINT_ID=5765167L;
  final AtomicInteger toUpdate;
  final int expected;
  public ValidatingOperator(  AtomicInteger toUpdate,  int expected){
    this.toUpdate=toUpdate;
    this.expected=expected;
  }
  @Override public void prepareSnapshotPreBarrier(  long checkpointId) throws Exception {
    assertEquals("wrong checkpointId",CHECKPOINT_ID,checkpointId);
    assertEquals("wrong order",expected,toUpdate.getAndIncrement());
  }
  @Override public void processElement(  StreamRecord<String> element) throws Exception {
    throw new UnsupportedOperationException();
  }
  @Override public OperatorID getOperatorID(){
    return new OperatorID();
  }
}
