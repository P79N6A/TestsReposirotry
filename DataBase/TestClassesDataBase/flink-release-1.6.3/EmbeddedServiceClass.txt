private static final class EmbeddedServiceClass implements ServiceClass {
  private EmbeddedLeaderService embeddedLeaderService;
  @Override public void setup(){
    embeddedLeaderService=new EmbeddedLeaderService(TestingUtils.defaultExecutionContext());
  }
  @Override public void teardown(){
    if (embeddedLeaderService != null) {
      embeddedLeaderService.shutdown();
      embeddedLeaderService=null;
    }
  }
  @Override public LeaderElectionService createLeaderElectionService() throws Exception {
    return embeddedLeaderService.createLeaderElectionService();
  }
}
