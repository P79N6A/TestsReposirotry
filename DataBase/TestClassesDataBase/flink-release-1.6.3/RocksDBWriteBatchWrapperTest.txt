/** 
 * Tests to guard  {@link RocksDBWriteBatchWrapper}.
 */
public class RocksDBWriteBatchWrapperTest {
  @Rule public TemporaryFolder folder=new TemporaryFolder();
  @Test public void basicTest() throws Exception {
    List<Tuple2<byte[],byte[]>> data=new ArrayList<>(10000);
    for (int i=0; i < 10000; ++i) {
      data.add(new Tuple2<>(("key:" + i).getBytes(),("value:" + i).getBytes()));
    }
    try (RocksDB db=RocksDB.open(folder.newFolder().getAbsolutePath());WriteOptions options=new WriteOptions().setDisableWAL(true);ColumnFamilyHandle handle=db.createColumnFamily(new ColumnFamilyDescriptor("test".getBytes()));RocksDBWriteBatchWrapper writeBatchWrapper=new RocksDBWriteBatchWrapper(db,options,200)){
      for (      Tuple2<byte[],byte[]> item : data) {
        writeBatchWrapper.put(handle,item.f0,item.f1);
      }
      writeBatchWrapper.flush();
      for (      Tuple2<byte[],byte[]> item : data) {
        Assert.assertArrayEquals(item.f1,db.get(handle,item.f0));
      }
    }
   }
}
