/** 
 * Simple recording client.
 */
private static class RecordingTestClient extends UntypedActor {
  private final Queue<Object> messages=new ConcurrentLinkedQueue<>();
  private CountDownLatch jobResultLatch=new CountDownLatch(1);
  @Override public void onReceive(  Object message) throws Exception {
    if (message instanceof LeaderSessionMessage) {
      message=((LeaderSessionMessage)message).message();
    }
    messages.add(message);
    if (message instanceof JobManagerMessages.JobResultFailure || message instanceof JobManagerMessages.JobResultSuccess) {
      jobResultLatch.countDown();
    }
  }
  public Queue<Object> getMessages(){
    return messages;
  }
  public void awaitJobResult(  long timeout) throws InterruptedException {
    jobResultLatch.await(timeout,TimeUnit.MILLISECONDS);
  }
}
