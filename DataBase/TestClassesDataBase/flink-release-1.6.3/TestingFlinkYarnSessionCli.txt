private static class TestingFlinkYarnSessionCli extends FlinkYarnSessionCli {
  @SuppressWarnings("unchecked") private final ClusterClient<ApplicationId> clusterClient;
  private final String configurationDirectory;
  private TestingFlinkYarnSessionCli(  Configuration configuration,  String configurationDirectory,  String shortPrefix,  String longPrefix) throws Exception {
    super(configuration,configurationDirectory,shortPrefix,longPrefix);
    this.clusterClient=new FakeClusterClient(configuration);
    this.configurationDirectory=configurationDirectory;
  }
  @Override public AbstractYarnClusterDescriptor createClusterDescriptor(  CommandLine commandLine) throws FlinkException {
    AbstractYarnClusterDescriptor parent=super.createClusterDescriptor(commandLine);
    return new NonDeployingDetachedYarnClusterDescriptor(parent.getFlinkConfiguration(),(YarnConfiguration)parent.getYarnClient().getConfig(),configurationDirectory,parent.getYarnClient(),clusterClient);
  }
}
