/** 
 * This doesn't do much but we use it to verify that translation of non-keyed broadcast connect works.
 */
private static class TestBroadcastProcessFunction extends BroadcastProcessFunction<Long,String,String> {
  private static final long serialVersionUID=7616910653561100842L;
  private transient MapStateDescriptor<Long,String> descriptor;
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    descriptor=new MapStateDescriptor<>("broadcast-state",BasicTypeInfo.LONG_TYPE_INFO,BasicTypeInfo.STRING_TYPE_INFO);
  }
  @Override public void processElement(  Long value,  ReadOnlyContext ctx,  Collector<String> out) throws Exception {
  }
  @Override public void processBroadcastElement(  String value,  Context ctx,  Collector<String> out) throws Exception {
    long key=Long.parseLong(value.split(":")[1]);
    ctx.getBroadcastState(descriptor).put(key,value);
  }
}
