@SuppressWarnings("serial") private static final class VertexUpdateDirection extends GatherFunction<Long,HashSet<Long>,Long> {
  @Override public void updateVertex(  Vertex<Long,HashSet<Long>> vertex,  MessageIterator<Long> messages) throws Exception {
    vertex.getValue().clear();
    for (    long msg : messages) {
      vertex.getValue().add(msg);
    }
    setNewVertexValue(vertex.getValue());
  }
}
