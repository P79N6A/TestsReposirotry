private static class PickOneAllReduce extends RichGroupReduceFunction<Integer,Integer> {
  private Integer bcValue;
  @Override public void open(  Configuration parameters){
    this.bcValue=getRuntimeContext().getBroadcastVariableWithInitializer("bc",new PickFirstInitializer());
  }
  @Override public void reduce(  Iterable<Integer> records,  Collector<Integer> out){
    if (bcValue == null) {
      return;
    }
    final int x=bcValue;
    for (    Integer y : records) {
      if (y > x) {
        out.collect(y);
        return;
      }
    }
    out.collect(bcValue);
  }
}
