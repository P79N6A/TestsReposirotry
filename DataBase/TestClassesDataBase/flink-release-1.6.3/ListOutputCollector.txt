private static final class ListOutputCollector<OUT> implements Collector<OUT> {
  private final List<OUT> output;
  private final TypeSerializer<OUT> serializer;
  public ListOutputCollector(  List<OUT> outputList,  TypeSerializer<OUT> serializer){
    this.output=outputList;
    this.serializer=serializer;
  }
  @Override public void collect(  OUT record){
    this.output.add(serializer.copy(record));
  }
  @Override public void close(){
  }
}
