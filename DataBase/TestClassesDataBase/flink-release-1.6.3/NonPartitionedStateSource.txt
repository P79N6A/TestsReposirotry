private static class NonPartitionedStateSource extends StateSourceBase implements ListCheckpointed<Integer> {
  private static final long serialVersionUID=-8108185918123186841L;
  @Override public List<Integer> snapshotState(  long checkpointId,  long timestamp) throws Exception {
    return Collections.singletonList(this.counter);
  }
  @Override public void restoreState(  List<Integer> state) throws Exception {
    if (!state.isEmpty()) {
      this.counter=state.get(0);
    }
  }
}
