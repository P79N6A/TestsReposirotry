@SuppressWarnings("unchecked") public class KryoWithCustomSerializersTest extends AbstractGenericTypeSerializerTest {
  @Test public void testJodaTime(){
    Collection<LocalDate> b=new HashSet<LocalDate>();
    b.add(new LocalDate(1L));
    b.add(new LocalDate(2L));
    runTests(b);
  }
  @Override protected <T>TypeSerializer<T> createSerializer(  Class<T> type){
    ExecutionConfig conf=new ExecutionConfig();
    conf.registerTypeWithKryoSerializer(LocalDate.class,LocalDateSerializer.class);
    TypeInformation<T> typeInfo=new GenericTypeInfo<T>(type);
    return typeInfo.createSerializer(conf);
  }
public static final class LocalDateSerializer extends Serializer<LocalDate> implements java.io.Serializable {
    private static final long serialVersionUID=1L;
    @Override public void write(    Kryo kryo,    Output output,    LocalDate object){
      output.writeInt(object.getYear());
      output.writeInt(object.getMonthOfYear());
      output.writeInt(object.getDayOfMonth());
    }
    @Override public LocalDate read(    Kryo kryo,    Input input,    Class<LocalDate> type){
      return new LocalDate(input.readInt(),input.readInt(),input.readInt());
    }
  }
}
