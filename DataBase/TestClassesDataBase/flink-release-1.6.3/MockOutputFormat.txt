public static class MockOutputFormat extends FileOutputFormat<Record> {
  private static final long serialVersionUID=1L;
  final StringBuilder bld=new StringBuilder();
  @Override public void configure(  Configuration parameters){
    super.configure(parameters);
  }
  @Override public void writeRecord(  Record rec) throws IOException {
    IntValue key=rec.getField(0,IntValue.class);
    IntValue value=rec.getField(1,IntValue.class);
    this.bld.setLength(0);
    this.bld.append(key.getValue());
    this.bld.append('_');
    this.bld.append(value.getValue());
    this.bld.append('\n');
    byte[] bytes=this.bld.toString().getBytes(ConfigConstants.DEFAULT_CHARSET);
    this.stream.write(bytes);
  }
}
