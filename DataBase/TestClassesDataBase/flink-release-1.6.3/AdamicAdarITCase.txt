/** 
 * Tests for  {@link AdamicAdar}.
 */
@RunWith(Parameterized.class) public class AdamicAdarITCase extends CopyableValueDriverBaseITCase {
  public AdamicAdarITCase(  String idType,  TestExecutionMode mode){
    super(idType,mode);
  }
  private String[] parameters(  int scale,  String output,  String... additionalParameters){
    String[] parameters=new String[]{"--algorithm","AdamicAdar","--mirror_results","--input","RMatGraph","--scale",Integer.toString(scale),"--type",idType,"--simplify","undirected","--output",output};
    return ArrayUtils.addAll(parameters,additionalParameters);
  }
  @Test public void testLongDescription() throws Exception {
    String expected=regexSubstring(new AdamicAdar().getLongDescription());
    expectedOutputFromException(new String[]{"--algorithm","AdamicAdar"},expected,ProgramParametrizationException.class);
  }
  @Test public void testPrintWithRMatGraph() throws Exception {
    Assume.assumeFalse(idType.equals("char") || idType.equals("nativeChar"));
    expectedCount(parameters(8,"print"),39276);
  }
  @Test public void testParallelism() throws Exception {
    TestUtils.verifyParallelism(parameters(8,"print"),"FlatMap \\(Mirror results\\)","GroupReduce \\(Compute scores\\)","GroupReduce \\(Generate group pairs\\)");
  }
}
