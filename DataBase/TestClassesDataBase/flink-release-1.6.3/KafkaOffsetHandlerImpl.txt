private class KafkaOffsetHandlerImpl implements KafkaOffsetHandler {
  private final KafkaConsumer<byte[],byte[]> offsetClient;
  public KafkaOffsetHandlerImpl(){
    Properties props=new Properties();
    props.putAll(standardProps);
    props.setProperty("key.deserializer","org.apache.kafka.common.serialization.ByteArrayDeserializer");
    props.setProperty("value.deserializer","org.apache.kafka.common.serialization.ByteArrayDeserializer");
    offsetClient=new KafkaConsumer<>(props);
  }
  @Override public Long getCommittedOffset(  String topicName,  int partition){
    OffsetAndMetadata committed=offsetClient.committed(new TopicPartition(topicName,partition));
    return (committed != null) ? committed.offset() : null;
  }
  @Override public void setCommittedOffset(  String topicName,  int partition,  long offset){
    Map<TopicPartition,OffsetAndMetadata> partitionAndOffset=new HashMap<>();
    partitionAndOffset.put(new TopicPartition(topicName,partition),new OffsetAndMetadata(offset));
    offsetClient.commitSync(partitionAndOffset);
  }
  @Override public void close(){
    offsetClient.close();
  }
}
