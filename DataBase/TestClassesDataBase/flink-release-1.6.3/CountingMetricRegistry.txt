private static class CountingMetricRegistry extends MetricRegistryImpl {
  private int counter=0;
  CountingMetricRegistry(  Configuration config){
    super(MetricRegistryConfiguration.fromConfiguration(config));
  }
  @Override public void register(  Metric metric,  String metricName,  AbstractMetricGroup group){
    super.register(metric,metricName,group);
    counter++;
  }
  @Override public void unregister(  Metric metric,  String metricName,  AbstractMetricGroup group){
    super.unregister(metric,metricName,group);
    counter--;
  }
  int getNumberRegisteredMetrics(){
    return counter;
  }
}
