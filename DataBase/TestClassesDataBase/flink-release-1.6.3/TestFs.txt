private static class TestFs extends LocalFileSystem {
  private final FunctionWithException<Path,FSDataOutputStream,IOException> streamFactory;
  TestFs(  FunctionWithException<Path,FSDataOutputStream,IOException> streamFactory){
    this.streamFactory=streamFactory;
  }
  @Override public FSDataOutputStream create(  Path filePath,  WriteMode overwrite) throws IOException {
    return streamFactory.apply(filePath);
  }
}
