private static final class MyDecoratedInputFormat extends FileInputFormat<byte[]> {
  private static final long serialVersionUID=1L;
  @Override public boolean reachedEnd() throws IOException {
    return this.stream.getPos() >= this.splitStart + this.splitLength;
  }
  @Override public byte[] nextRecord(  byte[] reuse) throws IOException {
    int read=this.stream.read();
    if (read == -1)     throw new IllegalStateException();
    return new byte[]{(byte)read};
  }
  @Override protected FSDataInputStream decorateInputStream(  FSDataInputStream inputStream,  FileInputSplit fileSplit) throws Throwable {
    inputStream=super.decorateInputStream(inputStream,fileSplit);
    return new InputStreamFSInputWrapper(new InvertedInputStream(inputStream));
  }
}
