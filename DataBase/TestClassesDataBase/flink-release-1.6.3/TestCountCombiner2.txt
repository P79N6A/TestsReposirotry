public static class TestCountCombiner2 extends RichGroupReduceFunction<Tuple2<Integer,String>,Tuple2<Integer,String>> implements GroupCombineFunction<Tuple2<Integer,String>,Tuple2<Integer,String>> {
  private static final long serialVersionUID=1L;
  public volatile boolean opened=false;
  public volatile boolean closed=false;
  @Override public void combine(  Iterable<Tuple2<Integer,String>> values,  Collector<Tuple2<Integer,String>> out){
    Tuple2<Integer,String> rec=new Tuple2<>();
    int cnt=0;
    for (    Tuple2<Integer,String> next : values) {
      rec=next;
      cnt+=Integer.parseInt(rec.f1);
    }
    out.collect(new Tuple2(rec.f0,cnt + ""));
  }
  @Override public void reduce(  Iterable<Tuple2<Integer,String>> values,  Collector<Tuple2<Integer,String>> out){
  }
  @Override public void open(  Configuration parameters) throws Exception {
    opened=true;
  }
  @Override public void close() throws Exception {
    closed=true;
  }
}
