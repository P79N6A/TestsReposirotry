private static class TestUserFunction extends RichMapFunction<Integer,Integer> implements ListCheckpointed<Integer> {
  private static final long serialVersionUID=-8981369286399531925L;
  private final List<Integer> expected;
  private boolean restored;
  public TestUserFunction(  List<Integer> expected){
    this.expected=expected;
    this.restored=false;
  }
  @Override public Integer map(  Integer value) throws Exception {
    return value;
  }
  @Override public List<Integer> snapshotState(  long checkpointId,  long timestamp) throws Exception {
    return expected;
  }
  @Override public void restoreState(  List<Integer> state) throws Exception {
    if (null != expected) {
      Assert.assertEquals(expected,state);
    }
 else {
      Assert.assertTrue(state.isEmpty());
    }
    restored=true;
  }
  public boolean isRestored(){
    return restored;
  }
}
