/** 
 * Tests for  {@link BooleanSummaryAggregator}.
 */
public class BooleanSummaryAggregatorTest {
  @Test public void testMixedGroup(){
    BooleanColumnSummary summary=summarize(true,false,null,true,true,true,false,null,true,false,true);
    Assert.assertEquals(11,summary.getTotalCount());
    Assert.assertEquals(2,summary.getNullCount());
    Assert.assertEquals(9,summary.getNonNullCount());
    Assert.assertEquals(6,summary.getTrueCount());
    Assert.assertEquals(3,summary.getFalseCount());
  }
  @Test public void testAllNullBooleans(){
    BooleanColumnSummary summary=summarize(null,null,null,null);
    Assert.assertEquals(4,summary.getTotalCount());
    Assert.assertEquals(4,summary.getNullCount());
    Assert.assertEquals(0,summary.getNonNullCount());
    Assert.assertEquals(0,summary.getTrueCount());
    Assert.assertEquals(0,summary.getFalseCount());
  }
  @Test public void testAllTrue(){
    BooleanColumnSummary summary=summarize(true,true,true,true,true,true);
    Assert.assertEquals(6,summary.getTotalCount());
    Assert.assertEquals(0,summary.getNullCount());
    Assert.assertEquals(6,summary.getNonNullCount());
    Assert.assertEquals(6,summary.getTrueCount());
    Assert.assertEquals(0,summary.getFalseCount());
  }
  @Test public void testAllFalse(){
    BooleanColumnSummary summary=summarize(false,false,false);
    Assert.assertEquals(3,summary.getTotalCount());
    Assert.assertEquals(0,summary.getNullCount());
    Assert.assertEquals(3,summary.getNonNullCount());
    Assert.assertEquals(0,summary.getTrueCount());
    Assert.assertEquals(3,summary.getFalseCount());
  }
  /** 
 * Helper method for summarizing a list of values. <p>This method breaks the rule of "testing only one thing" by aggregating and combining a bunch of different ways.
 */
  protected BooleanColumnSummary summarize(  Boolean... values){
    return new AggregateCombineHarness<Boolean,BooleanColumnSummary,BooleanSummaryAggregator>(){
      @Override protected void compareResults(      BooleanColumnSummary result1,      BooleanColumnSummary result2){
        Assert.assertEquals(result1.getNullCount(),result2.getNullCount());
        Assert.assertEquals(result1.getNonNullCount(),result2.getNonNullCount());
        Assert.assertEquals(result1.getTrueCount(),result2.getTrueCount());
        Assert.assertEquals(result1.getFalseCount(),result2.getFalseCount());
      }
    }
.summarize(values);
  }
}
