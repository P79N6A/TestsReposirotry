/** 
 * IT cases for both the  {@link HadoopInputFormat} and {@link HadoopOutputFormat}.
 */
public class HadoopInputOutputITCase extends JavaProgramTestBase {
  protected String textPath;
  protected String resultPath;
  @Before public void checkOperatingSystem(){
    Assume.assumeTrue("This test can't run successfully on Windows.",!OperatingSystem.isWindows());
  }
  @Override protected void preSubmit() throws Exception {
    textPath=createTempFile("text.txt",WordCountData.TEXT);
    resultPath=getTempDirPath("result");
  }
  @Override protected void postSubmit() throws Exception {
    compareResultsByLinesInMemory(WordCountData.COUNTS,resultPath,new String[]{".","_"});
  }
  @Override protected void testProgram() throws Exception {
    WordCount.main(new String[]{textPath,resultPath});
  }
}
