private static class BufferingQueryingSink<T> implements SinkFunction<T> {
  private final List<Tuple4<Long,Long,Long,T>> data;
  public BufferingQueryingSink(){
    data=new ArrayList<>();
  }
  @Override public void invoke(  T value,  Context context) throws Exception {
    Long timestamp=context.timestamp();
    if (timestamp != null) {
      data.add(new Tuple4<>(context.currentWatermark(),context.currentProcessingTime(),context.timestamp(),value));
    }
 else {
      data.add(new Tuple4<>(context.currentWatermark(),context.currentProcessingTime(),null,value));
    }
  }
}
