private static class WordChecker extends RichFlatMapFunction<String,Tuple1<String>> {
  private static final long serialVersionUID=1L;
  private final List<String> wordList=new ArrayList<>();
  @Override public void open(  Configuration conf) throws IOException {
    File file=getRuntimeContext().getDistributedCache().getFile("cache_test");
    try (BufferedReader reader=new BufferedReader(new FileReader(file))){
      String tempString;
      while ((tempString=reader.readLine()) != null) {
        wordList.add(tempString);
      }
    }
   }
  @Override public void flatMap(  String word,  Collector<Tuple1<String>> out) throws Exception {
    assertTrue("Unexpected word in stream! wordFromStream: " + word + ", shouldBeOneOf: "+ wordList.toString(),wordList.contains(word));
    out.collect(new Tuple1<>(word));
  }
}
