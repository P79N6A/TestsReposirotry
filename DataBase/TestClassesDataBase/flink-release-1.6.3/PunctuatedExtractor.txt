private static class PunctuatedExtractor implements AssignerWithPunctuatedWatermarks<Tuple2<Long,Boolean>> {
  private static final long serialVersionUID=1L;
  @Override public long extractTimestamp(  Tuple2<Long,Boolean> element,  long previousTimestamp){
    return element.f0;
  }
  @Override public Watermark checkAndGetNextWatermark(  Tuple2<Long,Boolean> lastElement,  long extractedTimestamp){
    return lastElement.f1 ? new Watermark(extractedTimestamp) : null;
  }
}
