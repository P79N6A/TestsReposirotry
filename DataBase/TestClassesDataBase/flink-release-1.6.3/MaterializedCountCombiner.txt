public static class MaterializedCountCombiner extends RichGroupReduceFunction<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>> implements GroupCombineFunction<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>> {
  private static final long serialVersionUID=1L;
  @Override public void combine(  Iterable<Tuple2<Integer,Integer>> values,  Collector<Tuple2<Integer,Integer>> out){
    ArrayList<Tuple2<Integer,Integer>> valueList=new ArrayList<>();
    for (    Tuple2<Integer,Integer> next : values) {
      valueList.add(next);
    }
    int count=0;
    Tuple2<Integer,Integer> rec=new Tuple2<>();
    for (    Tuple2<Integer,Integer> tuple : valueList) {
      rec.setField(tuple.f0,0);
      count+=tuple.f1;
    }
    rec.setField(count,1);
    out.collect(rec);
  }
  @Override public void reduce(  Iterable<Tuple2<Integer,Integer>> values,  Collector<Tuple2<Integer,Integer>> out) throws Exception {
  }
}
