/** 
 * A source that emits elements with a fixed set of keys as fast as possible. Used for rough performance estimation.
 */
public static class InfiniteTupleSource implements ParallelSourceFunction<Tuple2<String,Integer>> {
  private static final long serialVersionUID=1L;
  private int numKeys;
  private volatile boolean running=true;
  public InfiniteTupleSource(  int numKeys){
    this.numKeys=numKeys;
  }
  @Override public void run(  SourceContext<Tuple2<String,Integer>> out) throws Exception {
    Random random=new Random(42);
    while (running) {
      Tuple2<String,Integer> tuple=new Tuple2<String,Integer>("Tuple " + (random.nextInt(numKeys)),1);
      out.collect(tuple);
    }
  }
  @Override public void cancel(){
    this.running=false;
  }
}
