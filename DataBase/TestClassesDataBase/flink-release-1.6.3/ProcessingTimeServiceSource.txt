private static final class ProcessingTimeServiceSource implements SourceFunction<Long> {
  private final TestProcessingTimeService processingTimeService;
  private final List<Long> processingTimes;
  private boolean cancelled=false;
  private ProcessingTimeServiceSource(  TestProcessingTimeService processingTimeService,  List<Long> processingTimes){
    this.processingTimeService=processingTimeService;
    this.processingTimes=processingTimes;
  }
  @Override public void run(  SourceContext<Long> ctx) throws Exception {
    for (    Long processingTime : processingTimes) {
      if (cancelled) {
        break;
      }
      processingTimeService.setCurrentTime(processingTime);
    }
  }
  @Override public void cancel(){
    cancelled=true;
  }
}
