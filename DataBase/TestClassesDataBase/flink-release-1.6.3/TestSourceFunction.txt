private static class TestSourceFunction implements SourceFunction<Tuple2<Integer,String>> {
  private static final long serialVersionUID=1L;
  private volatile boolean running=true;
  private final int numElements;
  public TestSourceFunction(  int numElements){
    this.numElements=numElements;
  }
  @Override public void run(  SourceContext<Tuple2<Integer,String>> ctx) throws Exception {
    for (int i=0; i < numElements && running; i++) {
      ctx.collect(Tuple2.of(i,"message #" + i));
    }
  }
  @Override public void cancel(){
    running=false;
  }
}
