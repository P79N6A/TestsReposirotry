/** 
 * Sends a fixed number of buffers and sleeps in-between sends.
 */
public static class SlowBufferSender extends AbstractInvokable {
  public SlowBufferSender(  Environment environment){
    super(environment);
  }
  @Override public void invoke() throws Exception {
    final ResultPartitionWriter writer=getEnvironment().getWriter(0);
    for (int i=0; i < 8; i++) {
      final BufferBuilder bufferBuilder=writer.getBufferProvider().requestBufferBuilderBlocking();
      writer.addBufferConsumer(bufferBuilder.createBufferConsumer(),0);
      Thread.sleep(50);
      bufferBuilder.finish();
    }
  }
}
