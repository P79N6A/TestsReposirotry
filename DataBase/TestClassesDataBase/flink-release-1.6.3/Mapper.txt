private static class Mapper extends RichMapFunction<Long,Long> {
  private List<Long> values;
  @Override public void open(  Configuration config){
    values=getRuntimeContext().getBroadcastVariable(BC_NAME);
  }
  @Override public Long map(  Long value) throws Exception {
    long sum=0;
    for (    Long v : values) {
      sum+=value * v;
    }
    return sum;
  }
}
