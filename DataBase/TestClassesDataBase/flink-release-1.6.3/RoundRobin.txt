/** 
 * RoundRobin channel selector starting at 0 ( {@link RoundRobinChannelSelector} starts at 1).
 */
private static class RoundRobin<T extends IOReadableWritable> implements ChannelSelector<T> {
  private int[] nextChannel=new int[]{-1};
  @Override public int[] selectChannels(  final T record,  final int numberOfOutputChannels){
    nextChannel[0]=(nextChannel[0] + 1) % numberOfOutputChannels;
    return nextChannel;
  }
}
