/** 
 * Wrapper around a  {@link Scanner} that buffers the last N lines read.
 */
private static class BufferingScanner {
  private final Scanner scanner;
  private final int numLinesBuffered;
  private final List<String> bufferedLines;
  BufferingScanner(  Scanner scanner,  int numLinesBuffered){
    this.scanner=scanner;
    this.numLinesBuffered=numLinesBuffered;
    this.bufferedLines=new ArrayList<>(numLinesBuffered);
  }
  public boolean hasNextLine(){
    return scanner.hasNextLine();
  }
  public String nextLine(){
    if (bufferedLines.size() == numLinesBuffered) {
      bufferedLines.remove(0);
    }
    String line=scanner.nextLine();
    bufferedLines.add(line);
    return line;
  }
  public List<String> getPreviousLines(){
    return new ArrayList<>(bufferedLines);
  }
}
