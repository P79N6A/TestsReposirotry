private static class TestOpenCloseFoldFunction extends RichFoldFunction<Integer,String> {
  private static final long serialVersionUID=1L;
  public static boolean openCalled=false;
  public static boolean closeCalled=false;
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    if (closeCalled) {
      fail("Close called before open.");
    }
    openCalled=true;
  }
  @Override public void close() throws Exception {
    super.close();
    if (!openCalled) {
      fail("Open was not called before close.");
    }
    closeCalled=true;
  }
  @Override public String fold(  String acc,  Integer in) throws Exception {
    if (!openCalled) {
      fail("Open was not called before run.");
    }
    return acc + in;
  }
}
