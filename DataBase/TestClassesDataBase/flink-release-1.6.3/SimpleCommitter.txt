private static class SimpleCommitter extends CheckpointCommitter {
  private static final long serialVersionUID=1L;
  private List<Tuple2<Long,Integer>> checkpoints;
  @Override public void open() throws Exception {
  }
  @Override public void close() throws Exception {
  }
  @Override public void createResource() throws Exception {
    checkpoints=new ArrayList<>();
  }
  @Override public void commitCheckpoint(  int subtaskIdx,  long checkpointID){
    checkpoints.add(new Tuple2<>(checkpointID,subtaskIdx));
  }
  @Override public boolean isCheckpointCommitted(  int subtaskIdx,  long checkpointID){
    return checkpoints.contains(new Tuple2<>(checkpointID,subtaskIdx));
  }
}
