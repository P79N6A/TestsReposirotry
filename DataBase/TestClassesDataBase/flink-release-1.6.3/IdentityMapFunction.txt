/** 
 * Identity transform on Long values wrapping the output in a tuple. As an implementation for the  {@link CheckpointListener} interface it stores all the checkpoint ids it has seen in a static list.
 */
private static class IdentityMapFunction extends RichMapFunction<Long,Tuple1<Long>> implements CheckpointListener {
  static final List<Long>[] COMPLETED_CHECKPOINTS=createCheckpointLists(PARALLELISM);
  private volatile boolean notificationAlready;
  @Override public Tuple1<Long> map(  Long value) throws Exception {
    return Tuple1.of(value);
  }
  @Override public void notifyCheckpointComplete(  long checkpointId){
    int partition=getRuntimeContext().getIndexOfThisSubtask();
    COMPLETED_CHECKPOINTS[partition].add(checkpointId);
    if (OnceFailingReducer.hasFailed && !notificationAlready) {
      notificationAlready=true;
      GeneratingSourceFunction.numPostFailureNotifications.incrementAndGet();
    }
  }
}
