private static final class CountDownLatchRestartStrategy implements RestartStrategy {
  private final CountDownLatch countDownLatch;
  private CountDownLatchRestartStrategy(  CountDownLatch countDownLatch){
    this.countDownLatch=countDownLatch;
  }
  @Override public boolean canRestart(){
    return true;
  }
  @Override public void restart(  RestartCallback restarter,  ScheduledExecutor executor){
    executor.execute(() -> {
      countDownLatch.countDown();
      try {
        countDownLatch.await();
      }
 catch (      InterruptedException e) {
        ExceptionUtils.rethrow(e);
      }
      restarter.triggerFullRecovery();
    }
);
  }
}
