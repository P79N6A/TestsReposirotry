@SuppressWarnings("serial") private static final class SelectMinWeightNeighbor implements EdgesFunctionWithVertexValue<Long,Long,Long,Tuple2<Long,Long>> {
  @Override public void iterateEdges(  Vertex<Long,Long> v,  Iterable<Edge<Long,Long>> edges,  Collector<Tuple2<Long,Long>> out) throws Exception {
    long weight=Long.MAX_VALUE;
    long minNeighborId=0;
    for (    Edge<Long,Long> edge : edges) {
      if (edge.getValue() < weight) {
        weight=edge.getValue();
        minNeighborId=edge.getTarget();
      }
    }
    out.collect(new Tuple2<>(v.getId(),minNeighborId));
  }
}
