private static class RemoteChannelSource extends Source {
  final RemoteInputChannel channel;
  private int seq=0;
  RemoteChannelSource(  RemoteInputChannel channel){
    this.channel=channel;
  }
  @Override void addBufferConsumer(  BufferConsumer bufferConsumer) throws Exception {
    try {
      Buffer buffer=bufferConsumer.build();
      checkState(bufferConsumer.isFinished(),"Handling of non finished buffers is not yet implemented");
      channel.onBuffer(buffer,seq++,-1);
    }
  finally {
      bufferConsumer.close();
    }
  }
  @Override void flush(){
  }
}
