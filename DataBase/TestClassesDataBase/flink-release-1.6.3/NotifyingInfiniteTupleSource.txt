/** 
 * Infinite source which notifies when all of its sub tasks have been started via the count down latch.
 */
public static class NotifyingInfiniteTupleSource extends ManualWindowSpeedITCase.InfiniteTupleSource {
  private static final long serialVersionUID=8120981235081181746L;
  private static CountDownLatch countDownLatch;
  public NotifyingInfiniteTupleSource(  int numKeys){
    super(numKeys);
  }
  @Override public void run(  SourceContext<Tuple2<String,Integer>> out) throws Exception {
    if (countDownLatch != null) {
      countDownLatch.countDown();
    }
    super.run(out);
  }
}
