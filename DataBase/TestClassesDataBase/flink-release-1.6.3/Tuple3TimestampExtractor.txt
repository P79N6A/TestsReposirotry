private static class Tuple3TimestampExtractor implements AssignerWithPunctuatedWatermarks<Tuple3<String,String,Integer>> {
  @Override public long extractTimestamp(  Tuple3<String,String,Integer> element,  long previousTimestamp){
    return element.f2;
  }
  @Override public Watermark checkAndGetNextWatermark(  Tuple3<String,String,Integer> lastElement,  long extractedTimestamp){
    return new Watermark(lastElement.f2 - 1);
  }
}
