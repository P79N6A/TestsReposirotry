private static class TimeStampingSource implements ParallelSourceFunction<Tuple2<Long,Long>> {
  private static final long serialVersionUID=-151782334777482511L;
  private volatile boolean running=true;
  @Override public void run(  SourceContext<Tuple2<Long,Long>> ctx) throws Exception {
    long num=100;
    long counter=(long)(Math.random() * 4096);
    while (running) {
      if (num < 100) {
        num++;
        ctx.collect(new Tuple2<Long,Long>(counter++,0L));
      }
 else {
        num=0;
        ctx.collect(new Tuple2<Long,Long>(counter++,System.currentTimeMillis()));
      }
      Thread.sleep(1);
    }
  }
  @Override public void cancel(){
    running=false;
  }
}
