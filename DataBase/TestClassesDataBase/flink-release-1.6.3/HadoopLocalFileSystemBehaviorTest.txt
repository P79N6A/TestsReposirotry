/** 
 * Behavior tests for HDFS.
 */
public class HadoopLocalFileSystemBehaviorTest extends FileSystemBehaviorTestSuite {
  @Rule public final TemporaryFolder tmp=new TemporaryFolder();
  @Override public FileSystem getFileSystem() throws Exception {
    org.apache.hadoop.fs.FileSystem fs=new RawLocalFileSystem();
    fs.initialize(LocalFileSystem.getLocalFsURI(),new Configuration());
    return new HadoopFileSystem(fs);
  }
  @Override public Path getBasePath() throws Exception {
    return new Path(tmp.newFolder().toURI());
  }
  @Override public FileSystemKind getFileSystemKind(){
    return FileSystemKind.FILE_SYSTEM;
  }
  /** 
 * This test needs to be skipped for earlier Hadoop versions because those have a bug.
 */
  @Override public void testMkdirsFailsForExistingFile() throws Exception {
    final String versionString=VersionInfo.getVersion();
    final String prefix=versionString.substring(0,3);
    final float version=Float.parseFloat(prefix);
    Assume.assumeTrue("Cannot execute this test on Hadoop prior to 2.8",version >= 2.8f);
    super.testMkdirsFailsForExistingFile();
  }
}
