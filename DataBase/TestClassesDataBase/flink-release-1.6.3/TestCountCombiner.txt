public static class TestCountCombiner extends RichGroupReduceFunction<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>> implements GroupCombineFunction<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>> {
  private static final long serialVersionUID=1L;
  private Integer count=0;
  public volatile boolean opened=false;
  public volatile boolean closed=false;
  @Override public void combine(  Iterable<Tuple2<Integer,Integer>> values,  Collector<Tuple2<Integer,Integer>> out){
    Tuple2<Integer,Integer> rec=new Tuple2<>();
    int cnt=0;
    for (    Tuple2<Integer,Integer> next : values) {
      rec=next;
      cnt+=rec.f1;
    }
    this.count=cnt;
    rec.setField(this.count,1);
    out.collect(rec);
  }
  @Override public void reduce(  Iterable<Tuple2<Integer,Integer>> values,  Collector<Tuple2<Integer,Integer>> out){
  }
  @Override public void open(  Configuration parameters) throws Exception {
    opened=true;
  }
  @Override public void close() throws Exception {
    closed=true;
  }
}
