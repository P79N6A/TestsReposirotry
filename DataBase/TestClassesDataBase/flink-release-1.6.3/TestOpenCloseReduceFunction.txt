private static class TestOpenCloseReduceFunction extends RichReduceFunction<Integer> {
  private static final long serialVersionUID=1L;
  public static boolean openCalled=false;
  public static boolean closeCalled=false;
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    if (closeCalled) {
      Assert.fail("Close called before open.");
    }
    openCalled=true;
  }
  @Override public void close() throws Exception {
    super.close();
    if (!openCalled) {
      Assert.fail("Open was not called before close.");
    }
    closeCalled=true;
  }
  @Override public Integer reduce(  Integer in1,  Integer in2) throws Exception {
    if (!openCalled) {
      Assert.fail("Open was not called before run.");
    }
    return in1 + in2;
  }
}
