/** 
 * The entry point for the TaskManager JVM. Simply configures and runs a TaskManager.
 */
public static class TaskManagerProcessEntryPoint {
  private static final Logger LOG=LoggerFactory.getLogger(TaskManagerProcessEntryPoint.class);
  public static void main(  String[] args){
    try {
      int jobManagerPort=Integer.parseInt(args[0]);
      Configuration cfg=new Configuration();
      cfg.setString(JobManagerOptions.ADDRESS,"localhost");
      cfg.setInteger(JobManagerOptions.PORT,jobManagerPort);
      cfg.setString(TaskManagerOptions.MANAGED_MEMORY_SIZE,"4m");
      cfg.setInteger(TaskManagerOptions.NETWORK_NUM_BUFFERS,100);
      cfg.setInteger(TaskManagerOptions.NUM_TASK_SLOTS,2);
      cfg.setString(AkkaOptions.ASK_TIMEOUT,"100 s");
      TaskManager.selectNetworkInterfaceAndRunTaskManager(cfg,ResourceID.generate(),TaskManager.class);
      Object lock=new Object();
synchronized (lock) {
        lock.wait();
      }
    }
 catch (    Throwable t) {
      LOG.error("Failed to start TaskManager process",t);
      System.exit(1);
    }
  }
}
