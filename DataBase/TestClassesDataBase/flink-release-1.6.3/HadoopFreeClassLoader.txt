private static final class HadoopFreeClassLoader extends URLClassLoader {
  private final ClassLoader properParent;
  HadoopFreeClassLoader(  URLClassLoader parent){
    super(parent.getURLs(),null);
    properParent=parent;
  }
  @Override public Class<?> loadClass(  String name) throws ClassNotFoundException {
    if (name.startsWith("org.apache.hadoop")) {
      throw new ClassNotFoundException(name);
    }
 else     if (name.startsWith("org.apache.log4j")) {
      return properParent.loadClass(name);
    }
 else {
      return super.loadClass(name);
    }
  }
}
