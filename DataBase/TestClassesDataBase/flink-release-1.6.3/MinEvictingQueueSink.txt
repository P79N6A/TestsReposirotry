/** 
 * Sink that emits the output to an evicting queue storing the last  {@link #NUM_OUTPUT} elements.A separate queue is initiated for each group, apply a grouping prior to this operator to avoid parallel access of the queues.
 */
private static class MinEvictingQueueSink implements SinkFunction<Tuple2<Integer,Long>> {
  public static Queue<Long>[] queues=new Queue[PARALLELISM];
  @Override public void invoke(  Tuple2<Integer,Long> value) throws Exception {
    if (queues[value.f0] == null) {
      queues[value.f0]=EvictingQueue.create(NUM_OUTPUT);
    }
    queues[value.f0].add(value.f1);
  }
}
