private static class SubtaskIndexAssigner extends RichMapFunction<Tuple1<String>,Tuple2<Integer,String>> {
  private static final long serialVersionUID=1L;
  private int indexOfSubtask;
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    RuntimeContext runtimeContext=getRuntimeContext();
    indexOfSubtask=runtimeContext.getIndexOfThisSubtask();
  }
  @Override public Tuple2<Integer,String> map(  Tuple1<String> value) throws Exception {
    return new Tuple2<Integer,String>(indexOfSubtask,value.f0);
  }
}
