@SuppressWarnings("unused, serial") private static class OrderCheckMapper<T> implements MapPartitionFunction<T,Tuple1<Boolean>> {
  OrderChecker<T> checker;
  public OrderCheckMapper(){
  }
  public OrderCheckMapper(  OrderChecker<T> checker){
    this.checker=checker;
  }
  @Override public void mapPartition(  Iterable<T> values,  Collector<Tuple1<Boolean>> out) throws Exception {
    Iterator<T> it=values.iterator();
    if (!it.hasNext()) {
      out.collect(new Tuple1<>(true));
    }
 else {
      T last=it.next();
      while (it.hasNext()) {
        T next=it.next();
        if (!checker.inOrder(last,next)) {
          out.collect(new Tuple1<>(false));
          return;
        }
        last=next;
      }
      out.collect(new Tuple1<>(true));
    }
  }
}
