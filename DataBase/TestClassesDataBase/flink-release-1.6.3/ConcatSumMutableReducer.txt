public static final class ConcatSumMutableReducer extends RichGroupReduceFunction<Tuple2<StringValue,IntValue>,Tuple2<StringValue,IntValue>> {
  @Override public void reduce(  Iterable<Tuple2<StringValue,IntValue>> values,  Collector<Tuple2<StringValue,IntValue>> out){
    Tuple2<StringValue,IntValue> current=new Tuple2<StringValue,IntValue>(new StringValue(""),new IntValue(0));
    for (    Tuple2<StringValue,IntValue> next : values) {
      next.f0.append(current.f0);
      next.f1.setValue(current.f1.getValue() + next.f1.getValue());
      current=next;
    }
    out.collect(current);
  }
}
