/** 
 * Tests for the JobPlanHandler.
 */
public class JobPlanHandlerTest extends TestLogger {
  @Test public void testArchiver() throws Exception {
    JsonArchivist archivist=new JobPlanHandler.JobPlanJsonArchivist();
    AccessExecutionGraph originalJob=ArchivedJobGenerationUtils.getTestJob();
    Collection<ArchivedJson> archives=archivist.archiveJsonWithPath(originalJob);
    Assert.assertEquals(1,archives.size());
    ArchivedJson archive=archives.iterator().next();
    Assert.assertEquals("/jobs/" + originalJob.getJobID() + "/plan",archive.getPath());
    Assert.assertEquals(originalJob.getJsonPlan(),archive.getJson());
  }
  @Test public void testGetPaths(){
    JobPlanHandler handler=new JobPlanHandler(mock(ExecutionGraphCache.class),Executors.directExecutor());
    String[] paths=handler.getPaths();
    Assert.assertEquals(1,paths.length);
    Assert.assertEquals("/jobs/:jobid/plan",paths[0]);
  }
}
