/** 
 * Unit test for  {@link TaskManagerServicesConfiguration}.
 */
public class TaskManagerServicesConfigurationTest extends TestLogger {
  /** 
 * Verifies that  {@link TaskManagerServicesConfiguration#hasNewNetworkBufConf(Configuration)}returns the correct result for old configurations via {@link TaskManagerOptions#NETWORK_NUM_BUFFERS}.
 */
  @SuppressWarnings("deprecation") @Test public void hasNewNetworkBufConfOld() throws Exception {
    Configuration config=new Configuration();
    config.setInteger(TaskManagerOptions.NETWORK_NUM_BUFFERS,1);
    assertFalse(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
  }
  /** 
 * Verifies that  {@link TaskManagerServicesConfiguration#hasNewNetworkBufConf(Configuration)}returns the correct result for new configurations via {@link TaskManagerOptions#NETWORK_BUFFERS_MEMORY_FRACTION}, {@link TaskManagerOptions#NETWORK_BUFFERS_MEMORY_MIN} and {@link TaskManagerOptions#NETWORK_BUFFERS_MEMORY_MAX}.
 */
  @Test public void hasNewNetworkBufConfNew() throws Exception {
    Configuration config=new Configuration();
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config.setFloat(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_FRACTION,0.1f);
    config.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MIN,"1024");
    config.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MAX,"2048");
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config=new Configuration();
    config.setFloat(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_FRACTION,0.1f);
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MAX,"1024");
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config=new Configuration();
    config.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MIN,"1024");
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config.setFloat(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_FRACTION,0.1f);
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config=new Configuration();
    config.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MAX,"1024");
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MIN,"1024");
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
  }
  /** 
 * Verifies that  {@link TaskManagerServicesConfiguration#hasNewNetworkBufConf(Configuration)}returns the correct result for mixed old/new configurations.
 */
  @SuppressWarnings("deprecation") @Test public void hasNewNetworkBufConfMixed() throws Exception {
    Configuration config=new Configuration();
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    config.setInteger(TaskManagerOptions.NETWORK_NUM_BUFFERS,1);
    assertFalse(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config));
    Configuration config1=config.clone();
    config1.setFloat(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_FRACTION,0.1f);
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config1));
    config1=config.clone();
    config1.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MIN,"1024");
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config1));
    config1=config.clone();
    config1.setString(TaskManagerOptions.NETWORK_BUFFERS_MEMORY_MAX,"1024");
    assertTrue(TaskManagerServicesConfiguration.hasNewNetworkBufConf(config1));
  }
}
