private static final class LongCancelTimeIdentityMapper<IN> implements MapFunction<IN,IN> {
  private static final long serialVersionUID=1L;
  private static final int WAIT_TIME_PER_VALUE=5 * 1000;
  @Override public IN map(  IN value) throws Exception {
    final long start=System.currentTimeMillis();
    long remaining=WAIT_TIME_PER_VALUE;
    do {
      try {
        Thread.sleep(remaining);
      }
 catch (      InterruptedException iex) {
      }
    }
 while ((remaining=WAIT_TIME_PER_VALUE - System.currentTimeMillis() + start) > 0);
    return value;
  }
}
