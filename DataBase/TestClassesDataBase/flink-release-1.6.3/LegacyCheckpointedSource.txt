private static class LegacyCheckpointedSource implements SourceFunction<Tuple2<Long,Long>> {
  public static String checkpointedString="Here be dragons!";
  private static final long serialVersionUID=1L;
  private volatile boolean isRunning=true;
  private final int numElements;
  public LegacyCheckpointedSource(  int numElements){
    this.numElements=numElements;
  }
  @Override public void run(  SourceContext<Tuple2<Long,Long>> ctx) throws Exception {
    ctx.emitWatermark(new Watermark(0));
synchronized (ctx.getCheckpointLock()) {
      for (long i=0; i < numElements; i++) {
        ctx.collect(new Tuple2<>(i,i));
      }
    }
    while (isRunning) {
      Thread.sleep(20);
    }
  }
  @Override public void cancel(){
    isRunning=false;
  }
}
