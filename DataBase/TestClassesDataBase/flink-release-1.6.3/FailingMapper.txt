private static class FailingMapper<T> extends RichMapFunction<T,T> {
  private static final long serialVersionUID=4435412404173331157L;
  private static final BlockingQueue<Object> TASK_TO_COORD_QUEUE=new LinkedBlockingQueue<Object>();
  private static final BlockingQueue<Object> COORD_TO_TASK_QUEUE=new LinkedBlockingQueue<Object>();
  @Override public void open(  Configuration parameters) throws Exception {
    TASK_TO_COORD_QUEUE.add(new Object());
    COORD_TO_TASK_QUEUE.take();
  }
  @Override public T map(  T value) throws Exception {
    return value;
  }
}
