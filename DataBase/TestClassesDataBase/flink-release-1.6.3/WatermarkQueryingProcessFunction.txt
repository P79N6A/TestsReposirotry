private static class WatermarkQueryingProcessFunction extends CoProcessFunction<Integer,String,String> {
  private static final long serialVersionUID=1L;
  @Override public void processElement1(  Integer value,  Context ctx,  Collector<String> out) throws Exception {
    out.collect(value + "WM:" + ctx.timerService().currentWatermark()+ " TS:"+ ctx.timestamp());
  }
  @Override public void processElement2(  String value,  Context ctx,  Collector<String> out) throws Exception {
    out.collect(value + "WM:" + ctx.timerService().currentWatermark()+ " TS:"+ ctx.timestamp());
  }
  @Override public void onTimer(  long timestamp,  OnTimerContext ctx,  Collector<String> out) throws Exception {
  }
}
