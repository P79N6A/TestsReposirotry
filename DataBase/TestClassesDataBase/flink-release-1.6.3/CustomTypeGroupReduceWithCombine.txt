private static class CustomTypeGroupReduceWithCombine implements GroupReduceFunction<CustomType,CustomType>, GroupCombineFunction<CustomType,CustomType> {
  private static final long serialVersionUID=1L;
  @Override public void combine(  Iterable<CustomType> values,  Collector<CustomType> out) throws Exception {
    CustomType o=new CustomType();
    for (    CustomType c : values) {
      o.myInt=c.myInt;
      o.myLong+=c.myLong;
      o.myString="test" + c.myInt;
    }
    out.collect(o);
  }
  @Override public void reduce(  Iterable<CustomType> values,  Collector<CustomType> out){
    CustomType o=new CustomType(0,0,"");
    for (    CustomType c : values) {
      o.myInt=c.myInt;
      o.myLong+=c.myLong;
      o.myString=c.myString;
    }
    out.collect(o);
  }
}
