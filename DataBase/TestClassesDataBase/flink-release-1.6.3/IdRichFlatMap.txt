public class IdRichFlatMap<IN> extends RichFlatMapFunction<IN,IN> {
  private boolean isOpened=false;
  private boolean isClosed=false;
  @Override public void open(  Configuration parameters) throws Exception {
    isOpened=true;
    RuntimeContext ctx=getRuntimeContext();
    Assert.assertEquals("Test UDF",ctx.getTaskName());
    Assert.assertEquals(4,ctx.getNumberOfParallelSubtasks());
    Assert.assertEquals(0,ctx.getIndexOfThisSubtask());
  }
  @Override public void flatMap(  IN value,  Collector<IN> out) throws Exception {
    Assert.assertTrue(isOpened);
    Assert.assertFalse(isClosed);
    out.collect(value);
  }
  @Override public void close() throws Exception {
    isClosed=true;
  }
}
