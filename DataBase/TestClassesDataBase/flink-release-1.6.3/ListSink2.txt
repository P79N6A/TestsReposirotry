/** 
 * Simple sink that stores all records in a public list.
 */
public static class ListSink2 extends GenericWriteAheadSink<Tuple1<Integer>> {
  private static final long serialVersionUID=1L;
  public List<Integer> values=new ArrayList<>();
  public ListSink2() throws Exception {
    super(new FailingCommitter(),TypeExtractor.getForObject(new Tuple1<>(1)).createSerializer(new ExecutionConfig()),"job");
  }
  @Override protected boolean sendValues(  Iterable<Tuple1<Integer>> values,  long checkpointId,  long timestamp) throws Exception {
    for (    Tuple1<Integer> value : values) {
      this.values.add(value.f0);
    }
    return true;
  }
}
