private static final class IntegerSource extends RichParallelSourceFunction<Integer> {
  private static final long serialVersionUID=1912878510707871659L;
  private final ExecutionMode mode;
  private volatile boolean running=true;
  private IntegerSource(  ExecutionMode mode){
    this.mode=mode;
  }
  @Override public void run(  SourceContext<Integer> ctx) throws Exception {
    ctx.collect(1);
switch (mode) {
case GENERATE:
case MIGRATE:
synchronized (this) {
        while (running) {
          this.wait();
        }
      }
  }
}
@Override public void cancel(){
synchronized (this) {
    running=false;
    this.notifyAll();
  }
}
}
