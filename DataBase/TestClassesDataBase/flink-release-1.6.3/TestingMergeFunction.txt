private static class TestingMergeFunction implements MergingWindowSet.MergeFunction<TimeWindow> {
  private TimeWindow target=null;
  private Collection<TimeWindow> sources=null;
  private TimeWindow stateWindow=null;
  private Collection<TimeWindow> mergedStateWindows=null;
  public void reset(){
    target=null;
    sources=null;
    stateWindow=null;
    mergedStateWindows=null;
  }
  public boolean hasMerged(){
    return target != null;
  }
  public TimeWindow mergeTarget(){
    return target;
  }
  public Collection<TimeWindow> mergeSources(){
    return sources;
  }
  public TimeWindow stateWindow(){
    return stateWindow;
  }
  public Collection<TimeWindow> mergedStateWindows(){
    return mergedStateWindows;
  }
  @Override public void merge(  TimeWindow mergeResult,  Collection<TimeWindow> mergedWindows,  TimeWindow stateWindowResult,  Collection<TimeWindow> mergedStateWindows) throws Exception {
    if (target != null) {
      fail("More than one merge for adding a Window should not occur.");
    }
    this.stateWindow=stateWindowResult;
    this.target=mergeResult;
    this.mergedStateWindows=mergedStateWindows;
    this.sources=mergedWindows;
  }
}
