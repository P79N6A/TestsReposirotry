private static class LegacyCheckpointedFlatMapWithKeyedState extends RichFlatMapFunction<Tuple2<Long,Long>,Tuple2<Long,Long>> {
  private static final long serialVersionUID=1L;
  public static Tuple2<String,Long> checkpointedTuple=new Tuple2<>("hello",42L);
  private final ValueStateDescriptor<Long> stateDescriptor=new ValueStateDescriptor<Long>("state-name",LongSerializer.INSTANCE);
  @Override public void flatMap(  Tuple2<Long,Long> value,  Collector<Tuple2<Long,Long>> out) throws Exception {
    out.collect(value);
    getRuntimeContext().getState(stateDescriptor).update(value.f1);
    assertEquals(value.f1,getRuntimeContext().getState(stateDescriptor).value());
  }
}
