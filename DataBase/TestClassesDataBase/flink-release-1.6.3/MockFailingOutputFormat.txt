public static class MockFailingOutputFormat extends MockOutputFormat {
  private static final long serialVersionUID=1L;
  int cnt=0;
  @Override public void configure(  Configuration parameters){
    super.configure(parameters);
  }
  @Override public void writeRecord(  Record rec) throws IOException {
    if (++this.cnt >= 10) {
      throw new RuntimeException("Expected Test Exception");
    }
    super.writeRecord(rec);
  }
}
