private static final class IntegerTupleSource extends RichSourceFunction<Tuple2<Integer,Integer>> {
  private static final long serialVersionUID=1912878510707871659L;
  private final ExecutionMode mode;
  private boolean running=true;
  private IntegerTupleSource(  ExecutionMode mode){
    this.mode=mode;
  }
  @Override public void run(  SourceContext<Tuple2<Integer,Integer>> ctx) throws Exception {
    for (int x=0; x < 10; x++) {
      ctx.collect(new Tuple2<>(x,x));
    }
switch (mode) {
case GENERATE:
case MIGRATE:
synchronized (this) {
        while (running) {
          this.wait();
        }
      }
  }
}
@Override public void cancel(){
synchronized (this) {
    running=false;
    this.notifyAll();
  }
}
}
