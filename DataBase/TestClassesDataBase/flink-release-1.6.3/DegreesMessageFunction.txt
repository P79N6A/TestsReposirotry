@SuppressWarnings("serial") private static final class DegreesMessageFunction extends ScatterFunction<Long,Long,Long,Long> {
  @Override public void sendMessages(  Vertex<Long,Long> vertex){
    if (vertex.getId() == 1) {
      Assert.assertEquals(2,getOutDegree());
      Assert.assertEquals(1,getInDegree());
    }
 else     if (vertex.getId() == 3) {
      Assert.assertEquals(2,getOutDegree());
      Assert.assertEquals(2,getInDegree());
    }
    sendMessageToAllNeighbors(vertex.getValue());
  }
}
