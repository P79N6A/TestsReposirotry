@SuppressWarnings("serial") private static final class UpdateFilter extends RichFlatMapFunction<Tuple2<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>>,Tuple2<Integer,Integer>> {
  private int superstep;
  @Override public void open(  Configuration conf){
    superstep=getIterationRuntimeContext().getSuperstepNumber();
  }
  @Override public void flatMap(  Tuple2<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>> value,  Collector<Tuple2<Integer,Integer>> out){
    if (value.f0.f1 > superstep) {
      out.collect(value.f0);
    }
  }
}
