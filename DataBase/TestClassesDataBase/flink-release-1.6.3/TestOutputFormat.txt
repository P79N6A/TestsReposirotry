private static final class TestOutputFormat extends RichOutputFormat<String> {
  private LongCounter counter=new LongCounter();
  @Override public void configure(  Configuration parameters){
  }
  @Override public void open(  int a,  int b){
    try {
      getRuntimeContext().addAccumulator("DATA_SINK_ACCUMULATOR",counter);
    }
 catch (    UnsupportedOperationException e) {
    }
  }
  @Override public void close() throws IOException {
  }
  @Override public void writeRecord(  String record){
    writeCalls.add(1);
    counter.add(1);
  }
}
