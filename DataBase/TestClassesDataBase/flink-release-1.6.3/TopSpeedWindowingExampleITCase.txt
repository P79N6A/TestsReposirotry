/** 
 * Tests for  {@link TopSpeedWindowing}.
 */
public class TopSpeedWindowingExampleITCase extends TestLogger {
  @ClassRule public static TemporaryFolder temporaryFolder=new TemporaryFolder();
  @ClassRule public static MiniClusterResource miniClusterResource=new MiniClusterResource(new MiniClusterResourceConfiguration.Builder().setNumberTaskManagers(1).setNumberSlotsPerTaskManager(1).build());
  @Test public void testTopSpeedWindowingExampleITCase() throws Exception {
    File inputFile=temporaryFolder.newFile();
    FileUtils.writeFileUtf8(inputFile,TopSpeedWindowingExampleData.CAR_DATA);
    final String resultPath=temporaryFolder.newFolder().toURI().toString();
    TopSpeedWindowing.main(new String[]{"--input",inputFile.getAbsolutePath(),"--output",resultPath});
    compareResultsByLinesInMemory(TopSpeedWindowingExampleData.TOP_SPEEDS,resultPath);
  }
}
