/** 
 * Tests for  {@link Utils}.
 */
public class UtilsTest {
  @Rule public TemporaryFolder temporaryFolder=new TemporaryFolder();
  @Test public void testDeleteApplicationFiles() throws Exception {
    final Path applicationFilesDir=temporaryFolder.newFolder(".flink").toPath();
    Files.createFile(applicationFilesDir.resolve("flink.jar"));
    try (Stream<Path> files=Files.list(temporaryFolder.getRoot().toPath())){
      assertThat(files.count(),equalTo(1L));
    }
     try (Stream<Path> files=Files.list(applicationFilesDir)){
      assertThat(files.count(),equalTo(1L));
    }
     Utils.deleteApplicationFiles(Collections.singletonMap(YarnConfigKeys.FLINK_YARN_FILES,applicationFilesDir.toString()));
    try (Stream<Path> files=Files.list(temporaryFolder.getRoot().toPath())){
      assertThat(files.count(),equalTo(0L));
    }
   }
}
