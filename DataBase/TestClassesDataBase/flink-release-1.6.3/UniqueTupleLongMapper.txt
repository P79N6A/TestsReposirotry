private static class UniqueTupleLongMapper implements MapPartitionFunction<Tuple3<Integer,Long,String>,Long> {
  private static final long serialVersionUID=1L;
  @Override public void mapPartition(  Iterable<Tuple3<Integer,Long,String>> records,  Collector<Long> out) throws Exception {
    HashSet<Long> uniq=new HashSet<>();
    for (    Tuple3<Integer,Long,String> t : records) {
      uniq.add(t.f1);
    }
    for (    Long l : uniq) {
      out.collect(l);
    }
  }
}
