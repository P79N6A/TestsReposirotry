@SuppressWarnings("serial") private static final class SumInNeighborsSubtractOne implements NeighborsFunctionWithVertexValue<Long,Long,Long,Tuple2<Long,Long>> {
  @Override public void iterateNeighbors(  Vertex<Long,Long> vertex,  Iterable<Tuple2<Edge<Long,Long>,Vertex<Long,Long>>> neighbors,  Collector<Tuple2<Long,Long>> out) throws Exception {
    long sum=0;
    for (    Tuple2<Edge<Long,Long>,Vertex<Long,Long>> neighbor : neighbors) {
      sum+=neighbor.f0.getValue() * neighbor.f1.getValue();
    }
    out.collect(new Tuple2<>(vertex.getId(),sum));
    out.collect(new Tuple2<>(vertex.getId(),sum - 1));
  }
}
