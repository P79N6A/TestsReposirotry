private static class CheckingRestoringFlatMap extends RichFlatMapFunction<Tuple2<Long,Long>,Tuple2<Long,Long>> {
  private static final long serialVersionUID=1L;
  public static final String SUCCESSFUL_RESTORE_CHECK_ACCUMULATOR=CheckingRestoringFlatMap.class + "_RESTORE_CHECK";
  private transient Tuple2<String,Long> restoredState;
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    getRuntimeContext().addAccumulator(SUCCESSFUL_RESTORE_CHECK_ACCUMULATOR,new IntCounter());
  }
  @Override public void flatMap(  Tuple2<Long,Long> value,  Collector<Tuple2<Long,Long>> out) throws Exception {
    out.collect(value);
    getRuntimeContext().getAccumulator(SUCCESSFUL_RESTORE_CHECK_ACCUMULATOR).add(1);
  }
}
