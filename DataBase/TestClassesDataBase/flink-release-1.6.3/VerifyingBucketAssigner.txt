private static class VerifyingBucketAssigner implements BucketAssigner<String,String> {
  private static final long serialVersionUID=7729086510972377578L;
  private final Long expectedTimestamp;
  private final long expectedWatermark;
  private final long expectedProcessingTime;
  VerifyingBucketAssigner(  final Long expectedTimestamp,  final long expectedWatermark,  final long expectedProcessingTime){
    this.expectedTimestamp=expectedTimestamp;
    this.expectedWatermark=expectedWatermark;
    this.expectedProcessingTime=expectedProcessingTime;
  }
  @Override public String getBucketId(  String element,  BucketAssigner.Context context){
    final Long elementTimestamp=context.timestamp();
    final long watermark=context.currentWatermark();
    final long processingTime=context.currentProcessingTime();
    Assert.assertEquals(expectedTimestamp,elementTimestamp);
    Assert.assertEquals(expectedProcessingTime,processingTime);
    Assert.assertEquals(expectedWatermark,watermark);
    return element;
  }
  @Override public SimpleVersionedSerializer<String> getSerializer(){
    return SimpleVersionedStringSerializer.INSTANCE;
  }
}
