/** 
 * A  {@link Comparator} to compare {@link StreamRecord} while sorting them.
 */
private class StreamRecordComparator implements Comparator<Object> {
  @Override public int compare(  Object o1,  Object o2){
    if (o1 instanceof Watermark || o2 instanceof Watermark) {
      return 0;
    }
 else {
      StreamRecord<Integer> sr0=(StreamRecord<Integer>)o1;
      StreamRecord<Integer> sr1=(StreamRecord<Integer>)o2;
      if (sr0.getTimestamp() != sr1.getTimestamp()) {
        return (int)(sr0.getTimestamp() - sr1.getTimestamp());
      }
      int comparison=sr0.getValue().compareTo(sr1.getValue());
      if (comparison != 0) {
        return comparison;
      }
 else {
        return sr0.getValue() - sr1.getValue();
      }
    }
  }
}
