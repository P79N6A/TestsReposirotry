/** 
 * IT case for the  {@link AvroExternalJarProgram}.
 */
public class AvroExternalJarProgramITCase extends TestLogger {
  private static final String JAR_FILE="maven-test-jar.jar";
  private static final String TEST_DATA_FILE="/testdata.avro";
  private static final int PARALLELISM=4;
  private static final MiniCluster MINI_CLUSTER=new MiniCluster(new MiniClusterConfiguration.Builder().setNumTaskManagers(1).setNumSlotsPerTaskManager(PARALLELISM).build());
  @BeforeClass public static void setUp() throws Exception {
    MINI_CLUSTER.start();
  }
  @AfterClass public static void tearDown(){
    TestEnvironment.unsetAsContext();
    MINI_CLUSTER.closeAsync();
  }
  @Test public void testExternalProgram() throws Exception {
    TestEnvironment.setAsContext(MINI_CLUSTER,PARALLELISM,Collections.singleton(new Path(JAR_FILE)),Collections.emptyList());
    String testData=getClass().getResource(TEST_DATA_FILE).toString();
    PackagedProgram program=new PackagedProgram(new File(JAR_FILE),new String[]{testData});
    program.invokeInteractiveModeForExecution();
  }
}
