private static class SyncFailureInducingStateBackend extends MemoryStateBackend {
  private static final long serialVersionUID=-1915780414440060539L;
  @Override public OperatorStateBackend createOperatorStateBackend(  Environment env,  String operatorIdentifier) throws Exception {
    return new DefaultOperatorStateBackend(env.getUserClassLoader(),env.getExecutionConfig(),true){
      @Override public RunnableFuture<SnapshotResult<OperatorStateHandle>> snapshot(      long checkpointId,      long timestamp,      CheckpointStreamFactory streamFactory,      CheckpointOptions checkpointOptions) throws Exception {
        throw new Exception("Sync part snapshot exception.");
      }
    }
;
  }
  @Override public SyncFailureInducingStateBackend configure(  Configuration config){
    return this;
  }
}
