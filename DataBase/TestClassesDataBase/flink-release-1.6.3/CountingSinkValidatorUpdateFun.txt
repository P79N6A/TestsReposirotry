/** 
 * For validating the stateful window counts.
 */
static class CountingSinkValidatorUpdateFun implements ValidatingSink.CountUpdater<Tuple4<Long,Long,Long,IntType>> {
  @Override public void updateCount(  Tuple4<Long,Long,Long,IntType> value,  Map<Long,Integer> windowCounts){
    windowCounts.merge(value.f0,1,(a,b) -> a + b);
    assertEquals("Window counts don't match for key " + value.f0 + ".",value.f0.intValue() + windowCounts.get(value.f0),value.f3.value);
  }
}
