private static class ModTimeVerifyingSourceContext extends DummySourceContext {
  final long[] expectedModificationTimes;
  int splitCounter;
  long lastSeenModTime;
  ModTimeVerifyingSourceContext(  long[] modTimes){
    this.expectedModificationTimes=modTimes;
    this.splitCounter=0;
    this.lastSeenModTime=Long.MIN_VALUE;
  }
  int getCounter(){
    return splitCounter;
  }
  @Override public void collect(  TimestampedFileInputSplit element){
    try {
      long modTime=hdfs.getFileStatus(new org.apache.hadoop.fs.Path(element.getPath().getPath())).getModificationTime();
      Assert.assertTrue(modTime >= lastSeenModTime);
      Assert.assertEquals(expectedModificationTimes[splitCounter],modTime);
      lastSeenModTime=modTime;
      splitCounter++;
    }
 catch (    IOException e) {
      Assert.fail(e.getMessage());
    }
  }
}
