private static class DeletedCacheListener implements NodeCacheListener {
  final CompletableFuture<Boolean> deletedPromise=new CompletableFuture<>();
  final NodeCache cache;
  public DeletedCacheListener(  final NodeCache cache){
    this.cache=cache;
  }
  public Future<Boolean> nodeDeleted(){
    return deletedPromise;
  }
  @Override public void nodeChanged() throws Exception {
    ChildData data=cache.getCurrentData();
    if (data == null && !deletedPromise.isDone()) {
      deletedPromise.complete(true);
      cache.getListenable().removeListener(this);
    }
  }
}
