private static class LargeJoinDataGeneratorInputFormat extends GenericInputFormat<Tuple3<Integer,Integer,String>> implements NonParallelInput {
  private static final long serialVersionUID=1L;
  private final Random rand=new Random(42);
  private final int toProduce;
  private int produced;
  public LargeJoinDataGeneratorInputFormat(  int toProduce){
    this.toProduce=toProduce;
  }
  @Override public boolean reachedEnd() throws IOException {
    return produced >= toProduce;
  }
  @Override public Tuple3<Integer,Integer,String> nextRecord(  Tuple3<Integer,Integer,String> reuse) throws IOException {
    produced++;
    return new Tuple3<Integer,Integer,String>(rand.nextInt(toProduce),rand.nextInt(toProduce),"aaa");
  }
}
