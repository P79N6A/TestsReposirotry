public static final class MockFailingCrossStub implements CrossFunction<Record,Record,Record> {
  private static final long serialVersionUID=1L;
  private int cnt=0;
  @Override public Record cross(  Record record1,  Record record2){
    if (++this.cnt >= 10) {
      throw new ExpectedTestException();
    }
    return record1;
  }
}
