private static class LongRetrievableStateHandle implements RetrievableStateHandle<Long> {
  private static final long serialVersionUID=-3555329254423838912L;
  private static int numberOfGlobalDiscardCalls=0;
  private final Long state;
  private int numberOfDiscardCalls=0;
  public LongRetrievableStateHandle(  Long state){
    this.state=state;
  }
  @Override public Long retrieveState(){
    return state;
  }
  @Override public void discardState() throws Exception {
    numberOfGlobalDiscardCalls++;
    numberOfDiscardCalls++;
  }
  @Override public long getStateSize(){
    return 0;
  }
  int getNumberOfDiscardCalls(){
    return numberOfDiscardCalls;
  }
  public static int getNumberOfGlobalDiscardCalls(){
    return numberOfGlobalDiscardCalls;
  }
}
