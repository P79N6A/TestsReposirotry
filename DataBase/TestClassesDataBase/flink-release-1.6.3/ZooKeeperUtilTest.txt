public class ZooKeeperUtilTest extends TestLogger {
  @Test public void testZooKeeperEnsembleConnectStringConfiguration() throws Exception {
    String actual, expected;
    Configuration conf=new Configuration();
{
      expected="localhost:2891";
      setQuorum(conf,expected);
      actual=ZooKeeperUtils.getZooKeeperEnsemble(conf);
      assertEquals(expected,actual);
      setQuorum(conf," localhost:2891 ");
      actual=ZooKeeperUtils.getZooKeeperEnsemble(conf);
      assertEquals(expected,actual);
      setQuorum(conf,"localhost :2891");
      actual=ZooKeeperUtils.getZooKeeperEnsemble(conf);
      assertEquals(expected,actual);
    }
{
      expected="localhost:2891,localhost:2891";
      setQuorum(conf,"localhost:2891,localhost:2891");
      actual=ZooKeeperUtils.getZooKeeperEnsemble(conf);
      assertEquals(expected,actual);
      setQuorum(conf,"localhost:2891, localhost:2891");
      actual=ZooKeeperUtils.getZooKeeperEnsemble(conf);
      assertEquals(expected,actual);
      setQuorum(conf,"localhost :2891, localhost:2891");
      actual=ZooKeeperUtils.getZooKeeperEnsemble(conf);
      assertEquals(expected,actual);
      setQuorum(conf," localhost:2891, localhost:2891 ");
      actual=ZooKeeperUtils.getZooKeeperEnsemble(conf);
      assertEquals(expected,actual);
    }
  }
  private Configuration setQuorum(  Configuration conf,  String quorum){
    conf.setString(HighAvailabilityOptions.HA_ZOOKEEPER_QUORUM,quorum);
    return conf;
  }
}
