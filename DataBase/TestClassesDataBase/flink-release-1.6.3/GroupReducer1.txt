private static class GroupReducer1 implements GroupReduceFunction<CollectionDataSets.PojoWithDateAndEnum,String> {
  private static final long serialVersionUID=1L;
  @Override public void reduce(  Iterable<PojoWithDateAndEnum> values,  Collector<String> out) throws Exception {
    for (    PojoWithDateAndEnum val : values) {
      if (val.cat == CollectionDataSets.Category.CAT_A) {
        Assert.assertEquals("a",val.group);
      }
 else       if (val.cat == CollectionDataSets.Category.CAT_B) {
        Assert.assertEquals("b",val.group);
      }
 else {
        Assert.fail("error. Cat = " + val.cat);
      }
      Assert.assertEquals(666,val.date.getTime());
    }
    out.collect("ok");
  }
}
