/** 
 * Custom accumulator.
 */
public static class SetAccumulator<T> implements Accumulator<T,HashSet<T>> {
  private static final long serialVersionUID=1L;
  private HashSet<T> set=new HashSet<>();
  @Override public void add(  T value){
    this.set.add(value);
  }
  @Override public HashSet<T> getLocalValue(){
    return this.set;
  }
  @Override public void resetLocal(){
    this.set.clear();
  }
  @Override public void merge(  Accumulator<T,HashSet<T>> other){
    this.set.addAll(other.getLocalValue());
  }
  @Override public Accumulator<T,HashSet<T>> clone(){
    SetAccumulator<T> result=new SetAccumulator<>();
    result.set.addAll(set);
    return result;
  }
}
