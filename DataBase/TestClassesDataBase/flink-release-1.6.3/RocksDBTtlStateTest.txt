/** 
 * Test suite for rocksdb state TTL. 
 */
public class RocksDBTtlStateTest extends TtlStateTestBase {
  @Rule public final TemporaryFolder tempFolder=new TemporaryFolder();
  @Override protected StateBackendTestContext createStateBackendTestContext(  TtlTimeProvider timeProvider){
    return new StateBackendTestContext(timeProvider){
      @Override protected StateBackend createStateBackend(){
        return RocksDBTtlStateTest.this.createStateBackend();
      }
    }
;
  }
  private StateBackend createStateBackend(){
    String dbPath;
    String checkpointPath;
    try {
      dbPath=tempFolder.newFolder().getAbsolutePath();
      checkpointPath=tempFolder.newFolder().toURI().toString();
    }
 catch (    IOException e) {
      throw new FlinkRuntimeException("Failed to init rocksdb test state backend");
    }
    RocksDBStateBackend backend=new RocksDBStateBackend(new FsStateBackend(checkpointPath),TernaryBoolean.FALSE);
    backend.setDbStoragePath(dbPath);
    return backend;
  }
}
