private static class NonKeyedCombReducer implements CombineFunction<Tuple2<Integer,Boolean>,Tuple2<Integer,Boolean>>, GroupReduceFunction<Tuple2<Integer,Boolean>,Tuple2<Integer,Boolean>> {
  @Override public Tuple2<Integer,Boolean> combine(  Iterable<Tuple2<Integer,Boolean>> values) throws Exception {
    int sum=0;
    boolean flag=true;
    for (    Tuple2<Integer,Boolean> tuple : values) {
      sum+=tuple.f0;
      flag&=!tuple.f1;
    }
    return new Tuple2<>(sum,flag);
  }
  @Override public void reduce(  Iterable<Tuple2<Integer,Boolean>> values,  Collector<Tuple2<Integer,Boolean>> out) throws Exception {
    int sum=0;
    boolean flag=true;
    for (    Tuple2<Integer,Boolean> tuple : values) {
      sum+=tuple.f0;
      flag&=tuple.f1;
    }
    out.collect(new Tuple2<>(sum,flag));
  }
}
