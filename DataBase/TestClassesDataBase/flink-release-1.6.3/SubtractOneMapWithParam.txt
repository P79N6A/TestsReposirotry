@SuppressWarnings("serial") private static final class SubtractOneMapWithParam extends RichMapFunction<Integer,Integer> {
  private LongSumAggregatorWithParameter aggr;
  @Override public void open(  Configuration conf){
    aggr=getIterationRuntimeContext().getIterationAggregator(NEGATIVE_ELEMENTS_AGGR);
  }
  @Override public Integer map(  Integer value){
    Integer newValue=value - 1;
    if (newValue < aggr.getValue()) {
      aggr.aggregate(1L);
    }
    return newValue;
  }
}
