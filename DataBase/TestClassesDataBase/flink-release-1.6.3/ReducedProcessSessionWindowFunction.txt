private static class ReducedProcessSessionWindowFunction extends ProcessWindowFunction<Tuple2<String,Integer>,Tuple3<String,Long,Long>,String,TimeWindow> {
  private static final long serialVersionUID=1L;
  @Override public void process(  String key,  Context context,  Iterable<Tuple2<String,Integer>> values,  Collector<Tuple3<String,Long,Long>> out) throws Exception {
    TimeWindow window=context.window();
    for (    Tuple2<String,Integer> val : values) {
      out.collect(new Tuple3<>(key + "-" + val.f1,window.getStart(),window.getEnd()));
    }
  }
}
