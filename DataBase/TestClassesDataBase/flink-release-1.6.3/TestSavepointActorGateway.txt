private static class TestSavepointActorGateway extends TestActorGateway<JobManagerMessages.TriggerSavepoint,JobManagerMessages.TriggerSavepointSuccess> {
  private static final long serialVersionUID=-2843143535044413148L;
  private final JobID expectedJobID;
  private final String expectedTargetDirectory;
  private final String savepointPathToReturn;
  private TestSavepointActorGateway(  JobID expectedJobID,  String expectedTargetDirectory,  String savepointPathToReturn){
    super(JobManagerMessages.TriggerSavepoint.class);
    this.expectedJobID=expectedJobID;
    this.expectedTargetDirectory=expectedTargetDirectory;
    this.savepointPathToReturn=savepointPathToReturn;
  }
  @Override public JobManagerMessages.TriggerSavepointSuccess process(  JobManagerMessages.TriggerSavepoint message){
    Assert.assertEquals(expectedJobID,message.jobId());
    if (expectedTargetDirectory == null) {
      Assert.assertTrue(message.savepointDirectory().isEmpty());
    }
 else {
      Assert.assertEquals(expectedTargetDirectory,message.savepointDirectory().get());
    }
    return new JobManagerMessages.TriggerSavepointSuccess(message.jobId(),0,savepointPathToReturn,0);
  }
}
