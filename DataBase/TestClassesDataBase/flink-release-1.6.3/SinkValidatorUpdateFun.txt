static class SinkValidatorUpdateFun implements ValidatingSink.CountUpdater<Tuple4<Long,Long,Long,IntType>> {
  private final int elementsPerKey;
  SinkValidatorUpdateFun(  int elementsPerKey){
    this.elementsPerKey=elementsPerKey;
  }
  @Override public void updateCount(  Tuple4<Long,Long,Long,IntType> value,  Map<Long,Integer> windowCounts){
    int expectedSum=0;
    long countUntil=Math.min(value.f2,elementsPerKey);
    for (long i=value.f1; i < countUntil; i++) {
      if (i > 0) {
        expectedSum+=i;
      }
    }
    assertEquals("Window start: " + value.f1 + " end: "+ value.f2,expectedSum,value.f3.value);
    windowCounts.merge(value.f0,1,(val,increment) -> val + increment);
  }
}
