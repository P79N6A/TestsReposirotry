private static final class FailingCompletedCheckpointStore implements CompletedCheckpointStore {
  @Override public void recover() throws Exception {
    throw new UnsupportedOperationException("Not implemented.");
  }
  @Override public void addCheckpoint(  CompletedCheckpoint checkpoint) throws Exception {
    throw new Exception("The failing completed checkpoint store failed again... :-(");
  }
  @Override public CompletedCheckpoint getLatestCheckpoint() throws Exception {
    throw new UnsupportedOperationException("Not implemented.");
  }
  @Override public void shutdown(  JobStatus jobStatus) throws Exception {
    throw new UnsupportedOperationException("Not implemented.");
  }
  @Override public List<CompletedCheckpoint> getAllCheckpoints() throws Exception {
    throw new UnsupportedOperationException("Not implemented.");
  }
  @Override public int getNumberOfRetainedCheckpoints(){
    return -1;
  }
  @Override public int getMaxNumberOfRetainedCheckpoints(){
    return 1;
  }
  @Override public boolean requiresExternalizedCheckpoints(){
    return false;
  }
}
