/** 
 * A  {@link IndexRequestBuilder} with equivalent functionality to {@link SourceSinkDataTestKit.TestElasticsearchSinkFunction}.
 */
private static class TestIndexRequestBuilder implements IndexRequestBuilder<Tuple2<Integer,String>> {
  private static final long serialVersionUID=1L;
  private final String index;
  public TestIndexRequestBuilder(  String index){
    this.index=index;
  }
  @Override public IndexRequest createIndexRequest(  Tuple2<Integer,String> element,  RuntimeContext ctx){
    Map<String,Object> json=new HashMap<>();
    json.put("data",element.f1);
    return Requests.indexRequest().index(index).type("flink-es-test-type").id(element.f0.toString()).source(json);
  }
}
