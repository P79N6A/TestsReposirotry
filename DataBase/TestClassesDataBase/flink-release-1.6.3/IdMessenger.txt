@SuppressWarnings("serial") private static final class IdMessenger extends ScatterFunction<Long,Boolean,Long,Long> {
  @Override public void sendMessages(  Vertex<Long,Boolean> vertex) throws Exception {
    for (    Edge<Long,Long> edge : getEdges()) {
      if (!edge.getSource().equals(vertex.getId())) {
        sendMessageTo(edge.getSource(),vertex.getId());
      }
 else {
        sendMessageTo(edge.getTarget(),vertex.getId());
      }
    }
  }
}
