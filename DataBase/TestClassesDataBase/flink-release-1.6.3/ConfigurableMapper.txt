/** 
 * {@link Mapper} that filters records based on a prefix.
 */
public static class ConfigurableMapper implements Mapper<IntWritable,Text,IntWritable,Text> {
  private String filterPrefix;
  @Override public void map(  IntWritable k,  Text v,  OutputCollector<IntWritable,Text> out,  Reporter r) throws IOException {
    if (v.toString().startsWith(filterPrefix)) {
      out.collect(k,v);
    }
  }
  @Override public void configure(  JobConf c){
    filterPrefix=c.get("my.filterPrefix");
  }
  @Override public void close() throws IOException {
  }
}
