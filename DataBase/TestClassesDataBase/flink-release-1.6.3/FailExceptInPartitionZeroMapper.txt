private static class FailExceptInPartitionZeroMapper extends RichMapFunction<Long,Long> {
  @Override public Long map(  Long value) throws Exception {
    if (getRuntimeContext().getIndexOfThisSubtask() == 0) {
      return value;
    }
 else {
      throw new Exception("Received data in a partition other than partition 0");
    }
  }
}
