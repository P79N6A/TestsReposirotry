private static class MockRichFlatJoinFunction extends RichFlatJoinFunction<String,String,String> {
  final AtomicBoolean opened=new AtomicBoolean(false);
  final AtomicBoolean closed=new AtomicBoolean(false);
  @Override public void open(  Configuration parameters) throws Exception {
    opened.compareAndSet(false,true);
    assertEquals(0,getRuntimeContext().getIndexOfThisSubtask());
    assertEquals(1,getRuntimeContext().getNumberOfParallelSubtasks());
  }
  @Override public void close() throws Exception {
    closed.compareAndSet(false,true);
  }
  @Override public void join(  String first,  String second,  Collector<String> out) throws Exception {
    out.collect(String.valueOf(first) + ',' + String.valueOf(second));
  }
}
