private static class SlowlyDeserializingOperator extends StreamSource<Long,SourceFunction<Long>> {
  private static final long serialVersionUID=1L;
  private volatile boolean canceled=false;
  public SlowlyDeserializingOperator(){
    super(new MockSourceFunction());
  }
  @Override public void run(  Object lockingObject,  StreamStatusMaintainer streamStatusMaintainer,  Output<StreamRecord<Long>> collector) throws Exception {
    while (!canceled) {
      try {
        Thread.sleep(500);
      }
 catch (      InterruptedException ignored) {
      }
    }
  }
  @Override public void cancel(){
    canceled=true;
  }
  private void readObject(  ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();
    long delay=500;
    long deadline=System.currentTimeMillis() + delay;
    do {
      try {
        Thread.sleep(delay);
      }
 catch (      InterruptedException ignored) {
      }
    }
 while ((delay=deadline - System.currentTimeMillis()) > 0);
  }
}
