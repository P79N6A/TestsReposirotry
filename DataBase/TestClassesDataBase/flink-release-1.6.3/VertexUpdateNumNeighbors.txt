@SuppressWarnings("serial") private static final class VertexUpdateNumNeighbors extends GatherFunction<Long,Boolean,Long> {
  @Override public void updateVertex(  Vertex<Long,Boolean> vertex,  MessageIterator<Long> messages) throws Exception {
    long count=0;
    for (    @SuppressWarnings("unused") long msg : messages) {
      count++;
    }
    setNewVertexValue(count == (getInDegree() + getOutDegree()));
  }
}
