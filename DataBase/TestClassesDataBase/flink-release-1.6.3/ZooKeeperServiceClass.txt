private static final class ZooKeeperServiceClass implements ServiceClass {
  private TestingServer testingServer;
  private CuratorFramework client;
  private Configuration configuration;
  @Override public void setup() throws Exception {
    try {
      testingServer=new TestingServer();
    }
 catch (    Exception e) {
      throw new RuntimeException("Could not start ZooKeeper testing cluster.",e);
    }
    configuration=new Configuration();
    configuration.setString(HighAvailabilityOptions.HA_ZOOKEEPER_QUORUM,testingServer.getConnectString());
    configuration.setString(HighAvailabilityOptions.HA_MODE,"zookeeper");
    client=ZooKeeperUtils.startCuratorFramework(configuration);
  }
  @Override public void teardown() throws Exception {
    if (client != null) {
      client.close();
      client=null;
    }
    if (testingServer != null) {
      testingServer.stop();
      testingServer=null;
    }
  }
  @Override public LeaderElectionService createLeaderElectionService() throws Exception {
    return ZooKeeperUtils.createLeaderElectionService(client,configuration);
  }
}
