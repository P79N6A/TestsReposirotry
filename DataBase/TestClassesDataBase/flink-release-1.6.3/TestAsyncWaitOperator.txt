/** 
 * Testing async wait operator which introduces a latch to synchronize the execution with the emitter.
 */
private static final class TestAsyncWaitOperator<IN,OUT> extends AsyncWaitOperator<IN,OUT> {
  private static final long serialVersionUID=-8528791694746625560L;
  private final transient OneShotLatch closingLatch;
  public TestAsyncWaitOperator(  AsyncFunction<IN,OUT> asyncFunction,  long timeout,  int capacity,  AsyncDataStream.OutputMode outputMode,  OneShotLatch closingLatch){
    super(asyncFunction,timeout,capacity,outputMode);
    this.closingLatch=Preconditions.checkNotNull(closingLatch);
  }
  @Override public void close() throws Exception {
    closingLatch.trigger();
    checkpointingLock.notifyAll();
    super.close();
  }
}
