/** 
 * A  {@link KeyedSerializationSchemaWrapper} that supports routing serialized records to different target topics.
 */
public static class CustomKeyedSerializationSchemaWrapper extends KeyedSerializationSchemaWrapper<Tuple2<Long,String>> {
  private final String defaultTopic;
  private final String dynamicTopic;
  public CustomKeyedSerializationSchemaWrapper(  SerializationSchema<Tuple2<Long,String>> serializationSchema,  String defaultTopic,  String dynamicTopic){
    super(serializationSchema);
    this.defaultTopic=Preconditions.checkNotNull(defaultTopic);
    this.dynamicTopic=Preconditions.checkNotNull(dynamicTopic);
  }
  @Override public String getTargetTopic(  Tuple2<Long,String> element){
    return (element.f0 % 2 == 0) ? defaultTopic : dynamicTopic;
  }
}
