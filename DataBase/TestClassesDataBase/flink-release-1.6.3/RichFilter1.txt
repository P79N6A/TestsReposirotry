private static class RichFilter1 extends RichFilterFunction<Tuple3<Integer,Long,String>> {
  private static final long serialVersionUID=1L;
  int literal=-1;
  @Override public void open(  Configuration config){
    Collection<Integer> ints=this.getRuntimeContext().getBroadcastVariable("ints");
    for (    int i : ints) {
      literal=literal < i ? i : literal;
    }
  }
  @Override public boolean filter(  Tuple3<Integer,Long,String> value) throws Exception {
    return value.f0 < literal;
  }
}
