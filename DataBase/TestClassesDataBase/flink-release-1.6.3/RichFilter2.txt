private static class RichFilter2 extends RichFilterFunction<Tuple3<Integer,Long,String>> {
  private static final long serialVersionUID=1L;
  private int broadcastSum=0;
  @Override public void open(  Configuration config){
    Collection<Integer> ints=this.getRuntimeContext().getBroadcastVariable("ints");
    for (    Integer i : ints) {
      broadcastSum+=i;
    }
  }
  @Override public boolean filter(  Tuple3<Integer,Long,String> value) throws Exception {
    return (value.f1 == (broadcastSum / 11));
  }
}
