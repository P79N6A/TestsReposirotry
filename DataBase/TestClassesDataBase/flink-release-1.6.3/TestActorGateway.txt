/** 
 * Utility class for hiding akka/scala details.
 * @param < M > expected type of incoming requests
 * @param < R > type of outgoing requests
 */
private abstract static class TestActorGateway<M,R> extends DummyActorGateway {
  private static final long serialVersionUID=-2794537151425694085L;
  private final Class<M> messageClass;
  volatile boolean messageArrived=false;
  TestActorGateway(  Class<M> messageClass){
    this.messageClass=messageClass;
  }
  @Override @SuppressWarnings("unchecked") public Future<Object> ask(  Object message,  FiniteDuration timeout){
    messageArrived=true;
    if (message.getClass().isAssignableFrom(messageClass)) {
      return Future$.MODULE$.successful(process((M)message));
    }
    fail("Expected TriggerSavepoint message, got: " + message.getClass());
    return null;
  }
  /** 
 * Processes the incoming message and verifies it's correctness. Implementations may directly throw unchecked exceptions (like JUnit asserts) in case of errors or faulty behaviors.
 * @param message incoming message
 * @return response in case of success
 */
  public abstract R process(  M message);
}
