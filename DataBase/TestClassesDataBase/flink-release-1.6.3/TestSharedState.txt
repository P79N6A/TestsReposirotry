private static class TestSharedState implements StreamStateHandle {
  private static final long serialVersionUID=4468635881465159780L;
  private SharedStateRegistryKey key;
  private boolean discarded;
  TestSharedState(  String key){
    this.key=new SharedStateRegistryKey(key);
    this.discarded=false;
  }
  public SharedStateRegistryKey getRegistrationKey(){
    return key;
  }
  @Override public void discardState() throws Exception {
    this.discarded=true;
  }
  @Override public long getStateSize(){
    return key.toString().length();
  }
  @Override public int hashCode(){
    return key.hashCode();
  }
  @Override public FSDataInputStream openInputStream() throws IOException {
    throw new UnsupportedOperationException();
  }
  public boolean isDiscarded(){
    return discarded;
  }
}
