public static class MockCombiningReduceStub implements GroupReduceFunction<Record,Record>, GroupCombineFunction<Record,Record> {
  private static final long serialVersionUID=1L;
  private final IntValue key=new IntValue();
  private final IntValue value=new IntValue();
  private final IntValue combineValue=new IntValue();
  @Override public void reduce(  Iterable<Record> records,  Collector<Record> out){
    Record element=null;
    int sum=0;
    for (    Record next : records) {
      element=next;
      element.getField(1,this.value);
      sum+=this.value.getValue();
    }
    element.getField(0,this.key);
    this.value.setValue(sum - this.key.getValue());
    element.setField(1,this.value);
    out.collect(element);
  }
  @Override public void combine(  Iterable<Record> records,  Collector<Record> out){
    Record element=null;
    int sum=0;
    for (    Record next : records) {
      element=next;
      element.getField(1,this.combineValue);
      sum+=this.combineValue.getValue();
    }
    this.combineValue.setValue(sum);
    element.setField(1,this.combineValue);
    out.collect(element);
  }
}
