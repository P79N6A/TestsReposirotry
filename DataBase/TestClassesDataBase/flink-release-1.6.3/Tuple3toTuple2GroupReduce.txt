private static class Tuple3toTuple2GroupReduce implements KvGroupReduce<Long,Tuple3<Integer,Long,String>,Tuple2<Integer,Long>,Tuple2<Integer,Long>> {
  @Override public void combine(  Iterable<Tuple2<Long,Tuple3<Integer,Long,String>>> values,  Collector<Tuple2<Long,Tuple2<Integer,Long>>> out) throws Exception {
    int i=0;
    long l=0;
    long key=0;
    for (    Tuple2<Long,Tuple3<Integer,Long,String>> value : values) {
      key=value.f0;
      Tuple3<Integer,Long,String> extracted=value.f1;
      i+=extracted.f0;
      l+=extracted.f1 + extracted.f2.length();
    }
    Tuple2<Integer,Long> result=new Tuple2<>(i,l);
    out.collect(new Tuple2<>(key,result));
  }
  @Override public void reduce(  Iterable<Tuple2<Long,Tuple2<Integer,Long>>> values,  Collector<Tuple2<Long,Tuple2<Integer,Long>>> out) throws Exception {
    new Tuple2toTuple2GroupReduce().reduce(values,out);
  }
}
