private static class MemorySinkFunction implements SinkFunction<Integer> {
  private static Map<Integer,Collection<Integer>> collections=new ConcurrentHashMap<>();
  private static final long serialVersionUID=-8815570195074103860L;
  private final int key;
  public MemorySinkFunction(  int key){
    this.key=key;
  }
  @Override public void invoke(  Integer value) throws Exception {
    Collection<Integer> collection=collections.get(key);
synchronized (collection) {
      collection.add(value);
    }
  }
  public static void registerCollection(  int key,  Collection<Integer> collection){
    collections.put(key,collection);
  }
  public static void clear(){
    collections.clear();
  }
}
