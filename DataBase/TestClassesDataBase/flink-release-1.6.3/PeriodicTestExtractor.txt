private static class PeriodicTestExtractor implements AssignerWithPeriodicWatermarks<Long> {
  private volatile long maxTimestamp=Long.MIN_VALUE;
  @Override public long extractTimestamp(  Long element,  long previousElementTimestamp){
    maxTimestamp=Math.max(maxTimestamp,element);
    return element;
  }
  @Nullable @Override public Watermark getCurrentWatermark(){
    return new Watermark(maxTimestamp);
  }
}
