private static class StreamWriterWithConfigCheck<K,V> extends AvroKeyValueSinkWriter<K,V> {
  private Map<String,String> properties;
  private String key;
  private String expect;
  public StreamWriterWithConfigCheck(  Map<String,String> properties,  String key,  String expect){
    super(properties);
    this.properties=properties;
    this.key=key;
    this.expect=expect;
  }
  @Override public void open(  FileSystem fs,  Path path) throws IOException {
    super.open(fs,path);
    Assert.assertEquals(expect,fs.getConf().get(key));
  }
  @Override public StreamWriterWithConfigCheck<K,V> duplicate(){
    return new StreamWriterWithConfigCheck<>(properties,key,expect);
  }
}
