@SuppressWarnings("serial") private static final class SelectNeighborsValueGreaterThanFour implements EdgesFunctionWithVertexValue<Long,Long,Long,Tuple2<Long,Long>> {
  @Override public void iterateEdges(  Vertex<Long,Long> v,  Iterable<Edge<Long,Long>> edges,  Collector<Tuple2<Long,Long>> out) throws Exception {
    for (    Edge<Long,Long> edge : edges) {
      if (v.getValue() > 4) {
        if (v.getId().equals(edge.getTarget())) {
          out.collect(new Tuple2<>(v.getId(),edge.getSource()));
        }
 else {
          out.collect(new Tuple2<>(v.getId(),edge.getTarget()));
        }
      }
    }
  }
}
