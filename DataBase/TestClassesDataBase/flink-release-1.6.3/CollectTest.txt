/** 
 * Tests for  {@link Collect}.
 */
public class CollectTest {
  private ExecutionEnvironment env;
  @Before public void setup() throws Exception {
    env=ExecutionEnvironment.createCollectionsEnvironment();
    env.getConfig().enableObjectReuse();
  }
  @Test public void testList() throws Exception {
    List<Long> list=Arrays.asList(ArrayUtils.toObject(new long[]{0,1,2,3,4,5,6,7,8,9}));
    DataSet<Long> dataset=env.fromCollection(list);
    List<Long> collected=new Collect<Long>().run(dataset).execute();
    assertArrayEquals(list.toArray(),collected.toArray());
  }
  @Test public void testEmptyList() throws Exception {
    DataSet<Long> dataset=env.fromCollection(Collections.emptyList(),Types.LONG);
    List<Long> collected=new Collect<Long>().run(dataset).execute();
    assertEquals(0,collected.size());
  }
}
