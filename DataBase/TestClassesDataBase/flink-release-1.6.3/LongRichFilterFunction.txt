/** 
 * Filter on Long values supposedly letting all values through. As an implementation for the  {@link CheckpointListener} interface it stores all the checkpoint idsit has seen in a static list.
 */
private static class LongRichFilterFunction extends RichFilterFunction<Long> implements CheckpointListener {
  static final List<Long>[] COMPLETED_CHECKPOINTS=createCheckpointLists(PARALLELISM);
  private volatile boolean notificationAlready;
  @Override public boolean filter(  Long value){
    return value < 100;
  }
  @Override public void notifyCheckpointComplete(  long checkpointId){
    int partition=getRuntimeContext().getIndexOfThisSubtask();
    COMPLETED_CHECKPOINTS[partition].add(checkpointId);
    if (OnceFailingReducer.hasFailed && !notificationAlready) {
      notificationAlready=true;
      GeneratingSourceFunction.numPostFailureNotifications.incrementAndGet();
    }
  }
}
