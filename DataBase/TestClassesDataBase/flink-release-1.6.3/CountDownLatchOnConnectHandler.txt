private static class CountDownLatchOnConnectHandler extends ChannelOutboundHandlerAdapter {
  private final CountDownLatch syncOnConnect;
  public CountDownLatchOnConnectHandler(  CountDownLatch syncOnConnect){
    this.syncOnConnect=syncOnConnect;
  }
  @Override public void connect(  ChannelHandlerContext ctx,  SocketAddress remoteAddress,  SocketAddress localAddress,  ChannelPromise promise) throws Exception {
    syncOnConnect.countDown();
  }
}
