private static class SessionWindowFunction implements WindowFunction<Tuple2<String,Integer>,Tuple3<String,Long,Long>,String,TimeWindow> {
  private static final long serialVersionUID=1L;
  @Override public void apply(  String key,  TimeWindow window,  Iterable<Tuple2<String,Integer>> values,  Collector<Tuple3<String,Long,Long>> out) throws Exception {
    int sum=0;
    for (    Tuple2<String,Integer> i : values) {
      sum+=i.f1;
    }
    String resultString=key + "-" + sum;
    out.collect(new Tuple3<>(resultString,window.getStart(),window.getEnd()));
  }
}
