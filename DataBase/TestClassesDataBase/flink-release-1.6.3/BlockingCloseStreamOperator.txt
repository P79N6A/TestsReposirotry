private static class BlockingCloseStreamOperator extends AbstractStreamOperator<Void> {
  private static final long serialVersionUID=-9042150529568008847L;
  public static final OneShotLatch IN_CLOSE=new OneShotLatch();
  public static final OneShotLatch FINISH_CLOSE=new OneShotLatch();
  @Override public void close() throws Exception {
    IN_CLOSE.trigger();
    FINISH_CLOSE.await();
    super.close();
  }
}
