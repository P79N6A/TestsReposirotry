private static class DefaultBufferResultSubpartitionView extends NoOpResultSubpartitionView {
  /** 
 * Number of buffer in the backlog to report with every  {@link #getNextBuffer()} call. 
 */
  private final AtomicInteger buffersInBacklog;
  private DefaultBufferResultSubpartitionView(  int buffersInBacklog){
    this.buffersInBacklog=new AtomicInteger(buffersInBacklog);
  }
  @Nullable @Override public BufferAndBacklog getNextBuffer(){
    int buffers=buffersInBacklog.decrementAndGet();
    return new BufferAndBacklog(TestBufferFactory.createBuffer(10),buffers > 0,buffers,false);
  }
  @Override public boolean isAvailable(){
    return buffersInBacklog.get() > 0;
  }
}
