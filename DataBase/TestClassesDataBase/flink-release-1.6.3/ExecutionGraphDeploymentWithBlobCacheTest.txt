/** 
 * Tests  {@link ExecutionGraph} deployment when offloading job and task information into the BLOBserver.
 */
public class ExecutionGraphDeploymentWithBlobCacheTest extends ExecutionGraphDeploymentWithBlobServerTest {
  @Before @Override public void setupBlobServer() throws IOException {
    Configuration config=new Configuration();
    config.setInteger(BlobServerOptions.OFFLOAD_MINSIZE,0);
    blobServer=new BlobServer(config,new VoidBlobStore());
    blobServer.start();
    blobWriter=blobServer;
    InetSocketAddress serverAddress=new InetSocketAddress("localhost",blobServer.getPort());
    blobCache=new PermanentBlobCache(config,new VoidBlobStore(),serverAddress);
  }
  @After @Override public void shutdownBlobServer() throws IOException {
    if (blobServer != null) {
      blobServer.close();
    }
  }
}
