private static class CustomPartitioner extends FlinkKafkaPartitioner<Tuple2<Long,String>> implements Serializable {
  private final Map<String,Integer> expectedTopicsToNumPartitions;
  public CustomPartitioner(  Map<String,Integer> expectedTopicsToNumPartitions){
    this.expectedTopicsToNumPartitions=expectedTopicsToNumPartitions;
  }
  @Override public int partition(  Tuple2<Long,String> next,  byte[] serializedKey,  byte[] serializedValue,  String topic,  int[] partitions){
    assertEquals(expectedTopicsToNumPartitions.get(topic).intValue(),partitions.length);
    return (int)(next.f0 % partitions.length);
  }
}
