private static final class RunTestingCliFrontend extends CliFrontend {
  private final int expectedParallelism;
  private final boolean sysoutLogging;
  private final boolean isDetached;
  private RunTestingCliFrontend(  AbstractCustomCommandLine<?> cli,  int expectedParallelism,  boolean logging,  boolean isDetached) throws Exception {
    super(cli.getConfiguration(),Collections.singletonList(cli));
    this.expectedParallelism=expectedParallelism;
    this.sysoutLogging=logging;
    this.isDetached=isDetached;
  }
  @Override protected void executeProgram(  PackagedProgram program,  ClusterClient client,  int parallelism){
    assertEquals(isDetached,client.isDetached());
    assertEquals(sysoutLogging,client.getPrintStatusDuringExecution());
    assertEquals(expectedParallelism,parallelism);
  }
}
