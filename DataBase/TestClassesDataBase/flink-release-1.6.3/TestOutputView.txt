private static final class TestOutputView extends AbstractPagedOutputView {
  private final List<SegmentWithPosition> segments=new ArrayList<>();
  private final int segmentSize;
  private TestOutputView(  int segmentSize){
    super(MemorySegmentFactory.allocateUnpooledSegment(segmentSize),segmentSize,0);
    this.segmentSize=segmentSize;
  }
  @Override protected MemorySegment nextSegment(  MemorySegment current,  int positionInCurrent) throws IOException {
    segments.add(new SegmentWithPosition(current,positionInCurrent));
    return MemorySegmentFactory.allocateUnpooledSegment(segmentSize);
  }
  public void close(){
    segments.add(new SegmentWithPosition(getCurrentSegment(),getCurrentPositionInSegment()));
  }
}
