private static final class StartStopNotifyingLeaderRetrievalService implements LeaderRetrievalService {
  private final CompletableFuture<LeaderRetrievalListener> startFuture;
  private final CompletableFuture<Void> stopFuture;
  private StartStopNotifyingLeaderRetrievalService(  CompletableFuture<LeaderRetrievalListener> startFuture,  CompletableFuture<Void> stopFuture){
    this.startFuture=startFuture;
    this.stopFuture=stopFuture;
  }
  @Override public void start(  LeaderRetrievalListener listener) throws Exception {
    startFuture.complete(listener);
  }
  @Override public void stop() throws Exception {
    stopFuture.complete(null);
  }
}
