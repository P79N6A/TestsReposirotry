/** 
 * Invokable that forwards incoming records. <p>NOTE: needs to be <tt>public</tt> so that a task can be run with this!
 */
public static class SpeedTestForwarder extends AbstractInvokable {
  public SpeedTestForwarder(  Environment environment){
    super(environment);
  }
  @Override public void invoke() throws Exception {
    RecordReader<SpeedTestRecord> reader=new RecordReader<>(getEnvironment().getInputGate(0),SpeedTestRecord.class,getEnvironment().getTaskManagerInfo().getTmpDirectories());
    RecordWriter<SpeedTestRecord> writer=new RecordWriter<>(getEnvironment().getWriter(0));
    try {
      SpeedTestRecord record;
      while ((record=reader.next()) != null) {
        writer.emit(record);
      }
    }
  finally {
      reader.clearBuffers();
      writer.clearBuffers();
      writer.flushAll();
    }
  }
}
