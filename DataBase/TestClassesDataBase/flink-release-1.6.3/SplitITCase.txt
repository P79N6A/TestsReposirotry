/** 
 * Tests for split examples.
 */
public class SplitITCase extends AbstractTestBase {
  private String output;
  @Before public void prepare() throws IOException {
    output=getTempFilePath("dummy").split(":")[1];
  }
  @After public void cleanUp() throws IOException {
    deleteRecursively(new File(output));
  }
  @Test public void testEmbeddedSpout() throws Exception {
    SpoutSplitExample.main(new String[]{"0",output});
    Assert.assertFalse(VerifyAndEnrichBolt.errorOccured);
    Assert.assertFalse(Enrich.errorOccured);
  }
  @Test public void testSpoutSplitTopology() throws Exception {
    SplitStreamSpoutLocal.main(new String[]{"0",output});
    Assert.assertFalse(VerifyAndEnrichBolt.errorOccured);
  }
  @Test public void testBoltSplitTopology() throws Exception {
    SplitStreamBoltLocal.main(new String[]{"0",output});
    Assert.assertFalse(VerifyAndEnrichBolt.errorOccured);
  }
}
