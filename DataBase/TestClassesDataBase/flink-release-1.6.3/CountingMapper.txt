@SuppressWarnings("serial") private static class CountingMapper extends RichMapFunction<Long,Long> {
  private IntCounter accumulator;
  @Override public void open(  Configuration parameters){
    accumulator=getRuntimeContext().getIntCounter(ACCUMULATOR_NAME);
  }
  @Override public Long map(  Long value){
    accumulator.add(1);
    return value;
  }
}
