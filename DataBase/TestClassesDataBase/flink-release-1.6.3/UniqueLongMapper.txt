private static class UniqueLongMapper implements MapPartitionFunction<Long,Long> {
  private static final long serialVersionUID=1L;
  @Override public void mapPartition(  Iterable<Long> longs,  Collector<Long> out) throws Exception {
    HashSet<Long> uniq=new HashSet<>();
    for (    Long l : longs) {
      uniq.add(l);
    }
    for (    Long l : uniq) {
      out.collect(l);
    }
  }
}
