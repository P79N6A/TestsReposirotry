private class NonContinousOffsetsDeserializationSchema implements KeyedDeserializationSchema<String> {
  private int numJumps;
  long nextExpected=0;
  @Override public String deserialize(  byte[] messageKey,  byte[] message,  String topic,  int partition,  long offset) throws IOException {
    if (offset != nextExpected) {
      numJumps++;
      nextExpected=offset;
      LOG.info("Registered now jump at offset {}",offset);
    }
    nextExpected++;
    try {
      Thread.sleep(10);
    }
 catch (    InterruptedException e) {
      throw new RuntimeException("Stopping it");
    }
    return "";
  }
  @Override public boolean isEndOfStream(  String nextElement){
    if (numJumps >= 5) {
      stopProducer=true;
      return true;
    }
    return false;
  }
  @Override public TypeInformation<String> getProducedType(){
    return Types.STRING;
  }
}
