/** 
 * Tests for the FlinkMeterWrapper.
 */
public class FlinkMeterWrapperTest {
  private static final double DELTA=0.0001;
  @Test public void testWrapper(){
    Meter meter=new TestMeter();
    FlinkMeterWrapper wrapper=new FlinkMeterWrapper(meter);
    assertEquals(0,wrapper.getMeanRate(),DELTA);
    assertEquals(5,wrapper.getOneMinuteRate(),DELTA);
    assertEquals(0,wrapper.getFiveMinuteRate(),DELTA);
    assertEquals(0,wrapper.getFifteenMinuteRate(),DELTA);
    assertEquals(100L,wrapper.getCount());
  }
  @Test public void testMarkOneEvent(){
    Meter meter=mock(Meter.class);
    FlinkMeterWrapper wrapper=new FlinkMeterWrapper(meter);
    wrapper.mark();
    verify(meter).markEvent();
  }
  @Test public void testMarkSeveralEvents(){
    Meter meter=mock(Meter.class);
    FlinkMeterWrapper wrapper=new FlinkMeterWrapper(meter);
    wrapper.mark(5);
    verify(meter).markEvent(5);
  }
}
