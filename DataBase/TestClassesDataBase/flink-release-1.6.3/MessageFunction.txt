@SuppressWarnings("serial") private static final class MessageFunction extends ScatterFunction<Long,Long,Long,Long> {
  @Override public void preSuperstep(){
    @SuppressWarnings("unchecked") List<Integer> bcastSet=(List<Integer>)(List<?>)getBroadcastSet("messagingBcastSet");
    Assert.assertEquals(4,bcastSet.get(0).intValue());
    Assert.assertEquals(5,bcastSet.get(1).intValue());
    Assert.assertEquals(6,bcastSet.get(2).intValue());
    Assert.assertEquals(5,getNumberOfVertices());
    if (getSuperstepNumber() == 2) {
      long aggrValue=((LongValue)getPreviousIterationAggregate("superstepAggregator")).getValue();
      Assert.assertEquals(5,aggrValue);
    }
  }
  @Override public void sendMessages(  Vertex<Long,Long> vertex){
    sendMessageToAllNeighbors(vertex.getValue());
  }
}
