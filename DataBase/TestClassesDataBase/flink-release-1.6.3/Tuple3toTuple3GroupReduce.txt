private static class Tuple3toTuple3GroupReduce implements KvGroupReduce<Long,Tuple3<Integer,Long,String>,Tuple3<Integer,Long,String>,Tuple3<Integer,Long,String>> {
  @Override public void combine(  Iterable<Tuple2<Long,Tuple3<Integer,Long,String>>> values,  Collector<Tuple2<Long,Tuple3<Integer,Long,String>>> out) throws Exception {
    int i=0;
    long l=0;
    long key=0;
    for (    Tuple2<Long,Tuple3<Integer,Long,String>> value : values) {
      key=value.f0;
      Tuple3<Integer,Long,String> extracted=value.f1;
      i+=extracted.f0;
      l+=extracted.f1;
    }
    Tuple3<Integer,Long,String> result=new Tuple3<>(i,l,"combined");
    out.collect(new Tuple2<>(key,result));
  }
  @Override public void reduce(  Iterable<Tuple2<Long,Tuple3<Integer,Long,String>>> values,  Collector<Tuple2<Long,Tuple3<Integer,Long,String>>> out) throws Exception {
    combine(values,out);
  }
}
