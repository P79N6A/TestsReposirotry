private static class UniqueNestedPojoLongMapper implements MapPartitionFunction<POJO,Long> {
  private static final long serialVersionUID=1L;
  @Override public void mapPartition(  Iterable<POJO> records,  Collector<Long> out) throws Exception {
    HashSet<Long> uniq=new HashSet<>();
    for (    POJO t : records) {
      uniq.add(t.nestedPojo.longNumber);
    }
    for (    Long l : uniq) {
      out.collect(l);
    }
  }
}
