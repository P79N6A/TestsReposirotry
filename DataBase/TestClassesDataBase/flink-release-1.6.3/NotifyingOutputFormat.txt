/** 
 * Outputs format which notifies of accumulator changes and waits for the previous mapper.
 */
private static class NotifyingOutputFormat implements OutputFormat<Integer> {
  private static final long serialVersionUID=1L;
  @Override public void configure(  Configuration parameters){
  }
  @Override public void open(  int taskNumber,  int numTasks) throws IOException {
    while (!NotifyingMapper.finished) {
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
      }
    }
    notifyTaskManagerOfAccumulatorUpdate();
  }
  @Override public void writeRecord(  Integer record) throws IOException {
    notifyTaskManagerOfAccumulatorUpdate();
  }
  @Override public void close() throws IOException {
  }
}
