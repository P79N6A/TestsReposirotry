@SuppressWarnings("serial") public static final class MockFailingJoinStub implements FlatJoinFunction<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>,Tuple2<Integer,Integer>> {
  private int cnt=0;
  @Override public void join(  Tuple2<Integer,Integer> first,  Tuple2<Integer,Integer> second,  Collector<Tuple2<Integer,Integer>> out) throws Exception {
    if (++this.cnt >= 10) {
      throw new ExpectedTestException();
    }
    out.collect(first != null ? first : second);
  }
}
