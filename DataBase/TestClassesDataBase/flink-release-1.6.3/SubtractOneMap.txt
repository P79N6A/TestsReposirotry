@SuppressWarnings("serial") private static final class SubtractOneMap extends RichMapFunction<Integer,Integer> {
  private LongSumAggregator aggr;
  @Override public void open(  Configuration conf){
    aggr=getIterationRuntimeContext().getIterationAggregator(NEGATIVE_ELEMENTS_AGGR);
  }
  @Override public Integer map(  Integer value){
    Integer newValue=value - 1;
    if (newValue < 0) {
      aggr.aggregate(1L);
    }
    return newValue;
  }
}
