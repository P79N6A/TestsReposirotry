private static class Tuple5CoGroupBC extends RichCoGroupFunction<Tuple5<Integer,Long,Integer,String,Long>,Tuple5<Integer,Long,Integer,String,Long>,Tuple3<Integer,Integer,Integer>> {
  private static final long serialVersionUID=1L;
  private int broadcast=42;
  @Override public void open(  Configuration config){
    Collection<Integer> ints=this.getRuntimeContext().getBroadcastVariable("ints");
    int sum=0;
    for (    Integer i : ints) {
      sum+=i;
    }
    broadcast=sum;
  }
  @Override public void coGroup(  Iterable<Tuple5<Integer,Long,Integer,String,Long>> first,  Iterable<Tuple5<Integer,Long,Integer,String,Long>> second,  Collector<Tuple3<Integer,Integer,Integer>> out){
    int sum=0;
    int id=0;
    for (    Tuple5<Integer,Long,Integer,String,Long> element : first) {
      sum+=element.f2;
      id=element.f0;
    }
    for (    Tuple5<Integer,Long,Integer,String,Long> element : second) {
      sum+=element.f2;
      id=element.f0;
    }
    out.collect(new Tuple3<Integer,Integer,Integer>(id,sum,broadcast));
  }
}
