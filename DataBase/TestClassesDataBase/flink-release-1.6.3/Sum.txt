@SuppressWarnings("serial") private static final class Sum extends SumFunction<Long,Long,Long> {
  LongSumAggregator aggregator=new LongSumAggregator();
  @Override public void preSuperstep(){
    @SuppressWarnings("unchecked") List<Integer> bcastSet=(List<Integer>)(List<?>)getBroadcastSet("sumBcastSet");
    Assert.assertEquals(4,bcastSet.get(0).intValue());
    Assert.assertEquals(5,bcastSet.get(1).intValue());
    Assert.assertEquals(6,bcastSet.get(2).intValue());
    aggregator=getIterationAggregator("superstepAggregator");
    Assert.assertEquals(5,getNumberOfVertices());
  }
  public Long sum(  Long newValue,  Long currentValue){
    long superstep=getSuperstepNumber();
    aggregator.aggregate(superstep);
    return 0L;
  }
}
