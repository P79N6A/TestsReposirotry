/** 
 * A  {@link BulkWriter} used for the tests.
 */
private static class TestBulkWriter implements BulkWriter<Tuple2<String,Integer>> {
  private static final Charset CHARSET=StandardCharsets.UTF_8;
  private final FSDataOutputStream stream;
  TestBulkWriter(  final FSDataOutputStream stream){
    this.stream=Preconditions.checkNotNull(stream);
  }
  @Override public void addElement(  Tuple2<String,Integer> element) throws IOException {
    stream.write((element.f0 + '@' + element.f1+ '\n').getBytes(CHARSET));
  }
  @Override public void flush() throws IOException {
    stream.flush();
  }
  @Override public void finish() throws IOException {
    flush();
  }
}
