private static class TimestampingSink implements SinkFunction<Tuple2<Long,Long>> {
  private static final long serialVersionUID=1876986644706201196L;
  private long maxLatency;
  private long count;
  @Override public void invoke(  Tuple2<Long,Long> value){
    long ts=value.f1;
    if (ts != 0L) {
      long diff=System.currentTimeMillis() - ts;
      maxLatency=Math.max(diff,maxLatency);
    }
    count++;
    if (count == 5000) {
      System.out.println("Max latency: " + maxLatency);
      count=0;
      maxLatency=0;
    }
  }
}
