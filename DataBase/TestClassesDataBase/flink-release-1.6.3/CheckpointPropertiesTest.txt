/** 
 * Tests for the default checkpoint properties.
 */
public class CheckpointPropertiesTest {
  /** 
 * Tests the external checkpoints properties.
 */
  @Test public void testCheckpointProperties(){
    CheckpointProperties props=CheckpointProperties.forCheckpoint(CheckpointRetentionPolicy.RETAIN_ON_FAILURE);
    assertFalse(props.forceCheckpoint());
    assertTrue(props.discardOnSubsumed());
    assertTrue(props.discardOnJobFinished());
    assertTrue(props.discardOnJobCancelled());
    assertFalse(props.discardOnJobFailed());
    assertTrue(props.discardOnJobSuspended());
    props=CheckpointProperties.forCheckpoint(CheckpointRetentionPolicy.RETAIN_ON_CANCELLATION);
    assertFalse(props.forceCheckpoint());
    assertTrue(props.discardOnSubsumed());
    assertTrue(props.discardOnJobFinished());
    assertFalse(props.discardOnJobCancelled());
    assertFalse(props.discardOnJobFailed());
    assertFalse(props.discardOnJobSuspended());
  }
  /** 
 * Tests the default (manually triggered) savepoint properties.
 */
  @Test public void testSavepointProperties(){
    CheckpointProperties props=CheckpointProperties.forSavepoint();
    assertTrue(props.forceCheckpoint());
    assertFalse(props.discardOnSubsumed());
    assertFalse(props.discardOnJobFinished());
    assertFalse(props.discardOnJobCancelled());
    assertFalse(props.discardOnJobFailed());
    assertFalse(props.discardOnJobSuspended());
  }
  /** 
 * Tests the isSavepoint utility works as expected.
 */
  @Test public void testIsSavepoint() throws Exception {
{
      CheckpointProperties props=CheckpointProperties.forCheckpoint(CheckpointRetentionPolicy.RETAIN_ON_FAILURE);
      assertFalse(props.isSavepoint());
    }
{
      CheckpointProperties props=CheckpointProperties.forCheckpoint(CheckpointRetentionPolicy.RETAIN_ON_CANCELLATION);
      assertFalse(props.isSavepoint());
    }
{
      CheckpointProperties props=CheckpointProperties.forSavepoint();
      assertTrue(props.isSavepoint());
      CheckpointProperties deserializedCheckpointProperties=InstantiationUtil.deserializeObject(InstantiationUtil.serializeObject(props),getClass().getClassLoader());
      assertTrue(deserializedCheckpointProperties.isSavepoint());
    }
  }
}
