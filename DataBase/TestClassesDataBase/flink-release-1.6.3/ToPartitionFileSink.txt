private static class ToPartitionFileSink extends RichSinkFunction<Tuple2<Integer,Integer>> {
  private static final long serialVersionUID=1L;
  private final List<File> allPartitions;
  private DataOutputStream dos;
  public ToPartitionFileSink(  List<File> allPartitions){
    this.allPartitions=allPartitions;
  }
  @Override public void open(  Configuration parameters) throws Exception {
    super.open(parameters);
    int subtaskIdx=getRuntimeContext().getIndexOfThisSubtask();
    dos=new DataOutputStream(new BufferedOutputStream(new FileOutputStream(allPartitions.get(subtaskIdx))));
  }
  @Override public void close() throws Exception {
    super.close();
    dos.close();
  }
  @Override public void invoke(  Tuple2<Integer,Integer> value,  Context context) throws Exception {
    dos.writeInt(value.f0);
    dos.writeInt(value.f1);
  }
}
