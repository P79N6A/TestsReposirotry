private static class RichFlatMapper1 extends RichFlatMapFunction<Tuple3<Integer,Long,String>,Tuple3<Integer,Long,String>> {
  private static final long serialVersionUID=1L;
  private final Tuple3<Integer,Long,String> outTuple=new Tuple3<Integer,Long,String>();
  private Integer f2Replace=0;
  @Override public void open(  Configuration config){
    Collection<Integer> ints=this.getRuntimeContext().getBroadcastVariable("ints");
    int sum=0;
    for (    Integer i : ints) {
      sum+=i;
    }
    f2Replace=sum;
  }
  @Override public void flatMap(  Tuple3<Integer,Long,String> value,  Collector<Tuple3<Integer,Long,String>> out) throws Exception {
    outTuple.setFields(f2Replace,value.f1,value.f2);
    out.collect(outTuple);
  }
}
