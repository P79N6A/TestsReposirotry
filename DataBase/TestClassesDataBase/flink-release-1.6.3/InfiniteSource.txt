private static class InfiniteSource implements ParallelSourceFunction<Integer> {
  private static final long serialVersionUID=1642561062000662861L;
  private volatile boolean running;
  private final Random random;
  InfiniteSource(){
    running=true;
    random=new Random();
  }
  @Override public void run(  SourceContext<Integer> ctx) throws Exception {
    while (running) {
synchronized (ctx.getCheckpointLock()) {
        ctx.collect(random.nextInt());
      }
      Thread.sleep(5L);
    }
  }
  @Override public void cancel(){
    running=false;
  }
}
