private static class QueryingProcessFunction extends ProcessFunction<Integer,String> {
  private static final long serialVersionUID=1L;
  private final TimeDomain timeDomain;
  public QueryingProcessFunction(  TimeDomain timeDomain){
    this.timeDomain=timeDomain;
  }
  @Override public void processElement(  Integer value,  Context ctx,  Collector<String> out) throws Exception {
    if (timeDomain.equals(TimeDomain.EVENT_TIME)) {
      out.collect(value + "TIME:" + ctx.timerService().currentWatermark()+ " TS:"+ ctx.timestamp());
    }
 else {
      out.collect(value + "TIME:" + ctx.timerService().currentProcessingTime()+ " TS:"+ ctx.timestamp());
    }
  }
  @Override public void onTimer(  long timestamp,  OnTimerContext ctx,  Collector<String> out) throws Exception {
  }
}
