/** 
 * Tests for the DataSource.
 */
public class DataSourceITCase extends JavaProgramTestBase {
  private String inputPath;
  @Override protected void preSubmit() throws Exception {
    inputPath=createTempFile("input","ab\n" + "cd\n" + "ef\n");
  }
  @Override protected void testProgram() throws Exception {
    final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
    Configuration ifConf=new Configuration();
    ifConf.setString("prepend","test");
    DataSet<String> ds=env.createInput(new TestInputFormat(new Path(inputPath))).withParameters(ifConf);
    List<String> result=ds.collect();
    String expectedResult="ab\n" + "cd\n" + "ef\n";
    compareResultAsText(result,expectedResult);
  }
private static class TestInputFormat extends TextInputFormat {
    private static final long serialVersionUID=1L;
    public TestInputFormat(    Path filePath){
      super(filePath);
    }
    @Override public void configure(    Configuration parameters){
      super.configure(parameters);
      Assert.assertNotNull(parameters.getString("prepend",null));
      Assert.assertEquals("test",parameters.getString("prepend",null));
    }
  }
}
