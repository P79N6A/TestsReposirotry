private static class DuplicateFilter extends RichFlatMapFunction<Integer,Integer> {
  static final ValueStateDescriptor<Boolean> DESCRIPTOR=new ValueStateDescriptor<>("seen",Boolean.class,false);
  private static final long serialVersionUID=1L;
  private ValueState<Boolean> operatorState;
  @Override public void open(  Configuration configuration){
    operatorState=this.getRuntimeContext().getState(DESCRIPTOR);
  }
  @Override public void flatMap(  Integer value,  Collector<Integer> out) throws Exception {
    if (!operatorState.value()) {
      out.collect(value);
      operatorState.update(true);
    }
    if (30 == value) {
      iterTestSnapshotWait[getRuntimeContext().getIndexOfThisSubtask()].trigger();
    }
  }
}
