public static final class MockFailingCombiningReduceStub implements GroupReduceFunction<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>>, GroupCombineFunction<Tuple2<Integer,Integer>,Tuple2<Integer,Integer>> {
  private static final long serialVersionUID=1L;
  private int cnt;
  @Override public void reduce(  Iterable<Tuple2<Integer,Integer>> records,  Collector<Tuple2<Integer,Integer>> out){
    int key=0;
    int sum=0;
    for (    Tuple2<Integer,Integer> next : records) {
      key=next.f0;
      sum+=next.f1;
    }
    int resultValue=sum - key;
    out.collect(new Tuple2<>(key,resultValue));
  }
  @Override public void combine(  Iterable<Tuple2<Integer,Integer>> records,  Collector<Tuple2<Integer,Integer>> out){
    int key=0;
    int sum=0;
    for (    Tuple2<Integer,Integer> next : records) {
      key=next.f0;
      sum+=next.f1;
    }
    if (++this.cnt >= 10) {
      throw new ExpectedTestException();
    }
    int resultValue=sum - key;
    out.collect(new Tuple2<>(key,resultValue));
  }
}
