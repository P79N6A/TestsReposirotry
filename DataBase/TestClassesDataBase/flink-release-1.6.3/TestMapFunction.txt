private static class TestMapFunction extends RichMapFunction<Integer,String> {
  private static final long serialVersionUID=-3917258280687242969L;
  @Override public String map(  Integer value) throws Exception {
    final Path actualFile=new Path(getRuntimeContext().getDistributedCache().getFile("test_data").toURI());
    Path path=new Path(actualFile.toUri());
    assertFalse(path.getFileSystem().isDistributedFS());
    DataInputStream in=new DataInputStream(actualFile.getFileSystem().open(actualFile));
    String contents=in.readUTF();
    assertEquals(testFileContent,contents);
    final Path actualDir=new Path(getRuntimeContext().getDistributedCache().getFile("test_dir").toURI());
    FileStatus fileStatus=actualDir.getFileSystem().getFileStatus(actualDir);
    assertTrue(fileStatus.isDir());
    FileStatus[] fileStatuses=actualDir.getFileSystem().listStatus(actualDir);
    assertEquals(2,fileStatuses.length);
    return contents;
  }
}
