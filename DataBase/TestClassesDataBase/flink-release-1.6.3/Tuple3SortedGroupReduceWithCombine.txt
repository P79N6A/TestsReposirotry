private static class Tuple3SortedGroupReduceWithCombine implements GroupReduceFunction<Tuple3<Integer,Long,String>,Tuple2<Integer,String>>, GroupCombineFunction<Tuple3<Integer,Long,String>,Tuple3<Integer,Long,String>> {
  private static final long serialVersionUID=1L;
  @Override public void combine(  Iterable<Tuple3<Integer,Long,String>> values,  Collector<Tuple3<Integer,Long,String>> out){
    int sum=0;
    long key=0;
    StringBuilder concat=new StringBuilder();
    for (    Tuple3<Integer,Long,String> next : values) {
      sum+=next.f0;
      key=next.f1;
      concat.append(next.f2).append("-");
    }
    if (concat.length() > 0) {
      concat.setLength(concat.length() - 1);
    }
    out.collect(new Tuple3<>(sum,key,concat.toString()));
  }
  @Override public void reduce(  Iterable<Tuple3<Integer,Long,String>> values,  Collector<Tuple2<Integer,String>> out){
    int i=0;
    String s="";
    for (    Tuple3<Integer,Long,String> t : values) {
      i+=t.f0;
      s=t.f2;
    }
    out.collect(new Tuple2<>(i,s));
  }
}
