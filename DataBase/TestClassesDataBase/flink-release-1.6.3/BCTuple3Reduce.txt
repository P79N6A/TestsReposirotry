private static class BCTuple3Reduce extends RichReduceFunction<Tuple3<Integer,Long,String>> {
  private static final long serialVersionUID=1L;
  private final Tuple3<Integer,Long,String> out=new Tuple3<Integer,Long,String>();
  private String f2Replace="";
  @Override public void open(  Configuration config){
    Collection<Integer> ints=this.getRuntimeContext().getBroadcastVariable("ints");
    int sum=0;
    for (    Integer i : ints) {
      sum+=i;
    }
    f2Replace=sum + "";
  }
  @Override public Tuple3<Integer,Long,String> reduce(  Tuple3<Integer,Long,String> in1,  Tuple3<Integer,Long,String> in2) throws Exception {
    out.setFields(in1.f0 + in2.f0,in1.f1,this.f2Replace);
    return out;
  }
}
