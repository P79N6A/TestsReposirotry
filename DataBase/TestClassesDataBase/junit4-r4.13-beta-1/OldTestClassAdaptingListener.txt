private static final class OldTestClassAdaptingListener implements TestListener {
  private final RunNotifier notifier;
  private OldTestClassAdaptingListener(  RunNotifier notifier){
    this.notifier=notifier;
  }
  public void endTest(  Test test){
    notifier.fireTestFinished(asDescription(test));
  }
  public void startTest(  Test test){
    notifier.fireTestStarted(asDescription(test));
  }
  public void addError(  Test test,  Throwable e){
    Failure failure=new Failure(asDescription(test),e);
    notifier.fireTestFailure(failure);
  }
  private Description asDescription(  Test test){
    if (test instanceof Describable) {
      Describable facade=(Describable)test;
      return facade.getDescription();
    }
    return Description.createTestDescription(getEffectiveClass(test),getName(test));
  }
  private Class<? extends Test> getEffectiveClass(  Test test){
    return test.getClass();
  }
  private String getName(  Test test){
    if (test instanceof TestCase) {
      return ((TestCase)test).getName();
    }
 else {
      return test.toString();
    }
  }
  public void addFailure(  Test test,  AssertionFailedError t){
    addError(test,t);
  }
}
