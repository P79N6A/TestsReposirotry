/** 
 * A matcher that matches the "at ..." line in a stack trace.
 */
private static class StackTraceLineMatcher extends StringMatcher {
  private static final Pattern PATTERN=Pattern.compile("\t*at ([a-zA-Z0-9.$]+)\\([a-zA-Z0-9]+\\.java:[0-9]+\\)");
  private final String method;
  public StackTraceLineMatcher(  String method){
    this.method=method;
  }
  public void describeTo(  Description description){
    description.appendText("A stack trace line for method " + method);
  }
  @Override protected boolean matchesSafely(  String line){
    if (!line.startsWith("\t")) {
      return false;
    }
    line=line.substring(1);
    java.util.regex.Matcher matcher=PATTERN.matcher(line);
    if (!matcher.matches()) {
      fail("Line does not look like a stack trace line: " + line);
    }
    String matchedMethod=matcher.group(1);
    return method.equals(matchedMethod);
  }
}
