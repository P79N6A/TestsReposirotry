public static class InfiniteLoopMultithreaded {
private static class ThreadTest implements Runnable {
    private boolean fStall;
    public ThreadTest(    boolean stall){
      fStall=stall;
    }
    public void run(){
      if (fStall)       for (; ; )       ;
      try {
        Thread.sleep(500);
      }
 catch (      InterruptedException e) {
      }
    }
  }
  public void failure(  boolean mainThreadStalls) throws Exception {
    Thread t1=new Thread(new ThreadTest(false),"timeout-thr1");
    Thread t2=new Thread(new ThreadTest(!mainThreadStalls),"timeout-thr2");
    Thread t3=new Thread(new ThreadTest(false),"timeout-thr3");
    t1.start();
    t2.start();
    t3.start();
    if (mainThreadStalls)     for (; ; )     ;
    t1.join();
    t2.join();
    t3.join();
  }
}
