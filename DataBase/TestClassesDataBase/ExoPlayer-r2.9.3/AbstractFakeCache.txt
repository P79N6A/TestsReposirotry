/** 
 * Abstract fake Cache implementation used by the test. This class must be public so Mockito can create a proxy for it.
 */
public abstract static class AbstractFakeCache implements Cache {
  private int[] spansAndGaps;
  private long contentLength;
  private void init(){
    spansAndGaps=new int[]{};
    contentLength=C.LENGTH_UNSET;
  }
  @Override public long getCachedLength(  String key,  long position,  long length){
    for (int i=0; i < spansAndGaps.length; i++) {
      int spanOrGap=spansAndGaps[i];
      if (position < spanOrGap) {
        long left=Math.min(spanOrGap - position,length);
        return (i & 1) == 1 ? -left : left;
      }
      position-=spanOrGap;
    }
    return -length;
  }
  @Override public long getContentLength(  String key){
    return contentLength;
  }
}
