@Configuration static class TwoEntityManagerFactoriesConfiguration {
  private static final Class<?>[] PACKAGE_CLASSES=new Class<?>[]{MyEntity.class};
  @Primary @Bean public LocalContainerEntityManagerFactoryBean firstEntityManagerFactory(  DataSource ds){
    return createSessionFactory(ds);
  }
  @Bean public LocalContainerEntityManagerFactoryBean secondOne(  DataSource ds){
    return createSessionFactory(ds);
  }
  private LocalContainerEntityManagerFactoryBean createSessionFactory(  DataSource ds){
    Map<String,String> jpaProperties=new HashMap<>();
    jpaProperties.put("hibernate.generate_statistics","true");
    return new EntityManagerFactoryBuilder(new HibernateJpaVendorAdapter(),jpaProperties,null).dataSource(ds).packages(PACKAGE_CLASSES).build();
  }
}
