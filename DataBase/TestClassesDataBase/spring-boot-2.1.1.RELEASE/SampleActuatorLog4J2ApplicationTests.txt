/** 
 * Tests for  {@link SampleActuatorLog4J2Application}.
 * @author Dave Syer
 * @@author Stephane Nicoll
 */
@RunWith(SpringRunner.class) @SpringBootTest @AutoConfigureMockMvc public class SampleActuatorLog4J2ApplicationTests {
  private static final Logger logger=LogManager.getLogger(SampleActuatorLog4J2ApplicationTests.class);
  @Rule public OutputCapture output=new OutputCapture();
  @Autowired private MockMvc mvc;
  @Test public void testLogger(){
    logger.info("Hello World");
    this.output.expect(containsString("Hello World"));
  }
  @Test public void validateLoggersEndpoint() throws Exception {
    this.mvc.perform(get("/actuator/loggers/org.apache.coyote.http11.Http11NioProtocol").header("Authorization","Basic " + getBasicAuth())).andExpect(status().isOk()).andExpect(content().string(equalTo("{\"configuredLevel\":\"WARN\"," + "\"effectiveLevel\":\"WARN\"}")));
  }
  private String getBasicAuth(){
    return new String(Base64.getEncoder().encode(("user:password").getBytes()));
  }
}
