/** 
 * {@link TrustSelfSignedStrategy} that also validates certificate serial number.
 */
private static final class SerialNumberValidatingTrustSelfSignedStrategy extends TrustSelfSignedStrategy {
  private final String serialNumber;
  private SerialNumberValidatingTrustSelfSignedStrategy(  String serialNumber){
    this.serialNumber=serialNumber;
  }
  @Override public boolean isTrusted(  X509Certificate[] chain,  String authType) throws CertificateException {
    String hexSerialNumber=chain[0].getSerialNumber().toString(16);
    boolean isMatch=hexSerialNumber.equals(this.serialNumber);
    return super.isTrusted(chain,authType) && isMatch;
  }
}
