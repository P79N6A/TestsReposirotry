/** 
 * Integration test for  {@link WebTestClientContextCustomizer}.
 * @author Phillip Webb
 */
@RunWith(SpringRunner.class) @SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT,properties="spring.main.web-application-type=reactive") @DirtiesContext public class WebTestClientContextCustomizerIntegrationTests {
  @Autowired private WebTestClient webTestClient;
  @Test public void test(){
    this.webTestClient.get().uri("/").exchange().expectBody(String.class).isEqualTo("hello");
  }
@Configuration @Import({TestHandler.class,NoWebTestClientBeanChecker.class}) static class TestConfig {
    @Bean public TomcatReactiveWebServerFactory webServerFactory(){
      return new TomcatReactiveWebServerFactory(0);
    }
  }
static class TestHandler implements HttpHandler {
    private static final DefaultDataBufferFactory factory=new DefaultDataBufferFactory();
    @Override public Mono<Void> handle(    ServerHttpRequest request,    ServerHttpResponse response){
      response.setStatusCode(HttpStatus.OK);
      return response.writeWith(Mono.just(factory.wrap("hello".getBytes())));
    }
  }
}
