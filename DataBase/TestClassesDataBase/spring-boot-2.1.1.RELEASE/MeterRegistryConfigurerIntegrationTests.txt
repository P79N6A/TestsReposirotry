/** 
 * Integration tests for  {@link MeterRegistryConfigurer}.
 * @author Jon Schneider
 */
public class MeterRegistryConfigurerIntegrationTests {
  private ApplicationContextRunner contextRunner=new ApplicationContextRunner().with(MetricsRun.limitedTo(AtlasMetricsExportAutoConfiguration.class,PrometheusMetricsExportAutoConfiguration.class)).withConfiguration(AutoConfigurations.of(JvmMetricsAutoConfiguration.class));
  @Test public void binderMetricsAreSearchableFromTheComposite(){
    this.contextRunner.run((context) -> {
      CompositeMeterRegistry composite=context.getBean(CompositeMeterRegistry.class);
      composite.get("jvm.memory.used").gauge();
      context.getBeansOfType(MeterRegistry.class).forEach((name,registry) -> registry.get("jvm.memory.used").gauge());
    }
);
  }
}
