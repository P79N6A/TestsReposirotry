/** 
 * Tests for  {@link Layouts}.
 * @author Phillip Webb
 * @author Andy Wilkinson
 */
public class LayoutsTests {
  @Test public void jarFile(){
    assertThat(Layouts.forFile(new File("test.jar"))).isInstanceOf(Layouts.Jar.class);
    assertThat(Layouts.forFile(new File("test.JAR"))).isInstanceOf(Layouts.Jar.class);
    assertThat(Layouts.forFile(new File("test.jAr"))).isInstanceOf(Layouts.Jar.class);
    assertThat(Layouts.forFile(new File("te.st.jar"))).isInstanceOf(Layouts.Jar.class);
  }
  @Test public void warFile(){
    assertThat(Layouts.forFile(new File("test.war"))).isInstanceOf(Layouts.War.class);
    assertThat(Layouts.forFile(new File("test.WAR"))).isInstanceOf(Layouts.War.class);
    assertThat(Layouts.forFile(new File("test.wAr"))).isInstanceOf(Layouts.War.class);
    assertThat(Layouts.forFile(new File("te.st.war"))).isInstanceOf(Layouts.War.class);
  }
  @Test public void unknownFile(){
    assertThatIllegalStateException().isThrownBy(() -> Layouts.forFile(new File("test.txt"))).withMessageContaining("Unable to deduce layout for 'test.txt'");
  }
  @Test public void jarLayout(){
    Layout layout=new Layouts.Jar();
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.COMPILE)).isEqualTo("BOOT-INF/lib/");
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.CUSTOM)).isEqualTo("BOOT-INF/lib/");
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.PROVIDED)).isEqualTo("BOOT-INF/lib/");
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.RUNTIME)).isEqualTo("BOOT-INF/lib/");
  }
  @Test public void warLayout(){
    Layout layout=new Layouts.War();
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.COMPILE)).isEqualTo("WEB-INF/lib/");
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.CUSTOM)).isEqualTo("WEB-INF/lib/");
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.PROVIDED)).isEqualTo("WEB-INF/lib-provided/");
    assertThat(layout.getLibraryDestination("lib.jar",LibraryScope.RUNTIME)).isEqualTo("WEB-INF/lib/");
  }
}
