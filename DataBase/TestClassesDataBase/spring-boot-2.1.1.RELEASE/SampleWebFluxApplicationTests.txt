/** 
 * Basic integration tests for WebFlux application.
 * @author Brian Clozel
 */
@RunWith(SpringRunner.class) @SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT) public class SampleWebFluxApplicationTests {
  @Autowired private WebTestClient webClient;
  @Test public void testWelcome(){
    this.webClient.get().uri("/").accept(MediaType.TEXT_PLAIN).exchange().expectBody(String.class).isEqualTo("Hello World");
  }
  @Test public void testEcho(){
    this.webClient.post().uri("/echo").contentType(MediaType.TEXT_PLAIN).accept(MediaType.TEXT_PLAIN).body(Mono.just("Hello WebFlux!"),String.class).exchange().expectBody(String.class).isEqualTo("Hello WebFlux!");
  }
  @Test public void testActuatorStatus(){
    this.webClient.get().uri("/actuator/health").accept(MediaType.APPLICATION_JSON).exchange().expectStatus().isOk().expectBody().json("{\"status\":\"UP\"}");
  }
}
