private static class CouchbaseStatement extends Statement {
  private final Statement base;
  private final CouchbaseEnvironment environment;
  private final Cluster cluster;
  CouchbaseStatement(  Statement base,  CouchbaseEnvironment environment,  Cluster cluster){
    this.base=base;
    this.environment=environment;
    this.cluster=cluster;
  }
  @Override public void evaluate() throws Throwable {
    try {
      this.base.evaluate();
    }
 catch (    BeanCreationException ex) {
      if ("couchbaseClient".equals(ex.getBeanName())) {
        throw new AssumptionViolatedException("Skipping test due to Couchbase error " + ex.getMessage(),ex);
      }
    }
 finally {
      try {
        this.cluster.disconnect();
        this.environment.shutdownAsync();
      }
 catch (      Exception ex) {
        logger.warn("Exception while trying to cleanup couchbase resource",ex);
      }
    }
  }
}
