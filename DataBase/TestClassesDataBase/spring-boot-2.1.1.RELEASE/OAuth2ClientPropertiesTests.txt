/** 
 * Tests for  {@link OAuth2ClientProperties}.
 * @author Madhura Bhave
 * @author Artsiom Yudovin
 */
public class OAuth2ClientPropertiesTests {
  private OAuth2ClientProperties properties=new OAuth2ClientProperties();
  @Test public void clientIdAbsentThrowsException(){
    OAuth2ClientProperties.Registration registration=new OAuth2ClientProperties.Registration();
    registration.setClientSecret("secret");
    registration.setProvider("google");
    this.properties.getRegistration().put("foo",registration);
    assertThatIllegalStateException().isThrownBy(this.properties::validate).withMessageContaining("Client id must not be empty.");
  }
  @Test public void clientSecretAbsentShouldNotThrowException(){
    OAuth2ClientProperties.Registration registration=new OAuth2ClientProperties.Registration();
    registration.setClientId("foo");
    registration.setProvider("google");
    this.properties.getRegistration().put("foo",registration);
    this.properties.validate();
  }
}
