/** 
 * Tests for  {@link RestClientTest} with two clients.
 * @author Phillip Webb
 */
@RunWith(SpringRunner.class) @RestClientTest({ExampleRestClient.class,AnotherExampleRestClient.class}) public class RestClientTestTwoComponentsIntegrationTests {
  @Autowired private ExampleRestClient client1;
  @Autowired private AnotherExampleRestClient client2;
  @Autowired private MockServerRestTemplateCustomizer customizer;
  @Autowired private MockRestServiceServer server;
  @Test public void serverShouldNotWork(){
    assertThatIllegalStateException().isThrownBy(() -> this.server.expect(requestTo("/test")).andRespond(withSuccess("hello",MediaType.TEXT_HTML))).withMessageContaining("Unable to use auto-configured");
  }
  @Test public void client1RestCallViaCustomizer(){
    this.customizer.getServer(this.client1.getRestTemplate()).expect(requestTo("/test")).andRespond(withSuccess("hello",MediaType.TEXT_HTML));
    assertThat(this.client1.test()).isEqualTo("hello");
  }
  @Test public void client2RestCallViaCustomizer(){
    this.customizer.getServer(this.client2.getRestTemplate()).expect(requestTo("/test")).andRespond(withSuccess("there",MediaType.TEXT_HTML));
    assertThat(this.client2.test()).isEqualTo("there");
  }
}
