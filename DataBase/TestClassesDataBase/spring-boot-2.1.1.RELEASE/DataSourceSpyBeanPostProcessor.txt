private static class DataSourceSpyBeanPostProcessor implements BeanPostProcessor {
  @Override public Object postProcessBeforeInitialization(  Object bean,  String beanName) throws BeansException {
    if (bean instanceof DataSource) {
      bean=spy(bean);
    }
    return bean;
  }
  @Override public Object postProcessAfterInitialization(  Object bean,  String beanName) throws BeansException {
    return bean;
  }
}
