/** 
 * Tests for  {@link SimpleTwoDataSourcesExample}.
 * @author Stephane Nicoll
 */
@RunWith(SpringRunner.class) @SpringBootTest(properties={"app.datasource.second.url=jdbc:h2:mem:bar;DB_CLOSE_DELAY=-1","app.datasource.second.max-total=42"}) @Import(SimpleTwoDataSourcesExample.SimpleDataSourcesConfiguration.class) public class SimpleTwoDataSourcesExampleTests {
  @Autowired private ApplicationContext context;
  @Test public void validateConfiguration() throws SQLException {
    assertThat(this.context.getBeansOfType(DataSource.class)).hasSize(2);
    DataSource dataSource=this.context.getBean(DataSource.class);
    assertThat(this.context.getBean("firstDataSource")).isSameAs(dataSource);
    assertThat(dataSource.getConnection().getMetaData().getURL()).startsWith("jdbc:h2:mem:");
    BasicDataSource secondDataSource=this.context.getBean("secondDataSource",BasicDataSource.class);
    assertThat(secondDataSource.getUrl()).isEqualTo("jdbc:h2:mem:bar;DB_CLOSE_DELAY=-1");
    assertThat(secondDataSource.getMaxTotal()).isEqualTo(42);
  }
}
