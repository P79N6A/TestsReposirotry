@Configuration static class NonHibernateEntityManagerFactoryConfiguration {
  @Bean public EntityManagerFactory entityManagerFactory(){
    EntityManagerFactory mockedFactory=mock(EntityManagerFactory.class);
    given(mockedFactory.unwrap(ArgumentMatchers.<Class<SessionFactory>>any())).willThrow(PersistenceException.class);
    return mockedFactory;
  }
}
