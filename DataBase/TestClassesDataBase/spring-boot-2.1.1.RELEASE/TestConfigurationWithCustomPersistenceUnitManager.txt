@Configuration @TestAutoConfigurationPackage(AbstractJpaAutoConfigurationTests.class) public static class TestConfigurationWithCustomPersistenceUnitManager {
  private final DataSource dataSource;
  public TestConfigurationWithCustomPersistenceUnitManager(  DataSource dataSource){
    this.dataSource=dataSource;
  }
  @Bean public PersistenceUnitManager persistenceUnitManager(){
    DefaultPersistenceUnitManager persistenceUnitManager=new DefaultPersistenceUnitManager();
    persistenceUnitManager.setDefaultDataSource(this.dataSource);
    persistenceUnitManager.setPackagesToScan(City.class.getPackage().getName());
    return persistenceUnitManager;
  }
}
