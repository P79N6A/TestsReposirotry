/** 
 * Integration tests for  {@link AutoConfigureTestDatabase} when there are multipledatasources.
 * @author Greg Potter
 */
@RunWith(SpringRunner.class) @JdbcTest @AutoConfigureTestDatabase public class AutoConfigureTestDatabaseWithMultipleDatasourcesIntegrationTests {
  @Autowired private DataSource dataSource;
  @Test public void replacesDefinedDataSourceWithExplicit() throws Exception {
    String product=this.dataSource.getConnection().getMetaData().getDatabaseProductName();
    assertThat(product).startsWith("H2");
  }
@Configuration @EnableAutoConfiguration static class Config {
    @Bean @Primary public DataSource dataSource(){
      return new EmbeddedDatabaseBuilder().generateUniqueName(true).setType(EmbeddedDatabaseType.HSQL).build();
    }
    @Bean public DataSource secondaryDataSource(){
      return new EmbeddedDatabaseBuilder().generateUniqueName(true).setType(EmbeddedDatabaseType.HSQL).build();
    }
  }
}
