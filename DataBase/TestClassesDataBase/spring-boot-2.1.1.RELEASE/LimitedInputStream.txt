private static class LimitedInputStream extends FilterInputStream {
  private final int max;
  protected LimitedInputStream(  InputStream in,  int max){
    super(in);
    this.max=max;
  }
  @Override public int read(  byte[] b,  int off,  int len) throws IOException {
    return super.read(b,off,Math.min(len,this.max));
  }
}
