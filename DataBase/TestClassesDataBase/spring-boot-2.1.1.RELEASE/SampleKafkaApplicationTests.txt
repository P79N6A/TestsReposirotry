/** 
 * Integration tests for demo application.
 * @author hcxin
 * @author Gary Russell
 * @author Stephane Nicoll
 */
@RunWith(SpringRunner.class) @SpringBootTest(properties="spring.kafka.bootstrap-servers=${spring.embedded.kafka.brokers}") @EmbeddedKafka public class SampleKafkaApplicationTests {
  @Rule public OutputCapture outputCapture=new OutputCapture();
  @Test public void testVanillaExchange() throws Exception {
    long end=System.currentTimeMillis() + 10000;
    while (!this.outputCapture.toString().contains("A simple test message") && System.currentTimeMillis() < end) {
      Thread.sleep(250);
    }
    assertThat(this.outputCapture.toString()).contains("A simple test message");
  }
}
