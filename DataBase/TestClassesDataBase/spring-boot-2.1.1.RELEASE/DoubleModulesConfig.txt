@Configuration protected static class DoubleModulesConfig {
  @Bean public Module jacksonModule(){
    SimpleModule module=new SimpleModule();
    module.addSerializer(Foo.class,new JsonSerializer<Foo>(){
      @Override public void serialize(      Foo value,      JsonGenerator jgen,      SerializerProvider provider) throws IOException {
        jgen.writeStartObject();
        jgen.writeStringField("foo","bar");
        jgen.writeEndObject();
      }
    }
);
    return module;
  }
  @Bean @Primary public ObjectMapper objectMapper(){
    ObjectMapper mapper=new ObjectMapper();
    mapper.registerModule(jacksonModule());
    return mapper;
  }
}
