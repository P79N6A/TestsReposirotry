@Configuration @EnableBatchProcessing protected static class BatchConfiguration implements BatchConfigurer {
  private ResourcelessTransactionManager transactionManager=new ResourcelessTransactionManager();
  private JobRepository jobRepository;
  private MapJobRepositoryFactoryBean jobRepositoryFactory=new MapJobRepositoryFactoryBean(this.transactionManager);
  public BatchConfiguration() throws Exception {
    this.jobRepository=this.jobRepositoryFactory.getObject();
  }
  public void clear(){
    this.jobRepositoryFactory.clear();
  }
  @Override public JobRepository getJobRepository(){
    return this.jobRepository;
  }
  @Override public PlatformTransactionManager getTransactionManager(){
    return this.transactionManager;
  }
  @Override public JobLauncher getJobLauncher(){
    SimpleJobLauncher launcher=new SimpleJobLauncher();
    launcher.setJobRepository(this.jobRepository);
    launcher.setTaskExecutor(new SyncTaskExecutor());
    return launcher;
  }
  @Override public JobExplorer getJobExplorer() throws Exception {
    return new MapJobExplorerFactoryBean(this.jobRepositoryFactory).getObject();
  }
}
