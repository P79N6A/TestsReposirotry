@Controller public static class HelloWorldController implements WebMvcConfigurer {
  private int status;
  private CountDownLatch latch=new CountDownLatch(1);
  public int getStatus() throws InterruptedException {
    assertThat(this.latch.await(1,TimeUnit.SECONDS)).as("Timed out waiting for latch").isTrue();
    return this.status;
  }
  public void setStatus(  int status){
    this.status=status;
  }
  public void reset(){
    this.status=0;
    this.latch=new CountDownLatch(1);
  }
  @Override public void addInterceptors(  InterceptorRegistry registry){
    registry.addInterceptor(new HandlerInterceptorAdapter(){
      @Override public void postHandle(      HttpServletRequest request,      HttpServletResponse response,      Object handler,      ModelAndView modelAndView){
        HelloWorldController.this.setStatus(response.getStatus());
        HelloWorldController.this.latch.countDown();
      }
    }
);
  }
  @RequestMapping("/hello") @ResponseBody public String sayHello(){
    return "Hello World";
  }
  @RequestMapping("/create") @ResponseBody @ResponseStatus(HttpStatus.CREATED) public String created(){
    return "Hello World";
  }
}
