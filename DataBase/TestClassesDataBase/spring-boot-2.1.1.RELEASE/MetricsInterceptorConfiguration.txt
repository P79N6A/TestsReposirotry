@Configuration @EnableWebMvc @Import(Controller1.class) static class MetricsInterceptorConfiguration {
  @Bean Clock micrometerClock(){
    return new MockClock();
  }
  @Bean SimpleMeterRegistry simple(  Clock clock){
    return new SimpleMeterRegistry(SimpleConfig.DEFAULT,clock);
  }
  @Bean CyclicBarrier callableBarrier(){
    return new CyclicBarrier(2);
  }
  @Bean WebMvcConfigurer handlerInterceptorConfigurer(  MeterRegistry meterRegistry){
    return new WebMvcConfigurer(){
      @Override public void addInterceptors(      InterceptorRegistry registry){
        registry.addInterceptor(new LongTaskTimingHandlerInterceptor(meterRegistry,new DefaultWebMvcTagsProvider()));
      }
    }
;
  }
}
