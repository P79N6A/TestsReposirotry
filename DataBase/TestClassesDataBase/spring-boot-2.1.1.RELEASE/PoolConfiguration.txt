@Configuration public static class PoolConfiguration {
  @Bean public ConnectionFactory pooledConnectionFactory(  XAConnectionFactoryWrapper wrapper) throws Exception {
    XAConnectionFactory connectionFactory=mock(XAConnectionFactory.class);
    XAConnection connection=mock(XAConnection.class);
    XASession session=mock(XASession.class);
    TemporaryQueue queue=mock(TemporaryQueue.class);
    XAResource resource=mock(XAResource.class);
    given(connectionFactory.createXAConnection()).willReturn(connection);
    given(connection.createXASession()).willReturn(session);
    given(session.createTemporaryQueue()).willReturn(queue);
    given(session.getXAResource()).willReturn(resource);
    return wrapper.wrapConnectionFactory(connectionFactory);
  }
  @Bean public DataSource pooledDataSource(  XADataSourceWrapper wrapper) throws Exception {
    XADataSource dataSource=mock(XADataSource.class);
    return wrapper.wrapDataSource(dataSource);
  }
}
