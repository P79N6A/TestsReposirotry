/** 
 * Tests for  {@link SslServerCustomizer}.
 * @author Andy Wilkinson
 */
public class SslServerCustomizerTests {
  @Test public void keyStoreProviderIsUsedWhenCreatingKeyStore() throws Exception {
    Ssl ssl=new Ssl();
    ssl.setKeyPassword("password");
    ssl.setKeyStore("src/test/resources/test.jks");
    ssl.setKeyStoreProvider("com.example.KeyStoreProvider");
    SslServerCustomizer customizer=new SslServerCustomizer(ssl,null,null);
    try {
      customizer.getKeyManagerFactory(ssl,null);
      fail();
    }
 catch (    IllegalStateException ex) {
      Throwable cause=ex.getCause();
      assertThat(cause).isInstanceOf(NoSuchProviderException.class);
      assertThat(cause).hasMessageContaining("com.example.KeyStoreProvider");
    }
  }
  @Test public void trustStoreProviderIsUsedWhenCreatingTrustStore() throws Exception {
    Ssl ssl=new Ssl();
    ssl.setTrustStorePassword("password");
    ssl.setTrustStore("src/test/resources/test.jks");
    ssl.setTrustStoreProvider("com.example.TrustStoreProvider");
    SslServerCustomizer customizer=new SslServerCustomizer(ssl,null,null);
    try {
      customizer.getTrustManagerFactory(ssl,null);
      fail();
    }
 catch (    IllegalStateException ex) {
      Throwable cause=ex.getCause();
      assertThat(cause).isInstanceOf(NoSuchProviderException.class);
      assertThat(cause).hasMessageContaining("com.example.TrustStoreProvider");
    }
  }
}
