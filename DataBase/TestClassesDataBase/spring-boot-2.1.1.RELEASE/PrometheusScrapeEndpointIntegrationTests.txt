/** 
 * Tests for  {@link PrometheusScrapeEndpoint}.
 * @author Jon Schneider
 */
@RunWith(WebEndpointRunners.class) public class PrometheusScrapeEndpointIntegrationTests {
  private static WebTestClient client;
  @Test public void scrapeHasContentTypeText004(){
    client.get().uri("/actuator/prometheus").exchange().expectStatus().isOk().expectHeader().contentType(MediaType.parseMediaType(TextFormat.CONTENT_TYPE_004));
  }
@Configuration static class TestConfiguration {
    @Bean public PrometheusScrapeEndpoint prometheusScrapeEndpoint(    CollectorRegistry collectorRegistry){
      return new PrometheusScrapeEndpoint(collectorRegistry);
    }
    @Bean public CollectorRegistry collectorRegistry(){
      return new CollectorRegistry(true);
    }
    @Bean public MeterRegistry registry(    CollectorRegistry registry){
      return new PrometheusMeterRegistry((k) -> null,registry,Clock.SYSTEM);
    }
  }
}
