/** 
 * Test  {@link MockBean} when used in combination with scoped proxy targets.
 * @author Phillip Webb
 * @see <a href="https://github.com/spring-projects/spring-boot/issues/5724">gh-5724</a>
 */
@RunWith(SpringRunner.class) public class MockBeanOnScopedProxyTests {
  @MockBean private ExampleService exampleService;
  @Autowired private ExampleServiceCaller caller;
  @Test public void testMocking(){
    given(this.caller.getService().greeting()).willReturn("Boot");
    assertThat(this.caller.sayGreeting()).isEqualTo("I say Boot");
  }
@Configuration @Import({ExampleServiceCaller.class}) static class Config {
    @Bean @Scope(proxyMode=ScopedProxyMode.TARGET_CLASS) public ExampleService exampleService(){
      return new FailingExampleService();
    }
  }
}
