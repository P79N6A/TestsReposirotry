/** 
 * Test  {@link MockBean} for a factory bean.
 * @author Phillip Webb
 */
@RunWith(SpringRunner.class) public class MockBeanForBeanFactoryIntegrationTests {
  @MockBean private TestFactoryBean testFactoryBean;
  @Autowired private ApplicationContext applicationContext;
  @Test @SuppressWarnings({"unchecked","rawtypes"}) public void testName(){
    TestBean testBean=mock(TestBean.class);
    given(testBean.hello()).willReturn("amock");
    given(this.testFactoryBean.getObjectType()).willReturn((Class)TestBean.class);
    given(this.testFactoryBean.getObject()).willReturn(testBean);
    TestBean bean=this.applicationContext.getBean(TestBean.class);
    assertThat(bean.hello()).isEqualTo("amock");
  }
@Configuration static class Config {
    @Bean public TestFactoryBean testFactoryBean(){
      return new TestFactoryBean();
    }
  }
static class TestFactoryBean implements FactoryBean<TestBean> {
    @Override public TestBean getObject(){
      return () -> "normal";
    }
    @Override public Class<?> getObjectType(){
      return TestBean.class;
    }
    @Override public boolean isSingleton(){
      return false;
    }
  }
interface TestBean {
    String hello();
  }
}
