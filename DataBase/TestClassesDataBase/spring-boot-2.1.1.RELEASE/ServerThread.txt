private class ServerThread extends Thread {
  @Override public void run(){
    try {
      SocketChannel channel=MockServer.this.serverSocket.accept();
      Thread.sleep(MockServer.this.delay);
      if (MockServer.this.send != null) {
        ByteBuffer buffer=ByteBuffer.wrap(MockServer.this.send);
        while (buffer.hasRemaining()) {
          channel.write(buffer);
        }
      }
      if (MockServer.this.expect != null) {
        ByteBuffer buffer=ByteBuffer.allocate(MockServer.this.expect.length);
        while (buffer.hasRemaining()) {
          channel.read(buffer);
        }
        MockServer.this.actualRead=buffer;
      }
      channel.close();
    }
 catch (    Exception ex) {
      fail();
    }
  }
}
