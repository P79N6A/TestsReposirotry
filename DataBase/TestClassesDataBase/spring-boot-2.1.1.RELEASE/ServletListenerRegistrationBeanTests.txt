/** 
 * Tests for  {@link ServletListenerRegistrationBean}.
 * @author Dave Syer
 */
public class ServletListenerRegistrationBeanTests {
  @Mock private ServletContextListener listener;
  @Mock private ServletContext servletContext;
  @Before public void setupMocks(){
    MockitoAnnotations.initMocks(this);
  }
  @Test public void startupWithDefaults() throws Exception {
    ServletListenerRegistrationBean<ServletContextListener> bean=new ServletListenerRegistrationBean<>(this.listener);
    bean.onStartup(this.servletContext);
    verify(this.servletContext).addListener(this.listener);
  }
  @Test public void disable() throws Exception {
    ServletListenerRegistrationBean<ServletContextListener> bean=new ServletListenerRegistrationBean<>(this.listener);
    bean.setEnabled(false);
    bean.onStartup(this.servletContext);
    verify(this.servletContext,never()).addListener(any(ServletContextListener.class));
  }
  @Test public void cannotRegisterUnsupportedType(){
    assertThatIllegalArgumentException().isThrownBy(() -> new ServletListenerRegistrationBean<>(new EventListener(){
    }
)).withMessageContaining("Listener is not of a supported type");
  }
}
