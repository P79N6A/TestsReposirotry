@EnableBatchProcessing @TestAutoConfigurationPackage(City.class) protected static class TestCustomConfiguration implements BatchConfigurer {
  private JobRepository jobRepository;
  private MapJobRepositoryFactoryBean factory=new MapJobRepositoryFactoryBean();
  @Override public JobRepository getJobRepository() throws Exception {
    if (this.jobRepository == null) {
      this.factory.afterPropertiesSet();
      this.jobRepository=this.factory.getObject();
    }
    return this.jobRepository;
  }
  @Override public PlatformTransactionManager getTransactionManager(){
    return new ResourcelessTransactionManager();
  }
  @Override public JobLauncher getJobLauncher(){
    SimpleJobLauncher launcher=new SimpleJobLauncher();
    launcher.setJobRepository(this.jobRepository);
    return launcher;
  }
  @Override public JobExplorer getJobExplorer() throws Exception {
    MapJobExplorerFactoryBean explorer=new MapJobExplorerFactoryBean(this.factory);
    explorer.afterPropertiesSet();
    return explorer.getObject();
  }
}
