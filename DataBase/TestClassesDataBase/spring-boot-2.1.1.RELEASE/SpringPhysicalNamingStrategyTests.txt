/** 
 * Tests for  {@link SpringPhysicalNamingStrategy}.
 * @author Phillip Webb
 * @author Madhura Bhave
 */
public class SpringPhysicalNamingStrategyTests {
  private Metadata metadata;
  private MetadataSources metadataSources;
  @Before public void setup(){
    this.metadataSources=new MetadataSources(createServiceRegistry());
    this.metadataSources.addAnnotatedClass(TelephoneNumber.class);
    this.metadata=this.metadataSources.getMetadataBuilder().applyPhysicalNamingStrategy(new SpringPhysicalNamingStrategy()).build();
  }
  private StandardServiceRegistry createServiceRegistry(){
    return new StandardServiceRegistryBuilder().applySetting(AvailableSettings.DIALECT,H2Dialect.class).build();
  }
  @Test public void tableNameShouldBeLowercaseUnderscore(){
    PersistentClass binding=this.metadata.getEntityBinding(TelephoneNumber.class.getName());
    assertThat(binding.getTable().getQuotedName()).isEqualTo("telephone_number");
  }
  @Test public void tableNameShouldNotBeLowerCaseIfCaseSensitive(){
    this.metadata=this.metadataSources.getMetadataBuilder().applyPhysicalNamingStrategy(new TestSpringPhysicalNamingStrategy()).build();
    PersistentClass binding=this.metadata.getEntityBinding(TelephoneNumber.class.getName());
    assertThat(binding.getTable().getQuotedName()).isEqualTo("Telephone_Number");
  }
private class TestSpringPhysicalNamingStrategy extends SpringPhysicalNamingStrategy {
    @Override protected boolean isCaseInsensitive(    JdbcEnvironment jdbcEnvironment){
      return false;
    }
  }
}
