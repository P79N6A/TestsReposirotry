public class ComplexTypeTest {
  private static SqlSessionFactory sqlSessionFactory;
  @BeforeClass public static void setUp() throws Exception {
    Reader reader=Resources.getResourceAsReader("org/apache/ibatis/submitted/complex_type/mybatis-config.xml");
    sqlSessionFactory=new SqlSessionFactoryBuilder().build(reader);
    reader.close();
    SqlSession session=sqlSessionFactory.openSession();
    Connection conn=session.getConnection();
    reader=Resources.getResourceAsReader("org/apache/ibatis/submitted/complex_type/CreateDB.sql");
    ScriptRunner runner=new ScriptRunner(conn);
    runner.setLogWriter(null);
    runner.runScript(reader);
    conn.close();
    reader.close();
    session.close();
  }
  @Test public void shouldUpdateProps(){
    SqlSession sqlSession=sqlSessionFactory.openSession();
    try {
      Item item=new Item();
      item.id=10;
      Property p1=new Property();
      p1.id=11;
      p1.value="value11";
      Property p2=new Property();
      p2.id=12;
      p2.value="value12";
      List<Property> list=new ArrayList<Property>();
      list.add(p1);
      list.add(p2);
      item.properties=list;
      sqlSession.update("updateProps",item);
    }
  finally {
      sqlSession.close();
    }
  }
}
