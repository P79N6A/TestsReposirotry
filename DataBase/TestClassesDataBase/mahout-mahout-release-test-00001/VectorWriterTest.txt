public final class VectorWriterTest extends MahoutTestCase {
  @Test public void testSFVW() throws Exception {
    Path path=getTestTempFilePath("sfvw");
    Configuration conf=getConfiguration();
    FileSystem fs=FileSystem.get(conf);
    SequenceFile.Writer seqWriter=new SequenceFile.Writer(fs,conf,path,LongWritable.class,VectorWritable.class);
    try (SequenceFileVectorWriter writer=new SequenceFileVectorWriter(seqWriter)){
      writer.write(new RandomVectorIterable(50));
    }
     long count=HadoopUtil.countRecords(path,conf);
    assertEquals(50,count);
  }
  @Test public void testTextOutputSize() throws Exception {
    StringWriter strWriter=new StringWriter();
    try (VectorWriter writer=new TextualVectorWriter(strWriter)){
      Collection<Vector> vectors=new ArrayList<>();
      vectors.add(new DenseVector(new double[]{0.3,1.5,4.5}));
      vectors.add(new DenseVector(new double[]{1.3,1.5,3.5}));
      writer.write(vectors);
    }
     String buffer=strWriter.toString();
    assertNotNull(buffer);
    assertFalse(buffer.isEmpty());
  }
}
