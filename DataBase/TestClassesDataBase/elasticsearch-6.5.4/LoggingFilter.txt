public static class LoggingFilter extends ActionFilter.Simple {
  private final ThreadPool threadPool;
  public LoggingFilter(  Settings settings,  ThreadPool pool){
    super(settings);
    this.threadPool=pool;
  }
  @Override public int order(){
    return 999;
  }
  @Override protected boolean apply(  String action,  ActionRequest request,  ActionListener<?> listener){
    requests.add(new RequestAndHeaders(threadPool.getThreadContext().getHeaders(),request));
    return true;
  }
}
