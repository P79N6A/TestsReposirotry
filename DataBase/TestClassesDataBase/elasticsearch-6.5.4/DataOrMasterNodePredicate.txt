private static final class DataOrMasterNodePredicate implements Predicate<NodeAndClient> {
  @Override public boolean test(  NodeAndClient nodeAndClient){
    return DiscoveryNode.isDataNode(nodeAndClient.node.settings()) || DiscoveryNode.isMasterNode(nodeAndClient.node.settings());
  }
}
