static class CapturingTransportChannel implements TransportChannel {
  AtomicReference<TransportResponse> response=new AtomicReference<>();
  AtomicReference<Throwable> error=new AtomicReference<>();
  public void clear(){
    response.set(null);
    error.set(null);
  }
  @Override public String getProfileName(){
    return "_noop_";
  }
  @Override public void sendResponse(  TransportResponse response) throws IOException {
    this.response.set(response);
    assertThat(error.get(),nullValue());
  }
  @Override public void sendResponse(  TransportResponse response,  TransportResponseOptions options) throws IOException {
    this.response.set(response);
    assertThat(error.get(),nullValue());
  }
  @Override public void sendResponse(  Exception exception) throws IOException {
    this.error.set(exception);
    assertThat(response.get(),nullValue());
  }
  @Override public String getChannelType(){
    return "capturing";
  }
}
