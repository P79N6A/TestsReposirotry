public static class ActionLoggingPlugin extends Plugin implements ActionPlugin {
  private final SetOnce<LoggingFilter> loggingFilter=new SetOnce<>();
  @Override public Collection<Object> createComponents(  Client client,  ClusterService clusterService,  ThreadPool threadPool,  ResourceWatcherService resourceWatcherService,  ScriptService scriptService,  NamedXContentRegistry xContentRegistry,  Environment environment,  NodeEnvironment nodeEnvironment,  NamedWriteableRegistry namedWriteableRegistry){
    loggingFilter.set(new LoggingFilter(clusterService.getSettings(),threadPool));
    return Collections.emptyList();
  }
  @Override public List<ActionFilter> getActionFilters(){
    return singletonList(loggingFilter.get());
  }
}
