private static class TestResponse {
  private final String method;
  private final int statusCode;
  private final Object response;
  TestResponse(  String method,  int statusCode,  Object response){
    this.method=method;
    this.statusCode=statusCode;
    this.response=response;
  }
  Response getResponse(){
    if (response instanceof Response) {
      return (Response)response;
    }
    if (response instanceof ResponseException) {
      return ((ResponseException)response).getResponse();
    }
    throw new AssertionError("unexpected response " + response.getClass());
  }
}
