final class CloseableDirectory implements Closeable {
  private final BaseDirectoryWrapper dir;
  private final TestRuleMarkFailure failureMarker;
  CloseableDirectory(  BaseDirectoryWrapper dir){
    this.dir=dir;
    this.failureMarker=ESTestCase.getSuiteFailureMarker();
  }
  @Override public void close(){
    try {
      if (failureMarker.wasSuccessful() && dir.isOpen()) {
        Assert.fail("Directory not closed: " + dir);
      }
    }
  finally {
    }
  }
}
