static class LookupNotSupportedRealm extends CachingUsernamePasswordRealm {
  public final AtomicInteger authInvocationCounter=new AtomicInteger(0);
  public final AtomicInteger lookupInvocationCounter=new AtomicInteger(0);
  LookupNotSupportedRealm(  Settings globalSettings,  ThreadPool threadPool){
    super("lookup",new RealmConfig("lookup-notsupported-test",Settings.EMPTY,globalSettings,TestEnvironment.newEnvironment(globalSettings),threadPool.getThreadContext()),threadPool);
  }
  @Override protected void doAuthenticate(  UsernamePasswordToken token,  ActionListener<AuthenticationResult> listener){
    authInvocationCounter.incrementAndGet();
    listener.onResponse(AuthenticationResult.success(new User(token.principal(),new String[]{"testRole1","testRole2"})));
  }
  @Override protected void doLookupUser(  String username,  ActionListener<User> listener){
    lookupInvocationCounter.incrementAndGet();
    listener.onFailure(new UnsupportedOperationException("don't call lookup if lookup isn't supported!!!"));
  }
}
