public class RestNodesActionTests extends ESTestCase {
  private RestNodesAction action;
  @Before public void setUpAction(){
    UsageService usageService=new UsageService(Settings.EMPTY);
    action=new RestNodesAction(Settings.EMPTY,new RestController(Settings.EMPTY,Collections.emptySet(),null,null,null,usageService));
  }
  public void testBuildTableDoesNotThrowGivenNullNodeInfoAndStats(){
    ClusterName clusterName=new ClusterName("cluster-1");
    DiscoveryNodes.Builder builder=DiscoveryNodes.builder();
    builder.add(new DiscoveryNode("node-1",buildNewFakeTransportAddress(),emptyMap(),emptySet(),Version.CURRENT));
    DiscoveryNodes discoveryNodes=builder.build();
    ClusterState clusterState=mock(ClusterState.class);
    when(clusterState.nodes()).thenReturn(discoveryNodes);
    ClusterStateResponse clusterStateResponse=new ClusterStateResponse(clusterName,clusterState,randomNonNegativeLong());
    NodesInfoResponse nodesInfoResponse=new NodesInfoResponse(clusterName,Collections.emptyList(),Collections.emptyList());
    NodesStatsResponse nodesStatsResponse=new NodesStatsResponse(clusterName,Collections.emptyList(),Collections.emptyList());
    action.buildTable(false,new FakeRestRequest(),clusterStateResponse,nodesInfoResponse,nodesStatsResponse);
  }
}
