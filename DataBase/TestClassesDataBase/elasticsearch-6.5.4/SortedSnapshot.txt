static class SortedSnapshot implements Translog.Snapshot {
  private final Translog.Snapshot snapshot;
  private List<Translog.Operation> operations=null;
  SortedSnapshot(  Translog.Snapshot snapshot){
    this.snapshot=snapshot;
  }
  @Override public int totalOperations(){
    return snapshot.totalOperations();
  }
  @Override public Translog.Operation next() throws IOException {
    if (operations == null) {
      operations=new ArrayList<>();
      Translog.Operation op;
      while ((op=snapshot.next()) != null) {
        operations.add(op);
      }
      operations.sort(Comparator.comparing(Translog.Operation::seqNo));
    }
    if (operations.isEmpty()) {
      return null;
    }
    return operations.remove(0);
  }
  @Override public void close() throws IOException {
    snapshot.close();
  }
}
