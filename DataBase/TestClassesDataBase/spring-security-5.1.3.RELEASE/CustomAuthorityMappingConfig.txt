@EnableWebSecurity static class CustomAuthorityMappingConfig extends WebSecurityConfigurerAdapter {
  @Override protected void configure(  HttpSecurity http) throws Exception {
    http.authorizeRequests().antMatchers("/requires-read-scope").access("hasAuthority('message:read')").and().oauth2ResourceServer().jwt().jwtAuthenticationConverter(getJwtAuthenticationConverter());
  }
  Converter<Jwt,AbstractAuthenticationToken> getJwtAuthenticationConverter(){
    return new JwtAuthenticationConverter(){
      @Override protected Collection<GrantedAuthority> extractAuthorities(      Jwt jwt){
        return Collections.singletonList(new SimpleGrantedAuthority("message:read"));
      }
    }
;
  }
}
