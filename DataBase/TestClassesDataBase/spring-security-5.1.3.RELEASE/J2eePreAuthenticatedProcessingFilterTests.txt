/** 
 * @author TSARDD
 * @since 18-okt-2007
 */
public class J2eePreAuthenticatedProcessingFilterTests {
  @Test public final void testGetPreAuthenticatedPrincipal(){
    String user="testUser";
    assertThat(user).isEqualTo(new J2eePreAuthenticatedProcessingFilter().getPreAuthenticatedPrincipal(getRequest(user,new String[]{})));
  }
  @Test public final void testGetPreAuthenticatedCredentials(){
    assertThat("N/A").isEqualTo(new J2eePreAuthenticatedProcessingFilter().getPreAuthenticatedCredentials(getRequest("testUser",new String[]{})));
  }
  private final HttpServletRequest getRequest(  final String aUserName,  final String[] aRoles){
    MockHttpServletRequest req=new MockHttpServletRequest(){
      private Set<String> roles=new HashSet<>(Arrays.asList(aRoles));
      public boolean isUserInRole(      String arg0){
        return roles.contains(arg0);
      }
    }
;
    req.setRemoteUser(aUserName);
    req.setUserPrincipal(new Principal(){
      public String getName(){
        return aUserName;
      }
    }
);
    return req;
  }
}
