@Configuration @EnableGlobalAuthentication @Import(ObjectPostProcessorConfiguration.class) static class UserFromPropertiesConfig {
  @Value("classpath:org/springframework/security/config/users.properties") Resource users;
  @Bean public AuthenticationManager authenticationManager() throws Exception {
    return new ProviderManager(Arrays.asList(authenticationProvider()));
  }
  @Bean public AuthenticationProvider authenticationProvider() throws Exception {
    DaoAuthenticationProvider provider=new DaoAuthenticationProvider();
    provider.setUserDetailsService(userDetailsService());
    return provider;
  }
  @Bean public UserDetailsService userDetailsService() throws Exception {
    Properties properties=new Properties();
    properties.load(this.users.getInputStream());
    return new InMemoryUserDetailsManager(properties);
  }
}
