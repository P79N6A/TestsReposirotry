@RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration @WebAppConfiguration public class SecurityMockMvcRequestPostProcessorsCsrfDebugFilterTests {
  @Autowired private WebApplicationContext wac;
  @Test public void findCookieCsrfTokenRepository() throws Exception {
    MockHttpServletRequest request=post("/").buildRequest(wac.getServletContext());
    CsrfTokenRepository csrfTokenRepository=WebTestUtils.getCsrfTokenRepository(request);
    assertThat(csrfTokenRepository).isNotNull();
    assertThat(csrfTokenRepository).isEqualTo(Config.cookieCsrfTokenRepository);
  }
@EnableWebSecurity static class Config extends WebSecurityConfigurerAdapter {
    static CsrfTokenRepository cookieCsrfTokenRepository=new CookieCsrfTokenRepository();
    @Override protected void configure(    HttpSecurity http) throws Exception {
      http.csrf().csrfTokenRepository(cookieCsrfTokenRepository);
    }
    @Override public void configure(    WebSecurity web) throws Exception {
      web.debug(true);
    }
  }
}
