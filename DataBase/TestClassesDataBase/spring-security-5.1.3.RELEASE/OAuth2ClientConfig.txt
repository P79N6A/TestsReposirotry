@EnableWebSecurity @EnableWebMvc static class OAuth2ClientConfig extends WebSecurityConfigurerAdapter {
  @Override protected void configure(  HttpSecurity http) throws Exception {
    http.authorizeRequests().anyRequest().authenticated().and().requestCache().requestCache(requestCache).and().oauth2Client().authorizationCodeGrant().authorizationRequestResolver(authorizationRequestResolver).accessTokenResponseClient(accessTokenResponseClient);
  }
  @Bean public ClientRegistrationRepository clientRegistrationRepository(){
    return clientRegistrationRepository;
  }
  @Bean public OAuth2AuthorizedClientRepository authorizedClientRepository(){
    return authorizedClientRepository;
  }
@RestController public class ResourceController {
    @GetMapping("/resource1") public String resource1(    @RegisteredOAuth2AuthorizedClient("registration-1") OAuth2AuthorizedClient authorizedClient){
      return "resource1";
    }
  }
}
