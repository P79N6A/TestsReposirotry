private class MockProvider implements AuthenticationProvider {
  public Authentication authenticate(  Authentication authentication) throws AuthenticationException {
    if (supports(authentication.getClass())) {
      return authentication;
    }
 else {
      throw new AuthenticationServiceException("Don't support this class");
    }
  }
  public boolean supports(  Class<?> authentication){
    return TestingAuthenticationToken.class.isAssignableFrom(authentication) || UsernamePasswordAuthenticationToken.class.isAssignableFrom(authentication);
  }
}
