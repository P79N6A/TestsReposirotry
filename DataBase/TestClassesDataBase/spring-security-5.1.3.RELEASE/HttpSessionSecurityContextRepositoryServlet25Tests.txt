/** 
 * @author Luke Taylor
 * @author Rob Winch
 */
@RunWith(PowerMockRunner.class) @PrepareForTest({ClassUtils.class}) public class HttpSessionSecurityContextRepositoryServlet25Tests {
  @Test public void servlet25Compatability() throws Exception {
    spy(ClassUtils.class);
    when(ClassUtils.class,"hasMethod",ServletRequest.class,"startAsync",new Class[]{}).thenReturn(false);
    HttpSessionSecurityContextRepository repo=new HttpSessionSecurityContextRepository();
    MockHttpServletRequest request=new MockHttpServletRequest();
    MockHttpServletResponse response=new MockHttpServletResponse();
    HttpRequestResponseHolder holder=new HttpRequestResponseHolder(request,response);
    repo.loadContext(holder);
    assertThat(holder.getRequest()).isSameAs(request);
  }
}
