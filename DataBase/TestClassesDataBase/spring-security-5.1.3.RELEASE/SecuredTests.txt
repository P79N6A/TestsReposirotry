/** 
 * @author Rob Winch
 */
@RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration public class SecuredTests {
  @Autowired SecuredServiceImpl service;
  @After public void cleanup(){
    SecurityContextHolder.clearContext();
  }
  @Test(expected=AccessDeniedException.class) public void securedAdminRoleDenied(){
    SecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("user","pass","ROLE_USER"));
    service.securedAdminRole();
  }
  @Test public void securedAdminRoleGranted(){
    SecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("user","pass","ROLE_ADMIN"));
    service.securedAdminRole();
  }
}
