public class SecurityMockMvcRequestBuildersFormLogoutTests {
  private MockServletContext servletContext;
  @Before public void setup(){
    servletContext=new MockServletContext();
  }
  @Test public void defaults() throws Exception {
    MockHttpServletRequest request=logout().buildRequest(servletContext);
    CsrfToken token=(CsrfToken)request.getAttribute(CsrfRequestPostProcessor.TestCsrfTokenRepository.TOKEN_ATTR_NAME);
    assertThat(request.getMethod()).isEqualTo("POST");
    assertThat(request.getParameter(token.getParameterName())).isEqualTo(token.getToken());
    assertThat(request.getRequestURI()).isEqualTo("/logout");
  }
  @Test public void custom() throws Exception {
    MockHttpServletRequest request=logout("/admin/logout").buildRequest(servletContext);
    CsrfToken token=(CsrfToken)request.getAttribute(CsrfRequestPostProcessor.TestCsrfTokenRepository.TOKEN_ATTR_NAME);
    assertThat(request.getMethod()).isEqualTo("POST");
    assertThat(request.getParameter(token.getParameterName())).isEqualTo(token.getToken());
    assertThat(request.getRequestURI()).isEqualTo("/admin/logout");
  }
}
