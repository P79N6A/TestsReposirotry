/** 
 * <p> Forward Authentication Failure Handler Tests </p>
 * @author Shazin Sadakath
 */
public class ForwardAuthenticationFailureHandlerTests {
  @Test(expected=IllegalArgumentException.class) public void invalidForwardUrl(){
    new ForwardAuthenticationFailureHandler("aaa");
  }
  @Test(expected=IllegalArgumentException.class) public void emptyForwardUrl(){
    new ForwardAuthenticationFailureHandler("");
  }
  @Test public void responseIsForwarded() throws Exception {
    ForwardAuthenticationFailureHandler fafh=new ForwardAuthenticationFailureHandler("/forwardUrl");
    MockHttpServletRequest request=new MockHttpServletRequest();
    MockHttpServletResponse response=new MockHttpServletResponse();
    AuthenticationException e=mock(AuthenticationException.class);
    fafh.onAuthenticationFailure(request,response,e);
    assertThat(response.getForwardedUrl()).isEqualTo("/forwardUrl");
    assertThat(request.getAttribute(WebAttributes.AUTHENTICATION_EXCEPTION)).isEqualTo(e);
  }
}
