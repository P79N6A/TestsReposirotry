/** 
 * @author Michael Simons
 */
public class JaasXmlTests {
  private WebDriver driver;
  private int port;
  @Before public void setup(){
    this.port=Integer.parseInt(System.getProperty("app.httpPort"));
    this.driver=new HtmlUnitDriver();
  }
  @After public void tearDown(){
    this.driver.quit();
  }
  @Test public void accessHomePageWithUnauthenticatedWorks(){
    final HomePage homePage=HomePage.to(this.driver,this.port);
    homePage.assertAt();
  }
  @Test public void accessSecurePageWithUnauthenticatedRequiresLogin(){
    final LoginPage loginPage=SecurePage.to(this.driver,this.port);
    loginPage.assertAt();
  }
  @Test public void authenticatedUserIsSentToOriginalPage(){
    final SecurePage securePage=SecurePage.to(this.driver,this.port).loginForm().username("user").password("user").submit();
    securePage.assertAt();
  }
  @Test public void authenticatedUserLogsOut(){
    final LogoutPage logoutPage=SecurePage.to(this.driver,this.port).loginForm().username("user").password("user").submit().logout();
    logoutPage.assertAt();
    final LoginPage loginPage=SecurePage.to(this.driver,this.port);
    loginPage.assertAt();
  }
}
