public class RoleHierarchyVoterTests {
  @Test public void hierarchicalRoleIsIncludedInDecision(){
    RoleHierarchyImpl roleHierarchyImpl=new RoleHierarchyImpl();
    roleHierarchyImpl.setHierarchy("ROLE_A > ROLE_B");
    TestingAuthenticationToken auth=new TestingAuthenticationToken("user","password","ROLE_A");
    RoleHierarchyVoter voter=new RoleHierarchyVoter(roleHierarchyImpl);
    assertThat(voter.vote(auth,new Object(),SecurityConfig.createList("ROLE_B"))).isEqualTo(RoleHierarchyVoter.ACCESS_GRANTED);
  }
}
