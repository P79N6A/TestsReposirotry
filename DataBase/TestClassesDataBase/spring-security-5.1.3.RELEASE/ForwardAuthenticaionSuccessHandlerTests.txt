/** 
 * <p> Forward Authentication Failure Handler Tests </p>
 * @author Shazin Sadakath
 * @since 4.1
 */
public class ForwardAuthenticaionSuccessHandlerTests {
  @Test(expected=IllegalArgumentException.class) public void invalidForwardUrl(){
    new ForwardAuthenticationSuccessHandler("aaa");
  }
  @Test(expected=IllegalArgumentException.class) public void emptyForwardUrl(){
    new ForwardAuthenticationSuccessHandler("");
  }
  @Test public void responseIsForwarded() throws Exception {
    ForwardAuthenticationSuccessHandler fash=new ForwardAuthenticationSuccessHandler("/forwardUrl");
    MockHttpServletRequest request=new MockHttpServletRequest();
    MockHttpServletResponse response=new MockHttpServletResponse();
    Authentication authentication=mock(Authentication.class);
    fash.onAuthenticationSuccess(request,response,authentication);
    assertThat(response.getForwardedUrl()).isEqualTo("/forwardUrl");
  }
}
