/** 
 * @author Rob Winch
 * @since 5.0
 */
public class XContentTypeOptionsServerHttpHeadersWriterTests {
  ContentTypeOptionsServerHttpHeadersWriter writer=new ContentTypeOptionsServerHttpHeadersWriter();
  ServerWebExchange exchange=MockServerWebExchange.from(MockServerHttpRequest.get("/").build());
  HttpHeaders headers=exchange.getResponse().getHeaders();
  @Test public void writeHeadersWhenNoHeadersThenWriteHeaders(){
    writer.writeHttpHeaders(exchange);
    assertThat(headers).hasSize(1);
    assertThat(headers.get(ContentTypeOptionsServerHttpHeadersWriter.X_CONTENT_OPTIONS)).containsOnly(ContentTypeOptionsServerHttpHeadersWriter.NOSNIFF);
  }
  @Test public void writeHeadersWhenHeaderWrittenThenDoesNotOverrride(){
    String headerValue="value";
    headers.set(ContentTypeOptionsServerHttpHeadersWriter.X_CONTENT_OPTIONS,headerValue);
    writer.writeHttpHeaders(exchange);
    assertThat(headers).hasSize(1);
    assertThat(headers.get(ContentTypeOptionsServerHttpHeadersWriter.X_CONTENT_OPTIONS)).containsOnly(headerValue);
  }
}
