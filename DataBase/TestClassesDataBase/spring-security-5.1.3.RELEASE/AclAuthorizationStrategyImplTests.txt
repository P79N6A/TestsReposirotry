/** 
 * @author Rob Winch
 */
@RunWith(MockitoJUnitRunner.class) public class AclAuthorizationStrategyImplTests {
  @Mock Acl acl;
  GrantedAuthority authority;
  AclAuthorizationStrategyImpl strategy;
  @Before public void setup(){
    authority=new SimpleGrantedAuthority("ROLE_AUTH");
    TestingAuthenticationToken authentication=new TestingAuthenticationToken("foo","bar",Arrays.asList(authority));
    authentication.setAuthenticated(true);
    SecurityContextHolder.getContext().setAuthentication(authentication);
  }
  @After public void cleanup(){
    SecurityContextHolder.clearContext();
  }
  @Test public void securityCheckWhenCustomAuthorityThenNameIsUsed(){
    strategy=new AclAuthorizationStrategyImpl(new CustomAuthority());
    strategy.securityCheck(acl,AclAuthorizationStrategy.CHANGE_GENERAL);
  }
@SuppressWarnings("serial") class CustomAuthority implements GrantedAuthority {
    @Override public String getAuthority(){
      return authority.getAuthority();
    }
  }
}
