/** 
 * Tests  {@link InterceptorStatusToken}.
 * @author Ben Alex
 */
public class InterceptorStatusTokenTests {
  @Test public void testOperation(){
    List<ConfigAttribute> attr=SecurityConfig.createList("FOO");
    MethodInvocation mi=new SimpleMethodInvocation();
    SecurityContext ctx=SecurityContextHolder.createEmptyContext();
    InterceptorStatusToken token=new InterceptorStatusToken(ctx,true,attr,mi);
    assertThat(token.isContextHolderRefreshRequired()).isTrue();
    assertThat(token.getAttributes()).isEqualTo(attr);
    assertThat(token.getSecureObject()).isEqualTo(mi);
    assertThat(token.getSecurityContext()).isSameAs(ctx);
  }
}
