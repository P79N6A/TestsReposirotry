private class MockFilterInvocationDefinitionMap implements FilterInvocationSecurityMetadataSource {
  private Collection<ConfigAttribute> toReturn;
  private String servletPath;
  private boolean provideIterator;
  public MockFilterInvocationDefinitionMap(  String servletPath,  boolean provideIterator,  String... toReturn){
    this.servletPath=servletPath;
    this.toReturn=SecurityConfig.createList(toReturn);
    this.provideIterator=provideIterator;
  }
  public Collection<ConfigAttribute> getAttributes(  Object object) throws IllegalArgumentException {
    FilterInvocation fi=(FilterInvocation)object;
    if (servletPath.equals(fi.getHttpRequest().getServletPath())) {
      return toReturn;
    }
 else {
      return null;
    }
  }
  public Collection<ConfigAttribute> getAllConfigAttributes(){
    if (!provideIterator) {
      return null;
    }
    return toReturn;
  }
  public boolean supports(  Class<?> clazz){
    return true;
  }
}
