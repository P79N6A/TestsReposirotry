/** 
 * @author Rob Winch
 * @since 3.2
 */
@RunWith(MockitoJUnitRunner.class) public class CsrfLogoutHandlerTests {
  @Mock private CsrfTokenRepository csrfTokenRepository;
  private MockHttpServletRequest request;
  private MockHttpServletResponse response;
  private CsrfLogoutHandler handler;
  @Before public void setup(){
    request=new MockHttpServletRequest();
    response=new MockHttpServletResponse();
    handler=new CsrfLogoutHandler(csrfTokenRepository);
  }
  @Test(expected=IllegalArgumentException.class) public void constructorNullCsrfTokenRepository(){
    new CsrfLogoutHandler(null);
  }
  @Test public void logoutRemovesCsrfToken(){
    handler.logout(request,response,new TestingAuthenticationToken("user","password","ROLE_USER"));
    verify(csrfTokenRepository).saveToken(null,request,response);
  }
}
