/** 
 * Tests  {@link org.springframework.security.core.SpringSecurityMessageSource}.
 */
public class SpringSecurityMessageSourceTests {
  @Test public void testOperation(){
    SpringSecurityMessageSource msgs=new SpringSecurityMessageSource();
    assertThat("\u4E0D\u5141\u8BB8\u8BBF\u95EE").isEqualTo(msgs.getMessage("AbstractAccessDecisionManager.accessDenied",null,Locale.SIMPLIFIED_CHINESE));
  }
  @Test public void testReplacableLookup(){
    Locale before=LocaleContextHolder.getLocale();
    LocaleContextHolder.setLocale(Locale.FRENCH);
    MessageSourceAccessor messages=SpringSecurityMessageSource.getAccessor();
    assertThat("Le jeton nonce est compromis FOOBAR").isEqualTo(messages.getMessage("DigestAuthenticationFilter.nonceCompromised",new Object[]{"FOOBAR"},"ERROR - FAILED TO LOOKUP"));
    LocaleContextHolder.setLocale(before);
  }
  @Test public void germanSystemLocaleWithEnglishLocaleContextHolder(){
    Locale beforeSystem=Locale.getDefault();
    Locale.setDefault(Locale.GERMAN);
    Locale beforeHolder=LocaleContextHolder.getLocale();
    LocaleContextHolder.setLocale(Locale.US);
    MessageSourceAccessor msgs=SpringSecurityMessageSource.getAccessor();
    assertThat("Access is denied").isEqualTo(msgs.getMessage("AbstractAccessDecisionManager.accessDenied","Ooops"));
    Locale.setDefault(beforeSystem);
    LocaleContextHolder.setLocale(beforeHolder);
  }
}
