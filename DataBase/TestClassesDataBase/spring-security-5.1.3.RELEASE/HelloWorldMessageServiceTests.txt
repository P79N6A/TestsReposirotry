/** 
 * @author Rob Winch
 * @since 5.0
 */
@RunWith(SpringRunner.class) @SpringBootTest public class HelloWorldMessageServiceTests {
  @Autowired HelloWorldMessageService messages;
  @Test public void messagesWhenNotAuthenticatedThenDenied(){
    StepVerifier.create(this.messages.findMessage()).expectError(AccessDeniedException.class).verify();
  }
  @Test @WithMockUser public void messagesWhenUserThenDenied(){
    StepVerifier.create(this.messages.findMessage()).expectError(AccessDeniedException.class).verify();
  }
  @Test @WithMockUser(roles="ADMIN") public void messagesWhenAdminThenOk(){
    StepVerifier.create(this.messages.findMessage()).expectNext("Hello World!").verifyComplete();
  }
}
