/** 
 * Tests  {@link LdapUserDetailsImpl}
 * @author Joe Grandja
 */
public class LdapUserDetailsImplTests {
  @Test public void credentialsAreCleared(){
    LdapUserDetailsImpl.Essence mutableLdapUserDetails=new LdapUserDetailsImpl.Essence();
    mutableLdapUserDetails.setDn("uid=username1,ou=people,dc=example,dc=com");
    mutableLdapUserDetails.setUsername("username1");
    mutableLdapUserDetails.setPassword("password");
    LdapUserDetails ldapUserDetails=mutableLdapUserDetails.createUserDetails();
    assertThat(ldapUserDetails).isInstanceOf(CredentialsContainer.class);
    ldapUserDetails.eraseCredentials();
    assertThat(ldapUserDetails.getPassword()).isNull();
  }
}
