/** 
 * @author Michael Simons
 */
public class ContactsTests {
  private WebDriver driver;
  private int port;
  @Before public void setup(){
    this.port=Integer.parseInt(System.getProperty("app.httpPort"));
    this.driver=new HtmlUnitDriver();
  }
  @After public void tearDown(){
    this.driver.quit();
  }
  @Test public void accessHomePageWithUnauthenticatedUserSuccess(){
    final HomePage homePage=HomePage.to(this.driver,this.port);
    homePage.assertAt();
  }
  @Test public void authenticatedUserCanAddContacts(){
    final String name="Rob Winch";
    final String email="rob@example.com";
    ContactsPage.accessManagePageWithUnauthenticatedUser(this.driver,this.port).sendsToLoginPage().username("rod").password("koala").submit().isAtContactsPage().addContact().name(name).email(email).submit().andHasContact(name,email).delete().andConfirmDeletion().isAtContactsPage().andConctactHasBeenRemoved(name,email);
  }
  @Test public void authenticatedUserLogsOut(){
    final HomePage homePage=ContactsPage.accessManagePageWithUnauthenticatedUser(this.driver,this.port).sendsToLoginPage().username("rod").password("koala").submit().isAtContactsPage().logout();
    homePage.assertAt();
    ContactsPage.accessManagePageWithUnauthenticatedUser(this.driver,this.port).sendsToLoginPage();
  }
}
