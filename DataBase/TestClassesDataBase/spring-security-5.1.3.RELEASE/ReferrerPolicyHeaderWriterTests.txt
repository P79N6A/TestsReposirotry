/** 
 * @author Eddú Meléndez
 */
public class ReferrerPolicyHeaderWriterTests {
  private final String DEFAULT_REFERRER_POLICY="no-referrer";
  private MockHttpServletRequest request;
  private MockHttpServletResponse response;
  private ReferrerPolicyHeaderWriter writer;
  @Before public void setup(){
    this.request=new MockHttpServletRequest();
    this.request.setSecure(true);
    this.response=new MockHttpServletResponse();
    this.writer=new ReferrerPolicyHeaderWriter();
  }
  @Test public void writeHeadersReferrerPolicyDefault(){
    this.writer.writeHeaders(this.request,this.response);
    assertThat(this.response.getHeaderNames()).hasSize(1);
    assertThat(this.response.getHeader("Referrer-Policy")).isEqualTo(DEFAULT_REFERRER_POLICY);
  }
  @Test public void writeHeadersReferrerPolicyCustom(){
    this.writer=new ReferrerPolicyHeaderWriter(ReferrerPolicy.SAME_ORIGIN);
    this.writer.writeHeaders(this.request,this.response);
    assertThat(this.response.getHeaderNames()).hasSize(1);
    assertThat(this.response.getHeader("Referrer-Policy")).isEqualTo("same-origin");
  }
  @Test(expected=IllegalArgumentException.class) public void writeHeaderReferrerPolicyInvalid(){
    this.writer=new ReferrerPolicyHeaderWriter(null);
  }
}
