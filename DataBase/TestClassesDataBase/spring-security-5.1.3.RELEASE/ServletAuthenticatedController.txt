@RestController public static class ServletAuthenticatedController {
  @GetMapping("/v2/good-login") public String v2Login(  HttpServletRequest request) throws ServletException {
    request.login("user2","password2");
    return this.principal();
  }
  @GetMapping("/good-login") public String login(  HttpServletRequest request) throws ServletException {
    request.login("user","password");
    return this.principal();
  }
  @GetMapping("/v2/authenticate") public String v2Authenticate(  HttpServletRequest request,  HttpServletResponse response) throws IOException, ServletException {
    return this.authenticate(request,response);
  }
  @GetMapping("/authenticate") public String authenticate(  HttpServletRequest request,  HttpServletResponse response) throws IOException, ServletException {
    request.authenticate(response);
    return this.principal();
  }
  @GetMapping("/v2/do-logout") public String v2Logout(  HttpServletRequest request) throws ServletException {
    return this.logout(request);
  }
  @GetMapping("/do-logout") public String logout(  HttpServletRequest request) throws ServletException {
    request.logout();
    return this.principal();
  }
  @GetMapping("/role") public String role(  HttpServletRequest request){
    return String.valueOf(request.isUserInRole("USER"));
  }
  private String principal(){
    if (SecurityContextHolder.getContext().getAuthentication() != null) {
      return SecurityContextHolder.getContext().getAuthentication().getName();
    }
    return null;
  }
}
