@EnableWebSecurity static class AuthenticationManagerRefConfig extends WebSecurityConfigurerAdapter {
  static AuthenticationManager AUTHENTICATION_MANAGER;
  @Override protected AuthenticationManager authenticationManager() throws Exception {
    return AUTHENTICATION_MANAGER;
  }
  @Override protected void configure(  HttpSecurity http) throws Exception {
    http.authorizeRequests().anyRequest().authenticated().and().formLogin();
  }
}
