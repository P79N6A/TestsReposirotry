/** 
 * @author Luke Taylor
 */
public class RoleVoterTests {
  @Test public void oneMatchingAttributeGrantsAccess(){
    RoleVoter voter=new RoleVoter();
    voter.setRolePrefix("");
    Authentication userAB=new TestingAuthenticationToken("user","pass","A","B");
    assertThat(voter.vote(userAB,this,SecurityConfig.createList("A","C"))).isEqualTo(AccessDecisionVoter.ACCESS_GRANTED);
  }
  @Test public void nullAuthenticationDenies(){
    RoleVoter voter=new RoleVoter();
    voter.setRolePrefix("");
    Authentication notAuthenitcated=null;
    assertThat(voter.vote(notAuthenitcated,this,SecurityConfig.createList("A"))).isEqualTo(AccessDecisionVoter.ACCESS_DENIED);
  }
}
