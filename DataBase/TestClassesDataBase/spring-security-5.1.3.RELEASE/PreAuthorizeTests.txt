/** 
 * @author Rob Winch
 */
@RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration public class PreAuthorizeTests {
  @Autowired PreAuthorizeServiceImpl service;
  @After public void cleanup(){
    SecurityContextHolder.clearContext();
  }
  @Test(expected=AccessDeniedException.class) public void preAuthorizeAdminRoleDenied(){
    SecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("user","pass","ROLE_USER"));
    service.preAuthorizeAdminRole();
  }
  @Test public void preAuthorizeAdminRoleGranted(){
    SecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("user","pass","ROLE_ADMIN"));
    service.preAuthorizeAdminRole();
  }
  @Test public void preAuthorizeContactPermissionGranted(){
    SecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("user","pass","ROLE_ADMIN"));
    service.contactPermission(new Contact("user"));
  }
  @Test(expected=AccessDeniedException.class) public void preAuthorizeContactPermissionDenied(){
    SecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("user","pass","ROLE_ADMIN"));
    service.contactPermission(new Contact("admin"));
  }
}
