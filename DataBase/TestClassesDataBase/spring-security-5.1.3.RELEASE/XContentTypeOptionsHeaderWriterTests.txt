/** 
 * @author Rob Winch
 */
public class XContentTypeOptionsHeaderWriterTests {
  private MockHttpServletRequest request;
  private MockHttpServletResponse response;
  private XContentTypeOptionsHeaderWriter writer;
  @Before public void setup(){
    request=new MockHttpServletRequest();
    response=new MockHttpServletResponse();
    writer=new XContentTypeOptionsHeaderWriter();
  }
  @Test public void writeHeaders(){
    writer.writeHeaders(request,response);
    assertThat(response.getHeaderNames()).hasSize(1);
    assertThat(response.getHeaderValues("X-Content-Type-Options")).containsExactly("nosniff");
  }
}
