@Configuration @EnableWebSocketMessageBroker @Import(SyncExecutorConfig.class) static class WebSocketSecurityConfig extends AbstractSecurityWebSocketMessageBrokerConfigurer {
  public void registerStompEndpoints(  StompEndpointRegistry registry){
    registry.addEndpoint("/websocket").setHandshakeHandler(testHandshakeHandler()).addInterceptors(new HttpSessionHandshakeInterceptor());
  }
  @Override protected void configureInbound(  MessageSecurityMetadataSourceRegistry messages){
    messages.simpDestMatchers("/permitAll/**").permitAll().simpDestMatchers("/customExpression/**").access("denyRob").anyMessage().denyAll();
  }
  @Bean public TestHandshakeHandler testHandshakeHandler(){
    return new TestHandshakeHandler();
  }
}
