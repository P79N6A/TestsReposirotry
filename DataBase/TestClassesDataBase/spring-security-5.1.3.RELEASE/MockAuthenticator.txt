class MockAuthenticator implements LdapAuthenticator {
  public DirContextOperations authenticate(  Authentication authentication){
    DirContextAdapter ctx=new DirContextAdapter();
    ctx.setAttributeValue("ou","FROM_ENTRY");
    String username=authentication.getName();
    String password=(String)authentication.getCredentials();
    if (username.equals("ben") && password.equals("benspassword")) {
      ctx.setDn(new DistinguishedName("cn=ben,ou=people,dc=springframework,dc=org"));
      ctx.setAttributeValue("userPassword","{SHA}nFCebWjxfaLbHHG1Qk5UU4trbvQ=");
      return ctx;
    }
 else     if (username.equals("jen") && password.equals("")) {
      ctx.setDn(new DistinguishedName("cn=jen,ou=people,dc=springframework,dc=org"));
      return ctx;
    }
    throw new BadCredentialsException("Authentication failed.");
  }
}
