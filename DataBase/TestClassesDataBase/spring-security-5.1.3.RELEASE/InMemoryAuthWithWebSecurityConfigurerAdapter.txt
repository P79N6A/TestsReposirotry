@EnableWebSecurity static class InMemoryAuthWithWebSecurityConfigurerAdapter extends WebSecurityConfigurerAdapter implements ApplicationListener<AuthenticationSuccessEvent> {
  static List<AuthenticationSuccessEvent> EVENTS=new ArrayList<>();
  @Override protected void configure(  AuthenticationManagerBuilder auth) throws Exception {
    auth.inMemoryAuthentication().withUser(PasswordEncodedUser.user());
  }
  @Override public void onApplicationEvent(  AuthenticationSuccessEvent event){
    EVENTS.add(event);
  }
}
