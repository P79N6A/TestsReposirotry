@EnableWebSecurity static class AuthenticationProviderRefConfig extends WebSecurityConfigurerAdapter {
  protected void configure(  AuthenticationManagerBuilder auth) throws Exception {
    auth.authenticationProvider(authenticationProvider());
  }
  @Bean public DaoAuthenticationProvider authenticationProvider(){
    DaoAuthenticationProvider result=new DaoAuthenticationProvider();
    result.setUserDetailsService(new InMemoryUserDetailsManager(PasswordEncodedUser.user()));
    return result;
  }
}
