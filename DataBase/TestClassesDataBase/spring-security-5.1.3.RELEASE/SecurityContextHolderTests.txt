/** 
 * Tests  {@link SecurityContextHolder}.
 * @author Ben Alex
 */
public class SecurityContextHolderTests {
  @Before public final void setUp() throws Exception {
    SecurityContextHolder.setStrategyName(SecurityContextHolder.MODE_INHERITABLETHREADLOCAL);
  }
  @Test public void testContextHolderGetterSetterClearer(){
    SecurityContext sc=new SecurityContextImpl();
    sc.setAuthentication(new UsernamePasswordAuthenticationToken("Foobar","pass"));
    SecurityContextHolder.setContext(sc);
    assertThat(SecurityContextHolder.getContext()).isEqualTo(sc);
    SecurityContextHolder.clearContext();
    assertThat(SecurityContextHolder.getContext()).isNotSameAs(sc);
    SecurityContextHolder.clearContext();
  }
  @Test public void testNeverReturnsNull(){
    assertThat(SecurityContextHolder.getContext()).isNotNull();
    SecurityContextHolder.clearContext();
  }
  @Test public void testRejectsNulls(){
    try {
      SecurityContextHolder.setContext(null);
      fail("Should have rejected null");
    }
 catch (    IllegalArgumentException expected) {
    }
  }
}
