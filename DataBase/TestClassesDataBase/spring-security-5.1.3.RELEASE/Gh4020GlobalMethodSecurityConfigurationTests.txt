/** 
 * @author Rob Winch
 */
@RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration public class Gh4020GlobalMethodSecurityConfigurationTests {
  @Autowired DenyAllService denyAll;
  @Test(expected=AuthenticationCredentialsNotFoundException.class) public void denyAll(){
    this.denyAll.denyAll();
  }
@Configuration @EnableGlobalMethodSecurity(prePostEnabled=true) static class SecurityConfig {
    @Bean PermissionEvaluator permissionEvaluator(){
      return mock(PermissionEvaluator.class);
    }
    @Bean RoleHierarchy RoleHierarchy(){
      return mock(RoleHierarchy.class);
    }
    @Bean AuthenticationTrustResolver trustResolver(){
      return mock(AuthenticationTrustResolver.class);
    }
    @Autowired DenyAllService denyAll;
  }
@Configuration static class ServiceConfig {
    @Bean DenyAllService denyAllService(){
      return new DenyAllService();
    }
  }
@PreAuthorize("denyAll") static class DenyAllService {
    void denyAll(){
    }
  }
}
