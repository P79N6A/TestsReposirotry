@Configuration @EnableTransactionManagement @ImportResource("org/springframework/transaction/annotation/enable-caching.xml") static class EnableTxAndCachingConfig {
  @Bean public PlatformTransactionManager txManager(){
    return new CallCountingTransactionManager();
  }
  @Bean public FooRepository fooRepository(){
    return new DummyFooRepository();
  }
  @Bean public CacheManager cacheManager(){
    SimpleCacheManager mgr=new SimpleCacheManager();
    ArrayList<Cache> caches=new ArrayList<>();
    caches.add(new ConcurrentMapCache(""));
    mgr.setCaches(caches);
    return mgr;
  }
}
