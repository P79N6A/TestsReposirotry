/** 
 * Fires on setter methods that take a string. Replaces null arg with "".
 */
@SuppressWarnings("serial") protected static class StringSetterNullReplacementAdvice extends DefaultPointcutAdvisor {
  private static MethodInterceptor cleaner=new MethodInterceptor(){
    @Override public Object invoke(    MethodInvocation mi) throws Throwable {
      mi.getArguments()[0]="";
      return mi.proceed();
    }
  }
;
  public StringSetterNullReplacementAdvice(){
    super(cleaner);
    setPointcut(new DynamicMethodMatcherPointcut(){
      @Override public boolean matches(      Method m,      @Nullable Class<?> targetClass,      Object... args){
        return args[0] == null;
      }
      @Override public boolean matches(      Method m,      @Nullable Class<?> targetClass){
        return m.getName().startsWith("set") && m.getParameterCount() == 1 && m.getParameterTypes()[0].equals(String.class);
      }
    }
);
  }
}
