@Configuration protected static class ConfigWithAbstractFactoryBeanAsReturnType {
  @Bean public AbstractFactoryBean<FooInterface> foo(){
    return new AbstractFactoryBean<FooInterface>(){
      @Override public FooInterface createInstance(){
        return new Foo("x");
      }
      @Override public Class<?> getObjectType(){
        return Foo.class;
      }
    }
;
  }
  @Bean public Bar bar() throws Exception {
    assertTrue(foo().isSingleton());
    return new Bar(foo().getObject());
  }
}
