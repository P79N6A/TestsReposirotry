@SuppressWarnings("unused") private static class NonPrivilegedFactoryBean implements SmartFactoryBean {
  private String expectedName;
  public NonPrivilegedFactoryBean(  String expected){
    this.expectedName=expected;
    checkCurrentContext();
  }
  @Override public boolean isEagerInit(){
    checkCurrentContext();
    return false;
  }
  @Override public boolean isPrototype(){
    checkCurrentContext();
    return true;
  }
  @Override public Object getObject() throws Exception {
    checkCurrentContext();
    return new Object();
  }
  @Override public Class getObjectType(){
    checkCurrentContext();
    return Object.class;
  }
  @Override public boolean isSingleton(){
    checkCurrentContext();
    return false;
  }
  private void checkCurrentContext(){
    assertEquals(expectedName,getCurrentSubjectName());
  }
}
