@SuppressWarnings("serial") private static class CountingExecutor extends SimpleAsyncTaskExecutor {
  int submitStartCounter;
  int submitCompleteCounter;
  @Override public <T>Future<T> submit(  Callable<T> task){
    submitStartCounter++;
    Future<T> future=super.submit(task);
    submitCompleteCounter++;
synchronized (this) {
      notifyAll();
    }
    return future;
  }
  public synchronized void waitForCompletion(){
    try {
      wait(WAIT_TIME);
    }
 catch (    InterruptedException ex) {
      fail("Didn't finish the async job in " + WAIT_TIME + " milliseconds");
    }
  }
}
