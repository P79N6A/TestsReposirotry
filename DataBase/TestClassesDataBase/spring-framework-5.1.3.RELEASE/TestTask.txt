private static class TestTask implements Runnable {
  private final int expectedRunCount;
  private final AtomicInteger actualRunCount=new AtomicInteger();
  private final CountDownLatch latch;
  private Thread lastThread;
  TestTask(  int expectedRunCount){
    this.expectedRunCount=expectedRunCount;
    this.latch=(expectedRunCount > 0 ? new CountDownLatch(expectedRunCount) : null);
  }
  @Override public void run(){
    lastThread=Thread.currentThread();
    try {
      Thread.sleep(10);
    }
 catch (    InterruptedException ex) {
    }
    if (expectedRunCount >= 0) {
      if (actualRunCount.incrementAndGet() > expectedRunCount) {
        throw new RuntimeException("intentional test failure");
      }
      latch.countDown();
    }
  }
}
