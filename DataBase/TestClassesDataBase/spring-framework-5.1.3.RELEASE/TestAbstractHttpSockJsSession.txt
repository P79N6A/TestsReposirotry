static class TestAbstractHttpSockJsSession extends StreamingSockJsSession {
  private IOException exceptionOnWriteFrame;
  private boolean cacheFlushed;
  private boolean heartbeatScheduled;
  public TestAbstractHttpSockJsSession(  SockJsServiceConfig config,  WebSocketHandler handler,  Map<String,Object> attributes){
    super("1",config,handler,attributes);
  }
  @Override protected byte[] getPrelude(  ServerHttpRequest request){
    return "hhh\n".getBytes();
  }
  public boolean wasCacheFlushed(){
    return this.cacheFlushed;
  }
  public boolean wasHeartbeatScheduled(){
    return this.heartbeatScheduled;
  }
  public void setExceptionOnWriteFrame(  IOException exceptionOnWriteFrame){
    this.exceptionOnWriteFrame=exceptionOnWriteFrame;
  }
  @Override protected void flushCache(){
    this.cacheFlushed=true;
    scheduleHeartbeat();
  }
  @Override protected void scheduleHeartbeat(){
    this.heartbeatScheduled=true;
  }
  @Override protected synchronized void writeFrameInternal(  SockJsFrame frame) throws IOException {
    if (this.exceptionOnWriteFrame != null) {
      throw this.exceptionOnWriteFrame;
    }
 else {
      super.writeFrameInternal(frame);
    }
  }
}
