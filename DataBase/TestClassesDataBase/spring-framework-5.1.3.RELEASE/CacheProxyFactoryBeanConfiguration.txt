@Configuration @EnableCaching static class CacheProxyFactoryBeanConfiguration {
  @Bean ConcurrentMapCacheManager cacheManager(){
    return new ConcurrentMapCacheManager("Greetings");
  }
  @Bean CacheProxyFactoryBean greeter(){
    CacheProxyFactoryBean factoryBean=new CacheProxyFactoryBean();
    factoryBean.setCacheOperationSources(newCacheOperationSource("greet",newCacheOperation("Greetings")));
    factoryBean.setTarget(new SimpleGreeter());
    return factoryBean;
  }
  CacheOperationSource newCacheOperationSource(  String methodName,  CacheOperation... cacheOperations){
    NameMatchCacheOperationSource cacheOperationSource=new NameMatchCacheOperationSource();
    cacheOperationSource.addCacheMethod(methodName,Arrays.asList(cacheOperations));
    return cacheOperationSource;
  }
  CacheableOperation newCacheOperation(  String cacheName){
    CacheableOperation.Builder builder=new CacheableOperation.Builder();
    builder.setCacheManager("cacheManager");
    builder.setCacheName(cacheName);
    return builder.build();
  }
}
