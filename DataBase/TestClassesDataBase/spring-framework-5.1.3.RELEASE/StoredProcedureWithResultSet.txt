private static class StoredProcedureWithResultSet extends StoredProcedure {
  public static final String SQL="sproc_with_result_set";
  private final SimpleRowCountCallbackHandler handler=new SimpleRowCountCallbackHandler();
  public StoredProcedureWithResultSet(  DataSource ds){
    setDataSource(ds);
    setSql(SQL);
    declareParameter(new SqlReturnResultSet("rs",this.handler));
    compile();
  }
  public void execute(){
    execute(new HashMap<>());
  }
  public int getCount(){
    return this.handler.getCount();
  }
}
