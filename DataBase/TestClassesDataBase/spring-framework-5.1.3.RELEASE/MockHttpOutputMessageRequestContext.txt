private static class MockHttpOutputMessageRequestContext implements RequestContext {
  private final MockHttpOutputMessage outputMessage;
  private MockHttpOutputMessageRequestContext(  MockHttpOutputMessage outputMessage){
    this.outputMessage=outputMessage;
  }
  @Override public String getCharacterEncoding(){
    MediaType type=this.outputMessage.getHeaders().getContentType();
    return (type != null && type.getCharset() != null ? type.getCharset().name() : null);
  }
  @Override public String getContentType(){
    MediaType type=this.outputMessage.getHeaders().getContentType();
    return (type != null ? type.toString() : null);
  }
  @Override @Deprecated public int getContentLength(){
    return this.outputMessage.getBodyAsBytes().length;
  }
  @Override public InputStream getInputStream() throws IOException {
    return new ByteArrayInputStream(this.outputMessage.getBodyAsBytes());
  }
}
