private static class PrecedenceVerifyingCollaborator implements PrecedenceTestAspect.Collaborator {
  private static final String[] EXPECTED={"beforeAdviceOne(highPrecedenceAspect)","beforeAdviceTwo(highPrecedenceAspect)","aroundAdviceOne(highPrecedenceAspect)","aroundAdviceTwo(highPrecedenceAspect)","beforeAdviceOne(highPrecedenceSpringAdvice)","beforeAdviceOne(lowPrecedenceSpringAdvice)","beforeAdviceOne(lowPrecedenceAspect)","beforeAdviceTwo(lowPrecedenceAspect)","aroundAdviceOne(lowPrecedenceAspect)","aroundAdviceTwo(lowPrecedenceAspect)","aroundAdviceTwo(lowPrecedenceAspect)","aroundAdviceOne(lowPrecedenceAspect)","afterAdviceOne(lowPrecedenceAspect)","afterAdviceTwo(lowPrecedenceAspect)","aroundAdviceTwo(highPrecedenceAspect)","aroundAdviceOne(highPrecedenceAspect)","afterAdviceOne(highPrecedenceAspect)","afterAdviceTwo(highPrecedenceAspect)"};
  private int adviceInvocationNumber=0;
  private void checkAdvice(  String whatJustHappened){
    if (adviceInvocationNumber > (EXPECTED.length - 1)) {
      fail("Too many advice invocations, expecting " + EXPECTED.length + " but had "+ adviceInvocationNumber);
    }
    String expecting=EXPECTED[adviceInvocationNumber++];
    if (!whatJustHappened.equals(expecting)) {
      fail("Expecting '" + expecting + "' on advice invocation "+ adviceInvocationNumber+ " but got '"+ whatJustHappened+ "'");
    }
  }
  @Override public void beforeAdviceOne(  String beanName){
    checkAdvice("beforeAdviceOne(" + beanName + ")");
  }
  @Override public void beforeAdviceTwo(  String beanName){
    checkAdvice("beforeAdviceTwo(" + beanName + ")");
  }
  @Override public void aroundAdviceOne(  String beanName){
    checkAdvice("aroundAdviceOne(" + beanName + ")");
  }
  @Override public void aroundAdviceTwo(  String beanName){
    checkAdvice("aroundAdviceTwo(" + beanName + ")");
  }
  @Override public void afterAdviceOne(  String beanName){
    checkAdvice("afterAdviceOne(" + beanName + ")");
  }
  @Override public void afterAdviceTwo(  String beanName){
    checkAdvice("afterAdviceTwo(" + beanName + ")");
  }
}
