public static class DependingBean implements InitializingBean, DisposableBean {
  public static int destroyCount=0;
  public boolean destroyed=false;
  public DependingBean(){
  }
  public DependingBean(  PreparingBean1 bean1,  PreparingBean2 bean2){
  }
  public void setBean1(  PreparingBean1 bean1){
  }
  public void setBean2(  PreparingBean2 bean2){
  }
  public void setInTheMiddleBean(  InTheMiddleBean bean){
  }
  @Override public void afterPropertiesSet(){
    if (!(PreparingBean1.prepared && PreparingBean2.prepared)) {
      throw new IllegalStateException("Need prepared PreparingBeans!");
    }
  }
  @Override public void destroy(){
    if (PreparingBean1.destroyed || PreparingBean2.destroyed) {
      throw new IllegalStateException("Should not be destroyed after PreparingBeans");
    }
    destroyed=true;
    destroyCount++;
  }
}
