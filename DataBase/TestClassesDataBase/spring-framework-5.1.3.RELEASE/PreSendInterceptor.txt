private static class PreSendInterceptor extends AbstractTestInterceptor {
  private Message<?> messageToReturn;
  private RuntimeException exceptionToRaise;
  public void setMessageToReturn(  Message<?> messageToReturn){
    this.messageToReturn=messageToReturn;
  }
  public void setExceptionToRaise(  RuntimeException exception){
    this.exceptionToRaise=exception;
  }
  @Override public Message<?> preSend(  Message<?> message,  MessageChannel channel){
    super.preSend(message,channel);
    if (this.exceptionToRaise != null) {
      throw this.exceptionToRaise;
    }
    return (this.messageToReturn != null ? this.messageToReturn : message);
  }
}
