private static class StoredProcedureWithResultSetMapped extends StoredProcedure {
  public static final String SQL="sproc_with_result_set";
  public StoredProcedureWithResultSetMapped(  DataSource ds){
    setDataSource(ds);
    setSql(SQL);
    declareParameter(new SqlReturnResultSet("rs",new RowMapperImpl()));
    compile();
  }
  public StoredProcedureWithResultSetMapped(  JdbcTemplate jt){
    setJdbcTemplate(jt);
    setSql(SQL);
    declareParameter(new SqlReturnResultSet("rs",new RowMapperImpl()));
    compile();
  }
  public Map<String,Object> execute(){
    return execute(new HashMap<>());
  }
private static class RowMapperImpl implements RowMapper<String> {
    @Override public String mapRow(    ResultSet rs,    int rowNum) throws SQLException {
      return rs.getString(2);
    }
  }
}
