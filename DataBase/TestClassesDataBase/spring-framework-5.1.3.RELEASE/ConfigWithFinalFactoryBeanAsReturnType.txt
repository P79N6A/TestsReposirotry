@Configuration protected static class ConfigWithFinalFactoryBeanAsReturnType {
  @Bean public FinalFactoryBean foo(){
    return new FinalFactoryBean();
  }
  @Bean public Bar bar() throws Exception {
    assertTrue(foo().isSingleton());
    return new Bar(foo().getObject());
  }
}
