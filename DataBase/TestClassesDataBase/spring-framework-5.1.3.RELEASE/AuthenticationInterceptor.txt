private static class AuthenticationInterceptor implements ChannelInterceptor {
  private final String name;
  public AuthenticationInterceptor(  String name){
    this.name=name;
  }
  @Override public Message<?> preSend(  Message<?> message,  MessageChannel channel){
    TestPrincipal user=new TestPrincipal(name);
    MessageHeaderAccessor.getAccessor(message,StompHeaderAccessor.class).setUser(user);
    return message;
  }
}
