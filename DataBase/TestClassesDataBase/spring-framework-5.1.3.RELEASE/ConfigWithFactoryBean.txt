@Configuration protected static class ConfigWithFactoryBean {
  @Bean public FactoryBean<Foo> foo(){
    return new FactoryBean<Foo>(){
      @Override public Foo getObject(){
        return new Foo("x");
      }
      @Override public Class<?> getObjectType(){
        return Foo.class;
      }
    }
;
  }
  @Bean public Bar bar() throws Exception {
    assertTrue(foo().isSingleton());
    return new Bar(foo().getObject());
  }
}
