/** 
 * @author Tomasz Bak
 */
public class SimpleEurekaHttpServerTest extends EurekaHttpClientCompatibilityTestSuite {
  private TransportClientFactory httpClientFactory;
  private EurekaHttpClient eurekaHttpClient;
  @Override @After public void tearDown() throws Exception {
    httpClientFactory.shutdown();
    super.tearDown();
  }
  @Override protected EurekaHttpClient getEurekaHttpClient(  URI serviceURI){
    Preconditions.checkState(eurekaHttpClient == null,"EurekaHttpClient has been already created");
    httpClientFactory=JerseyEurekaHttpClientFactory.newBuilder().withClientName("test").withMaxConnectionsPerHost(10).withMaxTotalConnections(10).withDecoder(JacksonJson.class.getSimpleName(),EurekaAccept.full.name()).withEncoder(JacksonJson.class.getSimpleName()).build();
    this.eurekaHttpClient=httpClientFactory.newClient(new DefaultEndpoint(serviceURI.toString()));
    return eurekaHttpClient;
  }
}
