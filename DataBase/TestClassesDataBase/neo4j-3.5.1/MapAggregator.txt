public static class MapAggregator {
  private Map<String,Object> map=new HashMap<>();
  @UserAggregationUpdate public void update(  @Name("name") String name,  @Name("value") long value){
    Long prev=(Long)map.getOrDefault(name,0L);
    if (value > prev) {
      map.put(name,value);
    }
  }
  @UserAggregationResult public Map<String,Object> result(){
    return map;
  }
}
