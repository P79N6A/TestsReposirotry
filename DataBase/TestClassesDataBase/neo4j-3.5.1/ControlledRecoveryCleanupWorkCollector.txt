private static class ControlledRecoveryCleanupWorkCollector extends RecoveryCleanupWorkCollector {
  Queue<CleanupJob> jobs=new LinkedList<>();
  List<CleanupJob> startedJobs=new LinkedList<>();
  @Override public void start(){
    executeWithExecutor(executor -> {
      CleanupJob job;
      while ((job=jobs.poll()) != null) {
        try {
          job.run(executor);
          startedJobs.add(job);
        }
  finally {
          job.close();
        }
      }
    }
);
  }
  @Override public void add(  CleanupJob job){
    jobs.add(job);
  }
  List<CleanupJob> allStartedJobs(){
    return startedJobs;
  }
}
