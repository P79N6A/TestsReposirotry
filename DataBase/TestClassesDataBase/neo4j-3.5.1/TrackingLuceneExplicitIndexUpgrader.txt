private static class TrackingLuceneExplicitIndexUpgrader extends LuceneExplicitIndexUpgrader {
  private final Set<String> migratedIndexes=new HashSet<>();
  private final boolean failIndexUpgrade;
  TrackingLuceneExplicitIndexUpgrader(  Path indexRootPath){
    this(indexRootPath,false);
  }
  TrackingLuceneExplicitIndexUpgrader(  Path indexRootPath,  boolean failIndexUpgrade){
    super(indexRootPath,NO_MONITOR);
    this.failIndexUpgrade=failIndexUpgrade;
  }
  @Override IndexUpgraderWrapper createIndexUpgrader(  String[] jars){
    return new IndexUpgraderWrapperStub(JarLoaderSupplier.of(jars),migratedIndexes,failIndexUpgrade);
  }
  public Set<String> getMigratedIndexes(){
    return migratedIndexes;
  }
}
