private class CustomGraphDatabaseFactory extends TestGraphDatabaseFactory {
  private GraphDatabaseFacadeFactory customFacadeFactory;
  CustomGraphDatabaseFactory(  GraphDatabaseFacadeFactory customFacadeFactory){
    this.customFacadeFactory=customFacadeFactory;
  }
  @Override protected GraphDatabaseBuilder.DatabaseCreator createDatabaseCreator(  File storeDir,  GraphDatabaseFactoryState state){
    return new GraphDatabaseBuilder.DatabaseCreator(){
      @Override public GraphDatabaseService newDatabase(      Config config){
        return customFacadeFactory.newFacade(storeDir,config,GraphDatabaseDependencies.newDependencies(state.databaseDependencies()));
      }
    }
;
  }
}
