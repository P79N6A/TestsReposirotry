private static class Machine {
  private final ByteArrayOutputStream output;
  private final WritableByteChannel writable;
  private final PackStream.Packer packer;
  Machine(){
    this.output=new ByteArrayOutputStream();
    this.writable=Channels.newChannel(this.output);
    this.packer=new PackStream.Packer(new BufferedChannelOutput(this.writable));
  }
  Machine(  int bufferSize){
    this.output=new ByteArrayOutputStream();
    this.writable=Channels.newChannel(this.output);
    this.packer=new PackStream.Packer(new BufferedChannelOutput(this.writable,bufferSize));
  }
  public void reset(){
    output.reset();
  }
  public byte[] output(){
    return output.toByteArray();
  }
  public PackStream.Packer packer(){
    return packer;
  }
}
