private static class IdSource implements IdSequence {
  int calls;
  long nextId;
  @Override public IdRange nextIdBatch(  int batchSize){
    calls++;
    try {
      return new IdRange(EMPTY_LONG_ARRAY,nextId,batchSize);
    }
  finally {
      nextId+=batchSize;
    }
  }
  @Override public long nextId(){
    throw new UnsupportedOperationException("Should not be used");
  }
}
