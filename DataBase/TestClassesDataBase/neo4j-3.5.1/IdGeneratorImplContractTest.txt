public class IdGeneratorImplContractTest extends IdGeneratorContractTest {
  private EphemeralFileSystemRule fsRule=new EphemeralFileSystemRule();
  private TestDirectory testDirectory=TestDirectory.testDirectory(fsRule.get());
  @Rule public RuleChain ruleChain=RuleChain.outerRule(fsRule).around(testDirectory);
  private EphemeralFileSystemAbstraction fs;
  @Before public void doBefore(){
    fs=fsRule.get();
  }
  @Override protected IdGenerator createIdGenerator(  int grabSize){
    IdGeneratorImpl.createGenerator(fs,idGeneratorFile(),0,false);
    return openIdGenerator(grabSize);
  }
  @Override protected IdGenerator openIdGenerator(  int grabSize){
    return new IdGeneratorImpl(fs,idGeneratorFile(),grabSize,1000,false,IdType.NODE,() -> 0L);
  }
  @After public void verifyFileCleanup(){
    File file=idGeneratorFile();
    if (file.exists()) {
      assertTrue(file.delete());
    }
  }
  private File idGeneratorFile(){
    return testDirectory.file("testIdGenerator.id");
  }
}
