public class RecordChangesTest {
  private final RecordAccess.Loader<Object,Object> loader=new RecordAccess.Loader<Object,Object>(){
    @Override public Object newUnused(    long o,    Object additionalData){
      return o;
    }
    @Override public Object load(    long o,    Object additionalData){
      return o;
    }
    @Override public void ensureHeavy(    Object o){
    }
    @Override public Object clone(    Object o){
      return o.toString();
    }
  }
;
  @Test public void shouldCountChanges(){
    RecordChanges<Object,Object> change=new RecordChanges<>(loader,new IntCounter());
    change.getOrLoad(1,null).forChangingData();
    change.getOrLoad(1,null).forChangingData();
    change.getOrLoad(2,null).forChangingData();
    change.getOrLoad(3,null).forReadingData();
    assertThat(change.changeSize(),equalTo(2));
  }
}
