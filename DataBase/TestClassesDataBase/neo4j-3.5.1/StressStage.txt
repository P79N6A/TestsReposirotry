private static class StressStage extends Stage {
  StressStage(  Configuration config,  int orderingGuarantees,  int batches){
    super("Stress",null,config,orderingGuarantees);
    add(new PullingProducerStep(control(),config){
      @Override protected long position(){
        return 0;
      }
      @Override protected Object nextBatchOrNull(      long ticket,      int batchSize){
        return ticket < batches ? ticket : null;
      }
    }
);
    add(new ProcessorStep<Long>(control(),"Yeah",config,3){
      @Override protected void process(      Long batch,      BatchSender sender) throws Throwable {
        Thread.sleep(0,ThreadLocalRandom.current().nextInt(100_000));
        sender.send(batch);
      }
    }
);
    add(new ForkedProcessorStep<Long>(control(),"Subject",config){
      @Override protected void forkedProcess(      int id,      int processors,      Long batch) throws Throwable {
        Thread.sleep(0,ThreadLocalRandom.current().nextInt(100_000));
      }
    }
);
    add(new DeadEndStep(control()));
  }
}
