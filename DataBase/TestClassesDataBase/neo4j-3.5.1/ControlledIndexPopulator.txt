private static class ControlledIndexPopulator extends IndexPopulator.Adapter {
  private final DoubleLatch latch;
  ControlledIndexPopulator(  DoubleLatch latch){
    this.latch=latch;
  }
  @Override public void add(  Collection<? extends IndexEntryUpdate<?>> updates){
    latch.waitForAllToStart();
  }
  @Override public void close(  boolean populationCompletedSuccessfully){
    latch.finish();
  }
}
