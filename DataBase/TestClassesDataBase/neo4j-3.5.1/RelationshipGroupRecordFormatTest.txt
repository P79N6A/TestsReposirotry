@RunWith(Parameterized.class) public class RelationshipGroupRecordFormatTest {
  @Parameters public static Collection<RecordFormats> formats(){
    return asList(StandardV2_3.RECORD_FORMATS,StandardV3_0.RECORD_FORMATS);
  }
  private final RecordFormat<RelationshipGroupRecord> format;
  private final int recordSize;
  public RelationshipGroupRecordFormatTest(  RecordFormats formats){
    this.format=formats.relationshipGroup();
    this.recordSize=format.getRecordSize(NO_STORE_HEADER);
  }
  @Test public void shouldReadUnsignedRelationshipTypeId() throws Exception {
    try (PageCursor cursor=new StubPageCursor(1,recordSize * 10)){
      int offset=10;
      cursor.next();
      RelationshipGroupRecord group=new RelationshipGroupRecord(2).initialize(true,Short.MAX_VALUE + offset,1,2,3,4,5);
      cursor.setOffset(offset);
      format.write(group,cursor,recordSize);
      RelationshipGroupRecord read=new RelationshipGroupRecord(group.getId());
      cursor.setOffset(offset);
      format.read(read,cursor,NORMAL,recordSize);
      assertEquals(group,read);
    }
   }
}
