private static class AssertableProgressReporter implements ProgressReporter {
  private final int expectedMax;
  private int recoveredTransactions;
  private long max;
  private boolean completed;
  AssertableProgressReporter(  int expectedMax){
    this.expectedMax=expectedMax;
  }
  @Override public void start(  long max){
    this.max=max;
  }
  @Override public void progress(  long add){
    recoveredTransactions+=add;
  }
  @Override public void completed(){
    completed=true;
  }
  public void verify(){
    assertTrue("Progress reporting was not completed.",completed);
    assertEquals("Number of max recovered transactions is different.",expectedMax,max);
    assertEquals("Number of recovered transactions is different.",expectedMax,recoveredTransactions);
  }
}
