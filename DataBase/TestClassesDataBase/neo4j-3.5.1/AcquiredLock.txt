private static class AcquiredLock {
  final Locks.Client client;
  final boolean shared;
  final ResourceType resourceType;
  final long resourceId;
  AcquiredLock(  Locks.Client client,  boolean shared,  ResourceType resourceType,  long resourceId){
    this.client=client;
    this.shared=shared;
    this.resourceType=resourceType;
    this.resourceId=resourceId;
  }
  static AcquiredLock shared(  Locks.Client client,  ResourceType resourceType,  long resourceId){
    return new AcquiredLock(client,true,resourceType,resourceId);
  }
  static AcquiredLock exclusive(  Locks.Client client,  ResourceType resourceType,  long resourceId){
    return new AcquiredLock(client,false,resourceType,resourceId);
  }
  void release(){
    if (shared) {
      client.releaseShared(resourceType,resourceId);
    }
 else {
      client.releaseExclusive(resourceType,resourceId);
    }
  }
}
