public class PageCacheIntArrayConcurrencyTest extends PageCacheNumberArrayConcurrencyTest {
  @Override protected Runnable wholeFileRacer(  NumberArray array,  int contestant){
    return new WholeFileRacer((PageCacheIntArray)array);
  }
  @Override protected Runnable fileRangeRacer(  NumberArray array,  int contestant){
    return new FileRangeRacer((PageCacheIntArray)array,contestant);
  }
  @Override protected PageCacheIntArray getNumberArray(  PagedFile file) throws IOException {
    return new PageCacheIntArray(file,COUNT,0,0);
  }
private class WholeFileRacer implements Runnable {
    private IntArray array;
    WholeFileRacer(    IntArray array){
      this.array=array;
    }
    @Override public void run(){
      for (int o=0; o < LAPS; o++) {
        for (int i=0; i < COUNT; i++) {
          array.set(i,i);
          assertEquals(i,array.get(i));
        }
      }
    }
  }
private class FileRangeRacer implements Runnable {
    private IntArray array;
    private int contestant;
    FileRangeRacer(    IntArray array,    int contestant){
      this.array=array;
      this.contestant=contestant;
    }
    @Override public void run(){
      for (int o=0; o < LAPS; o++) {
        for (int i=contestant; i < COUNT; i+=CONTESTANTS) {
          int value=random.nextInt();
          array.set(i,value);
          assertEquals(value,array.get(i));
        }
      }
    }
  }
}
