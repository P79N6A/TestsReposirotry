private static class Batch {
  private final boolean[] processed;
  Batch(  int processors){
    this.processed=new boolean[processors];
  }
  void processedBy(  int id){
    assertFalse(processed[id]);
    processed[id]=true;
  }
}
