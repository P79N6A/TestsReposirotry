public class LegacyCredentialTest {
  @Test public void testMatchesPassword(){
    LegacyCredential credential=LegacyCredential.forPassword("foo");
    assertTrue(credential.matchesPassword("foo"));
    assertFalse(credential.matchesPassword("fooo"));
    assertFalse(credential.matchesPassword("fo"));
    assertFalse(credential.matchesPassword("bar"));
  }
  @Test public void testEquals(){
    LegacyCredential credential=LegacyCredential.forPassword("foo");
    LegacyCredential sameCredential=new LegacyCredential(credential.salt(),credential.passwordHash());
    assertEquals(credential,sameCredential);
  }
  @Test public void testInaccessibleCredentials(){
    LegacyCredential credential=new LegacyCredential(INACCESSIBLE.salt(),INACCESSIBLE.passwordHash());
    assertEquals(INACCESSIBLE,credential);
    assertEquals(credential,INACCESSIBLE);
    assertEquals(INACCESSIBLE,INACCESSIBLE);
    assertNotEquals(INACCESSIBLE,LegacyCredential.forPassword(""));
    assertNotEquals(LegacyCredential.forPassword(""),INACCESSIBLE);
    assertFalse(INACCESSIBLE.matchesPassword(new String(new byte[]{})));
    assertFalse(INACCESSIBLE.matchesPassword("foo"));
    assertFalse(INACCESSIBLE.matchesPassword(""));
  }
}
