private static class FailingNodeDecorator implements Decorator {
  private final RuntimeException failure;
  FailingNodeDecorator(  RuntimeException failure){
    this.failure=failure;
  }
  @Override public InputEntityVisitor apply(  InputEntityVisitor t){
    return new InputEntityVisitor.Delegate(t){
      @Override public void endOfEntity(){
        throw failure;
      }
    }
;
  }
}
