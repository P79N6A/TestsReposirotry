private static class MyTxEventHandler implements TransactionEventHandler<Object> {
  Map<String,Object> nodeProps=new HashMap<>();
  Map<String,Object> relProps=new HashMap<>();
  @Override public void afterCommit(  TransactionData data,  Object state){
    for (    PropertyEntry<Node> entry : data.removedNodeProperties()) {
      String key=entry.key();
      Object value=entry.previouslyCommitedValue();
      nodeProps.put(key,value);
    }
    for (    PropertyEntry<Relationship> entry : data.removedRelationshipProperties()) {
      relProps.put(entry.key(),entry.previouslyCommitedValue());
    }
  }
  @Override public void afterRollback(  TransactionData data,  Object state){
  }
  @Override public Object beforeCommit(  TransactionData data){
    return null;
  }
}
