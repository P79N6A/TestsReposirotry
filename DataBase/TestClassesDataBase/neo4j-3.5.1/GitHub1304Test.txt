public class GitHub1304Test {
  @Rule public final TestDirectory testDirectory=TestDirectory.testDirectory();
  @Rule public DefaultFileSystemRule fileSystemRule=new DefaultFileSystemRule();
  @Test public void givenBatchInserterWhenArrayPropertyUpdated4TimesThenShouldNotFail() throws IOException {
    BatchInserter batchInserter=BatchInserters.inserter(testDirectory.databaseDir(),fileSystemRule.get());
    long nodeId=batchInserter.createNode(Collections.emptyMap());
    for (int i=0; i < 4; i++) {
      batchInserter.setNodeProperty(nodeId,"array",new byte[]{2,3,98,1,43,50,3,33,51,55,116,16,23,56,9,-10,1,3,1,1,1,1,1,1,1,1,1});
    }
    batchInserter.getNodeProperties(nodeId);
    batchInserter.shutdown();
  }
}
