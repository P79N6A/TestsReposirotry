class SunManagementHeapAllocationTest {
  @BeforeEach void onlyOnSupportedJvms(){
    assumeFalse(HEAP_ALLOCATION == NOT_AVAILABLE);
  }
  @Test void shouldLoadHeapAllocation(){
    assertNotSame(NOT_AVAILABLE,HEAP_ALLOCATION);
    assertThat(HEAP_ALLOCATION,instanceOf(SunManagementHeapAllocation.class));
  }
  @Test void shouldMeasureAllocation(){
    long allocatedBytes=HEAP_ALLOCATION.allocatedBytes(currentThread());
    List<Object> objects=new ArrayList<>();
    for (int i=0; i < 17; i++) {
      objects.add(new Object());
    }
    assertThat(allocatedBytes,Matchers.lessThan(HEAP_ALLOCATION.allocatedBytes(currentThread())));
    assertEquals(17,objects.size());
  }
}
