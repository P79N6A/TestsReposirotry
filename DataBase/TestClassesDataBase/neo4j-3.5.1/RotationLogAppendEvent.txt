private static class RotationLogAppendEvent implements LogAppendEvent {
  private final LogRotationImpl logRotation;
  RotationLogAppendEvent(  LogRotationImpl logRotation){
    this.logRotation=logRotation;
  }
  @Override public LogForceWaitEvent beginLogForceWait(){
    return null;
  }
  @Override public LogForceEvent beginLogForce(){
    return null;
  }
  @Override public void close(){
  }
  @Override public void setLogRotated(  boolean logRotated){
  }
  @Override public LogRotateEvent beginLogRotate(){
    return null;
  }
  @Override public SerializeTransactionEvent beginSerializeTransaction(){
    return () -> {
      try {
        logRotation.rotateLogFile();
      }
 catch (      IOException e) {
        throw new RuntimeException("Should be able to rotate file",e);
      }
    }
;
  }
}
