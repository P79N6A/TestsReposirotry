private static class ControlledCheckPointer implements CheckPointer {
  volatile boolean fail;
  @Override public long checkPointIfNeeded(  TriggerInfo triggerInfo) throws IOException {
    if (fail) {
      throw new IOException("Just failing");
    }
    return 1;
  }
  @Override public long tryCheckPoint(  TriggerInfo triggerInfo){
    throw new UnsupportedOperationException();
  }
  @Override public long forceCheckPoint(  TriggerInfo triggerInfo){
    throw new UnsupportedOperationException();
  }
  @Override public long lastCheckPointedTransactionId(){
    throw new UnsupportedOperationException();
  }
}
