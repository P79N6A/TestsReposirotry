private static class TransactionCloseListener implements LifecycleListener {
  private final Transaction transaction;
  private boolean transactionClosed;
  TransactionCloseListener(  Transaction transaction){
    this.transaction=transaction;
  }
  @Override public void notifyStatusChanged(  Object instance,  LifecycleStatus from,  LifecycleStatus to){
    if ((LifecycleStatus.STOPPED == to) && (instance instanceof RecordStorageEngine)) {
      transaction.success();
      transaction.close();
      transactionClosed=true;
    }
  }
  boolean isTransactionClosed(){
    return transactionClosed;
  }
}
