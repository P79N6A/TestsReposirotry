public class CountsStoreTransactionApplierTest {
  @Test public void shouldNotifyCacheAccessOnHowManyUpdatesOnCountsWeHadSoFar() throws Exception {
    final CountsTracker tracker=mock(CountsTracker.class);
    final CountsAccessor.Updater updater=mock(CountsAccessor.Updater.class);
    when(tracker.apply(anyLong())).thenReturn(Optional.of(updater));
    final CountsStoreBatchTransactionApplier applier=new CountsStoreBatchTransactionApplier(tracker,TransactionApplicationMode.INTERNAL);
    try (TransactionApplier txApplier=applier.startTx(new TransactionToApply(null,2L))){
      txApplier.visitNodeCountsCommand(new Command.NodeCountsCommand(StatementConstants.ANY_LABEL,1));
    }
     verify(updater,times(1)).incrementNodeCount(StatementConstants.ANY_LABEL,1);
  }
}
