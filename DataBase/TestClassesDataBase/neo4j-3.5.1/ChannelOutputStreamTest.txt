@ExtendWith(TestDirectoryExtension.class) class ChannelOutputStreamTest {
  @Inject TestDirectory tmpDir;
  @Test void shouldStoreAByteAtBoundary() throws Exception {
    try (EphemeralFileSystemAbstraction fs=new EphemeralFileSystemAbstraction()){
      File workFile=tmpDir.file("a");
      fs.mkdirs(tmpDir.directory());
      OutputStream out=fs.openAsOutputStream(workFile,false);
      byte[] b=new byte[8097];
      b[b.length - 1]=7;
      out.write(b);
      out.flush();
      InputStream in=fs.openAsInputStream(workFile);
      in.skip(8096);
      assertEquals(7,in.read());
    }
   }
}
