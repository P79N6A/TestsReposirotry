public class ProcedureHolderTest {
  @Test public void shouldGetProcedureFromHolder(){
    ProcedureHolder<String> procHolder=new ProcedureHolder<>();
    QualifiedName qualifiedName=new QualifiedName(new String[0],"CaseSensitive");
    String item="CaseSensitiveItem";
    procHolder.put(qualifiedName,item,false);
    assertThat(procHolder.get(qualifiedName),equalTo(item));
    assertThat(procHolder.idOf(qualifiedName),equalTo(0));
  }
  @Test public void okToHaveProcsOnlyDifferByCase(){
    ProcedureHolder<String> procHolder=new ProcedureHolder<>();
    procHolder.put(new QualifiedName(new String[0],"CASESENSITIVE"),"CASESENSITIVEItem",false);
    procHolder.put(new QualifiedName(new String[0],"CaseSensitive"),"CaseSensitiveItem",false);
    assertThat(procHolder.get(new QualifiedName(new String[0],"CASESENSITIVE")),equalTo("CASESENSITIVEItem"));
    assertThat(procHolder.get(new QualifiedName(new String[0],"CaseSensitive")),equalTo("CaseSensitiveItem"));
    assertThat(procHolder.idOf(new QualifiedName(new String[0],"CASESENSITIVE")),equalTo(0));
    assertThat(procHolder.idOf(new QualifiedName(new String[0],"CaseSensitive")),equalTo(1));
  }
  @Test public void shouldGetCaseInsensitiveFromHolder(){
    ProcedureHolder<String> procHolder=new ProcedureHolder<>();
    QualifiedName qualifiedName=new QualifiedName(new String[0],"CaseInSensitive");
    String item="CaseInSensitiveItem";
    procHolder.put(qualifiedName,item,true);
    QualifiedName lowerCaseName=new QualifiedName(new String[0],"caseinsensitive");
    assertThat(procHolder.get(lowerCaseName),equalTo(item));
    assertThat(procHolder.idOf(lowerCaseName),equalTo(0));
  }
  @Test public void canOverwriteFunctionAndChangeCaseSensitivity(){
    ProcedureHolder<String> procHolder=new ProcedureHolder<>();
    QualifiedName qualifiedName=new QualifiedName(new String[0],"CaseInSensitive");
    String item="CaseInSensitiveItem";
    procHolder.put(qualifiedName,item,true);
    QualifiedName lowerCaseName=new QualifiedName(new String[0],"caseinsensitive");
    assertThat(procHolder.get(lowerCaseName),equalTo(item));
    assertThat(procHolder.idOf(lowerCaseName),equalTo(0));
    procHolder.put(qualifiedName,item,false);
    assertNull(procHolder.get(lowerCaseName));
    try {
      procHolder.idOf(lowerCaseName);
      fail("Should have failed to find with lower case");
    }
 catch (    NoSuchElementException e) {
    }
  }
}
