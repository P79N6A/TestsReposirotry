private static class CommitTrackingMonitor implements TransactionMonitor {
  volatile boolean committed;
  volatile boolean rolledBack;
  volatile boolean terminated;
  @Override public void transactionStarted(){
  }
  @Override public void transactionFinished(  boolean successful,  boolean writeTx){
    if (successful) {
      committed=true;
    }
 else {
      rolledBack=true;
    }
  }
  @Override public void transactionTerminated(  boolean writeTx){
    terminated=true;
  }
  @Override public void upgradeToWriteTransaction(){
  }
  void reset(){
    committed=false;
    rolledBack=false;
    terminated=false;
  }
}
