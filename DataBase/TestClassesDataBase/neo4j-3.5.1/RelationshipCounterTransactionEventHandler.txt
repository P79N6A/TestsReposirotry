private static class RelationshipCounterTransactionEventHandler implements TransactionEventHandler<Void> {
  private final Node node;
  RelationshipCounterTransactionEventHandler(  Node node){
    this.node=node;
  }
  @SuppressWarnings("boxing") @Override public Void beforeCommit(  TransactionData data){
    if (Iterables.count(data.createdRelationships()) == 0) {
      return null;
    }
    node.setProperty("counter",((Long)node.removeProperty("counter")) + 1);
    return null;
  }
  @Override public void afterCommit(  TransactionData data,  Void state){
  }
  @Override public void afterRollback(  TransactionData data,  Void state){
  }
}
