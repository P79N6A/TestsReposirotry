private static class PositiveLogFilesBasedLogVersionRepository implements LogVersionRepository {
  private long version;
  PositiveLogFilesBasedLogVersionRepository(  LogFiles logFiles){
    this.version=(logFiles.getHighestLogVersion() == -1) ? 0 : logFiles.getHighestLogVersion();
  }
  @Override public long getCurrentLogVersion(){
    return version;
  }
  @Override public void setCurrentLogVersion(  long version){
    this.version=version;
  }
  @Override public long incrementAndGetVersion(){
    version++;
    return version;
  }
}
