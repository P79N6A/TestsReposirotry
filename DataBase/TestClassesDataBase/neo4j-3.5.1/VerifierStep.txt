private static class VerifierStep extends ProcessorStep<RelationshipGroupRecord[]> {
  private long lastBatchLastOwningNode=-1;
  private final AtomicInteger processCounter;
  VerifierStep(  StageControl control,  Configuration config,  AtomicInteger processCounter){
    super(control,"Verifier",config,1);
    this.processCounter=processCounter;
  }
  @Override protected void process(  RelationshipGroupRecord[] batch,  BatchSender sender){
    long lastOwningNode=lastBatchLastOwningNode;
    for (    RelationshipGroupRecord record : batch) {
      assertTrue(record.getOwningNode() >= lastOwningNode);
      assertTrue(record.getOwningNode() > lastBatchLastOwningNode);
    }
    processCounter.incrementAndGet();
    if (batch.length > 0) {
      lastBatchLastOwningNode=batch[batch.length - 1].getOwningNode();
    }
  }
}
