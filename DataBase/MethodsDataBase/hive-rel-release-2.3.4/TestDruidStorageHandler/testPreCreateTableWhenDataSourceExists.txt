@Test(expected=MetaException.class) public void testPreCreateTableWhenDataSourceExists() throws MetaException {
  derbyConnectorRule.getConnector().createSegmentTable();
  SQLMetadataStorageUpdaterJobHandler sqlMetadataStorageUpdaterJobHandler=new SQLMetadataStorageUpdaterJobHandler(derbyConnectorRule.getConnector());
  sqlMetadataStorageUpdaterJobHandler.publishSegments(segmentsTable,Arrays.asList(dataSegment),DruidStorageHandlerUtils.JSON_MAPPER);
  DruidStorageHandler druidStorageHandler=new DruidStorageHandler(derbyConnectorRule.getConnector(),new SQLMetadataStorageUpdaterJobHandler(derbyConnectorRule.getConnector()),derbyConnectorRule.metadataTablesConfigSupplier().get(),null);
  druidStorageHandler.preCreateTable(tableMock);
}
