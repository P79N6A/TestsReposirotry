@Test public void createTable() throws Exception {
  String dbName="default";
  String tableName="hcatcreatetable";
  HCatTable table=new HCatTable(dbName,tableName);
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,events.size());
  HCatNotificationEvent event=events.get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
  assertEquals(dbName,event.getDbName());
  assertEquals("hcatcreatetable",event.getTableName());
  CreateTableMessage createTableMessage=md.getCreateTableMessage(event.getMessage());
  assertEquals(dbName,createTableMessage.getDB());
  assertEquals(tableName,createTableMessage.getTable());
  HCatTable createdTable=hCatClient.getTable(dbName,tableName);
  assertTrue(createdTable.diff(table).equals(HCatTable.NO_DIFF));
}
