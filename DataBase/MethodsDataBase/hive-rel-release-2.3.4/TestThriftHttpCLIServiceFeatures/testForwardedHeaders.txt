/** 
 * Test if addresses in X-Forwarded-For are passed to HiveAuthorizer calls
 * @throws Exception
 */
@Test public void testForwardedHeaders() throws Exception {
  verifyForwardedHeaders(new ArrayList<String>(Arrays.asList("127.0.0.1","202.101.101.101")),"show tables");
  verifyForwardedHeaders(new ArrayList<String>(Arrays.asList("202.101.101.101")),"fs -ls /");
  verifyForwardedHeaders(new ArrayList<String>(),"show databases");
}
