/** 
 * Investigating DP and WriteEntity, etc
 * @throws Exception
 */
@Test @Ignore public void testDynamicPartitions() throws Exception {
  d.destroy();
  hiveConf.setVar(HiveConf.ConfVars.DYNAMICPARTITIONINGMODE,"nonstrict");
  runStatementOnDriver("insert into " + Table.ACIDTBLPART + " partition(p) values(1,1,'p1'),(2,2,'p1'),(3,3,'p1'),(4,4,'p2')");
  List<String> r1=runStatementOnDriver("select count(*) from " + Table.ACIDTBLPART);
  Assert.assertEquals("4",r1.get(0));
  runStatementOnDriver("insert into " + Table.ACIDTBLPART + " partition(p) select * from "+ Table.ACIDTBLPART+ " where p='p1'");
  runStatementOnDriver("insert into " + Table.ACIDTBLPART + " partition(p='p2') select a,b from "+ Table.ACIDTBLPART+ " where p='p1'");
  runStatementOnDriver("update " + Table.ACIDTBLPART + " set b = 1");
  runStatementOnDriver("update " + Table.ACIDTBLPART + " set b = 1 where p='p1'");
}
