@Test public void createDatabase() throws Exception {
  String dbName="createdb";
  String dbName2="createdb2";
  String dbLocationUri="file:/tmp";
  String dbDescription="no description";
  Database db=new Database(dbName,dbDescription,dbLocationUri,emptyParameters);
  msClient.createDatabase(db);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(EventType.CREATE_DATABASE.toString(),event.getEventType());
  assertEquals(dbName,event.getDbName());
  assertNull(event.getTableName());
  CreateDatabaseMessage createDbMsg=md.getCreateDatabaseMessage(event.getMessage());
  assertEquals(dbName,createDbMsg.getDB());
  MockMetaStoreEventListener.popAndVerifyLastEventId(EventType.CREATE_DATABASE,firstEventId + 1);
  DummyRawStoreFailEvent.setEventSucceed(false);
  db=new Database(dbName2,dbDescription,dbLocationUri,emptyParameters);
  try {
    msClient.createDatabase(db);
    fail("Error: create database should've failed");
  }
 catch (  Exception ex) {
  }
  rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,rsp.getEventsSize());
}
