@Test public void testStatus() throws IOException {
  Map<String,Long> cmap=new ReplStateMap<String,Long>();
  Long oldV;
  oldV=cmap.put("a",1L);
  assertEquals(1L,cmap.get("a").longValue());
  assertEquals(null,oldV);
  cmap.put("b",2L);
  oldV=cmap.put("b",-2L);
  assertEquals(2L,cmap.get("b").longValue());
  assertEquals(2L,oldV.longValue());
  cmap.put("c",3L);
  oldV=cmap.put("c",33L);
  assertEquals(33L,cmap.get("c").longValue());
  assertEquals(3L,oldV.longValue());
  String testName="incrementalStatus";
  LOG.info("Testing " + testName);
  String dbName=testName + "_" + tid;
  run("CREATE DATABASE " + dbName);
  advanceDumpDir();
  run("REPL DUMP " + dbName);
  String lastReplDumpLocn=getResult(0,0);
  String lastReplDumpId=getResult(0,1,true);
  run("REPL LOAD " + dbName + "_dupe FROM '"+ lastReplDumpLocn+ "'");
  lastReplDumpId=verifyAndReturnDbReplStatus(dbName,"ptned",lastReplDumpId,"CREATE TABLE " + dbName + ".ptned(a string) partitioned by (b int) STORED AS TEXTFILE");
  lastReplDumpId=verifyAndReturnDbReplStatus(dbName,"ptned",lastReplDumpId,"ALTER TABLE " + dbName + ".ptned ADD PARTITION (b=1)");
  lastReplDumpId=verifyAndReturnDbReplStatus(dbName,"ptned",lastReplDumpId,"ALTER TABLE " + dbName + ".ptned PARTITION (b=1) RENAME TO PARTITION (b=11)");
  lastReplDumpId=verifyAndReturnDbReplStatus(dbName,"ptned",lastReplDumpId,"ALTER TABLE " + dbName + ".ptned SET TBLPROPERTIES ('blah'='foo')");
  lastReplDumpId=verifyAndReturnDbReplStatus(dbName,"ptned_rn",lastReplDumpId,"ALTER TABLE " + dbName + ".ptned RENAME TO  "+ dbName+ ".ptned_rn");
  lastReplDumpId=verifyAndReturnDbReplStatus(dbName,"ptned_rn",lastReplDumpId,"ALTER TABLE " + dbName + ".ptned_rn DROP PARTITION (b=11)");
  lastReplDumpId=verifyAndReturnDbReplStatus(dbName,null,lastReplDumpId,"DROP TABLE " + dbName + ".ptned_rn");
  String lastTblReplDumpId=lastReplDumpId;
  lastTblReplDumpId=verifyAndReturnTblReplStatus(dbName,"ptned2",lastReplDumpId,lastTblReplDumpId,"CREATE TABLE " + dbName + ".ptned2(a string) partitioned by (b int) STORED AS TEXTFILE");
  lastTblReplDumpId=verifyAndReturnTblReplStatus(dbName,"ptned2",lastReplDumpId,lastTblReplDumpId,"ALTER TABLE " + dbName + ".ptned2 ADD PARTITION (b=1)");
  lastTblReplDumpId=verifyAndReturnTblReplStatus(dbName,"ptned2",lastReplDumpId,lastTblReplDumpId,"ALTER TABLE " + dbName + ".ptned2 PARTITION (b=1) RENAME TO PARTITION (b=11)");
  lastTblReplDumpId=verifyAndReturnTblReplStatus(dbName,"ptned2",lastReplDumpId,lastTblReplDumpId,"ALTER TABLE " + dbName + ".ptned2 SET TBLPROPERTIES ('blah'='foo')");
  String finalTblReplDumpId=verifyAndReturnTblReplStatus(dbName,"ptned2",lastReplDumpId,lastTblReplDumpId,"ALTER TABLE " + dbName + ".ptned2 DROP PARTITION (b=11)");
  assertTrue(finalTblReplDumpId.compareTo(lastTblReplDumpId) > 0);
}
