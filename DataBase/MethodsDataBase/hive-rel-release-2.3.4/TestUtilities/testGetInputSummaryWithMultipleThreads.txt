@Test public void testGetInputSummaryWithMultipleThreads() throws IOException {
  final int NUM_PARTITIONS=5;
  final int BYTES_PER_FILE=5;
  JobConf jobConf=new JobConf();
  Properties properties=new Properties();
  jobConf.setInt(HiveConf.ConfVars.HIVE_EXEC_INPUT_LISTING_MAX_THREADS.varname,2);
  ContentSummary summary=runTestGetInputSummary(jobConf,properties,NUM_PARTITIONS,BYTES_PER_FILE,HiveInputFormat.class);
  assertEquals(NUM_PARTITIONS * BYTES_PER_FILE,summary.getLength());
  assertEquals(NUM_PARTITIONS,summary.getFileCount());
  assertEquals(NUM_PARTITIONS,summary.getDirectoryCount());
  jobConf.setInt(HiveConf.ConfVars.HIVE_EXEC_INPUT_LISTING_MAX_THREADS.varname,0);
  jobConf.setInt(Utilities.DEPRECATED_MAPRED_DFSCLIENT_PARALLELISM_MAX,2);
  summary=runTestGetInputSummary(jobConf,properties,NUM_PARTITIONS,BYTES_PER_FILE,HiveInputFormat.class);
  assertEquals(NUM_PARTITIONS * BYTES_PER_FILE,summary.getLength());
  assertEquals(NUM_PARTITIONS,summary.getFileCount());
  assertEquals(NUM_PARTITIONS,summary.getDirectoryCount());
}
