@Test public void testGetInputSummaryWithContentSummaryInputFormat() throws IOException {
  final int NUM_PARTITIONS=5;
  final int BYTES_PER_FILE=10;
  JobConf jobConf=new JobConf();
  Properties properties=new Properties();
  jobConf.setInt(Utilities.DEPRECATED_MAPRED_DFSCLIENT_PARALLELISM_MAX,2);
  ContentSummaryInputFormatTestClass.setContentSummary(new ContentSummary.Builder().length(BYTES_PER_FILE).fileCount(2).directoryCount(1).build());
  ContentSummary summary=runTestGetInputSummary(jobConf,properties,NUM_PARTITIONS,BYTES_PER_FILE * 2,ContentSummaryInputFormatTestClass.class);
  assertEquals(NUM_PARTITIONS * BYTES_PER_FILE,summary.getLength());
  assertEquals(NUM_PARTITIONS * 2,summary.getFileCount());
  assertEquals(NUM_PARTITIONS,summary.getDirectoryCount());
}
