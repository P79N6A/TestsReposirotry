@Test public void testGetInputSummaryWithInputEstimator() throws IOException, HiveException {
  final int NUM_PARTITIONS=5;
  final int BYTES_PER_FILE=10;
  final int NUM_OF_ROWS=5;
  JobConf jobConf=new JobConf();
  Properties properties=new Properties();
  jobConf.setInt(Utilities.DEPRECATED_MAPRED_DFSCLIENT_PARALLELISM_MAX,2);
  properties.setProperty(hive_metastoreConstants.META_TABLE_STORAGE,InputEstimatorTestClass.class.getName());
  InputEstimatorTestClass.setEstimation(new InputEstimator.Estimation(NUM_OF_ROWS,BYTES_PER_FILE));
  ContentSummary summary=runTestGetInputSummary(jobConf,properties,NUM_PARTITIONS,BYTES_PER_FILE * 2,HiveInputFormat.class);
  assertEquals(NUM_PARTITIONS * BYTES_PER_FILE,summary.getLength());
  assertEquals(NUM_PARTITIONS * -1,summary.getFileCount());
  assertEquals(NUM_PARTITIONS * -1,summary.getDirectoryCount());
  jobConf.setInt(HiveConf.ConfVars.HIVE_EXEC_INPUT_LISTING_MAX_THREADS.varname,0);
  jobConf.setInt(HiveConf.ConfVars.HIVE_EXEC_INPUT_LISTING_MAX_THREADS.varname,2);
  properties.setProperty(hive_metastoreConstants.META_TABLE_STORAGE,InputEstimatorTestClass.class.getName());
  InputEstimatorTestClass.setEstimation(new InputEstimator.Estimation(NUM_OF_ROWS,BYTES_PER_FILE));
  summary=runTestGetInputSummary(jobConf,properties,NUM_PARTITIONS,BYTES_PER_FILE * 2,HiveInputFormat.class);
  assertEquals(NUM_PARTITIONS * BYTES_PER_FILE,summary.getLength());
  assertEquals(NUM_PARTITIONS * -1,summary.getFileCount());
  assertEquals(NUM_PARTITIONS * -1,summary.getDirectoryCount());
}
