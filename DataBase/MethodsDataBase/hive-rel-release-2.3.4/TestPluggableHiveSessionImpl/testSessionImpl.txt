@Test public void testSessionImpl() throws Exception {
  HiveConf hiveConf=new HiveConf();
  hiveConf.setVar(HiveConf.ConfVars.HIVE_AUTHORIZATION_MANAGER,HiveConf.ConfVars.HIVE_AUTHORIZATION_MANAGER.getDefaultValue());
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SESSION_IMPL_CLASSNAME,SampleHiveSessionImpl.class.getName());
  hiveConf.setBoolVar(HiveConf.ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
  CLIService cliService=new CLIService(null);
  cliService.init(hiveConf);
  ThriftBinaryCLIService service=new ThriftBinaryCLIService(cliService,null);
  service.init(hiveConf);
  ThriftCLIServiceClient client=new ThriftCLIServiceClient(service);
  SessionHandle sessionHandle=null;
  sessionHandle=client.openSession("tom","password");
  assertEquals(SampleHiveSessionImpl.class.getName(),service.getHiveConf().getVar(HiveConf.ConfVars.HIVE_SESSION_IMPL_CLASSNAME));
  HiveSession session=cliService.getSessionManager().getSession(sessionHandle);
  assertEquals(SampleHiveSessionImpl.MAGIC_RETURN_VALUE,session.getNoOperationTime());
  client.closeSession(sessionHandle);
}
