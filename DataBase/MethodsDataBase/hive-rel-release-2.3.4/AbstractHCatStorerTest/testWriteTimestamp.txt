/** 
 * Note that the value that comes back from Hive will have local TZ on it. Using local is arbitrary but DateTime needs TZ (or will assume default) and Hive does not have TZ. So if you start with Pig value in TZ=x and write to Hive, when you read it back the TZ may be different. The millis value should match, of course.
 * @throws Exception
 */
@Test public void testWriteTimestamp() throws Exception {
  DateTime d=new DateTime(1991,10,11,14,23,30,10);
  pigValueRangeTest("junitTypeTest1","timestamp","datetime",null,d.toString(),d.toDateTime(DateTimeZone.getDefault()).toString());
  d=d.plusHours(2);
  pigValueRangeTest("junitTypeTest2","timestamp","datetime",HCatBaseStorer.OOR_VALUE_OPT_VALUES.Null,d.toString(),d.toDateTime(DateTimeZone.getDefault()).toString());
  d=d.toDateTime(DateTimeZone.UTC);
  pigValueRangeTest("junitTypeTest3","timestamp","datetime",null,d.toString(),d.toDateTime(DateTimeZone.getDefault()).toString());
  d=new DateTime(1991,10,11,23,24,25,26);
  pigValueRangeTest("junitTypeTest1","timestamp","datetime",null,d.toString(),d.toDateTime(DateTimeZone.getDefault()).toString());
  d=d.toDateTime(DateTimeZone.UTC);
  pigValueRangeTest("junitTypeTest3","timestamp","datetime",null,d.toString(),d.toDateTime(DateTimeZone.getDefault()).toString());
}
