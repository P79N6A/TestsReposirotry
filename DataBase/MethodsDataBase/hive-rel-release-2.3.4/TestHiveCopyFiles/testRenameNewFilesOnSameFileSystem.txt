@Test public void testRenameNewFilesOnSameFileSystem() throws IOException {
  Path sourcePath=new Path(sourceFolder.getRoot().getAbsolutePath());
  sourceFolder.newFile("000000_0");
  sourceFolder.newFile("000001_0");
  sourceFolder.newFile("000000_0.gz");
  sourceFolder.newFile("000001_0.gz");
  Path targetPath=new Path(targetFolder.getRoot().getAbsolutePath());
  FileSystem targetFs=targetPath.getFileSystem(hiveConf);
  try {
    Hive.copyFiles(hiveConf,sourcePath,targetPath,targetFs,isSourceLocal,NO_ACID,null);
  }
 catch (  HiveException e) {
    e.printStackTrace();
    assertTrue("Hive.copyFiles() threw an unexpected exception.",false);
  }
  assertTrue(targetFs.exists(new Path(targetPath,"000000_0")));
  assertTrue(targetFs.exists(new Path(targetPath,"000001_0")));
  assertTrue(targetFs.exists(new Path(targetPath,"000000_0.gz")));
  assertTrue(targetFs.exists(new Path(targetPath,"000001_0.gz")));
}
