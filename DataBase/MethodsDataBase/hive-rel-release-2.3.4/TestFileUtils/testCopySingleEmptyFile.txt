@Test public void testCopySingleEmptyFile() throws IOException {
  String file1Name="file1.txt";
  Path copySrc=new Path(basePath,"copySrc");
  Path copyDst=new Path(basePath,"copyDst");
  try {
    fs.create(new Path(basePath,new Path(copySrc,file1Name))).close();
    Assert.assertTrue("FileUtils.copy failed to copy data",FileUtils.copy(fs,copySrc,fs,copyDst,false,false,conf));
    Path dstFileName1=new Path(copyDst,file1Name);
    Assert.assertTrue(fs.exists(new Path(copyDst,file1Name)));
    Assert.assertEquals(fs.getFileStatus(dstFileName1).getLen(),0);
  }
  finally {
    try {
      fs.delete(copySrc,true);
      fs.delete(copyDst,true);
    }
 catch (    IOException e) {
    }
  }
}
