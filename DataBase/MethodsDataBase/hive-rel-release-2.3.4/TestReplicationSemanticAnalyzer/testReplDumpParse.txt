@Test public void testReplDumpParse() throws Exception {
  ParseDriver pd=new ParseDriver();
  String fromEventId="100";
  String toEventId="200";
  String maxEventLimit="50";
  ASTNode root;
  ASTNode child;
  String query="repl dump " + defaultDB;
  root=(ASTNode)pd.parse(query).getChild(0);
  assertEquals(root.getText(),"TOK_REPL_DUMP");
  assertEquals(root.getChildCount(),1);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),defaultDB);
  assertEquals(child.getChildCount(),0);
  query="repl dump " + defaultDB + "."+ tblName;
  root=(ASTNode)pd.parse(query).getChild(0);
  assertEquals(root.getChildCount(),2);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),defaultDB);
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(1);
  assertEquals(child.getText(),tblName);
  assertEquals(child.getChildCount(),0);
  query="repl dump " + defaultDB + "."+ tblName+ " from "+ fromEventId;
  root=(ASTNode)pd.parse(query).getChild(0);
  assertEquals(root.getChildCount(),3);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),defaultDB);
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(1);
  assertEquals(child.getText(),tblName);
  assertEquals(child.getChildCount(),0);
  root=(ASTNode)root.getChild(2);
  assertEquals(root.getText(),"TOK_FROM");
  assertEquals(root.getChildCount(),1);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),fromEventId);
  assertEquals(child.getChildCount(),0);
  query="repl dump " + defaultDB + "."+ tblName+ " from "+ fromEventId+ " to "+ toEventId;
  root=(ASTNode)pd.parse(query).getChild(0);
  assertEquals(root.getChildCount(),3);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),defaultDB);
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(1);
  assertEquals(child.getText(),tblName);
  assertEquals(child.getChildCount(),0);
  root=(ASTNode)root.getChild(2);
  assertEquals(root.getText(),"TOK_FROM");
  assertEquals(root.getChildCount(),3);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),fromEventId);
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(1);
  assertEquals(child.getText(),"TOK_TO");
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(2);
  assertEquals(child.getText(),toEventId);
  assertEquals(child.getChildCount(),0);
  query="repl dump " + defaultDB + "."+ tblName+ " from "+ fromEventId+ " to "+ toEventId+ " limit "+ maxEventLimit;
  root=(ASTNode)pd.parse(query).getChild(0);
  assertEquals(root.getChildCount(),3);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),defaultDB);
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(1);
  assertEquals(child.getText(),tblName);
  assertEquals(child.getChildCount(),0);
  root=(ASTNode)root.getChild(2);
  assertEquals(root.getText(),"TOK_FROM");
  assertEquals(root.getChildCount(),5);
  child=(ASTNode)root.getChild(0);
  assertEquals(child.getText(),fromEventId);
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(1);
  assertEquals(child.getText(),"TOK_TO");
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(2);
  assertEquals(child.getText(),toEventId);
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(3);
  assertEquals(child.getText(),"TOK_LIMIT");
  assertEquals(child.getChildCount(),0);
  child=(ASTNode)root.getChild(4);
  assertEquals(child.getText(),maxEventLimit);
  assertEquals(child.getChildCount(),0);
}
