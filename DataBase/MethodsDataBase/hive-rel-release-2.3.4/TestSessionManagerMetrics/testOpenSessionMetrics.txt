@Test public void testOpenSessionMetrics() throws Exception {
  String json=metrics.dumpJson();
  MetricsTestUtils.verifyMetricsJson(json,MetricsTestUtils.GAUGE,MetricsConstant.HS2_OPEN_SESSIONS,0);
  SessionHandle handle=sm.openSession(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V9,"user","passw","127.0.0.1",new HashMap<String,String>());
  json=metrics.dumpJson();
  MetricsTestUtils.verifyMetricsJson(json,MetricsTestUtils.GAUGE,MetricsConstant.HS2_OPEN_SESSIONS,1);
  sm.openSession(TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V9,"user","passw","127.0.0.1",new HashMap<String,String>());
  json=metrics.dumpJson();
  MetricsTestUtils.verifyMetricsJson(json,MetricsTestUtils.GAUGE,MetricsConstant.HS2_OPEN_SESSIONS,2);
  sm.closeSession(handle);
  json=metrics.dumpJson();
  MetricsTestUtils.verifyMetricsJson(json,MetricsTestUtils.GAUGE,MetricsConstant.HS2_OPEN_SESSIONS,1);
}
