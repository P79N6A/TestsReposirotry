@Test public void testFindGroupDNWhenExceptionInSearch() throws NamingException {
  conf.setVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_GROUPDNPATTERN,Joiner.on(":").join("CN=%s,OU=org1,DC=foo,DC=bar","CN=%s,OU=org2,DC=foo,DC=bar"));
  NamingEnumeration<SearchResult> result=LdapTestUtils.mockNamingEnumeration("CN=Group1");
  when(ctx.search(anyString(),anyString(),any(SearchControls.class))).thenReturn(result).thenThrow(NamingException.class);
  search=new LdapSearch(conf,ctx);
  String expected="CN=Group1";
  String actual=search.findGroupDn("grp1");
  assertEquals(expected,actual);
}
