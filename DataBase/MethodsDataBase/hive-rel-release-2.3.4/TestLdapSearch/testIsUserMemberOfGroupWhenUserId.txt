@Test public void testIsUserMemberOfGroupWhenUserId() throws NamingException {
  conf.setVar(HiveConf.ConfVars.HIVE_SERVER2_PLAIN_LDAP_USERDNPATTERN,"CN=%s,OU=org1,DC=foo,DC=bar");
  NamingEnumeration<SearchResult> validResult=LdapTestUtils.mockNamingEnumeration("CN=User1");
  NamingEnumeration<SearchResult> emptyResult=LdapTestUtils.mockEmptyNamingEnumeration();
  when(ctx.search(anyString(),contains("(uid=usr1)"),any(SearchControls.class))).thenReturn(validResult);
  when(ctx.search(anyString(),contains("(uid=usr2)"),any(SearchControls.class))).thenReturn(emptyResult);
  search=new LdapSearch(conf,ctx);
  assertTrue(search.isUserMemberOfGroup("usr1","grp1"));
  assertFalse(search.isUserMemberOfGroup("usr2","grp2"));
}
