/** 
 * Check that a new client is returned for the same configuration after the expiry time. Also verify that the expiry time configuration is honoured
 */
@Test public void testCacheExpiry() throws IOException, MetaException, LoginException, InterruptedException {
  HiveClientCache cache=new HiveClientCache(1);
  HiveClientCache.ICacheableMetaStoreClient client=(HiveClientCache.ICacheableMetaStoreClient)cache.get(hiveConf);
  assertNotNull(client);
  Thread.sleep(2500);
  HiveClientCache.ICacheableMetaStoreClient client2=(HiveClientCache.ICacheableMetaStoreClient)cache.get(hiveConf);
  client.close();
  assertTrue(client.isClosed());
  assertNotNull(client2);
  assertNotSame(client,client2);
}
