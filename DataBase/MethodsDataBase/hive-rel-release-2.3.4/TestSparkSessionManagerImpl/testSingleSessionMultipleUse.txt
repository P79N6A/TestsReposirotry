/** 
 * Tests CLI scenario where we get a single session and use it multiple times. 
 */
@Test public void testSingleSessionMultipleUse() throws Exception {
  HiveConf conf=new HiveConf();
  conf.set("spark.master","local");
  SparkSessionManager sessionManager=SparkSessionManagerImpl.getInstance();
  SparkSession sparkSession1=sessionManager.getSession(null,conf,true);
  assertTrue(sparkSession1.isOpen());
  SparkSession sparkSession2=sessionManager.getSession(sparkSession1,conf,true);
  assertTrue(sparkSession1 == sparkSession2);
  assertTrue(sparkSession2.isOpen());
  sessionManager.shutdown();
  sessionManager.closeSession(sparkSession1);
}
