@Test public void testJobSubmission() throws Exception {
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle.Listener<String> listener=newListener();
      List<JobHandle.Listener<String>> listeners=Lists.newArrayList(listener);
      ;
      JobHandle<String> handle=client.submit(new SimpleJob(),listeners);
      assertEquals("hello",handle.get(TIMEOUT,TimeUnit.SECONDS));
      assertFalse(((JobHandleImpl<String>)handle).changeState(JobHandle.State.SENT));
      verify(listener).onJobStarted(handle);
      verify(listener).onJobSucceeded(same(handle),eq(handle.get()));
    }
  }
);
}
