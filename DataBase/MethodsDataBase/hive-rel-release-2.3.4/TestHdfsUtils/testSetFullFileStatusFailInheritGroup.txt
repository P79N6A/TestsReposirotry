/** 
 * Tests that  {@link HdfsUtils#setFullFileStatus(Configuration,HdfsUtils.HadoopFileStatus,String,FileSystem,Path,boolean)}does not throw an exception when setting the group and without recursion.
 */
@Test public void testSetFullFileStatusFailInheritGroup() throws IOException {
  Configuration conf=new Configuration();
  conf.set("dfs.namenode.acls.enabled","false");
  HdfsUtils.HadoopFileStatus mockHadoopFileStatus=mock(HdfsUtils.HadoopFileStatus.class);
  FileStatus mockSourceStatus=mock(FileStatus.class);
  FileSystem fs=mock(FileSystem.class);
  when(mockSourceStatus.getGroup()).thenReturn("fakeGroup1");
  when(mockHadoopFileStatus.getFileStatus()).thenReturn(mockSourceStatus);
  doThrow(RuntimeException.class).when(fs).setOwner(any(Path.class),any(String.class),any(String.class));
  HdfsUtils.setFullFileStatus(conf,mockHadoopFileStatus,"fakeGroup2",fs,new Path("fakePath"),false);
  verify(fs).setOwner(any(Path.class),any(String.class),any(String.class));
}
