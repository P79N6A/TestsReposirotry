/** 
 * Test notification operations
 */
@Test public void testNotificationOps() throws InterruptedException {
  final int NO_EVENT_ID=0;
  final int FIRST_EVENT_ID=1;
  final int SECOND_EVENT_ID=2;
  NotificationEvent event=new NotificationEvent(0,0,EventMessage.EventType.CREATE_DATABASE.toString(),"");
  NotificationEventResponse eventResponse;
  CurrentNotificationEventId eventId;
  eventId=objectStore.getCurrentNotificationEventId();
  Assert.assertEquals(NO_EVENT_ID,eventId.getEventId());
  objectStore.addNotificationEvent(event);
  Assert.assertEquals(FIRST_EVENT_ID,event.getEventId());
  objectStore.addNotificationEvent(event);
  Assert.assertEquals(SECOND_EVENT_ID,event.getEventId());
  eventId=objectStore.getCurrentNotificationEventId();
  Assert.assertEquals(SECOND_EVENT_ID,eventId.getEventId());
  eventResponse=objectStore.getNextNotification(new NotificationEventRequest());
  Assert.assertEquals(2,eventResponse.getEventsSize());
  Assert.assertEquals(FIRST_EVENT_ID,eventResponse.getEvents().get(0).getEventId());
  Assert.assertEquals(SECOND_EVENT_ID,eventResponse.getEvents().get(1).getEventId());
  eventResponse=objectStore.getNextNotification(new NotificationEventRequest(FIRST_EVENT_ID));
  Assert.assertEquals(1,eventResponse.getEventsSize());
  Assert.assertEquals(SECOND_EVENT_ID,eventResponse.getEvents().get(0).getEventId());
  eventResponse=objectStore.getNextNotification(new NotificationEventRequest(SECOND_EVENT_ID));
  Assert.assertEquals(0,eventResponse.getEventsSize());
  Thread.sleep(1);
  objectStore.cleanNotificationEvents(1);
  eventResponse=objectStore.getNextNotification(new NotificationEventRequest());
  Assert.assertEquals(0,eventResponse.getEventsSize());
}
