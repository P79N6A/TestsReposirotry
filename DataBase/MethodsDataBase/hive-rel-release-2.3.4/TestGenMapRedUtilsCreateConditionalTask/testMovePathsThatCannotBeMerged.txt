@Test public void testMovePathsThatCannotBeMerged(){
  final Path condInputPath=new Path("s3a://bucket/scratch/-ext-10000");
  final Path condOutputPath=new Path("s3a://bucket/scratch/-ext-10002");
  final MoveWork mockWork=mock(MoveWork.class);
  assertFalse("A MoveWork null object cannot be merged.",GenMapRedUtils.shouldMergeMovePaths(hiveConf,condInputPath,condOutputPath,null));
  hiveConf.set(HiveConf.ConfVars.HIVE_BLOBSTORE_OPTIMIZATIONS_ENABLED.varname,"false");
  assertFalse("Merging paths is not allowed when BlobStorage optimizations are disabled.",GenMapRedUtils.shouldMergeMovePaths(hiveConf,condInputPath,condOutputPath,mockWork));
  hiveConf.set(HiveConf.ConfVars.HIVE_BLOBSTORE_OPTIMIZATIONS_ENABLED.varname,"true");
  reset(mockWork);
  when(mockWork.getLoadMultiFilesWork()).thenReturn(new LoadMultiFilesDesc());
  assertFalse("Merging paths is not allowed when MultiFileWork is found in the MoveWork object.",GenMapRedUtils.shouldMergeMovePaths(hiveConf,condInputPath,condOutputPath,mockWork));
  reset(mockWork);
  when(mockWork.getLoadFileWork()).thenReturn(mock(LoadFileDesc.class));
  when(mockWork.getLoadTableWork()).thenReturn(mock(LoadTableDesc.class));
  assertFalse("Merging paths is not allowed when both LoadFileWork & LoadTableWork are found in the MoveWork object.",GenMapRedUtils.shouldMergeMovePaths(hiveConf,condInputPath,condOutputPath,mockWork));
  reset(mockWork);
  when(mockWork.getLoadFileWork()).thenReturn(new LoadFileDesc(condInputPath,condOutputPath,false,"",""));
  assertFalse("Merging paths is not allowed when both conditional output path is not equals to MoveWork input path.",GenMapRedUtils.shouldMergeMovePaths(hiveConf,condInputPath,condOutputPath,mockWork));
  reset(mockWork);
  when(mockWork.getLoadFileWork()).thenReturn(new LoadFileDesc(condOutputPath,new Path("unused"),false,"",""));
  assertFalse("Merging paths is not allowed when conditional input path is not a BlobStore path.",GenMapRedUtils.shouldMergeMovePaths(hiveConf,new Path("hdfs://hdfs-path"),condOutputPath,mockWork));
  reset(mockWork);
  when(mockWork.getLoadFileWork()).thenReturn(new LoadFileDesc(condOutputPath,new Path("hdfs://hdfs-path"),false,"",""));
  assertFalse("Merging paths is not allowed when MoveWork output path is not a BlobStore path.",GenMapRedUtils.shouldMergeMovePaths(hiveConf,condInputPath,condOutputPath,mockWork));
}
