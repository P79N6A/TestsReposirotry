/** 
 * `1` means 1 is a column name and '1' means 1 is a string literal HiveConf.HIVE_QUOTEDID_SUPPORT HiveConf.HIVE_SUPPORT_SPECICAL_CHARACTERS_IN_TABLE_NAMES {@link TestTxnCommands#testMergeType2SCD01()}
 */
@Test public void testQuotedIdentifier() throws Exception {
  String target="`aci/d_u/ami`";
  String src="`src/name`";
  runStatementOnDriver("drop table if exists " + target);
  runStatementOnDriver("drop table if exists " + src);
  runStatementOnDriver("create table " + target + "(i int,"+ "`d?*de e` decimal(5,2),"+ "vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')");
  runStatementOnDriver("create table " + src + "(gh int, j decimal(5,2), k varchar(128))");
  runStatementOnDriver("merge into " + target + " as `d/8` using "+ src+ " as `a/b` on i=gh "+ "\nwhen matched and i > 5 then delete "+ "\nwhen matched then update set vc='blah' "+ "\nwhen not matched then insert values(1,2.1,'baz')");
  runStatementOnDriver("merge into " + target + " as `d/8` using "+ src+ " as `a/b` on i=gh "+ "\nwhen matched and i > 5 then delete "+ "\nwhen matched then update set vc='blah',  `d?*de e` = current_timestamp()  "+ "\nwhen not matched then insert values(1,2.1, concat('baz', current_timestamp()))");
  runStatementOnDriver("merge into " + target + " as `d/8` using "+ src+ " as `a/b` on i=gh "+ "\nwhen matched and i > 5 then delete "+ "\nwhen matched then update set vc='blah' "+ "\nwhen not matched then insert values(1,2.1,'a\\b')");
  runStatementOnDriver("merge into " + target + " as `d/8` using "+ src+ " as `a/b` on i=gh "+ "\nwhen matched and i > 5 then delete "+ "\nwhen matched then update set vc='∆∋'"+ "\nwhen not matched then insert values(`a/b`.gh,`a/b`.j,'c\\t')");
}
