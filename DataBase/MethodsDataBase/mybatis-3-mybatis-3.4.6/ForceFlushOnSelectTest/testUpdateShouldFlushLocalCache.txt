@Test public void testUpdateShouldFlushLocalCache() throws SQLException {
  SqlSession sqlSession=sqlSessionFactory.openSession(ExecutorType.SIMPLE);
  try {
    PersonMapper personMapper=sqlSession.getMapper(PersonMapper.class);
    Person person=personMapper.selectByIdNoFlush(1);
    person.setLastName("Perez");
    personMapper.update(person);
    Person updatedPerson=personMapper.selectByIdNoFlush(1);
    assertEquals("Smith",updatedPerson.getLastName());
    assertNotSame(person,updatedPerson);
    sqlSession.commit();
  }
  finally {
    sqlSession.close();
  }
}
