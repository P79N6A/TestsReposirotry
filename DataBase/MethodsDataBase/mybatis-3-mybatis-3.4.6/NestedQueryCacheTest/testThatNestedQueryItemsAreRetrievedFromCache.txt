@Test public void testThatNestedQueryItemsAreRetrievedFromCache() throws Exception {
  SqlSession sqlSession=sqlSessionFactory.openSession();
  final Author author;
  try {
    final AuthorMapper authorMapper=sqlSession.getMapper(AuthorMapper.class);
    author=authorMapper.selectAuthor(101);
    final Author cachedAuthor=authorMapper.selectAuthor(101);
    assertThat(author).isSameAs(cachedAuthor);
  }
  finally {
    sqlSession.close();
  }
  sqlSession=sqlSessionFactory.openSession();
  try {
    final BlogMapper blogMapper=sqlSession.getMapper(BlogMapper.class);
    assertThat(blogMapper.selectBlog(1).getAuthor()).isSameAs(author);
    assertThat(blogMapper.selectBlogUsingConstructor(1).getAuthor()).isSameAs(author);
  }
  finally {
    sqlSession.close();
  }
}
