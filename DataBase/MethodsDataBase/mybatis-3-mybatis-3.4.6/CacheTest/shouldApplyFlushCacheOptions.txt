@Test public void shouldApplyFlushCacheOptions(){
  SqlSession sqlSession1=sqlSessionFactory.openSession(true);
  try {
    PersonMapper pm=sqlSession1.getMapper(PersonMapper.class);
    Assert.assertEquals(2,pm.findAll().size());
  }
  finally {
    sqlSession1.close();
  }
  SqlSession sqlSession2=sqlSessionFactory.openSession(true);
  try {
    PersonMapper pm=sqlSession2.getMapper(PersonMapper.class);
    Person p=new Person(3,"hello","world");
    pm.createWithoutFlushCache(p);
  }
  finally {
    sqlSession2.close();
  }
  SqlSession sqlSession3=sqlSessionFactory.openSession(true);
  try {
    PersonMapper pm=sqlSession3.getMapper(PersonMapper.class);
    Assert.assertEquals(2,pm.findAll().size());
  }
  finally {
    sqlSession3.close();
  }
  SqlSession sqlSession4=sqlSessionFactory.openSession(true);
  try {
    PersonMapper pm=sqlSession4.getMapper(PersonMapper.class);
    Assert.assertEquals(3,pm.findWithFlushCache().size());
  }
  finally {
    sqlSession4.close();
  }
}
