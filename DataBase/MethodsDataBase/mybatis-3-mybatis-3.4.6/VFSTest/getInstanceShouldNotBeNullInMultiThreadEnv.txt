@Test public void getInstanceShouldNotBeNullInMultiThreadEnv() throws InterruptedException {
  final int threadCount=3;
  Thread[] threads=new Thread[threadCount];
  InstanceGetterProcedure[] procedures=new InstanceGetterProcedure[threadCount];
  for (int i=0; i < threads.length; i++) {
    String threadName="Thread##" + i;
    procedures[i]=new InstanceGetterProcedure();
    threads[i]=new Thread(procedures[i],threadName);
  }
  for (  Thread thread : threads) {
    thread.start();
  }
  for (  Thread thread : threads) {
    thread.join();
  }
  for (int i=0; i < threadCount - 1; i++) {
    Assert.assertEquals(procedures[i].instanceGot,procedures[i + 1].instanceGot);
  }
}
