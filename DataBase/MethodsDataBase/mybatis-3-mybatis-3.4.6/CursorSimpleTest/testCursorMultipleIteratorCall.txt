@Test public void testCursorMultipleIteratorCall(){
  SqlSession sqlSession=sqlSessionFactory.openSession();
  Mapper mapper=sqlSession.getMapper(Mapper.class);
  Cursor<User> usersCursor=mapper.getAllUsers();
  Iterator<User> iterator2=null;
  try {
    Iterator<User> iterator=usersCursor.iterator();
    User user=iterator.next();
    Assert.assertEquals("User1",user.getName());
    Assert.assertEquals(0,usersCursor.getCurrentIndex());
    iterator2=usersCursor.iterator();
    iterator2.hasNext();
    Assert.fail("We should have failed since calling iterator several times is not allowed");
  }
 catch (  IllegalStateException e) {
    Assert.assertNull("iterator2 should be null",iterator2);
    return;
  }
 finally {
    sqlSession.close();
  }
  Assert.fail("Should have returned earlier");
}
