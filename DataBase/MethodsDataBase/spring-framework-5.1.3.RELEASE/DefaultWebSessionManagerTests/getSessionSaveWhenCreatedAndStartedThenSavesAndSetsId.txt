@Test public void getSessionSaveWhenCreatedAndStartedThenSavesAndSetsId(){
  when(this.sessionIdResolver.resolveSessionIds(this.exchange)).thenReturn(Collections.emptyList());
  WebSession session=this.sessionManager.getSession(this.exchange).block();
  assertSame(this.createSession,session);
  String sessionId=this.createSession.getId();
  when(this.createSession.isStarted()).thenReturn(true);
  this.exchange.getResponse().setComplete().block();
  verify(this.sessionStore).createWebSession();
  verify(this.sessionIdResolver).setSessionId(any(),eq(sessionId));
  verify(this.createSession).save();
}
