@Test public void controllerAdvice() throws Exception {
  StaticWebApplicationContext ctx=new StaticWebApplicationContext();
  ctx.registerSingleton("exceptionHandler",ApplicationExceptionHandler.class);
  ctx.refresh();
  ExceptionHandlerExceptionResolver resolver=new ExceptionHandlerExceptionResolver();
  resolver.setApplicationContext(ctx);
  resolver.afterPropertiesSet();
  ServletRequestBindingException ex=new ServletRequestBindingException("message");
  assertNotNull(resolver.resolveException(this.servletRequest,this.servletResponse,null,ex));
  assertEquals(400,this.servletResponse.getStatus());
  assertEquals("error content",this.servletResponse.getContentAsString());
  assertEquals("someHeaderValue",this.servletResponse.getHeader("someHeader"));
}
