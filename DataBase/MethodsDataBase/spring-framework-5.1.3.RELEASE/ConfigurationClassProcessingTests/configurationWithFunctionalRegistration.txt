@Test public void configurationWithFunctionalRegistration(){
  AnnotationConfigApplicationContext ctx=new AnnotationConfigApplicationContext();
  ctx.register(ConfigWithFunctionalRegistration.class);
  ctx.refresh();
  assertSame(ctx.getBean("spouse"),ctx.getBean(TestBean.class).getSpouse());
  assertEquals("functional",ctx.getBean(NestedTestBean.class).getCompany());
}
