@Test @SuppressWarnings("unchecked") public void testQueryNoPersonsShared(){
  Query q=this.sharedEntityManager.createQuery("select p from Person as p");
  q.setFlushMode(FlushModeType.AUTO);
  List<Person> people=q.getResultList();
  assertEquals(0,people.size());
  try {
    assertNull(q.getSingleResult());
    fail("Should have thrown NoResultException");
  }
 catch (  NoResultException ex) {
  }
}
