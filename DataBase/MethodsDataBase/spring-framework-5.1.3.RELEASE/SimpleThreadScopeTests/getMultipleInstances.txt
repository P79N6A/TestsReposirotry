@Test public void getMultipleInstances() throws Exception {
  TestBean[] beans=new TestBean[2];
  Thread thread1=new Thread(() -> beans[0]=applicationContext.getBean("threadScopedObject",TestBean.class));
  Thread thread2=new Thread(() -> beans[1]=applicationContext.getBean("threadScopedObject",TestBean.class));
  thread1.start();
  thread2.start();
  Awaitility.await().atMost(500,TimeUnit.MILLISECONDS).pollInterval(10,TimeUnit.MILLISECONDS).until(() -> (beans[0] != null) && (beans[1] != null));
  assertNotSame(beans[0],beans[1]);
}
