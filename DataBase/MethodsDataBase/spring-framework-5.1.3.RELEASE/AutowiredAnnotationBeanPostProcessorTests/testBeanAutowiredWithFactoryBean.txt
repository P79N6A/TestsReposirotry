/** 
 * Verifies that a dependency on a  {@link FactoryBean} can be autowired via{@link Autowired @Autowired}, specifically addressing the JIRA issue raised in <a href="http://opensource.atlassian.com/projects/spring/browse/SPR-4040" target="_blank">SPR-4040</a>.
 */
@Test public void testBeanAutowiredWithFactoryBean(){
  bf.registerBeanDefinition("factoryBeanDependentBean",new RootBeanDefinition(FactoryBeanDependentBean.class));
  bf.registerSingleton("stringFactoryBean",new StringFactoryBean());
  final StringFactoryBean factoryBean=(StringFactoryBean)bf.getBean("&stringFactoryBean");
  final FactoryBeanDependentBean bean=(FactoryBeanDependentBean)bf.getBean("factoryBeanDependentBean");
  assertNotNull("The singleton StringFactoryBean should have been registered.",factoryBean);
  assertNotNull("The factoryBeanDependentBean should have been registered.",bean);
  assertEquals("The FactoryBeanDependentBean should have been autowired 'by type' with the StringFactoryBean.",factoryBean,bean.getFactoryBean());
}
