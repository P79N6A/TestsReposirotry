@Test public void testConstructorResourceInjectionWithCollectionAndNullFromFactoryBean(){
  bf.registerBeanDefinition("annotatedBean",new RootBeanDefinition(ConstructorsCollectionResourceInjectionBean.class));
  TestBean tb=new TestBean();
  bf.registerSingleton("testBean",tb);
  bf.registerBeanDefinition("nestedTestBean1",new RootBeanDefinition(NullNestedTestBeanFactoryBean.class));
  NestedTestBean ntb2=new NestedTestBean();
  bf.registerSingleton("nestedTestBean2",ntb2);
  ConstructorsCollectionResourceInjectionBean bean=(ConstructorsCollectionResourceInjectionBean)bf.getBean("annotatedBean");
  assertNull(bean.getTestBean3());
  assertSame(tb,bean.getTestBean4());
  assertEquals(1,bean.getNestedTestBeans().size());
  assertSame(ntb2,bean.getNestedTestBeans().get(0));
  Map<String,NestedTestBean> map=bf.getBeansOfType(NestedTestBean.class);
  assertNull(map.get("nestedTestBean1"));
  assertSame(ntb2,map.get("nestedTestBean2"));
}
