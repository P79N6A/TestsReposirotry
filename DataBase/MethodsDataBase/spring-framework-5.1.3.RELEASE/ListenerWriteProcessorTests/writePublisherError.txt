@Test public void writePublisherError(){
  this.processor.setWritePossible(false);
  DataBuffer buffer=mock(DataBuffer.class);
  this.processor.onNext(buffer);
  this.processor.onError(new IllegalStateException());
  assertNotNull("Error should flow to result publisher",this.resultSubscriber.getError());
  assertEquals(1,this.processor.getDiscardedBuffers().size());
  assertSame(buffer,this.processor.getDiscardedBuffers().get(0));
}
