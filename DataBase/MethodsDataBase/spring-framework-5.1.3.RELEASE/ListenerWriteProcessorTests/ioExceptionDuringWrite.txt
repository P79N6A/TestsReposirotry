@Test public void ioExceptionDuringWrite(){
  this.processor.setWritePossible(true);
  this.processor.setFailOnWrite(true);
  DataBuffer buffer=mock(DataBuffer.class);
  this.processor.onNext(buffer);
  assertNotNull("Error should flow to result publisher",this.resultSubscriber.getError());
  assertEquals(1,this.processor.getDiscardedBuffers().size());
  assertSame(buffer,this.processor.getDiscardedBuffers().get(0));
}
