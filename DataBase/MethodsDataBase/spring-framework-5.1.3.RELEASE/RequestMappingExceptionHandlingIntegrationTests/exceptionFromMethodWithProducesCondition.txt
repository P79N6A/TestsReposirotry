@Test public void exceptionFromMethodWithProducesCondition() throws Exception {
  try {
    HttpHeaders headers=new HttpHeaders();
    headers.add("Accept","text/csv, application/problem+json");
    performGet("/SPR-16318",headers,String.class).getBody();
    fail();
  }
 catch (  HttpStatusCodeException ex) {
    assertEquals(500,ex.getRawStatusCode());
    assertEquals("application/problem+json;charset=UTF-8",ex.getResponseHeaders().getContentType().toString());
    assertEquals("{\"reason\":\"error\"}",ex.getResponseBodyAsString());
  }
}
