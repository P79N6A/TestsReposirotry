@Test public void servletPathMapping() throws Exception {
  AnnotationConfigApplicationContext context=new AnnotationConfigApplicationContext();
  context.register(WebAppConfig.class);
  context.refresh();
  File base=new File(System.getProperty("java.io.tmpdir"));
  TomcatHttpServer server=new TomcatHttpServer(base.getAbsolutePath());
  server.setContextPath("/app");
  server.setServletMapping("/api/*");
  HttpHandler httpHandler=WebHttpHandlerBuilder.applicationContext(context).build();
  server.setHandler(httpHandler);
  server.afterPropertiesSet();
  server.start();
  try {
    RestTemplate restTemplate=new RestTemplate();
    String actual;
    String url="http://localhost:" + server.getPort() + "/app/api/test";
    actual=restTemplate.getForObject(url,String.class);
    assertEquals("Tested in /app/api",actual);
  }
  finally {
    server.stop();
  }
}
