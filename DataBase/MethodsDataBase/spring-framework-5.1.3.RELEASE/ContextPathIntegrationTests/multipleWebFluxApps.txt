@Test public void multipleWebFluxApps() throws Exception {
  AnnotationConfigApplicationContext context1=new AnnotationConfigApplicationContext();
  context1.register(WebAppConfig.class);
  context1.refresh();
  AnnotationConfigApplicationContext context2=new AnnotationConfigApplicationContext();
  context2.register(WebAppConfig.class);
  context2.refresh();
  HttpHandler webApp1Handler=WebHttpHandlerBuilder.applicationContext(context1).build();
  HttpHandler webApp2Handler=WebHttpHandlerBuilder.applicationContext(context2).build();
  ReactorHttpServer server=new ReactorHttpServer();
  server.registerHttpHandler("/webApp1",webApp1Handler);
  server.registerHttpHandler("/webApp2",webApp2Handler);
  server.afterPropertiesSet();
  server.start();
  try {
    RestTemplate restTemplate=new RestTemplate();
    String actual;
    String url="http://localhost:" + server.getPort() + "/webApp1/test";
    actual=restTemplate.getForObject(url,String.class);
    assertEquals("Tested in /webApp1",actual);
    url="http://localhost:" + server.getPort() + "/webApp2/test";
    actual=restTemplate.getForObject(url,String.class);
    assertEquals("Tested in /webApp2",actual);
  }
  finally {
    server.stop();
  }
}
