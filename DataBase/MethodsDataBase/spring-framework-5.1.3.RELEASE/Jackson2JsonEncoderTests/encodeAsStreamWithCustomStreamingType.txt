@Test public void encodeAsStreamWithCustomStreamingType(){
  MediaType fooMediaType=new MediaType("application","foo");
  MediaType barMediaType=new MediaType("application","bar");
  this.encoder.setStreamingMediaTypes(Arrays.asList(fooMediaType,barMediaType));
  Flux<Pojo> input=Flux.just(new Pojo("foo","bar"),new Pojo("foofoo","barbar"),new Pojo("foofoofoo","barbarbar"));
  testEncode(input,ResolvableType.forClass(Pojo.class),step -> step.consumeNextWith(expectString("{\"foo\":\"foo\",\"bar\":\"bar\"}\n").andThen(DataBufferUtils::release)).consumeNextWith(expectString("{\"foo\":\"foofoo\",\"bar\":\"barbar\"}\n").andThen(DataBufferUtils::release)).consumeNextWith(expectString("{\"foo\":\"foofoofoo\",\"bar\":\"barbarbar\"}\n").andThen(DataBufferUtils::release)).verifyComplete(),barMediaType,null);
}
