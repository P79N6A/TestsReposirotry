/** 
 * In order to preserve backward-compatibility,  {@link StandardAnnotationMetadata}defaults to return nested annotations and annotation arrays as actual Annotation instances. It is recommended for compatibility with ASM-based AnnotationMetadata implementations to set the 'nestedAnnotationsAsMap' flag to 'true' as is done in the main test above.
 */
@Test public void standardAnnotationMetadata_nestedAnnotationsAsMap_false() throws Exception {
  AnnotationMetadata metadata=new StandardAnnotationMetadata(AnnotatedComponent.class);
  AnnotationAttributes specialAttrs=(AnnotationAttributes)metadata.getAnnotationAttributes(SpecialAttr.class.getName());
  Annotation[] nestedAnnoArray=(Annotation[])specialAttrs.get("nestedAnnoArray");
  assertThat(nestedAnnoArray[0],instanceOf(NestedAnno.class));
}
