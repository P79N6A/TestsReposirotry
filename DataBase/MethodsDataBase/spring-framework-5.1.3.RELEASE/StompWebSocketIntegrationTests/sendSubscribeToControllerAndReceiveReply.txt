@Test public void sendSubscribeToControllerAndReceiveReply() throws Exception {
  TextMessage m0=create(StompCommand.CONNECT).headers("accept-version:1.1").build();
  String destHeader="destination:/app/number";
  TextMessage m1=create(StompCommand.SUBSCRIBE).headers("id:subs1",destHeader).build();
  TestClientWebSocketHandler clientHandler=new TestClientWebSocketHandler(2,m0,m1);
  WebSocketSession session=doHandshake(clientHandler,"/ws").get();
  try {
    assertTrue(clientHandler.latch.await(TIMEOUT,TimeUnit.SECONDS));
    String payload=clientHandler.actual.get(1).getPayload();
    assertTrue("Expected STOMP destination=/app/number, got " + payload,payload.contains(destHeader));
    assertTrue("Expected STOMP Payload=42, got " + payload,payload.contains("42"));
  }
  finally {
    session.close();
  }
}
