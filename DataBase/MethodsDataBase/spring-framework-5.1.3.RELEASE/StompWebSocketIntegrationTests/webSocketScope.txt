@Test public void webSocketScope() throws Exception {
  TextMessage m0=create(StompCommand.CONNECT).headers("accept-version:1.1").build();
  TextMessage m1=create(StompCommand.SUBSCRIBE).headers("id:subs1","destination:/topic/scopedBeanValue").build();
  TextMessage m2=create(StompCommand.SEND).headers("destination:/app/scopedBeanValue").build();
  TestClientWebSocketHandler clientHandler=new TestClientWebSocketHandler(2,m0,m1,m2);
  WebSocketSession session=doHandshake(clientHandler,"/ws").get();
  try {
    assertTrue(clientHandler.latch.await(TIMEOUT,TimeUnit.SECONDS));
    String payload=clientHandler.actual.get(1).getPayload();
    assertTrue(payload.startsWith("MESSAGE\n"));
    assertTrue(payload.contains("destination:/topic/scopedBeanValue\n"));
    assertTrue(payload.endsWith("55\0"));
  }
  finally {
    session.close();
  }
}
