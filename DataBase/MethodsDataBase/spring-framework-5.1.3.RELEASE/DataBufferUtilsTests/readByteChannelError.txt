@Test public void readByteChannelError() throws Exception {
  ReadableByteChannel channel=mock(ReadableByteChannel.class);
  when(channel.read(any())).thenAnswer(invocation -> {
    ByteBuffer buffer=invocation.getArgument(0);
    buffer.put("foo".getBytes(StandardCharsets.UTF_8));
    buffer.flip();
    return 3;
  }
).thenThrow(new IOException());
  Flux<DataBuffer> result=DataBufferUtils.readByteChannel(() -> channel,this.bufferFactory,3);
  StepVerifier.create(result).consumeNextWith(stringConsumer("foo")).expectError(IOException.class).verify(Duration.ofSeconds(3));
}
