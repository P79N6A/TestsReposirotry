@Test public void writeAsynchronousFileChannelCanceled() throws Exception {
  DataBuffer foo=stringBuffer("foo");
  DataBuffer bar=stringBuffer("bar");
  Flux<DataBuffer> flux=Flux.just(foo,bar);
  AsynchronousFileChannel channel=AsynchronousFileChannel.open(tempFile,StandardOpenOption.WRITE);
  Flux<DataBuffer> writeResult=DataBufferUtils.write(flux,channel);
  StepVerifier.create(writeResult,1).consumeNextWith(stringConsumer("foo")).thenCancel().verify();
  String result=String.join("",Files.readAllLines(tempFile));
  assertEquals("foo",result);
  channel.close();
  flux.subscribe(DataBufferUtils::release);
}
