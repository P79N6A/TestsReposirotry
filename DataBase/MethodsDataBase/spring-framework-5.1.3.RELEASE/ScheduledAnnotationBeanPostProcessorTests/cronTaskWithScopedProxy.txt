@Test public void cronTaskWithScopedProxy(){
  BeanDefinition processorDefinition=new RootBeanDefinition(ScheduledAnnotationBeanPostProcessor.class);
  context.registerBeanDefinition("postProcessor",processorDefinition);
  new AnnotatedBeanDefinitionReader(context).register(ProxiedCronTestBean.class,ProxiedCronTestBeanDependent.class);
  context.refresh();
  ScheduledTaskHolder postProcessor=context.getBean("postProcessor",ScheduledTaskHolder.class);
  assertEquals(1,postProcessor.getScheduledTasks().size());
  ScheduledTaskRegistrar registrar=(ScheduledTaskRegistrar)new DirectFieldAccessor(postProcessor).getPropertyValue("registrar");
  @SuppressWarnings("unchecked") List<CronTask> cronTasks=(List<CronTask>)new DirectFieldAccessor(registrar).getPropertyValue("cronTasks");
  assertEquals(1,cronTasks.size());
  CronTask task=cronTasks.get(0);
  ScheduledMethodRunnable runnable=(ScheduledMethodRunnable)task.getRunnable();
  Object targetObject=runnable.getTarget();
  Method targetMethod=runnable.getMethod();
  assertEquals(context.getBean(ScopedProxyUtils.getTargetBeanName("target")),targetObject);
  assertEquals("cron",targetMethod.getName());
  assertEquals("*/7 * * * * ?",task.getExpression());
}
