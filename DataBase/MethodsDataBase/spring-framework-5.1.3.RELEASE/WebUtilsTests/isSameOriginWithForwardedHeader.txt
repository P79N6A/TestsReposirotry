@Test public void isSameOriginWithForwardedHeader() throws Exception {
  String server="mydomain1.com";
  testWithForwardedHeader(server,-1,"proto=https","https://mydomain1.com");
  testWithForwardedHeader(server,123,"proto=https","https://mydomain1.com");
  testWithForwardedHeader(server,-1,"proto=https; host=mydomain2.com","https://mydomain2.com");
  testWithForwardedHeader(server,123,"proto=https; host=mydomain2.com","https://mydomain2.com");
  testWithForwardedHeader(server,-1,"proto=https; host=mydomain2.com:456","https://mydomain2.com:456");
  testWithForwardedHeader(server,123,"proto=https; host=mydomain2.com:456","https://mydomain2.com:456");
}
