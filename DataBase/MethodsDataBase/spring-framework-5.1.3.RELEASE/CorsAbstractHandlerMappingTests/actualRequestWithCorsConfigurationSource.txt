@Test public void actualRequestWithCorsConfigurationSource() throws Exception {
  this.handlerMapping.setCorsConfigurationSource(new CustomCorsConfigurationSource());
  this.request.setMethod(RequestMethod.GET.name());
  this.request.setRequestURI("/foo");
  this.request.addHeader(HttpHeaders.ORIGIN,"http://domain2.com");
  this.request.addHeader(HttpHeaders.ACCESS_CONTROL_REQUEST_METHOD,"GET");
  HandlerExecutionChain chain=handlerMapping.getHandler(this.request);
  assertNotNull(chain);
  assertTrue(chain.getHandler() instanceof SimpleHandler);
  CorsConfiguration config=getCorsConfiguration(chain,false);
  assertNotNull(config);
  assertArrayEquals(new String[]{"*"},config.getAllowedOrigins().toArray());
  assertEquals(true,config.getAllowCredentials());
}
