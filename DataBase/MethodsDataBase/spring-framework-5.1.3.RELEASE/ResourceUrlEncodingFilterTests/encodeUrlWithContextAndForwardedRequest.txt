@Test public void encodeUrlWithContextAndForwardedRequest() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest("GET","/context/foo");
  request.setContextPath("/context");
  this.filter.doFilter(request,new MockHttpServletResponse(),(req,res) -> {
    req.setAttribute(ResourceUrlProviderExposingInterceptor.RESOURCE_URL_PROVIDER_ATTR,this.urlProvider);
    request.setRequestURI("/forwarded");
    request.setContextPath("/");
    String result=((HttpServletResponse)res).encodeURL("/context/resources/bar.css");
    assertEquals("/context/resources/bar-11e16cf79faee7ac698c805cf28248d2.css",result);
  }
);
}
