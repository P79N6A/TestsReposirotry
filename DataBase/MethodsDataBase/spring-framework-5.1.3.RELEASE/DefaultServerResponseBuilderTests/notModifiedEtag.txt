@Test public void notModifiedEtag(){
  String etag="\"foo\"";
  ServerResponse responseMono=ServerResponse.ok().eTag(etag).syncBody("bar").block();
  MockServerHttpRequest request=MockServerHttpRequest.get("http://example.com").header(HttpHeaders.IF_NONE_MATCH,etag).build();
  MockServerWebExchange exchange=MockServerWebExchange.from(request);
  responseMono.writeTo(exchange,EMPTY_CONTEXT);
  MockServerHttpResponse response=exchange.getResponse();
  assertEquals(HttpStatus.NOT_MODIFIED,response.getStatusCode());
  StepVerifier.create(response.getBody()).expectError(IllegalStateException.class).verify();
}
