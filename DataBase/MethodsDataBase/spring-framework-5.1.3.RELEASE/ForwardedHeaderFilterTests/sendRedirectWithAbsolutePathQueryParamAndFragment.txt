@Test public void sendRedirectWithAbsolutePathQueryParamAndFragment() throws Exception {
  this.request.addHeader(X_FORWARDED_PROTO,"https");
  this.request.addHeader(X_FORWARDED_HOST,"example.com");
  this.request.addHeader(X_FORWARDED_PORT,"443");
  this.request.setQueryString("oldqp=1");
  String redirectedUrl=sendRedirect("/foo/bar?newqp=2#fragment");
  assertEquals("https://example.com/foo/bar?newqp=2#fragment",redirectedUrl);
}
