@Test public void sendTimeLimitExceeded() throws IOException, InterruptedException {
  BlockingSession session=new BlockingSession();
  session.setId("123");
  session.setOpen(true);
  final ConcurrentWebSocketSessionDecorator decorator=new ConcurrentWebSocketSessionDecorator(session,100,1024);
  sendBlockingMessage(decorator);
  Thread.sleep(200);
  try {
    TextMessage payload=new TextMessage("payload");
    decorator.sendMessage(payload);
    fail("Expected exception");
  }
 catch (  SessionLimitExceededException ex) {
    String actual=ex.getMessage();
    String regex="Send time [\\d]+ \\(ms\\) for session '123' exceeded the allowed limit 100";
    assertTrue("Unexpected message: " + actual,actual.matches(regex));
    assertEquals(CloseStatus.SESSION_NOT_RELIABLE,ex.getStatus());
  }
}
