@Test public void sendAfterBlockedSend() throws IOException, InterruptedException {
  BlockingSession session=new BlockingSession();
  session.setOpen(true);
  final ConcurrentWebSocketSessionDecorator decorator=new ConcurrentWebSocketSessionDecorator(session,10 * 1000,1024);
  sendBlockingMessage(decorator);
  Thread.sleep(50);
  assertTrue(decorator.getTimeSinceSendStarted() > 0);
  TextMessage payload=new TextMessage("payload");
  for (int i=0; i < 5; i++) {
    decorator.sendMessage(payload);
  }
  assertTrue(decorator.getTimeSinceSendStarted() > 0);
  assertEquals(5 * payload.getPayloadLength(),decorator.getBufferSize());
  assertTrue(session.isOpen());
}
