@Test public void getUnsupportedMediaType() throws Exception {
  mockSentRequest(GET,"http://example.com/resource");
  mockResponseStatus(HttpStatus.OK);
  given(converter.canRead(String.class,null)).willReturn(true);
  MediaType supportedMediaType=new MediaType("foo","bar");
  given(converter.getSupportedMediaTypes()).willReturn(Collections.singletonList(supportedMediaType));
  MediaType barBaz=new MediaType("bar","baz");
  mockResponseBody("Foo",new MediaType("bar","baz"));
  given(converter.canRead(String.class,barBaz)).willReturn(false);
  try {
    template.getForObject("http://example.com/{p}",String.class,"resource");
    fail("UnsupportedMediaTypeException expected");
  }
 catch (  RestClientException ex) {
  }
  verify(response).close();
}
