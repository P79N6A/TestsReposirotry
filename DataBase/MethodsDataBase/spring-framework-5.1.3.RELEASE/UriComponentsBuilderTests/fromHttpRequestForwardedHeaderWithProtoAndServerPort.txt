@Test public void fromHttpRequestForwardedHeaderWithProtoAndServerPort(){
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.addHeader("Forwarded","proto=https");
  request.setScheme("http");
  request.setServerPort(8080);
  request.setServerName("example.com");
  request.setRequestURI("/rest/mobile/users/1");
  HttpRequest httpRequest=new ServletServerHttpRequest(request);
  UriComponents result=UriComponentsBuilder.fromHttpRequest(httpRequest).build();
  assertEquals("https",result.getScheme());
  assertEquals("example.com",result.getHost());
  assertEquals("/rest/mobile/users/1",result.getPath());
  assertEquals(-1,result.getPort());
  assertEquals("https://example.com/rest/mobile/users/1",result.toUriString());
}
