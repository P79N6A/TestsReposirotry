/** 
 * Verifies that a dependency on a  {@link org.springframework.beans.factory.FactoryBean}can be autowired via  {@link org.springframework.beans.factory.annotation.Autowired @Inject}, specifically addressing SPR-4040.
 */
@Test public void testBeanAutowiredWithFactoryBean(){
  bf.registerBeanDefinition("factoryBeanDependentBean",new RootBeanDefinition(FactoryBeanDependentBean.class));
  bf.registerSingleton("stringFactoryBean",new StringFactoryBean());
  final StringFactoryBean factoryBean=(StringFactoryBean)bf.getBean("&stringFactoryBean");
  final FactoryBeanDependentBean bean=(FactoryBeanDependentBean)bf.getBean("factoryBeanDependentBean");
  assertNotNull("The singleton StringFactoryBean should have been registered.",factoryBean);
  assertNotNull("The factoryBeanDependentBean should have been registered.",bean);
  assertEquals("The FactoryBeanDependentBean should have been autowired 'by type' with the StringFactoryBean.",factoryBean,bean.getFactoryBean());
}
