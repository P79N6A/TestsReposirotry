@Test public void customExecutorConfigWithThrowsException(){
  AnnotationConfigApplicationContext ctx=new AnnotationConfigApplicationContext();
  ctx.register(CustomExecutorConfig.class);
  ctx.refresh();
  AsyncBean asyncBean=ctx.getBean(AsyncBean.class);
  Method method=ReflectionUtils.findMethod(AsyncBean.class,"fail");
  TestableAsyncUncaughtExceptionHandler exceptionHandler=(TestableAsyncUncaughtExceptionHandler)ctx.getBean("exceptionHandler");
  assertFalse("handler should not have been called yet",exceptionHandler.isCalled());
  asyncBean.fail();
  Awaitility.await().atMost(500,TimeUnit.MILLISECONDS).pollInterval(10,TimeUnit.MILLISECONDS).untilAsserted(() -> exceptionHandler.assertCalledWith(method,UnsupportedOperationException.class));
  ctx.close();
}
