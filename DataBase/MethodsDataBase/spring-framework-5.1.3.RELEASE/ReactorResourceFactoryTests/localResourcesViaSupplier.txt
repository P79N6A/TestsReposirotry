@Test public void localResourcesViaSupplier() throws Exception {
  this.resourceFactory.setUseGlobalResources(false);
  this.resourceFactory.setConnectionProviderSupplier(() -> this.connectionProvider);
  this.resourceFactory.setLoopResourcesSupplier(() -> this.loopResources);
  this.resourceFactory.afterPropertiesSet();
  ConnectionProvider connectionProvider=this.resourceFactory.getConnectionProvider();
  LoopResources loopResources=this.resourceFactory.getLoopResources();
  assertSame(this.connectionProvider,connectionProvider);
  assertSame(this.loopResources,loopResources);
  verifyNoMoreInteractions(this.connectionProvider,this.loopResources);
  this.resourceFactory.destroy();
  verify(this.connectionProvider).dispose();
  verify(this.loopResources).dispose();
  verifyNoMoreInteractions(this.connectionProvider,this.loopResources);
}
