@Test public void testBiasAdd(){
  Nd4j.getRandom().setSeed(12345);
  for (  boolean rank1Bias : new boolean[]{false,true}) {
    SameDiff sameDiff=SameDiff.create();
    INDArray input=Nd4j.linspace(1,8,8).reshape(new long[]{2,4});
    INDArray b=Nd4j.linspace(1,4,4).reshape(rank1Bias ? new long[]{4} : new long[]{1,4}).divi(4);
    SDVariable sdInput=sameDiff.var("input",input);
    SDVariable sdBias=sameDiff.var("bias",b);
    SDVariable res=sameDiff.biasAdd(sdInput,sdBias);
    SDVariable loss=sameDiff.standardDeviation(res,true);
    INDArray exp=input.addRowVector(b);
    TestCase tc=new TestCase(sameDiff).gradientCheck(true).expectedOutput(res.getVarName(),exp);
    String err=OpValidation.validate(tc);
    assertNull(err);
  }
}
