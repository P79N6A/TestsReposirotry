@Test public void testPerf1() throws Exception {
  Nd4j.getWorkspaceManager().setDefaultWorkspaceConfiguration(WorkspaceConfiguration.builder().initialSize(50000L).build());
  MemoryWorkspace ws=Nd4j.getWorkspaceManager().getWorkspaceForCurrentThread("WS_1");
  INDArray tmp=Nd4j.create(64 * 64 + 1);
  List<Long> results=new ArrayList<>();
  List<Long> resultsOp=new ArrayList<>();
  for (int i=0; i < 1000000; i++) {
    long time1=System.nanoTime();
    long time3=0;
    long time4=0;
    try (MemoryWorkspace workspace=Nd4j.getWorkspaceManager().getAndActivateWorkspace("WS_1")){
      INDArray array=Nd4j.createUninitialized(64 * 64 + 1);
      INDArray arrayx=Nd4j.createUninitialized(64 * 64 + 1);
      time3=System.nanoTime();
      arrayx.addi(1.01);
      time4=System.nanoTime();
    }
     long time2=System.nanoTime();
    results.add(time2 - time1);
    resultsOp.add(time4 - time3);
  }
  Collections.sort(results);
  Collections.sort(resultsOp);
  int pos=(int)(results.size() * 0.9);
  log.info("Block: {} ns; Op: {} ns;",results.get(pos),resultsOp.get(pos));
}
