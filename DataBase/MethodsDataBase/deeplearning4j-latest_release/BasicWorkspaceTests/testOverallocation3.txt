@Test public void testOverallocation3() throws Exception {
  WorkspaceConfiguration overallocationConfig=WorkspaceConfiguration.builder().initialSize(0).maxSize(10 * 1024 * 1024).overallocationLimit(1.0).policyAllocation(AllocationPolicy.OVERALLOCATE).policyLearning(LearningPolicy.OVER_TIME).policyMirroring(MirroringPolicy.FULL).policySpill(SpillPolicy.EXTERNAL).build();
  Nd4jWorkspace workspace=(Nd4jWorkspace)Nd4j.getWorkspaceManager().createNewWorkspace(overallocationConfig);
  Nd4j.getMemoryManager().setCurrentWorkspace(workspace);
  assertEquals(0,workspace.getCurrentSize());
  for (int x=10; x <= 100; x+=10) {
    try (MemoryWorkspace cW=workspace.notifyScopeEntered()){
      INDArray array=Nd4j.create(x);
    }
   }
  assertEquals(0,workspace.getCurrentSize());
  workspace.initializeWorkspace();
  assertEquals(200 * Nd4j.sizeOfDataType(),workspace.getCurrentSize());
}
