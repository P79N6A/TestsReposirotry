@Test public void testDispatchFlatMap(){
  AggregatorImpls.AggregableFirst<Integer> af=new AggregatorImpls.AggregableFirst<>();
  AggregatorImpls.AggregableSum<Integer> as=new AggregatorImpls.AggregableSum<>();
  AggregableMultiOp<Integer> multi=new AggregableMultiOp<>(Arrays.asList(af,as));
  AggregatorImpls.AggregableLast<Integer> al=new AggregatorImpls.AggregableLast<>();
  AggregatorImpls.AggregableMax<Integer> amax=new AggregatorImpls.AggregableMax<>();
  AggregableMultiOp<Integer> otherMulti=new AggregableMultiOp<>(Arrays.asList(al,amax));
  DispatchOp<Integer,Writable> parallel=new DispatchOp<>(Arrays.<IAggregableReduceOp<Integer,List<Writable>>>asList(multi,otherMulti));
  assertTrue(multi.getOperations().size() == 2);
  assertTrue(otherMulti.getOperations().size() == 2);
  assertTrue(parallel.getOperations().size() == 2);
  for (int i=0; i < intList.size(); i++) {
    parallel.accept(Arrays.asList(intList.get(i),intList.get(i)));
  }
  List<Writable> res=parallel.get();
  assertTrue(res.get(1).toDouble() == 45D);
  assertTrue(res.get(0).toInt() == 1);
  assertTrue(res.get(3).toDouble() == 9);
  assertTrue(res.get(2).toInt() == 9);
}
