@Test public void testWrite() throws Exception {
  File tempFile=File.createTempFile("datavec","writer");
  tempFile.deleteOnExit();
  FileSplit fileSplit=new FileSplit(tempFile);
  CSVRecordWriter writer=new CSVRecordWriter();
  writer.initialize(fileSplit,new NumberOfRecordsPartitioner());
  List<Writable> collection=new ArrayList<>();
  collection.add(new Text("12"));
  collection.add(new Text("13"));
  collection.add(new Text("14"));
  writer.write(collection);
  CSVRecordReader reader=new CSVRecordReader(0);
  reader.initialize(new FileSplit(tempFile));
  int cnt=0;
  while (reader.hasNext()) {
    List<Writable> line=new ArrayList<>(reader.next());
    assertEquals(3,line.size());
    assertEquals(12,line.get(0).toInt());
    assertEquals(13,line.get(1).toInt());
    assertEquals(14,line.get(2).toInt());
    cnt++;
  }
  assertEquals(1,cnt);
}
