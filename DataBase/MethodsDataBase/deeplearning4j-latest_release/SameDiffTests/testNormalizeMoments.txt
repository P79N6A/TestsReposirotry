@Test public void testNormalizeMoments(){
  SameDiff sd=SameDiff.create();
  INDArray counts=Nd4j.create(new float[]{2},new long[]{1,1});
  INDArray means=Nd4j.create(new float[]{2,4},new long[]{1,2});
  INDArray vars=Nd4j.create(new float[]{6,8},new long[]{1,2});
  SDVariable sdCounts=sd.var("counts",counts);
  SDVariable sdMeans=sd.var("means",means);
  SDVariable sdVars=sd.var("vars",vars);
  double shift=0.0;
  SDVariable[] moments=sd.normalizeMoments(sdCounts,sdMeans,sdVars,shift);
  SDVariable normMean=moments[0];
  SDVariable normVariance=moments[1];
  SDVariable sum=normMean.add(normVariance);
  SDVariable out=sd.tanh("out",sum);
  INDArray outArr=sd.execAndEndResult();
  INDArray meanArray=normMean.getArr();
  INDArray varArray=normVariance.getArr();
  assertEquals(meanArray.getDouble(0,0),1,1e-5);
  assertEquals(meanArray.getDouble(0,1),2,1e-5);
  assertArrayEquals(meanArray.shape(),varArray.shape());
}
