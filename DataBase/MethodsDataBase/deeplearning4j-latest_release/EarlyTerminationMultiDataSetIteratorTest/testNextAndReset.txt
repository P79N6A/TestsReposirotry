@Test public void testNextAndReset() throws Exception {
  int terminateAfter=2;
  MultiDataSetIterator iter=new MultiDataSetIteratorAdapter(new MnistDataSetIterator(minibatchSize,numExamples));
  int count=0;
  List<MultiDataSet> seenMDS=new ArrayList<>();
  while (count < terminateAfter) {
    seenMDS.add(iter.next());
    count++;
  }
  iter.reset();
  EarlyTerminationMultiDataSetIterator earlyEndIter=new EarlyTerminationMultiDataSetIterator(iter,terminateAfter);
  assertTrue(earlyEndIter.hasNext());
  count=0;
  while (earlyEndIter.hasNext()) {
    MultiDataSet path=earlyEndIter.next();
    assertEquals(path.getFeatures()[0],seenMDS.get(count).getFeatures()[0]);
    assertEquals(path.getLabels()[0],seenMDS.get(count).getLabels()[0]);
    count++;
  }
  assertEquals(count,terminateAfter);
  earlyEndIter.reset();
  count=0;
  while (earlyEndIter.hasNext()) {
    MultiDataSet path=earlyEndIter.next();
    assertEquals(path.getFeatures()[0],seenMDS.get(count).getFeatures()[0]);
    assertEquals(path.getLabels()[0],seenMDS.get(count).getLabels()[0]);
    count++;
  }
}
