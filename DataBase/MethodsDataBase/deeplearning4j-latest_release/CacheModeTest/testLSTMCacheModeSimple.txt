@Test public void testLSTMCacheModeSimple(){
  for (  boolean graves : new boolean[]{true,false}) {
    MultiLayerConfiguration conf1=getConfLSTM(CacheMode.NONE,graves);
    MultiLayerConfiguration conf2=getConfLSTM(CacheMode.DEVICE,graves);
    MultiLayerNetwork net1=new MultiLayerNetwork(conf1);
    net1.init();
    MultiLayerNetwork net2=new MultiLayerNetwork(conf2);
    net2.init();
    INDArray in=Nd4j.rand(new int[]{3,3,10});
    INDArray labels=TestUtils.randomOneHotTimeSeries(3,10,10);
    INDArray out1=net1.output(in);
    INDArray out2=net2.output(in);
    assertEquals(out1,out2);
    assertEquals(net1.params(),net2.params());
    net1.fit(in,labels);
    net2.fit(in,labels);
    assertEquals(net1.params(),net2.params());
  }
}
