@Test public void testSingleMaxLineSearch() throws Exception {
  double score1, score2;
  OutputLayer layer=getIrisLogisticLayerConfig(Activation.SOFTMAX,100,LossFunctions.LossFunction.NEGATIVELOGLIKELIHOOD);
  int nParams=(int)layer.numParams();
  layer.setBackpropGradientsViewArray(Nd4j.create(1,nParams));
  layer.setInput(irisData.getFeatures(),LayerWorkspaceMgr.noWorkspaces());
  layer.setLabels(irisData.getLabels());
  layer.computeGradientAndScore(LayerWorkspaceMgr.noWorkspaces());
  score1=layer.score();
  BackTrackLineSearch lineSearch=new BackTrackLineSearch(layer,new NegativeDefaultStepFunction(),layer.getOptimizer());
  double step=lineSearch.optimize(layer.params(),layer.gradient().gradient(),layer.gradient().gradient(),LayerWorkspaceMgr.noWorkspacesImmutable());
  assertEquals(1.0,step,1e-3);
}
