@Test public void testVaeWeightNoise(){
  for (  boolean ws : new boolean[]{false,true}) {
    MultiLayerConfiguration conf=new NeuralNetConfiguration.Builder().seed(12345L).trainingWorkspaceMode(ws ? WorkspaceMode.ENABLED : WorkspaceMode.NONE).inferenceWorkspaceMode(ws ? WorkspaceMode.ENABLED : WorkspaceMode.NONE).weightNoise(new WeightNoise(new org.deeplearning4j.nn.conf.distribution.NormalDistribution(0.1,0.3))).list().layer(0,new VariationalAutoencoder.Builder().nIn(10).nOut(3).encoderLayerSizes(5).decoderLayerSizes(6).pzxActivationFunction(Activation.TANH).reconstructionDistribution(new GaussianReconstructionDistribution()).activation(new ActivationTanH()).build()).pretrain(true).backprop(false).build();
    MultiLayerNetwork net=new MultiLayerNetwork(conf);
    net.init();
    INDArray arr=Nd4j.rand(3,10);
    net.pretrainLayer(0,arr);
  }
}
