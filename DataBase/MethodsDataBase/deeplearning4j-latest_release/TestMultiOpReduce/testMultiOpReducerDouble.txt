@Test public void testMultiOpReducerDouble(){
  List<List<Writable>> inputs=new ArrayList<>();
  inputs.add(Arrays.asList((Writable)new Text("someKey"),new DoubleWritable(0)));
  inputs.add(Arrays.asList((Writable)new Text("someKey"),new DoubleWritable(1)));
  inputs.add(Arrays.asList((Writable)new Text("someKey"),new DoubleWritable(2)));
  inputs.add(Arrays.asList((Writable)new Text("someKey"),new DoubleWritable(2)));
  Map<ReduceOp,Double> exp=new LinkedHashMap<>();
  exp.put(ReduceOp.Min,0.0);
  exp.put(ReduceOp.Max,2.0);
  exp.put(ReduceOp.Range,2.0);
  exp.put(ReduceOp.Sum,5.0);
  exp.put(ReduceOp.Mean,1.25);
  exp.put(ReduceOp.Stdev,0.957427108);
  exp.put(ReduceOp.Count,4.0);
  exp.put(ReduceOp.CountUnique,3.0);
  exp.put(ReduceOp.TakeFirst,0.0);
  exp.put(ReduceOp.TakeLast,2.0);
  for (  ReduceOp op : exp.keySet()) {
    Schema schema=new Schema.Builder().addColumnString("key").addColumnDouble("column").build();
    Reducer reducer=new Reducer.Builder(op).keyColumns("key").build();
    reducer.setInputSchema(schema);
    IAggregableReduceOp<List<Writable>,List<Writable>> accumulator=reducer.aggregableReducer();
    for (int i=0; i < inputs.size(); i++) {
      accumulator.accept(inputs.get(i));
    }
    List<Writable> out=accumulator.get();
    assertEquals(2,out.size());
    assertEquals(out.get(0),new Text("someKey"));
    String msg=op.toString();
    assertEquals(msg,exp.get(op),out.get(1).toDouble(),1e-5);
  }
}
