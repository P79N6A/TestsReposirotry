@Test public void testReplicate4() throws Exception {
  INDArray array=Nd4j.create(3,3);
  array.getRow(1).putScalar(0,1f);
  array.getRow(1).putScalar(1,1f);
  array.getRow(1).putScalar(2,1f);
  final DeviceLocalNDArray locals=new DeviceLocalNDArray(array);
  int numDevices=Nd4j.getAffinityManager().getNumberOfDevices();
  for (int t=0; t < numDevices; t++) {
    assertEquals(3,locals.get(t).sumNumber().floatValue(),0.001f);
  }
}
