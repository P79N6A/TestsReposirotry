@Test public void testOcnn(){
  Map<String,Object> commands=new HashMap<>();
  commands.put(DataSetIteratorFactoryProvider.FACTORY_KEY,TestDataFactoryProviderMnist.class.getCanonicalName());
  MultiLayerSpace mls=new MultiLayerSpace.Builder().optimizationAlgo(OptimizationAlgorithm.STOCHASTIC_GRADIENT_DESCENT).updater(new SgdSpace(new ContinuousParameterSpace(0.0001,0.1))).l2(new ContinuousParameterSpace(0.0001,0.01)).addLayer(new DenseLayerSpace.Builder().nOut(new IntegerParameterSpace(250,500)).activation(new DiscreteParameterSpace<>(Activation.RELU,Activation.TANH)).build(),new IntegerParameterSpace(1,2)).addLayer(new OCNNLayerSpace.Builder().nu(new ContinuousParameterSpace(0.0001,0.1)).numHidden(new DiscreteParameterSpace<Integer>(784 / 2,784 / 4)).activation(Activation.HARDSIGMOID).lossFunction(LossFunctions.LossFunction.MCXENT).build()).setInputType(InputType.convolutionalFlat(28,28,1)).pretrain(false).backprop(true).build();
  CandidateGenerator candidateGenerator=new RandomSearchGenerator(mls,commands);
  DataProvider dataProvider=new DataSetIteratorFactoryProvider();
  String modelSavePath=new File(System.getProperty("java.io.tmpdir"),"ArbiterDL4JTest3\\").getAbsolutePath();
  File f=new File(modelSavePath);
  if (f.exists())   f.delete();
  f.mkdir();
  f.deleteOnExit();
  if (!f.exists())   throw new RuntimeException();
  OptimizationConfiguration configuration=new OptimizationConfiguration.Builder().candidateGenerator(candidateGenerator).dataProvider(dataProvider).modelSaver(new FileModelSaver(modelSavePath)).scoreFunction(new TestSetLossScoreFunction()).terminationConditions(new MaxTimeCondition(2,TimeUnit.MINUTES),new MaxCandidatesCondition(100)).build();
  IOptimizationRunner runner=new LocalOptimizationRunner(configuration,new MultiLayerNetworkTaskCreator(new ClassificationEvaluator()));
  Candidate candidate=candidateGenerator.getCandidate();
  System.out.println("----- COMPLETE -----");
}
