/** 
 * This test should be run manually
 * @throws Exception
 */
@Test public void testDelayedAllocation2() throws Exception {
  AtomicAllocator allocator=AtomicAllocator.getInstance();
  INDArray array=Nd4j.create(10,10);
  AllocationPoint pointer=allocator.getAllocationPoint(array);
  PointersPair pair=pointer.getPointers();
  assertEquals(pair.getDevicePointer(),pair.getHostPointer());
  AllocationPoint shapePointer=allocator.getAllocationPoint(array.shapeInfoDataBuffer());
  assertEquals(shapePointer.getPointers().getDevicePointer(),shapePointer.getPointers().getHostPointer());
  assertEquals(pointer.getAllocationStatus(),AllocationStatus.HOST);
  assertEquals(shapePointer.getAllocationStatus(),AllocationStatus.HOST);
  float sum=array.sumNumber().floatValue();
  assertEquals(0.0f,sum,0.0001f);
  shapePointer=allocator.getAllocationPoint(array.shapeInfoDataBuffer());
  pointer=allocator.getAllocationPoint(array);
  assertEquals(AllocationStatus.CONSTANT,shapePointer.getAllocationStatus());
  assertEquals(AllocationStatus.DEVICE,pointer.getAllocationStatus());
  assertNotEquals(shapePointer.getPointers().getDevicePointer(),shapePointer.getPointers().getHostPointer());
}
