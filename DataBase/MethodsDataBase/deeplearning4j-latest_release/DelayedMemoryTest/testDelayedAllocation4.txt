@Test public void testDelayedAllocation4() throws Exception {
  INDArray array=Nd4j.create(new float[]{1f,2f,3f,4f,5f});
  AllocationPoint pointer=AtomicAllocator.getInstance().getAllocationPoint(array);
  PointersPair pair=pointer.getPointers();
  assertEquals(pair.getDevicePointer(),pair.getHostPointer());
  assertEquals(2.0f,array.getFloat(1),0.001f);
  assertEquals(pair.getDevicePointer(),pair.getHostPointer());
  String temp=System.getProperty("java.io.tmpdir");
  String outPath=FilenameUtils.concat(temp,"dl4jtestserialization.bin");
  try (DataOutputStream dos=new DataOutputStream(Files.newOutputStream(Paths.get(outPath)))){
    Nd4j.write(array,dos);
  }
   INDArray in;
  try (DataInputStream dis=new DataInputStream(new FileInputStream(outPath))){
    in=Nd4j.read(dis);
  }
   assertEquals(AtomicAllocator.getInstance().getAllocationPoint(in).getPointers().getDevicePointer(),AtomicAllocator.getInstance().getAllocationPoint(in).getPointers().getHostPointer());
  assertEquals(array,in);
}
