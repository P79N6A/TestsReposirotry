@Test public void testInferShape() throws IOException {
  SameDiff graph=TFGraphMapper.getInstance().importGraph(new ClassPathResource("tf_graphs/examples/bias_add/frozen_model.pb").getInputStream());
  assertNotNull(graph);
  INDArray input=Nd4j.linspace(1,40,40).reshape(10,4);
  INDArray expectedOutput=Nd4j.linspace(1,40,40).reshape(10,4).addRowVector(Nd4j.linspace(1,4,4));
  INDArray actual=graph.execWithPlaceHolderAndEndResult(Collections.singletonMap("input",input));
  assertEquals(input,graph.getVariable("input").getArr());
  assertArrayEquals(input.shape(),graph.getShapeForVarName(graph.getVariable("input").getVarName()));
  assertEquals(expectedOutput,actual);
}
