@Test public void testRecordReaderDataSetIteratorNDArrayWritableLabels(){
  Collection<Collection<Writable>> data=new ArrayList<>();
  data.add(Arrays.<Writable>asList(new DoubleWritable(0),new DoubleWritable(1),new NDArrayWritable(Nd4j.create(new double[]{1.1,2.1,3.1}))));
  data.add(Arrays.<Writable>asList(new DoubleWritable(2),new DoubleWritable(3),new NDArrayWritable(Nd4j.create(new double[]{4.1,5.1,6.1}))));
  data.add(Arrays.<Writable>asList(new DoubleWritable(4),new DoubleWritable(5),new NDArrayWritable(Nd4j.create(new double[]{7.1,8.1,9.1}))));
  RecordReader rr=new CollectionRecordReader(data);
  int batchSize=3;
  int labelIndexFrom=2;
  int labelIndexTo=2;
  boolean regression=true;
  DataSetIterator rrdsi=new RecordReaderDataSetIterator(rr,batchSize,labelIndexFrom,labelIndexTo,regression);
  DataSet ds=rrdsi.next();
  INDArray expFeatures=Nd4j.create(new double[][]{{0,1},{2,3},{4,5}});
  INDArray expLabels=Nd4j.create(new double[][]{{1.1,2.1,3.1},{4.1,5.1,6.1},{7.1,8.1,9.1}});
  assertEquals(expFeatures,ds.getFeatures());
  assertEquals(expLabels,ds.getLabels());
  data=new ArrayList<>();
  data.add(Arrays.<Writable>asList(new NDArrayWritable(Nd4j.create(new double[]{0,1})),new NDArrayWritable(Nd4j.create(new double[]{1.1,2.1,3.1}))));
  data.add(Arrays.<Writable>asList(new NDArrayWritable(Nd4j.create(new double[]{2,3})),new NDArrayWritable(Nd4j.create(new double[]{4.1,5.1,6.1}))));
  data.add(Arrays.<Writable>asList(new NDArrayWritable(Nd4j.create(new double[]{4,5})),new NDArrayWritable(Nd4j.create(new double[]{7.1,8.1,9.1}))));
  labelIndexFrom=1;
  labelIndexTo=1;
  rr=new CollectionRecordReader(data);
  rrdsi=new RecordReaderDataSetIterator(rr,batchSize,labelIndexFrom,labelIndexTo,regression);
  DataSet ds2=rrdsi.next();
  assertEquals(expFeatures,ds2.getFeatures());
  assertEquals(expLabels,ds2.getLabels());
}
