@Test public void testCsvSkipAllButOneLine() throws IOException, InterruptedException {
  final int numLines=4;
  final List<Writable> lineList=Arrays.<Writable>asList(new Text(Integer.toString(numLines - 1)),new Text("one"),new Text("two"),new Text("three"));
  String header=",one,two,three";
  List<String> lines=new ArrayList<>();
  for (int i=0; i < numLines; i++)   lines.add(Integer.toString(i) + header);
  File tempFile=File.createTempFile("csvSkipLines",".csv");
  FileUtils.writeLines(tempFile,lines);
  CSVRecordReader rr=new CSVRecordReader(numLines - 1,',');
  rr.initialize(new FileSplit(tempFile));
  rr.reset();
  assertTrue(rr.hasNext());
  assertEquals(rr.next(),lineList);
}
