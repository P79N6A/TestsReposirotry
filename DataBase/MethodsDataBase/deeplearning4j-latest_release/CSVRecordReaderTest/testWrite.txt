@Test public void testWrite() throws Exception {
  List<List<Writable>> list=new ArrayList<>();
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < 10; i++) {
    List<Writable> temp=new ArrayList<>();
    for (int j=0; j < 3; j++) {
      int v=100 * i + j;
      temp.add(new IntWritable(v));
      sb.append(v);
      if (j < 2)       sb.append(",");
 else       if (i != 9)       sb.append("\n");
    }
    list.add(temp);
  }
  String expected=sb.toString();
  Path p=Files.createTempFile("csvwritetest","csv");
  p.toFile().deleteOnExit();
  FileRecordWriter writer=new CSVRecordWriter();
  FileSplit fileSplit=new FileSplit(p.toFile());
  writer.initialize(fileSplit,new NumberOfRecordsPartitioner());
  for (  List<Writable> c : list) {
    writer.write(c);
  }
  writer.close();
  String fileContents=FileUtils.readFileToString(p.toFile(),FileRecordWriter.DEFAULT_CHARSET.name());
  assertEquals(expected,fileContents);
}
