@Test public void testRecordReaderAndWriteFile() throws Exception {
  val recordsToWrite=recordToWrite();
  ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  ArrowConverter.writeRecordBatchTo(recordsToWrite.getRight(),recordsToWrite.getFirst(),byteArrayOutputStream);
  byte[] arr=byteArrayOutputStream.toByteArray();
  val read=ArrowConverter.readFromBytes(arr);
  assertEquals(recordsToWrite,read);
  File tmp=tmpDataFile(recordsToWrite);
  RecordReader recordReader=new ArrowRecordReader();
  recordReader.initialize(new FileSplit(tmp));
  List<Writable> record=recordReader.next();
  assertEquals(2,record.size());
}
