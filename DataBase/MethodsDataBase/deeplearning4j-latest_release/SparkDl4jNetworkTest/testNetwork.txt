@Test public void testNetwork(){
  DatasetFacade df=DatasetFacade.dataRows(sqlContext.read().json("src/test/resources/dl4jnetwork"));
  Pipeline p=new Pipeline().setStages(new PipelineStage[]{getAssembler(new String[]{"x","y"},"features")});
  DatasetFacade part2=DatasetFacade.dataRows(p.fit(df.get()).transform(df.get()).select("features","label"));
  ParamSerializer ps=new ParamHelper();
  MultiLayerConfiguration mc=getNNConfiguration();
  Collection<TrainingListener> il=new ArrayList<>();
  il.add(new ScoreIterationListener(1));
  SparkDl4jNetwork sparkDl4jNetwork=new SparkDl4jNetwork(mc,2,ps,1,il,true).setFeaturesCol("features").setLabelCol("label");
  SparkDl4jModel sm=sparkDl4jNetwork.fit(part2.get());
  MultiLayerNetwork mln=sm.getMultiLayerNetwork();
  Assert.assertNotNull(mln);
  DatasetFacade transformed=DatasetFacade.dataRows(sm.transform(part2.get()));
  List<?> rows=transformed.get().collectAsList();
  Assert.assertNotNull(sm.getTrainingStats());
  Assert.assertNotNull(rows);
}
