@Test public void testCopyFromCsvToArrow() throws Exception {
  val recordsPair=records();
  Path p=Files.createTempFile("csvwritetest",".csv");
  FileUtils.write(p.toFile(),recordsPair.getFirst());
  p.toFile().deleteOnExit();
  CSVRecordReader recordReader=new CSVRecordReader();
  FileSplit fileSplit=new FileSplit(p.toFile());
  ArrowRecordWriter arrowRecordWriter=new ArrowRecordWriter(recordsPair.getMiddle());
  File outputFile=Files.createTempFile("outputarrow","arrow").toFile();
  FileSplit outputFileSplit=new FileSplit(outputFile);
  RecordMapper mapper=RecordMapper.builder().batchSize(10).inputUrl(fileSplit).outputUrl(outputFileSplit).partitioner(new NumberOfRecordsPartitioner()).recordReader(recordReader).recordWriter(arrowRecordWriter).build();
  mapper.copy();
  ArrowRecordReader arrowRecordReader=new ArrowRecordReader();
  arrowRecordReader.initialize(outputFileSplit);
  List<List<Writable>> next=arrowRecordReader.next(10);
  System.out.println(next);
  assertEquals(10,next.size());
}
