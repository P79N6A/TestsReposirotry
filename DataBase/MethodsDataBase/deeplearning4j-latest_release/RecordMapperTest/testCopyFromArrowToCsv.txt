@Test public void testCopyFromArrowToCsv() throws Exception {
  val recordsPair=records();
  Path p=Files.createTempFile("arrowwritetest",".arrow");
  FileUtils.write(p.toFile(),recordsPair.getFirst());
  p.toFile().deleteOnExit();
  ArrowRecordWriter arrowRecordWriter=new ArrowRecordWriter(recordsPair.getMiddle());
  FileSplit split=new FileSplit(p.toFile());
  arrowRecordWriter.initialize(split,new NumberOfRecordsPartitioner());
  arrowRecordWriter.writeBatch(recordsPair.getRight());
  ArrowRecordReader arrowRecordReader=new ArrowRecordReader();
  arrowRecordReader.initialize(split);
  CSVRecordWriter csvRecordWriter=new CSVRecordWriter();
  Path p2=Files.createTempFile("arrowwritetest",".csv");
  FileUtils.write(p2.toFile(),recordsPair.getFirst());
  p.toFile().deleteOnExit();
  FileSplit outputCsv=new FileSplit(p2.toFile());
  RecordMapper mapper=RecordMapper.builder().batchSize(10).inputUrl(split).outputUrl(outputCsv).partitioner(new NumberOfRecordsPartitioner()).recordReader(arrowRecordReader).recordWriter(csvRecordWriter).build();
  mapper.copy();
  CSVRecordReader recordReader=new CSVRecordReader();
  recordReader.initialize(outputCsv);
  List<List<Writable>> loadedCSvRecords=recordReader.next(10);
  assertEquals(10,loadedCSvRecords.size());
}
