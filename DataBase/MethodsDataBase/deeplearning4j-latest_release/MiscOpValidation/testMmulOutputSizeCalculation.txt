@Test public void testMmulOutputSizeCalculation(){
  INDArray a=Nd4j.create(3,2);
  INDArray b=Nd4j.create(2,4);
  INDArray z=Nd4j.create(4,3);
  Mmul m=new Mmul(a,b,z,MMulTranspose.builder().transposeA(false).transposeB(false).transposeResult(true).build());
  List<long[]> outShapes=Nd4j.getExecutioner().calculateOutputShape(m);
  assertArrayEquals(new long[]{4,3},outShapes.get(0));
  Nd4j.getExecutioner().exec(m);
  a=Nd4j.create(3,4);
  b=Nd4j.create(2,4);
  z=Nd4j.create(2,3);
  m=new Mmul(a,b,z,MMulTranspose.builder().transposeA(false).transposeB(true).transposeResult(true).build());
  outShapes=Nd4j.getExecutioner().calculateOutputShape(m);
  assertArrayEquals(new long[]{2,3},outShapes.get(0));
  Nd4j.getExecutioner().exec(m);
}
