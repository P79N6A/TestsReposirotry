@Test public void testOneHot1(){
  List<String> failed=new ArrayList<>();
  for (int i=-1; i <= 0; i++) {
    INDArray indicesArr=Nd4j.trueVector(new double[]{0,1,2});
    int depth=3;
    SameDiff sd=SameDiff.create();
    SDVariable indices=sd.var(indicesArr);
    SDVariable oneHot=sd.oneHot(indices,depth,i,1.0,0.0);
    INDArray exp=Nd4j.eye(3);
    String msg="Axis: " + i;
    log.info("Test case: " + msg);
    String err=OpValidation.validate(new TestCase(sd).testName(msg).gradientCheck(false).expected(oneHot,exp));
    if (err != null) {
      failed.add(err);
    }
  }
  assertEquals(failed.toString(),0,failed.size());
}
