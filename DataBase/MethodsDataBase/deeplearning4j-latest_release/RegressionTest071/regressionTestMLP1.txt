@Test public void regressionTestMLP1() throws Exception {
  File f=new ClassPathResource("regression_testing/071/071_ModelSerializer_Regression_MLP_1.zip").getTempFileFromArchive();
  MultiLayerNetwork net=ModelSerializer.restoreMultiLayerNetwork(f,true);
  MultiLayerConfiguration conf=net.getLayerWiseConfigurations();
  assertEquals(2,conf.getConfs().size());
  assertTrue(conf.isBackprop());
  assertFalse(conf.isPretrain());
  DenseLayer l0=(DenseLayer)conf.getConf(0).getLayer();
  assertEquals("relu",l0.getActivationFn().toString());
  assertEquals(3,l0.getNIn());
  assertEquals(4,l0.getNOut());
  assertEquals(WeightInit.XAVIER,l0.getWeightInit());
  assertEquals(new Nesterovs(0.15,0.9),l0.getIUpdater());
  assertEquals(0.15,((Nesterovs)l0.getIUpdater()).getLearningRate(),1e-6);
  OutputLayer l1=(OutputLayer)conf.getConf(1).getLayer();
  assertEquals("softmax",l1.getActivationFn().toString());
  assertTrue(l1.getLossFn() instanceof LossMCXENT);
  assertEquals(4,l1.getNIn());
  assertEquals(5,l1.getNOut());
  assertEquals(WeightInit.XAVIER,l1.getWeightInit());
  assertEquals(0.9,((Nesterovs)l1.getIUpdater()).getMomentum(),1e-6);
  assertEquals(0.9,((Nesterovs)l1.getIUpdater()).getMomentum(),1e-6);
  assertEquals(0.15,((Nesterovs)l1.getIUpdater()).getLearningRate(),1e-6);
  long numParams=(int)net.numParams();
  assertEquals(Nd4j.linspace(1,numParams,numParams),net.params());
  int updaterSize=(int)new Nesterovs().stateSize(numParams);
  assertEquals(Nd4j.linspace(1,updaterSize,updaterSize),net.getUpdater().getStateViewArray());
}
