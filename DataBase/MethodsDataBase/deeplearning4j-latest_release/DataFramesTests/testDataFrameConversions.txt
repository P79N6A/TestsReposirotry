@Test public void testDataFrameConversions(){
  List<List<Writable>> data=new ArrayList<>();
  Schema.Builder builder=new Schema.Builder();
  int numColumns=6;
  for (int i=0; i < numColumns; i++)   builder.addColumnDouble(String.valueOf(i));
  for (int i=0; i < 5; i++) {
    List<Writable> record=new ArrayList<>(numColumns);
    data.add(record);
    for (int j=0; j < numColumns; j++) {
      record.add(new DoubleWritable(1.0));
    }
  }
  Schema schema=builder.build();
  JavaRDD<List<Writable>> rdd=sc.parallelize(data);
  assertEquals(schema,DataFrames.fromStructType(DataFrames.fromSchema(schema)));
  assertEquals(rdd.collect(),DataFrames.toRecords(DataFrames.toDataFrame(schema,rdd)).getSecond().collect());
  DataRowsFacade dataFrame=DataFrames.toDataFrame(schema,rdd);
  dataFrame.get().show();
  Column mean=DataFrames.mean(dataFrame,"0");
  Column std=DataFrames.std(dataFrame,"0");
  dataFrame.get().withColumn("0",dataFrame.get().col("0").minus(mean)).show();
  dataFrame.get().withColumn("0",dataFrame.get().col("0").divide(std)).show();
}
