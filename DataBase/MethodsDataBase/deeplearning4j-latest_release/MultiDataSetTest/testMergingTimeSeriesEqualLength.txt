@Test public void testMergingTimeSeriesEqualLength(){
  int tsLength=8;
  int nRows=5;
  int nColsIn0=3;
  int nColsIn1=4;
  int nColsOut0=5;
  int nColsOut1=6;
  int n0=nRows * nColsIn0 * tsLength;
  int n1=nRows * nColsIn1 * tsLength;
  int nOut0=nRows * nColsOut0 * tsLength;
  int nOut1=nRows * nColsOut1 * tsLength;
  INDArray expIn0=Nd4j.linspace(0,n0 - 1,n0).reshape(nRows,nColsIn0,tsLength);
  INDArray expIn1=Nd4j.linspace(0,n1 - 1,n1).reshape(nRows,nColsIn1,tsLength);
  INDArray expOut0=Nd4j.linspace(0,nOut0 - 1,nOut0).reshape(nRows,nColsOut0,tsLength);
  INDArray expOut1=Nd4j.linspace(0,nOut1 - 1,nOut1).reshape(nRows,nColsOut1,tsLength);
  List<MultiDataSet> list=new ArrayList<>(nRows);
  for (int i=0; i < nRows; i++) {
    if (i == 0) {
      INDArray in0=expIn0.get(NDArrayIndex.interval(0,1,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      INDArray in1=expIn1.get(NDArrayIndex.interval(0,1,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      INDArray out0=expOut0.get(NDArrayIndex.interval(0,1,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      INDArray out1=expOut1.get(NDArrayIndex.interval(0,1,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      list.add(new MultiDataSet(new INDArray[]{in0,in1},new INDArray[]{out0,out1}));
      i++;
    }
 else {
      INDArray in0=expIn0.get(NDArrayIndex.interval(i,i,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      INDArray in1=expIn1.get(NDArrayIndex.interval(i,i,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      INDArray out0=expOut0.get(NDArrayIndex.interval(i,i,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      INDArray out1=expOut1.get(NDArrayIndex.interval(i,i,true),NDArrayIndex.all(),NDArrayIndex.all()).dup();
      list.add(new MultiDataSet(new INDArray[]{in0,in1},new INDArray[]{out0,out1}));
    }
  }
  MultiDataSet merged=MultiDataSet.merge(list);
  assertEquals(2,merged.getFeatures().length);
  assertEquals(2,merged.getLabels().length);
  assertEquals(expIn0,merged.getFeatures(0));
  assertEquals(expIn1,merged.getFeatures(1));
  assertEquals(expOut0,merged.getLabels(0));
  assertEquals(expOut1,merged.getLabels(1));
}
