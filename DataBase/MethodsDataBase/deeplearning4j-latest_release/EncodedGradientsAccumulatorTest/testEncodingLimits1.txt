/** 
 * Here we ensure that no matter how dense/sparse our updates are - we're never going above 1/16 of original elements of gradients array
 * @throws Exception
 */
@Test public void testEncodingLimits1() throws Exception {
  int numParams=100000;
  for (int e=10; e < numParams / 5; e++) {
    EncodingHandler handler=new EncodingHandler(new FixedThresholdAlgorithm(1e-3),null,null,false);
    INDArray encoded=handler.encodeUpdates(0,0,getGradients(numParams,e,2e-3));
    int encFormat=encoded.data().getInt(3);
    assertTrue("Failed for E = " + e + "; Format: "+ encFormat+ "; Length: "+ encoded.data().length(),encoded.data().length() < numParams / 16 + 6);
  }
}
