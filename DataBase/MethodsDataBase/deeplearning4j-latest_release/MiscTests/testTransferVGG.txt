@Test public void testTransferVGG() throws Exception {
  DataSet ds=new DataSet();
  ds.setFeatures(Nd4j.create(1,3,224,224));
  ds.setLabels(Nd4j.create(1,2));
  ComputationGraph model=(ComputationGraph)(VGG16.builder().build().initPretrained(PretrainedType.IMAGENET));
  ComputationGraph transferModel=new TransferLearning.GraphBuilder(model).setFeatureExtractor("fc2").removeVertexKeepConnections("predictions").addLayer("predictions",new OutputLayer.Builder(LossFunctions.LossFunction.NEGATIVELOGLIKELIHOOD).nIn(4096).nOut(2).weightInit(WeightInit.XAVIER).activation(Activation.SOFTMAX).build(),"fc2").build();
  transferModel.fit(ds);
  ComputationGraph g2=TestUtils.testModelSerialization(transferModel);
  g2.fit(ds);
}
