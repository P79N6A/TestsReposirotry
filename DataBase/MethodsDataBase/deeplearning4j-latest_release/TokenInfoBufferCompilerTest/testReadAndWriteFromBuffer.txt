@Test public void testReadAndWriteFromBuffer() throws Exception {
  List<Short> shorts=new ArrayList<>();
  for (int i=0; i < 10; i++) {
    shorts.add((short)i);
  }
  ByteBuffer buffer=ByteBuffer.allocate(shorts.size() * 2 + 2);
  buffer.putShort((short)shorts.size());
  for (  Short s : shorts) {
    buffer.putShort(s);
  }
  buffer.position(0);
  short count=buffer.getShort();
  List<Short> readShorts=new ArrayList<>();
  for (int i=0; i < count; i++) {
    readShorts.add(buffer.getShort());
  }
  for (int i=0; i < shorts.size(); i++) {
    assertEquals(readShorts.get(i),shorts.get(i));
  }
}
