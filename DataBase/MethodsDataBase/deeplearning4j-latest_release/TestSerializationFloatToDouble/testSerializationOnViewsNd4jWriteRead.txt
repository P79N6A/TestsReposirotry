@Test public void testSerializationOnViewsNd4jWriteRead() throws Exception {
  int length=100;
  Nd4j.create(1);
  DataTypeUtil.setDTypeForContext(DataBuffer.Type.FLOAT);
  INDArray arr=Nd4j.linspace(1,length,length).reshape('c',10,10);
  INDArray sub=arr.get(NDArrayIndex.interval(5,10),NDArrayIndex.interval(5,10));
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  try (DataOutputStream dos=new DataOutputStream(baos)){
    Nd4j.write(sub,dos);
  }
   byte[] bytes=baos.toByteArray();
  DataTypeUtil.setDTypeForContext(DataBuffer.Type.DOUBLE);
  System.out.println("The data opType is " + Nd4j.dataType());
  INDArray arr1=Nd4j.linspace(1,length,length).reshape('c',10,10);
  INDArray sub1=arr1.get(NDArrayIndex.interval(5,10),NDArrayIndex.interval(5,10));
  INDArray arr2;
  try (DataInputStream dis=new DataInputStream(new ByteArrayInputStream(bytes))){
    arr2=Nd4j.read(dis);
  }
   assertTrue(Transforms.abs(sub1.sub(arr2).div(sub1)).maxNumber().doubleValue() < 0.01);
}
