@Test public void testHardTanhDerivative(){
  INDArray z=Nd4j.zeros(100);
  double[] expOut=new double[100];
  for (int i=0; i < 100; i++) {
    double x=0.1 * (i - 50);
    z.putScalar(i,x);
    expOut[i]=(Math.abs(x) <= 1.0 ? 1 : 0);
  }
  INDArray zPrime=Nd4j.getExecutioner().execAndReturn(new HardTanhDerivative(z));
  for (int i=0; i < 100; i++) {
    assertEquals(expOut[i],zPrime.getDouble(i),1e-1);
  }
}
