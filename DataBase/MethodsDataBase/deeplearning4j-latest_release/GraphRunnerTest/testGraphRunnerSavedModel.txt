@Test public void testGraphRunnerSavedModel() throws Exception {
  File f=testDir.newFolder();
  new ClassPathResource("/tf_saved_models/saved_model_counter/00000123/").copyDirectory(f);
  SavedModelConfig savedModelConfig=SavedModelConfig.builder().savedModelPath(f.getAbsolutePath()).signatureKey("incr_counter_by").modelTag("serve").build();
  try (GraphRunner graphRunner=new GraphRunner(savedModelConfig)){
    INDArray delta=Nd4j.create(new float[]{42},new long[0]);
    Map<String,INDArray> inputs=new LinkedHashMap<>();
    inputs.put("delta",delta);
    Map<String,INDArray> outputs=graphRunner.run(inputs);
    assertEquals(1,outputs.size());
    INDArray output=outputs.get("output");
    assertEquals(42.0,output.getDouble(0),0.0);
  }
 }
