@Test public void testCodecReader() throws Exception {
  File file=new ClassPathResource("datavec-data-codec/fire_lowres.mp4").getFile();
  SequenceRecordReader reader=new CodecRecordReader();
  Configuration conf=new Configuration();
  conf.set(CodecRecordReader.RAVEL,"true");
  conf.set(CodecRecordReader.START_FRAME,"160");
  conf.set(CodecRecordReader.TOTAL_FRAMES,"500");
  conf.set(CodecRecordReader.ROWS,"80");
  conf.set(CodecRecordReader.COLUMNS,"46");
  reader.initialize(new FileSplit(file));
  reader.setConf(conf);
  assertTrue(reader.hasNext());
  List<List<Writable>> record=reader.sequenceRecord();
  Iterator<List<Writable>> it=record.iterator();
  List<Writable> first=it.next();
  assertEquals(1,first.size());
  assertEquals(80 * 46 * 3,((ArrayWritable)first.iterator().next()).length());
}
