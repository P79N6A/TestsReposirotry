@Test public void testViaDataInputStream() throws Exception {
  File file=new ClassPathResource("datavec-data-codec/fire_lowres.mp4").getFile();
  SequenceRecordReader reader=new CodecRecordReader();
  Configuration conf=new Configuration();
  conf.set(CodecRecordReader.RAVEL,"true");
  conf.set(CodecRecordReader.START_FRAME,"160");
  conf.set(CodecRecordReader.TOTAL_FRAMES,"500");
  conf.set(CodecRecordReader.ROWS,"80");
  conf.set(CodecRecordReader.COLUMNS,"46");
  Configuration conf2=new Configuration(conf);
  reader.initialize(new FileSplit(file));
  reader.setConf(conf);
  assertTrue(reader.hasNext());
  List<List<Writable>> expected=reader.sequenceRecord();
  SequenceRecordReader reader2=new CodecRecordReader();
  reader2.setConf(conf2);
  DataInputStream dataInputStream=new DataInputStream(new FileInputStream(file));
  List<List<Writable>> actual=reader2.sequenceRecord(null,dataInputStream);
  assertEquals(expected,actual);
}
