@Test public void testReallocate1() throws Exception {
  try (MemoryWorkspace ws=Nd4j.getWorkspaceManager().getAndActivateWorkspace(reallocateConfiguration,"WS_1")){
    INDArray array=Nd4j.create(100);
  }
   Nd4jWorkspace workspace=(Nd4jWorkspace)Nd4j.getWorkspaceManager().getWorkspaceForCurrentThread(reallocateConfiguration,"WS_1");
  workspace.initializeWorkspace();
  assertEquals(100 * Nd4j.sizeOfDataType(),workspace.getCurrentSize());
  try (MemoryWorkspace ws=Nd4j.getWorkspaceManager().getAndActivateWorkspace(reallocateConfiguration,"WS_1")){
    INDArray array=Nd4j.create(1000);
  }
   assertEquals(1000 * Nd4j.sizeOfDataType(),workspace.getMaxCycleAllocations());
  workspace.initializeWorkspace();
  assertEquals(1000 * Nd4j.sizeOfDataType(),workspace.getCurrentSize());
  try (MemoryWorkspace ws=Nd4j.getWorkspaceManager().getAndActivateWorkspace(reallocateConfiguration,"WS_1")){
    INDArray array=Nd4j.create(500).assign(1.0);
    assertEquals(1.0,array.meanNumber().doubleValue(),0.01);
  }
 }
