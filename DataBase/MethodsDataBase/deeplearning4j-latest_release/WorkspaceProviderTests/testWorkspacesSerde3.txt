@Test public void testWorkspacesSerde3() throws Exception {
  INDArray array=Nd4j.create(10).assign(1.0);
  INDArray restored=null;
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(bos);
  Nd4j.write(array,dos);
  try (Nd4jWorkspace workspace=(Nd4jWorkspace)Nd4j.getWorkspaceManager().getAndActivateWorkspace(basicConfiguration,"WS_1")){
    try (MemoryWorkspace wsO=Nd4j.getMemoryManager().scopeOutOfWorkspaces()){
      workspace.enableDebug(true);
      ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
      DataInputStream dis=new DataInputStream(bis);
      restored=Nd4j.read(dis);
      assertEquals(0,workspace.getHostOffset());
      assertEquals(array.length(),restored.length());
      assertEquals(1.0f,restored.meanNumber().floatValue(),1.0f);
      assertTrue(array.shapeInfoDataBuffer() == restored.shapeInfoDataBuffer());
    }
   }
 }
