@Test public void testWorkspacesSerde2() throws Exception {
  INDArray array=Nd4j.create(10).assign(1.0);
  INDArray restored=null;
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(bos);
  Nd4j.write(array,dos);
  try (Nd4jWorkspace workspace=(Nd4jWorkspace)Nd4j.getWorkspaceManager().getAndActivateWorkspace(basicConfiguration,"WS_1")){
    workspace.enableDebug(true);
    ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
    DataInputStream dis=new DataInputStream(bis);
    restored=Nd4j.read(dis);
    long requiredMemory=10 * Nd4j.sizeOfDataType();
    assertEquals(requiredMemory + requiredMemory % 8,workspace.getHostOffset());
    assertEquals(array.length(),restored.length());
    assertEquals(1.0f,restored.meanNumber().floatValue(),1.0f);
    assertTrue(array.shapeInfoDataBuffer() == restored.shapeInfoDataBuffer());
  }
 }
