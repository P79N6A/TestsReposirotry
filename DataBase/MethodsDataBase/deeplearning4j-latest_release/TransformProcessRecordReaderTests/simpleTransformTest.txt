@Test public void simpleTransformTest() throws Exception {
  Schema schema=new Schema.Builder().addColumnsDouble("%d",0,4).build();
  TransformProcess transformProcess=new TransformProcess.Builder(schema).removeColumns("0").build();
  CSVRecordReader csvRecordReader=new CSVRecordReader();
  csvRecordReader.initialize(new FileSplit(new ClassPathResource("datavec-api/iris.dat").getFile()));
  TransformProcessRecordReader rr=new TransformProcessRecordReader(csvRecordReader,transformProcess);
  int count=0;
  List<List<Writable>> all=new ArrayList<>();
  while (rr.hasNext()) {
    List<Writable> next=rr.next();
    assertEquals(4,next.size());
    count++;
    all.add(next);
  }
  assertEquals(150,count);
  assertTrue(rr.resetSupported());
  rr.reset();
  List<List<Writable>> batch=rr.next(150);
  assertEquals(all,batch);
}
