@Test public void testTopK(){
  OpValidationSuite.ignoreFailing();
  INDArray in=Nd4j.trueVector(new double[]{7,3,1,2,5,0,4,6,9,8});
  INDArray expTopK=Nd4j.trueVector(new double[]{7,5,6,9,8});
  INDArray expIndices=Nd4j.trueVector(new double[]{0,4,7,8,9});
  INDArray expTopK_sorted=Nd4j.trueVector(new double[]{9,8,7,6,5});
  INDArray expIndices_sorted=Nd4j.trueVector(new double[]{8,9,0,7,4});
  for (  boolean sort : new boolean[]{false,true}) {
    INDArray outUnique=Nd4j.create(expTopK.shape());
    INDArray outUniqueIdxs=Nd4j.create(expIndices.shape());
    DynamicCustomOp op=DynamicCustomOp.builder("top_k").addInputs(in).addOutputs(outUnique,outUniqueIdxs).addIntegerArguments(5,sort ? 1 : 0).build();
    String err=OpValidation.validate(new OpTestCase(op).expectedOutput(0,sort ? expTopK_sorted : expTopK).expectedOutput(1,sort ? expIndices_sorted : expIndices));
    assertNull(err);
  }
}
