@Test public void testImagesRRDMSI() throws Exception {
  File parentDir=temporaryFolder.newFolder();
  parentDir.deleteOnExit();
  String str1=FilenameUtils.concat(parentDir.getAbsolutePath(),"Zico/");
  String str2=FilenameUtils.concat(parentDir.getAbsolutePath(),"Ziwang_Xu/");
  File f1=new File(str1);
  File f2=new File(str2);
  f1.mkdirs();
  f2.mkdirs();
  TestUtils.writeStreamToFile(new File(FilenameUtils.concat(f1.getPath(),"Zico_0001.jpg")),new ClassPathResource("lfwtest/Zico/Zico_0001.jpg").getInputStream());
  TestUtils.writeStreamToFile(new File(FilenameUtils.concat(f2.getPath(),"Ziwang_Xu_0001.jpg")),new ClassPathResource("lfwtest/Ziwang_Xu/Ziwang_Xu_0001.jpg").getInputStream());
  int outputNum=2;
  Random r=new Random(12345);
  ParentPathLabelGenerator labelMaker=new ParentPathLabelGenerator();
  ImageRecordReader rr1=new ImageRecordReader(10,10,1,labelMaker);
  ImageRecordReader rr1s=new ImageRecordReader(5,5,1,labelMaker);
  rr1.initialize(new FileSplit(parentDir));
  rr1s.initialize(new FileSplit(parentDir));
  MultiDataSetIterator trainDataIterator=new RecordReaderMultiDataSetIterator.Builder(1).addReader("rr1",rr1).addReader("rr1s",rr1s).addInput("rr1",0,0).addInput("rr1s",0,0).addOutputOneHot("rr1s",1,outputNum).build();
  ImageRecordReader rr1_b=new ImageRecordReader(10,10,1,labelMaker);
  ImageRecordReader rr1s_b=new ImageRecordReader(5,5,1,labelMaker);
  rr1_b.initialize(new FileSplit(parentDir));
  rr1s_b.initialize(new FileSplit(parentDir));
  DataSetIterator dsi1=new RecordReaderDataSetIterator(rr1_b,1,1,2);
  DataSetIterator dsi2=new RecordReaderDataSetIterator(rr1s_b,1,1,2);
  for (int i=0; i < 2; i++) {
    MultiDataSet mds=trainDataIterator.next();
    DataSet d1=dsi1.next();
    DataSet d2=dsi2.next();
    assertEquals(d1.getFeatures(),mds.getFeatures(0));
    assertEquals(d2.getFeatures(),mds.getFeatures(1));
    assertEquals(d1.getLabels(),mds.getLabels(0));
  }
}
