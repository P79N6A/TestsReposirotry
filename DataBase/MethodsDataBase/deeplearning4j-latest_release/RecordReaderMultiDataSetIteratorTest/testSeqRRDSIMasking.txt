@Test public void testSeqRRDSIMasking(){
  List<List<List<Writable>>> features=new ArrayList<>();
  List<List<List<Writable>>> labels=new ArrayList<>();
  features.add(Arrays.asList(l(new DoubleWritable(1)),l(new DoubleWritable(2)),l(new DoubleWritable(3))));
  features.add(Arrays.asList(l(new DoubleWritable(4)),l(new DoubleWritable(5))));
  labels.add(Arrays.asList(l(new IntWritable(0))));
  labels.add(Arrays.asList(l(new IntWritable(1))));
  CollectionSequenceRecordReader fR=new CollectionSequenceRecordReader(features);
  CollectionSequenceRecordReader lR=new CollectionSequenceRecordReader(labels);
  SequenceRecordReaderDataSetIterator seqRRDSI=new SequenceRecordReaderDataSetIterator(fR,lR,2,2,false,SequenceRecordReaderDataSetIterator.AlignmentMode.ALIGN_END);
  DataSet ds=seqRRDSI.next();
  INDArray fMask=Nd4j.create(new double[][]{{1,1,1},{1,1,0}});
  INDArray lMask=Nd4j.create(new double[][]{{0,0,1},{0,1,0}});
  assertEquals(fMask,ds.getFeaturesMaskArray());
  assertEquals(lMask,ds.getLabelsMaskArray());
  INDArray f=Nd4j.create(new double[][]{{1,2,3},{4,5,0}});
  INDArray l=Nd4j.create(2,2,3);
  l.putScalar(0,0,2,1.0);
  l.putScalar(1,1,1,1.0);
  assertEquals(f,ds.getFeatures().get(all(),point(0),all()));
  assertEquals(l,ds.getLabels());
}
