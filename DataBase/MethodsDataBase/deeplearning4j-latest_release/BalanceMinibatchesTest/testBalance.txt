@Test public void testBalance() throws Exception {
  DataSetIterator iterator=new IrisDataSetIterator(10,150);
  File minibatches=testDir.newFolder();
  File saveDir=testDir.newFolder();
  BalanceMinibatches balanceMinibatches=BalanceMinibatches.builder().dataSetIterator(iterator).miniBatchSize(10).numLabels(3).rootDir(minibatches).rootSaveDir(saveDir).build();
  balanceMinibatches.balance();
  DataSetIterator balanced=new ExistingMiniBatchDataSetIterator(balanceMinibatches.getRootSaveDir());
  while (balanced.hasNext()) {
    assertTrue(balanced.next().labelCounts().size() > 0);
  }
}
