@Test public void testRotateImageTransform() throws Exception {
  ImageWritable writable=makeRandomImage(0,0,1);
  Frame frame=writable.getFrame();
  ImageTransform transform=new RotateImageTransform(rng,180).interMode(INTER_NEAREST).borderMode(BORDER_REFLECT);
  for (int i=0; i < 100; i++) {
    ImageWritable w=transform.transform(writable);
    Frame f=w.getFrame();
    assertEquals(f.imageHeight,frame.imageHeight);
    assertEquals(f.imageWidth,frame.imageWidth);
    assertEquals(f.imageChannels,frame.imageChannels);
  }
  assertEquals(null,transform.transform(null));
  transform=new RotateImageTransform(0,0,-90,0);
  writable=transform.transform(writable);
  float[] coordinates={frame.imageWidth / 2,frame.imageHeight / 2,0,0};
  float[] transformed=transform.query(coordinates);
  assertEquals(frame.imageWidth / 2,transformed[0],0);
  assertEquals(frame.imageHeight / 2,transformed[1],0);
  assertEquals((frame.imageHeight + frame.imageWidth) / 2,transformed[2],1);
  assertEquals((frame.imageHeight - frame.imageWidth) / 2,transformed[3],1);
}
