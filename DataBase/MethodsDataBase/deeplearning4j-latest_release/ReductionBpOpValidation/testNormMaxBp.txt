@Test public void testNormMaxBp(){
  for (  boolean keepDims : new boolean[]{false,true}) {
    INDArray preReduceInput=Nd4j.linspace(-5,6,12).reshape(3,4);
    INDArray sgn=Transforms.sign(preReduceInput,true);
    INDArray max=Nd4j.create(3,4);
    max.putScalar(2,3,1.0);
    INDArray dLdOut;
    if (keepDims) {
      dLdOut=Nd4j.valueArrayOf(new long[]{1,1},0.5);
    }
 else {
      dLdOut=Nd4j.trueScalar(0.5);
    }
    INDArray dLdInExpected=sgn.mul(max).mul(0.5);
    INDArray dLdIn=Nd4j.createUninitialized(3,4);
    String err=OpValidation.validate(new OpTestCase(new NormMaxBp(preReduceInput,dLdOut,dLdIn,keepDims)).expectedOutput(0,dLdInExpected));
    assertNull(err);
  }
}
