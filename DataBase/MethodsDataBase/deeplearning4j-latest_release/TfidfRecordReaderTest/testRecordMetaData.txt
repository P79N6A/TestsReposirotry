@Test public void testRecordMetaData() throws Exception {
  TfidfVectorizer vectorizer=new TfidfVectorizer();
  Configuration conf=new Configuration();
  conf.setInt(TfidfVectorizer.MIN_WORD_FREQUENCY,1);
  conf.setBoolean(RecordReader.APPEND_LABEL,true);
  vectorizer.initialize(conf);
  TfidfRecordReader reader=new TfidfRecordReader();
  File f=testDir.newFolder();
  new ClassPathResource("datavec-data-nlp/labeled/").copyDirectory(f);
  reader.initialize(conf,new FileSplit(f));
  while (reader.hasNext()) {
    Record record=reader.nextRecord();
    assertNotNull(record.getMetaData().getURI());
    assertEquals(record.getMetaData().getReaderClass(),TfidfRecordReader.class);
  }
}
