@Test public void testNextRecord() throws IOException, InterruptedException {
  SVMLightRecordReader rr=new SVMLightRecordReader();
  Configuration config=new Configuration();
  config.setBoolean(SVMLightRecordReader.ZERO_BASED_INDEXING,false);
  config.setInt(SVMLightRecordReader.NUM_FEATURES,10);
  config.setBoolean(SVMLightRecordReader.APPEND_LABEL,false);
  rr.initialize(config,new FileSplit(new ClassPathResource("datavec-api/svmlight/basic.txt").getFile()));
  Record record=rr.nextRecord();
  List<Writable> recordList=record.getRecord();
  assertEquals(new DoubleWritable(1.0),recordList.get(1));
  assertEquals(new DoubleWritable(3.0),recordList.get(5));
  assertEquals(new DoubleWritable(4.0),recordList.get(7));
  record=rr.nextRecord();
  recordList=record.getRecord();
  assertEquals(new DoubleWritable(0.1),recordList.get(0));
  assertEquals(new DoubleWritable(6.6),recordList.get(5));
  assertEquals(new DoubleWritable(80.0),recordList.get(7));
}
