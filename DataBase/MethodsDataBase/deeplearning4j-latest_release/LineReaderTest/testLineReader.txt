@Test public void testLineReader() throws Exception {
  String tempDir=System.getProperty("java.io.tmpdir");
  File tmpdir=new File(tempDir,"tmpdir-testLineReader");
  if (tmpdir.exists())   tmpdir.delete();
  tmpdir.mkdir();
  File tmp1=new File(FilenameUtils.concat(tmpdir.getPath(),"tmp1.txt"));
  File tmp2=new File(FilenameUtils.concat(tmpdir.getPath(),"tmp2.txt"));
  File tmp3=new File(FilenameUtils.concat(tmpdir.getPath(),"tmp3.txt"));
  FileUtils.writeLines(tmp1,Arrays.asList("1","2","3"));
  FileUtils.writeLines(tmp2,Arrays.asList("4","5","6"));
  FileUtils.writeLines(tmp3,Arrays.asList("7","8","9"));
  InputSplit split=new FileSplit(tmpdir);
  RecordReader reader=new LineRecordReader();
  reader.initialize(split);
  int count=0;
  List<List<Writable>> list=new ArrayList<>();
  while (reader.hasNext()) {
    List<Writable> l=reader.next();
    assertEquals(1,l.size());
    list.add(l);
    count++;
  }
  assertEquals(9,count);
  try {
    FileUtils.deleteDirectory(tmpdir);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
