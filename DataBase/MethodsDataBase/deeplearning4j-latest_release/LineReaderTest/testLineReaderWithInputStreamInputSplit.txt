@Test public void testLineReaderWithInputStreamInputSplit() throws Exception {
  String tempDir=System.getProperty("java.io.tmpdir");
  File tmpdir=new File(tempDir,"tmpdir");
  tmpdir.mkdir();
  File tmp1=new File(tmpdir,"tmp1.txt.gz");
  OutputStream os=new GZIPOutputStream(new FileOutputStream(tmp1,false));
  IOUtils.writeLines(Arrays.asList("1","2","3","4","5","6","7","8","9"),null,os);
  os.flush();
  os.close();
  InputSplit split=new InputStreamInputSplit(new GZIPInputStream(new FileInputStream(tmp1)));
  RecordReader reader=new LineRecordReader();
  reader.initialize(split);
  int count=0;
  while (reader.hasNext()) {
    assertEquals(1,reader.next().size());
    count++;
  }
  assertEquals(9,count);
  try {
    FileUtils.deleteDirectory(tmpdir);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
