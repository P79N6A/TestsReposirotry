@Test public void testLabelAndPredictionCounts(){
  int minibatch=50;
  int nClasses=3;
  INDArray arr=Nd4j.rand(minibatch,nClasses);
  arr.diviColumnVector(arr.sum(1));
  INDArray labels=Nd4j.zeros(minibatch,nClasses);
  Random r=new Random(12345);
  for (int i=0; i < minibatch; i++) {
    labels.putScalar(i,r.nextInt(nClasses),1.0);
  }
  EvaluationCalibration ec=new EvaluationCalibration(5,5);
  ec.eval(labels,arr);
  int[] expLabelCounts=labels.sum(0).data().asInt();
  int[] expPredictionCount=new int[(int)labels.size(1)];
  INDArray argmax=Nd4j.argMax(arr,1);
  for (int i=0; i < argmax.length(); i++) {
    expPredictionCount[argmax.getInt(i,0)]++;
  }
  assertArrayEquals(expLabelCounts,ec.getLabelCountsEachClass());
  assertArrayEquals(expPredictionCount,ec.getPredictionCountsEachClass());
}
