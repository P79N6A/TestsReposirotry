@Test public void testClassificationScoreFunctionSimple() throws Exception {
  for (  Evaluation.Metric metric : Evaluation.Metric.values()) {
    log.info("Metric: " + metric);
    ComputationGraphConfiguration conf=new NeuralNetConfiguration.Builder().graphBuilder().addInputs("in").layer("0",new DenseLayer.Builder().nIn(784).nOut(32).build(),"in").layer("1",new OutputLayer.Builder().nIn(32).nOut(10).activation(Activation.SOFTMAX).build(),"0").setOutputs("1").build();
    ComputationGraph net=new ComputationGraph(conf);
    net.init();
    DataSetIterator iter=new MnistDataSetIterator(32,false,12345);
    List<DataSet> l=new ArrayList<>();
    for (int i=0; i < 10; i++) {
      DataSet ds=iter.next();
      l.add(ds);
    }
    iter=new ExistingDataSetIterator(l);
    EarlyStoppingModelSaver<ComputationGraph> saver=new InMemoryModelSaver<>();
    EarlyStoppingConfiguration<ComputationGraph> esConf=new EarlyStoppingConfiguration.Builder<ComputationGraph>().epochTerminationConditions(new MaxEpochsTerminationCondition(5)).iterationTerminationConditions(new MaxTimeIterationTerminationCondition(1,TimeUnit.MINUTES)).scoreCalculator(new ClassificationScoreCalculator(metric,iter)).modelSaver(saver).build();
    EarlyStoppingGraphTrainer trainer=new EarlyStoppingGraphTrainer(esConf,net,iter);
    EarlyStoppingResult<ComputationGraph> result=trainer.fit();
    assertNotNull(result.getBestModel());
  }
}
