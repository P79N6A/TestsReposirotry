@Test public void testElementWiseVertexForwardProduct(){
  int batchsz=24;
  int featuresz=17;
  ComputationGraphConfiguration cgc=new NeuralNetConfiguration.Builder().graphBuilder().addInputs("input1","input2","input3").addLayer("denselayer",new DenseLayer.Builder().nIn(featuresz).nOut(1).activation(Activation.IDENTITY).build(),"input1").addVertex("elementwiseProduct",new ElementWiseVertex(ElementWiseVertex.Op.Product),"input1","input2","input3").addLayer("Product",new ActivationLayer.Builder().activation(Activation.IDENTITY).build(),"elementwiseProduct").setOutputs("Product","denselayer").build();
  ComputationGraph cg=new ComputationGraph(cgc);
  cg.init();
  INDArray input1=Nd4j.rand(batchsz,featuresz);
  INDArray input2=Nd4j.rand(batchsz,featuresz);
  INDArray input3=Nd4j.rand(batchsz,featuresz);
  INDArray target=input1.dup().muli(input2).muli(input3);
  INDArray output=cg.output(input1,input2,input3)[0];
  INDArray squared=output.sub(target);
  double rms=squared.mul(squared).sumNumber().doubleValue();
  Assert.assertEquals(0.0,rms,this.epsilon);
}
