@Test public void testRecordReader() throws Exception {
  RecordReader rr=new MapFileRecordReader();
  URI uri=mapFilePath.toUri();
  InputSplit is=new FileSplit(new File(uri));
  rr.initialize(is);
  assertTrue(rr.hasNext());
  int count=0;
  while (rr.hasNext()) {
    List<org.datavec.api.writable.Writable> l=rr.next();
    assertEquals(recordMap.get(new LongWritable(count)).getRecord(),l);
    count++;
  }
  assertEquals(recordMap.size(),count);
  rr.close();
  rr=new MapFileRecordReader(new Random(12345));
  rr.initialize(is);
  Field f=MapFileRecordReader.class.getDeclaredField("order");
  f.setAccessible(true);
  int[] order=(int[])f.get(rr);
  assertNotNull(order);
  int[] expOrder=new int[]{0,1,2};
  MathUtils.shuffleArray(expOrder,new Random(12345));
  assertArrayEquals(expOrder,order);
  count=0;
  while (rr.hasNext()) {
    List<org.datavec.api.writable.Writable> l=rr.next();
    assertEquals(recordMap.get(new LongWritable(expOrder[count])).getRecord(),l);
    count++;
  }
}
