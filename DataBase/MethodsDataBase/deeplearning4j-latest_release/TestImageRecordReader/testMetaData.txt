@Test public void testMetaData() throws IOException {
  File parentDir=testDir.newFolder();
  new ClassPathResource("datavec-data-image/testimages/").copyDirectory(parentDir);
  ParentPathLabelGenerator labelMaker=new ParentPathLabelGenerator();
  ImageRecordReader rr=new ImageRecordReader(32,32,3,labelMaker);
  rr.initialize(new FileSplit(parentDir));
  List<List<Writable>> out=new ArrayList<>();
  while (rr.hasNext()) {
    List<Writable> l=rr.next();
    out.add(l);
    assertEquals(2,l.size());
  }
  assertEquals(6,out.size());
  rr.reset();
  List<List<Writable>> out2=new ArrayList<>();
  List<Record> out3=new ArrayList<>();
  List<RecordMetaData> meta=new ArrayList<>();
  while (rr.hasNext()) {
    Record r=rr.nextRecord();
    out2.add(r.getRecord());
    out3.add(r);
    meta.add(r.getMetaData());
  }
  assertEquals(out,out2);
  List<Record> fromMeta=rr.loadFromMetaData(meta);
  assertEquals(out3,fromMeta);
}
