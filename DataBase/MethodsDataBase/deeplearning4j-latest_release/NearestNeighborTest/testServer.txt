@Test public void testServer() throws Exception {
  int localPort=getAvailablePort();
  Nd4j.getRandom().setSeed(7);
  INDArray rand=Nd4j.randn(10,5);
  File writeToTmp=testDir.newFile();
  writeToTmp.deleteOnExit();
  BinarySerde.writeArrayToDisk(rand,writeToTmp);
  NearestNeighborsServer server=new NearestNeighborsServer();
  server.runMain("--ndarrayPath",writeToTmp.getAbsolutePath(),"--nearestNeighborsPort",String.valueOf(localPort));
  NearestNeighborsClient client=new NearestNeighborsClient("http://localhost:" + localPort);
  NearestNeighborsResults result=client.knnNew(5,rand.getRow(0));
  assertEquals(5,result.getResults().size());
  server.stop();
}
