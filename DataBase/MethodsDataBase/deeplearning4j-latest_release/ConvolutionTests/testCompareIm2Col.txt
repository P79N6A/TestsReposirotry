@Test @Ignore public void testCompareIm2Col() throws Exception {
  int[] miniBatches={1,3,5};
  int[] depths={1,3,5};
  int[] inHeights={5,21};
  int[] inWidths={5,21};
  int[] strideH={1,2};
  int[] strideW={1,2};
  int[] sizeW={1,2,3};
  int[] sizeH={1,2,3};
  int[] padH={0,1,2};
  int[] padW={0,1,2};
  DataBuffer.Type[] types=new DataBuffer.Type[]{DataBuffer.Type.FLOAT,DataBuffer.Type.DOUBLE,DataBuffer.Type.FLOAT,DataBuffer.Type.DOUBLE};
  DataBuffer.AllocationMode[] modes=new DataBuffer.AllocationMode[]{DataBuffer.AllocationMode.HEAP,DataBuffer.AllocationMode.HEAP,DataBuffer.AllocationMode.DIRECT,DataBuffer.AllocationMode.DIRECT};
  String factoryClassName=Nd4j.factory().getClass().toString().toLowerCase();
  if (factoryClassName.contains("jcublas") || factoryClassName.contains("cuda")) {
    types=new DataBuffer.Type[]{DataBuffer.Type.FLOAT,DataBuffer.Type.DOUBLE};
    modes=new DataBuffer.AllocationMode[]{DataBuffer.AllocationMode.DIRECT,DataBuffer.AllocationMode.DIRECT};
  }
  DataBuffer.Type inititalType=Nd4j.dataType();
  for (int i=0; i < types.length; i++) {
    DataBuffer.Type type=types[i];
    DataBuffer.AllocationMode mode=modes[i];
    DataTypeUtil.setDTypeForContext(type);
    Nd4j.alloc=mode;
    for (    int m : miniBatches) {
      for (      int d : depths) {
        for (        int h : inHeights) {
          for (          int w : inWidths) {
            for (            int sh : strideH) {
              for (              int sw : strideW) {
                for (                int kh : sizeH) {
                  for (                  int kw : sizeW) {
                    for (                    int ph : padH) {
                      for (                      int pw : padW) {
                        System.out.println("Before assertion");
                        if ((w - kw + 2 * pw) % sw != 0 || (h - kh + 2 * ph) % sh != 0)                         continue;
                        INDArray in=Nd4j.rand(new int[]{m,d,h,w});
                        assertEquals(in.data().allocationMode(),mode);
                        assertEquals(in.data().dataType(),type);
                        INDArray im2col=Convolution.im2col(in,kh,kw,sh,sw,ph,pw,false);
                        INDArray imgOutOld=OldConvolution.col2im(im2col,sh,sw,ph,pw,h,w);
                        INDArray imgOutNew=Convolution.col2im(im2col,sh,sw,ph,pw,h,w);
                        System.out.println("F order test");
                        System.out.println(imgOutOld);
                        System.out.println(imgOutNew);
                        assertEquals(imgOutOld,imgOutNew);
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  DataTypeUtil.setDTypeForContext(inititalType);
}
