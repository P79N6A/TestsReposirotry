@Test public void getBatchedDotAggregation1() throws Exception {
  INDArray x=Nd4j.create(5,300).assign(2.0);
  INDArray y=x.dup();
  x.muli(y);
  INDArray exp=x.sum(1);
  List<DotAggregation> aggregations=new ArrayList<>();
  for (int i=0, j=0; i < NODES; i++) {
    INDArray arrayX=Nd4j.create(5,ELEMENTS_PER_NODE);
    INDArray arrayY=Nd4j.create(5,ELEMENTS_PER_NODE);
    arrayX.assign(2.0);
    arrayY.assign(2.0);
    DotAggregation aggregation=new DotAggregation(1L,NODES,(short)i,arrayX.mul(arrayY));
    aggregations.add(aggregation);
  }
  DotAggregation aggregation=aggregations.get(0);
  int cnt=1;
  for (  DotAggregation vectorAggregation : aggregations) {
    aggregation.accumulateAggregation(vectorAggregation);
    cnt++;
  }
  INDArray result=aggregation.getAccumulatedResult();
  assertArrayEquals(exp.shapeInfoDataBuffer().asInt(),result.shapeInfoDataBuffer().asInt());
  assertEquals(exp,result);
}
