@Test public void testCsvSequence() throws Exception {
  File baseDir=testDir.newFolder();
  List<File> fileList=new ArrayList<>();
  for (int i=0; i < 10; i++) {
    StringBuilder sb=new StringBuilder();
    for (int j=0; j < 3; j++) {
      if (j > 0)       sb.append("\n");
      sb.append("file_" + i + ","+ i+ ","+ j);
    }
    File f=new File(baseDir,"origFile" + i + ".csv");
    FileUtils.writeStringToFile(f,sb.toString(),StandardCharsets.UTF_8);
    fileList.add(f);
  }
  FileBatch fb=FileBatch.forFiles(fileList);
  SequenceRecordReader rr=new CSVSequenceRecordReader();
  FileBatchSequenceRecordReader fbrr=new FileBatchSequenceRecordReader(rr,fb);
  for (int test=0; test < 3; test++) {
    for (int i=0; i < 10; i++) {
      assertTrue(fbrr.hasNext());
      List<List<Writable>> next=fbrr.sequenceRecord();
      assertEquals(3,next.size());
      int count=0;
      for (      List<Writable> step : next) {
        String s1="file_" + i;
        assertEquals(s1,step.get(0).toString());
        assertEquals(String.valueOf(i),step.get(1).toString());
        assertEquals(String.valueOf(count++),step.get(2).toString());
      }
    }
    assertFalse(fbrr.hasNext());
    assertTrue(fbrr.resetSupported());
    fbrr.reset();
  }
}
