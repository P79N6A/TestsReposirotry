@Test public void testCategoricalToInteger(){
  Schema schema=getSchema(ColumnType.Categorical,"zero","one","two");
  Transform transform=new CategoricalToIntegerTransform("column");
  transform.setInputSchema(schema);
  Schema out=transform.transform(schema);
  TestCase.assertEquals(ColumnType.Integer,out.getMetaData(0).getColumnType());
  IntegerMetaData meta=(IntegerMetaData)out.getMetaData(0);
  assertNotNull(meta.getMinAllowedValue());
  assertEquals(0,(int)meta.getMinAllowedValue());
  assertNotNull(meta.getMaxAllowedValue());
  assertEquals(2,(int)meta.getMaxAllowedValue());
  assertEquals(0,transform.map(Collections.singletonList((Writable)new Text("zero"))).get(0).toInt());
  assertEquals(1,transform.map(Collections.singletonList((Writable)new Text("one"))).get(0).toInt());
  assertEquals(2,transform.map(Collections.singletonList((Writable)new Text("two"))).get(0).toInt());
}
