@Test public void testStringListToCountsNDArrayTransform() throws Exception {
  StringListToCountsNDArrayTransform t=new StringListToCountsNDArrayTransform("inCol","outCol",Arrays.asList("cat","dog","horse"),",",false,true);
  Schema s=new Schema.Builder().addColumnString("inCol").build();
  t.setInputSchema(s);
  List<Writable> l=Collections.<Writable>singletonList(new Text("cat,cat,dog,dog,dog,unknown"));
  List<Writable> out=t.map(l);
  assertEquals(Collections.singletonList(new NDArrayWritable(Nd4j.create(new double[]{2,3,0}))),out);
  String json=JsonMappers.getMapper().writeValueAsString(t);
  Transform transform2=JsonMappers.getMapper().readValue(json,StringListToCountsNDArrayTransform.class);
  Assert.assertEquals(t,transform2);
}
