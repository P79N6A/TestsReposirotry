@Test public void testDoubleColumnsMathOpTransform(){
  Schema schema=new Schema.Builder().addColumnString("first").addColumnDouble("second").addColumnDouble("third").build();
  Transform transform=new DoubleColumnsMathOpTransform("out",MathOp.Add,"second","third");
  transform.setInputSchema(schema);
  Schema out=transform.transform(schema);
  assertEquals(4,out.numColumns());
  assertEquals(Arrays.asList("first","second","third","out"),out.getColumnNames());
  assertEquals(Arrays.asList(ColumnType.String,ColumnType.Double,ColumnType.Double,ColumnType.Double),out.getColumnTypes());
  assertEquals(Arrays.asList((Writable)new Text("something"),new DoubleWritable(1.0),new DoubleWritable(2.1),new DoubleWritable(3.1)),transform.map(Arrays.asList((Writable)new Text("something"),new DoubleWritable(1.0),new DoubleWritable(2.1))));
  assertEquals(Arrays.asList((Writable)new Text("something2"),new DoubleWritable(100.0),new DoubleWritable(21.1),new DoubleWritable(121.1)),transform.map(Arrays.asList((Writable)new Text("something2"),new DoubleWritable(100.0),new DoubleWritable(21.1))));
}
