@Test public void testStringListToCategoricalSetTransform(){
  Schema schema=getSchema(ColumnType.String);
  Transform transform=new StringListToCategoricalSetTransform("column",Arrays.asList("a","b","c"),Arrays.asList("a","b","c"),",");
  transform.setInputSchema(schema);
  Schema out=transform.transform(schema);
  assertEquals(3,out.getColumnMetaData().size());
  for (int i=0; i < 3; i++) {
    TestCase.assertEquals(ColumnType.Categorical,out.getType(i));
    CategoricalMetaData meta=(CategoricalMetaData)out.getMetaData(i);
    assertEquals(Arrays.asList("true","false"),meta.getStateNames());
  }
  assertEquals(Arrays.asList(new Text("false"),new Text("false"),new Text("false")),transform.map(Collections.singletonList((Writable)new Text(""))));
  assertEquals(Arrays.asList(new Text("true"),new Text("false"),new Text("false")),transform.map(Collections.singletonList((Writable)new Text("a"))));
  assertEquals(Arrays.asList(new Text("false"),new Text("true"),new Text("false")),transform.map(Collections.singletonList((Writable)new Text("b"))));
  assertEquals(Arrays.asList(new Text("false"),new Text("false"),new Text("true")),transform.map(Collections.singletonList((Writable)new Text("c"))));
  assertEquals(Arrays.asList(new Text("true"),new Text("false"),new Text("true")),transform.map(Collections.singletonList((Writable)new Text("a,c"))));
  assertEquals(Arrays.asList(new Text("true"),new Text("true"),new Text("true")),transform.map(Collections.singletonList((Writable)new Text("a,b,c"))));
}
