@Test public void testStringListToIndicesNDArrayTransform() throws Exception {
  StringListToIndicesNDArrayTransform t=new StringListToIndicesNDArrayTransform("inCol","outCol",Arrays.asList("apple","cat","dog","horse"),",",false,true);
  Schema s=new Schema.Builder().addColumnString("inCol").build();
  t.setInputSchema(s);
  List<Writable> l=Collections.<Writable>singletonList(new Text("cat,dog,dog,dog,unknown"));
  List<Writable> out=t.map(l);
  assertEquals(Collections.singletonList(new NDArrayWritable(Nd4j.create(new double[]{1,2,2,2}))),out);
  String json=JsonMappers.getMapper().writeValueAsString(t);
  Transform transform2=JsonMappers.getMapper().readValue(json,StringListToIndicesNDArrayTransform.class);
  Assert.assertEquals(t,transform2);
}
