@Test public void testWriter() throws Exception {
  ExcelRecordWriter excelRecordWriter=new ExcelRecordWriter();
  val records=records();
  File tmpDir=testDir.newFolder();
  File outputFile=new File(tmpDir,"testexcel.xlsx");
  outputFile.deleteOnExit();
  FileSplit fileSplit=new FileSplit(outputFile);
  excelRecordWriter.initialize(fileSplit,new NumberOfRecordsPartitioner());
  excelRecordWriter.writeBatch(records.getRight());
  excelRecordWriter.close();
  File parentFile=outputFile.getParentFile();
  assertEquals(1,parentFile.list().length);
  ExcelRecordReader excelRecordReader=new ExcelRecordReader();
  excelRecordReader.initialize(fileSplit);
  List<List<Writable>> next=excelRecordReader.next(10);
  assertEquals(10,next.size());
}
