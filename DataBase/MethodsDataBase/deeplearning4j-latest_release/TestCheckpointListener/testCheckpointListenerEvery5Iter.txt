@Test public void testCheckpointListenerEvery5Iter() throws Exception {
  File f=tempDir.newFolder();
  Pair<MultiLayerNetwork,DataSetIterator> p=getNetAndData();
  MultiLayerNetwork net=p.getFirst();
  DataSetIterator iter=p.getSecond();
  CheckpointListener l=new CheckpointListener.Builder(f).keepLast(3).saveEveryNIterations(5).build();
  net.setListeners(l);
  for (int i=0; i < 20; i++) {
    net.fit(iter);
  }
  File[] files=f.listFiles();
  int count=0;
  Set<Integer> ns=new HashSet<>();
  for (  File f2 : files) {
    if (!f2.getPath().endsWith(".zip")) {
      continue;
    }
    count++;
    int prefixLength="checkpoint_".length();
    int num=Integer.parseInt(f2.getName().substring(prefixLength,prefixLength + 1));
    MultiLayerNetwork n=ModelSerializer.restoreMultiLayerNetwork(f2,true);
    int expIter=5 * (num + 1);
    assertEquals(expIter,n.getIterationCount());
    ns.add(n.getIterationCount());
    count++;
  }
  assertEquals(ns.toString(),3,ns.size());
  assertTrue(ns.contains(25));
  assertTrue(ns.contains(30));
  assertTrue(ns.contains(35));
  assertEquals(3,l.availableCheckpoints().size());
}
