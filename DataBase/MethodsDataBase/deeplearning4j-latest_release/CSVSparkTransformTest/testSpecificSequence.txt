@Test public void testSpecificSequence() throws Exception {
  final Schema schema=new Schema.Builder().addColumnsString("action").build();
  final TransformProcess transformProcess=new TransformProcess.Builder(schema).removeAllColumnsExceptFor("action").transform(new ConverToLowercase("action")).convertToSequence().transform(new TextToCharacterIndexTransform("action","action_sequence",defaultCharIndex(),false)).integerToOneHot("action_sequence",0,29).build();
  final String[] data1=new String[]{"test1"};
  final String[] data2=new String[]{"test2"};
  final BatchCSVRecord batchCsvRecord=new BatchCSVRecord(Arrays.asList(new SingleCSVRecord(data1),new SingleCSVRecord(data2)));
  final CSVSparkTransform transform=new CSVSparkTransform(transformProcess);
  System.out.println(transform.transformSequenceIncremental(batchCsvRecord));
  assertEquals(3,Nd4jBase64.fromBase64(transform.transformSequenceArrayIncremental(batchCsvRecord).getNdarray()).rank());
}
