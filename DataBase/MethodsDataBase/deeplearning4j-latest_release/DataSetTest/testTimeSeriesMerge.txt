@Test public void testTimeSeriesMerge(){
  int numExamples=10;
  int inSize=13;
  int labelSize=5;
  int tsLength=15;
  Nd4j.getRandom().setSeed(12345);
  List<DataSet> list=new ArrayList<>(numExamples);
  for (int i=0; i < numExamples; i++) {
    INDArray in=Nd4j.rand(new long[]{1,inSize,tsLength});
    INDArray out=Nd4j.rand(new long[]{1,labelSize,tsLength});
    list.add(new DataSet(in,out));
  }
  DataSet merged=DataSet.merge(list);
  assertEquals(numExamples,merged.numExamples());
  INDArray f=merged.getFeatures();
  INDArray l=merged.getLabels();
  assertArrayEquals(new long[]{numExamples,inSize,tsLength},f.shape());
  assertArrayEquals(new long[]{numExamples,labelSize,tsLength},l.shape());
  for (int i=0; i < numExamples; i++) {
    DataSet exp=list.get(i);
    INDArray expIn=exp.getFeatures();
    INDArray expL=exp.getLabels();
    INDArray fSubset=f.get(interval(i,i + 1),all(),all());
    INDArray lSubset=l.get(interval(i,i + 1),all(),all());
    assertEquals(expIn,fSubset);
    assertEquals(expL,lSubset);
  }
}
