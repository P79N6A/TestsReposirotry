@Test public void testAppendingLabelsMetaData() throws Exception {
  ClassPathResource cpr=new ClassPathResource("datavec-api/json/");
  File f=testDir.newFolder();
  cpr.copyDirectory(f);
  String path=new File(f,"json_test_%d.txt").getAbsolutePath();
  InputSplit is=new NumberedFileInputSplit(path,0,2);
  RecordReader rr=new JacksonRecordReader(getFieldSelection(),new ObjectMapper(new JsonFactory()),false,-1,new LabelGen());
  rr.initialize(is);
  List<List<Writable>> out=new ArrayList<>();
  while (rr.hasNext()) {
    out.add(rr.next());
  }
  assertEquals(3,out.size());
  rr.reset();
  List<List<Writable>> out2=new ArrayList<>();
  List<Record> outRecord=new ArrayList<>();
  List<RecordMetaData> meta=new ArrayList<>();
  while (rr.hasNext()) {
    Record r=rr.nextRecord();
    out2.add(r.getRecord());
    outRecord.add(r);
    meta.add(r.getMetaData());
  }
  assertEquals(out,out2);
  List<Record> fromMeta=rr.loadFromMetaData(meta);
  assertEquals(outRecord,fromMeta);
}
