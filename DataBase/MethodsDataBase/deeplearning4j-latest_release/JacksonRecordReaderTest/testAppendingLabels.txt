@Test public void testAppendingLabels() throws Exception {
  ClassPathResource cpr=new ClassPathResource("datavec-api/json/");
  File f=testDir.newFolder();
  cpr.copyDirectory(f);
  String path=new File(f,"json_test_%d.txt").getAbsolutePath();
  InputSplit is=new NumberedFileInputSplit(path,0,2);
  RecordReader rr=new JacksonRecordReader(getFieldSelection(),new ObjectMapper(new JsonFactory()),false,-1,new LabelGen());
  rr.initialize(is);
  List<Writable> exp0=Arrays.asList((Writable)new Text("aValue0"),new Text("bValue0"),new Text("cxValue0"),new IntWritable(0));
  assertEquals(exp0,rr.next());
  List<Writable> exp1=Arrays.asList((Writable)new Text("aValue1"),new Text("MISSING_B"),new Text("cxValue1"),new IntWritable(1));
  assertEquals(exp1,rr.next());
  List<Writable> exp2=Arrays.asList((Writable)new Text("aValue2"),new Text("bValue2"),new Text("MISSING_CX"),new IntWritable(2));
  assertEquals(exp2,rr.next());
  rr=new JacksonRecordReader(getFieldSelection(),new ObjectMapper(new JsonFactory()),false,-1,new LabelGen(),0);
  rr.initialize(is);
  exp0=Arrays.asList((Writable)new IntWritable(0),new Text("aValue0"),new Text("bValue0"),new Text("cxValue0"));
  assertEquals(exp0,rr.next());
  exp1=Arrays.asList((Writable)new IntWritable(1),new Text("aValue1"),new Text("MISSING_B"),new Text("cxValue1"));
  assertEquals(exp1,rr.next());
  exp2=Arrays.asList((Writable)new IntWritable(2),new Text("aValue2"),new Text("bValue2"),new Text("MISSING_CX"));
  assertEquals(exp2,rr.next());
}
