@Test public void test_normal_channel_close_wait_gracefully() throws Exception {
  URL url=URL.valueOf("dubbo://127.0.0.1:20883/hi?scope=true&lazy=false");
  Exporter<IDemoService> exporter=ProtocolUtils.export(new DemoServiceImpl(),IDemoService.class,url);
  Exporter<IDemoService> exporter0=ProtocolUtils.export(new DemoServiceImpl0(),IDemoService.class,url);
  DubboInvoker<?> invoker=(DubboInvoker<?>)protocol.refer(IDemoService.class,url);
  long start=System.currentTimeMillis();
  try {
    System.setProperty(Constants.SHUTDOWN_WAIT_KEY,"2000");
    protocol.destroy();
  }
  finally {
    System.getProperties().remove(Constants.SHUTDOWN_WAIT_KEY);
  }
  long waitTime=System.currentTimeMillis() - start;
  Assert.assertTrue(waitTime >= 2000);
  Assert.assertEquals(false,invoker.isAvailable());
}
