@Test public void testSystemPropertyOverrideProperties() throws Exception {
  String portString=System.getProperty("dubbo.protocol.port");
  System.clearProperty("dubbo.protocol.port");
  try {
    int port=1234;
    System.setProperty("dubbo.protocol.port",String.valueOf(port));
    ApplicationConfig application=new ApplicationConfig();
    application.setName("aaa");
    RegistryConfig registry=new RegistryConfig();
    registry.setAddress("N/A");
    ProtocolConfig protocol=new ProtocolConfig();
    protocol.setName("rmi");
    ServiceConfig<DemoService> service=new ServiceConfig<DemoService>();
    service.setInterface(DemoService.class);
    service.setRef(new DemoServiceImpl());
    service.setApplication(application);
    service.setRegistry(registry);
    service.setProtocol(protocol);
    service.export();
    try {
      URL url=service.toUrls().get(0);
      assertEquals("aaa",url.getParameter("application"));
      assertEquals("world",url.getParameter("owner"));
      assertEquals(1234,url.getPort());
    }
  finally {
      service.unexport();
    }
  }
  finally {
    if (portString != null) {
      System.setProperty("dubbo.protocol.port",portString);
    }
  }
}
