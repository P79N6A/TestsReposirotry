@Test public void testMultiProtocolRegister(){
  SimpleRegistryService registryService=new SimpleRegistryService();
  Exporter<RegistryService> exporter=SimpleRegistryExporter.export(4547,registryService);
  ClassPathXmlApplicationContext ctx=new ClassPathXmlApplicationContext(ConfigTest.class.getPackage().getName().replace('.','/') + "/multi-protocol-register.xml");
  ctx.start();
  try {
    List<URL> urls=registryService.getRegistered().get("com.alibaba.dubbo.config.spring.api.DemoService");
    assertNotNull(urls);
    assertEquals(1,urls.size());
    assertEquals("dubbo://" + NetUtils.getLocalHost() + ":20824/com.alibaba.dubbo.config.spring.api.DemoService",urls.get(0).toIdentityString());
  }
  finally {
    ctx.stop();
    ctx.close();
    exporter.unexport();
  }
}
