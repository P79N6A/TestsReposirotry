@Test public void testDelayOnInitialized() throws Exception {
  SimpleRegistryService registryService=new SimpleRegistryService();
  Exporter<RegistryService> exporter=SimpleRegistryExporter.export(4548,registryService);
  ClassPathXmlApplicationContext ctx=new ClassPathXmlApplicationContext(ConfigTest.class.getPackage().getName().replace('.','/') + "/delay-on-initialized.xml");
  try {
    List<URL> urls=registryService.getRegistered().get("com.alibaba.dubbo.config.spring.api.DemoService");
    assertNotNull(urls);
    assertEquals(1,urls.size());
    assertEquals("dubbo://" + NetUtils.getLocalHost() + ":20888/com.alibaba.dubbo.config.spring.api.DemoService",urls.get(0).toIdentityString());
  }
  finally {
    ctx.stop();
    ctx.close();
    exporter.unexport();
  }
}
