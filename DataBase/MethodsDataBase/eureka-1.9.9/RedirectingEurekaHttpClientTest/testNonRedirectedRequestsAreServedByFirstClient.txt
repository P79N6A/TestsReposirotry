@Test public void testNonRedirectedRequestsAreServedByFirstClient() throws Exception {
  when(factory.newClient(Matchers.<EurekaEndpoint>anyVararg())).thenReturn(sourceClient);
  when(sourceClient.getApplications()).thenReturn(anEurekaHttpResponse(200,new Applications()).type(MediaType.APPLICATION_JSON_TYPE).build());
  RedirectingEurekaHttpClient httpClient=new RedirectingEurekaHttpClient(SERVICE_URL,factory,dnsService);
  httpClient.getApplications();
  verify(factory,times(1)).newClient(Matchers.<EurekaEndpoint>anyVararg());
  verify(sourceClient,times(1)).getApplications();
}
