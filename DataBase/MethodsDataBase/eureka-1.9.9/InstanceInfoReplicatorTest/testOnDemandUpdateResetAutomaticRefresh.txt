@Test public void testOnDemandUpdateResetAutomaticRefresh() throws Throwable {
  replicator.start(0);
  Thread.sleep(1000 * refreshRateSeconds / 2);
  assertTrue(replicator.onDemandUpdate());
  Thread.sleep(1000 * refreshRateSeconds + 50);
  verify(discoveryClient,times(3)).refreshInstanceInfo();
  verify(discoveryClient,times(1)).register();
}
