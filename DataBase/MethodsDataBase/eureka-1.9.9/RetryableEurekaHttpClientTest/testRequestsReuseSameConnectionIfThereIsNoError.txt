@Test public void testRequestsReuseSameConnectionIfThereIsNoError() throws Exception {
  when(clientFactory.newClient(Matchers.<EurekaEndpoint>anyVararg())).thenReturn(clusterDelegates.get(0));
  when(requestExecutor.execute(clusterDelegates.get(0))).thenReturn(EurekaHttpResponse.status(200));
  for (int i=0; i < 3; i++) {
    EurekaHttpResponse<Void> httpResponse=retryableClient.execute(requestExecutor);
    assertThat(httpResponse.getStatusCode(),is(equalTo(200)));
  }
  verify(clientFactory,times(1)).newClient(Matchers.<EurekaEndpoint>anyVararg());
  verify(requestExecutor,times(3)).execute(clusterDelegates.get(0));
}
