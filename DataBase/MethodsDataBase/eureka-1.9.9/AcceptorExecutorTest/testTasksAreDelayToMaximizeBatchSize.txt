@Test public void testTasksAreDelayToMaximizeBatchSize() throws Exception {
  BlockingQueue<List<TaskHolder<Integer,String>>> taskQueue=acceptorExecutor.requestWorkItems();
  acceptorExecutor.process(1,"Task1",System.currentTimeMillis() + 60 * 1000);
  Thread.sleep(MAX_BATCHING_DELAY_MS / 2);
  acceptorExecutor.process(2,"Task2",System.currentTimeMillis() + 60 * 1000);
  List<TaskHolder<Integer,String>> taskHolders=taskQueue.poll(5,TimeUnit.SECONDS);
  assertThat(taskHolders.size(),is(equalTo(2)));
}
