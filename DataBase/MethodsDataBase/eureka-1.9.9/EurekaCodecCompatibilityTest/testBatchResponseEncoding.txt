@Test public void testBatchResponseEncoding() throws Exception {
  List<ReplicationInstanceResponse> responseList=new ArrayList<>();
  responseList.add(new ReplicationInstanceResponse(200,InstanceInfoGenerator.takeOne()));
  final ReplicationListResponse replicationListResponse=new ReplicationListResponse(responseList);
  Action2 codingAction=new Action2(){
    @Override public void call(    EncoderWrapper encodingCodec,    DecoderWrapper decodingCodec) throws IOException {
      String encodedString=encodingCodec.encode(replicationListResponse);
      ReplicationListResponse decodedValue=decodingCodec.decode(encodedString,ReplicationListResponse.class);
      assertThat(decodedValue.getResponseList().size(),is(equalTo(1)));
    }
  }
;
  List<CodecWrapper> jsonCodes=Arrays.asList(new CodecWrappers.JacksonJson(),new CodecWrappers.LegacyJacksonJson());
  verifyAllPairs(codingAction,ReplicationListResponse.class,jsonCodes);
}
