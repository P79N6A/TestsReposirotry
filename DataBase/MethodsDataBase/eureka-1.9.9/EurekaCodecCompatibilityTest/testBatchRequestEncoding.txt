@Test public void testBatchRequestEncoding() throws Exception {
  InstanceInfo instance=InstanceInfoGenerator.takeOne();
  List<ReplicationInstance> replicationInstances=new ArrayList<>();
  replicationInstances.add(new ReplicationInstance(instance.getAppName(),instance.getId(),System.currentTimeMillis(),null,instance.getStatus().name(),instance,Action.Register));
  final ReplicationList replicationList=new ReplicationList(replicationInstances);
  Action2 codingAction=new Action2(){
    @Override public void call(    EncoderWrapper encodingCodec,    DecoderWrapper decodingCodec) throws IOException {
      String encodedString=encodingCodec.encode(replicationList);
      ReplicationList decodedValue=decodingCodec.decode(encodedString,ReplicationList.class);
      assertThat(decodedValue.getReplicationList().size(),is(equalTo(1)));
    }
  }
;
  List<CodecWrapper> jsonCodes=Arrays.asList(new CodecWrappers.JacksonJson(),new CodecWrappers.LegacyJacksonJson());
  verifyAllPairs(codingAction,ReplicationList.class,jsonCodes);
}
