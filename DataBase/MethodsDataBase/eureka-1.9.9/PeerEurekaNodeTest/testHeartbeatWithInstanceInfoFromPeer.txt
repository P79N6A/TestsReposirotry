@Test public void testHeartbeatWithInstanceInfoFromPeer() throws Throwable {
  InstanceInfo instanceInfoFromPeer=ClusterSampleData.newInstanceInfo(2);
  httpReplicationClient.withNetworkStatusCode(200);
  httpReplicationClient.withBatchReply(400);
  httpReplicationClient.withInstanceInfo(instanceInfoFromPeer);
  createPeerEurekaNode().heartbeat(instanceInfo.getAppName(),instanceInfo.getId(),instanceInfo,null,false);
  expectRequestType(RequestType.Batch);
  verify(registry,timeout(1000).times(1)).register(instanceInfoFromPeer,true);
}
