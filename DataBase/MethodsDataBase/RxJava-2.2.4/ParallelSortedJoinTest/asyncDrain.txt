@Test public void asyncDrain(){
  Integer[] values=new Integer[100 * 1000];
  for (int i=0; i < values.length; i++) {
    values[i]=values.length - i;
  }
  TestSubscriber<Integer> ts=Flowable.fromArray(values).parallel(2).runOn(Schedulers.computation()).sorted(Functions.naturalComparator()).observeOn(Schedulers.single()).test();
  ts.awaitDone(5,TimeUnit.SECONDS).assertValueCount(values.length).assertNoErrors().assertComplete();
  List<Integer> list=ts.values();
  for (int i=0; i < values.length; i++) {
    assertEquals(i + 1,list.get(i).intValue());
  }
}
