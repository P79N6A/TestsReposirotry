@Test public void noReentrantDispose(){
  final AtomicInteger disposeCalled=new AtomicInteger();
  final BehaviorSubject<Integer> s=BehaviorSubject.create();
  s.doOnDispose(new Action(){
    @Override public void run() throws Exception {
      disposeCalled.incrementAndGet();
      s.onNext(2);
    }
  }
).firstOrError().subscribe().dispose();
  assertEquals(1,disposeCalled.get());
}
