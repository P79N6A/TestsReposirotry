@Test public void testEarlyUnsubscribe(){
  for (int i=0; i < 10; i++) {
    TestScheduler scheduler1=new TestScheduler();
    AtomicBoolean os1=new AtomicBoolean(false);
    Observable<Long> o1=createObservableOf5IntervalsOf1SecondIncrementsWithSubscriptionHook(scheduler1,os1);
    TestScheduler scheduler2=new TestScheduler();
    AtomicBoolean os2=new AtomicBoolean(false);
    Observable<Long> o2=createObservableOf5IntervalsOf1SecondIncrementsWithSubscriptionHook(scheduler2,os2);
    TestObserver<Long> to=new TestObserver<Long>();
    Observable.merge(o1,o2).subscribe(to);
    to.assertNoValues();
    scheduler1.advanceTimeBy(3,TimeUnit.SECONDS);
    scheduler2.advanceTimeBy(2,TimeUnit.SECONDS);
    to.assertValues(0L,1L,2L,0L,1L);
    assertFalse(os1.get());
    assertFalse(os2.get());
    to.dispose();
    assertTrue(os1.get());
    assertTrue(os2.get());
    to.assertValues(0L,1L,2L,0L,1L);
  }
}
