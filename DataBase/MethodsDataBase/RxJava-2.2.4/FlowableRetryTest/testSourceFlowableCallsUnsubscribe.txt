@Test public void testSourceFlowableCallsUnsubscribe() throws InterruptedException {
  final AtomicInteger subsCount=new AtomicInteger(0);
  final TestSubscriber<String> ts=new TestSubscriber<String>();
  Publisher<String> onSubscribe=new Publisher<String>(){
    @Override public void subscribe(    Subscriber<? super String> s){
      BooleanSubscription bs=new BooleanSubscription();
      if (!bs.isCancelled()) {
        subsCount.incrementAndGet();
        s.onError(new RuntimeException("failed"));
        bs.cancel();
      }
 else {
        s.onError(new RuntimeException());
      }
    }
  }
;
  Flowable.unsafeCreate(onSubscribe).retry(3).subscribe(ts);
  assertEquals(4,subsCount.get());
}
