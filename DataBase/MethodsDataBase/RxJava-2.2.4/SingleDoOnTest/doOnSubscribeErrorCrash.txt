@Test public void doOnSubscribeErrorCrash(){
  List<Throwable> errors=TestHelper.trackPluginErrors();
  try {
    Single.error(new TestException("Outer")).doOnSubscribe(new Consumer<Disposable>(){
      @Override public void accept(      Disposable d) throws Exception {
        throw new TestException("Inner");
      }
    }
).test().assertFailureAndMessage(TestException.class,"Inner");
    TestHelper.assertUndeliverable(errors,0,TestException.class,"Outer");
  }
  finally {
    RxJavaPlugins.reset();
  }
}
