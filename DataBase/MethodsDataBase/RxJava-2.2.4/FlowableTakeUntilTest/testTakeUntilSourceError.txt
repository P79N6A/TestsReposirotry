@Test public void testTakeUntilSourceError(){
  Subscription sSource=mock(Subscription.class);
  Subscription sOther=mock(Subscription.class);
  TestObservable source=new TestObservable(sSource);
  TestObservable other=new TestObservable(sOther);
  Throwable error=new Throwable();
  Subscriber<String> result=TestHelper.mockSubscriber();
  Flowable<String> stringObservable=Flowable.unsafeCreate(source).takeUntil(Flowable.unsafeCreate(other));
  stringObservable.subscribe(result);
  source.sendOnNext("one");
  source.sendOnNext("two");
  source.sendOnError(error);
  source.sendOnNext("three");
  verify(result,times(1)).onNext("one");
  verify(result,times(1)).onNext("two");
  verify(result,times(0)).onNext("three");
  verify(result,times(1)).onError(error);
  verify(sSource,never()).cancel();
  verify(sOther,times(1)).cancel();
}
