@Test public void testDownstreamUnsubscribes(){
  PublishProcessor<Integer> source=PublishProcessor.create();
  PublishProcessor<Integer> until=PublishProcessor.create();
  TestSubscriber<Integer> ts=new TestSubscriber<Integer>();
  source.takeUntil(until).take(1).subscribe(ts);
  assertTrue(source.hasSubscribers());
  assertTrue(until.hasSubscribers());
  source.onNext(1);
  ts.assertValue(1);
  ts.assertNoErrors();
  ts.assertTerminated();
  assertFalse("Source still has observers",source.hasSubscribers());
  assertFalse("Until still has observers",until.hasSubscribers());
  assertFalse("TestSubscriber is unsubscribed",ts.isCancelled());
}
