@Test public void basicWithError(){
  final Disposable d=Disposables.empty();
  Single.<Integer>create(new SingleOnSubscribe<Integer>(){
    @Override public void subscribe(    SingleEmitter<Integer> e) throws Exception {
      e.setDisposable(d);
      e.onError(new TestException());
      e.onSuccess(2);
      e.onError(new TestException());
    }
  }
).test().assertFailure(TestException.class);
  assertTrue(d.isDisposed());
}
