@Test(timeout=5000) public void undeliverableUponCancellation() throws Exception {
  List<Throwable> errors=TestHelper.trackPluginErrors();
  try {
    final TestSubscriber<Integer> ts=new TestSubscriber<Integer>();
    Flowable.fromCallable(new Callable<Integer>(){
      @Override public Integer call() throws Exception {
        ts.cancel();
        throw new TestException();
      }
    }
).subscribe(ts);
    ts.assertEmpty();
    TestHelper.assertUndeliverable(errors,0,TestException.class);
  }
  finally {
    RxJavaPlugins.reset();
  }
}
