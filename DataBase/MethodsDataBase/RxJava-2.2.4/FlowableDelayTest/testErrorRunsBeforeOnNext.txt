@Test public void testErrorRunsBeforeOnNext(){
  TestScheduler test=new TestScheduler();
  PublishProcessor<Integer> pp=PublishProcessor.create();
  TestSubscriber<Integer> ts=new TestSubscriber<Integer>();
  pp.delay(1,TimeUnit.SECONDS,test).subscribe(ts);
  pp.onNext(1);
  test.advanceTimeBy(500,TimeUnit.MILLISECONDS);
  pp.onError(new TestException());
  test.advanceTimeBy(1,TimeUnit.SECONDS);
  ts.assertNoValues();
  ts.assertError(TestException.class);
  ts.assertNotComplete();
}
