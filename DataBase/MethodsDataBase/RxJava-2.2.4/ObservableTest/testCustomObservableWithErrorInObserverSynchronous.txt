/** 
 * The error from the user provided Observer is handled by the subscribe try/catch because this is synchronous. Result: Passes
 */
@Test public void testCustomObservableWithErrorInObserverSynchronous(){
  final AtomicInteger count=new AtomicInteger();
  final AtomicReference<Throwable> error=new AtomicReference<Throwable>();
  Observable.just("1","2","three","4").safeSubscribe(new DefaultObserver<String>(){
    @Override public void onComplete(){
      System.out.println("completed");
    }
    @Override public void onError(    Throwable e){
      error.set(e);
      System.out.println("error");
      e.printStackTrace();
    }
    @Override public void onNext(    String v){
      int num=Integer.parseInt(v);
      System.out.println(num);
      count.incrementAndGet();
    }
  }
);
  assertEquals(2,count.get());
  assertNotNull(error.get());
  if (!(error.get() instanceof NumberFormatException)) {
    fail("It should be a NumberFormatException");
  }
}
