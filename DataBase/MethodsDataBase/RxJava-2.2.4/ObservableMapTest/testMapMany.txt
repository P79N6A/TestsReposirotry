@Test public void testMapMany(){
  Observable<Integer> ids=Observable.just(1,2);
  Observable<String> m=ids.flatMap(new Function<Integer,Observable<String>>(){
    @Override public Observable<String> apply(    Integer id){
      Observable<Map<String,String>> subObservable=null;
      if (id == 1) {
        Map<String,String> m1=getMap("One");
        Map<String,String> m2=getMap("Two");
        subObservable=Observable.just(m1,m2);
      }
 else {
        Map<String,String> m3=getMap("Three");
        Map<String,String> m4=getMap("Four");
        subObservable=Observable.just(m3,m4);
      }
      return subObservable.map(new Function<Map<String,String>,String>(){
        @Override public String apply(        Map<String,String> map){
          return map.get("firstName");
        }
      }
);
    }
  }
);
  m.subscribe(stringObserver);
  verify(stringObserver,never()).onError(any(Throwable.class));
  verify(stringObserver,times(1)).onNext("OneFirst");
  verify(stringObserver,times(1)).onNext("TwoFirst");
  verify(stringObserver,times(1)).onNext("ThreeFirst");
  verify(stringObserver,times(1)).onNext("FourFirst");
  verify(stringObserver,times(1)).onComplete();
}
