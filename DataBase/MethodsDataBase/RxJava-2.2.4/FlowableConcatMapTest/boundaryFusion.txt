@Test public void boundaryFusion(){
  Flowable.range(1,10000).observeOn(Schedulers.single()).map(new Function<Integer,String>(){
    @Override public String apply(    Integer t) throws Exception {
      String name=Thread.currentThread().getName();
      if (name.contains("RxSingleScheduler")) {
        return "RxSingleScheduler";
      }
      return name;
    }
  }
).concatMap(new Function<String,Publisher<? extends Object>>(){
    @Override public Publisher<? extends Object> apply(    String v) throws Exception {
      return Flowable.just(v);
    }
  }
).observeOn(Schedulers.computation()).distinct().test().awaitDone(5,TimeUnit.SECONDS).assertResult("RxSingleScheduler");
}
