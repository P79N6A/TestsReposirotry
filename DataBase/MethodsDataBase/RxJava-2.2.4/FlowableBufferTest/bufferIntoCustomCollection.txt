@SuppressWarnings("unchecked") @Test public void bufferIntoCustomCollection(){
  Flowable.just(1,1,2,2,3,3,4,4).buffer(3,new Callable<Collection<Integer>>(){
    @Override public Collection<Integer> call() throws Exception {
      return new HashSet<Integer>();
    }
  }
).test().assertResult(set(1,2),set(2,3),set(4));
}
