@SuppressWarnings("unchecked") @Test public void noCompletionCancelOverlap(){
  final AtomicInteger counter=new AtomicInteger();
  Flowable.<Integer>empty().doOnCancel(new Action(){
    @Override public void run() throws Exception {
      counter.getAndIncrement();
    }
  }
).buffer(10,5,TimeUnit.SECONDS).test().awaitDone(5,TimeUnit.SECONDS).assertResult(Collections.<Integer>emptyList());
  assertEquals(0,counter.get());
}
