@Test public void boundaryCancel(){
  PublishProcessor<Object> pp=PublishProcessor.create();
  TestSubscriber<Collection<Object>> ts=pp.buffer(Functions.justCallable(Flowable.never()),new Callable<Collection<Object>>(){
    @Override public Collection<Object> call() throws Exception {
      return new ArrayList<Object>();
    }
  }
).test();
  assertTrue(pp.hasSubscribers());
  ts.dispose();
  assertFalse(pp.hasSubscribers());
}
