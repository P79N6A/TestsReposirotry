@Test public void testSequenceOfDelayedActions() throws InterruptedException {
  Scheduler scheduler=getScheduler();
  final Scheduler.Worker inner=scheduler.createWorker();
  try {
    final CountDownLatch latch=new CountDownLatch(1);
    final Runnable first=mock(Runnable.class);
    final Runnable second=mock(Runnable.class);
    inner.schedule(new Runnable(){
      @Override public void run(){
        inner.schedule(first,30,TimeUnit.MILLISECONDS);
        inner.schedule(second,10,TimeUnit.MILLISECONDS);
        inner.schedule(new Runnable(){
          @Override public void run(){
            latch.countDown();
          }
        }
,40,TimeUnit.MILLISECONDS);
      }
    }
);
    latch.await();
    InOrder inOrder=inOrder(first,second);
    inOrder.verify(second,times(1)).run();
    inOrder.verify(first,times(1)).run();
  }
  finally {
    inner.dispose();
  }
}
