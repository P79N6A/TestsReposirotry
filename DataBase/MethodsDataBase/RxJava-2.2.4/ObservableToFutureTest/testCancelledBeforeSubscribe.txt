@Test public void testCancelledBeforeSubscribe() throws Exception {
  @SuppressWarnings("unchecked") Future<Object> future=mock(Future.class);
  CancellationException e=new CancellationException("unit test synthetic cancellation");
  when(future.get()).thenThrow(e);
  Observer<Object> o=TestHelper.mockObserver();
  TestObserver<Object> to=new TestObserver<Object>(o);
  to.dispose();
  Observable.fromFuture(future).subscribe(to);
  to.assertNoErrors();
  to.assertNotComplete();
}
