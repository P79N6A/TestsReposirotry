@Test public void testFailure() throws Exception {
  @SuppressWarnings("unchecked") Future<Object> future=mock(Future.class);
  RuntimeException e=new RuntimeException();
  when(future.get()).thenThrow(e);
  Observer<Object> o=TestHelper.mockObserver();
  TestObserver<Object> to=new TestObserver<Object>(o);
  Observable.fromFuture(future).subscribe(to);
  to.dispose();
  verify(o,never()).onNext(null);
  verify(o,never()).onComplete();
  verify(o,times(1)).onError(e);
  verify(future,never()).cancel(true);
}
