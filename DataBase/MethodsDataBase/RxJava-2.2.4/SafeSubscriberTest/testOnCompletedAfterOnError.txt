/** 
 * Ensure onComplete can not be called after onError.
 */
@Test public void testOnCompletedAfterOnError(){
  TestObservable t=new TestObservable();
  Flowable<String> st=Flowable.unsafeCreate(t);
  Subscriber<String> w=TestHelper.mockSubscriber();
  st.subscribe(new SafeSubscriber<String>(new TestSubscriber<String>(w)));
  t.sendOnNext("one");
  t.sendOnError(new RuntimeException("bad"));
  t.sendOnCompleted();
  verify(w,times(1)).onNext("one");
  verify(w,times(1)).onError(any(Throwable.class));
  verify(w,Mockito.never()).onComplete();
}
