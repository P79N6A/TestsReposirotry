@Test public void delayErrors(){
  PublishProcessor<Publisher<Integer>> source=PublishProcessor.create();
  TestSubscriber<Integer> ts=source.switchMapDelayError(Functions.<Publisher<Integer>>identity()).test();
  ts.assertNoValues().assertNoErrors().assertNotComplete();
  source.onNext(Flowable.just(1));
  source.onNext(Flowable.<Integer>error(new TestException("Forced failure 1")));
  source.onNext(Flowable.just(2,3,4));
  source.onNext(Flowable.<Integer>error(new TestException("Forced failure 2")));
  source.onNext(Flowable.just(5));
  source.onError(new TestException("Forced failure 3"));
  ts.assertValues(1,2,3,4,5).assertNotComplete().assertError(CompositeException.class);
  List<Throwable> errors=ExceptionHelper.flatten(ts.errors().get(0));
  TestHelper.assertError(errors,0,TestException.class,"Forced failure 1");
  TestHelper.assertError(errors,1,TestException.class,"Forced failure 2");
  TestHelper.assertError(errors,2,TestException.class,"Forced failure 3");
}
