@Test public void setOnceAndRequest(){
  AtomicReference<Subscription> ref=new AtomicReference<Subscription>();
  Subscription sub=mock(Subscription.class);
  assertTrue(SubscriptionHelper.setOnce(ref,sub,1));
  verify(sub).request(1);
  verify(sub,never()).cancel();
  List<Throwable> errors=TestHelper.trackPluginErrors();
  try {
    sub=mock(Subscription.class);
    assertFalse(SubscriptionHelper.setOnce(ref,sub,1));
    verify(sub,never()).request(anyLong());
    verify(sub).cancel();
    TestHelper.assertError(errors,0,ProtocolViolationException.class);
  }
  finally {
    RxJavaPlugins.reset();
  }
}
