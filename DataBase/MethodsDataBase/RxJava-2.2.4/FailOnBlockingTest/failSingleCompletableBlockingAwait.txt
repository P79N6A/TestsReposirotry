@Test public void failSingleCompletableBlockingAwait(){
  try {
    RxJavaPlugins.setFailOnNonBlockingScheduler(true);
    Completable.complete().subscribeOn(Schedulers.single()).doOnComplete(new Action(){
      @Override public void run() throws Exception {
        Completable.complete().delay(10,TimeUnit.SECONDS).blockingAwait();
      }
    }
).test().awaitDone(5,TimeUnit.SECONDS).assertFailure(IllegalStateException.class);
  }
  finally {
    RxJavaPlugins.reset();
  }
}
