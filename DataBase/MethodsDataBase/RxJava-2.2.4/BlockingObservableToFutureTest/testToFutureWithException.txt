@Test public void testToFutureWithException(){
  Observable<String> obs=Observable.unsafeCreate(new ObservableSource<String>(){
    @Override public void subscribe(    Observer<? super String> observer){
      observer.onSubscribe(Disposables.empty());
      observer.onNext("one");
      observer.onError(new TestException());
    }
  }
);
  Future<String> f=obs.toFuture();
  try {
    f.get();
    fail("expected exception");
  }
 catch (  Throwable e) {
    assertEquals(TestException.class,e.getCause().getClass());
  }
}
