@Test public void testAwaitTerminalEventWithDurationAndUnsubscribeOnTimeout(){
  TestSubscriber<Object> ts=new TestSubscriber<Object>();
  final AtomicBoolean unsub=new AtomicBoolean(false);
  Flowable.just(1).doOnCancel(new Action(){
    @Override public void run(){
      unsub.set(true);
    }
  }
).delay(1000,TimeUnit.MILLISECONDS).subscribe(ts);
  ts.awaitTerminalEvent(100,TimeUnit.MILLISECONDS);
  ts.dispose();
  assertTrue(unsub.get());
}
