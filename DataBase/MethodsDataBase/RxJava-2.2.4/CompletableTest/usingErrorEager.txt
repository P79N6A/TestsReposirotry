@Test(timeout=5000) public void usingErrorEager(){
  final AtomicInteger dispose=new AtomicInteger();
  Completable c=Completable.using(new Callable<Integer>(){
    @Override public Integer call(){
      return 1;
    }
  }
,new Function<Integer,Completable>(){
    @Override public Completable apply(    Integer v){
      return error.completable;
    }
  }
,new Consumer<Integer>(){
    @Override public void accept(    Integer d){
      dispose.set(d);
    }
  }
);
  final AtomicBoolean disposedFirst=new AtomicBoolean();
  final AtomicBoolean complete=new AtomicBoolean();
  c.subscribe(new CompletableObserver(){
    @Override public void onSubscribe(    Disposable d){
    }
    @Override public void onError(    Throwable e){
      disposedFirst.set(dispose.get() != 0);
    }
    @Override public void onComplete(){
      complete.set(true);
    }
  }
);
  Assert.assertEquals(1,dispose.get());
  Assert.assertTrue("Not disposed first",disposedFirst.get());
  Assert.assertFalse(complete.get());
}
