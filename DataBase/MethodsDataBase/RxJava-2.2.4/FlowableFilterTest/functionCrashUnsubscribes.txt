@Test public void functionCrashUnsubscribes(){
  PublishProcessor<Integer> pp=PublishProcessor.create();
  TestSubscriber<Integer> ts=new TestSubscriber<Integer>();
  pp.filter(new Predicate<Integer>(){
    @Override public boolean test(    Integer v){
      throw new TestException();
    }
  }
).subscribe(ts);
  Assert.assertTrue("Not subscribed?",pp.hasSubscribers());
  pp.onNext(1);
  Assert.assertFalse("Subscribed?",pp.hasSubscribers());
  ts.assertError(TestException.class);
}
