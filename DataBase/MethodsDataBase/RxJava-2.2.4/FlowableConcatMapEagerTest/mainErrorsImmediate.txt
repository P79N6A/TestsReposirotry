@Test public void mainErrorsImmediate(){
  PublishProcessor<Integer> main=PublishProcessor.create();
  final PublishProcessor<Integer> inner=PublishProcessor.create();
  TestSubscriber<Integer> ts=main.concatMapEager(new Function<Integer,Publisher<Integer>>(){
    @Override public Publisher<Integer> apply(    Integer t){
      return inner;
    }
  }
).test();
  main.onNext(1);
  main.onNext(2);
  inner.onNext(2);
  ts.assertValue(2);
  main.onError(new TestException("Forced failure"));
  assertFalse("inner has subscribers?",inner.hasSubscribers());
  inner.onNext(3);
  inner.onComplete();
  ts.assertFailureAndMessage(TestException.class,"Forced failure",2);
}
