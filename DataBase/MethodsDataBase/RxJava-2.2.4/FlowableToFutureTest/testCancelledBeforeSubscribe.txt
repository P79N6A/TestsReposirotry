@Test public void testCancelledBeforeSubscribe() throws Exception {
  @SuppressWarnings("unchecked") Future<Object> future=mock(Future.class);
  CancellationException e=new CancellationException("unit test synthetic cancellation");
  when(future.get()).thenThrow(e);
  Subscriber<Object> subscriber=TestHelper.mockSubscriber();
  TestSubscriber<Object> ts=new TestSubscriber<Object>(subscriber);
  ts.dispose();
  Flowable.fromFuture(future).subscribe(ts);
  ts.assertNoErrors();
  ts.assertNotComplete();
}
