@Test public void testSizedTruncation(){
  SizeBoundReplayBuffer<Integer> buf=new SizeBoundReplayBuffer<Integer>(2);
  List<Integer> values=new ArrayList<Integer>();
  buf.next(1);
  buf.next(2);
  buf.collect(values);
  Assert.assertEquals(Arrays.asList(1,2),values);
  buf.next(3);
  buf.next(4);
  values.clear();
  buf.collect(values);
  Assert.assertEquals(Arrays.asList(3,4),values);
  buf.next(5);
  values.clear();
  buf.collect(values);
  Assert.assertEquals(Arrays.asList(4,5),values);
  Assert.assertFalse(buf.hasCompleted());
  buf.complete();
  values.clear();
  buf.collect(values);
  Assert.assertEquals(Arrays.asList(4,5),values);
  Assert.assertEquals(3,buf.size);
  Assert.assertTrue(buf.hasCompleted());
  Assert.assertFalse(buf.hasError());
}
