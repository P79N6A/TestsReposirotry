/** 
 * Issue #2844: wrong target of request. 
 */
@Test(timeout=3000) public void testRepeatRetarget(){
  final List<Integer> concatBase=new ArrayList<Integer>();
  TestSubscriber<Integer> ts=new TestSubscriber<Integer>();
  Flowable.just(1,2).repeat(5).concatMap(new Function<Integer,Flowable<Integer>>(){
    @Override public Flowable<Integer> apply(    Integer x){
      System.out.println("testRepeatRetarget -> " + x);
      concatBase.add(x);
      return Flowable.<Integer>empty().delay(200,TimeUnit.MILLISECONDS);
    }
  }
).subscribe(ts);
  ts.awaitTerminalEvent();
  ts.assertNoErrors();
  ts.assertNoValues();
  assertEquals(Arrays.asList(1,2,1,2,1,2,1,2,1,2),concatBase);
}
