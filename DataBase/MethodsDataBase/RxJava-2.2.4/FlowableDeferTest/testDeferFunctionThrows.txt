@Test public void testDeferFunctionThrows() throws Exception {
  Callable<Flowable<String>> factory=mock(Callable.class);
  when(factory.call()).thenThrow(new TestException());
  Flowable<String> result=Flowable.defer(factory);
  Subscriber<String> subscriber=TestHelper.mockSubscriber();
  result.subscribe(subscriber);
  verify(subscriber).onError(any(TestException.class));
  verify(subscriber,never()).onNext(any(String.class));
  verify(subscriber,never()).onComplete();
}
