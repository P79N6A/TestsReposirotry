/** 
 * Issue #2844: wrong target of request. 
 */
@Test(timeout=3000) public void testRepeatRetarget(){
  final List<Integer> concatBase=new ArrayList<Integer>();
  TestObserver<Integer> to=new TestObserver<Integer>();
  Observable.just(1,2).repeat(5).concatMap(new Function<Integer,Observable<Integer>>(){
    @Override public Observable<Integer> apply(    Integer x){
      System.out.println("testRepeatRetarget -> " + x);
      concatBase.add(x);
      return Observable.<Integer>empty().delay(200,TimeUnit.MILLISECONDS);
    }
  }
).subscribe(to);
  to.awaitTerminalEvent();
  to.assertNoErrors();
  to.assertNoValues();
  assertEquals(Arrays.asList(1,2,1,2,1,2,1,2,1,2),concatBase);
}
