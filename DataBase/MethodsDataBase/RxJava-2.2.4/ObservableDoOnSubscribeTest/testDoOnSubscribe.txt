@Test public void testDoOnSubscribe() throws Exception {
  final AtomicInteger count=new AtomicInteger();
  Observable<Integer> o=Observable.just(1).doOnSubscribe(new Consumer<Disposable>(){
    @Override public void accept(    Disposable d){
      count.incrementAndGet();
    }
  }
);
  o.subscribe();
  o.subscribe();
  o.subscribe();
  assertEquals(3,count.get());
}
