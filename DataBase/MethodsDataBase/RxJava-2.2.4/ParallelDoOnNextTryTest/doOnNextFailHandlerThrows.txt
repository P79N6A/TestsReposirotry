@SuppressWarnings("unchecked") @Test public void doOnNextFailHandlerThrows(){
  TestSubscriber<Integer> ts=Flowable.range(0,2).parallel(1).doOnNext(new Consumer<Integer>(){
    @Override public void accept(    Integer v) throws Exception {
      if (1 / v < 0) {
        System.out.println("Should not happen!");
      }
    }
  }
,new BiFunction<Long,Throwable,ParallelFailureHandling>(){
    @Override public ParallelFailureHandling apply(    Long n,    Throwable e) throws Exception {
      throw new TestException();
    }
  }
).sequential().test().assertFailure(CompositeException.class);
  TestHelper.assertCompositeExceptions(ts,ArithmeticException.class,TestException.class);
}
