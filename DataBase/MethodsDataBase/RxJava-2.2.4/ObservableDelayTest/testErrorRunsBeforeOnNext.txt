@Test public void testErrorRunsBeforeOnNext(){
  TestScheduler test=new TestScheduler();
  PublishSubject<Integer> ps=PublishSubject.create();
  TestObserver<Integer> to=new TestObserver<Integer>();
  ps.delay(1,TimeUnit.SECONDS,test).subscribe(to);
  ps.onNext(1);
  test.advanceTimeBy(500,TimeUnit.MILLISECONDS);
  ps.onError(new TestException());
  test.advanceTimeBy(1,TimeUnit.SECONDS);
  to.assertNoValues();
  to.assertError(TestException.class);
  to.assertNotComplete();
}
