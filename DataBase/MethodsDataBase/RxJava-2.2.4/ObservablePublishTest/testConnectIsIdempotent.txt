@Test public void testConnectIsIdempotent(){
  final AtomicInteger calls=new AtomicInteger();
  Observable<Integer> source=Observable.unsafeCreate(new ObservableSource<Integer>(){
    @Override public void subscribe(    Observer<? super Integer> t){
      t.onSubscribe(Disposables.empty());
      calls.getAndIncrement();
    }
  }
);
  ConnectableObservable<Integer> conn=source.publish();
  assertEquals(0,calls.get());
  conn.connect();
  conn.connect();
  assertEquals(1,calls.get());
  conn.connect().dispose();
  conn.connect();
  conn.connect();
  assertEquals(2,calls.get());
}
