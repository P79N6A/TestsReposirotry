@Test public void bufferWithTimeThrows(){
  PublishSubject<Integer> source=PublishSubject.create();
  Observable<List<Integer>> result=source.buffer(100,TimeUnit.MILLISECONDS,scheduler);
  Observer<Object> o=TestHelper.mockObserver();
  InOrder inOrder=inOrder(o);
  result.subscribe(o);
  source.onNext(1);
  source.onNext(2);
  scheduler.advanceTimeBy(100,TimeUnit.MILLISECONDS);
  source.onNext(3);
  source.onError(new TestException());
  scheduler.advanceTimeBy(100,TimeUnit.MILLISECONDS);
  inOrder.verify(o).onNext(Arrays.asList(1,2));
  inOrder.verify(o).onError(any(TestException.class));
  inOrder.verifyNoMoreInteractions();
  verify(o,never()).onNext(Arrays.asList(3));
  verify(o,never()).onComplete();
}
