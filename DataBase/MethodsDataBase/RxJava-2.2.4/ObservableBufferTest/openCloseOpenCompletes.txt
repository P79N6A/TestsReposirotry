@Test @SuppressWarnings("unchecked") public void openCloseOpenCompletes(){
  PublishSubject<Integer> source=PublishSubject.create();
  PublishSubject<Integer> openIndicator=PublishSubject.create();
  PublishSubject<Integer> closeIndicator=PublishSubject.create();
  TestObserver<List<Integer>> to=source.buffer(openIndicator,Functions.justFunction(closeIndicator)).test();
  openIndicator.onNext(1);
  assertTrue(closeIndicator.hasObservers());
  openIndicator.onComplete();
  assertTrue(source.hasObservers());
  assertTrue(closeIndicator.hasObservers());
  closeIndicator.onComplete();
  assertFalse(source.hasObservers());
  to.assertResult(Collections.<Integer>emptyList());
}
