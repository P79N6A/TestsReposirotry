@Test public void testReentrantTake(){
  final PublishProcessor<Integer> source=PublishProcessor.create();
  TestSubscriber<Integer> ts=new TestSubscriber<Integer>();
  source.take(1).doOnNext(new Consumer<Integer>(){
    @Override public void accept(    Integer v){
      source.onNext(2);
    }
  }
).subscribe(ts);
  source.onNext(1);
  ts.assertValue(1);
  ts.assertNoErrors();
  ts.assertComplete();
}
