@Test public void fusionRequestedState() throws Exception {
  TestSubscriber<Integer> ts=new TestSubscriber<Integer>(0);
  FlattenIterableSubscriber<Integer,Integer> f=new FlattenIterableSubscriber<Integer,Integer>(ts,Functions.justFunction(Arrays.<Integer>asList(1,2)),128);
  f.onSubscribe(new BooleanSubscription());
  f.fusionMode=QueueFuseable.NONE;
  assertEquals(QueueFuseable.NONE,f.requestFusion(QueueFuseable.SYNC));
  assertEquals(QueueFuseable.NONE,f.requestFusion(QueueFuseable.ASYNC));
  f.fusionMode=QueueFuseable.SYNC;
  assertEquals(QueueFuseable.SYNC,f.requestFusion(QueueFuseable.SYNC));
  assertEquals(QueueFuseable.NONE,f.requestFusion(QueueFuseable.ASYNC));
}
