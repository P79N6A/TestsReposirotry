@Test public void testToFutureWithException(){
  Flowable<String> obs=Flowable.unsafeCreate(new Publisher<String>(){
    @Override public void subscribe(    Subscriber<? super String> subscriber){
      subscriber.onSubscribe(new BooleanSubscription());
      subscriber.onNext("one");
      subscriber.onError(new TestException());
    }
  }
);
  Future<String> f=obs.toFuture();
  try {
    f.get();
    fail("expected exception");
  }
 catch (  Throwable e) {
    assertEquals(TestException.class,e.getCause().getClass());
  }
}
