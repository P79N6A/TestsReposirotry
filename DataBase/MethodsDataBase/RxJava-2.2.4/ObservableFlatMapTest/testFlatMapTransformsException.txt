@Test public void testFlatMapTransformsException(){
  Observable<Integer> onNext=Observable.fromIterable(Arrays.asList(1,2,3));
  Observable<Integer> onComplete=Observable.fromIterable(Arrays.asList(4));
  Observable<Integer> onError=Observable.fromIterable(Arrays.asList(5));
  Observable<Integer> source=Observable.concat(Observable.fromIterable(Arrays.asList(10,20,30)),Observable.<Integer>error(new RuntimeException("Forced failure!")));
  Observer<Object> o=TestHelper.mockObserver();
  source.flatMap(just(onNext),just(onError),just0(onComplete)).subscribe(o);
  verify(o,times(3)).onNext(1);
  verify(o,times(3)).onNext(2);
  verify(o,times(3)).onNext(3);
  verify(o).onNext(5);
  verify(o).onComplete();
  verify(o,never()).onNext(4);
  verify(o,never()).onError(any(Throwable.class));
}
