@Test public void testUnsubscribesFromUpstreamObservable(){
  final AtomicBoolean unsub=new AtomicBoolean();
  Observable.range(1,10).concatWith(Observable.<Integer>never()).doOnDispose(new Action(){
    @Override public void run(){
      unsub.set(true);
    }
  }
).ignoreElements().toObservable().subscribe().dispose();
  assertTrue(unsub.get());
}
