@Test public void testUnsubscribeAll(){
  PublishSubject<Integer> source=PublishSubject.create();
  PublishSubject<Integer> open=PublishSubject.create();
  final PublishSubject<Integer> close=PublishSubject.create();
  TestObserver<Observable<Integer>> to=new TestObserver<Observable<Integer>>();
  source.window(open,new Function<Integer,Observable<Integer>>(){
    @Override public Observable<Integer> apply(    Integer t){
      return close;
    }
  }
).subscribe(to);
  open.onNext(1);
  assertTrue(open.hasObservers());
  assertTrue(close.hasObservers());
  to.dispose();
  assertTrue(open.hasObservers());
  assertTrue(close.hasObservers());
}
