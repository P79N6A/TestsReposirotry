@Test public void testDeferFunctionThrows() throws Exception {
  Callable<Observable<String>> factory=mock(Callable.class);
  when(factory.call()).thenThrow(new TestException());
  Observable<String> result=Observable.defer(factory);
  Observer<String> o=TestHelper.mockObserver();
  result.subscribe(o);
  verify(o).onError(any(TestException.class));
  verify(o,never()).onNext(any(String.class));
  verify(o,never()).onComplete();
}
