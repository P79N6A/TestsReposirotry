@Test public void whenCounted(){
  final int[] counter={0};
  Completable.fromAction(new Action(){
    @Override public void run() throws Exception {
      counter[0]++;
    }
  }
).repeatWhen(new Function<Flowable<Object>,Publisher<Object>>(){
    @Override public Publisher<Object> apply(    Flowable<Object> f) throws Exception {
      final int[] j={3};
      return f.takeWhile(new Predicate<Object>(){
        @Override public boolean test(        Object v) throws Exception {
          return j[0]-- != 0;
        }
      }
);
    }
  }
).subscribe();
  assertEquals(4,counter[0]);
}
