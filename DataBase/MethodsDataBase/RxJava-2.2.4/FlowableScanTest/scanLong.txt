@Test public void scanLong(){
  int n=2 * Flowable.bufferSize();
  for (int b=1; b <= n; b*=2) {
    List<Integer> list=Flowable.range(1,n).scan(0,new BiFunction<Integer,Integer,Integer>(){
      @Override public Integer apply(      Integer a,      Integer b) throws Exception {
        return b;
      }
    }
).rebatchRequests(b).toList().blockingGet();
    for (int i=0; i <= n; i++) {
      assertEquals(i,list.get(i).intValue());
    }
  }
}
