@Test public void testSwitchWithSubsequenceError(){
  Observable<Observable<String>> source=Observable.unsafeCreate(new ObservableSource<Observable<String>>(){
    @Override public void subscribe(    Observer<? super Observable<String>> observer){
      observer.onSubscribe(Disposables.empty());
      publishNext(observer,50,Observable.unsafeCreate(new ObservableSource<String>(){
        @Override public void subscribe(        Observer<? super String> observer){
          observer.onSubscribe(Disposables.empty());
          publishNext(observer,50,"one");
          publishNext(observer,100,"two");
        }
      }
));
      publishNext(observer,130,Observable.unsafeCreate(new ObservableSource<String>(){
        @Override public void subscribe(        Observer<? super String> observer){
          observer.onSubscribe(Disposables.empty());
          publishError(observer,0,new TestException());
        }
      }
));
      publishNext(observer,150,Observable.unsafeCreate(new ObservableSource<String>(){
        @Override public void subscribe(        Observer<? super String> observer){
          observer.onSubscribe(Disposables.empty());
          publishNext(observer,50,"three");
        }
      }
));
    }
  }
);
  Observable<String> sampled=Observable.switchOnNext(source);
  sampled.subscribe(observer);
  InOrder inOrder=inOrder(observer);
  scheduler.advanceTimeTo(90,TimeUnit.MILLISECONDS);
  inOrder.verify(observer,never()).onNext(anyString());
  verify(observer,never()).onComplete();
  verify(observer,never()).onError(any(Throwable.class));
  scheduler.advanceTimeTo(125,TimeUnit.MILLISECONDS);
  inOrder.verify(observer,times(1)).onNext("one");
  verify(observer,never()).onComplete();
  verify(observer,never()).onError(any(Throwable.class));
  scheduler.advanceTimeTo(250,TimeUnit.MILLISECONDS);
  inOrder.verify(observer,never()).onNext("three");
  verify(observer,never()).onComplete();
  verify(observer,times(1)).onError(any(TestException.class));
}
