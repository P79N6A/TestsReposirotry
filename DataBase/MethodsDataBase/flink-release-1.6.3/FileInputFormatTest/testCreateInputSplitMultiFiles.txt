@Test public void testCreateInputSplitMultiFiles() throws IOException {
  String tempFile1=TestFileUtils.createTempFile(21);
  String tempFile2=TestFileUtils.createTempFile(22);
  String tempFile3=TestFileUtils.createTempFile(23);
  FileInputFormat fif=new MultiDummyFileInputFormat();
  fif.setFilePaths(tempFile1,tempFile2,tempFile3);
  fif.configure(new Configuration());
  FileInputSplit[] splits=fif.createInputSplits(3);
  int numSplitsFile1=0;
  int numSplitsFile2=0;
  int numSplitsFile3=0;
  Assert.assertEquals(3,splits.length);
  for (  FileInputSplit fis : splits) {
    Assert.assertEquals(0,fis.getStart());
    if (fis.getPath().toString().equals(tempFile1)) {
      numSplitsFile1++;
      Assert.assertEquals(21,fis.getLength());
    }
 else     if (fis.getPath().toString().equals(tempFile2)) {
      numSplitsFile2++;
      Assert.assertEquals(22,fis.getLength());
    }
 else     if (fis.getPath().toString().equals(tempFile3)) {
      numSplitsFile3++;
      Assert.assertEquals(23,fis.getLength());
    }
 else {
      Assert.fail("Got split for unknown file.");
    }
  }
  Assert.assertEquals(1,numSplitsFile1);
  Assert.assertEquals(1,numSplitsFile2);
  Assert.assertEquals(1,numSplitsFile3);
}
