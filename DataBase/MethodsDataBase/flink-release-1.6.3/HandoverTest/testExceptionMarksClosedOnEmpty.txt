@Test public void testExceptionMarksClosedOnEmpty() throws Exception {
  final Handover handover=new Handover();
  IllegalStateException error=new IllegalStateException();
  handover.reportError(error);
  try {
    handover.produce(createTestRecords());
    fail("should throw an exception");
  }
 catch (  Handover.ClosedException e) {
  }
}
