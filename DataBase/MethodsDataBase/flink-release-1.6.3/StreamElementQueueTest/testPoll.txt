@Test public void testPoll() throws InterruptedException {
  OperatorActions operatorActions=mock(OperatorActions.class);
  StreamElementQueue queue=createStreamElementQueue(2,operatorActions);
  WatermarkQueueEntry watermarkQueueEntry=new WatermarkQueueEntry(new Watermark(0L));
  StreamRecordQueueEntry<Integer> streamRecordQueueEntry=new StreamRecordQueueEntry<>(new StreamRecord<>(42,1L));
  queue.put(watermarkQueueEntry);
  queue.put(streamRecordQueueEntry);
  Assert.assertEquals(watermarkQueueEntry,queue.peekBlockingly());
  Assert.assertEquals(2,queue.size());
  Assert.assertEquals(watermarkQueueEntry,queue.poll());
  Assert.assertEquals(1,queue.size());
  streamRecordQueueEntry.complete(Collections.<Integer>emptyList());
  Assert.assertEquals(streamRecordQueueEntry,queue.poll());
  Assert.assertEquals(0,queue.size());
  Assert.assertTrue(queue.isEmpty());
  verify(operatorActions,never()).failOperator(any(Exception.class));
}
