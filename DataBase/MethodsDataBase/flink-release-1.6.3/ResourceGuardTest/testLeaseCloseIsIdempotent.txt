@Test public void testLeaseCloseIsIdempotent() throws Exception {
  ResourceGuard resourceGuard=new ResourceGuard();
  ResourceGuard.Lease lease1=resourceGuard.acquireResource();
  ResourceGuard.Lease lease2=resourceGuard.acquireResource();
  Assert.assertEquals(2,resourceGuard.getLeaseCount());
  lease1.close();
  Assert.assertEquals(1,resourceGuard.getLeaseCount());
  lease1.close();
  Assert.assertEquals(1,resourceGuard.getLeaseCount());
  lease2.close();
  Assert.assertEquals(0,resourceGuard.getLeaseCount());
  ResourceGuard.Lease lease3=resourceGuard.acquireResource();
  Assert.assertEquals(1,resourceGuard.getLeaseCount());
  lease2.close();
  Assert.assertEquals(1,resourceGuard.getLeaseCount());
  lease3.close();
  Assert.assertEquals(0,resourceGuard.getLeaseCount());
  resourceGuard.close();
}
