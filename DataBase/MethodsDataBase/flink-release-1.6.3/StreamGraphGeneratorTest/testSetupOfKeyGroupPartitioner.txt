/** 
 * Tests that the KeyGroupStreamPartitioner are properly set up with the correct value of maximum parallelism.
 */
@Test public void testSetupOfKeyGroupPartitioner(){
  int maxParallelism=42;
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.getConfig().setMaxParallelism(maxParallelism);
  DataStream<Integer> source=env.fromElements(1,2,3);
  DataStream<Integer> keyedResult=source.keyBy(value -> value).map(new NoOpIntMap());
  keyedResult.addSink(new DiscardingSink<>());
  StreamGraph graph=env.getStreamGraph();
  StreamNode keyedResultNode=graph.getStreamNode(keyedResult.getId());
  StreamPartitioner<?> streamPartitioner=keyedResultNode.getInEdges().get(0).getPartitioner();
}
