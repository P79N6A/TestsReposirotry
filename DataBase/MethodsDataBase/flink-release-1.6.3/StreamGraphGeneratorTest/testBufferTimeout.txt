@Test public void testBufferTimeout(){
  final StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setBufferTimeout(77);
  env.fromElements(1,2,3,4,5).map(value -> value).setBufferTimeout(-1).name("A").map(value -> value).setBufferTimeout(0).name("B").map(value -> value).setBufferTimeout(12).name("C").map(value -> value).name("D");
  final StreamGraph sg=env.getStreamGraph();
  for (  StreamNode node : sg.getStreamNodes()) {
switch (node.getOperatorName()) {
case "A":
      assertEquals(77L,node.getBufferTimeout().longValue());
    break;
case "B":
  assertEquals(0L,node.getBufferTimeout().longValue());
break;
case "C":
assertEquals(12L,node.getBufferTimeout().longValue());
break;
case "D":
assertEquals(77L,node.getBufferTimeout().longValue());
break;
default :
assertTrue(node.getOperator() instanceof StreamSource);
}
}
}
