/** 
 * Test whether an  {@link OutputTypeConfigurable} implementation gets called with the correctoutput type. In this test case the output type must be BasicTypeInfo.INT_TYPE_INFO.
 */
@Test public void testOutputTypeConfigurationWithOneInputTransformation() throws Exception {
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<Integer> source=env.fromElements(1,10);
  OutputTypeConfigurableOperationWithOneInput outputTypeConfigurableOperation=new OutputTypeConfigurableOperationWithOneInput();
  DataStream<Integer> result=source.transform("Single input and output type configurable operation",BasicTypeInfo.INT_TYPE_INFO,outputTypeConfigurableOperation);
  result.addSink(new DiscardingSink<>());
  env.getStreamGraph();
  assertEquals(BasicTypeInfo.INT_TYPE_INFO,outputTypeConfigurableOperation.getTypeInformation());
}
