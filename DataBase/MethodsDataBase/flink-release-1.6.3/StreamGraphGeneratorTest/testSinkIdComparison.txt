/** 
 * Tests that the json generated by JSONGenerator shall meet with 2 requirements: 1. sink nodes are at the back 2. if both two nodes are sink nodes or neither of them is sink node, then sort by its id.
 */
@Test public void testSinkIdComparison(){
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<Integer> source=env.fromElements(1,2,3);
  for (int i=0; i < 32; i++) {
    if (i % 2 == 0) {
      source.addSink(new SinkFunction<Integer>(){
        @Override public void invoke(        Integer value,        Context ctx) throws Exception {
        }
      }
);
    }
 else {
      source.map(x -> x + 1);
    }
  }
  env.getStreamGraph().getStreamingPlanAsJSON();
}
