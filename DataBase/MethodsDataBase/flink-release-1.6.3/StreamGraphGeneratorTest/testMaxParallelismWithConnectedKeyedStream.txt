/** 
 * Tests that the max parallelism is properly set for connected streams.
 */
@Test public void testMaxParallelismWithConnectedKeyedStream(){
  int maxParallelism=42;
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<Integer> input1=env.fromElements(1,2,3,4).setMaxParallelism(128);
  DataStream<Integer> input2=env.fromElements(1,2,3,4).setMaxParallelism(129);
  env.getConfig().setMaxParallelism(maxParallelism);
  DataStream<Integer> keyedResult=input1.connect(input2).keyBy(value -> value,value -> value).map(new NoOpIntCoMap());
  keyedResult.addSink(new DiscardingSink<>());
  StreamGraph graph=env.getStreamGraph();
  StreamNode keyedResultNode=graph.getStreamNode(keyedResult.getId());
  StreamPartitioner<?> streamPartitioner1=keyedResultNode.getInEdges().get(0).getPartitioner();
  StreamPartitioner<?> streamPartitioner2=keyedResultNode.getInEdges().get(1).getPartitioner();
}
