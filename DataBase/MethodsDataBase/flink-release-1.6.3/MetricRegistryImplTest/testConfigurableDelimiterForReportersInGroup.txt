@Test public void testConfigurableDelimiterForReportersInGroup() throws Exception {
  Configuration config=new Configuration();
  config.setString(ConfigConstants.METRICS_REPORTER_PREFIX + "test1." + ConfigConstants.METRICS_REPORTER_SCOPE_DELIMITER,"_");
  config.setString(ConfigConstants.METRICS_REPORTER_PREFIX + "test1." + ConfigConstants.METRICS_REPORTER_CLASS_SUFFIX,TestReporter8.class.getName());
  config.setString(ConfigConstants.METRICS_REPORTER_PREFIX + "test2." + ConfigConstants.METRICS_REPORTER_SCOPE_DELIMITER,"-");
  config.setString(ConfigConstants.METRICS_REPORTER_PREFIX + "test2." + ConfigConstants.METRICS_REPORTER_CLASS_SUFFIX,TestReporter8.class.getName());
  config.setString(ConfigConstants.METRICS_REPORTER_PREFIX + "test3." + ConfigConstants.METRICS_REPORTER_SCOPE_DELIMITER,"AA");
  config.setString(ConfigConstants.METRICS_REPORTER_PREFIX + "test3." + ConfigConstants.METRICS_REPORTER_CLASS_SUFFIX,TestReporter8.class.getName());
  config.setString(ConfigConstants.METRICS_REPORTER_PREFIX + "test4." + ConfigConstants.METRICS_REPORTER_CLASS_SUFFIX,TestReporter8.class.getName());
  config.setString(MetricOptions.SCOPE_NAMING_TM,"A.B");
  MetricRegistryImpl registry=new MetricRegistryImpl(MetricRegistryConfiguration.fromConfiguration(config));
  List<MetricReporter> reporters=registry.getReporters();
  ((TestReporter8)reporters.get(0)).expectedDelimiter='_';
  ((TestReporter8)reporters.get(1)).expectedDelimiter='-';
  ((TestReporter8)reporters.get(2)).expectedDelimiter=GLOBAL_DEFAULT_DELIMITER;
  ((TestReporter8)reporters.get(3)).expectedDelimiter=GLOBAL_DEFAULT_DELIMITER;
  TaskManagerMetricGroup group=new TaskManagerMetricGroup(registry,"host","id");
  group.counter("C");
  group.close();
  registry.shutdown().get();
  assertEquals(4,TestReporter8.numCorrectDelimitersForRegister);
  assertEquals(4,TestReporter8.numCorrectDelimitersForUnregister);
}
