/** 
 * This test validates that the factory can be instantiated and configured even when Hadoop classes are missing from the classpath.
 */
@Test public void testHadoopFactoryInstantiationWithoutHadoop() throws Exception {
  final String testClassName="org.apache.flink.runtime.fs.hdfs.HadoopFreeTests";
  URLClassLoader parent=(URLClassLoader)getClass().getClassLoader();
  ClassLoader hadoopFreeClassLoader=new HadoopFreeClassLoader(parent);
  Class<?> testClass=Class.forName(testClassName,false,hadoopFreeClassLoader);
  Method m=testClass.getDeclaredMethod("test");
  try {
    m.invoke(null);
  }
 catch (  InvocationTargetException e) {
    ExceptionUtils.rethrowException(e.getTargetException(),"exception in method");
  }
}
