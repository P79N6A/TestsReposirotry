@Test public void testReadNestedListFile() throws Exception {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_NESTEDLIST),TEST_SCHEMA_NESTEDLIST,new Configuration());
  FileInputSplit[] splits=rowOrcInputFormat.createInputSplits(1);
  assertEquals(1,splits.length);
  rowOrcInputFormat.openInputFormat();
  rowOrcInputFormat.open(splits[0]);
  assertFalse(rowOrcInputFormat.reachedEnd());
  Row row=null;
  long cnt=0;
  while (!rowOrcInputFormat.reachedEnd()) {
    row=rowOrcInputFormat.nextRecord(row);
    assertEquals(1,row.getArity());
    Object[] list=(Object[])row.getField(0);
    assertEquals(1,list.length);
    Row[] nestedRows=(Row[])list[0];
    assertEquals(1,nestedRows.length);
    assertEquals(1,nestedRows[0].getArity());
    assertEquals(cnt,nestedRows[0].getField(0));
    cnt++;
  }
  assertEquals(100,cnt);
}
