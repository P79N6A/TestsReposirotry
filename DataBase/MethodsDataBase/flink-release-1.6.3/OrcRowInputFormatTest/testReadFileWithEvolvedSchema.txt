@Test public void testReadFileWithEvolvedSchema() throws IOException {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_FLAT),"struct<_col0:int,_col1:string,_col4:string,_col3:string>",new Configuration());
  rowOrcInputFormat.selectFields(3,0,2);
  rowOrcInputFormat.addPredicate(new OrcRowInputFormat.LessThan("_col0",PredicateLeaf.Type.LONG,10L));
  FileInputSplit[] splits=rowOrcInputFormat.createInputSplits(1);
  assertEquals(1,splits.length);
  rowOrcInputFormat.openInputFormat();
  rowOrcInputFormat.open(splits[0]);
  assertFalse(rowOrcInputFormat.reachedEnd());
  Row row=rowOrcInputFormat.nextRecord(null);
  assertNotNull(row);
  assertEquals(3,row.getArity());
  assertEquals("Primary",row.getField(0));
  assertEquals(1,row.getField(1));
  assertEquals("M",row.getField(2));
  long cnt=1;
  while (!rowOrcInputFormat.reachedEnd()) {
    assertNotNull(rowOrcInputFormat.nextRecord(null));
    cnt++;
  }
  assertEquals(5000,cnt);
}
