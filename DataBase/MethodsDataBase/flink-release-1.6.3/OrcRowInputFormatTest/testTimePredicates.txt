@Test public void testTimePredicates() throws Exception {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_TIMETYPES),TEST_SCHEMA_TIMETYPES,new Configuration());
  rowOrcInputFormat.addPredicate(new OrcRowInputFormat.Or(new OrcRowInputFormat.Equals("time",PredicateLeaf.Type.TIMESTAMP,Timestamp.valueOf("1900-05-05 12:34:56.100")),new OrcRowInputFormat.Equals("date",PredicateLeaf.Type.DATE,Date.valueOf("1900-12-25"))));
  FileInputSplit[] splits=rowOrcInputFormat.createInputSplits(1);
  rowOrcInputFormat.openInputFormat();
  OrcRowInputFormat spy=spy(rowOrcInputFormat);
  Reader.Options options=new Reader.Options();
  doReturn(options).when(spy).getOptions(any());
  spy.openInputFormat();
  spy.open(splits[0]);
  SearchArgument sarg=options.getSearchArgument();
  assertNotNull(sarg);
  assertEquals("(or leaf-0 leaf-1)",sarg.getExpression().toString());
  assertEquals(2,sarg.getLeaves().size());
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals("(EQUALS time 1900-05-05 12:34:56.1)",leaves.get(0).toString());
  assertEquals("(EQUALS date 1900-12-25)",leaves.get(1).toString());
}
