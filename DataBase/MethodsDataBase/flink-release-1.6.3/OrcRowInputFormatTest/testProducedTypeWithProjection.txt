@Test public void testProducedTypeWithProjection() throws IOException {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_NESTED),TEST_SCHEMA_NESTED,new Configuration());
  rowOrcInputFormat.selectFields(9,3,7,10);
  assertTrue(rowOrcInputFormat.getProducedType() instanceof RowTypeInfo);
  RowTypeInfo producedType=(RowTypeInfo)rowOrcInputFormat.getProducedType();
  assertArrayEquals(new TypeInformation[]{Types.ROW_NAMED(new String[]{"list"},ObjectArrayTypeInfo.getInfoFor(Types.ROW_NAMED(new String[]{"int1","string1"},Types.INT,Types.STRING))),Types.INT,PrimitiveArrayTypeInfo.BYTE_PRIMITIVE_ARRAY_TYPE_INFO,ObjectArrayTypeInfo.getInfoFor(Types.ROW_NAMED(new String[]{"int1","string1"},Types.INT,Types.STRING))},producedType.getFieldTypes());
  assertArrayEquals(new String[]{"middle","int1","bytes1","list"},producedType.getFieldNames());
}
