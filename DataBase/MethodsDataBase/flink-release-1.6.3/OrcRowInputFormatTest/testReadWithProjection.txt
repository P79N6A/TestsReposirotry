@Test public void testReadWithProjection() throws IOException {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_NESTED),TEST_SCHEMA_NESTED,new Configuration());
  rowOrcInputFormat.selectFields(7,0,10,8);
  FileInputSplit[] splits=rowOrcInputFormat.createInputSplits(1);
  assertEquals(1,splits.length);
  rowOrcInputFormat.openInputFormat();
  rowOrcInputFormat.open(splits[0]);
  assertFalse(rowOrcInputFormat.reachedEnd());
  Row row=rowOrcInputFormat.nextRecord(null);
  assertNotNull(row);
  assertEquals(4,row.getArity());
  assertArrayEquals(new byte[]{0,1,2,3,4},(byte[])row.getField(0));
  assertEquals(false,row.getField(1));
  assertTrue(row.getField(2) instanceof Object[]);
  Object[] list1=(Object[])row.getField(2);
  assertEquals(2,list1.length);
  assertEquals(Row.of(3,"good"),list1[0]);
  assertEquals(Row.of(4,"bad"),list1[1]);
  assertEquals("hi",row.getField(3));
  assertFalse(rowOrcInputFormat.reachedEnd());
  row=rowOrcInputFormat.nextRecord(null);
  assertNotNull(row);
  assertEquals(4,row.getArity());
  assertTrue(rowOrcInputFormat.reachedEnd());
}
