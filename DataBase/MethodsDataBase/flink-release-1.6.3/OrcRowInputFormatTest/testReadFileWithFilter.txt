@Test public void testReadFileWithFilter() throws IOException {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_FLAT),TEST_SCHEMA_FLAT,new Configuration());
  rowOrcInputFormat.selectFields(0,1);
  rowOrcInputFormat.addPredicate(new OrcRowInputFormat.Or(new OrcRowInputFormat.LessThan("_col0",PredicateLeaf.Type.LONG,10L),new OrcRowInputFormat.Not(new OrcRowInputFormat.LessThanEquals("_col0",PredicateLeaf.Type.LONG,1920000L))));
  rowOrcInputFormat.addPredicate(new OrcRowInputFormat.Equals("_col1",PredicateLeaf.Type.STRING,"M"));
  FileInputSplit[] splits=rowOrcInputFormat.createInputSplits(1);
  assertEquals(1,splits.length);
  rowOrcInputFormat.openInputFormat();
  rowOrcInputFormat.open(splits[0]);
  long cnt=0;
  while (!rowOrcInputFormat.reachedEnd()) {
    assertNotNull(rowOrcInputFormat.nextRecord(null));
    cnt++;
  }
  assertEquals(5800,cnt);
}
