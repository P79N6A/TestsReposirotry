@Test public void testSerialization() throws Exception {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_FLAT),TEST_SCHEMA_FLAT,new Configuration());
  rowOrcInputFormat.selectFields(0,4,1);
  rowOrcInputFormat.addPredicate(new OrcRowInputFormat.Equals("_col1",PredicateLeaf.Type.STRING,"M"));
  byte[] bytes=InstantiationUtil.serializeObject(rowOrcInputFormat);
  OrcRowInputFormat copy=InstantiationUtil.deserializeObject(bytes,getClass().getClassLoader());
  FileInputSplit[] splits=copy.createInputSplits(1);
  copy.openInputFormat();
  copy.open(splits[0]);
  assertFalse(copy.reachedEnd());
  Row row=copy.nextRecord(null);
  assertNotNull(row);
  assertEquals(3,row.getArity());
  assertEquals(1,row.getField(0));
  assertEquals(500,row.getField(1));
  assertEquals("M",row.getField(2));
}
