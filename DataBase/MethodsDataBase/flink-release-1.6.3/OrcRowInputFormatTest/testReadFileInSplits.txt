@Test public void testReadFileInSplits() throws IOException {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_FLAT),TEST_SCHEMA_FLAT,new Configuration());
  rowOrcInputFormat.selectFields(0,1);
  FileInputSplit[] splits=rowOrcInputFormat.createInputSplits(4);
  assertEquals(4,splits.length);
  rowOrcInputFormat.openInputFormat();
  long cnt=0;
  for (  FileInputSplit split : splits) {
    rowOrcInputFormat.open(split);
    while (!rowOrcInputFormat.reachedEnd()) {
      assertNotNull(rowOrcInputFormat.nextRecord(null));
      cnt++;
    }
  }
  assertEquals(1920800,cnt);
}
