@Test public void testDecimalPredicate() throws Exception {
  rowOrcInputFormat=new OrcRowInputFormat(getPath(TEST_FILE_DECIMAL),TEST_SCHEMA_DECIMAL,new Configuration());
  rowOrcInputFormat.addPredicate(new OrcRowInputFormat.Not(new OrcRowInputFormat.Equals("_col0",PredicateLeaf.Type.DECIMAL,BigDecimal.valueOf(-1000.5))));
  FileInputSplit[] splits=rowOrcInputFormat.createInputSplits(1);
  rowOrcInputFormat.openInputFormat();
  OrcRowInputFormat spy=spy(rowOrcInputFormat);
  Reader.Options options=new Reader.Options();
  doReturn(options).when(spy).getOptions(any());
  spy.openInputFormat();
  spy.open(splits[0]);
  SearchArgument sarg=options.getSearchArgument();
  assertNotNull(sarg);
  assertEquals("(not leaf-0)",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals("(EQUALS _col0 -1000.5)",leaves.get(0).toString());
}
