/** 
 * Tests that suspends discards all checkpoints (as they cannot be recovered later in standalone recovery mode).
 */
@Test public void testSuspendDiscardsCheckpoints() throws Exception {
  SharedStateRegistry sharedStateRegistry=new SharedStateRegistry();
  CompletedCheckpointStore store=createCompletedCheckpoints(1);
  TestCompletedCheckpoint checkpoint=createCheckpoint(0,sharedStateRegistry);
  Collection<OperatorState> taskStates=checkpoint.getOperatorStates().values();
  store.addCheckpoint(checkpoint);
  assertEquals(1,store.getNumberOfRetainedCheckpoints());
  verifyCheckpointRegistered(taskStates,sharedStateRegistry);
  store.shutdown(JobStatus.SUSPENDED);
  assertEquals(0,store.getNumberOfRetainedCheckpoints());
  assertTrue(checkpoint.isDiscarded());
  verifyCheckpointDiscarded(taskStates);
}
