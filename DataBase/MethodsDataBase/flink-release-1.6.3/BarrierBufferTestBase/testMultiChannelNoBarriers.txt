/** 
 * Validates that the buffer behaves correctly if no checkpoint barriers come, for an input with multiple input channels.
 */
@Test public void testMultiChannelNoBarriers() throws Exception {
  BufferOrEvent[] sequence={createBuffer(2,PAGE_SIZE),createBuffer(2,PAGE_SIZE),createBuffer(0,PAGE_SIZE),createBuffer(1,PAGE_SIZE),createBuffer(0,PAGE_SIZE),createEndOfPartition(0),createBuffer(3,PAGE_SIZE),createBuffer(1,PAGE_SIZE),createEndOfPartition(3),createBuffer(1,PAGE_SIZE),createEndOfPartition(1),createBuffer(2,PAGE_SIZE),createEndOfPartition(2)};
  MockInputGate gate=new MockInputGate(PAGE_SIZE,4,Arrays.asList(sequence));
  BarrierBuffer buffer=createBarrierHandler(gate);
  for (  BufferOrEvent boe : sequence) {
    assertEquals(boe,buffer.getNextNonBlocked());
  }
  assertEquals(0L,buffer.getAlignmentDurationNanos());
  assertNull(buffer.getNextNonBlocked());
  assertNull(buffer.getNextNonBlocked());
  buffer.cleanup();
}
