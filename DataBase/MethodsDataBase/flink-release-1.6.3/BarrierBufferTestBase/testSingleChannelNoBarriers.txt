/** 
 * Validates that the buffer behaves correctly if no checkpoint barriers come, for a single input channel.
 */
@Test public void testSingleChannelNoBarriers() throws Exception {
  BufferOrEvent[] sequence={createBuffer(0,PAGE_SIZE),createBuffer(0,PAGE_SIZE),createBuffer(0,PAGE_SIZE),createEndOfPartition(0)};
  MockInputGate gate=new MockInputGate(PAGE_SIZE,1,Arrays.asList(sequence));
  BarrierBuffer buffer=createBarrierHandler(gate);
  for (  BufferOrEvent boe : sequence) {
    assertEquals(boe,buffer.getNextNonBlocked());
  }
  assertEquals(0L,buffer.getAlignmentDurationNanos());
  assertNull(buffer.getNextNonBlocked());
  assertNull(buffer.getNextNonBlocked());
  buffer.cleanup();
}
