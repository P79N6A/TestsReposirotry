/** 
 * Tests  {@link EventSerializer#isEvent(Buffer,Class)}whether it peaks into the buffer only, i.e. after the call, the buffer is still de-serializable.
 */
@Test public void testIsEventPeakOnly() throws Exception {
  final Buffer serializedEvent=EventSerializer.toBuffer(EndOfPartitionEvent.INSTANCE);
  try {
    final ClassLoader cl=getClass().getClassLoader();
    assertTrue(EventSerializer.isEvent(serializedEvent,EndOfPartitionEvent.class));
    EndOfPartitionEvent event=(EndOfPartitionEvent)EventSerializer.fromBuffer(serializedEvent,cl);
    assertEquals(EndOfPartitionEvent.INSTANCE,event);
  }
  finally {
    serializedEvent.recycleBuffer();
  }
}
