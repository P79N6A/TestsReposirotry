/** 
 * Tests simple updates of the completed checkpoint stats.
 */
@Test public void testSimpleUpdates() throws Exception {
  long triggerTimestamp=123123L;
  long ackTimestamp=123123 + 1212312399L;
  long stateSize=Integer.MAX_VALUE + 17787L;
  long alignmentBuffered=Integer.MAX_VALUE + 123123L;
  CompletedCheckpointStatsSummary summary=new CompletedCheckpointStatsSummary();
  assertEquals(0,summary.getStateSizeStats().getCount());
  assertEquals(0,summary.getEndToEndDurationStats().getCount());
  assertEquals(0,summary.getAlignmentBufferedStats().getCount());
  int numCheckpoints=10;
  for (int i=0; i < numCheckpoints; i++) {
    CompletedCheckpointStats completed=createCompletedCheckpoint(i,triggerTimestamp,ackTimestamp + i,stateSize + i,alignmentBuffered + i);
    summary.updateSummary(completed);
    assertEquals(i + 1,summary.getStateSizeStats().getCount());
    assertEquals(i + 1,summary.getEndToEndDurationStats().getCount());
    assertEquals(i + 1,summary.getAlignmentBufferedStats().getCount());
  }
  MinMaxAvgStats stateSizeStats=summary.getStateSizeStats();
  assertEquals(stateSize,stateSizeStats.getMinimum());
  assertEquals(stateSize + numCheckpoints - 1,stateSizeStats.getMaximum());
  MinMaxAvgStats durationStats=summary.getEndToEndDurationStats();
  assertEquals(ackTimestamp - triggerTimestamp,durationStats.getMinimum());
  assertEquals(ackTimestamp - triggerTimestamp + numCheckpoints - 1,durationStats.getMaximum());
  MinMaxAvgStats alignmentBufferedStats=summary.getAlignmentBufferedStats();
  assertEquals(alignmentBuffered,alignmentBufferedStats.getMinimum());
  assertEquals(alignmentBuffered + numCheckpoints - 1,alignmentBufferedStats.getMaximum());
}
