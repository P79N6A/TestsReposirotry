@Test public void testRolloverInterval() throws Exception {
  final File outDir=tempFolder.newFolder();
  OneInputStreamOperatorTestHarness<String,Object> testHarness=createRescalingTestSinkWithRollover(outDir,1,0,1000L,100L);
  testHarness.setup();
  testHarness.open();
  testHarness.setProcessingTime(0L);
  testHarness.processElement(new StreamRecord<>("test1",1L));
  checkLocalFs(outDir,1,0,0,0);
  testHarness.setProcessingTime(101L);
  testHarness.processElement(new StreamRecord<>("test1",2L));
  checkLocalFs(outDir,1,1,0,0);
  testHarness.snapshot(0,0);
  testHarness.notifyOfCompletedCheckpoint(0);
  checkLocalFs(outDir,1,0,1,0);
  testHarness.setProcessingTime(3000L);
  testHarness.snapshot(1,1);
  checkLocalFs(outDir,0,1,1,0);
  testHarness.notifyOfCompletedCheckpoint(1);
  testHarness.close();
  checkLocalFs(outDir,0,0,2,0);
}
