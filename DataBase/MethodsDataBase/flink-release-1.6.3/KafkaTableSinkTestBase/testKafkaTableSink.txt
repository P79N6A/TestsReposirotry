@SuppressWarnings("unchecked") @Test public void testKafkaTableSink(){
  DataStream dataStream=mock(DataStream.class);
  when(dataStream.addSink(any(SinkFunction.class))).thenReturn(mock(DataStreamSink.class));
  KafkaTableSink kafkaTableSink=spy(createTableSink());
  kafkaTableSink.emitDataStream(dataStream);
  verify(dataStream).addSink(any(getProducerClass()));
  verify(kafkaTableSink).createKafkaProducer(eq(TOPIC),eq(PROPERTIES),any(getSerializationSchemaClass()),eq(Optional.of(PARTITIONER)));
}
