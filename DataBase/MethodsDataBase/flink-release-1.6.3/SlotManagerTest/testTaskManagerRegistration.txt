/** 
 * Tests that we can register task manager and their slots at the slot manager.
 */
@Test public void testTaskManagerRegistration() throws Exception {
  final ResourceManagerId resourceManagerId=ResourceManagerId.generate();
  final ResourceActions resourceManagerActions=mock(ResourceActions.class);
  final TaskExecutorGateway taskExecutorGateway=mock(TaskExecutorGateway.class);
  final ResourceID resourceId=ResourceID.generate();
  final TaskExecutorConnection taskManagerConnection=new TaskExecutorConnection(resourceId,taskExecutorGateway);
  final SlotID slotId1=new SlotID(resourceId,0);
  final SlotID slotId2=new SlotID(resourceId,1);
  final ResourceProfile resourceProfile=new ResourceProfile(42.0,1337);
  final SlotStatus slotStatus1=new SlotStatus(slotId1,resourceProfile);
  final SlotStatus slotStatus2=new SlotStatus(slotId2,resourceProfile);
  final SlotReport slotReport=new SlotReport(Arrays.asList(slotStatus1,slotStatus2));
  try (SlotManager slotManager=createSlotManager(resourceManagerId,resourceManagerActions)){
    slotManager.registerTaskManager(taskManagerConnection,slotReport);
    assertTrue("The number registered slots does not equal the expected number.",2 == slotManager.getNumberRegisteredSlots());
    assertNotNull(slotManager.getSlot(slotId1));
    assertNotNull(slotManager.getSlot(slotId2));
  }
 }
