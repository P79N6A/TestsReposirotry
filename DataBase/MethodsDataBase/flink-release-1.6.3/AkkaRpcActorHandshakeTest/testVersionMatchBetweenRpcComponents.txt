@Test public void testVersionMatchBetweenRpcComponents() throws Exception {
  AkkaRpcActorTest.DummyRpcEndpoint rpcEndpoint=new AkkaRpcActorTest.DummyRpcEndpoint(akkaRpcService1);
  final int value=42;
  rpcEndpoint.setFoobar(value);
  rpcEndpoint.start();
  try {
    final AkkaRpcActorTest.DummyRpcGateway dummyRpcGateway=akkaRpcService2.connect(rpcEndpoint.getAddress(),AkkaRpcActorTest.DummyRpcGateway.class).get();
    assertThat(dummyRpcGateway.foobar().get(),equalTo(value));
  }
  finally {
    RpcUtils.terminateRpcEndpoint(rpcEndpoint,timeout);
  }
}
