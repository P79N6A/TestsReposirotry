@Test public void testVersionMismatchBetweenRpcComponents() throws Exception {
  AkkaRpcActorTest.DummyRpcEndpoint rpcEndpoint=new AkkaRpcActorTest.DummyRpcEndpoint(akkaRpcService1);
  rpcEndpoint.start();
  try {
    try {
      wrongVersionAkkaRpcService.connect(rpcEndpoint.getAddress(),AkkaRpcActorTest.DummyRpcGateway.class).get();
      fail("Expected HandshakeException.");
    }
 catch (    ExecutionException ee) {
      assertThat(ExceptionUtils.stripExecutionException(ee),instanceOf(HandshakeException.class));
    }
  }
  finally {
    RpcUtils.terminateRpcEndpoint(rpcEndpoint,timeout);
  }
}
