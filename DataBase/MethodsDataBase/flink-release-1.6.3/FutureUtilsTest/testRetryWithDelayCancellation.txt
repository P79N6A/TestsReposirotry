/** 
 * Tests that all scheduled tasks are canceled if the retry future is being cancelled.
 */
@Test public void testRetryWithDelayCancellation(){
  final ManuallyTriggeredScheduledExecutor scheduledExecutor=new ManuallyTriggeredScheduledExecutor();
  CompletableFuture<?> retryFuture=FutureUtils.retryWithDelay(() -> FutureUtils.completedExceptionally(new FlinkException("Test exception")),1,TestingUtils.infiniteTime(),scheduledExecutor);
  assertFalse(retryFuture.isDone());
  final Collection<ScheduledFuture<?>> scheduledTasks=scheduledExecutor.getScheduledTasks();
  assertFalse(scheduledTasks.isEmpty());
  final ScheduledFuture<?> scheduledFuture=scheduledTasks.iterator().next();
  assertFalse(scheduledFuture.isDone());
  retryFuture.cancel(false);
  assertTrue(retryFuture.isCancelled());
  assertTrue(scheduledFuture.isCancelled());
}
