/** 
 * Tests that we can submit a jobGraph in detached mode.
 */
@Test public void testDetachedJobSubmission() throws Exception {
  final TestJobSubmitHandler testJobSubmitHandler=new TestJobSubmitHandler();
  try (TestRestServerEndpoint ignored=createRestServerEndpoint(testJobSubmitHandler)){
    restClusterClient.setDetached(true);
    final JobSubmissionResult jobSubmissionResult=restClusterClient.submitJob(jobGraph,ClassLoader.getSystemClassLoader());
    assertThat(jobSubmissionResult,is(not(instanceOf(JobExecutionResult.class))));
    assertThat(jobSubmissionResult.getJobID(),is(jobId));
  }
 }
