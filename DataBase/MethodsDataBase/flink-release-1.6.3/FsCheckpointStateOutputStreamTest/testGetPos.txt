@Test public void testGetPos() throws Exception {
  FsCheckpointStreamFactory.CheckpointStateOutputStream stream=new FsCheckpointStreamFactory.FsCheckpointStateOutputStream(Path.fromLocalFile(tempDir.newFolder()),FileSystem.getLocalFileSystem(),31,17);
  for (int i=0; i < 64; ++i) {
    Assert.assertEquals(i,stream.getPos());
    stream.write(0x42);
  }
  stream.closeAndGetHandle();
  stream=new FsCheckpointStreamFactory.FsCheckpointStateOutputStream(Path.fromLocalFile(tempDir.newFolder()),FileSystem.getLocalFileSystem(),31,17);
  byte[] data="testme!".getBytes(ConfigConstants.DEFAULT_CHARSET);
  for (int i=0; i < 7; ++i) {
    Assert.assertEquals(i * (1 + data.length),stream.getPos());
    stream.write(0x42);
    stream.write(data);
  }
  stream.closeAndGetHandle();
}
