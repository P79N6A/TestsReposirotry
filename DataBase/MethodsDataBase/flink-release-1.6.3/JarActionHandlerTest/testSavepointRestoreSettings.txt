/** 
 * Test that the savepoint settings are correctly parsed.
 */
@Test public void testSavepointRestoreSettings() throws Exception {
  Map<String,String> pathParams=new HashMap<>();
  pathParams.put("jarid","required");
  pathParams.put("savepointPath","ignored");
  pathParams.put("allowNonRestoredState","ignored");
  Map<String,String> queryParams=new HashMap<>();
  JarActionHandler.JarActionHandlerConfig config=JarActionHandler.JarActionHandlerConfig.fromParams(pathParams,queryParams);
  assertEquals(SavepointRestoreSettings.none(),config.getSavepointRestoreSettings());
  queryParams.put("savepointPath","the-savepoint-path");
  queryParams.put("allowNonRestoredState","");
  SavepointRestoreSettings expected=SavepointRestoreSettings.forPath("the-savepoint-path",false);
  config=JarActionHandler.JarActionHandlerConfig.fromParams(pathParams,queryParams);
  assertEquals(expected,config.getSavepointRestoreSettings());
  queryParams.put("allowNonRestoredState","true");
  expected=SavepointRestoreSettings.forPath("the-savepoint-path",true);
  config=JarActionHandler.JarActionHandlerConfig.fromParams(pathParams,queryParams);
  assertEquals(expected,config.getSavepointRestoreSettings());
}
