@Test public void testWindowAssignmentWithOffset(){
  WindowAssigner.WindowAssignerContext mockContext=mock(WindowAssigner.WindowAssignerContext.class);
  TumblingProcessingTimeWindows assigner=TumblingProcessingTimeWindows.of(Time.milliseconds(5000),Time.milliseconds(100));
  when(mockContext.getCurrentProcessingTime()).thenReturn(100L);
  assertThat(assigner.assignWindows("String",Long.MIN_VALUE,mockContext),contains(timeWindow(100,5100)));
  when(mockContext.getCurrentProcessingTime()).thenReturn(5099L);
  assertThat(assigner.assignWindows("String",Long.MIN_VALUE,mockContext),contains(timeWindow(100,5100)));
  when(mockContext.getCurrentProcessingTime()).thenReturn(5100L);
  assertThat(assigner.assignWindows("String",Long.MIN_VALUE,mockContext),contains(timeWindow(5100,10100)));
}
