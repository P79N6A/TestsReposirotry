@Test public void testCompression() throws IOException {
  final String testFileContent="Goethe - Faust: Der Tragoedie erster Teil\n" + "Prolog im Himmel.\n" + "Der Herr. Die himmlischen Heerscharen. Nachher Mephistopheles. Die drei\n"+ "Erzengel treten vor.\n"+ "RAPHAEL: Die Sonne toent, nach alter Weise, In Brudersphaeren Wettgesang,\n"+ "Und ihre vorgeschriebne Reise Vollendet sie mit Donnergang. Ihr Anblick\n"+ "gibt den Engeln Staerke, Wenn keiner Sie ergruenden mag; die unbegreiflich\n"+ "hohen Werke Sind herrlich wie am ersten Tag.\n"+ "GABRIEL: Und schnell und unbegreiflich schnelle Dreht sich umher der Erde\n"+ "Pracht; Es wechselt Paradieseshelle Mit tiefer, schauervoller Nacht. Es\n"+ "schaeumt das Meer in breiten Fluessen Am tiefen Grund der Felsen auf, Und\n"+ "Fels und Meer wird fortgerissen Im ewig schnellem Sphaerenlauf.\n"+ "MICHAEL: Und Stuerme brausen um die Wette Vom Meer aufs Land, vom Land\n"+ "aufs Meer, und bilden wuetend eine Kette Der tiefsten Wirkung rings umher.\n"+ "Da flammt ein blitzendes Verheeren Dem Pfade vor des Donnerschlags. Doch\n"+ "deine Boten, Herr, verehren Das sanfte Wandeln deines Tags.";
  final java.nio.file.Path compressDir=tmp.newFolder("compressDir").toPath();
  final java.nio.file.Path extractDir=tmp.newFolder("extractDir").toPath();
  final java.nio.file.Path originalDir=Paths.get("rootDir");
  final java.nio.file.Path emptySubDir=originalDir.resolve("emptyDir");
  final java.nio.file.Path fullSubDir=originalDir.resolve("fullDir");
  final java.nio.file.Path file1=originalDir.resolve("file1");
  final java.nio.file.Path file2=originalDir.resolve("file2");
  final java.nio.file.Path file3=fullSubDir.resolve("file3");
  Files.createDirectory(compressDir.resolve(originalDir));
  Files.createDirectory(compressDir.resolve(emptySubDir));
  Files.createDirectory(compressDir.resolve(fullSubDir));
  Files.copy(new ByteArrayInputStream(testFileContent.getBytes(StandardCharsets.UTF_8)),compressDir.resolve(file1));
  Files.createFile(compressDir.resolve(file2));
  Files.copy(new ByteArrayInputStream(testFileContent.getBytes(StandardCharsets.UTF_8)),compressDir.resolve(file3));
  final Path zip=FileUtils.compressDirectory(new Path(compressDir.resolve(originalDir).toString()),new Path(compressDir.resolve(originalDir) + ".zip"));
  FileUtils.expandDirectory(zip,new Path(extractDir.toAbsolutePath().toString()));
  assertDirEquals(compressDir.resolve(originalDir),extractDir.resolve(originalDir));
}
