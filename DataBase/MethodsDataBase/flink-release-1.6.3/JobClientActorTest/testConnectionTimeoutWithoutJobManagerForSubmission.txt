/** 
 * Tests that a  {@link JobClientActorConnectionTimeoutException}is thrown when the JobSubmissionClientActor wants to submit a job but has not connected to a JobManager.
 * @throws Exception
 */
@Test(expected=JobClientActorConnectionTimeoutException.class) public void testConnectionTimeoutWithoutJobManagerForSubmission() throws Exception {
  FiniteDuration jobClientActorTimeout=new FiniteDuration(1L,TimeUnit.SECONDS);
  FiniteDuration timeout=jobClientActorTimeout.$times(2);
  SettableLeaderRetrievalService settableLeaderRetrievalService=new SettableLeaderRetrievalService("localhost",HighAvailabilityServices.DEFAULT_LEADER_ID);
  Props jobClientActorProps=JobSubmissionClientActor.createActorProps(settableLeaderRetrievalService,jobClientActorTimeout,false,clientConfig);
  ActorRef jobClientActor=system.actorOf(jobClientActorProps);
  Future<Object> jobExecutionResult=Patterns.ask(jobClientActor,new JobClientMessages.SubmitJobAndWait(testJobGraph),new Timeout(timeout));
  Await.result(jobExecutionResult,timeout);
}
