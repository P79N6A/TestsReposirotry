/** 
 * This test validates that an InvalidProgramException is thrown when maxBy is used on a custom data type.
 */
@Test(expected=InvalidProgramException.class) public void testCustomKeyFieldsDataset(){
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  this.customTypeData.add(new CustomType());
  DataSet<CustomType> customDs=env.fromCollection(customTypeData);
  customDs.maxBy(0);
}
