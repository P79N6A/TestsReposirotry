/** 
 * Test groupReduceOnNeighbors() -NeighborsFunctionWithVertexValue- with an edge having a srcId that does not exist in the vertex DataSet.
 */
@Test public void testGroupReduceOnNeighborsWithVVInvalidEdgeSrcId() throws Exception {
  final ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(PARALLELISM);
  env.getConfig().disableSysoutLogging();
  Graph<Long,Long,Long> graph=Graph.fromDataSet(TestGraphUtils.getLongLongVertexData(env),TestGraphUtils.getLongLongEdgeInvalidSrcData(env),env);
  try {
    DataSet<Tuple2<Long,Long>> verticesWithSumOfOutNeighborValues=graph.groupReduceOnNeighbors(new SumAllNeighbors(),EdgeDirection.ALL);
    verticesWithSumOfOutNeighborValues.output(new DiscardingOutputFormat<>());
    env.execute();
    fail("Expected an exception.");
  }
 catch (  Exception e) {
  }
}
