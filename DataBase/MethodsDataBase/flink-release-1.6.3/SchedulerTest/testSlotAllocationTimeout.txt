/** 
 * Tests that the Scheduler times out uncompleted slot futures.
 */
@Test public void testSlotAllocationTimeout() throws Exception {
  final Scheduler scheduler=new Scheduler(TestingUtils.defaultExecutor());
  final ExecutionGraph executionGraph=ExecutionGraphTestUtils.createSimpleTestGraph();
  final Map<ExecutionAttemptID,Execution> registeredExecutions=executionGraph.getRegisteredExecutions();
  assertThat(registeredExecutions.values(),Matchers.not(Matchers.empty()));
  final Execution execution=registeredExecutions.values().iterator().next();
  final CompletableFuture<LogicalSlot> slotFuture=scheduler.allocateSlot(new ScheduledUnit(execution),true,SlotProfile.noRequirements(),Time.milliseconds(1L));
  try {
    slotFuture.get();
  }
 catch (  ExecutionException ee) {
    assertThat(ExceptionUtils.stripExecutionException(ee),Matchers.instanceOf(TimeoutException.class));
  }
}
