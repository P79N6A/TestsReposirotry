/** 
 * Suspending from CANCELING goes to SUSPENDING and sends no additional RPC calls.
 */
@Test public void testSuspendedOutOfCanceling() throws Exception {
  final TaskManagerGateway gateway=spy(new SimpleAckingTaskManagerGateway());
  final int parallelism=10;
  final ExecutionGraph eg=createExecutionGraph(gateway,parallelism);
  eg.scheduleForExecution();
  ExecutionGraphTestUtils.switchAllVerticesToRunning(eg);
  eg.cancel();
  assertEquals(JobStatus.CANCELLING,eg.getState());
  validateCancelRpcCalls(gateway,parallelism);
  eg.suspend(new Exception("suspend"));
  assertEquals(JobStatus.SUSPENDING,eg.getState());
  ensureCannotLeaveSuspendingState(eg,gateway);
  ExecutionGraphTestUtils.completeCancellingForAllVertices(eg);
  assertEquals(JobStatus.SUSPENDED,eg.getState());
  ensureCannotLeaveSuspendedState(eg,gateway);
}
