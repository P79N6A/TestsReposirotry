/** 
 * Tests that stream status toggling works correctly, as well as that non-toggling status inputs do not yield output for a multiple input valve.
 */
@Test public void testMultipleInputStreamStatusToggling(){
  BufferedValveOutputHandler valveOutput=new BufferedValveOutputHandler();
  StatusWatermarkValve valve=new StatusWatermarkValve(2,valveOutput);
  valve.inputStreamStatus(StreamStatus.ACTIVE,0);
  valve.inputStreamStatus(StreamStatus.ACTIVE,1);
  assertEquals(null,valveOutput.popLastSeenOutput());
  valve.inputStreamStatus(StreamStatus.IDLE,1);
  assertEquals(null,valveOutput.popLastSeenOutput());
  valve.inputStreamStatus(StreamStatus.IDLE,0);
  assertEquals(StreamStatus.IDLE,valveOutput.popLastSeenOutput());
  valve.inputStreamStatus(StreamStatus.IDLE,0);
  valve.inputStreamStatus(StreamStatus.IDLE,1);
  assertEquals(null,valveOutput.popLastSeenOutput());
  valve.inputStreamStatus(StreamStatus.ACTIVE,1);
  assertEquals(StreamStatus.ACTIVE,valveOutput.popLastSeenOutput());
  valve.inputStreamStatus(StreamStatus.ACTIVE,0);
  assertEquals(null,valveOutput.popLastSeenOutput());
}
