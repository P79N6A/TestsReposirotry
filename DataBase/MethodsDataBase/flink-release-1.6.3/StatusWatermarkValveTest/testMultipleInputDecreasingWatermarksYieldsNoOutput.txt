/** 
 * Tests that for a multiple input valve, decreasing watermarks will yield no output.
 */
@Test public void testMultipleInputDecreasingWatermarksYieldsNoOutput(){
  BufferedValveOutputHandler valveOutput=new BufferedValveOutputHandler();
  StatusWatermarkValve valve=new StatusWatermarkValve(3,valveOutput);
  valve.inputWatermark(new Watermark(25),0);
  valve.inputWatermark(new Watermark(10),1);
  valve.inputWatermark(new Watermark(17),2);
  assertEquals(new Watermark(10),valveOutput.popLastSeenOutput());
  valve.inputWatermark(new Watermark(12),0);
  valve.inputWatermark(new Watermark(8),1);
  valve.inputWatermark(new Watermark(15),2);
  assertEquals(null,valveOutput.popLastSeenOutput());
}
