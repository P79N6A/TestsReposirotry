/** 
 * Tests that watermarks do not advance with decreasing watermark inputs for a single input valve.
 */
@Test public void testSingleInputDecreasingWatermarksYieldsNoOutput(){
  BufferedValveOutputHandler valveOutput=new BufferedValveOutputHandler();
  StatusWatermarkValve valve=new StatusWatermarkValve(1,valveOutput);
  valve.inputWatermark(new Watermark(25),0);
  assertEquals(new Watermark(25),valveOutput.popLastSeenOutput());
  valve.inputWatermark(new Watermark(18),0);
  assertEquals(null,valveOutput.popLastSeenOutput());
  valve.inputWatermark(new Watermark(42),0);
  assertEquals(new Watermark(42),valveOutput.popLastSeenOutput());
  assertEquals(null,valveOutput.popLastSeenOutput());
}
