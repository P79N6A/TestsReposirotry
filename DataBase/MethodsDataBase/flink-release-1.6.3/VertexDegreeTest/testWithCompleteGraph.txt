@Test public void testWithCompleteGraph() throws Exception {
  long expectedDegree=completeGraphVertexCount - 1;
  DataSet<Vertex<LongValue,LongValue>> degreeOnSourceId=completeGraph.run(new VertexDegree<LongValue,NullValue,NullValue>().setReduceOnTargetId(false));
  for (  Vertex<LongValue,LongValue> vertex : degreeOnSourceId.collect()) {
    assertEquals(expectedDegree,vertex.getValue().getValue());
  }
  DataSet<Vertex<LongValue,LongValue>> degreeOnTargetId=completeGraph.run(new VertexDegree<LongValue,NullValue,NullValue>().setReduceOnTargetId(true));
  for (  Vertex<LongValue,LongValue> vertex : degreeOnTargetId.collect()) {
    assertEquals(expectedDegree,vertex.getValue().getValue());
  }
}
