@Test public void testDelay() throws Exception {
  final long restartDelay=10;
  final int numberRestarts=10;
  final FixedDelayRestartStrategy strategy=new FixedDelayRestartStrategy(numberRestarts,restartDelay);
  for (int restartsLeft=numberRestarts; restartsLeft > 0; --restartsLeft) {
    assertTrue(strategy.canRestart());
    final OneShotLatch sync=new OneShotLatch();
    final RestartCallback restarter=new LatchedRestarter(sync);
    final long time=System.nanoTime();
    strategy.restart(restarter,executor);
    sync.await();
    final long elapsed=System.nanoTime() - time;
    assertTrue("Not enough delay",elapsed >= restartDelay * 1_000_000);
  }
  assertFalse(strategy.canRestart());
}
