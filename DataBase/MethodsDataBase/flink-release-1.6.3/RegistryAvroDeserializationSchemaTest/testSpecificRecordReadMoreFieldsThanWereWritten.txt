@Test public void testSpecificRecordReadMoreFieldsThanWereWritten() throws IOException {
  Schema smallerUserSchema=new Schema.Parser().parse("{\"namespace\": \"org.apache.flink.formats.avro.generated\",\n" + " \"type\": \"record\",\n" + " \"name\": \"SimpleRecord\",\n"+ " \"fields\": [\n"+ "     {\"name\": \"name\", \"type\": \"string\"}"+ " ]\n"+ "}]");
  RegistryAvroDeserializationSchema<SimpleRecord> deserializer=new RegistryAvroDeserializationSchema<>(SimpleRecord.class,null,() -> in -> smallerUserSchema);
  GenericData.Record smallUser=new GenericRecordBuilder(smallerUserSchema).set("name","someName").build();
  SimpleRecord simpleRecord=deserializer.deserialize(writeRecord(smallUser,smallerUserSchema));
  assertEquals("someName",simpleRecord.getName().toString());
  assertNull(simpleRecord.getOptionalField());
}
