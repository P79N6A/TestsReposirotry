/** 
 * Tests a checkpoint history with allowed size 1.
 */
@Test public void testSizeOneHistory() throws Exception {
  CheckpointStatsHistory history=new CheckpointStatsHistory(1);
  history.addInProgressCheckpoint(createPendingCheckpointStats(0));
  history.addInProgressCheckpoint(createPendingCheckpointStats(1));
  assertFalse(history.replacePendingCheckpointById(createCompletedCheckpointStats(0)));
  assertTrue(history.replacePendingCheckpointById(createCompletedCheckpointStats(1)));
  CheckpointStatsHistory snapshot=history.createSnapshot();
  for (  AbstractCheckpointStats stats : snapshot.getCheckpoints()) {
    assertEquals(1,stats.getCheckpointId());
    assertTrue(stats.getStatus().isCompleted());
  }
}
