@Test public void testRestoreAfterScaleUp() throws Exception {
  OperatorID headOperatorID=new OperatorID(42L,42L);
  OperatorID tailOperatorID=new OperatorID(44L,44L);
  JobManagerTaskRestore restore=createRunAndCheckpointOperatorChain(headOperatorID,new CounterOperator(),tailOperatorID,new CounterOperator(),Optional.empty());
  TaskStateSnapshot stateHandles=restore.getTaskStateSnapshot();
  assertEquals(2,stateHandles.getSubtaskStateMappings().size());
  OperatorSubtaskState emptyHeadOperatorState=StateAssignmentOperation.operatorSubtaskStateFrom(new OperatorInstanceID(0,headOperatorID),Collections.emptyMap(),Collections.emptyMap(),Collections.emptyMap(),Collections.emptyMap());
  stateHandles.putSubtaskStateByOperatorID(headOperatorID,emptyHeadOperatorState);
  createRunAndCheckpointOperatorChain(headOperatorID,new CounterOperator(),tailOperatorID,new CounterOperator(),Optional.of(restore));
  assertEquals(new HashSet<>(Arrays.asList(headOperatorID,tailOperatorID)),RESTORED_OPERATORS);
}
