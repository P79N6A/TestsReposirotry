@Test(expected=IOException.class) public void testExceptionWritingAfterCloseForCommit() throws Exception {
  final Path testDir=getBasePathForTest();
  final RecoverableWriter writer=getNewFileSystemWriter();
  final Path path=new Path(testDir,"part-0");
  try (final RecoverableFsDataOutputStream stream=writer.open(path)){
    stream.write(testData1.getBytes(StandardCharsets.UTF_8));
    stream.closeForCommit().getRecoverable();
    stream.write(testData2.getBytes(StandardCharsets.UTF_8));
    fail();
  }
 }
