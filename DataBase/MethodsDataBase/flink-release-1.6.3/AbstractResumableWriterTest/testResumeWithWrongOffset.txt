@Test public void testResumeWithWrongOffset() throws Exception {
  final Path testDir=getBasePathForTest();
  final RecoverableWriter writer=getNewFileSystemWriter();
  final Path path=new Path(testDir,"part-0");
  final RecoverableWriter.ResumeRecoverable recoverable1;
  final RecoverableWriter.ResumeRecoverable recoverable2;
  try (final RecoverableFsDataOutputStream stream=writer.open(path)){
    stream.write(testData1.getBytes(StandardCharsets.UTF_8));
    recoverable1=stream.persist();
    stream.write(testData2.getBytes(StandardCharsets.UTF_8));
    recoverable2=stream.persist();
    stream.write(testData3.getBytes(StandardCharsets.UTF_8));
  }
   try (RecoverableFsDataOutputStream ignored=writer.recover(recoverable1)){
  }
 catch (  Exception e) {
    fail();
  }
  try (RecoverableFsDataOutputStream ignored=writer.recover(recoverable2)){
    fail();
  }
 catch (  IOException e) {
    return;
  }
  fail();
}
