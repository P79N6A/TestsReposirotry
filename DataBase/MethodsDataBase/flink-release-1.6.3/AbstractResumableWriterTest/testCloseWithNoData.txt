@Test public void testCloseWithNoData() throws Exception {
  final RecoverableWriter writer=getNewFileSystemWriter();
  final Path testDir=getBasePathForTest();
  final Path path=new Path(testDir,"part-0");
  final RecoverableFsDataOutputStream stream=writer.open(path);
  for (  Map.Entry<Path,String> fileContents : getFileContentByPath(testDir).entrySet()) {
    Assert.assertTrue(fileContents.getKey().getName().startsWith(".part-0.inprogress."));
    Assert.assertTrue(fileContents.getValue().isEmpty());
  }
  stream.closeForCommit().commit();
  for (  Map.Entry<Path,String> fileContents : getFileContentByPath(testDir).entrySet()) {
    Assert.assertEquals("part-0",fileContents.getKey().getName());
    Assert.assertTrue(fileContents.getValue().isEmpty());
  }
}
