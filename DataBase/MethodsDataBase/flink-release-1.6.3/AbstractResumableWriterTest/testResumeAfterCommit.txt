@Test(expected=IOException.class) public void testResumeAfterCommit() throws Exception {
  final Path testDir=getBasePathForTest();
  final RecoverableWriter writer=getNewFileSystemWriter();
  final Path path=new Path(testDir,"part-0");
  RecoverableWriter.ResumeRecoverable recoverable;
  try (final RecoverableFsDataOutputStream stream=writer.open(path)){
    stream.write(testData1.getBytes(StandardCharsets.UTF_8));
    recoverable=stream.persist();
    stream.write(testData2.getBytes(StandardCharsets.UTF_8));
    stream.closeForCommit().commit();
  }
   writer.recover(recoverable);
  fail();
}
