@Test public void testJDBCInputFormatWithParallelismAndGenericSplitting() throws IOException {
  Serializable[][] queryParameters=new String[2][1];
  queryParameters[0]=new String[]{TEST_DATA[3].author};
  queryParameters[1]=new String[]{TEST_DATA[0].author};
  ParameterValuesProvider paramProvider=new GenericParameterValuesProvider(queryParameters);
  jdbcInputFormat=JDBCInputFormat.buildJDBCInputFormat().setDrivername(DRIVER_CLASS).setDBUrl(DB_URL).setQuery(JDBCTestBase.SELECT_ALL_BOOKS_SPLIT_BY_AUTHOR).setRowTypeInfo(ROW_TYPE_INFO).setParametersProvider(paramProvider).setResultSetType(ResultSet.TYPE_SCROLL_INSENSITIVE).finish();
  jdbcInputFormat.openInputFormat();
  InputSplit[] splits=jdbcInputFormat.createInputSplits(1);
  Assert.assertEquals(queryParameters.length,splits.length);
  verifySplit(splits[0],TEST_DATA[3].id);
  verifySplit(splits[1],TEST_DATA[0].id + TEST_DATA[1].id);
  jdbcInputFormat.closeInputFormat();
}
