@Test public void testCheckpointingCustomKvStateJobWithCustomClassLoader() throws IOException, ProgramInvocationException {
  File checkpointDir=FOLDER.newFolder();
  File outputDir=FOLDER.newFolder();
  final PackagedProgram program=new PackagedProgram(new File(CHECKPOINTING_CUSTOM_KV_STATE_JAR_PATH),new String[]{checkpointDir.toURI().toString(),outputDir.toURI().toString()});
  TestStreamEnvironment.setAsContext(testCluster,parallelism,Collections.singleton(new Path(CHECKPOINTING_CUSTOM_KV_STATE_JAR_PATH)),Collections.<URL>emptyList());
  expectedException.expectCause(Matchers.<Throwable>hasProperty("cause",isA(SuccessException.class)));
  program.invokeInteractiveModeForExecution();
}
