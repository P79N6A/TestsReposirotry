/** 
 * Tests that a single JobManager is elected as the leader by ZooKeeper.
 */
@Test public void testLeaderElection() throws Exception {
  final Configuration configuration=ZooKeeperTestUtils.createZooKeeperHAConfig(testingServer.getConnectString(),tempFolder.getRoot().getPath());
  ActorRef jm=null;
  try {
    Props jmProps=createJobManagerProps(configuration);
    jm=actorSystem.actorOf(jmProps);
    Future<Object> leaderFuture=Patterns.ask(jm,TestingJobManagerMessages.getNotifyWhenLeader(),timeout);
    Await.ready(leaderFuture,duration);
  }
  finally {
    TestingUtils.stopActor(jm);
  }
}
