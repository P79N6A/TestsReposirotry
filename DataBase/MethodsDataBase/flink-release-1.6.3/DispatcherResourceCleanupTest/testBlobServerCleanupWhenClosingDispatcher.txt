@Test public void testBlobServerCleanupWhenClosingDispatcher() throws Exception {
  submitJob();
  dispatcher.shutDown();
  terminationFuture.complete(null);
  dispatcher.getTerminationFuture().get();
  assertThat(cleanupJobFuture.get(),equalTo(jobId));
  assertThat(blobFile.exists(),is(false));
  try {
    deleteAllHABlobsFuture.get(50L,TimeUnit.MILLISECONDS);
    fail("We should not delete the HA blobs.");
  }
 catch (  TimeoutException ignored) {
  }
  assertThat(deleteAllHABlobsFuture.isDone(),is(false));
}
