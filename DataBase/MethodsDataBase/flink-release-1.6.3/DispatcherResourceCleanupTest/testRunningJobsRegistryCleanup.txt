/** 
 * Tests that the  {@link RunningJobsRegistry} entries are cleared after thejob reached a terminal state.
 */
@Test public void testRunningJobsRegistryCleanup() throws Exception {
  submitJob();
  runningJobsRegistry.setJobRunning(jobId);
  assertThat(runningJobsRegistry.contains(jobId),is(true));
  resultFuture.complete(new ArchivedExecutionGraphBuilder().setState(JobStatus.FINISHED).setJobID(jobId).build());
  terminationFuture.complete(null);
  clearedJobLatch.await();
  assertThat(runningJobsRegistry.contains(jobId),is(false));
}
