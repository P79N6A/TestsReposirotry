@Test @SuppressWarnings("unchecked") public void testKafkaConsumer(){
  KafkaTableSource.Builder b=getBuilder();
  configureBuilder(b);
  KafkaTableSource observed=spy(b.build());
  StreamExecutionEnvironment env=mock(StreamExecutionEnvironment.class);
  when(env.addSource(any(SourceFunction.class))).thenReturn(mock(DataStreamSource.class));
  observed.getDataStream(env);
  verify(env).addSource(any(getFlinkKafkaConsumer()));
  verify(observed).getKafkaConsumer(eq(TOPIC),eq(PROPS),any(getDeserializationSchema()));
}
