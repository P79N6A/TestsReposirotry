/** 
 * Tests  {@link NetworkBufferPool#requestMemorySegments(int)} with the number of requiredbuffers exceeding the capacity of  {@link NetworkBufferPool}.
 */
@Test public void testRequestMemorySegmentsMoreThanTotalBuffers() throws Exception {
  final int numBuffers=10;
  NetworkBufferPool globalPool=new NetworkBufferPool(numBuffers,128);
  try {
    globalPool.requestMemorySegments(numBuffers + 1);
    fail("Should throw an IOException");
  }
 catch (  IOException e) {
    assertEquals(globalPool.getNumberOfAvailableMemorySegments(),numBuffers);
  }
 finally {
    globalPool.destroy();
  }
}
