/** 
 * Normally moreAvailable flag from InputChannel should ignore non finished BufferConsumers, otherwise we would busy loop on the unfinished BufferConsumers.
 */
@Test public void testUnfinishedBufferBehindFinished() throws Exception {
  subpartition.add(createFilledBufferConsumer(1025));
  subpartition.add(createFilledBufferBuilder(1024).createBufferConsumer());
  assertThat(availablityListener.getNumNotifications(),greaterThan(0L));
  assertNextBuffer(readView,1025,false,1,false,true);
  assertNextBuffer(readView,1024,false,1,false,false);
  assertNoNextBuffer(readView);
}
