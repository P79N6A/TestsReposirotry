@Test public void testLimitingOutputStreams() throws Exception {
  final int maxConcurrentOpen=2;
  final int numThreads=61;
  final LimitedConnectionsFileSystem limitedFs=new LimitedConnectionsFileSystem(LocalFileSystem.getSharedInstance(),Integer.MAX_VALUE,maxConcurrentOpen,Integer.MAX_VALUE,0,0);
  final WriterThread[] threads=new WriterThread[numThreads];
  for (int i=0; i < numThreads; i++) {
    Path path=new Path(tempFolder.newFile().toURI());
    threads[i]=new WriterThread(limitedFs,path,maxConcurrentOpen,Integer.MAX_VALUE);
  }
  for (  WriterThread t : threads) {
    t.start();
  }
  for (  WriterThread t : threads) {
    t.sync();
  }
}
