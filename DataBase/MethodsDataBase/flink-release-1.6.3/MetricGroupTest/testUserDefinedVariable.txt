/** 
 * Verifies the basic behavior when defining user-defined variables.
 */
@Test public void testUserDefinedVariable(){
  MetricRegistry registry=NoOpMetricRegistry.INSTANCE;
  GenericMetricGroup root=new GenericMetricGroup(registry,new DummyAbstractMetricGroup(registry),"root");
  String key="key";
  String value="value";
  MetricGroup group=root.addGroup(key,value);
  String variableValue=group.getAllVariables().get(ScopeFormat.asVariable("key"));
  assertEquals(value,variableValue);
  String identifier=group.getMetricIdentifier("metric");
  assertTrue("Key is missing from metric identifier.",identifier.contains("key"));
  assertTrue("Value is missing from metric identifier.",identifier.contains("value"));
  String logicalScope=((AbstractMetricGroup)group).getLogicalScope(new DummyCharacterFilter());
  assertTrue("Key is missing from logical scope.",logicalScope.contains(key));
  assertFalse("Value is present in logical scope.",logicalScope.contains(value));
}
