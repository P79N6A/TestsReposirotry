/** 
 * FLINK-6775. <p>Tests that the returned serializer is duplicated. This allows to share the state descriptor.
 */
@Test public void testSerializerDuplication(){
  TypeSerializer<String> keySerializer=new KryoSerializer<>(String.class,new ExecutionConfig());
  TypeSerializer<Long> valueSerializer=new KryoSerializer<>(Long.class,new ExecutionConfig());
  MapStateDescriptor<String,Long> descr=new MapStateDescriptor<>("foobar",keySerializer,valueSerializer);
  TypeSerializer<String> keySerializerA=descr.getKeySerializer();
  TypeSerializer<String> keySerializerB=descr.getKeySerializer();
  TypeSerializer<Long> valueSerializerA=descr.getValueSerializer();
  TypeSerializer<Long> valueSerializerB=descr.getValueSerializer();
  assertNotSame(keySerializerA,keySerializerB);
  assertNotSame(valueSerializerA,valueSerializerB);
  TypeSerializer<Map<String,Long>> serializerA=descr.getSerializer();
  TypeSerializer<Map<String,Long>> serializerB=descr.getSerializer();
  assertNotSame(serializerA,serializerB);
}
