/** 
 * Tests that all persisted files are cleaned up after closing the store.
 */
@Test public void testCloseCleansUp() throws IOException {
  final File rootDir=temporaryFolder.newFolder();
  assertThat(rootDir.listFiles().length,Matchers.equalTo(0));
  try (final FileArchivedExecutionGraphStore executionGraphStore=createDefaultExecutionGraphStore(rootDir)){
    assertThat(rootDir.listFiles().length,Matchers.equalTo(1));
    final File storageDirectory=executionGraphStore.getStorageDir();
    assertThat(storageDirectory.listFiles().length,Matchers.equalTo(0));
    executionGraphStore.put(new ArchivedExecutionGraphBuilder().setState(JobStatus.FINISHED).build());
    assertThat(storageDirectory.listFiles().length,Matchers.equalTo(1));
  }
   assertThat(rootDir.listFiles().length,Matchers.equalTo(0));
}
