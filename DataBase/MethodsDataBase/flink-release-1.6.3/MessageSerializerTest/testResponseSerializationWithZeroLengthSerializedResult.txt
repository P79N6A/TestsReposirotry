/** 
 * Tests response serialization with zero-length serialized result.
 */
@Test public void testResponseSerializationWithZeroLengthSerializedResult() throws Exception {
  byte[] serializedResult=new byte[0];
  final KvStateResponse response=new KvStateResponse(serializedResult);
  final MessageSerializer<KvStateInternalRequest,KvStateResponse> serializer=new MessageSerializer<>(new KvStateInternalRequest.KvStateInternalRequestDeserializer(),new KvStateResponse.KvStateResponseDeserializer());
  ByteBuf buf=MessageSerializer.serializeResponse(alloc,72727278L,response);
  int frameLength=buf.readInt();
  assertEquals(MessageType.REQUEST_RESULT,MessageSerializer.deserializeHeader(buf));
  assertEquals(72727278L,MessageSerializer.getRequestId(buf));
  KvStateResponse responseDeser=serializer.deserializeResponse(buf);
  assertEquals(buf.readerIndex(),frameLength + 4);
  assertArrayEquals(serializedResult,responseDeser.getContent());
}
