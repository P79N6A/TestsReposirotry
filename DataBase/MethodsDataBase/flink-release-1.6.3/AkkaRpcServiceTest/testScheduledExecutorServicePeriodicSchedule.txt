/** 
 * Tests that the RPC service's scheduled executor service can execute runnables at a fixed rate.
 */
@Test(timeout=60000) public void testScheduledExecutorServicePeriodicSchedule() throws ExecutionException, InterruptedException {
  ScheduledExecutor scheduledExecutor=akkaRpcService.getScheduledExecutor();
  final int tries=4;
  final long delay=10L;
  final CountDownLatch countDownLatch=new CountDownLatch(tries);
  long currentTime=System.nanoTime();
  ScheduledFuture<?> future=scheduledExecutor.scheduleAtFixedRate(new Runnable(){
    @Override public void run(){
      countDownLatch.countDown();
    }
  }
,delay,delay,TimeUnit.MILLISECONDS);
  assertTrue(!future.isDone());
  countDownLatch.await();
  assertTrue(!future.isDone());
  long finalTime=System.nanoTime() - currentTime;
  assertTrue(finalTime >= tries * delay);
  future.cancel(true);
}
