/** 
 * Tests that a remote rpc call with a non-serializable argument fails with an {@link IOException} (or an {@link java.lang.reflect.UndeclaredThrowableException} if thethe method declaration does not include the  {@link IOException} as throwable).
 */
@Test(expected=IOException.class) public void testNonSerializableRemoteMessageTransfer() throws Exception {
  LinkedBlockingQueue<Object> linkedBlockingQueue=new LinkedBlockingQueue<>();
  TestEndpoint testEndpoint=new TestEndpoint(akkaRpcService1,linkedBlockingQueue);
  testEndpoint.start();
  String address=testEndpoint.getAddress();
  CompletableFuture<TestGateway> remoteGatewayFuture=akkaRpcService2.connect(address,TestGateway.class);
  TestGateway remoteGateway=remoteGatewayFuture.get(timeout.getSize(),timeout.getUnit());
  remoteGateway.foobar(new Object());
  fail("Should have failed because Object is not serializable.");
}
