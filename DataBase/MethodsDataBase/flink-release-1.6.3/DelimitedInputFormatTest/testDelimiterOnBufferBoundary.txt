@Test public void testDelimiterOnBufferBoundary() throws IOException {
  String[] records=new String[]{"1234567890<DEL?NO!>1234567890","1234567890<DEL?NO!>1234567890","<DEL?NO!>"};
  String delimiter="<DELIM>";
  String fileContent=StringUtils.join(records,delimiter);
  final FileInputSplit split=createTempFile(fileContent);
  final Configuration parameters=new Configuration();
  format.setBufferSize(12);
  format.setDelimiter(delimiter);
  format.configure(parameters);
  format.open(split);
  for (  String record : records) {
    String value=format.nextRecord(null);
    assertEquals(record,value);
  }
  assertNull(format.nextRecord(null));
  assertTrue(format.reachedEnd());
  format.close();
}
