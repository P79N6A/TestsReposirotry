@Test @SuppressWarnings("unchecked") public void testNumStateEntries() throws Exception {
  AbstractKeyedStateBackend<Integer> backend=createKeyedBackend(IntSerializer.INSTANCE);
  ValueStateDescriptor<String> kvId=new ValueStateDescriptor<>("id",String.class);
  assertEquals(0,backend.numKeyValueStateEntries());
  ValueState<String> state=backend.getPartitionedState(VoidNamespace.INSTANCE,VoidNamespaceSerializer.INSTANCE,kvId);
  backend.setCurrentKey(0);
  state.update("hello");
  state.update("ciao");
  assertEquals(1,backend.numKeyValueStateEntries());
  backend.setCurrentKey(42);
  state.update("foo");
  assertEquals(2,backend.numKeyValueStateEntries());
  backend.setCurrentKey(0);
  state.clear();
  assertEquals(1,backend.numKeyValueStateEntries());
  backend.setCurrentKey(42);
  state.clear();
  assertEquals(0,backend.numKeyValueStateEntries());
  backend.dispose();
}
