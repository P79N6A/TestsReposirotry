/** 
 * Tests the specifying heap memory with unit (MB) for job manager and task manager.
 */
@Test public void testHeapMemoryPropertyWithUnitMB() throws Exception {
  final String[] args=new String[]{"-yn","2","-yjm","1024m","-ytm","2048m"};
  final FlinkYarnSessionCli flinkYarnSessionCli=new FlinkYarnSessionCli(new Configuration(),tmp.getRoot().getAbsolutePath(),"y","yarn");
  final CommandLine commandLine=flinkYarnSessionCli.parseCommandLineOptions(args,false);
  final ClusterSpecification clusterSpecification=flinkYarnSessionCli.getClusterSpecification(commandLine);
  assertThat(clusterSpecification.getMasterMemoryMB(),is(1024));
  assertThat(clusterSpecification.getTaskManagerMemoryMB(),is(2048));
}
