/** 
 * Tests that the configuration settings are used to create the {@link ClusterSpecification}.
 */
@Test public void testConfigurationClusterSpecification() throws Exception {
  final Configuration configuration=new Configuration();
  final int jobManagerMemory=1337;
  configuration.setString(JobManagerOptions.JOB_MANAGER_HEAP_MEMORY,jobManagerMemory + "m");
  final int taskManagerMemory=7331;
  configuration.setString(TaskManagerOptions.TASK_MANAGER_HEAP_MEMORY,taskManagerMemory + "m");
  final int slotsPerTaskManager=42;
  configuration.setInteger(TaskManagerOptions.NUM_TASK_SLOTS,slotsPerTaskManager);
  final String[] args={};
  final FlinkYarnSessionCli flinkYarnSessionCli=new FlinkYarnSessionCli(configuration,tmp.getRoot().getAbsolutePath(),"y","yarn");
  CommandLine commandLine=flinkYarnSessionCli.parseCommandLineOptions(args,false);
  final ClusterSpecification clusterSpecification=flinkYarnSessionCli.getClusterSpecification(commandLine);
  assertThat(clusterSpecification.getMasterMemoryMB(),is(jobManagerMemory));
  assertThat(clusterSpecification.getTaskManagerMemoryMB(),is(taskManagerMemory));
  assertThat(clusterSpecification.getSlotsPerTaskManager(),is(slotsPerTaskManager));
}
