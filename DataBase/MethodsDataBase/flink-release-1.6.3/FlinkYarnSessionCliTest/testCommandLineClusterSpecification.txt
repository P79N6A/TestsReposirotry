/** 
 * Tests that the command line arguments override the configuration settings when the  {@link ClusterSpecification} is created.
 */
@Test public void testCommandLineClusterSpecification() throws Exception {
  final Configuration configuration=new Configuration();
  final int jobManagerMemory=1337;
  final int taskManagerMemory=7331;
  final int slotsPerTaskManager=30;
  configuration.setString(JobManagerOptions.JOB_MANAGER_HEAP_MEMORY,jobManagerMemory + "m");
  configuration.setString(TaskManagerOptions.TASK_MANAGER_HEAP_MEMORY,taskManagerMemory + "m");
  configuration.setInteger(TaskManagerOptions.NUM_TASK_SLOTS,slotsPerTaskManager);
  final String[] args={"-yjm",String.valueOf(jobManagerMemory) + "m","-ytm",String.valueOf(taskManagerMemory) + "m","-ys",String.valueOf(slotsPerTaskManager)};
  final FlinkYarnSessionCli flinkYarnSessionCli=new FlinkYarnSessionCli(configuration,tmp.getRoot().getAbsolutePath(),"y","yarn");
  CommandLine commandLine=flinkYarnSessionCli.parseCommandLineOptions(args,false);
  final ClusterSpecification clusterSpecification=flinkYarnSessionCli.getClusterSpecification(commandLine);
  assertThat(clusterSpecification.getMasterMemoryMB(),is(jobManagerMemory));
  assertThat(clusterSpecification.getTaskManagerMemoryMB(),is(taskManagerMemory));
  assertThat(clusterSpecification.getSlotsPerTaskManager(),is(slotsPerTaskManager));
}
