@Test public void testConfigurationViaQueryParameters() throws Exception {
  sendRequestAndValidateGraph(handler,restfulGateway,() -> {
    final JarRunMessageParameters parameters=JarRunHeaders.getInstance().getUnresolvedMessageParameters();
    parameters.allowNonRestoredStateQueryParameter.resolve(Collections.singletonList(true));
    parameters.savepointPathQueryParameter.resolve(Collections.singletonList("/foo/bar"));
    parameters.entryClassQueryParameter.resolve(Collections.singletonList(ParameterProgram.class.getCanonicalName()));
    parameters.parallelismQueryParameter.resolve(Collections.singletonList(4));
    parameters.programArgsQueryParameter.resolve(Collections.singletonList("--host localhost --port 1234"));
    return createRequest(new JarRunRequestBody(),parameters,jarWithoutManifest);
  }
,jobGraph -> {
    Assert.assertEquals(4,ParameterProgram.actualArguments.length);
    Assert.assertEquals("--host",ParameterProgram.actualArguments[0]);
    Assert.assertEquals("localhost",ParameterProgram.actualArguments[1]);
    Assert.assertEquals("--port",ParameterProgram.actualArguments[2]);
    Assert.assertEquals("1234",ParameterProgram.actualArguments[3]);
    Assert.assertEquals(4,getExecutionConfig(jobGraph).getParallelism());
    final SavepointRestoreSettings savepointRestoreSettings=jobGraph.getSavepointRestoreSettings();
    Assert.assertTrue(savepointRestoreSettings.allowNonRestoredState());
    Assert.assertEquals("/foo/bar",savepointRestoreSettings.getRestorePath());
  }
);
}
