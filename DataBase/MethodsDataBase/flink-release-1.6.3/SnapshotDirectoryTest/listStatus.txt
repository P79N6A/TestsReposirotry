/** 
 * Tests listing of file statuses works like listing on the path directly.
 */
@Test public void listStatus() throws Exception {
  File folderRoot=temporaryFolder.getRoot();
  File folderA=new File(folderRoot,String.valueOf(UUID.randomUUID()));
  File folderB=new File(folderA,String.valueOf(UUID.randomUUID()));
  Assert.assertTrue(folderB.mkdirs());
  File file=new File(folderA,"test.txt");
  Assert.assertTrue(file.createNewFile());
  Path path=new Path(folderA.toURI());
  FileSystem fileSystem=path.getFileSystem();
  SnapshotDirectory snapshotDirectory=SnapshotDirectory.permanent(path);
  Assert.assertTrue(snapshotDirectory.exists());
  Assert.assertEquals(Arrays.toString(fileSystem.listStatus(path)),Arrays.toString(snapshotDirectory.listStatus()));
}
