/** 
 * This test checks that completing or deleting the snapshot influence the #isSnapshotOngoing() flag.
 */
@Test public void isSnapshotOngoing() throws Exception {
  File folderRoot=temporaryFolder.getRoot();
  File folderA=new File(folderRoot,String.valueOf(UUID.randomUUID()));
  Assert.assertTrue(folderA.mkdirs());
  Path pathA=new Path(folderA.toURI());
  SnapshotDirectory snapshotDirectory=SnapshotDirectory.permanent(pathA);
  Assert.assertFalse(snapshotDirectory.isSnapshotCompleted());
  Assert.assertNotNull(snapshotDirectory.completeSnapshotAndGetHandle());
  Assert.assertTrue(snapshotDirectory.isSnapshotCompleted());
  snapshotDirectory=SnapshotDirectory.permanent(pathA);
  Assert.assertFalse(snapshotDirectory.isSnapshotCompleted());
  snapshotDirectory.cleanup();
  Assert.assertFalse(snapshotDirectory.isSnapshotCompleted());
}
