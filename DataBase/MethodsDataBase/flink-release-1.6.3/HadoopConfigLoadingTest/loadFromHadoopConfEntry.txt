@Test public void loadFromHadoopConfEntry() throws Exception {
  final String k1="singing?";
  final String v1="rain!";
  final String k2="dancing?";
  final String v2="shower!";
  final File confDir=tempFolder.newFolder();
  final File file1=new File(confDir,"core-site.xml");
  final File file2=new File(confDir,"hdfs-site.xml");
  printConfig(file1,k1,v1);
  printConfig(file2,k2,v2);
  final Configuration cfg=new Configuration();
  cfg.setString(ConfigConstants.PATH_HADOOP_CONFIG,confDir.getAbsolutePath());
  org.apache.hadoop.conf.Configuration hadoopConf=HadoopUtils.getHadoopConfiguration(cfg);
  assertEquals(v1,hadoopConf.get(k1,null));
  assertEquals(v2,hadoopConf.get(k2,null));
  assertEquals(IN_CP_CONFIG_VALUE,hadoopConf.get(IN_CP_CONFIG_KEY,null));
}
