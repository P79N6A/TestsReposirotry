@Test public void testStopYarn() throws Exception {
  assertTrue(getRunningJobs(CLUSTER.getClusterClient()).isEmpty());
  final JobVertex sender=new JobVertex("Sender");
  sender.setParallelism(2);
  sender.setInvokableClass(BlockingInvokable.class);
  final JobGraph jobGraph=new JobGraph("Stoppable streaming test job",sender);
  final JobID jid=jobGraph.getJobID();
  ClusterClient<?> clusterClient=CLUSTER.getClusterClient();
  clusterClient.setDetached(true);
  clusterClient.submitJob(jobGraph,WebFrontendITCase.class.getClassLoader());
  while (getRunningJobs(CLUSTER.getClusterClient()).isEmpty()) {
    Thread.sleep(10);
  }
  BlockingInvokable.latch.await();
  final FiniteDuration testTimeout=new FiniteDuration(2,TimeUnit.MINUTES);
  final Deadline deadline=testTimeout.fromNow();
  try (HttpTestClient client=new HttpTestClient("localhost",CLUSTER.getWebUIPort())){
    client.sendGetRequest("/jobs/" + jid + "/yarn-stop",deadline.timeLeft());
    HttpTestClient.SimpleHttpResponse response=client.getNextResponse(deadline.timeLeft());
    if (CLUSTER.getCodebaseType() == TestBaseUtils.CodebaseType.NEW) {
      assertEquals(HttpResponseStatus.ACCEPTED,response.getStatus());
    }
 else {
      assertEquals(HttpResponseStatus.OK,response.getStatus());
    }
    assertEquals("application/json; charset=UTF-8",response.getType());
    assertEquals("{}",response.getContent());
  }
   while (!getRunningJobs(CLUSTER.getClusterClient()).isEmpty()) {
    Thread.sleep(20);
  }
  BlockingInvokable.reset();
}
