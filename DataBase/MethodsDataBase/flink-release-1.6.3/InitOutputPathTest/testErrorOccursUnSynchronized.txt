/** 
 * This test validates that this test case makes sense - that the error can be produced in the absence of synchronization, if the threads make progress in a certain way, here enforced by latches.
 */
@Test public void testErrorOccursUnSynchronized() throws Exception {
  Field lock=FileSystem.class.getDeclaredField("OUTPUT_DIRECTORY_INIT_LOCK");
  lock.setAccessible(true);
  lock.set(null,new NoOpLock());
  try {
    runTest(true);
    fail("should fail with an exception");
  }
 catch (  FileNotFoundException e) {
  }
 finally {
    lock.set(null,new ReentrantLock(true));
  }
}
