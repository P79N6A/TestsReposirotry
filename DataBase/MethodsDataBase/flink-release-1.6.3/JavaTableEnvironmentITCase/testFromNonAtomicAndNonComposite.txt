@Test public void testFromNonAtomicAndNonComposite() throws Exception {
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  BatchTableEnvironment tableEnv=TableEnvironment.getTableEnvironment(env,config());
  List<Either<String,Integer>> data=new ArrayList<>();
  data.add(new Either.Left<>("Hello"));
  data.add(new Either.Right<>(42));
  data.add(new Either.Left<>("World"));
  Table table=tableEnv.fromDataSet(env.fromCollection(data,TypeInformation.of(new TypeHint<Either<String,Integer>>(){
  }
)),"either").select("either");
  DataSet<Row> ds=tableEnv.toDataSet(table,Row.class);
  List<Row> results=ds.collect();
  String expected="Left(Hello)\n" + "Left(World)\n" + "Right(42)\n";
  compareResultAsText(results,expected);
}
