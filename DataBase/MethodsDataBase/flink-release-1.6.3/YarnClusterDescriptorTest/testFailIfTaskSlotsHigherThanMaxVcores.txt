@Test public void testFailIfTaskSlotsHigherThanMaxVcores() throws ClusterDeploymentException {
  final Configuration flinkConfiguration=new Configuration();
  flinkConfiguration.setInteger(ResourceManagerOptions.CONTAINERIZED_HEAP_CUTOFF_MIN,0);
  LegacyYarnClusterDescriptor clusterDescriptor=new LegacyYarnClusterDescriptor(flinkConfiguration,yarnConfiguration,temporaryFolder.getRoot().getAbsolutePath(),yarnClient,true);
  clusterDescriptor.setLocalJarPath(new Path(flinkJar.getPath()));
  ClusterSpecification clusterSpecification=new ClusterSpecification.ClusterSpecificationBuilder().setMasterMemoryMB(1).setTaskManagerMemoryMB(1).setNumberTaskManagers(1).setSlotsPerTaskManager(Integer.MAX_VALUE).createClusterSpecification();
  try {
    clusterDescriptor.deploySessionCluster(clusterSpecification);
    fail("The deploy call should have failed.");
  }
 catch (  ClusterDeploymentException e) {
    if (!(e.getCause() instanceof IllegalConfigurationException)) {
      throw e;
    }
  }
 finally {
    clusterDescriptor.close();
  }
}
