/** 
 * Tests that the YarnClient is only shut down if it is not shared.
 */
@Test public void testYarnClientShutDown(){
  LegacyYarnClusterDescriptor yarnClusterDescriptor=new LegacyYarnClusterDescriptor(new Configuration(),yarnConfiguration,temporaryFolder.getRoot().getAbsolutePath(),yarnClient,true);
  yarnClusterDescriptor.close();
  assertTrue(yarnClient.isInState(Service.STATE.STARTED));
  final YarnClient closableYarnClient=YarnClient.createYarnClient();
  closableYarnClient.init(yarnConfiguration);
  closableYarnClient.start();
  yarnClusterDescriptor=new LegacyYarnClusterDescriptor(new Configuration(),yarnConfiguration,temporaryFolder.getRoot().getAbsolutePath(),closableYarnClient,false);
  yarnClusterDescriptor.close();
  assertTrue(closableYarnClient.isInState(Service.STATE.STOPPED));
}
