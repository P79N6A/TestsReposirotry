@Test public void testRun() throws Exception {
  final Configuration configuration=getConfiguration();
{
    String[] parameters={"-v",getTestJarPath()};
    verifyCliFrontend(getCli(configuration),parameters,1,true,false);
  }
{
    String[] parameters={"-v","-p","42",getTestJarPath()};
    verifyCliFrontend(getCli(configuration),parameters,42,true,false);
  }
{
    String[] parameters={"-p","2","-q",getTestJarPath()};
    verifyCliFrontend(getCli(configuration),parameters,2,false,false);
  }
{
    String[] parameters={"-p","2","-d",getTestJarPath()};
    verifyCliFrontend(getCli(configuration),parameters,2,true,true);
  }
{
    String[] parameters={"-s","expectedSavepointPath",getTestJarPath()};
    RunOptions options=CliFrontendParser.parseRunCommand(parameters);
    SavepointRestoreSettings savepointSettings=options.getSavepointRestoreSettings();
    assertTrue(savepointSettings.restoreSavepoint());
    assertEquals("expectedSavepointPath",savepointSettings.getRestorePath());
    assertFalse(savepointSettings.allowNonRestoredState());
  }
{
    String[] parameters={"-s","expectedSavepointPath","-n",getTestJarPath()};
    RunOptions options=CliFrontendParser.parseRunCommand(parameters);
    SavepointRestoreSettings savepointSettings=options.getSavepointRestoreSettings();
    assertTrue(savepointSettings.restoreSavepoint());
    assertEquals("expectedSavepointPath",savepointSettings.getRestorePath());
    assertTrue(savepointSettings.allowNonRestoredState());
  }
{
    String[] parameters={getTestJarPath(),"-arg1","value1","justavalue","--arg2","value2"};
    RunOptions options=CliFrontendParser.parseRunCommand(parameters);
    assertEquals("-arg1",options.getProgramArgs()[0]);
    assertEquals("value1",options.getProgramArgs()[1]);
    assertEquals("justavalue",options.getProgramArgs()[2]);
    assertEquals("--arg2",options.getProgramArgs()[3]);
    assertEquals("value2",options.getProgramArgs()[4]);
  }
}
