@Test public void testSetFinishedAndRunning() throws Exception {
  final File folder=tempFolder.newFolder();
  final String uri=folder.toURI().toString();
  final JobID jid=new JobID();
  FsNegativeRunningJobsRegistry registry=new FsNegativeRunningJobsRegistry(new Path(uri));
  registry.setJobFinished(jid);
  assertEquals(JobSchedulingStatus.DONE,registry.getJobSchedulingStatus(jid));
  registry.setJobRunning(jid);
  assertEquals(JobSchedulingStatus.DONE,registry.getJobSchedulingStatus(jid));
  FsNegativeRunningJobsRegistry otherRegistry=new FsNegativeRunningJobsRegistry(new Path(uri));
  assertEquals(JobSchedulingStatus.DONE,otherRegistry.getJobSchedulingStatus(jid));
  otherRegistry.clearJob(jid);
  assertEquals(JobSchedulingStatus.PENDING,registry.getJobSchedulingStatus(jid));
  assertEquals(JobSchedulingStatus.PENDING,otherRegistry.getJobSchedulingStatus(jid));
}
