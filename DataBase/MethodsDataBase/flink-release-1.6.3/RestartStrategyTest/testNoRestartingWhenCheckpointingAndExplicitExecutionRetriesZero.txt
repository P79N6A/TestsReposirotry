/** 
 * Checks that in a streaming use case where checkpointing is enabled and the number of execution retries is set to 0, restarting is deactivated.
 */
@Test public void testNoRestartingWhenCheckpointingAndExplicitExecutionRetriesZero() throws Exception {
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.enableCheckpointing(500);
  env.setNumberOfExecutionRetries(0);
  env.fromElements(1).print();
  StreamGraph graph=env.getStreamGraph();
  JobGraph jobGraph=graph.getJobGraph();
  RestartStrategies.RestartStrategyConfiguration restartStrategy=jobGraph.getSerializedExecutionConfig().deserializeValue(getClass().getClassLoader()).getRestartStrategy();
  Assert.assertNotNull(restartStrategy);
  Assert.assertTrue(restartStrategy instanceof RestartStrategies.NoRestartStrategyConfiguration);
}
