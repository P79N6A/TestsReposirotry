@Test public void testSerializationEmpty() throws IOException {
  final File testFolder=tempFolder.newFolder();
  final FileSystem fs=FileSystem.get(testFolder.toURI());
  final RecoverableWriter writer=fs.createRecoverableWriter();
  final Path testBucket=new Path(testFolder.getPath(),"test");
  final BucketState<String> bucketState=new BucketState<>("test",testBucket,Long.MAX_VALUE,null,new HashMap<>());
  final SimpleVersionedSerializer<BucketState<String>> serializer=new BucketStateSerializer<>(writer.getResumeRecoverableSerializer(),writer.getCommitRecoverableSerializer(),SimpleVersionedStringSerializer.INSTANCE);
  byte[] bytes=SimpleVersionedSerialization.writeVersionAndSerialize(serializer,bucketState);
  final BucketState<String> recoveredState=SimpleVersionedSerialization.readVersionAndDeSerialize(serializer,bytes);
  Assert.assertEquals(testBucket,recoveredState.getBucketPath());
  Assert.assertNull(recoveredState.getInProgressResumableFile());
  Assert.assertTrue(recoveredState.getCommittableFilesPerCheckpoint().isEmpty());
}
