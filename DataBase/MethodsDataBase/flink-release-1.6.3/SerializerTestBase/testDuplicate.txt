@Test public void testDuplicate() throws Exception {
  final int numThreads=10;
  final TypeSerializer<T> serializer=getSerializer();
  final CyclicBarrier startLatch=new CyclicBarrier(numThreads);
  final List<SerializerRunner<T>> concurrentRunners=new ArrayList<>(numThreads);
  Assert.assertEquals(serializer,serializer.duplicate());
  T[] testData=getData();
  for (int i=0; i < numThreads; ++i) {
    SerializerRunner<T> runner=new SerializerRunner<>(startLatch,serializer.duplicate(),testData,120L);
    runner.start();
    concurrentRunners.add(runner);
  }
  for (  SerializerRunner<T> concurrentRunner : concurrentRunners) {
    concurrentRunner.join();
    concurrentRunner.checkResult();
  }
}
