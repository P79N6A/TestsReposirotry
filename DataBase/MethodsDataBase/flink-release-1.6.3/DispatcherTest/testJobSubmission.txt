/** 
 * Tests that we can submit a job to the Dispatcher which then spawns a new JobManagerRunner.
 */
@Test public void testJobSubmission() throws Exception {
  dispatcher=createAndStartDispatcher(heartbeatServices,haServices,new ExpectedJobIdJobManagerRunnerFactory(TEST_JOB_ID,createdJobManagerRunnerLatch));
  CompletableFuture<UUID> leaderFuture=dispatcherLeaderElectionService.isLeader(UUID.randomUUID());
  leaderFuture.get();
  DispatcherGateway dispatcherGateway=dispatcher.getSelfGateway(DispatcherGateway.class);
  CompletableFuture<Acknowledge> acknowledgeFuture=dispatcherGateway.submitJob(jobGraph,TIMEOUT);
  acknowledgeFuture.get();
  assertTrue("jobManagerRunner was not started",dispatcherLeaderElectionService.isStarted());
}
