/** 
 * Tests that the dispatcher takes part in the leader election.
 */
@Test public void testLeaderElection() throws Exception {
  dispatcher=createAndStartDispatcher(heartbeatServices,haServices,new ExpectedJobIdJobManagerRunnerFactory(TEST_JOB_ID,createdJobManagerRunnerLatch));
  CompletableFuture<Void> jobIdsFuture=new CompletableFuture<>();
  submittedJobGraphStore.setJobIdsFunction((  Collection<JobID> jobIds) -> {
    jobIdsFuture.complete(null);
    return jobIds;
  }
);
  electDispatcher();
  jobIdsFuture.get(TIMEOUT.toMilliseconds(),TimeUnit.MILLISECONDS);
}
