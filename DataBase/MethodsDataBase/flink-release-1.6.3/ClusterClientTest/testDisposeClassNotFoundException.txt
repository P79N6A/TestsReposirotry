@Test public void testDisposeClassNotFoundException() throws Exception {
  final Configuration configuration=new Configuration();
  final Time timeout=Time.milliseconds(1000L);
  final String savepointPath="foobar";
  final ActorGateway jobManagerGateway=new TestDisposeWithClassNotFoundExceptionActorGateway();
  final TestClusterClient clusterClient=new TestClusterClient(configuration,jobManagerGateway);
  CompletableFuture<Acknowledge> acknowledgeCompletableFuture=clusterClient.disposeSavepoint(savepointPath);
  try {
    acknowledgeCompletableFuture.get();
    fail("Dispose operation should have failed.");
  }
 catch (  ExecutionException e) {
    assertTrue(ExceptionUtils.findThrowableWithMessage(e,"Savepoint disposal failed, because of a " + "missing class. This is most likely caused by a custom state " + "instance, which cannot be disposed without the user code class "+ "loader. Please provide the program jar with which you have created "+ "the savepoint via -j <JAR> for disposal.").isPresent());
  }
 finally {
    clusterClient.shutdown();
  }
}
