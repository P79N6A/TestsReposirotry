@Test public void testClusterClientSavepoint() throws Exception {
  Configuration config=new Configuration();
  config.setString(JobManagerOptions.ADDRESS,"localhost");
  JobID jobID=new JobID();
  String savepointDirectory="/test/directory";
  String savepointPath="/test/path";
  TestSavepointActorGateway gateway=new TestSavepointActorGateway(jobID,savepointDirectory,savepointPath);
  TestClusterClient clusterClient=new TestClusterClient(config,gateway);
  try {
    CompletableFuture<String> pathFuture=clusterClient.triggerSavepoint(jobID,savepointDirectory);
    Assert.assertTrue(gateway.messageArrived);
    Assert.assertEquals(savepointPath,pathFuture.get());
  }
  finally {
    clusterClient.shutdown();
  }
}
