@Test public void testClusterClientList() throws Exception {
  Configuration config=new Configuration();
  config.setString(JobManagerOptions.ADDRESS,"localhost");
  TestListActorGateway gateway=new TestListActorGateway();
  TestClusterClient clusterClient=new TestClusterClient(config,gateway);
  try {
    CompletableFuture<Collection<JobStatusMessage>> jobDetailsFuture=clusterClient.listJobs();
    Collection<JobStatusMessage> jobDetails=jobDetailsFuture.get();
    Assert.assertTrue(gateway.messageArrived);
    Assert.assertEquals(2,jobDetails.size());
    Iterator<JobStatusMessage> jobDetailsIterator=jobDetails.iterator();
    JobStatusMessage job1=jobDetailsIterator.next();
    JobStatusMessage job2=jobDetailsIterator.next();
    Assert.assertNotEquals("The job statues should not be equal.",job1.getJobState(),job2.getJobState());
  }
  finally {
    clusterClient.shutdown();
  }
}
