@Test public void testClusterClientCancelWithSavepoint() throws Exception {
  Configuration config=new Configuration();
  config.setString(JobManagerOptions.ADDRESS,"localhost");
  JobID jobID=new JobID();
  String savepointDirectory="/test/directory";
  String savepointPath="/test/path";
  TestCancelWithSavepointActorGateway gateway=new TestCancelWithSavepointActorGateway(jobID,savepointDirectory,savepointPath);
  TestClusterClient clusterClient=new TestClusterClient(config,gateway);
  try {
    String path=clusterClient.cancelWithSavepoint(jobID,savepointDirectory);
    Assert.assertTrue(gateway.messageArrived);
    Assert.assertEquals(savepointPath,path);
  }
  finally {
    clusterClient.shutdown();
  }
}
