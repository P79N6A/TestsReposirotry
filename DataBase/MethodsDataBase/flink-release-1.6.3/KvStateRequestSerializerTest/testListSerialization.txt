/** 
 * Tests list serialization utils.
 */
@Test public void testListSerialization() throws Exception {
  final long key=0L;
  final KeyGroupRange keyGroupRange=new KeyGroupRange(0,0);
  final HeapKeyedStateBackend<Long> longHeapKeyedStateBackend=new HeapKeyedStateBackend<>(mock(TaskKvStateRegistry.class),LongSerializer.INSTANCE,ClassLoader.getSystemClassLoader(),keyGroupRange.getNumberOfKeyGroups(),keyGroupRange,async,new ExecutionConfig(),TestLocalRecoveryConfig.disabled(),new HeapPriorityQueueSetFactory(keyGroupRange,keyGroupRange.getNumberOfKeyGroups(),128),TtlTimeProvider.DEFAULT);
  longHeapKeyedStateBackend.setCurrentKey(key);
  final InternalListState<Long,VoidNamespace,Long> listState=longHeapKeyedStateBackend.createInternalState(VoidNamespaceSerializer.INSTANCE,new ListStateDescriptor<>("test",LongSerializer.INSTANCE));
  testListSerialization(key,listState);
}
