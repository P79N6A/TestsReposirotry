/** 
 * Tests map serialization utils.
 */
@Test public void testMapSerialization() throws Exception {
  final long key=0L;
  final KeyGroupRange keyGroupRange=new KeyGroupRange(0,0);
  final HeapKeyedStateBackend<Long> longHeapKeyedStateBackend=new HeapKeyedStateBackend<>(mock(TaskKvStateRegistry.class),LongSerializer.INSTANCE,ClassLoader.getSystemClassLoader(),keyGroupRange.getNumberOfKeyGroups(),keyGroupRange,async,new ExecutionConfig(),TestLocalRecoveryConfig.disabled(),new HeapPriorityQueueSetFactory(keyGroupRange,keyGroupRange.getNumberOfKeyGroups(),128),TtlTimeProvider.DEFAULT);
  longHeapKeyedStateBackend.setCurrentKey(key);
  final InternalMapState<Long,VoidNamespace,Long,String> mapState=(InternalMapState<Long,VoidNamespace,Long,String>)longHeapKeyedStateBackend.getPartitionedState(VoidNamespace.INSTANCE,VoidNamespaceSerializer.INSTANCE,new MapStateDescriptor<>("test",LongSerializer.INSTANCE,StringSerializer.INSTANCE));
  testMapSerialization(key,mapState);
}
