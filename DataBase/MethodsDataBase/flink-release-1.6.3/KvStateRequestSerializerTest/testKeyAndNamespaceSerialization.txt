/** 
 * Tests key and namespace serialization utils.
 */
@Test public void testKeyAndNamespaceSerialization() throws Exception {
  TypeSerializer<Long> keySerializer=LongSerializer.INSTANCE;
  TypeSerializer<String> namespaceSerializer=StringSerializer.INSTANCE;
  long expectedKey=Integer.MAX_VALUE + 12323L;
  String expectedNamespace="knilf";
  byte[] serializedKeyAndNamespace=KvStateSerializer.serializeKeyAndNamespace(expectedKey,keySerializer,expectedNamespace,namespaceSerializer);
  Tuple2<Long,String> actual=KvStateSerializer.deserializeKeyAndNamespace(serializedKeyAndNamespace,keySerializer,namespaceSerializer);
  assertEquals(expectedKey,actual.f0.longValue());
  assertEquals(expectedNamespace,actual.f1);
}
