/** 
 * Tests that any preferred locations are calculated.
 */
@Test public void testAnyPreferredLocationCalculation() throws ExecutionException, InterruptedException {
  final TaskManagerLocation taskManagerLocation1=new LocalTaskManagerLocation();
  final TaskManagerLocation taskManagerLocation3=new LocalTaskManagerLocation();
  final CompletableFuture<TaskManagerLocation> locationFuture1=CompletableFuture.completedFuture(taskManagerLocation1);
  final CompletableFuture<TaskManagerLocation> locationFuture2=new CompletableFuture<>();
  final CompletableFuture<TaskManagerLocation> locationFuture3=CompletableFuture.completedFuture(taskManagerLocation3);
  final Execution execution=SchedulerTestUtils.getTestVertex(Arrays.asList(locationFuture1,locationFuture2,locationFuture3));
  CompletableFuture<Collection<TaskManagerLocation>> preferredLocationsFuture=execution.calculatePreferredLocations(LocationPreferenceConstraint.ANY);
  assertTrue(preferredLocationsFuture.isDone());
  final Collection<TaskManagerLocation> preferredLocations=preferredLocationsFuture.get();
  assertThat(preferredLocations,containsInAnyOrder(taskManagerLocation1,taskManagerLocation3));
}
