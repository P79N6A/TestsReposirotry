@Test public void testExceptionPropagationFuturePiping() throws Exception {
  ExceptionalFutureEndpoint rpcEndpoint=new ExceptionalFutureEndpoint(akkaRpcService);
  rpcEndpoint.start();
  ExceptionalGateway rpcGateway=rpcEndpoint.getSelfGateway(ExceptionalGateway.class);
  CompletableFuture<Integer> result=rpcGateway.doStuff();
  try {
    result.get(timeout.getSize(),timeout.getUnit());
    fail("this should fail with an exception");
  }
 catch (  ExecutionException e) {
    Throwable cause=e.getCause();
    assertEquals(Exception.class,cause.getClass());
    assertEquals("some test",cause.getMessage());
  }
}
