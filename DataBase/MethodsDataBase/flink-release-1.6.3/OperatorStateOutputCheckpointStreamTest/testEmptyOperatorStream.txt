@Test public void testEmptyOperatorStream() throws Exception {
  OperatorStateCheckpointOutputStream stream=createStream();
  TestMemoryCheckpointOutputStream innerStream=(TestMemoryCheckpointOutputStream)stream.getDelegate();
  OperatorStateHandle emptyHandle=stream.closeAndGetHandle();
  Assert.assertTrue(innerStream.isClosed());
  Assert.assertEquals(0,stream.getNumberOfPartitions());
  Assert.assertEquals(null,emptyHandle);
}
