@Test public void testOperatorNameTruncation() throws Exception {
  Configuration cfg=new Configuration();
  cfg.setString(MetricOptions.SCOPE_NAMING_OPERATOR,ScopeFormat.SCOPE_OPERATOR_NAME);
  MetricRegistryImpl registry=new MetricRegistryImpl(MetricRegistryConfiguration.fromConfiguration(cfg));
  TaskManagerMetricGroup tm=new TaskManagerMetricGroup(registry,"host","id");
  TaskManagerJobMetricGroup job=new TaskManagerJobMetricGroup(registry,tm,new JobID(),"jobname");
  TaskMetricGroup taskMetricGroup=new TaskMetricGroup(registry,job,new JobVertexID(),new AbstractID(),"task",0,0);
  String originalName=new String(new char[100]).replace("\0","-");
  OperatorMetricGroup operatorMetricGroup=taskMetricGroup.addOperator(originalName);
  String storedName=operatorMetricGroup.getScopeComponents()[0];
  Assert.assertEquals(TaskMetricGroup.METRICS_OPERATOR_NAME_MAX_LENGTH,storedName.length());
  Assert.assertEquals(originalName.substring(0,TaskMetricGroup.METRICS_OPERATOR_NAME_MAX_LENGTH),storedName);
  registry.shutdown().get();
}
