@Test public void testGenerateScopeCustom() throws Exception {
  Configuration cfg=new Configuration();
  cfg.setString(MetricOptions.SCOPE_NAMING_TM,"abc");
  cfg.setString(MetricOptions.SCOPE_NAMING_TM_JOB,"def");
  cfg.setString(MetricOptions.SCOPE_NAMING_TASK,"<tm_id>.<job_id>.<task_id>.<task_attempt_id>");
  MetricRegistryImpl registry=new MetricRegistryImpl(MetricRegistryConfiguration.fromConfiguration(cfg));
  JobID jid=new JobID();
  JobVertexID vertexId=new JobVertexID();
  AbstractID executionId=new AbstractID();
  TaskManagerMetricGroup tmGroup=new TaskManagerMetricGroup(registry,"theHostName","test-tm-id");
  TaskManagerJobMetricGroup jmGroup=new TaskManagerJobMetricGroup(registry,tmGroup,jid,"myJobName");
  TaskMetricGroup taskGroup=new TaskMetricGroup(registry,jmGroup,vertexId,executionId,"aTaskName",13,2);
  assertArrayEquals(new String[]{"test-tm-id",jid.toString(),vertexId.toString(),executionId.toString()},taskGroup.getScopeComponents());
  assertEquals(String.format("test-tm-id.%s.%s.%s.name",jid,vertexId,executionId),taskGroup.getMetricIdentifier("name"));
  registry.shutdown().get();
}
