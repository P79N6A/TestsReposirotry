@Test public void testCreateHadoopFsWithMissingAuthority() throws Exception {
  final URI uri=URI.create("hdfs:///my/path");
  HadoopFsFactory factory=new HadoopFsFactory();
  try {
    factory.create(uri);
    fail("should have failed with an exception");
  }
 catch (  IOException e) {
    assertTrue(e.getMessage().contains("authority"));
  }
}
