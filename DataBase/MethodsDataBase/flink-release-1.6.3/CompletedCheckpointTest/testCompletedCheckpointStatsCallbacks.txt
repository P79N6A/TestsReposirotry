/** 
 * Tests that the stats callbacks happen if the callback is registered.
 */
@Test public void testCompletedCheckpointStatsCallbacks() throws Exception {
  CompletedCheckpoint completed=new CompletedCheckpoint(new JobID(),0,0,1,Collections.emptyMap(),Collections.emptyList(),CheckpointProperties.forCheckpoint(CheckpointRetentionPolicy.NEVER_RETAIN_AFTER_TERMINATION),new TestCompletedCheckpointStorageLocation());
  CompletedCheckpointStats.DiscardCallback callback=mock(CompletedCheckpointStats.DiscardCallback.class);
  completed.setDiscardCallback(callback);
  completed.discardOnShutdown(JobStatus.FINISHED);
  verify(callback,times(1)).notifyDiscardedCheckpoint();
}
