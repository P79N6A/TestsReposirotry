@Test public void removingSingleInstanceOfMetricDoesNotBreakOtherInstances() throws UnirestException {
  Counter counter1=new SimpleCounter();
  counter1.inc(1);
  Counter counter2=new SimpleCounter();
  counter2.inc(2);
  taskMetricGroup1.counter("my_counter",counter1);
  taskMetricGroup2.counter("my_counter",counter2);
  assertThat(CollectorRegistry.defaultRegistry.getSampleValue("flink_taskmanager_job_task_my_counter",LABEL_NAMES,labelValues1),equalTo(1.));
  assertThat(CollectorRegistry.defaultRegistry.getSampleValue("flink_taskmanager_job_task_my_counter",LABEL_NAMES,labelValues2),equalTo(2.));
  taskMetricGroup2.close();
  assertThat(CollectorRegistry.defaultRegistry.getSampleValue("flink_taskmanager_job_task_my_counter",LABEL_NAMES,labelValues1),equalTo(1.));
  taskMetricGroup1.close();
  assertThat(CollectorRegistry.defaultRegistry.getSampleValue("flink_taskmanager_job_task_my_counter",LABEL_NAMES,labelValues1),nullValue());
}
