@Test public void testMergingAssignerWithNonMergingTriggerFails() throws Exception {
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  AllWindowedStream<String,TimeWindow> windowedStream=env.fromElements("Hello","Ciao").windowAll(EventTimeSessionWindows.withGap(Time.seconds(5)));
  try {
    windowedStream.trigger(new Trigger<String,TimeWindow>(){
      private static final long serialVersionUID=6558046711583024443L;
      @Override public TriggerResult onElement(      String element,      long timestamp,      TimeWindow window,      TriggerContext ctx) throws Exception {
        return null;
      }
      @Override public TriggerResult onProcessingTime(      long time,      TimeWindow window,      TriggerContext ctx) throws Exception {
        return null;
      }
      @Override public TriggerResult onEventTime(      long time,      TimeWindow window,      TriggerContext ctx) throws Exception {
        return null;
      }
      @Override public boolean canMerge(){
        return false;
      }
      @Override public void clear(      TimeWindow window,      TriggerContext ctx) throws Exception {
      }
    }
);
  }
 catch (  UnsupportedOperationException e) {
    return;
  }
  fail("The trigger call should fail.");
}
