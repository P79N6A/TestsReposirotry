@Test public void testMultipleAggregation() throws Exception {
  Map<String,List<String>> queryParams=new HashMap<>(4);
  queryParams.put("get",Collections.singletonList("abc.metric1"));
  queryParams.put("agg",Arrays.asList("min","max","avg"));
  HandlerRequest<EmptyRequestBody,P> request=new HandlerRequest<>(EmptyRequestBody.getInstance(),handler.getMessageHeaders().getUnresolvedMessageParameters(),pathParameters,queryParams);
  AggregatedMetricsResponseBody response=handler.handleRequest(request,MOCK_DISPATCHER_GATEWAY).get();
  Collection<AggregatedMetric> aggregatedMetrics=response.getMetrics();
  assertEquals(1,aggregatedMetrics.size());
  AggregatedMetric aggregatedMetric=aggregatedMetrics.iterator().next();
  assertEquals("abc.metric1",aggregatedMetric.getId());
  assertEquals(1.0,aggregatedMetric.getMin(),0.1);
  assertEquals(3.0,aggregatedMetric.getMax(),0.1);
  assertEquals(2.0,aggregatedMetric.getAvg(),0.1);
  assertNull(aggregatedMetric.getSum());
}
