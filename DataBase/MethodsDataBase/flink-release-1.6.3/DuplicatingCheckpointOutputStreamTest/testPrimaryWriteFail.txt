/** 
 * This is the first of a set of tests that check that exceptions from the primary stream are immediately reported.
 */
@Test public void testPrimaryWriteFail() throws Exception {
  DuplicatingCheckpointOutputStream duplicatingStream=createDuplicatingStreamWithFailingPrimary();
  testFailingPrimaryStream(duplicatingStream,() -> {
    for (int i=0; i < 128; i++) {
      duplicatingStream.write(42);
    }
  }
);
}
