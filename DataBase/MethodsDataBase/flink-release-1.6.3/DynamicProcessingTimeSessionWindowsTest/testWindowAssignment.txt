@Test public void testWindowAssignment(){
  WindowAssigner.WindowAssignerContext mockContext=mock(WindowAssigner.WindowAssignerContext.class);
  SessionWindowTimeGapExtractor<String> extractor=mock(SessionWindowTimeGapExtractor.class);
  when(extractor.extract(eq("gap5000"))).thenReturn(5000L);
  when(extractor.extract(eq("gap4000"))).thenReturn(4000L);
  when(extractor.extract(eq("gap9000"))).thenReturn(9000L);
  DynamicProcessingTimeSessionWindows<String> assigner=DynamicProcessingTimeSessionWindows.withDynamicGap(extractor);
  when(mockContext.getCurrentProcessingTime()).thenReturn(0L);
  assertThat(assigner.assignWindows("gap5000",Long.MIN_VALUE,mockContext),contains(timeWindow(0,5000)));
  when(mockContext.getCurrentProcessingTime()).thenReturn(4999L);
  assertThat(assigner.assignWindows("gap4000",Long.MIN_VALUE,mockContext),contains(timeWindow(4999,8999)));
  when(mockContext.getCurrentProcessingTime()).thenReturn(5000L);
  assertThat(assigner.assignWindows("gap9000",Long.MIN_VALUE,mockContext),contains(timeWindow(5000,14000)));
}
