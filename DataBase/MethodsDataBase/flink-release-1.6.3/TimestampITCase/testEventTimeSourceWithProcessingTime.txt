/** 
 * This verifies that an event time source works when setting stream time characteristic to processing time. In this case, the watermarks should just be swallowed.
 */
@Test public void testEventTimeSourceWithProcessingTime() throws Exception {
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(2);
  env.getConfig().disableSysoutLogging();
  env.setStreamTimeCharacteristic(TimeCharacteristic.ProcessingTime);
  DataStream<Integer> source1=env.addSource(new MyTimestampSource(0,10));
  source1.map(new IdentityMap()).transform("Watermark Check",BasicTypeInfo.INT_TYPE_INFO,new CustomOperator(false));
  env.execute();
  Assert.assertTrue(CustomOperator.finalWatermarks[0].size() == 0);
}
