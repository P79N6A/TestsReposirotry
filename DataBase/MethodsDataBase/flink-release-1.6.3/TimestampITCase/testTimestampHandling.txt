/** 
 * These check whether timestamps are properly assigned at the sources and handled in network transmission and between chained operators when timestamps are enabled.
 */
@Test public void testTimestampHandling() throws Exception {
  final int numElements=10;
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime);
  env.setParallelism(PARALLELISM);
  env.getConfig().disableSysoutLogging();
  DataStream<Integer> source1=env.addSource(new MyTimestampSource(0L,numElements));
  DataStream<Integer> source2=env.addSource(new MyTimestampSource(0L,numElements));
  source1.map(new IdentityMap()).connect(source2).map(new IdentityCoMap()).transform("Custom Operator",BasicTypeInfo.INT_TYPE_INFO,new TimestampCheckingOperator()).addSink(new DiscardingSink<Integer>());
  env.execute();
}
