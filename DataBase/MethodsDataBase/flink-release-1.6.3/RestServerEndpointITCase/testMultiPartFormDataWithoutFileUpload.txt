/** 
 * Sending multipart/form-data without a file should result in a bad request if the handler expects a file upload.
 */
@Test public void testMultiPartFormDataWithoutFileUpload() throws Exception {
  final String boundary=generateMultiPartBoundary();
  final String crlf="\r\n";
  final HttpURLConnection connection=openHttpConnectionForUpload(boundary);
  try (OutputStream output=connection.getOutputStream();PrintWriter writer=new PrintWriter(new OutputStreamWriter(output,StandardCharsets.UTF_8),true)){
    writer.append("--" + boundary).append(crlf);
    writer.append("Content-Disposition: form-data; name=\"foo\"").append(crlf);
    writer.append(crlf).flush();
    output.write("test".getBytes(StandardCharsets.UTF_8));
    output.flush();
    writer.append(crlf).flush();
    writer.append("--" + boundary + "--").append(crlf).flush();
  }
   assertEquals(400,connection.getResponseCode());
}
