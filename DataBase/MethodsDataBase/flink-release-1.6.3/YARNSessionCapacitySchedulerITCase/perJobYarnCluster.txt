/** 
 * Test per-job yarn cluster <p>This also tests the prefixed CliFrontend options for the YARN case We also test if the requested parallelism of 2 is passed through. The parallelism is requested at the YARN client (-ys).
 */
@Test public void perJobYarnCluster() throws IOException {
  LOG.info("Starting perJobYarnCluster()");
  addTestAppender(JobClient.class,Level.INFO);
  File exampleJarLocation=getTestJarPath("BatchWordCount.jar");
  runWithArgs(new String[]{"run","-m","yarn-cluster","-yj",flinkUberjar.getAbsolutePath(),"-yt",flinkLibFolder.getAbsolutePath(),"-yn","1","-ys","2","-yjm","768m","-ytm","1024m",exampleJarLocation.getAbsolutePath()},"Program execution finished",new String[]{"DataSink \\(.*\\) \\(1/1\\) switched to FINISHED"},RunTypes.CLI_FRONTEND,0,true);
  LOG.info("Finished perJobYarnCluster()");
}
