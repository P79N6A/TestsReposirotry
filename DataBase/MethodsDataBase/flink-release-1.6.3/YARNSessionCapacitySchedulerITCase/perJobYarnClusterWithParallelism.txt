/** 
 * Test per-job yarn cluster with the parallelism set at the CliFrontend instead of the YARN client.
 */
@Test public void perJobYarnClusterWithParallelism() throws IOException {
  LOG.info("Starting perJobYarnClusterWithParallelism()");
  addTestAppender(JobClient.class,Level.INFO);
  File exampleJarLocation=getTestJarPath("BatchWordCount.jar");
  runWithArgs(new String[]{"run","-p","2","-m","yarn-cluster","-yj",flinkUberjar.getAbsolutePath(),"-yt",flinkLibFolder.getAbsolutePath(),"-yn","1","-ys","2","-yjm","768m","-ytm","1024m",exampleJarLocation.getAbsolutePath()},"Program execution finished",new String[]{"DataSink \\(.*\\) \\(1/1\\) switched to FINISHED"},RunTypes.CLI_FRONTEND,0,true);
  LOG.info("Finished perJobYarnClusterWithParallelism()");
}
