@Test public void testTaskOwnedStateStream() throws Exception {
  final List<String> state=Arrays.asList("Flopsy","Mopsy","Cotton Tail","Peter");
  final MemoryBackendCheckpointStorage storage=new MemoryBackendCheckpointStorage(new JobID(),null,null,DEFAULT_MAX_STATE_SIZE);
  StreamStateHandle stateHandle;
  try (CheckpointStateOutputStream stream=storage.createTaskOwnedStateStream()){
    assertTrue(stream instanceof MemoryCheckpointOutputStream);
    new ObjectOutputStream(stream).writeObject(state);
    stateHandle=stream.closeAndGetHandle();
  }
   try (ObjectInputStream in=new ObjectInputStream(stateHandle.openInputStream())){
    assertEquals(state,in.readObject());
  }
 }
