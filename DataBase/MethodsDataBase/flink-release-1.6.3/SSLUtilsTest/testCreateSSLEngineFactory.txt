/** 
 * Tests that  {@link SSLHandlerFactory} is created correctly.
 */
@Test public void testCreateSSLEngineFactory() throws Exception {
  Configuration serverConfig=createInternalSslConfigWithKeyAndTrustStores();
  serverConfig.setString(SecurityOptions.SSL_PROTOCOL,"TLSv1");
  serverConfig.setString(SecurityOptions.SSL_ALGORITHMS,"TLS_DHE_RSA_WITH_AES_128_CBC_SHA,TLS_DHE_RSA_WITH_AES_128_CBC_SHA256");
  final SSLHandlerFactory serverSSLHandlerFactory=SSLUtils.createInternalServerSSLEngineFactory(serverConfig);
  final SslHandler sslHandler=serverSSLHandlerFactory.createNettySSLHandler();
  assertEquals(1,sslHandler.engine().getEnabledProtocols().length);
  assertEquals("TLSv1",sslHandler.engine().getEnabledProtocols()[0]);
  assertEquals(2,sslHandler.engine().getEnabledCipherSuites().length);
  assertThat(sslHandler.engine().getEnabledCipherSuites(),arrayContainingInAnyOrder("TLS_DHE_RSA_WITH_AES_128_CBC_SHA","TLS_DHE_RSA_WITH_AES_128_CBC_SHA256"));
}
