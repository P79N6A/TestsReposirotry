/** 
 * Tests whether activation of internal / REST SSL evaluates the config flags correctly.
 */
@SuppressWarnings("deprecation") @Test public void checkEnableSSL(){
  Configuration oldConf=new Configuration();
  oldConf.setBoolean(SecurityOptions.SSL_ENABLED,true);
  assertTrue(SSLUtils.isInternalSSLEnabled(oldConf));
  assertTrue(SSLUtils.isRestSSLEnabled(oldConf));
  Configuration newOptions=new Configuration();
  newOptions.setBoolean(SecurityOptions.SSL_INTERNAL_ENABLED,true);
  newOptions.setBoolean(SecurityOptions.SSL_REST_ENABLED,false);
  assertTrue(SSLUtils.isInternalSSLEnabled(newOptions));
  assertFalse(SSLUtils.isRestSSLEnabled(newOptions));
  Configuration precedence=new Configuration();
  precedence.setBoolean(SecurityOptions.SSL_ENABLED,true);
  precedence.setBoolean(SecurityOptions.SSL_INTERNAL_ENABLED,false);
  precedence.setBoolean(SecurityOptions.SSL_REST_ENABLED,false);
  assertFalse(SSLUtils.isInternalSSLEnabled(precedence));
  assertFalse(SSLUtils.isRestSSLEnabled(precedence));
}
