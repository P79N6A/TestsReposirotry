/** 
 * Checks the GET operation fails when the downloaded file (from  {@link BlobServer} or HA store)is corrupt, i.e. its content's hash does not match the  {@link BlobKey}'s hash.
 */
@Test public void testGetFailsFromCorruptFile() throws IOException {
  final Configuration config=new Configuration();
  config.setString(HighAvailabilityOptions.HA_MODE,"ZOOKEEPER");
  config.setString(BlobServerOptions.STORAGE_DIRECTORY,temporaryFolder.newFolder().getAbsolutePath());
  config.setString(HighAvailabilityOptions.HA_STORAGE_PATH,temporaryFolder.newFolder().getPath());
  BlobStoreService blobStoreService=null;
  try {
    blobStoreService=BlobUtils.createBlobStoreFromConfig(config);
    testGetFailsFromCorruptFile(config,blobStoreService,exception);
  }
  finally {
    if (blobStoreService != null) {
      blobStoreService.closeAndCleanupAllData();
    }
  }
}
