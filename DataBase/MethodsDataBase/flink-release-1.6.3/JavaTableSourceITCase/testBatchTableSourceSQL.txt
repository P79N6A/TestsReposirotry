@Test public void testBatchTableSourceSQL() throws Exception {
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  BatchTableEnvironment tableEnv=TableEnvironment.getTableEnvironment(env,config());
  BatchTableSource csvTable=CommonTestData.getCsvTableSource();
  tableEnv.registerTableSource("persons",csvTable);
  Table result=tableEnv.sqlQuery("SELECT `last`, FLOOR(id), score * 2 FROM persons WHERE score < 20");
  DataSet<Row> resultSet=tableEnv.toDataSet(result,Row.class);
  List<Row> results=resultSet.collect();
  String expected="Smith,1,24.6\n" + "Miller,3,15.78\n" + "Smith,4,0.24\n"+ "Miller,6,13.56\n"+ "Williams,8,4.68\n";
  compareResultAsText(results,expected);
}
