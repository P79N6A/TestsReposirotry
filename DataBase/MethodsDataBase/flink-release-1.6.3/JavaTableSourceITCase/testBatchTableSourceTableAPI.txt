@Test public void testBatchTableSourceTableAPI() throws Exception {
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  BatchTableEnvironment tableEnv=TableEnvironment.getTableEnvironment(env,config());
  BatchTableSource csvTable=CommonTestData.getCsvTableSource();
  tableEnv.registerTableSource("persons",csvTable);
  Table result=tableEnv.scan("persons").select("id, first, last, score");
  DataSet<Row> resultSet=tableEnv.toDataSet(result,Row.class);
  List<Row> results=resultSet.collect();
  String expected="1,Mike,Smith,12.3\n" + "2,Bob,Taylor,45.6\n" + "3,Sam,Miller,7.89\n"+ "4,Peter,Smith,0.12\n"+ "5,Liz,Williams,34.5\n"+ "6,Sally,Miller,6.78\n"+ "7,Alice,Smith,90.1\n"+ "8,Kelly,Williams,2.34\n";
  compareResultAsText(results,expected);
}
