@Test(timeout=30_000L) public void testStreamQueryExecutionTable() throws Exception {
  final URL url=getClass().getClassLoader().getResource("test-data.csv");
  Objects.requireNonNull(url);
  final Map<String,String> replaceVars=new HashMap<>();
  replaceVars.put("$VAR_0",url.getPath());
  replaceVars.put("$VAR_1","/");
  replaceVars.put("$VAR_2","streaming");
  replaceVars.put("$VAR_3","table");
  replaceVars.put("$VAR_UPDATE_MODE","update-mode: append");
  replaceVars.put("$VAR_MAX_ROWS","100");
  final String query="SELECT scalarUDF(IntegerField1), StringField1 FROM TableNumber1";
  final List<String> expectedResults=new ArrayList<>();
  expectedResults.add("47,Hello World");
  expectedResults.add("27,Hello World");
  expectedResults.add("37,Hello World");
  expectedResults.add("37,Hello World");
  expectedResults.add("47,Hello World");
  expectedResults.add("57,Hello World!!!!");
  executeStreamQueryTable(replaceVars,query,expectedResults);
}
