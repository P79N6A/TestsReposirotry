@Test(timeout=30_000L) public void testStreamQueryExecutionChangelog() throws Exception {
  final URL url=getClass().getClassLoader().getResource("test-data.csv");
  Objects.requireNonNull(url);
  final Map<String,String> replaceVars=new HashMap<>();
  replaceVars.put("$VAR_0",url.getPath());
  replaceVars.put("$VAR_1","/");
  replaceVars.put("$VAR_2","streaming");
  replaceVars.put("$VAR_3","changelog");
  replaceVars.put("$VAR_UPDATE_MODE","update-mode: append");
  final Executor executor=createModifiedExecutor(clusterClient,replaceVars);
  final SessionContext session=new SessionContext("test-session",new Environment());
  try {
    final ResultDescriptor desc=executor.executeQuery(session,"SELECT scalarUDF(IntegerField1), StringField1 FROM TableNumber1");
    assertFalse(desc.isMaterialized());
    final List<String> actualResults=retrieveChangelogResult(executor,session,desc.getResultId());
    final List<String> expectedResults=new ArrayList<>();
    expectedResults.add("(true,47,Hello World)");
    expectedResults.add("(true,27,Hello World)");
    expectedResults.add("(true,37,Hello World)");
    expectedResults.add("(true,37,Hello World)");
    expectedResults.add("(true,47,Hello World)");
    expectedResults.add("(true,57,Hello World!!!!)");
    TestBaseUtils.compareResultCollections(expectedResults,actualResults,Comparator.naturalOrder());
  }
  finally {
    executor.stop(session);
  }
}
