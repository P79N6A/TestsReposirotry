@Test(timeout=30_000L) public void testBatchQueryExecution() throws Exception {
  final URL url=getClass().getClassLoader().getResource("test-data.csv");
  Objects.requireNonNull(url);
  final Map<String,String> replaceVars=new HashMap<>();
  replaceVars.put("$VAR_0",url.getPath());
  replaceVars.put("$VAR_1","/");
  replaceVars.put("$VAR_2","batch");
  replaceVars.put("$VAR_3","table");
  replaceVars.put("$VAR_UPDATE_MODE","");
  final Executor executor=createModifiedExecutor(clusterClient,replaceVars);
  final SessionContext session=new SessionContext("test-session",new Environment());
  try {
    final ResultDescriptor desc=executor.executeQuery(session,"SELECT IntegerField1 FROM TableNumber1");
    assertTrue(desc.isMaterialized());
    final List<String> actualResults=retrieveTableResult(executor,session,desc.getResultId());
    final List<String> expectedResults=new ArrayList<>();
    expectedResults.add("42");
    expectedResults.add("22");
    expectedResults.add("32");
    expectedResults.add("32");
    expectedResults.add("42");
    expectedResults.add("52");
    TestBaseUtils.compareResultCollections(expectedResults,actualResults,Comparator.naturalOrder());
  }
  finally {
    executor.stop(session);
  }
}
