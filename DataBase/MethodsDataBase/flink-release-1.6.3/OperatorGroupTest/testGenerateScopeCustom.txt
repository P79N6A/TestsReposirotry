@Test public void testGenerateScopeCustom() throws Exception {
  Configuration cfg=new Configuration();
  cfg.setString(MetricOptions.SCOPE_NAMING_OPERATOR,"<tm_id>.<job_id>.<task_id>.<operator_name>.<operator_id>");
  MetricRegistryImpl registry=new MetricRegistryImpl(MetricRegistryConfiguration.fromConfiguration(cfg));
  try {
    String tmID="test-tm-id";
    JobID jid=new JobID();
    JobVertexID vertexId=new JobVertexID();
    OperatorID operatorID=new OperatorID();
    String operatorName="operatorName";
    OperatorMetricGroup operatorGroup=new TaskManagerMetricGroup(registry,"theHostName",tmID).addTaskForJob(jid,"myJobName",vertexId,new ExecutionAttemptID(),"aTaskname",13,2).addOperator(operatorID,operatorName);
    assertArrayEquals(new String[]{tmID,jid.toString(),vertexId.toString(),operatorName,operatorID.toString()},operatorGroup.getScopeComponents());
    assertEquals(String.format("%s.%s.%s.%s.%s.name",tmID,jid,vertexId,operatorName,operatorID),operatorGroup.getMetricIdentifier("name"));
  }
  finally {
    registry.shutdown().get();
  }
}
