/** 
 * Tests that a collision on the manual hash throws an Exception.
 */
@Test(expected=IllegalArgumentException.class) public void testManualHashAssignmentCollisionThrowsException() throws Exception {
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment();
  env.setParallelism(4);
  env.disableOperatorChaining();
  env.addSource(new NoOpSourceFunction()).uid("source").map(new NoOpMapFunction()).uid("source").addSink(new NoOpSinkFunction());
  env.getStreamGraph().getJobGraph();
}
