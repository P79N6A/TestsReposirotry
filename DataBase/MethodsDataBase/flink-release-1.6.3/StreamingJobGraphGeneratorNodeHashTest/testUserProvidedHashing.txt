@Test public void testUserProvidedHashing(){
  StreamExecutionEnvironment env=StreamExecutionEnvironment.createLocalEnvironment();
  List<String> userHashes=Arrays.asList("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa","bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb");
  env.addSource(new NoOpSourceFunction(),"src").setUidHash(userHashes.get(0)).map(new NoOpMapFunction()).filter(new NoOpFilterFunction()).keyBy(new NoOpKeySelector()).reduce(new NoOpReduceFunction()).name("reduce").setUidHash(userHashes.get(1));
  StreamGraph streamGraph=env.getStreamGraph();
  int idx=1;
  for (  JobVertex jobVertex : streamGraph.getJobGraph().getVertices()) {
    List<JobVertexID> idAlternatives=jobVertex.getIdAlternatives();
    Assert.assertEquals(idAlternatives.get(idAlternatives.size() - 1).toString(),userHashes.get(idx));
    --idx;
  }
}
