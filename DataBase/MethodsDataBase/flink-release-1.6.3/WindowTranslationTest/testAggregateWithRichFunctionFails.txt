/** 
 * .aggregate() does not support RichAggregateFunction, since the AggregationFunction is used internally in a  {@code AggregatingState}.
 */
@Test(expected=UnsupportedOperationException.class) public void testAggregateWithRichFunctionFails() throws Exception {
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  DataStream<Tuple2<String,Integer>> source=env.fromElements(Tuple2.of("hello",1),Tuple2.of("hello",2));
  env.setStreamTimeCharacteristic(TimeCharacteristic.ProcessingTime);
  source.keyBy(0).window(SlidingEventTimeWindows.of(Time.of(1,TimeUnit.SECONDS),Time.of(100,TimeUnit.MILLISECONDS))).aggregate(new DummyRichAggregationFunction<Tuple2<String,Integer>>());
  fail("exception was not thrown");
}
