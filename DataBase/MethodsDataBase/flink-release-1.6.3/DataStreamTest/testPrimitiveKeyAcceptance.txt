@Test public void testPrimitiveKeyAcceptance() throws Exception {
  StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(1);
  env.setMaxParallelism(1);
  DataStream<Integer> input=env.fromElements(new Integer(10000));
  KeyedStream<Integer,Object> keyedStream=input.keyBy(new KeySelector<Integer,Object>(){
    @Override public Object getKey(    Integer value) throws Exception {
      return value;
    }
  }
);
  keyedStream.addSink(new SinkFunction<Integer>(){
    @Override public void invoke(    Integer value) throws Exception {
      Assert.assertEquals(10000L,(long)value);
    }
  }
);
}
