/** 
 * Tests pruning of previous checkpoints if a new checkpoint is confirmed.
 */
@Test public void confirmCheckpoint() throws Exception {
  final int chkCount=3;
  final int confirmed=chkCount - 1;
  List<TaskStateSnapshot> taskStateSnapshots=storeStates(chkCount);
  taskLocalStateStore.confirmCheckpoint(confirmed);
  checkPrunedAndDiscarded(taskStateSnapshots,0,confirmed);
  checkStoredAsExpected(taskStateSnapshots,confirmed,chkCount);
}
