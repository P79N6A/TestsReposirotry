/** 
 * Test checkpoint pruning.
 */
@Test public void pruneCheckpoints() throws Exception {
  final int chkCount=3;
  List<TaskStateSnapshot> taskStateSnapshots=storeStates(chkCount);
  taskLocalStateStore.pruneMatchingCheckpoints((  long chk) -> chk != chkCount - 1);
  for (int i=0; i < chkCount - 1; ++i) {
    Assert.assertNull(taskLocalStateStore.retrieveLocalState(i));
  }
  checkStoredAsExpected(taskStateSnapshots,chkCount - 1,chkCount);
}
