/** 
 * This test makes sure that failures properly manifest when the state backend could not be loaded.
 */
@Test public void testLoadingFails() throws Exception {
  final Configuration config=new Configuration();
  config.setString(backendKey,"does.not.exist");
  try {
    StateBackendLoader.fromApplicationOrConfigOrDefault(null,config,cl,null);
    fail("should fail with an exception");
  }
 catch (  DynamicCodeLoadingException ignored) {
  }
  config.setString(backendKey,java.io.File.class.getName());
  try {
    StateBackendLoader.fromApplicationOrConfigOrDefault(null,config,cl,null);
    fail("should fail with an exception");
  }
 catch (  DynamicCodeLoadingException ignored) {
  }
  config.setString(backendKey,FailingFactory.class.getName());
  try {
    StateBackendLoader.fromApplicationOrConfigOrDefault(null,config,cl,null);
    fail("should fail with an exception");
  }
 catch (  IOException ignored) {
  }
}
