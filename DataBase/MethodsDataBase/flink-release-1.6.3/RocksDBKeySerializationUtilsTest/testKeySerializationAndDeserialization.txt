@Test public void testKeySerializationAndDeserialization() throws Exception {
  ByteArrayOutputStreamWithPos outputStream=new ByteArrayOutputStreamWithPos(8);
  DataOutputView outputView=new DataOutputViewStreamWrapper(outputStream);
  for (int orgKey=0; orgKey < 100; ++orgKey) {
    outputStream.reset();
    RocksDBKeySerializationUtils.writeKey(orgKey,IntSerializer.INSTANCE,outputStream,outputView,false);
    ByteArrayInputStreamWithPos inputStream=new ByteArrayInputStreamWithPos(outputStream.toByteArray());
    int deserializedKey=RocksDBKeySerializationUtils.readKey(IntSerializer.INSTANCE,inputStream,new DataInputViewStreamWrapper(inputStream),false);
    Assert.assertEquals(orgKey,deserializedKey);
    RocksDBKeySerializationUtils.writeKey(orgKey,IntSerializer.INSTANCE,outputStream,outputView,true);
    inputStream=new ByteArrayInputStreamWithPos(outputStream.toByteArray());
    deserializedKey=RocksDBKeySerializationUtils.readKey(IntSerializer.INSTANCE,inputStream,new DataInputViewStreamWrapper(inputStream),true);
    Assert.assertEquals(orgKey,deserializedKey);
  }
}
