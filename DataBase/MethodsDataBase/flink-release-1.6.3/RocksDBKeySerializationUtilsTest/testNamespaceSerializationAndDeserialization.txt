@Test public void testNamespaceSerializationAndDeserialization() throws Exception {
  ByteArrayOutputStreamWithPos outputStream=new ByteArrayOutputStreamWithPos(8);
  DataOutputView outputView=new DataOutputViewStreamWrapper(outputStream);
  for (int orgNamespace=0; orgNamespace < 100; ++orgNamespace) {
    outputStream.reset();
    RocksDBKeySerializationUtils.writeNameSpace(orgNamespace,IntSerializer.INSTANCE,outputStream,outputView,false);
    ByteArrayInputStreamWithPos inputStream=new ByteArrayInputStreamWithPos(outputStream.toByteArray());
    int deserializedNamepsace=RocksDBKeySerializationUtils.readNamespace(IntSerializer.INSTANCE,inputStream,new DataInputViewStreamWrapper(inputStream),false);
    Assert.assertEquals(orgNamespace,deserializedNamepsace);
    RocksDBKeySerializationUtils.writeNameSpace(orgNamespace,IntSerializer.INSTANCE,outputStream,outputView,true);
    inputStream=new ByteArrayInputStreamWithPos(outputStream.toByteArray());
    deserializedNamepsace=RocksDBKeySerializationUtils.readNamespace(IntSerializer.INSTANCE,inputStream,new DataInputViewStreamWrapper(inputStream),true);
    Assert.assertEquals(orgNamespace,deserializedNamepsace);
  }
}
