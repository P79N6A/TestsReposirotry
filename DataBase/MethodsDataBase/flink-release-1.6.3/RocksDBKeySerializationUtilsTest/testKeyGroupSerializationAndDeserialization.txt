@Test public void testKeyGroupSerializationAndDeserialization() throws Exception {
  ByteArrayOutputStreamWithPos outputStream=new ByteArrayOutputStreamWithPos(8);
  DataOutputView outputView=new DataOutputViewStreamWrapper(outputStream);
  for (int keyGroupPrefixBytes=1; keyGroupPrefixBytes <= 2; ++keyGroupPrefixBytes) {
    for (int orgKeyGroup=0; orgKeyGroup < 128; ++orgKeyGroup) {
      outputStream.reset();
      RocksDBKeySerializationUtils.writeKeyGroup(orgKeyGroup,keyGroupPrefixBytes,outputView);
      int deserializedKeyGroup=RocksDBKeySerializationUtils.readKeyGroup(keyGroupPrefixBytes,new DataInputViewStreamWrapper(new ByteArrayInputStreamWithPos(outputStream.toByteArray())));
      Assert.assertEquals(orgKeyGroup,deserializedKeyGroup);
    }
  }
}
