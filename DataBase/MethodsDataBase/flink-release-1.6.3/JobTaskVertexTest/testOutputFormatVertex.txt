@Test public void testOutputFormatVertex(){
  try {
    final OutputFormat outputFormat=new TestingOutputFormat();
    final OutputFormatVertex of=new OutputFormatVertex("Name");
    new TaskConfig(of.getConfiguration()).setStubWrapper(new UserCodeObjectWrapper<OutputFormat<?>>(outputFormat));
    final ClassLoader cl=new TestClassLoader();
    try {
      of.initializeOnMaster(cl);
      fail("Did not throw expected exception.");
    }
 catch (    TestException e) {
    }
    OutputFormatVertex copy=InstantiationUtil.clone(of);
    ClassLoader ctxCl=Thread.currentThread().getContextClassLoader();
    try {
      copy.initializeOnMaster(cl);
      fail("Did not throw expected exception.");
    }
 catch (    TestException e) {
    }
    assertEquals("Previous classloader was not restored.",ctxCl,Thread.currentThread().getContextClassLoader());
    try {
      copy.finalizeOnMaster(cl);
      fail("Did not throw expected exception.");
    }
 catch (    TestException e) {
    }
    assertEquals("Previous classloader was not restored.",ctxCl,Thread.currentThread().getContextClassLoader());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
