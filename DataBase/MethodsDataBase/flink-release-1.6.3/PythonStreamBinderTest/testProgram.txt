@Test public void testProgram() throws Exception {
  Path testEntryPoint=new Path(getBaseTestPythonDir(),"examples/word_count.py");
  List<String> testFiles=findTestFiles();
  Preconditions.checkState(testFiles.size() > 0,"No test files were found in {}.",getBaseTestPythonDir());
  String[] arguments=new String[1 + 1 + testFiles.size()];
  arguments[0]=testEntryPoint.getPath();
  arguments[1]=findUtilsModule().getPath();
  int index=2;
  for (  String testFile : testFiles) {
    arguments[index]=testFile;
    index++;
  }
  try {
    new PythonStreamBinder(new Configuration()).runPlan(arguments);
  }
 catch (  PyException e) {
    if (e.getCause() instanceof JobExecutionException) {
      throw (JobExecutionException)e.getCause();
    }
 else {
      throw e;
    }
  }
}
