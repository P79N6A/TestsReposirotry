/** 
 * Crashes the handler be submitting a malformed multipart request and tests that the upload directory is cleaned up.
 */
@Test public void testUploadCleanupOnFailure() throws IOException {
  OkHttpClient client=new OkHttpClient();
  Request request=buildMalformedRequest(MULTIPART_UPLOAD_RESOURCE.getMixedHandler().getMessageHeaders().getTargetRestEndpointURL());
  try (Response response=client.newCall(request).execute()){
    assertEquals(HttpResponseStatus.INTERNAL_SERVER_ERROR.code(),response.code());
  }
   MULTIPART_UPLOAD_RESOURCE.assertUploadDirectoryIsEmpty();
}
