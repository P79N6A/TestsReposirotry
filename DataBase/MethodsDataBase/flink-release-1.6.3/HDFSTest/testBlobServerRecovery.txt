/** 
 * Tests that with  {@link HighAvailabilityMode#ZOOKEEPER} distributed JARs are recoverable from anyparticipating BlobServer when talking to the  {@link org.apache.flink.runtime.blob.BlobServer} directly.
 */
@Test public void testBlobServerRecovery() throws Exception {
  org.apache.flink.configuration.Configuration config=new org.apache.flink.configuration.Configuration();
  config.setString(HighAvailabilityOptions.HA_MODE,"ZOOKEEPER");
  config.setString(BlobServerOptions.STORAGE_DIRECTORY,temporaryFolder.newFolder().getAbsolutePath());
  config.setString(HighAvailabilityOptions.HA_STORAGE_PATH,hdfsURI);
  BlobStoreService blobStoreService=BlobUtils.createBlobStoreFromConfig(config);
  try {
    BlobServerRecoveryTest.testBlobServerRecovery(config,blobStoreService);
  }
  finally {
    blobStoreService.closeAndCleanupAllData();
  }
}
