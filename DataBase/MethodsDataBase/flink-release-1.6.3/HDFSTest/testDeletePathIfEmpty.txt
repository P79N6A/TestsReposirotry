/** 
 * Test that  {@link FileUtils#deletePathIfEmpty(FileSystem,Path)} deletes the path if it isempty. A path can only be empty if it is a directory which does not contain any files/directories.
 */
@Test public void testDeletePathIfEmpty() throws IOException {
  final Path basePath=new Path(hdfsURI);
  final Path directory=new Path(basePath,UUID.randomUUID().toString());
  final Path directoryFile=new Path(directory,UUID.randomUUID().toString());
  final Path singleFile=new Path(basePath,UUID.randomUUID().toString());
  FileSystem fs=basePath.getFileSystem();
  fs.mkdirs(directory);
  byte[] data="HDFSTest#testDeletePathIfEmpty".getBytes(ConfigConstants.DEFAULT_CHARSET);
  for (  Path file : Arrays.asList(singleFile,directoryFile)) {
    org.apache.flink.core.fs.FSDataOutputStream outputStream=fs.create(file,FileSystem.WriteMode.OVERWRITE);
    outputStream.write(data);
    outputStream.close();
  }
  assertTrue(fs.exists(singleFile));
  assertTrue(fs.exists(directoryFile));
  assertFalse(FileUtils.deletePathIfEmpty(fs,singleFile));
  assertTrue(fs.exists(singleFile));
  assertFalse(FileUtils.deletePathIfEmpty(fs,directory));
  assertTrue(fs.exists(directory));
  assertTrue(fs.delete(directoryFile,false));
  assertTrue(FileUtils.deletePathIfEmpty(fs,directory));
  assertFalse(fs.exists(directory));
}
