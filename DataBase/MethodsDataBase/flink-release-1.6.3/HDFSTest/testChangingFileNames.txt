@Test public void testChangingFileNames(){
  org.apache.hadoop.fs.Path hdfsPath=new org.apache.hadoop.fs.Path(hdfsURI + "/hdfsTest");
  Path path=new Path(hdfsPath.toString());
  String type="one";
  TextOutputFormat<String> outputFormat=new TextOutputFormat<>(path);
  outputFormat.setWriteMode(FileSystem.WriteMode.NO_OVERWRITE);
  outputFormat.setOutputDirectoryMode(FileOutputFormat.OutputDirectoryMode.ALWAYS);
  try {
    outputFormat.open(0,2);
    outputFormat.writeRecord(type);
    outputFormat.close();
    outputFormat.open(1,2);
    outputFormat.writeRecord(type);
    outputFormat.close();
    assertTrue("No result file present",hdfs.exists(hdfsPath));
    FileStatus[] files=hdfs.listStatus(hdfsPath);
    Assert.assertEquals(2,files.length);
    for (    FileStatus file : files) {
      assertTrue("1".equals(file.getPath().getName()) || "2".equals(file.getPath().getName()));
    }
  }
 catch (  IOException e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}
