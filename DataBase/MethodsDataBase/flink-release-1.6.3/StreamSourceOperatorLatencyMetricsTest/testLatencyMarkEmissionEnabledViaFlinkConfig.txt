/** 
 * Verifies that latency metrics can be enabled via the configuration.
 */
@Test public void testLatencyMarkEmissionEnabledViaFlinkConfig() throws Exception {
  testLatencyMarkEmission((int)(maxProcessingTime / latencyMarkInterval) + 1,(operator,timeProvider) -> {
    Configuration tmConfig=new Configuration();
    tmConfig.setLong(MetricOptions.LATENCY_INTERVAL,latencyMarkInterval);
    Environment env=MockEnvironment.builder().setTaskManagerRuntimeInfo(new TestingTaskManagerRuntimeInfo(tmConfig)).build();
    setupSourceOperator(operator,new ExecutionConfig(),env,timeProvider);
  }
);
}
