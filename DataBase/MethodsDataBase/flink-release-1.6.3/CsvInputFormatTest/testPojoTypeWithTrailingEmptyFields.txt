@Test public void testPojoTypeWithTrailingEmptyFields() throws Exception {
  final String fileContent="123,,3.123,,\n456,BBB,3.23,,";
  final FileInputSplit split=createTempFile(fileContent);
  @SuppressWarnings("unchecked") PojoTypeInfo<PrivatePojoItem> typeInfo=(PojoTypeInfo<PrivatePojoItem>)TypeExtractor.createTypeInfo(PrivatePojoItem.class);
  CsvInputFormat<PrivatePojoItem> inputFormat=new PojoCsvInputFormat<PrivatePojoItem>(PATH,typeInfo);
  inputFormat.configure(new Configuration());
  inputFormat.open(split);
  PrivatePojoItem item=new PrivatePojoItem();
  inputFormat.nextRecord(item);
  assertEquals(123,item.field1);
  assertEquals("",item.field2);
  assertEquals(Double.valueOf(3.123),item.field3);
  assertEquals("",item.field4);
  inputFormat.nextRecord(item);
  assertEquals(456,item.field1);
  assertEquals("BBB",item.field2);
  assertEquals(Double.valueOf(3.23),item.field3);
  assertEquals("",item.field4);
}
