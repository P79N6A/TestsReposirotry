@Test public void getMapFor() throws Exception {
  MetricFetcher fetcher=new MetricFetcher(mock(GatewayRetriever.class),mock(MetricQueryServiceRetriever.class),Executors.directExecutor(),TestingUtils.TIMEOUT());
  MetricStore store=MetricStoreTest.setupStore(fetcher.getMetricStore());
  TaskManagerMetricsHandler handler=new TaskManagerMetricsHandler(Executors.directExecutor(),fetcher);
  Map<String,String> pathParams=new HashMap<>();
  pathParams.put(TASK_MANAGER_ID_KEY,"tmid");
  Map<String,String> metrics=handler.getMapFor(pathParams,store);
  assertEquals("1",metrics.get("abc.metric2"));
}
