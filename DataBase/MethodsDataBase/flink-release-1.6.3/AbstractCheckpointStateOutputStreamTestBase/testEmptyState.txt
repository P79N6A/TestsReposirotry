/** 
 * Validates that even empty streams create a file and a file state handle.
 */
@Test public void testEmptyState() throws Exception {
  final FileSystem fs=FileSystem.getLocalFileSystem();
  final Path folder=baseFolder();
  final String fileName="myFileName";
  final Path filePath=new Path(folder,fileName);
  final FileStateHandle handle;
  try (FSDataOutputStream stream=createTestStream(fs,folder,fileName)){
    handle=closeAndGetResult(stream);
  }
   assertNotNull(handle);
  assertEquals(filePath,handle.getFilePath());
  assertTrue(fs.exists(handle.getFilePath()));
  assertFalse(fs.getFileStatus(filePath).isDir());
  try (FSDataInputStream in=handle.openInputStream()){
    assertEquals(-1,in.read());
  }
 }
