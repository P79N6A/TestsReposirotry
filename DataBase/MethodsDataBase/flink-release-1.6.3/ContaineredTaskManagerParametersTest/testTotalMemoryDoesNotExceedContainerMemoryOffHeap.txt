/** 
 * This tests that when using on-heap memory the sum of on and off heap memory does not exceed the container maximum.
 */
@Test public void testTotalMemoryDoesNotExceedContainerMemoryOffHeap(){
  Configuration conf=new Configuration();
  conf.setBoolean(MEMORY_OFF_HEAP,true);
  ContaineredTaskManagerParameters params=ContaineredTaskManagerParameters.create(conf,CONTAINER_MEMORY,1);
  assertTrue(params.taskManagerDirectMemoryLimitMB() > 0L);
  assertTrue(params.taskManagerHeapSizeMB() + params.taskManagerDirectMemoryLimitMB() <= CONTAINER_MEMORY);
}
