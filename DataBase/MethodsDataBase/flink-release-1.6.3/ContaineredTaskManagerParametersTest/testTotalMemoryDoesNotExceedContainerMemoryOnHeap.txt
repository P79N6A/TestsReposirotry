/** 
 * This tests that when using off-heap memory the sum of on and off heap memory does not exceed the container maximum.
 */
@Test public void testTotalMemoryDoesNotExceedContainerMemoryOnHeap(){
  Configuration conf=new Configuration();
  conf.setBoolean(MEMORY_OFF_HEAP,false);
  ContaineredTaskManagerParameters params=ContaineredTaskManagerParameters.create(conf,CONTAINER_MEMORY,1);
  assertTrue(params.taskManagerDirectMemoryLimitMB() > 0L);
  assertTrue(params.taskManagerHeapSizeMB() + params.taskManagerDirectMemoryLimitMB() <= CONTAINER_MEMORY);
}
