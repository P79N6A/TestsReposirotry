@Test(timeout=5000) public void testThrowErrorOnSnapshot() throws Exception {
  TestCassandraSink casSinkFunc=new TestCassandraSink();
  OneInputStreamOperatorTestHarness<String,Object> testHarness=new OneInputStreamOperatorTestHarness<>(new StreamSink<>(casSinkFunc));
  testHarness.open();
  Exception cause=new RuntimeException();
  casSinkFunc.setResultFuture(ResultSetFutures.fromCompletableFuture(FutureUtils.getFailedFuture(cause)));
  casSinkFunc.invoke("hello");
  try {
    testHarness.snapshot(123L,123L);
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertTrue(e.getCause() instanceof IOException);
    Assert.assertEquals(cause,e.getCause().getCause());
    Assert.assertEquals(0,casSinkFunc.getNumOfPendingRecords());
  }
  testHarness.close();
}
