@Test(timeout=5000) public void testThrowErrorOnClose() throws Exception {
  TestCassandraSink casSinkFunc=new TestCassandraSink();
  casSinkFunc.open(new Configuration());
  Exception cause=new RuntimeException();
  casSinkFunc.setResultFuture(ResultSetFutures.fromCompletableFuture(FutureUtils.getFailedFuture(cause)));
  casSinkFunc.invoke("hello");
  try {
    casSinkFunc.close();
    Assert.fail("Close should have thrown an exception.");
  }
 catch (  IOException e) {
    Assert.assertEquals(cause,e.getCause());
    Assert.assertEquals(0,casSinkFunc.getNumOfPendingRecords());
  }
}
