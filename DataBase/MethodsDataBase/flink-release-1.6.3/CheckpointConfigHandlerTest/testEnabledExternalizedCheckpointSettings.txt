/** 
 * Tests that the externalized checkpoint settings are forwarded.
 */
@Test public void testEnabledExternalizedCheckpointSettings() throws Exception {
  GraphAndSettings graphAndSettings=createGraphAndSettings(true,false);
  AccessExecutionGraph graph=graphAndSettings.graph;
  CheckpointRetentionPolicy retentionPolicy=graphAndSettings.retentionPolicy;
  CheckpointConfigHandler handler=new CheckpointConfigHandler(mock(ExecutionGraphCache.class),Executors.directExecutor());
  String json=handler.handleRequest(graph,Collections.<String,String>emptyMap()).get();
  ObjectMapper mapper=new ObjectMapper();
  JsonNode externalizedNode=mapper.readTree(json).get("externalization");
  assertNotNull(externalizedNode);
  assertEquals(retentionPolicy != CheckpointRetentionPolicy.NEVER_RETAIN_AFTER_TERMINATION,externalizedNode.get("enabled").asBoolean());
  assertEquals(retentionPolicy != CheckpointRetentionPolicy.RETAIN_ON_CANCELLATION,externalizedNode.get("delete_on_cancellation").asBoolean());
}
