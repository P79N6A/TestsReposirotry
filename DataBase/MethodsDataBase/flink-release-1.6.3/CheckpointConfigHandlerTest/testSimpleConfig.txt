/** 
 * Tests a simple config.
 */
@Test public void testSimpleConfig() throws Exception {
  GraphAndSettings graphAndSettings=createGraphAndSettings(false,true);
  AccessExecutionGraph graph=graphAndSettings.graph;
  CheckpointCoordinatorConfiguration chkConfig=graphAndSettings.jobCheckpointingConfiguration;
  CheckpointConfigHandler handler=new CheckpointConfigHandler(mock(ExecutionGraphCache.class),Executors.directExecutor());
  String json=handler.handleRequest(graph,Collections.<String,String>emptyMap()).get();
  ObjectMapper mapper=new ObjectMapper();
  JsonNode rootNode=mapper.readTree(json);
  assertEquals("exactly_once",rootNode.get("mode").asText());
  assertEquals(chkConfig.getCheckpointInterval(),rootNode.get("interval").asLong());
  assertEquals(chkConfig.getCheckpointTimeout(),rootNode.get("timeout").asLong());
  assertEquals(chkConfig.getMinPauseBetweenCheckpoints(),rootNode.get("min_pause").asLong());
  assertEquals(chkConfig.getMaxConcurrentCheckpoints(),rootNode.get("max_concurrent").asInt());
  JsonNode externalizedNode=rootNode.get("externalization");
  assertNotNull(externalizedNode);
  assertEquals(false,externalizedNode.get("enabled").asBoolean());
}
