@Test public void testDoubleFields() throws Exception {
  String fileContent="11.1|22.2|33.3|44.4|55.5\n66.6|77.7|88.8|99.9|00.0|\n";
  FileInputSplit split=createTempFile(fileContent);
  TypeInformation[] fieldTypes=new TypeInformation[]{BasicTypeInfo.DOUBLE_TYPE_INFO,BasicTypeInfo.DOUBLE_TYPE_INFO,BasicTypeInfo.DOUBLE_TYPE_INFO,BasicTypeInfo.DOUBLE_TYPE_INFO,BasicTypeInfo.DOUBLE_TYPE_INFO};
  RowCsvInputFormat format=new RowCsvInputFormat(PATH,fieldTypes);
  format.setFieldDelimiter("|");
  format.configure(new Configuration());
  format.open(split);
  Row result=new Row(5);
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals(11.1,result.getField(0));
  assertEquals(22.2,result.getField(1));
  assertEquals(33.3,result.getField(2));
  assertEquals(44.4,result.getField(3));
  assertEquals(55.5,result.getField(4));
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals(66.6,result.getField(0));
  assertEquals(77.7,result.getField(1));
  assertEquals(88.8,result.getField(2));
  assertEquals(99.9,result.getField(3));
  assertEquals(0.0,result.getField(4));
  result=format.nextRecord(result);
  assertNull(result);
  assertTrue(format.reachedEnd());
}
