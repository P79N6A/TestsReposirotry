@Test public void testEmptyFields() throws Exception {
  String fileContent=",,,,,,,,\n" + ",,,,,,,\n" + ",,,,,,,,\n"+ ",,,,,,,\n"+ ",,,,,,,,\n"+ ",,,,,,,,\n"+ ",,,,,,,\n"+ ",,,,,,,,\n";
  FileInputSplit split=createTempFile(fileContent);
  TypeInformation[] fieldTypes=new TypeInformation[]{BasicTypeInfo.BOOLEAN_TYPE_INFO,BasicTypeInfo.BYTE_TYPE_INFO,BasicTypeInfo.DOUBLE_TYPE_INFO,BasicTypeInfo.FLOAT_TYPE_INFO,BasicTypeInfo.INT_TYPE_INFO,BasicTypeInfo.LONG_TYPE_INFO,BasicTypeInfo.SHORT_TYPE_INFO,BasicTypeInfo.STRING_TYPE_INFO};
  RowCsvInputFormat format=new RowCsvInputFormat(PATH,fieldTypes,true);
  format.setFieldDelimiter(",");
  format.configure(new Configuration());
  format.open(split);
  Row result=new Row(8);
  int linesCnt=fileContent.split("\n").length;
  for (int i=0; i < linesCnt; i++) {
    result=format.nextRecord(result);
    assertNull(result.getField(i));
  }
  assertNull(format.nextRecord(result));
  assertTrue(format.reachedEnd());
}
