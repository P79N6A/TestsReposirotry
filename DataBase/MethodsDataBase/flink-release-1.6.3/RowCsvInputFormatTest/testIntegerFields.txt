@Test public void testIntegerFields() throws Exception {
  String fileContent="111|222|333|444|555\n666|777|888|999|000|\n";
  FileInputSplit split=createTempFile(fileContent);
  TypeInformation[] fieldTypes=new TypeInformation[]{BasicTypeInfo.INT_TYPE_INFO,BasicTypeInfo.INT_TYPE_INFO,BasicTypeInfo.INT_TYPE_INFO,BasicTypeInfo.INT_TYPE_INFO,BasicTypeInfo.INT_TYPE_INFO};
  RowCsvInputFormat format=new RowCsvInputFormat(PATH,fieldTypes,"\n","|");
  format.setFieldDelimiter("|");
  format.configure(new Configuration());
  format.open(split);
  Row result=new Row(5);
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals(111,result.getField(0));
  assertEquals(222,result.getField(1));
  assertEquals(333,result.getField(2));
  assertEquals(444,result.getField(3));
  assertEquals(555,result.getField(4));
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals(666,result.getField(0));
  assertEquals(777,result.getField(1));
  assertEquals(888,result.getField(2));
  assertEquals(999,result.getField(3));
  assertEquals(0,result.getField(4));
  result=format.nextRecord(result);
  assertNull(result);
  assertTrue(format.reachedEnd());
}
