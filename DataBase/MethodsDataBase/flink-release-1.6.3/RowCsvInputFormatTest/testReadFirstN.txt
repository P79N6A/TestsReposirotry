@Test public void testReadFirstN() throws Exception {
  String fileContent="111|222|333|444|555|\n666|777|888|999|000|\n";
  FileInputSplit split=createTempFile(fileContent);
  TypeInformation[] fieldTypes=new TypeInformation[]{BasicTypeInfo.INT_TYPE_INFO,BasicTypeInfo.INT_TYPE_INFO};
  RowCsvInputFormat format=new RowCsvInputFormat(PATH,fieldTypes);
  format.setFieldDelimiter("|");
  format.configure(new Configuration());
  format.open(split);
  Row result=new Row(2);
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals(111,result.getField(0));
  assertEquals(222,result.getField(1));
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals(666,result.getField(0));
  assertEquals(777,result.getField(1));
  result=format.nextRecord(result);
  assertNull(result);
  assertTrue(format.reachedEnd());
}
