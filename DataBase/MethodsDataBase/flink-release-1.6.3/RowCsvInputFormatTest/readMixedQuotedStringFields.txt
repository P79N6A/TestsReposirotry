@Test public void readMixedQuotedStringFields() throws Exception {
  String fileContent="@a|b|c@|def|@ghijk@\nabc||@|hhg@\n|||\n";
  FileInputSplit split=createTempFile(fileContent);
  TypeInformation[] fieldTypes=new TypeInformation[]{BasicTypeInfo.STRING_TYPE_INFO,BasicTypeInfo.STRING_TYPE_INFO,BasicTypeInfo.STRING_TYPE_INFO};
  RowCsvInputFormat format=new RowCsvInputFormat(PATH,fieldTypes,"\n","|");
  format.configure(new Configuration());
  format.enableQuotedStringParsing('@');
  format.open(split);
  Row result=new Row(3);
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals("a|b|c",result.getField(0));
  assertEquals("def",result.getField(1));
  assertEquals("ghijk",result.getField(2));
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals("abc",result.getField(0));
  assertEquals("",result.getField(1));
  assertEquals("|hhg",result.getField(2));
  result=format.nextRecord(result);
  assertNotNull(result);
  assertEquals("",result.getField(0));
  assertEquals("",result.getField(1));
  assertEquals("",result.getField(2));
  result=format.nextRecord(result);
  assertNull(result);
  assertTrue(format.reachedEnd());
}
