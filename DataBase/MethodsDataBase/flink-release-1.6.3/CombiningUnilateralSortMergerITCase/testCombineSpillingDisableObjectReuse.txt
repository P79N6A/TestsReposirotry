@Test public void testCombineSpillingDisableObjectReuse() throws Exception {
  int noKeys=100;
  int noKeyCnt=10000;
  TestData.MockTuple2Reader<Tuple2<Integer,Integer>> reader=TestData.getIntIntTupleReader();
  LOG.debug("initializing sortmerger");
  MaterializedCountCombiner comb=new MaterializedCountCombiner();
  Sorter<Tuple2<Integer,Integer>> merger=new CombiningUnilateralSortMerger<>(comb,this.memoryManager,this.ioManager,reader,this.parentTask,this.serializerFactory2,this.comparator2,0.01,2,0.005f,true,false);
  final Tuple2<Integer,Integer> rec=new Tuple2<>();
  for (int i=0; i < noKeyCnt; i++) {
    rec.setField(i,0);
    for (int j=0; j < noKeys; j++) {
      rec.setField(j,1);
      reader.emit(rec);
    }
  }
  reader.close();
  MutableObjectIterator<Tuple2<Integer,Integer>> iterator=merger.getIterator();
  Iterator<Integer> result=getReducingIterator(iterator,serializerFactory2.getSerializer(),comparator2.duplicate());
  while (result.hasNext()) {
    Assert.assertEquals(4950,result.next().intValue());
  }
  merger.close();
}
