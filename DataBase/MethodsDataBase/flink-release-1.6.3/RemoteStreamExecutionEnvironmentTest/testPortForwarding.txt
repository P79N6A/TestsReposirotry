/** 
 * Verifies that the port passed to the RemoteStreamEnvironment is used for connecting to the cluster.
 */
@Test public void testPortForwarding() throws Exception {
  final Configuration clientConfiguration=new Configuration();
  clientConfiguration.setInteger(RestOptions.RETRY_MAX_ATTEMPTS,0);
  final StreamExecutionEnvironment env=StreamExecutionEnvironment.createRemoteEnvironment(flink.getRestAddress().getHost(),flink.getRestAddress().getPort(),clientConfiguration);
  final DataStream<Integer> resultStream=env.fromElements(1).map(x -> x * 2);
  final Iterator<Integer> result=DataStreamUtils.collect(resultStream);
  Assert.assertTrue(result.hasNext());
  Assert.assertEquals(2,result.next().intValue());
  Assert.assertFalse(result.hasNext());
}
