@Test public void testDoNotCancelJobIfSavepointFails() throws Exception {
  try {
    Files.setPosixFilePermissions(savepointDirectory,Collections.emptySet());
  }
 catch (  IOException e) {
    Assume.assumeNoException(e);
  }
  try {
    cancelWithSavepoint();
  }
 catch (  Exception e) {
    assertThat(ExceptionUtils.findThrowable(e,CheckpointTriggerException.class).isPresent(),equalTo(true));
  }
  final JobStatus jobStatus=clusterClient.getJobStatus(jobGraph.getJobID()).get(60,TimeUnit.SECONDS);
  assertThat(jobStatus,equalTo(JobStatus.RUNNING));
  triggerCheckpointLatch=new CountDownLatch(1);
  assertThat(triggerCheckpointLatch.await(60,TimeUnit.SECONDS),equalTo(true));
}
