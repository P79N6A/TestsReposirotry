@Test public void testMaximumRegistrationDuration() throws Exception {
  configuration.setString(TaskManagerOptions.REGISTRATION_TIMEOUT,"10 ms");
  final TaskExecutor taskExecutor=createTaskExecutor(new TaskManagerServicesBuilder().build());
  taskExecutor.start();
  try {
    final Throwable error=testingFatalErrorHandler.getErrorFuture().get();
    assertThat(error,is(notNullValue()));
    assertThat(ExceptionUtils.stripExecutionException(error),instanceOf(RegistrationTimeoutException.class));
    testingFatalErrorHandler.clearError();
  }
  finally {
    RpcUtils.terminateRpcEndpoint(taskExecutor,timeout);
  }
}
