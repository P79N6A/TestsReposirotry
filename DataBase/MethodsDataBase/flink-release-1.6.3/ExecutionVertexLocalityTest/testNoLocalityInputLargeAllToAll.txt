/** 
 * This test validates that vertices with too many input streams do not have a location preference any more.
 */
@Test public void testNoLocalityInputLargeAllToAll() throws Exception {
  final int parallelism=100;
  final ExecutionGraph graph=createTestGraph(parallelism,true);
  for (int i=0; i < parallelism; i++) {
    ExecutionVertex source=graph.getAllVertices().get(sourceVertexId).getTaskVertices()[i];
    TaskManagerLocation location=new TaskManagerLocation(ResourceID.generate(),InetAddress.getLoopbackAddress(),10000 + i);
    initializeLocation(source,location);
  }
  for (int i=0; i < parallelism; i++) {
    ExecutionVertex target=graph.getAllVertices().get(targetVertexId).getTaskVertices()[i];
    Iterator<CompletableFuture<TaskManagerLocation>> preference=target.getPreferredLocations().iterator();
    assertFalse(preference.hasNext());
  }
}
