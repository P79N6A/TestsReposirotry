/** 
 * Tests scalar resource accounting.
 */
@Test public void testScalarResourceAccounting(){
  MesosResourceAllocation allocation;
  allocation=new MesosResourceAllocation(resources(cpus(1.0)));
  Assert.assertEquals(resources(cpus(0.25)),allocation.takeScalar("cpus",0.25,AS_NO_ROLE));
  Assert.assertEquals(resources(cpus(0.75)),allocation.getRemaining());
  allocation=new MesosResourceAllocation(resources(cpus(1.0)));
  Assert.assertEquals(resources(cpus(1.0)),allocation.takeScalar("cpus",1.0,AS_NO_ROLE));
  Assert.assertEquals(resources(),allocation.getRemaining());
  allocation=new MesosResourceAllocation(resources(cpus(ROLE_A,1.0),cpus(UNRESERVED_ROLE,1.0)));
  Assert.assertEquals(resources(cpus(ROLE_A,1.0),cpus(UNRESERVED_ROLE,0.25)),allocation.takeScalar("cpus",1.25,AS_ROLE_A));
  Assert.assertEquals(resources(cpus(UNRESERVED_ROLE,0.75)),allocation.getRemaining());
}
