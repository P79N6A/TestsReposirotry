@Test public void testHookReset() throws Exception {
  final String id1="id1";
  final String id2="id2";
  final MasterTriggerRestoreHook<String> hook1=mockGeneric(MasterTriggerRestoreHook.class);
  when(hook1.getIdentifier()).thenReturn(id1);
  final MasterTriggerRestoreHook<String> hook2=mockGeneric(MasterTriggerRestoreHook.class);
  when(hook2.getIdentifier()).thenReturn(id2);
  final JobID jid=new JobID();
  final ExecutionAttemptID execId=new ExecutionAttemptID();
  final ExecutionVertex ackVertex=mockExecutionVertex(execId);
  final CheckpointCoordinator cc=instantiateCheckpointCoordinator(jid,ackVertex);
  cc.addMasterHook(hook1);
  cc.addMasterHook(hook2);
  cc.restoreLatestCheckpointedState(Collections.<JobVertexID,ExecutionJobVertex>emptyMap(),false,false);
  verify(hook1,times(1)).reset();
  verify(hook2,times(1)).reset();
  cc.shutdown(JobStatus.CANCELED);
  verify(hook1,times(1)).close();
  verify(hook2,times(1)).close();
}
