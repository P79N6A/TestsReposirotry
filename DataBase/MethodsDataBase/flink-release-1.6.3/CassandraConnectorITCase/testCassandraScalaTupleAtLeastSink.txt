@Test public void testCassandraScalaTupleAtLeastSink() throws Exception {
  CassandraScalaProductSink<scala.Tuple3<String,Integer,Integer>> sink=new CassandraScalaProductSink<>(injectTableName(INSERT_DATA_QUERY),builder);
  List<scala.Tuple3<String,Integer,Integer>> scalaTupleCollection=new ArrayList<>(20);
  for (int i=0; i < 20; i++) {
    scalaTupleCollection.add(new scala.Tuple3<>(UUID.randomUUID().toString(),i,0));
  }
  sink.open(new Configuration());
  for (  scala.Tuple3<String,Integer,Integer> value : scalaTupleCollection) {
    sink.invoke(value,SinkContextUtil.forTimestamp(0));
  }
  sink.close();
  ResultSet rs=session.execute(injectTableName(SELECT_DATA_QUERY));
  List<com.datastax.driver.core.Row> rows=rs.all();
  Assert.assertEquals(scalaTupleCollection.size(),rows.size());
  for (  com.datastax.driver.core.Row row : rows) {
    scalaTupleCollection.remove(new scala.Tuple3<>(row.getString("id"),row.getInt("counter"),row.getInt("batch_id")));
  }
  Assert.assertEquals(0,scalaTupleCollection.size());
}
