@Test public void testCassandraRowAtLeastOnceSink() throws Exception {
  CassandraRowSink sink=new CassandraRowSink(FIELD_TYPES.length,injectTableName(INSERT_DATA_QUERY),builder);
  sink.open(new Configuration());
  for (  Row value : rowCollection) {
    sink.send(value);
  }
  sink.close();
  ResultSet rs=session.execute(injectTableName(SELECT_DATA_QUERY));
  Assert.assertEquals(20,rs.all().size());
}
