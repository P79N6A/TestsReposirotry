@Test public void testCassandraTupleAtLeastOnceSink() throws Exception {
  CassandraTupleSink<Tuple3<String,Integer,Integer>> sink=new CassandraTupleSink<>(injectTableName(INSERT_DATA_QUERY),builder);
  sink.open(new Configuration());
  for (  Tuple3<String,Integer,Integer> value : collection) {
    sink.send(value);
  }
  sink.close();
  ResultSet rs=session.execute(injectTableName(SELECT_DATA_QUERY));
  Assert.assertEquals(20,rs.all().size());
}
