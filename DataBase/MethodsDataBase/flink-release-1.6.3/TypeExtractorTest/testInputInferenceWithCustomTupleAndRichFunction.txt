@Test public void testInputInferenceWithCustomTupleAndRichFunction(){
  JoinFunction<CustomTuple2WithArray<Long>,CustomTuple2WithArray<Long>,CustomTuple2WithArray<Long>> function=new JoinWithCustomTuple2WithArray<>();
  TypeInformation<?> ti=TypeExtractor.getJoinReturnTypes(function,new TypeHint<CustomTuple2WithArray<Long>>(){
  }
.getTypeInfo(),new TypeHint<CustomTuple2WithArray<Long>>(){
  }
.getTypeInfo());
  Assert.assertTrue(ti.isTupleType());
  TupleTypeInfo<?> tti=(TupleTypeInfo<?>)ti;
  Assert.assertEquals(BasicTypeInfo.LONG_TYPE_INFO,tti.getTypeAt(1));
  Assert.assertTrue(tti.getTypeAt(0) instanceof ObjectArrayTypeInfo<?,?>);
  ObjectArrayTypeInfo<?,?> oati=(ObjectArrayTypeInfo<?,?>)tti.getTypeAt(0);
  Assert.assertEquals(BasicTypeInfo.LONG_TYPE_INFO,oati.getComponentInfo());
}
