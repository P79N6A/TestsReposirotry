/** 
 * This tests that the creation of  {@link TaskManagerServices} correctly falls back to the first tmp directory ofthe IOManager as default for the local state root directory.
 */
@Test public void testCreationFromConfigDefault() throws Exception {
  final Configuration config=new Configuration();
  final ResourceID tmResourceID=ResourceID.generate();
  TaskManagerServicesConfiguration taskManagerServicesConfiguration=TaskManagerServicesConfiguration.fromConfiguration(config,InetAddress.getLocalHost(),true);
  TaskManagerServices taskManagerServices=TaskManagerServices.fromConfiguration(taskManagerServicesConfiguration,tmResourceID,Executors.directExecutor(),MEM_SIZE_PARAM,MEM_SIZE_PARAM);
  TaskExecutorLocalStateStoresManager taskStateManager=taskManagerServices.getTaskManagerStateStore();
  String[] tmpDirPaths=taskManagerServicesConfiguration.getTmpDirPaths();
  File[] localStateRootDirectories=taskStateManager.getLocalStateRootDirectories();
  for (int i=0; i < tmpDirPaths.length; ++i) {
    Assert.assertEquals(new File(tmpDirPaths[i],TaskManagerServices.LOCAL_STATE_SUB_DIRECTORY_ROOT),localStateRootDirectories[i]);
  }
  Assert.assertFalse(taskStateManager.isLocalRecoveryEnabled());
}
