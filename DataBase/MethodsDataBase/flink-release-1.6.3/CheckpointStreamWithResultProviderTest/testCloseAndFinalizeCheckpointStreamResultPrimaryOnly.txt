@Test public void testCloseAndFinalizeCheckpointStreamResultPrimaryOnly() throws Exception {
  CheckpointStreamFactory primaryFactory=createCheckpointStreamFactory();
  CheckpointStreamWithResultProvider resultProvider=CheckpointStreamWithResultProvider.createSimpleStream(CheckpointedStateScope.EXCLUSIVE,primaryFactory);
  SnapshotResult<StreamStateHandle> result=writeCheckpointTestData(resultProvider);
  Assert.assertNotNull(result.getJobManagerOwnedSnapshot());
  Assert.assertNull(result.getTaskLocalSnapshot());
  try (FSDataInputStream inputStream=result.getJobManagerOwnedSnapshot().openInputStream()){
    Assert.assertEquals(0x42,inputStream.read());
    Assert.assertEquals(-1,inputStream.read());
  }
 }
