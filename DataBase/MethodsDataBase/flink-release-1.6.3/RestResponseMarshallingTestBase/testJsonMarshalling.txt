/** 
 * Tests that we can marshal and unmarshal the response.
 */
@Test public void testJsonMarshalling() throws Exception {
  final R expected=getTestResponseInstance();
  ObjectMapper objectMapper=RestMapperUtils.getStrictObjectMapper();
  final String marshalled=objectMapper.writeValueAsString(expected);
  final Collection<Class<?>> typeParameters=getTypeParameters();
  final JavaType type;
  if (typeParameters.isEmpty()) {
    type=objectMapper.getTypeFactory().constructType(getTestResponseClass());
  }
 else {
    type=objectMapper.getTypeFactory().constructParametricType(getTestResponseClass(),typeParameters.toArray(new Class<?>[typeParameters.size()]));
  }
  final R unmarshalled=objectMapper.readValue(marshalled,type);
  assertOriginalEqualsToUnmarshalled(expected,unmarshalled);
}
