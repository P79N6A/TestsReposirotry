/** 
 * Tests that no checkpoints happen when the fetcher is not running.
 */
@Test public void ignoreCheckpointWhenNotRunning() throws Exception {
  @SuppressWarnings("unchecked") final MockFetcher<String> fetcher=new MockFetcher<>();
  final FlinkKafkaConsumerBase<String> consumer=new DummyFlinkKafkaConsumer<>(fetcher,mock(AbstractPartitionDiscoverer.class),false);
  final TestingListState<Tuple2<KafkaTopicPartition,Long>> listState=new TestingListState<>();
  setupConsumer(consumer,false,listState,true,0,1);
  consumer.snapshotState(new StateSnapshotContextSynchronousImpl(1,1));
  assertFalse(listState.get().iterator().hasNext());
  consumer.notifyCheckpointComplete(1L);
  assertNull(fetcher.getAndClearLastCommittedOffsets());
  assertEquals(0,fetcher.getCommitCount());
}
