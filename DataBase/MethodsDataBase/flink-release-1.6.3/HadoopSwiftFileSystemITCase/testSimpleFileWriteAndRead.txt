@Test public void testSimpleFileWriteAndRead() throws Exception {
  final Configuration conf=createConfiguration();
  final String testLine="Hello Upload!";
  FileSystem.initialize(conf);
  final Path path=new Path("swift://" + CONTAINER + '.'+ SERVICENAME+ '/'+ TEST_DATA_DIR+ "/test.txt");
  final FileSystem fs=path.getFileSystem();
  try {
    try (FSDataOutputStream out=fs.create(path,WriteMode.OVERWRITE);OutputStreamWriter writer=new OutputStreamWriter(out,StandardCharsets.UTF_8)){
      writer.write(testLine);
    }
     try (FSDataInputStream in=fs.open(path);InputStreamReader ir=new InputStreamReader(in,StandardCharsets.UTF_8);BufferedReader reader=new BufferedReader(ir)){
      String line=reader.readLine();
      assertEquals(testLine,line);
    }
   }
  finally {
    fs.delete(path,false);
  }
}
