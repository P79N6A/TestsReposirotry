@Test public void testPartCounterAfterBucketResurrection() throws Exception {
  final File outDir=TEMP_FOLDER.newFolder();
  final Path path=new Path(outDir.toURI());
  final OnProcessingTimePolicy<String,String> rollOnProcessingTimeCountingPolicy=new OnProcessingTimePolicy<>(2L);
  final Buckets<String,String> buckets=createBuckets(path,rollOnProcessingTimeCountingPolicy,0);
  buckets.onElement("test",new TestUtils.MockSinkContext(1L,2L,3L));
  Assert.assertEquals(1L,buckets.getActiveBuckets().get("test").getPartCounter());
  buckets.onProcessingTime(7L);
  Assert.assertEquals(1L,rollOnProcessingTimeCountingPolicy.getOnProcessingTimeRollCounter());
  Assert.assertEquals(1L,buckets.getActiveBuckets().get("test").getPartCounter());
  buckets.snapshotState(0L,new MockListState<>(),new MockListState<>());
  buckets.commitUpToCheckpoint(0L);
  Assert.assertTrue(buckets.getActiveBuckets().isEmpty());
  buckets.onElement("test",new TestUtils.MockSinkContext(2L,3L,4L));
  Assert.assertEquals(2L,buckets.getActiveBuckets().get("test").getPartCounter());
}
