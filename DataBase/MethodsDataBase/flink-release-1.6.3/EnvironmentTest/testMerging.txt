@Test public void testMerging() throws Exception {
  final Map<String,String> replaceVars1=new HashMap<>();
  replaceVars1.put("$VAR_UPDATE_MODE","update-mode: append");
  final Environment env1=EnvironmentFileUtil.parseModified(DEFAULTS_ENVIRONMENT_FILE,replaceVars1);
  final Map<String,String> replaceVars2=new HashMap<>(replaceVars1);
  replaceVars2.put("TableNumber1","NewTable");
  final Environment env2=EnvironmentFileUtil.parseModified(FACTORY_ENVIRONMENT_FILE,replaceVars2);
  final Environment merged=Environment.merge(env1,env2);
  final Set<String> tables=new HashSet<>();
  tables.add("TableNumber1");
  tables.add("TableNumber2");
  tables.add("NewTable");
  tables.add("TableSourceSink");
  assertEquals(tables,merged.getTables().keySet());
  assertTrue(merged.getExecution().isStreamingExecution());
  assertEquals(16,merged.getExecution().getMaxParallelism());
}
