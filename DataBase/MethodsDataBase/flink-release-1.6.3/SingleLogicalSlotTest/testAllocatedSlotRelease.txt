/** 
 * Tests that the  {@link AllocatedSlot.Payload#release(Throwable)} does not waitfor the payload to reach a terminal state.
 */
@Test public void testAllocatedSlotRelease(){
  final CompletableFuture<LogicalSlot> returnSlotFuture=new CompletableFuture<>();
  final WaitingSlotOwner waitingSlotOwner=new WaitingSlotOwner(returnSlotFuture,new CompletableFuture<>());
  final SingleLogicalSlot singleLogicalSlot=createSingleLogicalSlot(waitingSlotOwner);
  final CompletableFuture<?> terminalStateFuture=new CompletableFuture<>();
  final CompletableFuture<?> failFuture=new CompletableFuture<>();
  final ManualTestingPayload dummyPayload=new ManualTestingPayload(failFuture,terminalStateFuture);
  assertThat(singleLogicalSlot.tryAssignPayload(dummyPayload),is(true));
  singleLogicalSlot.release(new FlinkException("Test exception"));
  assertThat(failFuture.isDone(),is(true));
  assertThat(returnSlotFuture.isDone(),is(false));
}
