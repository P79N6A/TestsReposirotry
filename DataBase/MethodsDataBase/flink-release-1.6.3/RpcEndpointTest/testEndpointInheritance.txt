/** 
 * Tests that we can extend existing RpcEndpoints and can communicate with them via the self gateways.
 */
@Test public void testEndpointInheritance() throws Exception {
  int foobar=1;
  int barfoo=2;
  String foo="foobar";
  ExtendedEndpoint endpoint=new ExtendedEndpoint(rpcService,foobar,barfoo,foo);
  try {
    endpoint.start();
    BaseGateway baseGateway=endpoint.getSelfGateway(BaseGateway.class);
    ExtendedGateway extendedGateway=endpoint.getSelfGateway(ExtendedGateway.class);
    DifferentGateway differentGateway=endpoint.getSelfGateway(DifferentGateway.class);
    assertEquals(Integer.valueOf(foobar),baseGateway.foobar().get());
    assertEquals(Integer.valueOf(foobar),extendedGateway.foobar().get());
    assertEquals(Integer.valueOf(barfoo),extendedGateway.barfoo().get());
    assertEquals(foo,differentGateway.foo().get());
  }
  finally {
    endpoint.shutDown();
  }
}
