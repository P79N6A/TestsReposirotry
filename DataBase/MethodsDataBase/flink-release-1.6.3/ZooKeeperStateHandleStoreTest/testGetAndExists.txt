/** 
 * Tests get operation.
 */
@Test public void testGetAndExists() throws Exception {
  LongStateStorage stateHandleProvider=new LongStateStorage();
  ZooKeeperStateHandleStore<Long> store=new ZooKeeperStateHandleStore<>(ZOOKEEPER.getClient(),stateHandleProvider);
  final String pathInZooKeeper="/testGetAndExists";
  final Long state=311222268470898L;
  assertEquals(-1,store.exists(pathInZooKeeper));
  store.addAndLock(pathInZooKeeper,state);
  RetrievableStateHandle<Long> actual=store.getAndLock(pathInZooKeeper);
  assertEquals(state,actual.retrieveState());
  assertTrue(store.exists(pathInZooKeeper) >= 0);
}
