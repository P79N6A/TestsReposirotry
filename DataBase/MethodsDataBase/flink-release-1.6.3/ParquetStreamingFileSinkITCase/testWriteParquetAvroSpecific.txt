@Test public void testWriteParquetAvroSpecific() throws Exception {
  final File folder=TEMPORARY_FOLDER.newFolder();
  final List<Address> data=Arrays.asList(new Address(1,"a","b","c","12345"),new Address(2,"p","q","r","12345"),new Address(3,"x","y","z","12345"));
  final StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(1);
  env.enableCheckpointing(100);
  DataStream<Address> stream=env.addSource(new FiniteTestSource<>(data),TypeInformation.of(Address.class));
  stream.addSink(StreamingFileSink.forBulkFormat(Path.fromLocalFile(folder),ParquetAvroWriters.forSpecificRecord(Address.class)).build());
  env.execute();
  validateResults(folder,SpecificData.get(),data);
}
