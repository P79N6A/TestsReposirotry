@Test public void testWriteParquetAvroReflect() throws Exception {
  final File folder=TEMPORARY_FOLDER.newFolder();
  final List<Datum> data=Arrays.asList(new Datum("a",1),new Datum("b",2),new Datum("c",3));
  final StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(1);
  env.enableCheckpointing(100);
  DataStream<Datum> stream=env.addSource(new FiniteTestSource<>(data),TypeInformation.of(Datum.class));
  stream.addSink(StreamingFileSink.forBulkFormat(Path.fromLocalFile(folder),ParquetAvroWriters.forReflectRecord(Datum.class)).build());
  env.execute();
  validateResults(folder,ReflectData.get(),data);
}
