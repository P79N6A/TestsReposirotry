@Test public void testWriteParquetAvroGeneric() throws Exception {
  final File folder=TEMPORARY_FOLDER.newFolder();
  final Schema schema=Address.getClassSchema();
  final Collection<GenericRecord> data=new GenericTestDataCollection();
  final StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
  env.setParallelism(1);
  env.enableCheckpointing(100);
  DataStream<GenericRecord> stream=env.addSource(new FiniteTestSource<>(data),new GenericRecordAvroTypeInfo(schema));
  stream.addSink(StreamingFileSink.forBulkFormat(Path.fromLocalFile(folder),ParquetAvroWriters.forGenericRecord(schema)).build());
  env.execute();
  List<Address> expected=Arrays.asList(new Address(1,"a","b","c","12345"),new Address(2,"x","y","z","98765"));
  validateResults(folder,SpecificData.get(),expected);
}
