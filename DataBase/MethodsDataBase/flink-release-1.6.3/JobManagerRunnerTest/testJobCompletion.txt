@Test public void testJobCompletion() throws Exception {
  final JobManagerRunner jobManagerRunner=createJobManagerRunner();
  try {
    jobManagerRunner.start();
    final CompletableFuture<ArchivedExecutionGraph> resultFuture=jobManagerRunner.getResultFuture();
    assertThat(resultFuture.isDone(),is(false));
    jobManagerRunner.jobReachedGloballyTerminalState(archivedExecutionGraph);
    assertThat(resultFuture.get(),is(archivedExecutionGraph));
  }
  finally {
    jobManagerRunner.close();
  }
}
