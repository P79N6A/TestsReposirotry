@Test public void testInvalidTypeAccumulator() throws Exception {
  ExecutionEnvironment env=ExecutionEnvironment.getExecutionEnvironment();
  env.getConfig().disableSysoutLogging();
  env.generateSequence(0,10000).map(new IncompatibleAccumulatorTypesMapper()).map(new IncompatibleAccumulatorTypesMapper2()).output(new DiscardingOutputFormat<>());
  try {
    env.execute();
    fail("Should have failed.");
  }
 catch (  JobExecutionException e) {
    assertTrue("Root cause should be:",e.getCause() instanceof Exception);
    assertTrue("Root cause should be:",e.getCause().getCause() instanceof UnsupportedOperationException);
  }
}
