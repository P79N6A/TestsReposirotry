/** 
 * This test checks that the file system connection limiting configuration object is properly created.
 */
@Test public void testConnectionLimitingSettings(){
  final String scheme="testscheme";
  assertNull(ConnectionLimitingSettings.fromConfig(new Configuration(),scheme));
{
    Configuration conf=new Configuration();
    conf.setInteger(CoreOptions.fileSystemConnectionLimit(scheme),10);
    ConnectionLimitingSettings settings=ConnectionLimitingSettings.fromConfig(conf,scheme);
    assertNotNull(settings);
    assertEquals(10,settings.limitTotal);
    assertEquals(0,settings.limitInput);
    assertEquals(0,settings.limitOutput);
  }
{
    Configuration conf=new Configuration();
    conf.setInteger(CoreOptions.fileSystemConnectionLimitIn(scheme),10);
    ConnectionLimitingSettings settings=ConnectionLimitingSettings.fromConfig(conf,scheme);
    assertNotNull(settings);
    assertEquals(0,settings.limitTotal);
    assertEquals(10,settings.limitInput);
    assertEquals(0,settings.limitOutput);
  }
{
    Configuration conf=new Configuration();
    conf.setInteger(CoreOptions.fileSystemConnectionLimitOut(scheme),10);
    ConnectionLimitingSettings settings=ConnectionLimitingSettings.fromConfig(conf,scheme);
    assertNotNull(settings);
    assertEquals(0,settings.limitTotal);
    assertEquals(0,settings.limitInput);
    assertEquals(10,settings.limitOutput);
  }
}
