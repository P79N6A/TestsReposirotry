/** 
 * Tests a fix for FLINK-2412.
 * @see <a href="https://issues.apache.org/jira/browse/FLINK-2412">FLINK-2412</a>
 */
@Test public void testReleasePartitionAndGetNext() throws Exception {
  SpillableSubpartition partition=createSubpartition();
  partition.finish();
  ResultSubpartitionView readView=spy(partition.createReadView(new NoOpBufferAvailablityListener()));
  doNothing().when(readView).releaseAllResources();
  partition.release();
  assertNull(readView.getNextBuffer());
}
