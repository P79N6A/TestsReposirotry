@Test public void testTimestampAndProcessingTimeQuerying() throws Exception {
  KeyedProcessOperator<Integer,Integer,String> operator=new KeyedProcessOperator<>(new QueryingFlatMapFunction(TimeDomain.PROCESSING_TIME));
  OneInputStreamOperatorTestHarness<Integer,String> testHarness=new KeyedOneInputStreamOperatorTestHarness<>(operator,new IdentityKeySelector<Integer>(),BasicTypeInfo.INT_TYPE_INFO);
  testHarness.setup();
  testHarness.open();
  testHarness.setProcessingTime(17);
  testHarness.processElement(new StreamRecord<>(5));
  testHarness.setProcessingTime(42);
  testHarness.processElement(new StreamRecord<>(6));
  ConcurrentLinkedQueue<Object> expectedOutput=new ConcurrentLinkedQueue<>();
  expectedOutput.add(new StreamRecord<>("5TIME:17 TS:null"));
  expectedOutput.add(new StreamRecord<>("6TIME:42 TS:null"));
  TestHarnessUtil.assertOutputEquals("Output was not correct.",expectedOutput,testHarness.getOutput());
  testHarness.close();
}
