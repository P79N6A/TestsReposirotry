@Test(timeout=30000L) public void testResumeTransaction() throws IOException {
  String topicName="flink-kafka-producer-resume-transaction";
  try (FlinkKafkaProducer<String,String> kafkaProducer=new FlinkKafkaProducer<>(extraProperties)){
    kafkaProducer.initTransactions();
    kafkaProducer.beginTransaction();
    kafkaProducer.send(new ProducerRecord<>(topicName,"42","42"));
    kafkaProducer.flush();
    long producerId=kafkaProducer.getProducerId();
    short epoch=kafkaProducer.getEpoch();
    try (FlinkKafkaProducer<String,String> resumeProducer=new FlinkKafkaProducer<>(extraProperties)){
      resumeProducer.resumeTransaction(producerId,epoch);
      resumeProducer.commitTransaction();
    }
     assertRecord(topicName,"42","42");
    kafkaProducer.commitTransaction();
    try (FlinkKafkaProducer<String,String> resumeProducer=new FlinkKafkaProducer<>(extraProperties)){
      resumeProducer.resumeTransaction(producerId,epoch);
      resumeProducer.commitTransaction();
    }
   }
   deleteTestTopic(topicName);
}
