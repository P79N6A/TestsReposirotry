/** 
 * Test for  {@link TaskManagerServices#calculateNetworkBufferMemory(long,Configuration)} using oldconfigurations via  {@link TaskManagerOptions#NETWORK_NUM_BUFFERS}.
 */
@SuppressWarnings("deprecation") @Test public void calculateNetworkBufOld(){
  Configuration config=new Configuration();
  config.setInteger(TaskManagerOptions.NETWORK_NUM_BUFFERS,1);
  assertEquals(MemorySize.parse(TaskManagerOptions.MEMORY_SEGMENT_SIZE.defaultValue()).getBytes(),TaskManagerServices.calculateNetworkBufferMemory(10L << 20,config));
  assertEquals(MemorySize.parse(TaskManagerOptions.MEMORY_SEGMENT_SIZE.defaultValue()).getBytes(),TaskManagerServices.calculateNetworkBufferMemory(64L << 20,config));
  int numBuffers=(int)((2L << 32) / MemorySize.parse(TaskManagerOptions.MEMORY_SEGMENT_SIZE.defaultValue()).getBytes());
  config.setInteger(TaskManagerOptions.NETWORK_NUM_BUFFERS,numBuffers);
  assertEquals(2L << 32,TaskManagerServices.calculateNetworkBufferMemory(2L << 33,config));
}
