/** 
 * Tests that a job only has one failover region and can recover from task failure successfully
 * @throws Exception
 */
@Test public void testSingleRegionFailover() throws Exception {
  RestartStrategy restartStrategy=new InfiniteDelayRestartStrategy(10);
  ExecutionGraph eg=createSingleRegionExecutionGraph(restartStrategy);
  RestartPipelinedRegionStrategy strategy=(RestartPipelinedRegionStrategy)eg.getFailoverStrategy();
  ExecutionVertex ev=eg.getAllExecutionVertices().iterator().next();
  assertEquals(JobStatus.RUNNING,strategy.getFailoverRegion(ev).getState());
  ev.getCurrentExecutionAttempt().fail(new Exception("Test Exception"));
  assertEquals(JobStatus.CANCELLING,strategy.getFailoverRegion(ev).getState());
  for (  ExecutionVertex evs : eg.getAllExecutionVertices()) {
    evs.getCurrentExecutionAttempt().cancelingComplete();
  }
  assertEquals(JobStatus.RUNNING,strategy.getFailoverRegion(ev).getState());
}
