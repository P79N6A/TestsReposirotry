/** 
 * Tests that async callables are not executed if the fencing token changes.
 */
@Test public void testCallAsyncWithFencing() throws Exception {
  final UUID newFencingToken=UUID.randomUUID();
  CompletableFuture<Boolean> resultFuture=testRunAsync(endpoint -> endpoint.callAsync(() -> true,timeout),newFencingToken);
  try {
    resultFuture.get(timeout.toMilliseconds(),TimeUnit.MILLISECONDS);
    fail("The async call operation should fail due to the changed fencing token.");
  }
 catch (  ExecutionException e) {
    assertTrue(ExceptionUtils.stripExecutionException(e) instanceof FencingTokenException);
  }
}
