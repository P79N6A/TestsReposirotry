@Test public void testSeekSkip() throws IOException {
  verifyInputStream=spy(new FSDataInputStream(new SeekableByteArrayInputStream(new byte[2 * HadoopDataInputStream.MIN_SKIP_BYTES])));
  testInputStream=new HadoopDataInputStream(verifyInputStream);
  seekAndAssert(10);
  seekAndAssert(10 + HadoopDataInputStream.MIN_SKIP_BYTES + 1);
  seekAndAssert(testInputStream.getPos() - 1);
  seekAndAssert(testInputStream.getPos() + 1);
  seekAndAssert(testInputStream.getPos() - HadoopDataInputStream.MIN_SKIP_BYTES);
  seekAndAssert(testInputStream.getPos());
  seekAndAssert(0);
  seekAndAssert(testInputStream.getPos() + HadoopDataInputStream.MIN_SKIP_BYTES);
  seekAndAssert(testInputStream.getPos() + HadoopDataInputStream.MIN_SKIP_BYTES - 1);
  try {
    seekAndAssert(-1);
    Assert.fail();
  }
 catch (  Exception ignore) {
  }
  try {
    seekAndAssert(-HadoopDataInputStream.MIN_SKIP_BYTES - 1);
    Assert.fail();
  }
 catch (  Exception ignore) {
  }
}
