@Test public void testKeyedStateMetaInfoSerialization() throws Exception {
  String name="test";
  TypeSerializer<?> namespaceSerializer=LongSerializer.INSTANCE;
  TypeSerializer<?> stateSerializer=DoubleSerializer.INSTANCE;
  StateMetaInfoSnapshot metaInfo=new RegisteredKeyValueStateBackendMetaInfo<>(StateDescriptor.Type.VALUE,name,namespaceSerializer,stateSerializer).snapshot();
  byte[] serialized;
  try (ByteArrayOutputStreamWithPos out=new ByteArrayOutputStreamWithPos()){
    StateMetaInfoSnapshotReadersWriters.getWriter().writeStateMetaInfoSnapshot(metaInfo,new DataOutputViewStreamWrapper(out));
    serialized=out.toByteArray();
  }
   try (ByteArrayInputStreamWithPos in=new ByteArrayInputStreamWithPos(serialized)){
    final StateMetaInfoReader reader=StateMetaInfoSnapshotReadersWriters.getReader(CURRENT_STATE_META_INFO_SNAPSHOT_VERSION,StateMetaInfoSnapshotReadersWriters.StateTypeHint.KEYED_STATE);
    metaInfo=reader.readStateMetaInfoSnapshot(new DataInputViewStreamWrapper(in),Thread.currentThread().getContextClassLoader());
  }
   Assert.assertEquals(name,metaInfo.getName());
}
