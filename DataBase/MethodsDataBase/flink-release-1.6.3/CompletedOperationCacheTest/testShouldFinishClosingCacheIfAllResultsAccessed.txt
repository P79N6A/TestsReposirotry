@Test public void testShouldFinishClosingCacheIfAllResultsAccessed() throws Exception {
  completedOperationCache.registerOngoingOperation(TEST_OPERATION_KEY,TEST_OPERATION_RESULT);
  final CompletableFuture<Void> closeCacheFuture=completedOperationCache.closeAsync();
  assertThat(closeCacheFuture.isDone(),is(false));
  final Either<Throwable,String> operationResultOrError=completedOperationCache.get(TEST_OPERATION_KEY);
  assertThat(operationResultOrError,is(notNullValue()));
  assertThat(operationResultOrError.right(),is(equalTo(TEST_OPERATION_RESULT.get())));
  assertThat(closeCacheFuture.isDone(),is(true));
}
