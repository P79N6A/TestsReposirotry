@Test public void testGenericRecord() throws Exception {
  DeserializationSchema<GenericRecord> deserializationSchema=AvroDeserializationSchema.forGeneric(address.getSchema());
  byte[] encodedAddress=writeRecord(address,Address.getClassSchema());
  GenericRecord genericRecord=deserializationSchema.deserialize(encodedAddress);
  assertEquals(address.getCity(),genericRecord.get("city").toString());
  assertEquals(address.getNum(),genericRecord.get("num"));
  assertEquals(address.getState(),genericRecord.get("state").toString());
}
