/** 
 * Tests that the  {@link AbstractTaskManagerFileHandler} serves the requested file.
 */
@Test public void testFileServing() throws Exception {
  final Time cacheEntryDuration=Time.milliseconds(1000L);
  final Queue<CompletableFuture<TransientBlobKey>> requestFileUploads=new ArrayDeque<>(1);
  requestFileUploads.add(CompletableFuture.completedFuture(transientBlobKey1));
  final TestTaskManagerFileHandler testTaskManagerFileHandler=createTestTaskManagerFileHandler(cacheEntryDuration,requestFileUploads,EXPECTED_TASK_MANAGER_ID);
  final File outputFile=temporaryFolder.newFile();
  final TestingChannelHandlerContext testingContext=new TestingChannelHandlerContext(outputFile);
  testTaskManagerFileHandler.respondToRequest(testingContext,HTTP_REQUEST,handlerRequest,null);
  assertThat(outputFile.length(),is(greaterThan(0L)));
  assertThat(FileUtils.readFileUtf8(outputFile),is(equalTo(fileContent1)));
}
