@Test public void testGroupingSets() throws Exception {
  String query="SELECT f1, f2, avg(f0) as a, GROUP_ID() as g, " + " GROUPING(f1) as gf1, GROUPING(f2) as gf2, " + " GROUPING_ID(f1) as gif1, GROUPING_ID(f2) as gif2, "+ " GROUPING_ID(f1, f2) as gid, "+ " COUNT(*) as cnt"+ " FROM " + TABLE_NAME + " GROUP BY GROUPING SETS (f1, f2, ())";
  String expected="1,null,1,1,1,0,1,0,2,1\n" + "6,null,18,1,1,0,1,0,2,6\n" + "2,null,2,1,1,0,1,0,2,2\n"+ "4,null,8,1,1,0,1,0,2,4\n"+ "5,null,13,1,1,0,1,0,2,5\n"+ "3,null,5,1,1,0,1,0,2,3\n"+ "null,Comment#11,17,2,0,1,0,1,1,1\n"+ "null,Comment#8,14,2,0,1,0,1,1,1\n"+ "null,Comment#2,8,2,0,1,0,1,1,1\n"+ "null,Comment#1,7,2,0,1,0,1,1,1\n"+ "null,Comment#14,20,2,0,1,0,1,1,1\n"+ "null,Comment#7,13,2,0,1,0,1,1,1\n"+ "null,Comment#6,12,2,0,1,0,1,1,1\n"+ "null,Comment#3,9,2,0,1,0,1,1,1\n"+ "null,Comment#12,18,2,0,1,0,1,1,1\n"+ "null,Comment#5,11,2,0,1,0,1,1,1\n"+ "null,Comment#15,21,2,0,1,0,1,1,1\n"+ "null,Comment#4,10,2,0,1,0,1,1,1\n"+ "null,Hi,1,2,0,1,0,1,1,1\n"+ "null,Comment#10,16,2,0,1,0,1,1,1\n"+ "null,Hello world,3,2,0,1,0,1,1,1\n"+ "null,I am fine.,5,2,0,1,0,1,1,1\n"+ "null,Hello world, how are you?,4,2,0,1,0,1,1,1\n"+ "null,Comment#9,15,2,0,1,0,1,1,1\n"+ "null,Comment#13,19,2,0,1,0,1,1,1\n"+ "null,Luke Skywalker,6,2,0,1,0,1,1,1\n"+ "null,Hello,2,2,0,1,0,1,1,1\n"+ "null,null,11,0,0,0,0,0,0,21";
  checkSql(query,expected);
}
