@Test public void failIfNotInMainThread() throws Exception {
  try {
    assert false;
    return;
  }
 catch (  AssertionError ignored) {
  }
  AkkaRpcService akkaRpcService=new AkkaRpcService(AkkaUtils.createDefaultActorSystem(),Time.milliseconds(10000));
  try {
    TestEndpoint testEndpoint=new TestEndpoint(akkaRpcService);
    testEndpoint.start();
    testEndpoint.getSelfGateway(TestGateway.class).someConcurrencyCriticalFunction();
    boolean exceptionThrown;
    try {
      testEndpoint.someConcurrencyCriticalFunction();
      exceptionThrown=false;
    }
 catch (    AssertionError e) {
      exceptionThrown=true;
    }
    assertTrue("should fail with an assertion error",exceptionThrown);
    testEndpoint.shutDown();
  }
  finally {
    akkaRpcService.stopService().get();
  }
}
