/** 
 * Runs the following program the test program defined in  {@link #testProgram(StreamExecutionEnvironment)}followed by the checks in  {@link #postSubmit}.
 */
@Test public void runCheckpointedProgram() throws Exception {
  try {
    StreamExecutionEnvironment env=StreamExecutionEnvironment.getExecutionEnvironment();
    env.setParallelism(PARALLELISM);
    env.enableCheckpointing(500);
    env.getConfig().disableSysoutLogging();
    env.setRestartStrategy(RestartStrategies.fixedDelayRestart(Integer.MAX_VALUE,0L));
    testProgram(env);
    TestUtils.tryExecute(env,"Fault Tolerance Test");
    postSubmit();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}
