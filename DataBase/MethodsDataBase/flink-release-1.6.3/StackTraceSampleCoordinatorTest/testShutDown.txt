/** 
 * Tests that shut down fails all pending samples and future sample triggers. 
 */
@Test public void testShutDown() throws Exception {
  ExecutionVertex[] vertices=new ExecutionVertex[]{mockExecutionVertex(new ExecutionAttemptID(),ExecutionState.RUNNING,true)};
  List<CompletableFuture<StackTraceSample>> sampleFutures=new ArrayList<>();
  sampleFutures.add(coord.triggerStackTraceSample(vertices,1,Time.milliseconds(100L),0));
  sampleFutures.add(coord.triggerStackTraceSample(vertices,1,Time.milliseconds(100L),0));
  for (  CompletableFuture<StackTraceSample> future : sampleFutures) {
    Assert.assertFalse(future.isDone());
  }
  coord.shutDown();
  for (  CompletableFuture<StackTraceSample> future : sampleFutures) {
    Assert.assertTrue(future.isDone());
  }
  CompletableFuture<StackTraceSample> future=coord.triggerStackTraceSample(vertices,1,Time.milliseconds(100L),0);
  Assert.assertTrue(future.isDone());
  try {
    future.get();
    Assert.fail("Expected exception.");
  }
 catch (  ExecutionException e) {
  }
}
