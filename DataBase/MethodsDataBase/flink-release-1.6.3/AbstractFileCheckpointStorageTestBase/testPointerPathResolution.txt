@Test public void testPointerPathResolution() throws Exception {
  final FileSystem fs=FileSystem.getLocalFileSystem();
  final Path metadataFile=new Path(Path.fromLocalFile(tmp.newFolder()),AbstractFsCheckpointStorage.METADATA_FILE_NAME);
  final String basePointer=metadataFile.getParent().toString();
  final String pointer1=metadataFile.toString();
  final String pointer2=metadataFile.getParent().toString();
  final String pointer3=metadataFile.getParent().toString() + '/';
  final CheckpointStorage storage=createCheckpointStorage(randomTempPath());
  final byte[] data=new byte[23686];
  new Random().nextBytes(data);
  try (FSDataOutputStream out=fs.create(metadataFile,WriteMode.NO_OVERWRITE)){
    out.write(data);
  }
   CompletedCheckpointStorageLocation completed1=storage.resolveCheckpoint(pointer1);
  CompletedCheckpointStorageLocation completed2=storage.resolveCheckpoint(pointer2);
  CompletedCheckpointStorageLocation completed3=storage.resolveCheckpoint(pointer3);
  assertEquals(basePointer,completed1.getExternalPointer());
  assertEquals(basePointer,completed2.getExternalPointer());
  assertEquals(basePointer,completed3.getExternalPointer());
  StreamStateHandle handle1=completed1.getMetadataHandle();
  StreamStateHandle handle2=completed2.getMetadataHandle();
  StreamStateHandle handle3=completed3.getMetadataHandle();
  assertNotNull(handle1);
  assertNotNull(handle2);
  assertNotNull(handle3);
  validateContents(handle1,data);
  validateContents(handle2,data);
  validateContents(handle3,data);
}
