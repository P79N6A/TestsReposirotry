@Test public void testDisposeDeletesAllDirectories() throws Exception {
  AbstractKeyedStateBackend<Integer> backend=createKeyedBackend(IntSerializer.INSTANCE);
  Collection<File> allFilesInDbDir=FileUtils.listFilesAndDirs(new File(dbPath),new AcceptAllFilter(),new AcceptAllFilter());
  try {
    ValueStateDescriptor<String> kvId=new ValueStateDescriptor<>("id",String.class,null);
    kvId.initializeSerializerUnlessSet(new ExecutionConfig());
    ValueState<String> state=backend.getPartitionedState(VoidNamespace.INSTANCE,VoidNamespaceSerializer.INSTANCE,kvId);
    backend.setCurrentKey(1);
    state.update("Hello");
    assertTrue(allFilesInDbDir.size() > 1);
  }
  finally {
    IOUtils.closeQuietly(backend);
    backend.dispose();
  }
  allFilesInDbDir=FileUtils.listFilesAndDirs(new File(dbPath),new AcceptAllFilter(),new AcceptAllFilter());
  assertEquals(1,allFilesInDbDir.size());
}
