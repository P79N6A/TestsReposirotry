@Test public void testCorrectMergeOperatorSet() throws IOException {
  final ColumnFamilyOptions columnFamilyOptions=spy(new ColumnFamilyOptions());
  RocksDBKeyedStateBackend<Integer> test=null;
  try {
    test=new RocksDBKeyedStateBackend<>("test",Thread.currentThread().getContextClassLoader(),tempFolder.newFolder(),mock(DBOptions.class),columnFamilyOptions,mock(TaskKvStateRegistry.class),IntSerializer.INSTANCE,1,new KeyGroupRange(0,0),new ExecutionConfig(),enableIncrementalCheckpointing,TestLocalRecoveryConfig.disabled(),RocksDBStateBackend.PriorityQueueStateType.HEAP,TtlTimeProvider.DEFAULT);
    verify(columnFamilyOptions,Mockito.times(1)).setMergeOperatorName(RocksDBKeyedStateBackend.MERGE_OPERATOR_NAME);
  }
  finally {
    if (test != null) {
      IOUtils.closeQuietly(test);
      test.dispose();
    }
    columnFamilyOptions.close();
  }
}
