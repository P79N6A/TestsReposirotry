/** 
 * Test lookup of not existing job vertex ID in checkpoint.
 */
@Test public void testJobVertexNotFound() throws Exception {
  PendingCheckpointStats inProgress=mock(PendingCheckpointStats.class);
  when(inProgress.getTaskStateStats(any(JobVertexID.class))).thenReturn(null);
  CheckpointStatsHistory history=mock(CheckpointStatsHistory.class);
  when(history.getCheckpointById(anyLong())).thenReturn(inProgress);
  CheckpointStatsSnapshot snapshot=mock(CheckpointStatsSnapshot.class);
  when(snapshot.getHistory()).thenReturn(history);
  AccessExecutionGraph graph=mock(AccessExecutionGraph.class);
  when(graph.getCheckpointStatsSnapshot()).thenReturn(snapshot);
  CheckpointStatsDetailsSubtasksHandler handler=new CheckpointStatsDetailsSubtasksHandler(mock(ExecutionGraphCache.class),Executors.directExecutor(),new CheckpointStatsCache(0));
  Map<String,String> params=new HashMap<>();
  params.put("checkpointid","123");
  params.put("vertexid",new JobVertexID().toString());
  String json=handler.handleRequest(graph,params).get();
  assertEquals("{}",json);
  verify(inProgress,times(1)).getTaskStateStats(any(JobVertexID.class));
}
