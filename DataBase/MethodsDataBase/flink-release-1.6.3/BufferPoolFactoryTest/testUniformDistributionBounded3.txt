@Test public void testUniformDistributionBounded3() throws IOException {
  NetworkBufferPool globalPool=new NetworkBufferPool(3,128);
  try {
    BufferPool first=globalPool.createBufferPool(0,10);
    assertEquals(3,first.getNumBuffers());
    BufferPool second=globalPool.createBufferPool(0,10);
    assertEquals(3,first.getNumBuffers() + second.getNumBuffers());
    assertNotEquals(3,first.getNumBuffers());
    assertNotEquals(3,second.getNumBuffers());
    BufferPool third=globalPool.createBufferPool(0,10);
    assertEquals(1,first.getNumBuffers());
    assertEquals(1,second.getNumBuffers());
    assertEquals(1,third.getNumBuffers());
    String msg="Wrong number of available segments after creating buffer pools.";
    assertEquals(msg,3,globalPool.getNumberOfAvailableMemorySegments());
  }
  finally {
    globalPool.destroyAllBufferPools();
    globalPool.destroy();
  }
}
