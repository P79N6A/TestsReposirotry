@Test public void testCheckpointWithOnlyMasterState() throws Exception {
  final Random rnd=new Random();
  final int maxNumMasterStates=5;
  for (int i=0; i < 100; ++i) {
    final long checkpointId=rnd.nextLong() & 0x7fffffffffffffffL;
    final Collection<OperatorState> operatorStates=Collections.emptyList();
    final int numMasterStates=rnd.nextInt(maxNumMasterStates) + 1;
    final Collection<MasterState> masterStates=CheckpointTestUtils.createRandomMasterStates(rnd,numMasterStates);
    testCheckpointSerialization(checkpointId,operatorStates,masterStates);
  }
}
