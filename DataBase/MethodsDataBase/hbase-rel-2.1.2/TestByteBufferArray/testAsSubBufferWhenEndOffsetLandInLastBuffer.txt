@Test public void testAsSubBufferWhenEndOffsetLandInLastBuffer() throws Exception {
  int capacity=4 * 1024 * 1024;
  ByteBufferAllocator allocator=new ByteBufferAllocator(){
    @Override public ByteBuffer allocate(    long size) throws IOException {
      return ByteBuffer.allocateDirect((int)size);
    }
  }
;
  ByteBufferArray array=new ByteBufferArray(capacity,allocator);
  ByteBuff subBuf=array.asSubByteBuff(0,capacity);
  subBuf.position(capacity - 1);
  assertTrue(subBuf.hasRemaining());
  subBuf.get();
  assertFalse(subBuf.hasRemaining());
}
