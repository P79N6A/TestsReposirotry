@Test public void testByteBufferCreation() throws Exception {
  int capacity=470 * 1021 * 1023;
  ByteBufferAllocator allocator=new ByteBufferAllocator(){
    @Override public ByteBuffer allocate(    long size) throws IOException {
      return ByteBuffer.allocateDirect((int)size);
    }
  }
;
  ByteBufferArray array=new ByteBufferArray(capacity,allocator);
  assertEquals(119,array.buffers.length);
  for (int i=0; i < array.buffers.length; i++) {
    if (i == array.buffers.length - 1) {
      assertEquals(0,array.buffers[i].capacity());
    }
 else {
      assertEquals(ByteBufferArray.DEFAULT_BUFFER_SIZE,array.buffers[i].capacity());
    }
  }
}
