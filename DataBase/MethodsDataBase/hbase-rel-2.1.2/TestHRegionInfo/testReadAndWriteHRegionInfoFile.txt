@Test public void testReadAndWriteHRegionInfoFile() throws IOException, InterruptedException {
  HBaseTestingUtility htu=new HBaseTestingUtility();
  HRegionInfo hri=HRegionInfo.FIRST_META_REGIONINFO;
  Path basedir=htu.getDataTestDir();
  FSTableDescriptors fsTableDescriptors=new FSTableDescriptors(htu.getConfiguration());
  HRegion r=HBaseTestingUtility.createRegionAndWAL(hri,basedir,htu.getConfiguration(),fsTableDescriptors.get(TableName.META_TABLE_NAME));
  long modtime=getModTime(r);
  HBaseTestingUtility.closeRegionAndWAL(r);
  Thread.sleep(1001);
  r=HRegion.openHRegion(basedir,hri,fsTableDescriptors.get(TableName.META_TABLE_NAME),null,htu.getConfiguration());
  long modtime2=getModTime(r);
  assertEquals(modtime,modtime2);
  org.apache.hadoop.hbase.client.RegionInfo deserializedHri=HRegionFileSystem.loadRegionInfoFileContent(r.getRegionFileSystem().getFileSystem(),r.getRegionFileSystem().getRegionDir());
  assertTrue(org.apache.hadoop.hbase.client.RegionInfo.COMPARATOR.compare(hri,deserializedHri) == 0);
  HBaseTestingUtility.closeRegionAndWAL(r);
}
