@Test public void testLocalityCost() throws Exception {
  Configuration conf=HBaseConfiguration.create();
  MockNoopMasterServices master=new MockNoopMasterServices();
  StochasticLoadBalancer.CostFunction costFunction=new ServerLocalityCostFunction(conf,master);
  for (int test=0; test < clusterRegionLocationMocks.length; test++) {
    int[][] clusterRegionLocations=clusterRegionLocationMocks[test];
    MockCluster cluster=new MockCluster(clusterRegionLocations);
    costFunction.init(cluster);
    double cost=costFunction.cost();
    double expected=1 - expectedLocalities[test];
    assertEquals(expected,cost,0.001);
  }
}
