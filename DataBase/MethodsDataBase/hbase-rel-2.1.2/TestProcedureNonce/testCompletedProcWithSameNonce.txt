@Test public void testCompletedProcWithSameNonce() throws Exception {
  final long nonceGroup=123;
  final long nonce=2222;
  final NonceKey nonceKey=procExecutor.createNonceKey(nonceGroup,nonce);
  assertFalse(procExecutor.registerNonce(nonceKey) >= 0);
  Procedure proc=new TestSingleStepProcedure();
  long procId=procExecutor.submitProcedure(proc,nonceKey);
  ProcedureTestingUtility.waitProcedure(procExecutor,procId);
  ProcedureTestingUtility.restart(procExecutor);
  ProcedureTestingUtility.waitProcedure(procExecutor,procId);
  assertEquals(procId,procExecutor.registerNonce(nonceKey));
  Procedure<?> result=procExecutor.getResult(procId);
  ProcedureTestingUtility.assertProcNotFailed(result);
}
