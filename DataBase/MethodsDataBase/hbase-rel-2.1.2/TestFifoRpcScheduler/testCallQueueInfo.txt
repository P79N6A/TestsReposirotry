@Test public void testCallQueueInfo() throws IOException, InterruptedException {
  ThreadPoolExecutor rpcExecutor;
  RpcScheduler scheduler=new FifoRpcScheduler(conf,1);
  scheduler.init(CONTEXT);
  disableHandlers(scheduler);
  int totalCallMethods=30;
  int unableToDispatch=0;
  for (int i=totalCallMethods; i > 0; i--) {
    CallRunner task=createMockTask();
    task.setStatus(new MonitoredRPCHandlerImpl());
    if (!scheduler.dispatch(task)) {
      unableToDispatch++;
    }
    Thread.sleep(10);
  }
  CallQueueInfo callQueueInfo=scheduler.getCallQueueInfo();
  int executionCount=callExecutionCount.get();
  int callQueueSize=0;
  for (  String callQueueName : callQueueInfo.getCallQueueNames()) {
    for (    String calledMethod : callQueueInfo.getCalledMethodNames(callQueueName)) {
      callQueueSize+=callQueueInfo.getCallMethodCount(callQueueName,calledMethod);
    }
  }
  assertEquals(totalCallMethods - unableToDispatch,callQueueSize + executionCount);
  scheduler.stop();
}
