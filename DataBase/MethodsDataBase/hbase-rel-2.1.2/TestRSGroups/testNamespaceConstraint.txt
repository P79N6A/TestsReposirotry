@Test public void testNamespaceConstraint() throws Exception {
  String nsName=tablePrefix + "_foo";
  String groupName=tablePrefix + "_foo";
  LOG.info("testNamespaceConstraint");
  rsGroupAdmin.addRSGroup(groupName);
  assertTrue(observer.preAddRSGroupCalled);
  assertTrue(observer.postAddRSGroupCalled);
  admin.createNamespace(NamespaceDescriptor.create(nsName).addConfiguration(RSGroupInfo.NAMESPACE_DESC_PROP_GROUP,groupName).build());
  try {
    rsGroupAdmin.removeRSGroup(groupName);
    fail("Expected a constraint exception");
  }
 catch (  IOException ex) {
  }
  admin.modifyNamespace(NamespaceDescriptor.create(nsName).addConfiguration(RSGroupInfo.NAMESPACE_DESC_PROP_GROUP,groupName).build());
  String anotherGroup=tablePrefix + "_anotherGroup";
  rsGroupAdmin.addRSGroup(anotherGroup);
  admin.deleteNamespace(nsName);
  rsGroupAdmin.removeRSGroup(groupName);
  assertTrue(observer.preRemoveRSGroupCalled);
  assertTrue(observer.postRemoveRSGroupCalled);
  try {
    admin.createNamespace(NamespaceDescriptor.create(nsName).addConfiguration(RSGroupInfo.NAMESPACE_DESC_PROP_GROUP,"foo").build());
    fail("Expected a constraint exception");
  }
 catch (  IOException ex) {
  }
}
