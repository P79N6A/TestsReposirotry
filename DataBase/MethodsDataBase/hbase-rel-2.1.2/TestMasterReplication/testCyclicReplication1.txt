/** 
 * It tests the replication scenario involving 0 -> 1 -> 0. It does it by adding and deleting a row to a table in each cluster, checking if it's replicated. It also tests that the puts and deletes are not replicated back to the originating cluster.
 */
@Test public void testCyclicReplication1() throws Exception {
  LOG.info("testSimplePutDelete");
  int numClusters=2;
  Table[] htables=null;
  try {
    htables=setUpClusterTablesAndPeers(numClusters);
    int[] expectedCounts=new int[]{2,2};
    putAndWait(row,famName,htables[0],htables[1]);
    putAndWait(row1,famName,htables[1],htables[0]);
    validateCounts(htables,put,expectedCounts);
    deleteAndWait(row,htables[0],htables[1]);
    deleteAndWait(row1,htables[1],htables[0]);
    validateCounts(htables,delete,expectedCounts);
  }
  finally {
    close(htables);
    shutDownMiniClusters();
  }
}
