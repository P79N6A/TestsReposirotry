@Test public void testOpenClose() throws Exception {
  String caseName=testName.getMethodName();
  Path testDir=TEST_UTIL.getDataTestDir();
  FileSystem fs=testDir.getFileSystem(conf);
  HFileContext meta=new HFileContextBuilder().withBlockSize(8 * 1024).build();
  StoreFileWriter writer=new StoreFileWriter.Builder(conf,cacheConf,fs).withOutputDir(testDir).withFileContext(meta).build();
  MobTestUtil.writeStoreFile(writer,caseName);
  CachedMobFile cachedMobFile=CachedMobFile.create(fs,writer.getPath(),conf,cacheConf);
  assertEquals(EXPECTED_REFERENCE_ZERO,cachedMobFile.getReferenceCount());
  cachedMobFile.open();
  assertEquals(EXPECTED_REFERENCE_ONE,cachedMobFile.getReferenceCount());
  cachedMobFile.open();
  assertEquals(EXPECTED_REFERENCE_TWO,cachedMobFile.getReferenceCount());
  cachedMobFile.close();
  assertEquals(EXPECTED_REFERENCE_ONE,cachedMobFile.getReferenceCount());
  cachedMobFile.close();
  assertEquals(EXPECTED_REFERENCE_ZERO,cachedMobFile.getReferenceCount());
}
