@Test public void testBatch() throws IOException, InterruptedException {
  ClusterConnection conn=new MyConnectionImpl(CONF);
  HTable ht=(HTable)conn.getTable(DUMMY_TABLE);
  ht.multiAp=new MyAsyncProcess(conn,CONF);
  List<Put> puts=new ArrayList<>(7);
  puts.add(createPut(1,true));
  puts.add(createPut(1,true));
  puts.add(createPut(1,true));
  puts.add(createPut(1,true));
  puts.add(createPut(1,false));
  puts.add(createPut(1,true));
  puts.add(createPut(1,false));
  Object[] res=new Object[puts.size()];
  try {
    ht.batch(puts,res);
    Assert.fail();
  }
 catch (  RetriesExhaustedException expected) {
  }
  Assert.assertEquals(success,res[0]);
  Assert.assertEquals(success,res[1]);
  Assert.assertEquals(success,res[2]);
  Assert.assertEquals(success,res[3]);
  Assert.assertEquals(failure,res[4]);
  Assert.assertEquals(success,res[5]);
  Assert.assertEquals(failure,res[6]);
}
