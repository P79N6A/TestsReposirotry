@Test public void testErrorsServers() throws IOException {
  Configuration configuration=new Configuration(CONF);
  ClusterConnection conn=new MyConnectionImpl(configuration);
  MyAsyncProcess ap=new MyAsyncProcess(conn,configuration);
  BufferedMutatorParams bufferParam=createBufferedMutatorParams(ap,DUMMY_TABLE);
  BufferedMutatorImpl mutator=new BufferedMutatorImpl(conn,bufferParam,ap);
  configuration.setBoolean(ConnectionImplementation.RETRIES_BY_SERVER_KEY,true);
  Assert.assertNotNull(ap.createServerErrorTracker());
  Assert.assertTrue(ap.serverTrackerTimeout > 200L);
  ap.serverTrackerTimeout=1L;
  Put p=createPut(1,false);
  mutator.mutate(p);
  try {
    mutator.flush();
    Assert.fail();
  }
 catch (  RetriesExhaustedWithDetailsException expected) {
    assertEquals(1,expected.getNumExceptions());
    assertTrue(expected.getRow(0) == p);
  }
  Assert.assertEquals(NB_RETRIES + 1,ap.callsCt.get());
}
