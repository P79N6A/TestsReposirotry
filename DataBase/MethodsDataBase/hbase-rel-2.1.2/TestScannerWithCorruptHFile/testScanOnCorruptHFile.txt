@Test(expected=DoNotRetryIOException.class) public void testScanOnCorruptHFile() throws IOException {
  TableName tableName=TableName.valueOf(name.getMethodName());
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.addCoprocessor(CorruptHFileCoprocessor.class.getName());
  htd.addFamily(new HColumnDescriptor(FAMILY_NAME));
  Table table=TEST_UTIL.createTable(htd,null);
  try {
    loadTable(table,1);
    scan(table);
  }
  finally {
    table.close();
  }
}
