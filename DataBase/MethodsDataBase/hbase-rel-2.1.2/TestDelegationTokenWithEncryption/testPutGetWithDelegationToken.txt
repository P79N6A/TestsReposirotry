@Test public void testPutGetWithDelegationToken() throws Exception {
  TableName tableName=getTestTableName();
  byte[] family=Bytes.toBytes("f");
  byte[] qualifier=Bytes.toBytes("q");
  byte[] row=Bytes.toBytes("row");
  byte[] value=Bytes.toBytes("data");
  try (Connection conn=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration())){
    Admin admin=conn.getAdmin();
    HTableDescriptor tableDescriptor=new HTableDescriptor(new HTableDescriptor(tableName));
    tableDescriptor.addFamily(new HColumnDescriptor(family));
    admin.createTable(tableDescriptor);
    try (Table table=conn.getTable(tableName)){
      table.put(new Put(row).addColumn(family,qualifier,value));
      Result result=table.get(new Get(row));
      assertArrayEquals(value,result.getValue(family,qualifier));
    }
   }
 }
