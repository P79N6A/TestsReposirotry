@Test public void testEnableReplicationWhenTableDescriptorIsNotSameInClusters() throws Exception {
  HTableDescriptor table=new HTableDescriptor(admin2.getTableDescriptor(tableName));
  HColumnDescriptor f=new HColumnDescriptor("newFamily");
  table.addFamily(f);
  admin2.disableTable(tableName);
  admin2.modifyTable(tableName,table);
  admin2.enableTable(tableName);
  try {
    admin1.enableTableReplication(tableName);
    fail("Exception should be thrown if table descriptors in the clusters are not same.");
  }
 catch (  RuntimeException ignored) {
  }
  admin1.disableTable(tableName);
  admin1.modifyTable(tableName,table);
  admin1.enableTable(tableName);
  admin1.enableTableReplication(tableName);
  table=admin1.getTableDescriptor(tableName);
  for (  HColumnDescriptor fam : table.getColumnFamilies()) {
    assertEquals(HConstants.REPLICATION_SCOPE_GLOBAL,fam.getScope());
  }
  admin1.deleteColumnFamily(tableName,f.getName());
  admin2.deleteColumnFamily(tableName,f.getName());
}
