@Test public void testStoresNeedingCompaction() throws Exception {
  List<StoreFileInfo> storeFiles=mockStoreFiles(regionStoreDir,5,10);
  MajorCompactionRequest request=makeMockRequest(100,storeFiles,false);
  Optional<MajorCompactionRequest> result=request.createRequest(mock(Configuration.class),Sets.newHashSet(FAMILY));
  assertTrue(result.isPresent());
  storeFiles=mockStoreFiles(regionStoreDir,5,101);
  request=makeMockRequest(100,storeFiles,false);
  result=request.createRequest(mock(Configuration.class),Sets.newHashSet(FAMILY));
  assertFalse(result.isPresent());
}
