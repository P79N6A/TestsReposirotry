@Test public void testAbortStuckProcedure() throws InterruptedException {
  try {
    procExecutor.getEnvironment().loop=true;
    TestSMProcedure proc=new TestSMProcedure();
    long procId=procExecutor.submitProcedure(proc);
    Thread.sleep(1000 + (int)(Math.random() * 4001));
    proc.abort(procExecutor.getEnvironment());
    ProcedureTestingUtility.waitProcedure(procExecutor,procId);
    assertEquals(true,proc.isFailed());
  }
  finally {
    procExecutor.getEnvironment().loop=false;
  }
}
