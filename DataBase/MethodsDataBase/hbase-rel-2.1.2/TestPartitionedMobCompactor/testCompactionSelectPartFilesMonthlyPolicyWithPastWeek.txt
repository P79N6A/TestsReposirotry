@Test public void testCompactionSelectPartFilesMonthlyPolicyWithPastWeek() throws Exception {
  String tableName="testCompactionSelectPartFilesMonthlyPolicyWithPastWeek";
  Date dateLastWeek=new Date(System.currentTimeMillis() - (7 * DAY_IN_MS));
  Calendar calendar=Calendar.getInstance();
  Date firstDayOfCurrentMonth=MobUtils.getFirstDayOfMonth(calendar,new Date());
  CompactionType type=CompactionType.PART_FILES;
  long mergeSizeMultiFactor=7;
  if (dateLastWeek.before(firstDayOfCurrentMonth)) {
    type=CompactionType.ALL_FILES;
    mergeSizeMultiFactor*=4;
  }
  testCompactionAtMergeSize(tableName,700,type,false,false,dateLastWeek,MobCompactPartitionPolicy.MONTHLY,mergeSizeMultiFactor);
}
