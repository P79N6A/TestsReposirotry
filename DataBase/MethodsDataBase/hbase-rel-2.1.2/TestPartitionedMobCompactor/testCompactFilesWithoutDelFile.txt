@Test public void testCompactFilesWithoutDelFile() throws Exception {
  String tableName="testCompactFilesWithoutDelFile";
  resetConf();
  init(tableName);
  createMobFile(basePath);
  listFiles();
  PartitionedMobCompactor compactor=new PartitionedMobCompactor(conf,fs,TableName.valueOf(tableName),hcd,pool){
    @Override public List<Path> compact(    List<FileStatus> files,    boolean isForceAllFiles) throws IOException {
      if (files == null || files.isEmpty()) {
        return null;
      }
      PartitionedMobCompactionRequest request=select(files,isForceAllFiles);
      assertTrue(request.getDelPartitions().size() == 0);
      for (      CompactionPartition p : request.getCompactionPartitions()) {
        assertTrue(p.getStartKey() == null);
        assertTrue(p.getEndKey() == null);
      }
      return null;
    }
  }
;
  compactor.compact(allFiles,true);
}
