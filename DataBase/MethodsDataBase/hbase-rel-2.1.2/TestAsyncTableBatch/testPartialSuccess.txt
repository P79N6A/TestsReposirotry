@Test public void testPartialSuccess() throws IOException, InterruptedException, ExecutionException {
  Admin admin=TEST_UTIL.getAdmin();
  TableDescriptor htd=TableDescriptorBuilder.newBuilder(admin.getDescriptor(TABLE_NAME)).setCoprocessor(ErrorInjectObserver.class.getName()).build();
  admin.modifyTable(htd);
  AsyncTable<?> table=tableGetter.apply(TABLE_NAME);
  table.putAll(Arrays.asList(SPLIT_KEYS).stream().map(k -> new Put(k).addColumn(FAMILY,CQ,k)).collect(Collectors.toList())).get();
  List<CompletableFuture<Result>> futures=table.get(Arrays.asList(SPLIT_KEYS).stream().map(k -> new Get(k)).collect(Collectors.toList()));
  for (int i=0; i < SPLIT_KEYS.length - 1; i++) {
    assertArrayEquals(SPLIT_KEYS[i],futures.get(i).get().getValue(FAMILY,CQ));
  }
  try {
    futures.get(SPLIT_KEYS.length - 1).get();
  }
 catch (  ExecutionException e) {
    assertThat(e.getCause(),instanceOf(RetriesExhaustedException.class));
  }
}
