@Test public void testMergeRegions() throws Exception {
  byte[][] splitRows=new byte[][]{Bytes.toBytes("3"),Bytes.toBytes("6")};
  createTableWithDefaultConf(tableName,splitRows);
  AsyncTable<AdvancedScanResultConsumer> metaTable=ASYNC_CONN.getTable(META_TABLE_NAME);
  List<HRegionLocation> regionLocations=AsyncMetaTableAccessor.getTableHRegionLocations(metaTable,Optional.of(tableName)).get();
  RegionInfo regionA;
  RegionInfo regionB;
  assertEquals(3,regionLocations.size());
  regionA=regionLocations.get(0).getRegion();
  regionB=regionLocations.get(1).getRegion();
  admin.mergeRegions(regionA.getRegionName(),regionB.getRegionName(),false).get();
  regionLocations=AsyncMetaTableAccessor.getTableHRegionLocations(metaTable,Optional.of(tableName)).get();
  assertEquals(2,regionLocations.size());
  regionA=regionLocations.get(0).getRegion();
  regionB=regionLocations.get(1).getRegion();
  admin.mergeRegions(regionA.getRegionName(),regionB.getRegionName(),false).get();
  regionLocations=AsyncMetaTableAccessor.getTableHRegionLocations(metaTable,Optional.of(tableName)).get();
  assertEquals(1,regionLocations.size());
}
