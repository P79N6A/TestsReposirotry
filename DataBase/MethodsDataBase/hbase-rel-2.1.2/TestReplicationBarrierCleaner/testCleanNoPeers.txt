@Test public void testCleanNoPeers() throws IOException {
  TableName tableName1=TableName.valueOf(name.getMethodName() + "_1");
  RegionInfo region11=RegionInfoBuilder.newBuilder(tableName1).setEndKey(Bytes.toBytes(1)).build();
  addBarrier(region11,10,20,30,40,50,60);
  RegionInfo region12=RegionInfoBuilder.newBuilder(tableName1).setStartKey(Bytes.toBytes(1)).build();
  addBarrier(region12,20,30,40,50,60,70);
  TableName tableName2=TableName.valueOf(name.getMethodName() + "_2");
  RegionInfo region21=RegionInfoBuilder.newBuilder(tableName2).setEndKey(Bytes.toBytes(1)).build();
  addBarrier(region21,100,200,300,400);
  RegionInfo region22=RegionInfoBuilder.newBuilder(tableName2).setStartKey(Bytes.toBytes(1)).build();
  addBarrier(region22,200,300,400,500,600);
  @SuppressWarnings("unchecked") ReplicationPeerManager peerManager=create(null,Collections.emptyList(),Collections.emptyList());
  ReplicationBarrierCleaner cleaner=create(peerManager);
  cleaner.chore();
  verify(peerManager,never()).getQueueStorage();
  verify(peerManager,times(2)).getSerialPeerIdsBelongsTo(any(TableName.class));
  assertArrayEquals(new long[]{60},MetaTableAccessor.getReplicationBarrier(UTIL.getConnection(),region11.getRegionName()));
  assertArrayEquals(new long[]{70},MetaTableAccessor.getReplicationBarrier(UTIL.getConnection(),region12.getRegionName()));
  assertArrayEquals(new long[]{400},MetaTableAccessor.getReplicationBarrier(UTIL.getConnection(),region21.getRegionName()));
  assertArrayEquals(new long[]{600},MetaTableAccessor.getReplicationBarrier(UTIL.getConnection(),region22.getRegionName()));
}
