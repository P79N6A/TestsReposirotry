@Test public void testDeleteWithNoVisibilitiesForPutsAndDeletes() throws Exception {
  TableName tableName=createTable(5);
  Put p=new Put(Bytes.toBytes("row1"));
  p.addColumn(fam,qual,value);
  Table table=TEST_UTIL.getConnection().getTable(tableName);
  table.put(p);
  p=new Put(Bytes.toBytes("row1"));
  p.addColumn(fam,qual1,value);
  table.put(p);
  p=new Put(Bytes.toBytes("row2"));
  p.addColumn(fam,qual,value);
  table.put(p);
  p=new Put(Bytes.toBytes("row2"));
  p.addColumn(fam,qual1,value);
  table.put(p);
  Delete d=new Delete(Bytes.toBytes("row1"));
  table.delete(d);
  Get g=new Get(Bytes.toBytes("row1"));
  g.readAllVersions();
  g.setAuthorizations(new Authorizations(SECRET,PRIVATE));
  Result result=table.get(g);
  assertEquals(0,result.rawCells().length);
  p=new Put(Bytes.toBytes("row1"));
  p.addColumn(fam,qual,value);
  table.put(p);
  result=table.get(g);
  assertEquals(1,result.rawCells().length);
}
