/** 
 * Test KeyValues with negative timestamp.
 * @throws IOException On test failure.
 */
@Test public void testNegativeTimestamps() throws IOException {
  List<KeyValue> kvList=new ArrayList<>();
  byte[] row=new byte[0];
  byte[] family=new byte[0];
  byte[] qualifier=new byte[0];
  byte[] value=new byte[0];
  if (includesTags) {
    byte[] metaValue1=Bytes.toBytes("metaValue1");
    byte[] metaValue2=Bytes.toBytes("metaValue2");
    kvList.add(new KeyValue(row,family,qualifier,0L,value,new Tag[]{new ArrayBackedTag((byte)1,metaValue1)}));
    kvList.add(new KeyValue(row,family,qualifier,0L,value,new Tag[]{new ArrayBackedTag((byte)1,metaValue2)}));
  }
 else {
    kvList.add(new KeyValue(row,family,qualifier,-1L,Type.Put,value));
    kvList.add(new KeyValue(row,family,qualifier,-2L,Type.Put,value));
  }
  testEncodersOnDataset(kvList,includesMemstoreTS,includesTags);
}
