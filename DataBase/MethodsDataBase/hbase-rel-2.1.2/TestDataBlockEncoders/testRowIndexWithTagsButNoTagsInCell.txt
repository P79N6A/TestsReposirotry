@Test public void testRowIndexWithTagsButNoTagsInCell() throws IOException {
  List<KeyValue> kvList=new ArrayList<>();
  byte[] row=new byte[0];
  byte[] family=new byte[0];
  byte[] qualifier=new byte[0];
  byte[] value=new byte[0];
  KeyValue expectedKV=new KeyValue(row,family,qualifier,1L,Type.Put,value);
  kvList.add(expectedKV);
  DataBlockEncoding encoding=DataBlockEncoding.ROW_INDEX_V1;
  DataBlockEncoder encoder=encoding.getEncoder();
  ByteBuffer encodedBuffer=encodeKeyValues(encoding,kvList,getEncodingContext(Algorithm.NONE,encoding),false);
  HFileContext meta=new HFileContextBuilder().withHBaseCheckSum(false).withIncludesMvcc(includesMemstoreTS).withIncludesTags(includesTags).withCompression(Compression.Algorithm.NONE).build();
  DataBlockEncoder.EncodedSeeker seeker=encoder.createSeeker(CellComparatorImpl.COMPARATOR,encoder.newDataBlockDecodingContext(meta));
  seeker.setCurrentBuffer(new SingleByteBuff(encodedBuffer));
  Cell cell=seeker.getCell();
  Assert.assertEquals(expectedKV.getLength(),((KeyValue)cell).getLength());
}
