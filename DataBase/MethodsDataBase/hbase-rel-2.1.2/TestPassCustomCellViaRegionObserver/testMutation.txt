@Test public void testMutation() throws Exception {
  Put put=new Put(ROW);
  put.addColumn(FAMILY,QUALIFIER,VALUE);
  table.put(put);
  byte[] value=VALUE;
  assertResult(table.get(new Get(ROW)),value,value);
  assertObserverHasExecuted();
  Increment inc=new Increment(ROW);
  inc.addColumn(FAMILY,QUALIFIER,10L);
  table.increment(inc);
  value=Bytes.toBytes(20L);
  assertResult(table.get(new Get(ROW)),value,value);
  assertObserverHasExecuted();
  Append append=new Append(ROW);
  append.addColumn(FAMILY,QUALIFIER,APPEND_VALUE);
  table.append(append);
  value=ByteBuffer.wrap(new byte[value.length + APPEND_VALUE.length]).put(value).put(APPEND_VALUE).array();
  assertResult(table.get(new Get(ROW)),value,value);
  assertObserverHasExecuted();
  Delete delete=new Delete(ROW);
  delete.addColumns(FAMILY,QUALIFIER);
  table.delete(delete);
  assertTrue(Arrays.asList(table.get(new Get(ROW)).rawCells()).toString(),table.get(new Get(ROW)).isEmpty());
  assertObserverHasExecuted();
  assertTrue(table.checkAndPut(ROW,FAMILY,QUALIFIER,null,put));
  assertObserverHasExecuted();
  assertTrue(table.checkAndDelete(ROW,FAMILY,QUALIFIER,VALUE,delete));
  assertObserverHasExecuted();
  assertTrue(table.get(new Get(ROW)).isEmpty());
}
