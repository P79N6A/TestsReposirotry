@Test public void testLruBlockCache() throws IOException {
  CacheConfig.instantiateBlockCache(this.conf);
  CacheConfig cc=new CacheConfig(this.conf);
  assertTrue(cc.isBlockCacheEnabled());
  assertTrue(CacheConfig.DEFAULT_IN_MEMORY == cc.isInMemory());
  assertTrue(cc.getBlockCache() instanceof LruBlockCache);
  logPerBlock(cc.getBlockCache());
  addDataAndHits(cc.getBlockCache(),3);
  BlockCache bc=cc.getBlockCache();
  LOG.info("count=" + bc.getBlockCount() + ", currentSize="+ bc.getCurrentSize()+ ", freeSize="+ bc.getFreeSize());
  LOG.info(Objects.toString(cc.getBlockCache().getStats()));
  BlockCacheUtil.CachedBlocksByFile cbsbf=logPerBlock(cc.getBlockCache());
  LOG.info(Objects.toString(cbsbf));
  logPerFile(cbsbf);
  bucketCacheReport(cc.getBlockCache());
  LOG.info(BlockCacheUtil.toJSON(cbsbf));
}
