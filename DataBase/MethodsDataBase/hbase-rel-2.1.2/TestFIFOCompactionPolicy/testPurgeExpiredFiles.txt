@Test public void testPurgeExpiredFiles() throws Exception {
  HStore store=prepareData();
  assertEquals(10,store.getStorefilesCount());
  TEST_UTIL.getAdmin().majorCompact(tableName);
  TEST_UTIL.waitFor(30000,new ExplainingPredicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      return store.getStorefilesCount() == 1;
    }
    @Override public String explainFailure() throws Exception {
      return "The store file count " + store.getStorefilesCount() + " is still greater than 1";
    }
  }
);
}
