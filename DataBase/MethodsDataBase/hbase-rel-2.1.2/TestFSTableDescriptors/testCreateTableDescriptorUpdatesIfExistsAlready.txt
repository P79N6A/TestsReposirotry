@Test public void testCreateTableDescriptorUpdatesIfExistsAlready() throws IOException {
  Path testdir=UTIL.getDataTestDir(name.getMethodName());
  TableDescriptor htd=TableDescriptorBuilder.newBuilder(TableName.valueOf(name.getMethodName())).build();
  FileSystem fs=FileSystem.get(UTIL.getConfiguration());
  FSTableDescriptors fstd=new FSTableDescriptors(UTIL.getConfiguration(),fs,testdir);
  assertTrue(fstd.createTableDescriptor(htd));
  assertFalse(fstd.createTableDescriptor(htd));
  htd=TableDescriptorBuilder.newBuilder(htd).setValue(Bytes.toBytes("mykey"),Bytes.toBytes("myValue")).build();
  assertTrue(fstd.createTableDescriptor(htd));
  Path tableDir=fstd.getTableDir(htd.getTableName());
  Path tmpTableDir=new Path(tableDir,FSTableDescriptors.TMP_DIR);
  FileStatus[] statuses=fs.listStatus(tmpTableDir);
  assertTrue(statuses.length == 0);
  assertEquals(htd,FSTableDescriptors.getTableDescriptorFromFs(fs,tableDir));
}
