@Test public void testCheckAndPut() throws IOException {
  final byte[] anotherrow=Bytes.toBytes("anotherrow");
  final byte[] value2=Bytes.toBytes("abcd");
  Table table=TEST_UTIL.createTable(TableName.valueOf(name.getMethodName()),FAMILY);
  Put put1=new Put(ROW);
  put1.addColumn(FAMILY,QUALIFIER,VALUE);
  boolean ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifEquals(VALUE).thenPut(put1);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifNotExists().thenPut(put1);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifNotExists().thenPut(put1);
  assertFalse(ok);
  Put put2=new Put(ROW);
  put2.addColumn(FAMILY,QUALIFIER,value2);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifEquals(VALUE).thenPut(put2);
  assertTrue(ok);
  Put put3=new Put(anotherrow);
  put3.addColumn(FAMILY,QUALIFIER,VALUE);
  try {
    table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifEquals(value2).thenPut(put3);
    fail("trying to check and modify different rows should have failed.");
  }
 catch (  Exception e) {
  }
}
