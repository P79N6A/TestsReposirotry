@Test public void testCellSizeLimit() throws IOException {
  final TableName tableName=TableName.valueOf("testCellSizeLimit");
  HTableDescriptor htd=new HTableDescriptor(tableName);
  htd.setConfiguration(HRegion.HBASE_MAX_CELL_SIZE_KEY,Integer.toString(10 * 1024));
  HColumnDescriptor fam=new HColumnDescriptor(FAMILY);
  htd.addFamily(fam);
  Admin admin=TEST_UTIL.getAdmin();
  admin.createTable(htd);
  try (Table t=TEST_UTIL.getConnection().getTable(tableName)){
    t.put(new Put(ROW).addColumn(FAMILY,QUALIFIER,Bytes.toBytes(0L)));
    t.increment(new Increment(ROW).addColumn(FAMILY,QUALIFIER,1L));
  }
   try (Table t=TEST_UTIL.getConnection().getTable(tableName)){
    t.put(new Put(ROW).addColumn(FAMILY,QUALIFIER,new byte[9 * 1024]));
  }
   try (Table t=TEST_UTIL.getConnection().getTable(tableName)){
    try {
      t.put(new Put(ROW).addColumn(FAMILY,QUALIFIER,new byte[10 * 1024]));
      fail("Oversize cell failed to trigger exception");
    }
 catch (    IOException e) {
    }
    try {
      t.append(new Append(ROW).addColumn(FAMILY,QUALIFIER,new byte[10 * 1024]));
      fail("Oversize cell failed to trigger exception");
    }
 catch (    IOException e) {
    }
  }
 }
