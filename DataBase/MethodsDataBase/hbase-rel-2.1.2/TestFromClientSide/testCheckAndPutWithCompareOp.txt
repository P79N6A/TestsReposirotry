@Test public void testCheckAndPutWithCompareOp() throws IOException {
  final byte[] value1=Bytes.toBytes("aaaa");
  final byte[] value2=Bytes.toBytes("bbbb");
  final byte[] value3=Bytes.toBytes("cccc");
  final byte[] value4=Bytes.toBytes("dddd");
  Table table=TEST_UTIL.createTable(TableName.valueOf(name.getMethodName()),FAMILY);
  Put put2=new Put(ROW);
  put2.addColumn(FAMILY,QUALIFIER,value2);
  Put put3=new Put(ROW);
  put3.addColumn(FAMILY,QUALIFIER,value3);
  boolean ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifNotExists().thenPut(put2);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.GREATER,value1).thenPut(put2);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.EQUAL,value1).thenPut(put2);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.GREATER_OR_EQUAL,value1).thenPut(put2);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.LESS,value1).thenPut(put2);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.LESS_OR_EQUAL,value1).thenPut(put2);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.NOT_EQUAL,value1).thenPut(put3);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.LESS,value4).thenPut(put3);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.LESS_OR_EQUAL,value4).thenPut(put3);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.EQUAL,value4).thenPut(put3);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.GREATER,value4).thenPut(put3);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.GREATER_OR_EQUAL,value4).thenPut(put3);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.NOT_EQUAL,value4).thenPut(put2);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.GREATER,value2).thenPut(put2);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.NOT_EQUAL,value2).thenPut(put2);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.LESS,value2).thenPut(put2);
  assertFalse(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.GREATER_OR_EQUAL,value2).thenPut(put2);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.LESS_OR_EQUAL,value2).thenPut(put2);
  assertTrue(ok);
  ok=table.checkAndMutate(ROW,FAMILY).qualifier(QUALIFIER).ifMatches(CompareOperator.EQUAL,value2).thenPut(put3);
  assertTrue(ok);
}
