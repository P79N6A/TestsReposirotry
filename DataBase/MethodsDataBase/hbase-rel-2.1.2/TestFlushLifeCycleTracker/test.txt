@Test public void test() throws IOException, InterruptedException {
  try (Table table=UTIL.getConnection().getTable(NAME)){
    for (int i=0; i < 100; i++) {
      byte[] row=Bytes.toBytes(i);
      table.put(new Put(row,true).add(CellBuilderFactory.create(CellBuilderType.SHALLOW_COPY).setRow(row).setFamily(CF).setQualifier(QUALIFIER).setTimestamp(HConstants.LATEST_TIMESTAMP).setType(Type.Put).setValue(Bytes.toBytes(i)).build()));
    }
  }
   Tracker tracker=new Tracker();
  TRACKER=tracker;
  region.requestFlush(tracker);
  tracker.await();
  assertNull(tracker.reason);
  assertTrue(tracker.beforeExecutionCalled);
  assertTrue(tracker.afterExecutionCalled);
  tracker=new Tracker();
  TRACKER=tracker;
  region.requestFlush(tracker);
  tracker.await();
  assertNull(tracker.reason);
  assertTrue(tracker.beforeExecutionCalled);
  assertTrue(tracker.afterExecutionCalled);
}
