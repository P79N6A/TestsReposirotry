@Test public void testPerf() throws Exception {
  final TableName TABLE_NAME=TableName.valueOf("testPerf");
  final int NRUNS=1000000;
  final RegionStates stateMap=new RegionStates();
  long st=System.currentTimeMillis();
  for (int i=0; i < NRUNS; ++i) {
    final int regionId=i;
    executorService.submit(new Callable<Object>(){
      @Override public Object call(){
        RegionInfo hri=createRegionInfo(TABLE_NAME,regionId);
        return stateMap.getOrCreateRegionStateNode(hri);
      }
    }
);
  }
  waitExecutorService(NRUNS);
  long et=System.currentTimeMillis();
  LOG.info(String.format("PERF STATEMAP INSERT: %s %s/sec",StringUtils.humanTimeDiff(et - st),StringUtils.humanSize(NRUNS / ((et - st) / 1000.0f))));
  st=System.currentTimeMillis();
  for (int i=0; i < NRUNS; ++i) {
    final int regionId=i;
    executorService.submit(new Callable<Object>(){
      @Override public Object call(){
        RegionInfo hri=createRegionInfo(TABLE_NAME,regionId);
        return stateMap.getRegionState(hri);
      }
    }
);
  }
  waitExecutorService(NRUNS);
  et=System.currentTimeMillis();
  LOG.info(String.format("PERF STATEMAP GET: %s %s/sec",StringUtils.humanTimeDiff(et - st),StringUtils.humanSize(NRUNS / ((et - st) / 1000.0f))));
}
