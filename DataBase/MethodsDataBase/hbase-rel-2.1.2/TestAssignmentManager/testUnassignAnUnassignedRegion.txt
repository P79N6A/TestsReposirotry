@Test public void testUnassignAnUnassignedRegion() throws Exception {
  final TableName tableName=TableName.valueOf("testUnassignAnUnassignedRegion");
  final RegionInfo hri=createRegionInfo(tableName,1);
  collectAssignmentManagerMetrics();
  rsDispatcher.setMockRsExecutor(new GoodRsExecutor());
  waitOnFuture(submitProcedure(am.createAssignProcedure(hri)));
  final Future<byte[]> futureA=submitProcedure(am.createUnassignProcedure(hri,null,false));
  waitOnFuture(futureA);
  am.getRegionStates().isRegionInState(hri,State.CLOSED);
  final Future<byte[]> futureB=submitProcedure(am.createUnassignProcedure(hri,ServerName.valueOf("example.org,1234,1"),false));
  waitOnFuture(futureB);
  am.getRegionStates().isRegionInState(hri,State.CLOSED);
  assertEquals(assignSubmittedCount + 1,assignProcMetrics.getSubmittedCounter().getCount());
  assertEquals(assignFailedCount,assignProcMetrics.getFailedCounter().getCount());
  assertEquals(unassignSubmittedCount + 2,unassignProcMetrics.getSubmittedCounter().getCount());
  assertEquals(unassignFailedCount,unassignProcMetrics.getFailedCounter().getCount());
}
