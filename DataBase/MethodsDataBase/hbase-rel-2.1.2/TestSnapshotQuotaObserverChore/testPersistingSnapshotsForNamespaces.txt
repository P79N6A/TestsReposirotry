@Test public void testPersistingSnapshotsForNamespaces() throws Exception {
  Multimap<TableName,SnapshotWithSize> snapshotsWithSizes=HashMultimap.create();
  TableName tn1=TableName.valueOf("ns1:tn1");
  TableName tn2=TableName.valueOf("ns1:tn2");
  TableName tn3=TableName.valueOf("ns2:tn1");
  TableName tn4=TableName.valueOf("ns2:tn2");
  TableName tn5=TableName.valueOf("tn1");
  snapshotsWithSizes.put(tn1,new SnapshotWithSize("",1024L));
  snapshotsWithSizes.put(tn2,new SnapshotWithSize("",1024L));
  snapshotsWithSizes.put(tn3,new SnapshotWithSize("",512L));
  snapshotsWithSizes.put(tn4,new SnapshotWithSize("",1024L));
  snapshotsWithSizes.put(tn5,new SnapshotWithSize("",3072L));
  Map<String,Long> nsSizes=testChore.groupSnapshotSizesByNamespace(snapshotsWithSizes);
  assertEquals(3,nsSizes.size());
  assertEquals(2048L,(long)nsSizes.get("ns1"));
  assertEquals(1536L,(long)nsSizes.get("ns2"));
  assertEquals(3072L,(long)nsSizes.get(NamespaceDescriptor.DEFAULT_NAMESPACE_NAME_STR));
}
