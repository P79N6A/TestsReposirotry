/** 
 * Corner case: HBase has 4 regions, (-oo,b),[b,c),[c,d),[d,+oo), and only rowKey with byte[]={0x00} locate in region (-oo,b) . test whether reversed small scanner will return infinity results with RowKey={0x00}.
 * @throws IOException
 */
@Test public void testSmallReversedScan02() throws IOException {
  Put put=new Put(new byte[]{(char)0x00});
  put.addColumn(COLUMN_FAMILY,null,Bytes.toBytes(0));
  htable.put(put);
  Scan scan=new Scan();
  scan.setCaching(1);
  scan.setReversed(true);
  scan.setSmall(true);
  ResultScanner scanner=htable.getScanner(scan);
  Result r;
  int count=1;
  while ((r=scanner.next()) != null) {
    Assert.assertArrayEquals(r.getValue(COLUMN_FAMILY,null),Bytes.toBytes(0));
    Assert.assertArrayEquals(r.getRow(),new byte[]{(char)0x00});
    Assert.assertTrue(--count >= 0);
  }
  Assert.assertEquals(0,count);
}
