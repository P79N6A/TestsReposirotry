@Test public void test() throws IOException, InterruptedException {
  try (Table t=UTIL.getConnection().getTable(NAME)){
    writeData(t);
    UTIL.flush(NAME);
    UTIL.compact(NAME,true);
    Scan s=new Scan();
    s.addColumn(FAMILY,QUALIFIER);
    try (ResultScanner scanner=t.getScanner(s)){
      for (int i=0; i < NUM_ROWS; i++) {
        Result result=scanner.next();
        assertNotNull("The " + (i + 1) + "th result was unexpectedly null",result);
        assertEquals(1,result.getFamilyMap(FAMILY).size());
        assertArrayEquals(Bytes.toBytes(i + 1),result.getRow());
        assertArrayEquals(Bytes.toBytes(replacedValue),result.getValue(FAMILY,QUALIFIER));
      }
      assertNull(scanner.next());
    }
   }
 }
