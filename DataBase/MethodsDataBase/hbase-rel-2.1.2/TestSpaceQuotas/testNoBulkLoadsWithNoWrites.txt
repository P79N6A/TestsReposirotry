@Test public void testNoBulkLoadsWithNoWrites() throws Exception {
  Put p=new Put(Bytes.toBytes("to_reject"));
  p.addColumn(Bytes.toBytes(SpaceQuotaHelperForTests.F1),Bytes.toBytes("to"),Bytes.toBytes("reject"));
  TableName tableName=writeUntilViolationAndVerifyViolation(SpaceViolationPolicy.NO_WRITES,p);
  ClientServiceCallable<Void> callable=generateFileToLoad(tableName,1,50);
  RpcRetryingCallerFactory factory=new RpcRetryingCallerFactory(TEST_UTIL.getConfiguration());
  RpcRetryingCaller<Void> caller=factory.<Void>newCaller();
  try {
    caller.callWithRetries(callable,Integer.MAX_VALUE);
    fail("Expected the bulk load call to fail!");
  }
 catch (  SpaceLimitingException e) {
    LOG.trace("Caught expected exception",e);
  }
}
