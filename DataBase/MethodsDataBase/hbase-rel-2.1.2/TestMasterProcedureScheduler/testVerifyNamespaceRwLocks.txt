@Test public void testVerifyNamespaceRwLocks() throws Exception {
  String nsName1="ns1";
  String nsName2="ns2";
  TableName tableName1=TableName.valueOf(nsName1,name.getMethodName());
  TableName tableName2=TableName.valueOf(nsName2,name.getMethodName());
  queue.addBack(new TestNamespaceProcedure(1,nsName1,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestTableProcedure(2,tableName1,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestTableProcedure(3,tableName2,TableProcedureInterface.TableOperationType.EDIT));
  queue.addBack(new TestNamespaceProcedure(4,nsName2,TableProcedureInterface.TableOperationType.EDIT));
  Procedure<?> procNs1=queue.poll();
  assertEquals(1,procNs1.getProcId());
  assertFalse(queue.waitNamespaceExclusiveLock(procNs1,nsName1));
  Procedure<?> procNs2=queue.poll();
  assertEquals(4,procNs2.getProcId());
  assertFalse(queue.waitNamespaceExclusiveLock(procNs2,nsName2));
  queue.wakeNamespaceExclusiveLock(procNs2,nsName2);
  queue.yield(procNs2);
  procNs2=queue.poll();
  assertEquals(4,procNs2.getProcId());
  assertFalse(queue.waitNamespaceExclusiveLock(procNs2,nsName2));
  assertNull(queue.poll());
  queue.wakeNamespaceExclusiveLock(procNs1,nsName1);
  long procId=queue.poll().getProcId();
  assertEquals(2,procId);
  queue.wakeNamespaceExclusiveLock(procNs2,nsName2);
  procId=queue.poll().getProcId();
  assertEquals(3,procId);
}
