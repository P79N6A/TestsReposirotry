@Test public void testAcquireSharedLockWhileParentHoldingExclusiveLock(){
  TableName tableName=TableName.valueOf(name.getMethodName());
  RegionInfo regionInfo=RegionInfoBuilder.newBuilder(tableName).build();
  TestTableProcedure parentProc=new TestTableProcedure(1,tableName,TableOperationType.EDIT);
  TestRegionProcedure proc=new TestRegionProcedure(1,2,tableName,TableOperationType.REGION_EDIT,regionInfo);
  queue.addBack(parentProc);
  assertSame(parentProc,queue.poll());
  assertFalse(queue.waitTableExclusiveLock(parentProc,tableName));
  queue.addFront(proc);
  assertSame(proc,queue.poll());
  assertFalse(queue.waitRegion(proc,regionInfo));
  queue.wakeRegion(proc,regionInfo);
  queue.wakeTableExclusiveLock(parentProc,tableName);
}
