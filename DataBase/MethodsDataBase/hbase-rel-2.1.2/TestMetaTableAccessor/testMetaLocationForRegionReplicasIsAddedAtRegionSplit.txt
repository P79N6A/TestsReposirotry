@Test public void testMetaLocationForRegionReplicasIsAddedAtRegionSplit() throws IOException {
  long regionId=System.currentTimeMillis();
  ServerName serverName0=ServerName.valueOf("foo",60010,random.nextLong());
  RegionInfo parent=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName())).setStartKey(HConstants.EMPTY_START_ROW).setEndKey(HConstants.EMPTY_END_ROW).setSplit(false).setRegionId(regionId).setReplicaId(0).build();
  RegionInfo splitA=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName())).setStartKey(HConstants.EMPTY_START_ROW).setEndKey(Bytes.toBytes("a")).setSplit(false).setRegionId(regionId + 1).setReplicaId(0).build();
  RegionInfo splitB=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName())).setStartKey(Bytes.toBytes("a")).setEndKey(HConstants.EMPTY_END_ROW).setSplit(false).setRegionId(regionId + 1).setReplicaId(0).build();
  try (Table meta=MetaTableAccessor.getMetaHTable(connection)){
    List<RegionInfo> regionInfos=Lists.newArrayList(parent);
    MetaTableAccessor.addRegionsToMeta(connection,regionInfos,3);
    MetaTableAccessor.splitRegion(connection,parent,-1L,splitA,splitB,serverName0,3);
    assertEmptyMetaLocation(meta,splitA.getRegionName(),1);
    assertEmptyMetaLocation(meta,splitA.getRegionName(),2);
    assertEmptyMetaLocation(meta,splitB.getRegionName(),1);
    assertEmptyMetaLocation(meta,splitB.getRegionName(),2);
  }
 }
