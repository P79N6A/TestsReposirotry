@Test public void testMetaLocationForRegionReplicasIsAddedAtTableCreation() throws IOException {
  long regionId=System.currentTimeMillis();
  RegionInfo primary=RegionInfoBuilder.newBuilder(TableName.valueOf(name.getMethodName())).setStartKey(HConstants.EMPTY_START_ROW).setEndKey(HConstants.EMPTY_END_ROW).setSplit(false).setRegionId(regionId).setReplicaId(0).build();
  Table meta=MetaTableAccessor.getMetaHTable(connection);
  try {
    List<RegionInfo> regionInfos=Lists.newArrayList(primary);
    MetaTableAccessor.addRegionsToMeta(connection,regionInfos,3);
    assertEmptyMetaLocation(meta,primary.getRegionName(),1);
    assertEmptyMetaLocation(meta,primary.getRegionName(),2);
  }
  finally {
    meta.close();
  }
}
