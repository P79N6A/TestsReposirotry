/** 
 * Tests that a region opened in secondary mode would not write region open / close events to its WAL.
 * @throws IOException
 */
@Test public void testSecondaryRegionDoesNotWriteRegionEventsToWAL() throws IOException {
  secondaryRegion.close();
  walSecondary=spy(walSecondary);
  secondaryRegion=HRegion.openHRegion(secondaryHri,htd,walSecondary,CONF,rss,null);
  verify(walSecondary,times(0)).append(any(RegionInfo.class),any(WALKeyImpl.class),any(WALEdit.class),anyBoolean());
  putDataByReplay(secondaryRegion,0,10,cq,families);
  secondaryRegion.replayWALFlushStartMarker(FlushDescriptor.newBuilder().setFlushSequenceNumber(10).setTableName(UnsafeByteOperations.unsafeWrap(primaryRegion.getTableDescriptor().getTableName().getName())).setAction(FlushAction.START_FLUSH).setEncodedRegionName(UnsafeByteOperations.unsafeWrap(primaryRegion.getRegionInfo().getEncodedNameAsBytes())).setRegionName(UnsafeByteOperations.unsafeWrap(primaryRegion.getRegionInfo().getRegionName())).build());
  verify(walSecondary,times(0)).append(any(RegionInfo.class),any(WALKeyImpl.class),any(WALEdit.class),anyBoolean());
  secondaryRegion.close();
  verify(walSecondary,times(0)).append(any(RegionInfo.class),any(WALKeyImpl.class),any(WALEdit.class),anyBoolean());
}
