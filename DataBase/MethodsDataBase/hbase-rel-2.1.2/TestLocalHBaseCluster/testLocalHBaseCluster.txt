/** 
 * Check that we can start a local HBase cluster specifying a custom master and regionserver class and then cast back to those classes; also that the cluster will launch and terminate cleanly. See HBASE-6011. Uses the HBaseTestingUtility facilities for creating a LocalHBaseCluster with custom master and regionserver classes.
 */
@Test public void testLocalHBaseCluster() throws Exception {
  TEST_UTIL.startMiniCluster(1,1,null,MyHMaster.class,MyHRegionServer.class);
  try {
    int val=((MyHMaster)TEST_UTIL.getHBaseCluster().getMaster(0)).echo(42);
    assertEquals(42,val);
  }
 catch (  ClassCastException e) {
    fail("Could not cast master to our class");
  }
  try {
    int val=((MyHRegionServer)TEST_UTIL.getHBaseCluster().getRegionServer(0)).echo(42);
    assertEquals(42,val);
  }
 catch (  ClassCastException e) {
    fail("Could not cast regionserver to our class");
  }
  TEST_UTIL.shutdownMiniCluster();
}
