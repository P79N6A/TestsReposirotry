/** 
 * Ensure that we only see Results marked as partial when the allowPartial flag is set
 * @throws Exception
 */
@Test public void testAllowPartialResults() throws Exception {
  Scan scan=new Scan();
  scan.setAllowPartialResults(true);
  scan.setMaxResultSize(1);
  ResultScanner scanner=TABLE.getScanner(scan);
  Result result=scanner.next();
  assertTrue(result != null);
  assertTrue(result.mayHaveMoreCellsInRow());
  assertTrue(result.rawCells() != null);
  assertTrue(result.rawCells().length == 1);
  scanner.close();
  scan.setAllowPartialResults(false);
  scanner=TABLE.getScanner(scan);
  result=scanner.next();
  assertTrue(result != null);
  assertTrue(!result.mayHaveMoreCellsInRow());
  assertTrue(result.rawCells() != null);
  assertTrue(result.rawCells().length == NUM_COLS);
  scanner.close();
}
