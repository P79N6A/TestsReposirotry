HRegion initHRegion(byte[] tableName,String callingMethod,Configuration conf,byte[]... families) throws IOException {
  HTableDescriptor htd=new HTableDescriptor(TableName.valueOf(tableName));
  for (  byte[] family : families) {
    htd.addFamily(new HColumnDescriptor(family));
  }
  ChunkCreator.initialize(MemStoreLABImpl.CHUNK_SIZE_DEFAULT,false,0,0,0,null);
  HRegionInfo info=new HRegionInfo(htd.getTableName(),null,null,false);
  Path path=new Path(DIR + callingMethod);
  HRegion r=HBaseTestingUtility.createRegionAndWAL(info,path,conf,htd);
  RegionCoprocessorHost host=new RegionCoprocessorHost(r,Mockito.mock(RegionServerServices.class),conf);
  r.setCoprocessorHost(host);
  return r;
}
