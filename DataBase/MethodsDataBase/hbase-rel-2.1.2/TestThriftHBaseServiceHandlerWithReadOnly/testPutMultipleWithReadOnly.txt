@Test public void testPutMultipleWithReadOnly() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  byte[] rowName1=Bytes.toBytes("testPutMultiple1");
  byte[] rowName2=Bytes.toBytes("testPutMultiple2");
  List<TColumnValue> columnValues=new ArrayList<>(2);
  columnValues.add(new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname)));
  columnValues.add(new TColumnValue(wrap(familyBname),wrap(qualifierBname),wrap(valueBname)));
  List<TPut> puts=new ArrayList<>(2);
  puts.add(new TPut(wrap(rowName1),columnValues));
  puts.add(new TPut(wrap(rowName2),columnValues));
  boolean exceptionCaught=false;
  try {
    handler.putMultiple(table,puts);
  }
 catch (  TIOError e) {
    exceptionCaught=true;
    assertTrue(e.getCause() instanceof DoNotRetryIOException);
    assertEquals("Thrift Server is in Read-only mode.",e.getMessage());
  }
 finally {
    assertTrue(exceptionCaught);
  }
}
