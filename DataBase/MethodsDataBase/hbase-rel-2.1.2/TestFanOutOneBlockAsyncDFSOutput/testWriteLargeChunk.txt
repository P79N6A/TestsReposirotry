@Test public void testWriteLargeChunk() throws IOException, InterruptedException, ExecutionException {
  Path f=new Path("/" + name.getMethodName());
  EventLoop eventLoop=EVENT_LOOP_GROUP.next();
  FanOutOneBlockAsyncDFSOutput out=FanOutOneBlockAsyncDFSOutputHelper.createOutput(FS,f,true,false,(short)3,1024 * 1024 * 1024,eventLoop,CHANNEL_CLASS);
  byte[] b=new byte[50 * 1024 * 1024];
  ThreadLocalRandom.current().nextBytes(b);
  out.write(b);
  out.flush(false);
  assertEquals(b.length,out.flush(false).get().longValue());
  out.close();
  assertEquals(b.length,FS.getFileStatus(f).getLen());
  byte[] actual=new byte[b.length];
  try (FSDataInputStream in=FS.open(f)){
    in.readFully(actual);
  }
   assertArrayEquals(b,actual);
}
