/** 
 * Tests the the  {@link WhileMatchFilter} works in combination with a{@link Filter} that uses the {@link Filter#filterCell(Cell)} method.See HBASE-2258.
 * @throws Exception
 */
@Test public void testWhileMatchFilterWithFilterCell() throws Exception {
  Scan s=new Scan();
  WhileMatchFilter filter=new WhileMatchFilter(new SingleColumnValueFilter(FAMILIES[0],QUALIFIERS_ONE[0],CompareOperator.EQUAL,Bytes.toBytes("foo")));
  s.setFilter(filter);
  InternalScanner scanner=this.region.getScanner(s);
  while (true) {
    ArrayList<Cell> values=new ArrayList<>();
    boolean isMoreResults=scanner.next(values);
    assertTrue("The WhileMatchFilter should now filter all remaining",filter.filterAllRemaining());
    if (!isMoreResults) {
      break;
    }
  }
}
