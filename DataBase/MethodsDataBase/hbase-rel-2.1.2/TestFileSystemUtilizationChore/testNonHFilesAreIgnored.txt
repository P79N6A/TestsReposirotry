@SuppressWarnings("unchecked") @Test public void testNonHFilesAreIgnored(){
  final Configuration conf=getDefaultHBaseConfiguration();
  final HRegionServer rs=mockRegionServer(conf);
  final List<Long> r1StoreFileSizes=Arrays.asList(1024L,2048L);
  final List<Long> r1HFileSizes=Arrays.asList(0L,2048L);
  final long r1HFileSizeSum=sum(r1HFileSizes);
  final List<Long> r2StoreFileSizes=Arrays.asList(1024L * 1024L);
  final List<Long> r2HFileSizes=Arrays.asList(0L);
  final long r2HFileSizeSum=sum(r2HFileSizes);
  final FileSystemUtilizationChore chore=new FileSystemUtilizationChore(rs);
  doAnswer(new ExpectedRegionSizeSummationAnswer(sum(Arrays.asList(r1HFileSizeSum,r2HFileSizeSum)))).when(rs).reportRegionSizesForQuotas((Map<RegionInfo,Long>)any());
  final Region r1=mockRegionWithHFileLinks(r1StoreFileSizes,r1HFileSizes);
  final Region r2=mockRegionWithHFileLinks(r2StoreFileSizes,r2HFileSizes);
  Mockito.doReturn(Arrays.asList(r1,r2)).when(rs).getRegions();
  chore.chore();
}
