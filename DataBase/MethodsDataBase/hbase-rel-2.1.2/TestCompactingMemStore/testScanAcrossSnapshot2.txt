/** 
 * A simple test which verifies the 3 possible states when scanning across snapshot.
 * @throws IOException
 * @throws CloneNotSupportedException
 */
@Override @Test public void testScanAcrossSnapshot2() throws IOException, CloneNotSupportedException {
  final byte[] one=Bytes.toBytes(1);
  final byte[] two=Bytes.toBytes(2);
  final byte[] f=Bytes.toBytes("f");
  final byte[] q=Bytes.toBytes("q");
  final byte[] v=Bytes.toBytes(3);
  final KeyValue kv1=new KeyValue(one,f,q,10,v);
  final KeyValue kv2=new KeyValue(two,f,q,10,v);
  this.memstore.add(kv1.clone(),null);
  this.memstore.add(kv2.clone(),null);
  verifyScanAcrossSnapshot2(kv1,kv2);
  this.memstore.snapshot();
  verifyScanAcrossSnapshot2(kv1,kv2);
  this.memstore=new CompactingMemStore(HBaseConfiguration.create(),CellComparator.getInstance(),store,regionServicesForStores,MemoryCompactionPolicy.EAGER);
  this.memstore.add(kv1.clone(),null);
  this.memstore.snapshot();
  this.memstore.add(kv2.clone(),null);
  verifyScanAcrossSnapshot2(kv1,kv2);
}
