@Test public void testBulkLoad() throws Exception {
  try {
    FileSystem fs=TEST_UTIL.getTestFileSystem();
    final Path dir=TEST_UTIL.getDataTestDirOnTestFS("testBulkLoad");
    fs.mkdirs(dir);
    fs.setPermission(dir,FS_PERMISSION_ALL);
    AccessTestAction bulkLoadAction=new AccessTestAction(){
      @Override public Object run() throws Exception {
        int numRows=3;
        byte[][][] hfileRanges={{{(byte)0},{(byte)9}}};
        Path bulkLoadBasePath=new Path(dir,new Path(User.getCurrent().getName()));
        new BulkLoadHelper(bulkLoadBasePath).initHFileData(TEST_FAMILY,TEST_QUALIFIER,hfileRanges,numRows,FS_PERMISSION_ALL).bulkLoadHFile(TEST_TABLE);
        return null;
      }
    }
;
    verifyAllowed(bulkLoadAction,SUPERUSER,USER_ADMIN,USER_OWNER,USER_CREATE,USER_GROUP_CREATE);
    verifyDenied(bulkLoadAction,USER_RW,USER_NONE,USER_RO,USER_GROUP_READ,USER_GROUP_WRITE,USER_GROUP_ADMIN);
  }
  finally {
    TEST_UTIL.getAdmin().disableTable(TEST_TABLE);
    TEST_UTIL.getAdmin().enableTable(TEST_TABLE);
  }
}
