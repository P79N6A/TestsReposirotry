@Test public void testBulkLoadWithoutWritePermission() throws Exception {
  Path testDataDir0=TEST_UTIL.getDataTestDirOnTestFS("testBulkLoadWithoutWritePermission0");
  Path testDataDir1=TEST_UTIL.getDataTestDirOnTestFS("testBulkLoadWithoutWritePermission1");
  AccessTestAction bulkLoadAction1=new BulkLoadAccessTestAction(FsPermission.valueOf("-r-xr-xr-x"),testDataDir0);
  AccessTestAction bulkLoadAction2=new BulkLoadAccessTestAction(FS_PERMISSION_ALL,testDataDir1);
  BulkLoadHelper.setPermission(TEST_UTIL.getTestFileSystem(),TEST_UTIL.getTestFileSystem().getWorkingDirectory(),FS_PERMISSION_ALL);
  try {
    USER_CREATE.runAs(bulkLoadAction1);
    fail("Should fail because the hbase user has no write permission on hfiles.");
  }
 catch (  IOException e) {
  }
  USER_CREATE.runAs(bulkLoadAction2);
}
