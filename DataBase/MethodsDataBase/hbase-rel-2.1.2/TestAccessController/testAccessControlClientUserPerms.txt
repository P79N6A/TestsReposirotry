@Test public void testAccessControlClientUserPerms() throws Exception {
  final TableName tableName=TableName.valueOf(name.getMethodName());
  createTestTable(tableName);
  try {
    final String regex=tableName.getNameWithNamespaceInclAsString();
    User testUserPerms=User.createUserForTesting(conf,"testUserPerms",new String[0]);
    assertEquals(0,testUserPerms.runAs(getPrivilegedAction(regex)).size());
    grantOnTable(TEST_UTIL,testUserPerms.getShortName(),tableName,null,null,Action.ADMIN);
    List<UserPermission> perms=testUserPerms.runAs(getPrivilegedAction(regex));
    assertNotNull(perms);
    assertEquals(2,perms.size());
  }
  finally {
    deleteTable(TEST_UTIL,tableName);
  }
}
