@Test public void testConcurrentLocate() throws IOException, InterruptedException, ExecutionException {
  createMultiRegionTable();
  byte[][] startKeys=getStartKeys();
  byte[][] endKeys=getEndKeys();
  ServerName[] serverNames=getLocations(startKeys);
  for (int i=0; i < 100; i++) {
    LOCATOR.clearCache(TABLE_NAME);
    List<CompletableFuture<HRegionLocation>> futures=IntStream.range(0,1000).mapToObj(n -> String.format("%03d",n)).map(s -> Bytes.toBytes(s)).map(r -> LOCATOR.getRegionLocation(TABLE_NAME,r,RegionLocateType.CURRENT,false)).collect(toList());
    for (int j=0; j < 1000; j++) {
      int index=Math.min(8,j / 111);
      assertLocEquals(startKeys[index],endKeys[index],serverNames[index],futures.get(j).get());
    }
  }
}
