@Test public void testBatchAndFilterDiffer() throws IOException {
  int limit=5;
  Scan scan=new Scan().setFilter(new ColumnCountOnRowFilter(3)).setBatch(2).setMaxResultSize(1).setLimit(limit);
  try (Table table=UTIL.getConnection().getTable(TABLE_NAME);ResultScanner scanner=table.getScanner(scan)){
    for (int i=0; i < limit; i++) {
      Result result=scanner.next();
      assertEquals(i,Bytes.toInt(result.getRow()));
      assertEquals(2,result.size());
      assertTrue(result.mayHaveMoreCellsInRow());
      assertEquals(i,Bytes.toInt(result.getValue(FAMILY,CQS[0])));
      assertEquals(2 * i,Bytes.toInt(result.getValue(FAMILY,CQS[1])));
      result=scanner.next();
      assertEquals(i,Bytes.toInt(result.getRow()));
      assertEquals(1,result.size());
      assertFalse(result.mayHaveMoreCellsInRow());
      assertEquals(3 * i,Bytes.toInt(result.getValue(FAMILY,CQS[2])));
    }
    assertNull(scanner.next());
  }
 }
