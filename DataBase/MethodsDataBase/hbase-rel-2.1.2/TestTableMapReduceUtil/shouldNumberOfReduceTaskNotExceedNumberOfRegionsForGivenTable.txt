/** 
 * Check what the given number of reduce tasks for the given job configuration does not exceed the number of regions for the given table.
 */
@Test public void shouldNumberOfReduceTaskNotExceedNumberOfRegionsForGivenTable() throws IOException {
  Assert.assertNotNull(presidentsTable);
  Configuration cfg=UTIL.getConfiguration();
  JobConf jobConf=new JobConf(cfg);
  TableMapReduceUtil.setNumReduceTasks(TABLE_NAME,jobConf);
  TableMapReduceUtil.limitNumReduceTasks(TABLE_NAME,jobConf);
  TableMapReduceUtil.setScannerCaching(jobConf,100);
  assertEquals(1,jobConf.getNumReduceTasks());
  assertEquals(100,jobConf.getInt("hbase.client.scanner.caching",0));
  jobConf.setNumReduceTasks(10);
  TableMapReduceUtil.setNumMapTasks(TABLE_NAME,jobConf);
  TableMapReduceUtil.limitNumReduceTasks(TABLE_NAME,jobConf);
  assertEquals(1,jobConf.getNumReduceTasks());
}
