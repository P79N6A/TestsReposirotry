@Test public void testFilterRegions() throws Exception {
  Map<TableName,Integer> mockReportedRegions=new HashMap<>();
  TablesWithQuotas tables=new TablesWithQuotas(TEST_UTIL.getConnection(),TEST_UTIL.getConfiguration()){
    @Override int getNumReportedRegions(    TableName table,    QuotaSnapshotStore<TableName> tableStore){
      Integer i=mockReportedRegions.get(table);
      if (i == null) {
        return 0;
      }
      return i;
    }
  }
;
  TableName tn1=helper.createTableWithRegions(20);
  TableName tn2=helper.createTableWithRegions(20);
  TableName tn3=helper.createTableWithRegions(20);
  tables.addTableQuotaTable(tn1);
  tables.addTableQuotaTable(tn2);
  tables.addTableQuotaTable(tn3);
  mockReportedRegions.put(tn1,10);
  mockReportedRegions.put(tn2,19);
  mockReportedRegions.put(tn3,20);
  tables.filterInsufficientlyReportedTables(null);
  assertEquals(new HashSet<>(Arrays.asList(tn2,tn3)),tables.getTableQuotaTables());
}
