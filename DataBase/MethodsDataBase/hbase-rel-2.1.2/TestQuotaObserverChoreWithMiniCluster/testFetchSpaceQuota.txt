@Test public void testFetchSpaceQuota() throws Exception {
  Multimap<TableName,QuotaSettings> tables=helper.createTablesWithSpaceQuotas();
  chore.initializeSnapshotStores(Collections.emptyMap());
  for (  Entry<TableName,QuotaSettings> entry : tables.entries()) {
    final TableName table=entry.getKey();
    final QuotaSettings qs=entry.getValue();
    assertTrue("QuotaSettings was an instance of " + qs.getClass(),qs instanceof SpaceLimitSettings);
    SpaceQuota spaceQuota=null;
    if (qs.getTableName() != null) {
      spaceQuota=chore.getTableSnapshotStore().getSpaceQuota(table);
      assertNotNull("Could not find table space quota for " + table,spaceQuota);
    }
 else     if (qs.getNamespace() != null) {
      spaceQuota=chore.getNamespaceSnapshotStore().getSpaceQuota(table.getNamespaceAsString());
      assertNotNull("Could not find namespace space quota for " + table.getNamespaceAsString(),spaceQuota);
    }
 else {
      fail("Expected table or namespace space quota");
    }
    final SpaceLimitSettings sls=(SpaceLimitSettings)qs;
    assertEquals(sls.getProto().getQuota(),spaceQuota);
  }
  TableName tableWithoutQuota=helper.createTable();
  assertNull(chore.getTableSnapshotStore().getSpaceQuota(tableWithoutQuota));
}
