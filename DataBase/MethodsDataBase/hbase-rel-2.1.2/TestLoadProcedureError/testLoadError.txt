@Test public void testLoadError() throws Exception {
  ProcedureExecutor<MasterProcedureEnv> procExec=UTIL.getMiniHBaseCluster().getMaster().getMasterProcedureExecutor();
  ARRIVE=new CountDownLatch(1);
  long procId=procExec.submitProcedure(new TestProcedure());
  ARRIVE.await();
  FAIL_LOAD=true;
  UTIL.getMiniHBaseCluster().getMaster().getWalProcedureStore().stop(true);
  UTIL.getMiniHBaseCluster().getMaster().abort("for testing");
  waitNoMaster();
  UTIL.getMiniHBaseCluster().startMaster();
  waitNoMaster();
  UTIL.getMiniHBaseCluster().startMaster();
  waitNoMaster();
  FAIL_LOAD=false;
  HMaster master=UTIL.getMiniHBaseCluster().startMaster().getMaster();
  UTIL.waitFor(30000,() -> master.isActiveMaster() && master.isInitialized());
  TestProcedure proc=(TestProcedure)master.getMasterProcedureExecutor().getProcedure(procId);
  assertFalse(proc.isFinished());
  FINISH_PROC=true;
  UTIL.waitFor(30000,() -> proc.isFinished());
}
