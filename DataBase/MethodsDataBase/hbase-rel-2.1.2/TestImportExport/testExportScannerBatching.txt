/** 
 * Test export scanner batching
 */
@Test public void testExportScannerBatching() throws Throwable {
  TableDescriptor desc=TableDescriptorBuilder.newBuilder(TableName.valueOf(name.getMethodName())).setColumnFamily(ColumnFamilyDescriptorBuilder.newBuilder(FAMILYA).setMaxVersions(1).build()).build();
  UTIL.getAdmin().createTable(desc);
  try (Table t=UTIL.getConnection().getTable(desc.getTableName())){
    Put p=new Put(ROW1);
    p.addColumn(FAMILYA,QUAL,now,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 1,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 2,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 3,QUAL);
    p.addColumn(FAMILYA,QUAL,now + 4,QUAL);
    t.put(p);
    String[] args=new String[]{"-D" + ExportUtils.EXPORT_BATCHING + "="+ EXPORT_BATCH_SIZE,name.getMethodName(),FQ_OUTPUT_DIR};
    assertTrue(runExport(args));
    FileSystem fs=FileSystem.get(UTIL.getConfiguration());
    fs.delete(new Path(FQ_OUTPUT_DIR),true);
  }
 }
