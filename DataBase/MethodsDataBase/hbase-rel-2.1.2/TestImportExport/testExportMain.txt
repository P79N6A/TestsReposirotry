/** 
 * test main method. Export should print help and call System.exit
 */
@Test public void testExportMain() throws Throwable {
  PrintStream oldPrintStream=System.err;
  SecurityManager SECURITY_MANAGER=System.getSecurityManager();
  LauncherSecurityManager newSecurityManager=new LauncherSecurityManager();
  System.setSecurityManager(newSecurityManager);
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  String[] args={};
  System.setErr(new PrintStream(data));
  try {
    System.setErr(new PrintStream(data));
    runExportMain(args);
    fail("should be SecurityException");
  }
 catch (  SecurityException e) {
    assertEquals(-1,newSecurityManager.getExitCode());
    String errMsg=data.toString();
    assertTrue(errMsg.contains("Wrong number of arguments:"));
    assertTrue(errMsg.contains("Usage: Export [-D <property=value>]* <tablename> <outputdir> [<versions> " + "[<starttime> [<endtime>]] [^[regex pattern] or [Prefix] to filter]]"));
    assertTrue(errMsg.contains("-D hbase.mapreduce.scan.column.family=<family1>,<family2>, ..."));
    assertTrue(errMsg.contains("-D hbase.mapreduce.include.deleted.rows=true"));
    assertTrue(errMsg.contains("-D hbase.client.scanner.caching=100"));
    assertTrue(errMsg.contains("-D hbase.export.scanner.batch=10"));
    assertTrue(errMsg.contains("-D hbase.export.scanner.caching=100"));
  }
 finally {
    System.setErr(oldPrintStream);
    System.setSecurityManager(SECURITY_MANAGER);
  }
}
