@Test public void testLiveAndDeadServersStatus() throws Exception {
  List<RegionServerThread> regionserverThreads=CLUSTER.getLiveRegionServerThreads();
  int numRs=0;
  int len=regionserverThreads.size();
  for (int i=0; i < len; i++) {
    if (regionserverThreads.get(i).isAlive()) {
      numRs++;
    }
  }
  Waiter.waitFor(CLUSTER.getConfiguration(),10 * 1000,100,new Predicate<Exception>(){
    @Override public boolean evaluate() throws Exception {
      ClusterStatus status=new ClusterStatus(ADMIN.getClusterMetrics(EnumSet.of(Option.LIVE_SERVERS)));
      Assert.assertNotNull(status);
      return status.getRegionsCount() > 0;
    }
  }
);
  EnumSet<Option> options=EnumSet.of(Option.LIVE_SERVERS,Option.DEAD_SERVERS);
  ClusterStatus status=new ClusterStatus(ADMIN.getClusterMetrics(options));
  checkPbObjectNotNull(status);
  Assert.assertNotNull(status);
  Assert.assertNotNull(status.getServers());
  Assert.assertEquals(SLAVES - 1,numRs);
  Assert.assertEquals(status.getServers().size(),numRs);
  Assert.assertTrue(status.getRegionsCount() > 0);
  Assert.assertNotNull(status.getDeadServerNames());
  Assert.assertEquals(1,status.getDeadServersSize());
  ServerName deadServerName=status.getDeadServerNames().iterator().next();
  Assert.assertEquals(DEAD.getServerName(),deadServerName);
}
