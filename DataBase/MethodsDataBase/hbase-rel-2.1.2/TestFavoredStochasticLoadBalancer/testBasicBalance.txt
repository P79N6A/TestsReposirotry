@Test public void testBasicBalance() throws Exception {
  TableName tableName=TableName.valueOf("testBasicBalance");
  HTableDescriptor desc=new HTableDescriptor(tableName);
  desc.addFamily(new HColumnDescriptor(HConstants.CATALOG_FAMILY));
  admin.createTable(desc,Bytes.toBytes("aaa"),Bytes.toBytes("zzz"),REGION_NUM);
  TEST_UTIL.waitTableAvailable(tableName);
  TEST_UTIL.loadTable(admin.getConnection().getTable(tableName),HConstants.CATALOG_FAMILY);
  admin.flush(tableName);
  compactTable(tableName);
  JVMClusterUtil.RegionServerThread rs1=cluster.startRegionServerAndWait(10000);
  JVMClusterUtil.RegionServerThread rs2=cluster.startRegionServerAndWait(10000);
  admin.setBalancerRunning(true,true);
  assertTrue("Balancer did not run",admin.balancer());
  TEST_UTIL.waitUntilNoRegionsInTransition(120000);
  List<RegionInfo> hris=admin.getRegions(rs1.getRegionServer().getServerName());
  for (  RegionInfo hri : hris) {
    assertFalse("New RS contains regions belonging to table: " + tableName,hri.getTable().equals(tableName));
  }
  hris=admin.getRegions(rs2.getRegionServer().getServerName());
  for (  RegionInfo hri : hris) {
    assertFalse("New RS contains regions belonging to table: " + tableName,hri.getTable().equals(tableName));
  }
}
