@Test public void testGetScannerResults() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<>(1);
  columnValues.add(columnValue);
  for (int i=0; i < 20; i++) {
    TPut put=new TPut(wrap(Bytes.toBytes("testGetScannerResults" + pad(i,(byte)2))),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  List<TColumn> columns=new ArrayList<>(1);
  TColumn column=new TColumn();
  column.setFamily(familyAname);
  column.setQualifier(qualifierAname);
  columns.add(column);
  scan.setColumns(columns);
  scan.setStartRow(Bytes.toBytes("testGetScannerResults"));
  scan.setStopRow(Bytes.toBytes("testGetScannerResults05"));
  List<TResult> results=handler.getScannerResults(table,scan,5);
  assertEquals(5,results.size());
  for (int i=0; i < 5; i++) {
    assertArrayEquals(Bytes.toBytes("testGetScannerResults" + pad(i,(byte)2)),results.get(i).getRow());
  }
  scan.setStopRow(Bytes.toBytes("testGetScannerResults10"));
  results=handler.getScannerResults(table,scan,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(Bytes.toBytes("testGetScannerResults" + pad(i,(byte)2)),results.get(i).getRow());
  }
  scan.setStopRow(Bytes.toBytes("testGetScannerResults20"));
  results=handler.getScannerResults(table,scan,20);
  assertEquals(20,results.size());
  for (int i=0; i < 20; i++) {
    assertArrayEquals(Bytes.toBytes("testGetScannerResults" + pad(i,(byte)2)),results.get(i).getRow());
  }
  scan=new TScan();
  scan.setColumns(columns);
  scan.setReversed(true);
  scan.setStartRow(Bytes.toBytes("testGetScannerResults20"));
  scan.setStopRow(Bytes.toBytes("testGetScannerResults"));
  results=handler.getScannerResults(table,scan,20);
  assertEquals(20,results.size());
  for (int i=0; i < 20; i++) {
    assertArrayEquals(Bytes.toBytes("testGetScannerResults" + pad(19 - i,(byte)2)),results.get(i).getRow());
  }
}
