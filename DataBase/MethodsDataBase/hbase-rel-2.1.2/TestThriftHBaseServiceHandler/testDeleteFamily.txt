@Test public void testDeleteFamily() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  byte[] rowName=Bytes.toBytes("testDeleteFamily");
  ByteBuffer table=wrap(tableAname);
  long timestamp1=System.currentTimeMillis() - 10;
  long timestamp2=System.currentTimeMillis();
  List<TColumnValue> columnValues=new ArrayList<>();
  TColumnValue columnValueA=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  columnValueA.setTimestamp(timestamp1);
  columnValues.add(columnValueA);
  TPut put=new TPut(wrap(rowName),columnValues);
  put.setColumnValues(columnValues);
  handler.put(table,put);
  columnValueA.setTimestamp(timestamp2);
  handler.put(table,put);
  TGet get=new TGet(wrap(rowName));
  get.setMaxVersions(2);
  TResult result=handler.get(table,get);
  assertEquals(2,result.getColumnValuesSize());
  TDelete delete=new TDelete(wrap(rowName));
  List<TColumn> deleteColumns=new ArrayList<>();
  TColumn deleteColumn=new TColumn(wrap(familyAname));
  deleteColumns.add(deleteColumn);
  delete.setColumns(deleteColumns);
  delete.setDeleteType(TDeleteType.DELETE_FAMILY);
  handler.deleteSingle(table,delete);
  get=new TGet(wrap(rowName));
  result=handler.get(table,get);
  assertArrayEquals(null,result.getRow());
  assertEquals(0,result.getColumnValuesSize());
}
