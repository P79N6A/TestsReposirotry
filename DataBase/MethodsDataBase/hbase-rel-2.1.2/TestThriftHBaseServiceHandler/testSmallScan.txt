@Test public void testSmallScan() throws Exception {
  ThriftHBaseServiceHandler handler=createHandler();
  ByteBuffer table=wrap(tableAname);
  TColumnValue columnValue=new TColumnValue(wrap(familyAname),wrap(qualifierAname),wrap(valueAname));
  List<TColumnValue> columnValues=new ArrayList<>();
  columnValues.add(columnValue);
  for (int i=0; i < 10; i++) {
    TPut put=new TPut(wrap(Bytes.toBytes("testSmallScan" + i)),columnValues);
    handler.put(table,put);
  }
  TScan scan=new TScan();
  scan.setStartRow(Bytes.toBytes("testSmallScan"));
  scan.setStopRow(Bytes.toBytes("testSmallScan\uffff"));
  scan.setReadType(TReadType.PREAD);
  scan.setCaching(2);
  int scanId=handler.openScanner(table,scan);
  List<TResult> results=handler.getScannerRows(scanId,10);
  assertEquals(10,results.size());
  for (int i=0; i < 10; i++) {
    assertArrayEquals(Bytes.toBytes("testSmallScan" + i),results.get(i).getRow());
  }
  results=handler.getScannerRows(scanId,10);
  assertEquals(0,results.size());
  handler.closeScanner(scanId);
  try {
    handler.getScannerRows(scanId,10);
    fail("Scanner id should be invalid");
  }
 catch (  TIllegalArgument e) {
  }
}
