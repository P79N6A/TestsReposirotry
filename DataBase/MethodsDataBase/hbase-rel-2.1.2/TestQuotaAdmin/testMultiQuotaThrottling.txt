@Test public void testMultiQuotaThrottling() throws Exception {
  byte[] FAMILY=Bytes.toBytes("testFamily");
  byte[] ROW=Bytes.toBytes("testRow");
  byte[] QUALIFIER=Bytes.toBytes("testQualifier");
  byte[] VALUE=Bytes.toBytes("testValue");
  Admin admin=TEST_UTIL.getAdmin();
  TableName tableName=TableName.valueOf("testMultiQuotaThrottling");
  TableDescriptor desc=TableDescriptorBuilder.newBuilder(tableName).setColumnFamily(ColumnFamilyDescriptorBuilder.of(FAMILY)).build();
  admin.createTable(desc);
  admin.setQuota(QuotaSettingsFactory.throttleTable(tableName,ThrottleType.WRITE_NUMBER,6,TimeUnit.SECONDS));
  Thread.sleep(1000);
  TEST_UTIL.getRSForFirstRegionInTable(tableName).getRegionServerRpcQuotaManager().getQuotaCache().triggerCacheRefresh();
  Thread.sleep(1000);
  Table t=TEST_UTIL.getConnection().getTable(tableName);
  try {
    int size=5;
    List actions=new ArrayList();
    Object[] results=new Object[size];
    for (int i=0; i < size; i++) {
      Put put1=new Put(ROW);
      put1.addColumn(FAMILY,QUALIFIER,VALUE);
      actions.add(put1);
    }
    t.batch(actions,results);
    t.batch(actions,results);
  }
 catch (  IOException e) {
    fail("Not supposed to get ThrottlingExcepiton " + e);
  }
 finally {
    t.close();
  }
}
