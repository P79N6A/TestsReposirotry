@Test public void testOldEntriesRemoved(){
  MasterServices masterServices=mock(MasterServices.class);
  MasterQuotaManager manager=new MasterQuotaManager(masterServices);
  manager.initializeRegionSizes();
  TableName tableName=TableName.valueOf("foo");
  HRegionInfo region1=new HRegionInfo(tableName,null,toBytes("a"));
  HRegionInfo region2=new HRegionInfo(tableName,toBytes("a"),toBytes("b"));
  HRegionInfo region3=new HRegionInfo(tableName,toBytes("b"),toBytes("c"));
  HRegionInfo region4=new HRegionInfo(tableName,toBytes("c"),toBytes("d"));
  HRegionInfo region5=new HRegionInfo(tableName,toBytes("d"),null);
  final long size=0;
  long time1=10;
  manager.addRegionSize(region1,size,time1);
  manager.addRegionSize(region2,size,time1);
  long time2=20;
  manager.addRegionSize(region3,size,time2);
  manager.addRegionSize(region4,size,time2);
  long time3=30;
  manager.addRegionSize(region5,size,time3);
  assertEquals(5,manager.snapshotRegionSizes().size());
  assertEquals(0,manager.pruneEntriesOlderThan(0));
  assertEquals(5,manager.snapshotRegionSizes().size());
  assertEquals(0,manager.pruneEntriesOlderThan(10));
  assertEquals(5,manager.snapshotRegionSizes().size());
  assertEquals(2,manager.pruneEntriesOlderThan(15));
  assertEquals(3,manager.snapshotRegionSizes().size());
  assertEquals(2,manager.pruneEntriesOlderThan(30));
  assertEquals(1,manager.snapshotRegionSizes().size());
}
