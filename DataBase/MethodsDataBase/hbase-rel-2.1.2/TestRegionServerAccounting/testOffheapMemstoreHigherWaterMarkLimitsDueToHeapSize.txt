@Test public void testOffheapMemstoreHigherWaterMarkLimitsDueToHeapSize(){
  conf.setLong(MemorySizeUtil.OFFHEAP_MEMSTORE_SIZE_KEY,(1L * 1024L));
  RegionServerAccounting regionServerAccounting=new RegionServerAccounting(conf);
  long dataSize=regionServerAccounting.getGlobalOnHeapMemStoreLimit();
  MemStoreSize memstoreSize=new MemStoreSize(dataSize,dataSize,0);
  regionServerAccounting.incGlobalMemStoreSize(memstoreSize);
  assertEquals(FlushType.ABOVE_ONHEAP_HIGHER_MARK,regionServerAccounting.isAboveHighWaterMark());
}
