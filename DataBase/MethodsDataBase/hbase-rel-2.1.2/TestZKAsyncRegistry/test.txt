@Test public void test() throws InterruptedException, ExecutionException, IOException {
  LOG.info("STARTED TEST");
  String clusterId=REGISTRY.getClusterId().get();
  String expectedClusterId=TEST_UTIL.getHBaseCluster().getMaster().getClusterId();
  assertEquals("Expected " + expectedClusterId + ", found="+ clusterId,expectedClusterId,clusterId);
  assertEquals(TEST_UTIL.getHBaseCluster().getClusterMetrics().getLiveServerMetrics().size(),REGISTRY.getCurrentNrHRS().get().intValue());
  assertEquals(TEST_UTIL.getHBaseCluster().getMaster().getServerName(),REGISTRY.getMasterAddress().get());
  assertEquals(-1,REGISTRY.getMasterInfoPort().get().intValue());
  waitUntilAllReplicasHavingRegionLocation(TableName.META_TABLE_NAME);
  RegionLocations locs=REGISTRY.getMetaRegionLocation().get();
  assertEquals(3,locs.getRegionLocations().length);
  IntStream.range(0,3).forEach(i -> {
    HRegionLocation loc=locs.getRegionLocation(i);
    assertNotNull("Replica " + i + " doesn't have location",loc);
    assertEquals(TableName.META_TABLE_NAME,loc.getRegion().getTable());
    assertEquals(i,loc.getRegion().getReplicaId());
  }
);
}
