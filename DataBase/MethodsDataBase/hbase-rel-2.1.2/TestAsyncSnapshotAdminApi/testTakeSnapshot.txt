@Test public void testTakeSnapshot() throws Exception {
  Admin syncAdmin=TEST_UTIL.getAdmin();
  Table table=TEST_UTIL.createTable(tableName,Bytes.toBytes("f1"));
  for (int i=0; i < 3000; i++) {
    table.put(new Put(Bytes.toBytes(i)).addColumn(Bytes.toBytes("f1"),Bytes.toBytes("cq"),Bytes.toBytes(i)));
  }
  admin.snapshot(snapshotName1,tableName).get();
  admin.snapshot(snapshotName2,tableName).get();
  List<SnapshotDescription> snapshots=syncAdmin.listSnapshots();
  Collections.sort(snapshots,(snap1,snap2) -> {
    assertNotNull(snap1);
    assertNotNull(snap1.getName());
    assertNotNull(snap2);
    assertNotNull(snap2.getName());
    return snap1.getName().compareTo(snap2.getName());
  }
);
  assertEquals(snapshotName1,snapshots.get(0).getName());
  assertEquals(tableName,snapshots.get(0).getTableName());
  assertEquals(SnapshotType.FLUSH,snapshots.get(0).getType());
  assertEquals(snapshotName2,snapshots.get(1).getName());
  assertEquals(tableName,snapshots.get(1).getTableName());
  assertEquals(SnapshotType.FLUSH,snapshots.get(1).getType());
}
