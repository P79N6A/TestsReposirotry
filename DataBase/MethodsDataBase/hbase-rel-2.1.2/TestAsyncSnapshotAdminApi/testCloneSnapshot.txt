@Test public void testCloneSnapshot() throws Exception {
  TableName tableName2=TableName.valueOf("testCloneSnapshot2");
  Admin syncAdmin=TEST_UTIL.getAdmin();
  Table table=TEST_UTIL.createTable(tableName,Bytes.toBytes("f1"));
  for (int i=0; i < 3000; i++) {
    table.put(new Put(Bytes.toBytes(i)).addColumn(Bytes.toBytes("f1"),Bytes.toBytes("cq"),Bytes.toBytes(i)));
  }
  admin.snapshot(snapshotName1,tableName).get();
  List<SnapshotDescription> snapshots=syncAdmin.listSnapshots();
  assertEquals(1,snapshots.size());
  assertEquals(snapshotName1,snapshots.get(0).getName());
  assertEquals(tableName,snapshots.get(0).getTableName());
  assertEquals(SnapshotType.FLUSH,snapshots.get(0).getType());
  boolean failed=false;
  try {
    admin.cloneSnapshot(snapshotName1,tableName).get();
  }
 catch (  Exception e) {
    failed=true;
  }
  assertTrue(failed);
  assertTrue(!syncAdmin.tableExists(tableName2));
  admin.cloneSnapshot(snapshotName1,tableName2).get();
  syncAdmin.tableExists(tableName2);
}
