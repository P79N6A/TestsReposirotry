@Test public void testMultipleRows() throws Throwable {
  prepareTestData();
  failures.set(0);
  int numThreads=100;
  concurrentExec(new SwapRowsRunner(),numThreads);
  LOG.debug("row keyvalues:" + stringifyKvs(table.get(new Get(ROW)).listCells()));
  LOG.debug("row2 keyvalues:" + stringifyKvs(table.get(new Get(ROW2)).listCells()));
  int failureNumber=failures.get();
  if (failureNumber > 0) {
    LOG.debug("We failed " + failureNumber + " times during test");
  }
  if (!swapped) {
    assertEquals(rowSize,table.get(new Get(ROW)).listCells().size());
    assertEquals(row2Size,table.get(new Get(ROW2)).listCells().size());
  }
 else {
    assertEquals(rowSize,table.get(new Get(ROW2)).listCells().size());
    assertEquals(row2Size,table.get(new Get(ROW)).listCells().size());
  }
}
