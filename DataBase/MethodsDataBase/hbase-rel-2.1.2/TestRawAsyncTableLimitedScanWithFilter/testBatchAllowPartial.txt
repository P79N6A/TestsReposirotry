@Test public void testBatchAllowPartial() throws InterruptedException, ExecutionException {
  int limit=5;
  Scan scan=new Scan().setFilter(new ColumnCountOnRowFilter(3)).setBatch(2).setMaxResultSize(1).setAllowPartialResults(true).setLimit(limit);
  List<Result> results=TABLE.scanAll(scan).get();
  assertEquals(3 * limit,results.size());
  IntStream.range(0,3 * limit).forEach(i -> {
    int key=i / 3;
    Result result=results.get(i);
    assertEquals(key,Bytes.toInt(result.getRow()));
    assertEquals(1,result.size());
    assertTrue(result.mayHaveMoreCellsInRow());
    int cqIndex=i % 3;
    assertEquals(key * (cqIndex + 1),Bytes.toInt(result.getValue(FAMILY,CQS[cqIndex])));
  }
);
}
