@Test public void testDeleteMobTable() throws Exception {
  final TableName tableName=TableName.valueOf(name.getMethodName());
  HTableDescriptor htd=createTableDescriptor(tableName,true);
  HColumnDescriptor hcd=htd.getFamily(FAMILY);
  String fileName=null;
  Table table=createTableWithOneFile(htd);
  try {
    Assert.assertEquals(1,countMobFiles(tableName,hcd.getNameAsString()));
    Assert.assertEquals(0,countArchiveMobFiles(tableName,hcd.getNameAsString()));
    fileName=assertHasOneMobRow(table,tableName,hcd.getNameAsString());
    Assert.assertFalse(mobArchiveExist(tableName,hcd.getNameAsString(),fileName));
    Assert.assertTrue(mobTableDirExist(tableName));
  }
  finally {
    table.close();
    TEST_UTIL.deleteTable(tableName);
  }
  Assert.assertFalse(TEST_UTIL.getAdmin().tableExists(tableName));
  Assert.assertEquals(0,countMobFiles(tableName,hcd.getNameAsString()));
  Assert.assertEquals(1,countArchiveMobFiles(tableName,hcd.getNameAsString()));
  Assert.assertTrue(mobArchiveExist(tableName,hcd.getNameAsString(),fileName));
  Assert.assertFalse(mobTableDirExist(tableName));
}
