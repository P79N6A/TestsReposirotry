@Test public void testStoreFileMissing() throws Exception {
  write("row1");
  region.flush(true);
  write("row2");
  region.flush(true);
  write("row3");
  region.flush(true);
  Scan scan=new Scan();
  scan.setCaching(1);
  RegionScanner scanner=region.getScanner(scan);
  List<Cell> res=new ArrayList<Cell>();
  scanner.next(res);
  assertEquals("row1",Bytes.toString(CellUtil.cloneRow(res.get(0))));
  res.clear();
  write("row4");
  region.flush(true);
  region.compact(true);
  CompactedHFilesDischarger cleaner=new CompactedHFilesDischarger(1000,(Stoppable)null,rss,false);
  cleaner.chore();
  scanner.next(res);
  assertEquals("row2",Bytes.toString(CellUtil.cloneRow(res.get(0))));
  scanner.close();
}
