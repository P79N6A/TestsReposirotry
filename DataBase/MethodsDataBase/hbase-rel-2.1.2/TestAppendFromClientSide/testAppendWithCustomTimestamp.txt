@Test public void testAppendWithCustomTimestamp() throws IOException {
  TableName TABLENAME=TableName.valueOf(name.getMethodName());
  Table table=TEST_UTIL.createTable(TABLENAME,FAMILY);
  long timestamp=999;
  Append append=new Append(ROW);
  append.add(CellUtil.createCell(ROW,FAMILY,QUALIFIER,timestamp,KeyValue.Type.Put.getCode(),Bytes.toBytes(100L)));
  Result r=table.append(append);
  assertEquals(1,r.size());
  assertEquals(timestamp,r.rawCells()[0].getTimestamp());
  r=table.get(new Get(ROW));
  assertEquals(1,r.size());
  assertEquals(timestamp,r.rawCells()[0].getTimestamp());
  r=table.append(append);
  assertEquals(1,r.size());
  assertNotEquals(timestamp,r.rawCells()[0].getTimestamp());
  r=table.get(new Get(ROW));
  assertEquals(1,r.size());
  assertNotEquals(timestamp,r.rawCells()[0].getTimestamp());
}
