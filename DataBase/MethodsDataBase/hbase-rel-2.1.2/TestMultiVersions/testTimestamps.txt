/** 
 * Tests user specifiable time stamps putting, getting and scanning.  Also tests same in presence of deletes.  Test cores are written so can be run against an HRegion and against an HTable: i.e. both local and remote. <p>Port of old TestTimestamp test to here so can better utilize the spun up cluster running more than a single test per spin up.  Keep old tests' crazyness.
 */
@Test public void testTimestamps() throws Exception {
  HTableDescriptor desc=new HTableDescriptor(TableName.valueOf(name.getMethodName()));
  HColumnDescriptor hcd=new HColumnDescriptor(TimestampTestBase.FAMILY_NAME);
  hcd.setMaxVersions(3);
  desc.addFamily(hcd);
  this.admin.createTable(desc);
  Table table=UTIL.getConnection().getTable(desc.getTableName());
  TimestampTestBase.doTestDelete(table,new FlushCache(){
    @Override public void flushcache() throws IOException {
      UTIL.getHBaseCluster().flushcache();
    }
  }
);
  TimestampTestBase.doTestTimestampScanning(table,new FlushCache(){
    @Override public void flushcache() throws IOException {
      UTIL.getMiniHBaseCluster().flushcache();
    }
  }
);
  table.close();
}
