@Test public void testRemoveTable() throws Exception {
  TableName tableName=createTable();
  ReplicationPeerConfig peerConfig=ReplicationPeerConfig.newBuilder().setClusterKey("127.0.0.1:2181:/hbase").setReplicationEndpointImpl(LocalReplicationEndpoint.class.getName()).setReplicateAllUserTables(false).setTableCFsMap(ImmutableMap.of(tableName,Collections.emptyList())).setSerial(true).build();
  UTIL.getAdmin().addReplicationPeer(PEER_ID,peerConfig,true);
  try (Table table=UTIL.getConnection().getTable(tableName)){
    for (int i=0; i < 100; i++) {
      table.put(new Put(Bytes.toBytes(i)).addColumn(CF,CQ,Bytes.toBytes(i)));
    }
  }
   RegionInfo region=UTIL.getMiniHBaseCluster().getRegions(tableName).get(0).getRegionInfo();
  waitUntilHasLastPushedSequenceId(region);
  UTIL.getAdmin().updateReplicationPeerConfig(PEER_ID,ReplicationPeerConfig.newBuilder(peerConfig).setTableCFsMap(Collections.emptyMap()).build());
  ReplicationQueueStorage queueStorage=UTIL.getMiniHBaseCluster().getMaster().getReplicationPeerManager().getQueueStorage();
  assertEquals(HConstants.NO_SEQNUM,queueStorage.getLastSequenceId(region.getEncodedName(),PEER_ID));
}
