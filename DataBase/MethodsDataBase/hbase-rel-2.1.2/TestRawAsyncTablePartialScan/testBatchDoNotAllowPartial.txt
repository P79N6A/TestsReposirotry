@Test public void testBatchDoNotAllowPartial() throws InterruptedException, ExecutionException {
  List<Result> results=TABLE.scanAll(new Scan().setBatch(2).setMaxResultSize(1)).get();
  assertEquals(2 * COUNT,results.size());
  for (int i=0; i < COUNT; i++) {
    Result firstTwo=results.get(2 * i);
    assertEquals(String.format("%02d",i),Bytes.toString(firstTwo.getRow()));
    assertEquals(2,firstTwo.size());
    assertEquals(i,Bytes.toInt(firstTwo.getValue(FAMILY,CQS[0])));
    assertEquals(2 * i,Bytes.toInt(firstTwo.getValue(FAMILY,CQS[1])));
    Result secondOne=results.get(2 * i + 1);
    assertEquals(String.format("%02d",i),Bytes.toString(secondOne.getRow()));
    assertEquals(1,secondOne.size());
    assertEquals(3 * i,Bytes.toInt(secondOne.getValue(FAMILY,CQS[2])));
  }
}
