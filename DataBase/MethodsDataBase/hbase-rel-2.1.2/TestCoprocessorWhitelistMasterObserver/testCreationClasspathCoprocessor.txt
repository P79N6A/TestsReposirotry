/** 
 * Test a table creation including a coprocessor path which is on the classpath
 * @result Table will be created with the coprocessor
 */
@Test public void testCreationClasspathCoprocessor() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  conf.set(CoprocessorHost.MASTER_COPROCESSOR_CONF_KEY,CoprocessorWhitelistMasterObserver.class.getName());
  conf.setStrings(CoprocessorWhitelistMasterObserver.CP_COPROCESSOR_WHITELIST_PATHS_KEY,new String[]{});
  conf.setInt("hbase.client.retries.number",5);
  UTIL.startMiniCluster();
  HTableDescriptor htd=new HTableDescriptor(TEST_TABLE);
  HColumnDescriptor hcd=new HColumnDescriptor(TEST_FAMILY);
  htd.addFamily(hcd);
  htd.addCoprocessor(TestRegionObserver.class.getName());
  Connection connection=ConnectionFactory.createConnection(conf);
  Admin admin=connection.getAdmin();
  LOG.info("Creating Table");
  admin.createTable(htd);
  LOG.info("Done Creating Table");
  Table t=connection.getTable(TEST_TABLE);
  assertEquals(1,t.getTableDescriptor().getCoprocessors().size());
}
