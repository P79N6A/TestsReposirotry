@Test public void testRefreshRegionHFilesEndpoint() throws Exception {
  setUp(HRegion.class.getName());
  MasterFileSystem mfs=HTU.getMiniHBaseCluster().getMaster().getMasterFileSystem();
  Path tableDir=FSUtils.getTableDir(mfs.getRootDir(),TABLE_NAME);
  for (  Region region : cluster.getRegions(TABLE_NAME)) {
    Path regionDir=new Path(tableDir,region.getRegionInfo().getEncodedName());
    Path familyDir=new Path(regionDir,Bytes.toString(FAMILY));
    HFileTestUtil.createHFile(HTU.getConfiguration(),HTU.getTestFileSystem(),new Path(familyDir,HFILE_NAME),FAMILY,QUALIFIER,Bytes.toBytes("50"),Bytes.toBytes("60"),NUM_ROWS);
  }
  assertEquals(2,HTU.getNumHFiles(TABLE_NAME,FAMILY));
  callRefreshRegionHFilesEndPoint();
  assertEquals(4,HTU.getNumHFiles(TABLE_NAME,FAMILY));
}
