/** 
 * Ensure we do not HAVE TO HAVE a codec.
 */
@Test public void testNoCodec() throws IOException, ServiceException {
  Configuration conf=HBaseConfiguration.create();
  RpcServer rpcServer=createRpcServer(null,"testRpcServer",Lists.newArrayList(new RpcServer.BlockingServiceAndInterface(SERVICE,null)),new InetSocketAddress("localhost",0),CONF,new FifoRpcScheduler(CONF,1));
  try (AbstractRpcClient<?> client=createRpcClientNoCodec(conf)){
    rpcServer.start();
    BlockingInterface stub=newBlockingStub(client,rpcServer.getListenerAddress());
    HBaseRpcController pcrc=new HBaseRpcControllerImpl();
    String message="hello";
    assertEquals(message,stub.echo(pcrc,EchoRequestProto.newBuilder().setMessage(message).build()).getMessage());
    assertNull(pcrc.cellScanner());
  }
  finally {
    rpcServer.stop();
  }
}
