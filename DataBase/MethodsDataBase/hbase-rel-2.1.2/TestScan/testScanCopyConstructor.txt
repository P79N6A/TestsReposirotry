@Test public void testScanCopyConstructor() throws Exception {
  Scan scan=new Scan();
  scan.addColumn(Bytes.toBytes("cf"),Bytes.toBytes("q")).setACL("test_user",new Permission(Permission.Action.READ)).setAllowPartialResults(true).setAsyncPrefetch(false).setAttribute("test_key",Bytes.toBytes("test_value")).setAuthorizations(new Authorizations("test_label")).setBatch(10).setCacheBlocks(false).setCaching(10).setConsistency(Consistency.TIMELINE).setFilter(new FilterList()).setId("scan_copy_constructor").setIsolationLevel(IsolationLevel.READ_COMMITTED).setLimit(100).setLoadColumnFamiliesOnDemand(false).setMaxResultSize(100).setMaxResultsPerColumnFamily(1000).readVersions(9999).setMvccReadPoint(5).setNeedCursorResult(true).setPriority(1).setRaw(true).setReplicaId(3).setReversed(true).setRowOffsetPerColumnFamily(5).setRowPrefixFilter(Bytes.toBytes("row_")).setScanMetricsEnabled(true).setSmall(true).setReadType(ReadType.STREAM).withStartRow(Bytes.toBytes("row_1")).withStopRow(Bytes.toBytes("row_2")).setTimeRange(0,13);
  Scan scanCopy=new Scan(scan);
  assertEquals(scan.getACL(),scanCopy.getACL());
  assertEquals(scan.getAllowPartialResults(),scanCopy.getAllowPartialResults());
  assertEquals(scan.getAttribute("test_key"),scanCopy.getAttribute("test_key"));
  assertEquals(scan.getAttributeSize(),scanCopy.getAttributeSize());
  assertEquals(scan.getAttributesMap(),scanCopy.getAttributesMap());
  assertEquals(scan.getAuthorizations().getLabels(),scanCopy.getAuthorizations().getLabels());
  assertEquals(scan.getBatch(),scanCopy.getBatch());
  assertEquals(scan.getCacheBlocks(),scanCopy.getCacheBlocks());
  assertEquals(scan.getCaching(),scanCopy.getCaching());
  assertEquals(scan.getConsistency(),scanCopy.getConsistency());
  assertEquals(scan.getFamilies().length,scanCopy.getFamilies().length);
  assertEquals(scan.getFamilies()[0],scanCopy.getFamilies()[0]);
  assertEquals(scan.getFamilyMap(),scanCopy.getFamilyMap());
  assertEquals(scan.getFilter(),scanCopy.getFilter());
  assertEquals(scan.getId(),scanCopy.getId());
  assertEquals(scan.getIsolationLevel(),scanCopy.getIsolationLevel());
  assertEquals(scan.getLimit(),scanCopy.getLimit());
  assertEquals(scan.getLoadColumnFamiliesOnDemandValue(),scanCopy.getLoadColumnFamiliesOnDemandValue());
  assertEquals(scan.getMaxResultSize(),scanCopy.getMaxResultSize());
  assertEquals(scan.getMaxResultsPerColumnFamily(),scanCopy.getMaxResultsPerColumnFamily());
  assertEquals(scan.getMaxVersions(),scanCopy.getMaxVersions());
  assertEquals(scan.getMvccReadPoint(),scanCopy.getMvccReadPoint());
  assertEquals(scan.getPriority(),scanCopy.getPriority());
  assertEquals(scan.getReadType(),scanCopy.getReadType());
  assertEquals(scan.getReplicaId(),scanCopy.getReplicaId());
  assertEquals(scan.getRowOffsetPerColumnFamily(),scanCopy.getRowOffsetPerColumnFamily());
  assertEquals(scan.getStartRow(),scanCopy.getStartRow());
  assertEquals(scan.getStopRow(),scanCopy.getStopRow());
  assertEquals(scan.getTimeRange(),scanCopy.getTimeRange());
  assertTrue("Make sure copy constructor adds all the fields in the copied object",EqualsBuilder.reflectionEquals(scan,scanCopy));
}
