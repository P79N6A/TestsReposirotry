@Test public void test() throws Exception {
  try (Connection conn=ConnectionFactory.createConnection(TEST_UTIL.getConfiguration());Table table=conn.getTable(TABLE_NAME)){
    org.apache.hadoop.hbase.mapreduce.TableRecordReaderImpl trr=new org.apache.hadoop.hbase.mapreduce.TableRecordReaderImpl();
    Scan scan=new Scan().setMaxResultSize(1).setCaching(Integer.MAX_VALUE).setNeedCursorResult(true);
    trr.setScan(scan);
    trr.setHTable(table);
    trr.initialize(null,null);
    int num=0;
    while (trr.nextKeyValue()) {
      num++;
    }
    assertEquals(NUM_ROWS * NUM_FAMILIES * NUM_QUALIFIERS,num);
  }
 }
