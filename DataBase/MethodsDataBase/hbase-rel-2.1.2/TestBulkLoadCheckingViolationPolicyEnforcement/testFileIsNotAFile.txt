@Test(expected=IllegalArgumentException.class) public void testFileIsNotAFile() throws Exception {
  final List<String> paths=new ArrayList<>();
  String path="/1";
  FileStatus status=mock(FileStatus.class);
  when(fs.getFileStatus(new Path(path))).thenReturn(status);
  when(status.getLen()).thenReturn(1000L);
  when(status.isFile()).thenReturn(false);
  paths.add(path);
  SpaceQuotaSnapshot snapshot=new SpaceQuotaSnapshot(SpaceQuotaStatus.notInViolation(),0,Long.MAX_VALUE);
  policy.initialize(rss,tableName,snapshot);
  policy.checkBulkLoad(fs,paths);
}
