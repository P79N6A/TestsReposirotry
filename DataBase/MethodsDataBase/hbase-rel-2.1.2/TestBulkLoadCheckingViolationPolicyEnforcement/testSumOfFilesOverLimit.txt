@Test(expected=SpaceLimitingException.class) public void testSumOfFilesOverLimit() throws Exception {
  final List<String> paths=new ArrayList<>();
  final List<FileStatus> statuses=new ArrayList<>();
  final long length=1024L;
  for (int i=0; i < 5; i++) {
    String path="/" + i;
    FileStatus status=mock(FileStatus.class);
    when(fs.getFileStatus(new Path(path))).thenReturn(status);
    when(status.getLen()).thenReturn(length);
    when(status.isFile()).thenReturn(true);
    paths.add(path);
    statuses.add(status);
  }
  SpaceQuotaSnapshot snapshot=new SpaceQuotaSnapshot(SpaceQuotaStatus.notInViolation(),0,5000L);
  policy.initialize(rss,tableName,snapshot);
  policy.checkBulkLoad(fs,paths);
}
