@Test public void testCreateTableWithSingleReplica() throws Exception {
  final int numRegions=3;
  final int numReplica=1;
  final TableName tableName=TableName.valueOf(name.getMethodName());
  try {
    HTableDescriptor desc=new HTableDescriptor(tableName);
    desc.setRegionReplication(numReplica);
    desc.addFamily(new HColumnDescriptor("family"));
    ADMIN.createTable(desc,Bytes.toBytes("A"),Bytes.toBytes("Z"),numRegions);
    validateNumberOfRowsInMeta(tableName,numRegions,ADMIN.getConnection());
    List<RegionInfo> hris=MetaTableAccessor.getTableRegions(ADMIN.getConnection(),tableName);
    assert (hris.size() == numRegions * numReplica);
  }
  finally {
    ADMIN.disableTable(tableName);
    ADMIN.deleteTable(tableName);
  }
}
