@Test public void testCountOfCellsAfterFlatteningByScan() throws IOException {
  String[] keys1={"A","B","C"};
  addRowsByKeysWith50Cols(memstore,keys1);
  ((CompactingMemStore)memstore).flushInMemory();
  while (((CompactingMemStore)memstore).isMemStoreFlushingInMemory()) {
    Threads.sleep(10);
  }
  List<KeyValueScanner> scanners=memstore.getScanners(Long.MAX_VALUE);
  int count=0;
  for (int i=0; i < scanners.size(); i++) {
    scanners.get(i).seek(KeyValue.LOWESTKEY);
    while (scanners.get(i).next() != null) {
      count++;
    }
  }
  assertEquals("the count should be ",150,count);
  for (int i=0; i < scanners.size(); i++) {
    scanners.get(i).close();
  }
}
