@Test public void testNonSuccessiveSplitsAreNotMerged() throws IOException {
  JobContext context=mock(JobContext.class);
  Configuration conf=HBaseConfiguration.create();
  conf.set(ClusterConnection.HBASE_CLIENT_CONNECTION_IMPL,ConnectionForMergeTesting.class.getName());
  conf.set(TableInputFormat.INPUT_TABLE,"testTable");
  conf.setBoolean(TableInputFormatBase.MAPREDUCE_INPUT_AUTOBALANCE,true);
  when(context.getConfiguration()).thenReturn(conf);
  TableInputFormat tifExclude=new TableInputFormatForMergeTesting();
  tifExclude.setConf(conf);
  assertEquals(ConnectionForMergeTesting.START_KEYS.length - 1 - 1,tifExclude.getSplits(context).size());
}
