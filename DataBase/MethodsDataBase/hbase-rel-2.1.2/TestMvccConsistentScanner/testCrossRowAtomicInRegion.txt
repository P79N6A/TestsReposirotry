@Test public void testCrossRowAtomicInRegion() throws IOException, InterruptedException {
  put(Bytes.toBytes("row1"),CQ1,Bytes.toBytes(1));
  put(Bytes.toBytes("row2"),CQ1,Bytes.toBytes(2));
  try (Table table=CONN.getTable(tableName);ResultScanner scanner=table.getScanner(new Scan().setCaching(1))){
    Result result=scanner.next();
    assertArrayEquals(Bytes.toBytes("row1"),result.getRow());
    assertEquals(1,Bytes.toInt(result.getValue(CF,CQ1)));
    move();
    put(Bytes.toBytes("row3"),CQ1,Bytes.toBytes(3));
    result=scanner.next();
    assertArrayEquals(Bytes.toBytes("row2"),result.getRow());
    assertEquals(2,Bytes.toInt(result.getValue(CF,CQ1)));
    assertNull(scanner.next());
  }
 }
