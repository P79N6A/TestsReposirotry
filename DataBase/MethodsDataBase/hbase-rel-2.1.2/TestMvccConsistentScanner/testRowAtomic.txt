@Test public void testRowAtomic() throws IOException, InterruptedException {
  byte[] row=Bytes.toBytes("row");
  put(row,CQ1,Bytes.toBytes(1));
  put(row,CQ2,Bytes.toBytes(2));
  try (Table table=CONN.getTable(tableName);ResultScanner scanner=table.getScanner(new Scan().setBatch(1).setCaching(1))){
    Result result=scanner.next();
    assertEquals(1,result.rawCells().length);
    assertEquals(1,Bytes.toInt(result.getValue(CF,CQ1)));
    move();
    put(row,CQ3,Bytes.toBytes(3));
    result=scanner.next();
    assertEquals(1,result.rawCells().length);
    assertEquals(2,Bytes.toInt(result.getValue(CF,CQ2)));
    assertNull(scanner.next());
  }
 }
