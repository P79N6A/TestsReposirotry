@Test public void test() throws Exception {
  List<RegionInfo> regionInfos=admin.getRegions(TABLE_NAME);
  MergeTableRegionsProcedure mergeTableRegionsProcedure=new MergeTableRegionsProcedure(UTIL.getMiniHBaseCluster().getMaster().getMasterProcedureExecutor().getEnvironment(),regionInfos.get(0),regionInfos.get(1));
  long procID=UTIL.getMiniHBaseCluster().getMaster().getMasterProcedureExecutor().submitProcedure(mergeTableRegionsProcedure);
  mergeCommitArrive.await();
  UTIL.getMiniHBaseCluster().stopMaster(0);
  UTIL.getMiniHBaseCluster().startMaster();
  UTIL.waitFor(30000,() -> UTIL.getMiniHBaseCluster().getMaster() != null && UTIL.getMiniHBaseCluster().getMaster().isInitialized());
  UTIL.waitFor(30000,() -> UTIL.getMiniHBaseCluster().getMaster().getMasterProcedureExecutor().isFinished(procID));
  Assert.assertTrue("Found region RIT, that's impossible!",UTIL.getMiniHBaseCluster().getMaster().getAssignmentManager().getRegionsInTransition().size() == 0);
}
