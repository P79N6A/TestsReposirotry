@Test public void testDifferentCounts() throws Exception {
  int[] NB_ROWS={1500,60000};
  int[] NB_KVS={1,100};
  Boolean[] BOOL_VALS={false,true};
  for (  int nbRows : NB_ROWS) {
    for (    int walEditKVs : NB_KVS) {
      for (      boolean isCompressionEnabled : BOOL_VALS) {
        TEST_UTIL.getConfiguration().setBoolean(HConstants.ENABLE_WAL_COMPRESSION,isCompressionEnabled);
        mvcc.advanceTo(1);
        for (int i=0; i < nbRows; i++) {
          appendToLogAndSync(walEditKVs);
        }
        log.rollWriter();
        try (WALEntryStream entryStream=new WALEntryStream(walQueue,fs,CONF,0,log,null,new MetricsSource("1"))){
          int i=0;
          while (entryStream.hasNext()) {
            assertNotNull(entryStream.next());
            i++;
          }
          assertEquals(nbRows,i);
          assertFalse(entryStream.hasNext());
        }
         log.close();
        setUp();
      }
    }
  }
}
