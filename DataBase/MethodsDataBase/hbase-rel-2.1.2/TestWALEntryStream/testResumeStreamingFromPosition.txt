@Test public void testResumeStreamingFromPosition() throws Exception {
  long lastPosition=0;
  appendToLog("1");
  try (WALEntryStream entryStream=new WALEntryStream(walQueue,fs,CONF,0,log,null,new MetricsSource("1"))){
    entryStream.next();
    appendToLog("2");
    appendToLog("3");
    lastPosition=entryStream.getPosition();
  }
   try (WALEntryStream entryStream=new WALEntryStream(walQueue,fs,CONF,lastPosition,log,null,new MetricsSource("1"))){
    assertEquals("2",getRow(entryStream.next()));
    assertEquals("3",getRow(entryStream.next()));
    assertFalse(entryStream.hasNext());
    assertEquals(1,walQueue.size());
  }
 }
