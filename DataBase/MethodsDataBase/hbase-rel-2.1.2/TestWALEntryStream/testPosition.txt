/** 
 * Tests that if we stop before hitting the end of a stream, we can continue where we left off using the last position
 */
@Test public void testPosition() throws Exception {
  long lastPosition=0;
  appendEntriesToLogAndSync(3);
  try (WALEntryStream entryStream=new WALEntryStream(walQueue,fs,CONF,lastPosition,log,null,new MetricsSource("1"))){
    entryStream.next();
    lastPosition=entryStream.getPosition();
  }
   try (WALEntryStream entryStream=new WALEntryStream(walQueue,fs,CONF,lastPosition,log,null,new MetricsSource("1"))){
    assertNotNull(entryStream.next());
    assertNotNull(entryStream.next());
    assertFalse(entryStream.hasNext());
  }
 }
