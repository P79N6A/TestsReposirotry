/** 
 * Test the case that there is a filter which filters most of rows
 */
@Test public void testHeartbeatWithSparseRowFilter() throws Exception {
  testImportanceOfHeartbeats(new Callable<Void>(){
    @Override public Void call() throws Exception {
      Scan scan=new Scan();
      scan.setMaxResultSize(Long.MAX_VALUE);
      scan.setCaching(Integer.MAX_VALUE);
      scan.setFilter(new SparseRowFilter());
      ResultScanner scanner=TABLE.getScanner(scan);
      int num=0;
      while (scanner.next() != null) {
        num++;
      }
      assertEquals(1,num);
      scanner.close();
      return null;
    }
  }
);
}
