@Test public void testRequestCount() throws Exception {
  doNPuts(1,false);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  long requests=metricsHelper.getCounter("totalRequestCount",serverSource);
  long rowActionRequests=metricsHelper.getCounter("totalRowActionRequestCount",serverSource);
  long readRequests=metricsHelper.getCounter("readRequestCount",serverSource);
  long writeRequests=metricsHelper.getCounter("writeRequestCount",serverSource);
  doNPuts(30,false);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  assertCounter("totalRequestCount",requests + 30);
  assertCounter("totalRowActionRequestCount",rowActionRequests + 30);
  assertCounter("readRequestCount",readRequests);
  assertCounter("writeRequestCount",writeRequests + 30);
  doNGets(10,false);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  assertCounter("totalRequestCount",requests + 40);
  assertCounter("totalRowActionRequestCount",rowActionRequests + 40);
  assertCounter("readRequestCount",readRequests + 10);
  assertCounter("writeRequestCount",writeRequests + 30);
  assertRegionMetrics("getCount",10);
  assertRegionMetrics("putCount",31);
  doNGets(10,true);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  if (TABLES_ON_MASTER) {
    assertCounter("totalRequestCount",requests + 41);
    assertCounter("totalRowActionRequestCount",rowActionRequests + 50);
    assertCounter("readRequestCount",readRequests + 20);
  }
  assertCounter("writeRequestCount",writeRequests + 30);
  doNPuts(30,true);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  if (TABLES_ON_MASTER) {
    assertCounter("totalRequestCount",requests + 42);
    assertCounter("totalRowActionRequestCount",rowActionRequests + 80);
    assertCounter("readRequestCount",readRequests + 20);
  }
  assertCounter("writeRequestCount",writeRequests + 60);
  doScan(10,false);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  if (TABLES_ON_MASTER) {
    assertCounter("totalRequestCount",requests + 52);
    assertCounter("totalRowActionRequestCount",rowActionRequests + 90);
    assertCounter("readRequestCount",readRequests + 30);
  }
  assertCounter("writeRequestCount",writeRequests + 60);
  numScanNext+=10;
  doScan(10,true);
  metricsRegionServer.getRegionServerWrapper().forceRecompute();
  if (TABLES_ON_MASTER) {
    assertCounter("totalRequestCount",requests + 53);
    assertCounter("totalRowActionRequestCount",rowActionRequests + 100);
    assertCounter("readRequestCount",readRequests + 40);
  }
  assertCounter("writeRequestCount",writeRequests + 60);
  numScanNext+=1;
}
