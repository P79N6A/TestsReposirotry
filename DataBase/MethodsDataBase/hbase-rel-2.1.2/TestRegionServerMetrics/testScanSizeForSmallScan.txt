@Test public void testScanSizeForSmallScan() throws Exception {
  doNPuts(100,true);
  Scan s=new Scan();
  s.setSmall(true);
  s.setCaching(1);
  ResultScanner resultScanners=table.getScanner(s);
  for (int nextCount=0; nextCount < NUM_SCAN_NEXT; nextCount++) {
    Result result=resultScanners.next();
    assertNotNull(result);
    if (TABLES_ON_MASTER) {
      assertEquals(1,result.size());
    }
  }
  numScanNext+=NUM_SCAN_NEXT;
  assertRegionMetrics("scanCount",NUM_SCAN_NEXT);
  if (TABLES_ON_MASTER) {
    assertCounter("ScanSize_num_ops",numScanNext);
  }
}
