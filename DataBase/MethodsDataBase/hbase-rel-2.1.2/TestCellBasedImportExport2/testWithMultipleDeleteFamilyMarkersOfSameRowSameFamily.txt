@Test public void testWithMultipleDeleteFamilyMarkersOfSameRowSameFamily() throws Throwable {
  final TableName exportTable=TableName.valueOf(name.getMethodName());
  TableDescriptor desc=TableDescriptorBuilder.newBuilder(TableName.valueOf(name.getMethodName())).setColumnFamily(ColumnFamilyDescriptorBuilder.newBuilder(FAMILYA).setMaxVersions(5).setKeepDeletedCells(KeepDeletedCells.TRUE).build()).build();
  UTIL.getAdmin().createTable(desc);
  Table exportT=UTIL.getConnection().getTable(exportTable);
  Put p=new Put(ROW1);
  p.addColumn(FAMILYA,QUAL,now,QUAL);
  exportT.put(p);
  Delete d=new Delete(ROW1,now + 3);
  exportT.delete(d);
  p=new Put(ROW1);
  p.addColumn(FAMILYA,QUAL,now + 5,"s".getBytes());
  exportT.put(p);
  d=new Delete(ROW1,now + 7);
  exportT.delete(d);
  String[] args=new String[]{"-D" + ExportUtils.RAW_SCAN + "=true",exportTable.getNameAsString(),FQ_OUTPUT_DIR,"1000"};
  assertTrue(runExport(args));
  final String importTable=name.getMethodName() + "import";
  desc=TableDescriptorBuilder.newBuilder(TableName.valueOf(importTable)).setColumnFamily(ColumnFamilyDescriptorBuilder.newBuilder(FAMILYA).setMaxVersions(5).setKeepDeletedCells(KeepDeletedCells.TRUE).build()).build();
  UTIL.getAdmin().createTable(desc);
  Table importT=UTIL.getConnection().getTable(TableName.valueOf(importTable));
  args=new String[]{importTable,FQ_OUTPUT_DIR};
  assertTrue(runImport(args));
  Scan s=new Scan();
  s.setMaxVersions();
  s.setRaw(true);
  ResultScanner importedTScanner=importT.getScanner(s);
  Result importedTResult=importedTScanner.next();
  ResultScanner exportedTScanner=exportT.getScanner(s);
  Result exportedTResult=exportedTScanner.next();
  try {
    Result.compareResults(exportedTResult,importedTResult);
  }
 catch (  Throwable e) {
    fail("Original and imported tables data comparision failed with error:" + e.getMessage());
  }
 finally {
    exportT.close();
    importT.close();
  }
}
