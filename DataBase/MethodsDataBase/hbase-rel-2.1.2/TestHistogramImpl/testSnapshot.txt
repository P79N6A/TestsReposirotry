@Test public void testSnapshot(){
  HistogramImpl histogram=new HistogramImpl();
  IntStream.range(0,100).forEach(histogram::update);
  Snapshot snapshot=histogram.snapshot();
  assertEquals(100,snapshot.getCount());
  assertEquals(50,snapshot.getMedian());
  assertEquals(49,snapshot.getMean());
  assertEquals(0,snapshot.getMin());
  assertEquals(99,snapshot.getMax());
  assertEquals(25,snapshot.get25thPercentile());
  assertEquals(75,snapshot.get75thPercentile());
  assertEquals(90,snapshot.get90thPercentile());
  assertEquals(95,snapshot.get95thPercentile());
  assertEquals(98,snapshot.get98thPercentile());
  assertEquals(99,snapshot.get99thPercentile());
  assertEquals(99,snapshot.get999thPercentile());
  assertEquals(51,snapshot.getCountAtOrBelow(50));
  assertEquals(100,histogram.getCount());
  IntStream.range(100,200).forEach(histogram::update);
  assertEquals(200,histogram.getCount());
  snapshot=histogram.snapshot();
  assertEquals(100,snapshot.getCount());
  assertEquals(150,snapshot.getMedian());
  assertEquals(149,snapshot.getMean());
  assertEquals(100,snapshot.getMin());
  assertEquals(199,snapshot.getMax());
  assertEquals(125,snapshot.get25thPercentile());
  assertEquals(175,snapshot.get75thPercentile());
  assertEquals(190,snapshot.get90thPercentile());
  assertEquals(195,snapshot.get95thPercentile());
  assertEquals(198,snapshot.get98thPercentile());
  assertEquals(199,snapshot.get99thPercentile());
  assertEquals(199,snapshot.get999thPercentile());
}
