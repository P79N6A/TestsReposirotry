@Test public void testPutMaskedAndUserMaxVersion() throws IOException {
  try (Table t=createTable()){
    t.put(new Put(ROW).addColumn(FAMILY,col1,1000001,value));
    t.put(new Put(ROW).addColumn(FAMILY,col1,1000002,value));
    t.put(new Put(ROW).addColumn(FAMILY,col1,1000003,value));
    t.put(new Put(ROW).addColumn(FAMILY,col1,1000004,value));
    t.delete(new Delete(ROW).addColumn(FAMILY,col1,1000004));
    t.delete(new Delete(ROW).addColumn(FAMILY,col1,1000003));
    Result r=t.get(new Get(ROW).setMaxVersions(1));
    assertEquals(1,r.size());
    assertEquals(1000002,r.rawCells()[0].getTimestamp());
    TEST_UTIL.getAdmin().flush(t.getName());
    r=t.get(new Get(ROW).setMaxVersions(1));
    assertEquals(1,r.size());
    assertEquals(1000002,r.rawCells()[0].getTimestamp());
  }
 }
