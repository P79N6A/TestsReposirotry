@Test public void testAlternateBufferedMutatorImpl() throws IOException {
  BufferedMutatorParams params=new BufferedMutatorParams(TableName.valueOf(name.getMethodName()));
  Configuration conf=HBaseConfiguration.create();
  conf.set(AsyncRegistryFactory.REGISTRY_IMPL_CONF_KEY,DoNothingAsyncRegistry.class.getName());
  try (Connection connection=ConnectionFactory.createConnection(conf)){
    BufferedMutator bm=connection.getBufferedMutator(params);
    assertTrue(bm instanceof BufferedMutatorImpl);
    params.implementationClassName(MyBufferedMutator.class.getName());
    bm=connection.getBufferedMutator(params);
    assertTrue(bm instanceof MyBufferedMutator);
  }
   conf.set(BufferedMutator.CLASSNAME_KEY,MyBufferedMutator.class.getName());
  try (Connection connection=ConnectionFactory.createConnection(conf)){
    BufferedMutator bm=connection.getBufferedMutator(params);
    assertTrue(bm instanceof MyBufferedMutator);
  }
 }
