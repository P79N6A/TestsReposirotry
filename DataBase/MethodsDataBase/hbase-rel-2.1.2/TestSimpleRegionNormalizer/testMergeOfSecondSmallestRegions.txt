@Test public void testMergeOfSecondSmallestRegions() throws HBaseIOException {
  final TableName tableName=TableName.valueOf(name.getMethodName());
  List<RegionInfo> RegionInfo=new ArrayList<>();
  Map<byte[],Integer> regionSizes=new HashMap<>();
  RegionInfo hri1=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("aaa")).setEndKey(Bytes.toBytes("bbb")).build();
  RegionInfo.add(hri1);
  regionSizes.put(hri1.getRegionName(),1);
  RegionInfo hri2=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("bbb")).setEndKey(Bytes.toBytes("ccc")).build();
  RegionInfo.add(hri2);
  regionSizes.put(hri2.getRegionName(),10000);
  RegionInfo hri3=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("ccc")).setEndKey(Bytes.toBytes("ddd")).build();
  RegionInfo.add(hri3);
  regionSizes.put(hri3.getRegionName(),10000);
  RegionInfo hri4=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("ddd")).setEndKey(Bytes.toBytes("eee")).build();
  RegionInfo.add(hri4);
  regionSizes.put(hri4.getRegionName(),10000);
  RegionInfo hri5=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("eee")).setEndKey(Bytes.toBytes("fff")).build();
  RegionInfo.add(hri5);
  regionSizes.put(hri5.getRegionName(),2700);
  RegionInfo hri6=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("fff")).setEndKey(Bytes.toBytes("ggg")).build();
  RegionInfo.add(hri6);
  regionSizes.put(hri6.getRegionName(),2700);
  setupMocksForNormalizer(regionSizes,RegionInfo);
  List<NormalizationPlan> plans=normalizer.computePlanForTable(tableName);
  NormalizationPlan plan=plans.get(0);
  assertTrue(plan instanceof MergeNormalizationPlan);
  assertEquals(hri5,((MergeNormalizationPlan)plan).getFirstRegion());
  assertEquals(hri6,((MergeNormalizationPlan)plan).getSecondRegion());
}
