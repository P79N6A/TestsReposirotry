@Test public void testSplitWithTargetRegionSize() throws Exception {
  final TableName tableName=TableName.valueOf(name.getMethodName());
  List<RegionInfo> RegionInfo=new ArrayList<>();
  Map<byte[],Integer> regionSizes=new HashMap<>();
  RegionInfo hri1=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("aaa")).setEndKey(Bytes.toBytes("bbb")).build();
  RegionInfo.add(hri1);
  regionSizes.put(hri1.getRegionName(),20);
  RegionInfo hri2=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("bbb")).setEndKey(Bytes.toBytes("ccc")).build();
  RegionInfo.add(hri2);
  regionSizes.put(hri2.getRegionName(),40);
  RegionInfo hri3=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("ccc")).setEndKey(Bytes.toBytes("ddd")).build();
  RegionInfo.add(hri3);
  regionSizes.put(hri3.getRegionName(),60);
  RegionInfo hri4=RegionInfoBuilder.newBuilder(tableName).setStartKey(Bytes.toBytes("ddd")).setEndKey(Bytes.toBytes("eee")).build();
  RegionInfo.add(hri4);
  regionSizes.put(hri4.getRegionName(),80);
  setupMocksForNormalizer(regionSizes,RegionInfo);
  when(masterServices.getTableDescriptors().get(any()).getNormalizerTargetRegionCount()).thenReturn(8);
  List<NormalizationPlan> plans=normalizer.computePlanForTable(tableName);
  Assert.assertEquals(2,plans.size());
  for (  NormalizationPlan plan : plans) {
    assertTrue(plan instanceof SplitNormalizationPlan);
  }
  when(masterServices.getTableDescriptors().get(any()).getNormalizerTargetRegionCount()).thenReturn(3);
  plans=normalizer.computePlanForTable(tableName);
  Assert.assertEquals(1,plans.size());
  NormalizationPlan plan=plans.get(0);
  assertTrue(plan instanceof MergeNormalizationPlan);
  assertEquals(hri1,((MergeNormalizationPlan)plan).getFirstRegion());
  assertEquals(hri2,((MergeNormalizationPlan)plan).getSecondRegion());
}
