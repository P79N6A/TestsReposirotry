/** 
 * If there is a corrupted data manifest, it should throw out CorruptedSnapshotException, instead of an IOException
 */
@Test public void testCorruptedDataManifest() throws IOException {
  SnapshotTestingUtils.SnapshotMock snapshotMock=new SnapshotTestingUtils.SnapshotMock(TEST_UTIL.getConfiguration(),fs,rootDir);
  SnapshotTestingUtils.SnapshotMock.SnapshotBuilder builder=snapshotMock.createSnapshotV2(SNAPSHOT_NAME_STR,TABLE_NAME_STR);
  builder.addRegionV2();
  builder.consolidate();
  builder.corruptDataManifest();
  fs.delete(SnapshotDescriptionUtils.getWorkingSnapshotDir(rootDir),true);
}
