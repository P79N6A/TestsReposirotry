@Test public void testHeartbeatWithSparseFilter() throws Exception {
  try (ResultScanner scanner=getScanner(createScanWithSparseFilter())){
    int num=0;
    Result r;
    while ((r=scanner.next()) != null) {
      if (num < (NUM_ROWS - 1) * NUM_FAMILIES * NUM_QUALIFIERS) {
        assertTrue(r.isCursor());
        assertArrayEquals(ROWS[num / NUM_FAMILIES / NUM_QUALIFIERS],r.getCursor().getRow());
      }
 else {
        assertFalse(r.isCursor());
        assertArrayEquals(ROWS[num / NUM_FAMILIES / NUM_QUALIFIERS],r.getRow());
      }
      num++;
    }
  }
 }
