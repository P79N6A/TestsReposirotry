@Test public void testSizeLimit() throws IOException {
  try (ResultScanner scanner=TEST_UTIL.getConnection().getTable(TABLE_NAME).getScanner(createScanWithSizeLimit())){
    int num=0;
    Result r;
    while ((r=scanner.next()) != null) {
      if (num % (NUM_FAMILIES * NUM_QUALIFIERS) != (NUM_FAMILIES * NUM_QUALIFIERS) - 1) {
        assertTrue(r.isCursor());
        assertArrayEquals(ROWS[num / NUM_FAMILIES / NUM_QUALIFIERS],r.getCursor().getRow());
      }
 else {
        assertFalse(r.isCursor());
        assertArrayEquals(ROWS[num / NUM_FAMILIES / NUM_QUALIFIERS],r.getRow());
      }
      num++;
    }
  }
 }
