@Test public void testToViolation() throws Exception {
  final TableName tn=TableName.valueOf("inviolation");
  final SpaceQuotaSnapshot snapshot=new SpaceQuotaSnapshot(new SpaceQuotaStatus(SpaceViolationPolicy.NO_INSERTS),1024L,512L);
  final Table quotaTable=mock(Table.class);
  when(conn.getTable(QuotaTableUtil.QUOTA_TABLE_NAME)).thenReturn(quotaTable);
  final Put expectedPut=new Put(Bytes.toBytes("t." + tn.getNameAsString()));
  final QuotaProtos.SpaceQuotaSnapshot protoQuota=QuotaProtos.SpaceQuotaSnapshot.newBuilder().setQuotaStatus(QuotaProtos.SpaceQuotaStatus.newBuilder().setInViolation(true).setViolationPolicy(QuotaProtos.SpaceViolationPolicy.NO_INSERTS)).setQuotaLimit(512L).setQuotaUsage(1024L).build();
  expectedPut.addColumn(Bytes.toBytes("u"),Bytes.toBytes("p"),protoQuota.toByteArray());
  notifier.transitionTable(tn,snapshot);
  verify(quotaTable).put(argThat(new SingleCellMutationMatcher<Put>(expectedPut)));
}
