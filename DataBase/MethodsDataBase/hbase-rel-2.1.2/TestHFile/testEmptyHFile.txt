/** 
 * Test empty HFile. Test all features work reasonably when hfile is empty of entries.
 * @throws IOException
 */
@Test public void testEmptyHFile() throws IOException {
  if (cacheConf == null)   cacheConf=new CacheConfig(conf);
  Path f=new Path(ROOT_DIR,testName.getMethodName());
  HFileContext context=new HFileContextBuilder().withIncludesTags(false).build();
  Writer w=HFile.getWriterFactory(conf,cacheConf).withPath(fs,f).withFileContext(context).create();
  w.close();
  Reader r=HFile.createReader(fs,f,cacheConf,true,conf);
  r.loadFileInfo();
  assertFalse(r.getFirstKey().isPresent());
  assertFalse(r.getLastKey().isPresent());
}
