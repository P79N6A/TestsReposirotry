@Test public void testLargeSmallIsolation() throws Exception {
  Configuration conf=UTIL.getConfiguration();
  conf.setStrings(HFileCleaner.MASTER_HFILE_CLEANER_PLUGINS,"");
  conf.setInt(HFileCleaner.HFILE_DELETE_THROTTLE_THRESHOLD,512 * 1024);
  Server server=new DummyServer();
  Path archivedHfileDir=new Path(UTIL.getDataTestDirOnTestFS(),HConstants.HFILE_ARCHIVE_DIRECTORY);
  FileSystem fs=UTIL.getDFSCluster().getFileSystem();
  HFileCleaner cleaner=new HFileCleaner(1000,server,conf,fs,archivedHfileDir);
  fs.delete(archivedHfileDir,true);
  fs.mkdirs(archivedHfileDir);
  final int LARGE_FILE_NUM=5;
  final int SMALL_FILE_NUM=20;
  createFilesForTesting(LARGE_FILE_NUM,SMALL_FILE_NUM,fs,archivedHfileDir);
  cleaner.chore();
  Assert.assertEquals(LARGE_FILE_NUM,cleaner.getNumOfDeletedLargeFiles());
  Assert.assertEquals(SMALL_FILE_NUM,cleaner.getNumOfDeletedSmallFiles());
}
