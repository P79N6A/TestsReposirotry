/** 
 * Test loading into a column family that does not exist.
 */
@Test public void testNonexistentColumnFamilyLoad() throws Exception {
  String testName=tn.getMethodName();
  byte[][][] hFileRanges=new byte[][][]{new byte[][]{Bytes.toBytes("aaa"),Bytes.toBytes("ccc")},new byte[][]{Bytes.toBytes("ddd"),Bytes.toBytes("ooo")}};
  byte[] TABLE=Bytes.toBytes("mytable_" + testName);
  TableDescriptor htd=TableDescriptorBuilder.newBuilder(TableName.valueOf(TABLE)).setColumnFamily(ColumnFamilyDescriptorBuilder.of(Bytes.toBytes(new String(FAMILY).toUpperCase(Locale.ROOT)))).build();
  try {
    runTest(testName,htd,true,SPLIT_KEYS,hFileRanges,false,false,2);
    assertTrue("Loading into table with non-existent family should have failed",false);
  }
 catch (  Exception e) {
    assertTrue("IOException expected",e instanceof IOException);
    String errMsg=e.getMessage();
    assertTrue("Incorrect exception message, expected message: [" + EXPECTED_MSG_FOR_NON_EXISTING_FAMILY + "], current message: ["+ errMsg+ "]",errMsg.contains(EXPECTED_MSG_FOR_NON_EXISTING_FAMILY));
  }
}
