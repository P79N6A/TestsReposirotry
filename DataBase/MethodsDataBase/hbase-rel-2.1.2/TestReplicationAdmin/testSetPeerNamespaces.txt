@Test public void testSetPeerNamespaces() throws Exception {
  String ns1="ns1";
  String ns2="ns2";
  ReplicationPeerConfig rpc=new ReplicationPeerConfig();
  rpc.setClusterKey(KEY_ONE);
  hbaseAdmin.addReplicationPeer(ID_ONE,rpc);
  rpc=hbaseAdmin.getReplicationPeerConfig(ID_ONE);
  rpc.setReplicateAllUserTables(false);
  hbaseAdmin.updateReplicationPeerConfig(ID_ONE,rpc);
  rpc=hbaseAdmin.getReplicationPeerConfig(ID_ONE);
  Set<String> namespaces=new HashSet<>();
  namespaces.add(ns1);
  namespaces.add(ns2);
  rpc.setNamespaces(namespaces);
  hbaseAdmin.updateReplicationPeerConfig(ID_ONE,rpc);
  namespaces=hbaseAdmin.getReplicationPeerConfig(ID_ONE).getNamespaces();
  assertEquals(2,namespaces.size());
  assertTrue(namespaces.contains(ns1));
  assertTrue(namespaces.contains(ns2));
  rpc=hbaseAdmin.getReplicationPeerConfig(ID_ONE);
  namespaces=new HashSet<>();
  namespaces.add(ns1);
  rpc.setNamespaces(namespaces);
  hbaseAdmin.updateReplicationPeerConfig(ID_ONE,rpc);
  namespaces=hbaseAdmin.getReplicationPeerConfig(ID_ONE).getNamespaces();
  assertEquals(1,namespaces.size());
  assertTrue(namespaces.contains(ns1));
  hbaseAdmin.removeReplicationPeer(ID_ONE);
}
