/** 
 * Simple testing of adding and removing peers, basically shows that all interactions with ZK work
 * @throws Exception
 */
@Test public void testAddRemovePeer() throws Exception {
  ReplicationPeerConfigBuilder rpc1=ReplicationPeerConfig.newBuilder();
  rpc1.setClusterKey(KEY_ONE);
  ReplicationPeerConfigBuilder rpc2=ReplicationPeerConfig.newBuilder();
  rpc2.setClusterKey(KEY_SECOND);
  hbaseAdmin.addReplicationPeer(ID_ONE,rpc1.build());
  try {
    hbaseAdmin.addReplicationPeer(ID_ONE,rpc1.build());
  }
 catch (  Exception e) {
  }
  assertEquals(1,hbaseAdmin.listReplicationPeers().size());
  try {
    hbaseAdmin.removeReplicationPeer(ID_SECOND);
    fail();
  }
 catch (  Exception e) {
  }
  assertEquals(1,hbaseAdmin.listReplicationPeers().size());
  try {
    hbaseAdmin.addReplicationPeer(ID_SECOND,rpc2.build());
  }
 catch (  Exception e) {
    fail();
  }
  assertEquals(2,hbaseAdmin.listReplicationPeers().size());
  hbaseAdmin.removeReplicationPeer(ID_ONE);
  assertEquals(1,hbaseAdmin.listReplicationPeers().size());
  hbaseAdmin.removeReplicationPeer(ID_SECOND);
  assertEquals(0,hbaseAdmin.listReplicationPeers().size());
}
