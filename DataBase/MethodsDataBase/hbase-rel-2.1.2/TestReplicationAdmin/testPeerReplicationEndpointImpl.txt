@Test public void testPeerReplicationEndpointImpl() throws Exception {
  ReplicationPeerConfigBuilder builder=ReplicationPeerConfig.newBuilder();
  builder.setClusterKey(KEY_ONE);
  builder.setReplicationEndpointImpl(ReplicationEndpointForTest.class.getName());
  hbaseAdmin.addReplicationPeer(ID_ONE,builder.build());
  try {
    builder.setReplicationEndpointImpl(InterClusterReplicationEndpointForTest.class.getName());
    hbaseAdmin.updateReplicationPeerConfig(ID_ONE,builder.build());
    fail("Change replication endpoint implementation class on an existing peer is not allowed");
  }
 catch (  Exception e) {
  }
  try {
    builder=ReplicationPeerConfig.newBuilder();
    builder.setClusterKey(KEY_ONE);
    hbaseAdmin.updateReplicationPeerConfig(ID_ONE,builder.build());
    fail("Change replication endpoint implementation class on an existing peer is not allowed");
  }
 catch (  Exception e) {
  }
  builder=ReplicationPeerConfig.newBuilder();
  builder.setClusterKey(KEY_SECOND);
  hbaseAdmin.addReplicationPeer(ID_SECOND,builder.build());
  try {
    builder.setReplicationEndpointImpl(ReplicationEndpointForTest.class.getName());
    hbaseAdmin.updateReplicationPeerConfig(ID_SECOND,builder.build());
    fail("Change replication endpoint implementation class on an existing peer is not allowed");
  }
 catch (  Exception e) {
  }
}
