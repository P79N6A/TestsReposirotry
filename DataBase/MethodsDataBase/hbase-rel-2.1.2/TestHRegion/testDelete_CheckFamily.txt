@Test public void testDelete_CheckFamily() throws IOException {
  byte[] row1=Bytes.toBytes("row1");
  byte[] fam1=Bytes.toBytes("fam1");
  byte[] fam2=Bytes.toBytes("fam2");
  byte[] fam3=Bytes.toBytes("fam3");
  byte[] fam4=Bytes.toBytes("fam4");
  this.region=initHRegion(tableName,method,CONF,fam1,fam2,fam3);
  try {
    List<Cell> kvs=new ArrayList<>();
    kvs.add(new KeyValue(row1,fam4,null,null));
    byte[] family=fam2;
    try {
      NavigableMap<byte[],List<Cell>> deleteMap=new TreeMap<>(Bytes.BYTES_COMPARATOR);
      deleteMap.put(family,kvs);
      region.delete(deleteMap,Durability.SYNC_WAL);
    }
 catch (    Exception e) {
      fail("Family " + new String(family,StandardCharsets.UTF_8) + " does not exist");
    }
    boolean ok=false;
    family=fam4;
    try {
      NavigableMap<byte[],List<Cell>> deleteMap=new TreeMap<>(Bytes.BYTES_COMPARATOR);
      deleteMap.put(family,kvs);
      region.delete(deleteMap,Durability.SYNC_WAL);
    }
 catch (    Exception e) {
      ok=true;
    }
    assertTrue("Family " + new String(family,StandardCharsets.UTF_8) + " does exist",ok);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}
