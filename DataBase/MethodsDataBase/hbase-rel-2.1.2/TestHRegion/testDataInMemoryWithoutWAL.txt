@Test public void testDataInMemoryWithoutWAL() throws IOException {
  FileSystem fs=FileSystem.get(CONF);
  Path rootDir=new Path(dir + "testDataInMemoryWithoutWAL");
  FSHLog hLog=new FSHLog(fs,rootDir,"testDataInMemoryWithoutWAL",CONF);
  ChunkCreator.initialize(MemStoreLABImpl.CHUNK_SIZE_DEFAULT,false,0,0,0,null);
  HRegion region=initHRegion(tableName,null,null,false,Durability.SYNC_WAL,hLog,COLUMN_FAMILY_BYTES);
  Cell originalCell=CellUtil.createCell(row,COLUMN_FAMILY_BYTES,qual1,System.currentTimeMillis(),KeyValue.Type.Put.getCode(),value1);
  final long originalSize=KeyValueUtil.length(originalCell);
  Cell addCell=CellUtil.createCell(row,COLUMN_FAMILY_BYTES,qual1,System.currentTimeMillis(),KeyValue.Type.Put.getCode(),Bytes.toBytes("xxxxxxxxxx"));
  final long addSize=KeyValueUtil.length(addCell);
  LOG.info("originalSize:" + originalSize + ", addSize:"+ addSize);
  testDataInMemoryWithoutWAL(region,new Put(row).add(originalCell).setDurability(Durability.SKIP_WAL),new Put(row).add(addCell).setDurability(Durability.SKIP_WAL),originalSize + addSize);
  testDataInMemoryWithoutWAL(region,new Put(row).add(originalCell).setDurability(Durability.SKIP_WAL),new Put(row).add(addCell).setDurability(Durability.SYNC_WAL),originalSize + addSize);
  testDataInMemoryWithoutWAL(region,new Put(row).add(originalCell).setDurability(Durability.SYNC_WAL),new Put(row).add(addCell).setDurability(Durability.SKIP_WAL),0);
  testDataInMemoryWithoutWAL(region,new Put(row).add(originalCell).setDurability(Durability.SYNC_WAL),new Put(row).add(addCell).setDurability(Durability.SYNC_WAL),0);
}
