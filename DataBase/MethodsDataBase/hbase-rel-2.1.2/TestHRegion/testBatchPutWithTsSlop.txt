@Test public void testBatchPutWithTsSlop() throws Exception {
  CONF.setInt("hbase.hregion.keyvalue.timestamp.slop.millisecs",1000);
  final Put[] puts=new Put[10];
  MetricsWALSource source=CompatibilitySingletonFactory.getInstance(MetricsWALSource.class);
  try {
    long syncs=prepareRegionForBachPut(puts,source,true);
    OperationStatus[] codes=this.region.batchMutate(puts);
    assertEquals(10,codes.length);
    for (int i=0; i < 10; i++) {
      assertEquals(OperationStatusCode.SANITY_CHECK_FAILURE,codes[i].getOperationStatusCode());
    }
    metricsAssertHelper.assertCounter("syncTimeNumOps",syncs,source);
  }
  finally {
    HBaseTestingUtility.closeRegionAndWAL(this.region);
    this.region=null;
  }
}
