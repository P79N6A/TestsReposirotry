@Test public void testIncrementTimestampsAreMonotonic() throws IOException {
  HRegion region=initHRegion(tableName,method,CONF,fam1);
  ManualEnvironmentEdge edge=new ManualEnvironmentEdge();
  EnvironmentEdgeManager.injectEdge(edge);
  edge.setValue(10);
  Increment inc=new Increment(row);
  inc.setDurability(Durability.SKIP_WAL);
  inc.addColumn(fam1,qual1,1L);
  region.increment(inc);
  Result result=region.get(new Get(row));
  Cell c=result.getColumnLatestCell(fam1,qual1);
  assertNotNull(c);
  assertEquals(10L,c.getTimestamp());
  edge.setValue(1);
  region.increment(inc);
  result=region.get(new Get(row));
  c=result.getColumnLatestCell(fam1,qual1);
  assertEquals(11L,c.getTimestamp());
  assertEquals(2L,Bytes.toLong(c.getValueArray(),c.getValueOffset(),c.getValueLength()));
}
