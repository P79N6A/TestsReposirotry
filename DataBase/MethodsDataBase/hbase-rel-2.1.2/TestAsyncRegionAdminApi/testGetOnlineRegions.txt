@Test public void testGetOnlineRegions() throws Exception {
  createTableAndGetOneRegion(tableName);
  AtomicInteger regionServerCount=new AtomicInteger(0);
  TEST_UTIL.getHBaseCluster().getLiveRegionServerThreads().stream().map(rsThread -> rsThread.getRegionServer()).forEach(rs -> {
    ServerName serverName=rs.getServerName();
    try {
      assertEquals(admin.getRegions(serverName).get().size(),rs.getRegions().size());
    }
 catch (    Exception e) {
      fail("admin.getOnlineRegions() method throws a exception: " + e.getMessage());
    }
    regionServerCount.incrementAndGet();
  }
);
  assertEquals(2,regionServerCount.get());
}
