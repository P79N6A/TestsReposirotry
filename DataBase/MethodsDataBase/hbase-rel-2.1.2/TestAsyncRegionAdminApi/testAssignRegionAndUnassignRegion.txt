@Test public void testAssignRegionAndUnassignRegion() throws Exception {
  createTableWithDefaultConf(tableName);
  HMaster master=TEST_UTIL.getHBaseCluster().getMaster();
  AssignmentManager am=master.getAssignmentManager();
  RegionInfo hri=am.getRegionStates().getRegionsOfTable(tableName).get(0);
  RegionStates regionStates=am.getRegionStates();
  ServerName serverName=regionStates.getRegionServerOfRegion(hri);
  TEST_UTIL.assertRegionOnServer(hri,serverName,200);
  assertTrue(regionStates.getRegionState(hri).isOpened());
  admin.assign(hri.getRegionName()).get();
  assertTrue(regionStates.getRegionState(hri).isOpened());
  admin.unassign(hri.getRegionName(),true).get();
  assertTrue(regionStates.getRegionState(hri).isClosed());
}
