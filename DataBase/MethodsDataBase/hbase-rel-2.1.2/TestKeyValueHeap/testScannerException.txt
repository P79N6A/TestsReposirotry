@Test public void testScannerException() throws IOException {
  TestScanner s1=new SeekTestScanner(Arrays.asList(kv115,kv211,kv212));
  TestScanner s2=new SeekTestScanner(Arrays.asList(kv111,kv112));
  TestScanner s3=new SeekTestScanner(Arrays.asList(kv113,kv114,kv121,kv122,kv213));
  TestScanner s4=new SeekTestScanner(new ArrayList<>());
  List<KeyValueScanner> scanners=new ArrayList<>(Arrays.asList(s1,s2,s3,s4));
  KeyValueHeap kvh=new KeyValueHeap(scanners,CellComparatorImpl.COMPARATOR);
  try {
    for (    KeyValueScanner scanner : scanners) {
      ((SeekTestScanner)scanner).setRealSeekDone(false);
    }
    while (kvh.next() != null)     ;
    assertTrue(false);
  }
 catch (  IOException ioe) {
    kvh.close();
  }
  for (  KeyValueScanner scanner : scanners) {
    assertTrue(((SeekTestScanner)scanner).isClosed());
    assertEquals(1,((SeekTestScanner)scanner).getClosedNum());
  }
}
