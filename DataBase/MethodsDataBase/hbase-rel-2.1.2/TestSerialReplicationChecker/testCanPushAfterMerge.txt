@Test public void testCanPushAfterMerge() throws IOException, ReplicationException {
  byte[] endKey=new byte[]{(byte)0xFF,0x00,(byte)0xFF,(byte)0xFF,0x01};
  RegionInfo regionA=RegionInfoBuilder.newBuilder(tableName).setEndKey(endKey).setRegionId(1).build();
  RegionInfo regionB=RegionInfoBuilder.newBuilder(tableName).setStartKey(endKey).setRegionId(2).build();
  RegionInfo region=RegionInfoBuilder.newBuilder(tableName).setRegionId(3).build();
  addStateAndBarrier(regionA,null,10,100);
  addStateAndBarrier(regionB,null,20,200);
  addStateAndBarrier(region,RegionState.State.OPEN,200);
  addParents(region,Arrays.asList(regionA,regionB));
  Cell cell=createCell(region);
  assertFalse(checker.canPush(createEntry(region,300),cell));
  updatePushedSeqId(regionB,199);
  assertFalse(checker.canPush(createEntry(region,300),cell));
  updatePushedSeqId(regionA,99);
  assertTrue(checker.canPush(createEntry(region,300),cell));
}
