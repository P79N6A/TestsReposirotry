/** 
 * Test that a custom  {@link WALCellCodec} will be completely setup when it is instantiated via{@link WALCellCodec}
 * @throws Exception on failure
 */
@Test public void testCreatePreparesCodec() throws Exception {
  Configuration conf=new Configuration(false);
  conf.setClass(WALCellCodec.WAL_CELL_CODEC_CLASS_KEY,CustomWALCellCodec.class,WALCellCodec.class);
  CustomWALCellCodec codec=(CustomWALCellCodec)WALCellCodec.create(conf,null,null);
  assertEquals("Custom codec didn't get initialized with the right configuration!",conf,codec.conf);
  assertEquals("Custom codec didn't get initialized with the right compression context!",null,codec.context);
}
