@Test public void testSetWALPositionBadVersion() throws IOException, ReplicationException {
  ZKReplicationQueueStorage storage=createWithUnstableVersion();
  ServerName serverName1=ServerName.valueOf("128.0.0.1",8000,10000);
  assertTrue(storage.getAllQueues(serverName1).isEmpty());
  String queue1="1";
  String fileName=getFileName("file1",0);
  String encodedRegionName="31d9792f4435b99d9fb1016f6fbc8dc6";
  storage.addWAL(serverName1,queue1,fileName);
  List<String> wals1=storage.getWALsInQueue(serverName1,queue1);
  assertEquals(1,wals1.size());
  assertEquals(0,storage.getWALPosition(serverName1,queue1,fileName));
  storage.setWALPosition(serverName1,queue1,fileName,100,ImmutableMap.of(encodedRegionName,120L));
  assertEquals(100,storage.getWALPosition(serverName1,queue1,fileName));
  assertEquals(120L,storage.getLastSequenceId(encodedRegionName,queue1));
}
