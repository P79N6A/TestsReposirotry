@Test public void testRemoveAllLastPushedSeqIdsForPeer() throws Exception {
  String peerId="1";
  String peerIdToDelete="2";
  for (int i=0; i < 100; i++) {
    String encodedRegionName=MD5Hash.getMD5AsHex(Bytes.toBytes(i));
    STORAGE.setLastSequenceIds(peerId,ImmutableMap.of(encodedRegionName,(long)i));
    STORAGE.setLastSequenceIds(peerIdToDelete,ImmutableMap.of(encodedRegionName,(long)i));
  }
  for (int i=0; i < 100; i++) {
    String encodedRegionName=MD5Hash.getMD5AsHex(Bytes.toBytes(i));
    assertEquals(i,STORAGE.getLastSequenceId(encodedRegionName,peerId));
    assertEquals(i,STORAGE.getLastSequenceId(encodedRegionName,peerIdToDelete));
  }
  STORAGE.removeLastSequenceIds(peerIdToDelete);
  for (int i=0; i < 100; i++) {
    String encodedRegionName=MD5Hash.getMD5AsHex(Bytes.toBytes(i));
    assertEquals(i,STORAGE.getLastSequenceId(encodedRegionName,peerId));
    assertEquals(HConstants.NO_SEQNUM,STORAGE.getLastSequenceId(encodedRegionName,peerIdToDelete));
  }
}
