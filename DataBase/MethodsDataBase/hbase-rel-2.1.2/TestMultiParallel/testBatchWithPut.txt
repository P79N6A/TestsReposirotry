@Test public void testBatchWithPut() throws Exception {
  LOG.info("test=testBatchWithPut");
  Table table=CONNECTION.getTable(TEST_TABLE);
  List<Put> puts=constructPutRequests();
  Object[] results=new Object[puts.size()];
  table.batch(puts,results);
  validateSizeAndEmpty(results,KEYS.length);
  if (true) {
    int liveRScount=UTIL.getMiniHBaseCluster().getLiveRegionServerThreads().size();
    assert liveRScount > 0;
    JVMClusterUtil.RegionServerThread liveRS=UTIL.getMiniHBaseCluster().getLiveRegionServerThreads().get(0);
    liveRS.getRegionServer().abort("Aborting for tests",new Exception("testBatchWithPut"));
    puts=constructPutRequests();
    try {
      results=new Object[puts.size()];
      table.batch(puts,results);
    }
 catch (    RetriesExhaustedWithDetailsException ree) {
      LOG.info(ree.getExhaustiveDescription());
      table.close();
      throw ree;
    }
    validateSizeAndEmpty(results,KEYS.length);
  }
  validateLoadedData(table);
  table.close();
}
