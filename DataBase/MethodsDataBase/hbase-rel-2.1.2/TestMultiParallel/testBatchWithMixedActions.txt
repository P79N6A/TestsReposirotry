@Test public void testBatchWithMixedActions() throws Exception {
  LOG.info("test=testBatchWithMixedActions");
  Table table=UTIL.getConnection().getTable(TEST_TABLE);
  List<Put> puts=constructPutRequests();
  Object[] results=new Object[puts.size()];
  table.batch(puts,results);
  validateSizeAndEmpty(results,KEYS.length);
  List<Row> actions=new ArrayList<>();
  byte[] qual2=Bytes.toBytes("qual2");
  byte[] val2=Bytes.toBytes("putvalue2");
  Get get=new Get(KEYS[10]);
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  get=new Get(KEYS[11]);
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  Put put=new Put(KEYS[10]);
  put.addColumn(BYTES_FAMILY,qual2,val2);
  actions.add(put);
  Delete delete=new Delete(KEYS[20]);
  delete.addFamily(BYTES_FAMILY);
  actions.add(delete);
  get=new Get(KEYS[30]);
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  put=new Put(KEYS[40]);
  put.addColumn(BYTES_FAMILY,qual2,val2);
  actions.add(put);
  RowMutations rm=new RowMutations(KEYS[50]);
  put=new Put(KEYS[50]);
  put.addColumn(BYTES_FAMILY,qual2,val2);
  rm.add((Mutation)put);
  byte[] qual3=Bytes.toBytes("qual3");
  byte[] val3=Bytes.toBytes("putvalue3");
  put=new Put(KEYS[50]);
  put.addColumn(BYTES_FAMILY,qual3,val3);
  rm.add((Mutation)put);
  actions.add(rm);
  get=new Get(KEYS[10]);
  get.addColumn(BYTES_FAMILY,QUALIFIER);
  actions.add(get);
  results=new Object[actions.size()];
  table.batch(actions,results);
  validateResult(results[0]);
  validateResult(results[1]);
  validateEmpty(results[3]);
  validateResult(results[4]);
  validateEmpty(results[5]);
  validateEmpty(results[6]);
  validateResult(results[7]);
  get=new Get(KEYS[40]);
  get.addColumn(BYTES_FAMILY,qual2);
  Result r=table.get(get);
  validateResult(r,qual2,val2);
  get=new Get(KEYS[50]);
  get.addColumn(BYTES_FAMILY,qual2);
  r=table.get(get);
  validateResult(r,qual2,val2);
  get=new Get(KEYS[50]);
  get.addColumn(BYTES_FAMILY,qual3);
  r=table.get(get);
  validateResult(r,qual3,val3);
  table.close();
}
