@Test public void testInvalidMerges() throws IOException {
  QuotaGlobalsSettingsBypass userBypass=new QuotaGlobalsSettingsBypass("joe",null,null,true);
  QuotaGlobalsSettingsBypass tableBypass=new QuotaGlobalsSettingsBypass(null,TableName.valueOf("table"),null,true);
  QuotaGlobalsSettingsBypass namespaceBypass=new QuotaGlobalsSettingsBypass(null,null,"ns",true);
  QuotaGlobalsSettingsBypass userOnTableBypass=new QuotaGlobalsSettingsBypass("joe",TableName.valueOf("table"),null,true);
  QuotaGlobalsSettingsBypass userOnNamespaceBypass=new QuotaGlobalsSettingsBypass("joe",null,"ns",true);
  assertTrue(userBypass.merge(userBypass).getBypass());
  expectFailure(userBypass,new QuotaGlobalsSettingsBypass("frank",null,null,false));
  expectFailure(userBypass,tableBypass);
  expectFailure(userBypass,namespaceBypass);
  expectFailure(userBypass,userOnTableBypass);
  expectFailure(userBypass,userOnNamespaceBypass);
  assertTrue(tableBypass.merge(tableBypass).getBypass());
  expectFailure(tableBypass,userBypass);
  expectFailure(tableBypass,new QuotaGlobalsSettingsBypass(null,TableName.valueOf("foo"),null,false));
  expectFailure(tableBypass,namespaceBypass);
  expectFailure(tableBypass,userOnTableBypass);
  expectFailure(tableBypass,userOnNamespaceBypass);
  assertTrue(namespaceBypass.merge(namespaceBypass).getBypass());
  expectFailure(namespaceBypass,userBypass);
  expectFailure(namespaceBypass,tableBypass);
  expectFailure(namespaceBypass,new QuotaGlobalsSettingsBypass(null,null,"sn",false));
  expectFailure(namespaceBypass,userOnTableBypass);
  expectFailure(namespaceBypass,userOnNamespaceBypass);
  assertTrue(userOnTableBypass.merge(userOnTableBypass).getBypass());
  expectFailure(userOnTableBypass,userBypass);
  expectFailure(userOnTableBypass,tableBypass);
  expectFailure(userOnTableBypass,namespaceBypass);
  expectFailure(userOnTableBypass,new QuotaGlobalsSettingsBypass("frank",TableName.valueOf("foo"),null,false));
  expectFailure(userOnTableBypass,new QuotaGlobalsSettingsBypass("joe",TableName.valueOf("bar"),null,false));
  expectFailure(userOnTableBypass,userOnNamespaceBypass);
  assertTrue(userOnNamespaceBypass.merge(userOnNamespaceBypass).getBypass());
  expectFailure(userOnNamespaceBypass,userBypass);
  expectFailure(userOnNamespaceBypass,tableBypass);
  expectFailure(userOnNamespaceBypass,namespaceBypass);
  expectFailure(userOnNamespaceBypass,userOnTableBypass);
  expectFailure(userOnNamespaceBypass,new QuotaGlobalsSettingsBypass("frank",null,"ns",false));
  expectFailure(userOnNamespaceBypass,new QuotaGlobalsSettingsBypass("joe",null,"sn",false));
}
