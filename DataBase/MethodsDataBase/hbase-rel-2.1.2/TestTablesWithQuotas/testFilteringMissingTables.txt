@Test public void testFilteringMissingTables() throws Exception {
  final TableName missingTable=TableName.valueOf("doesNotExist");
  Admin admin=mock(Admin.class);
  when(conn.getAdmin()).thenReturn(admin);
  when(admin.getTableRegions(missingTable)).thenReturn(null);
  QuotaObserverChore chore=mock(QuotaObserverChore.class);
  Map<RegionInfo,Long> regionUsage=new HashMap<>();
  TableQuotaSnapshotStore store=new TableQuotaSnapshotStore(conn,chore,regionUsage);
  final TablesWithQuotas tables=new TablesWithQuotas(conn,conf){
    @Override int getNumReportedRegions(    TableName table,    QuotaSnapshotStore<TableName> tableStore){
      throw new RuntimeException("Should should not reach here");
    }
  }
;
  tables.addTableQuotaTable(missingTable);
  tables.filterInsufficientlyReportedTables(store);
  final Set<TableName> tablesWithQuotas=tables.getTableQuotaTables();
  assertTrue("Expected to find no tables, but found " + tablesWithQuotas,tablesWithQuotas.isEmpty());
}
