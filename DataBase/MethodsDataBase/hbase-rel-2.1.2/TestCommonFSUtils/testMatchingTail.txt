/** 
 * Test path compare and prefix checking.
 */
@Test public void testMatchingTail() throws IOException {
  Path rootdir=htu.getDataTestDir();
  final FileSystem fs=rootdir.getFileSystem(conf);
  assertTrue(rootdir.depth() > 1);
  Path partPath=new Path("a","b");
  Path fullPath=new Path(rootdir,partPath);
  Path fullyQualifiedPath=fs.makeQualified(fullPath);
  assertFalse(CommonFSUtils.isMatchingTail(fullPath,partPath));
  assertFalse(CommonFSUtils.isMatchingTail(fullPath,partPath.toString()));
  assertTrue(CommonFSUtils.isStartingWithPath(rootdir,fullPath.toString()));
  assertTrue(CommonFSUtils.isStartingWithPath(fullyQualifiedPath,fullPath.toString()));
  assertFalse(CommonFSUtils.isStartingWithPath(rootdir,partPath.toString()));
  assertFalse(CommonFSUtils.isMatchingTail(fullyQualifiedPath,partPath));
  assertTrue(CommonFSUtils.isMatchingTail(fullyQualifiedPath,fullPath));
  assertTrue(CommonFSUtils.isMatchingTail(fullyQualifiedPath,fullPath.toString()));
  assertTrue(CommonFSUtils.isMatchingTail(fullyQualifiedPath,fs.makeQualified(fullPath)));
  assertTrue(CommonFSUtils.isStartingWithPath(rootdir,fullyQualifiedPath.toString()));
  assertFalse(CommonFSUtils.isMatchingTail(fullPath,new Path("x")));
  assertFalse(CommonFSUtils.isMatchingTail(new Path("x"),fullPath));
}
