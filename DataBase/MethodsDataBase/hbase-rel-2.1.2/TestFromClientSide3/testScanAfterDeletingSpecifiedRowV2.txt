@Test public void testScanAfterDeletingSpecifiedRowV2() throws IOException {
  TableName tableName=TableName.valueOf(name.getMethodName());
  TableDescriptor desc=TableDescriptorBuilder.newBuilder(tableName).setColumnFamily(ColumnFamilyDescriptorBuilder.of(FAMILY)).build();
  TEST_UTIL.getAdmin().createTable(desc);
  byte[] row=Bytes.toBytes("SpecifiedRow");
  byte[] qual0=Bytes.toBytes("qual0");
  byte[] qual1=Bytes.toBytes("qual1");
  try (Table t=TEST_UTIL.getConnection().getTable(tableName)){
    Delete d=new Delete(row);
    t.delete(d);
    Put put=new Put(row);
    put.addColumn(FAMILY,null,VALUE);
    t.put(put);
    put=new Put(row);
    put.addColumn(FAMILY,qual1,qual1);
    t.put(put);
    put=new Put(row);
    put.addColumn(FAMILY,qual0,qual0);
    t.put(put);
    Result r=t.get(new Get(row));
    assertEquals(3,r.size());
    assertEquals("testValue",Bytes.toString(CellUtil.cloneValue(r.rawCells()[0])));
    assertEquals("qual0",Bytes.toString(CellUtil.cloneValue(r.rawCells()[1])));
    assertEquals("qual1",Bytes.toString(CellUtil.cloneValue(r.rawCells()[2])));
    TEST_UTIL.getAdmin().flush(tableName);
    r=t.get(new Get(row));
    assertEquals(3,r.size());
    assertEquals("testValue",Bytes.toString(CellUtil.cloneValue(r.rawCells()[0])));
    assertEquals("qual0",Bytes.toString(CellUtil.cloneValue(r.rawCells()[1])));
    assertEquals("qual1",Bytes.toString(CellUtil.cloneValue(r.rawCells()[2])));
  }
 }
