@Test public void testDeleteLastColumnFamily() throws Exception {
  final TableName tableName=TableName.valueOf(name.getMethodName());
  TEST_UTIL.createTable(tableName,HConstants.CATALOG_FAMILY).close();
  while (!this.admin.isTableEnabled(TableName.valueOf(name.getMethodName()))) {
    Thread.sleep(10);
  }
  try {
    this.admin.deleteColumnFamily(tableName,HConstants.CATALOG_FAMILY);
    fail("Should have failed to delete the only column family of a table");
  }
 catch (  InvalidFamilyOperationException ex) {
  }
  this.admin.disableTable(tableName);
  try {
    this.admin.deleteColumnFamily(tableName,HConstants.CATALOG_FAMILY);
    fail("Should have failed to delete the only column family of a table");
  }
 catch (  InvalidFamilyOperationException ex) {
  }
  this.admin.deleteTable(tableName);
}
