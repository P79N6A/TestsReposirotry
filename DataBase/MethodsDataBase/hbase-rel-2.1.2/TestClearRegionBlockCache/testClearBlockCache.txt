@Test public void testClearBlockCache() throws Exception {
  BlockCache blockCache1=rs1.getCacheConfig().getBlockCache();
  BlockCache blockCache2=rs2.getCacheConfig().getBlockCache();
  long initialBlockCount1=blockCache1.getBlockCount();
  long initialBlockCount2=blockCache2.getBlockCount();
  scanAllRegionsForRS(rs1);
  assertEquals(blockCache1.getBlockCount() - initialBlockCount1,HTU.getNumHFilesForRS(rs1,TABLE_NAME,FAMILY));
  clearRegionBlockCache(rs1);
  scanAllRegionsForRS(rs2);
  assertEquals(blockCache2.getBlockCount() - initialBlockCount2,HTU.getNumHFilesForRS(rs2,TABLE_NAME,FAMILY));
  clearRegionBlockCache(rs2);
  assertEquals(initialBlockCount1,blockCache1.getBlockCount());
  assertEquals(initialBlockCount2,blockCache2.getBlockCount());
}
