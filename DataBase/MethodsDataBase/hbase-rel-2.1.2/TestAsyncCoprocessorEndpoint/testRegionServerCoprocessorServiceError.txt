@Test public void testRegionServerCoprocessorServiceError() throws Exception {
  final ServerName serverName=TEST_UTIL.getHBaseCluster().getRegionServer(0).getServerName();
  DummyRegionServerEndpointProtos.DummyRequest request=DummyRegionServerEndpointProtos.DummyRequest.getDefaultInstance();
  try {
    admin.<DummyRegionServerEndpointProtos.DummyService.Stub,DummyRegionServerEndpointProtos.DummyResponse>coprocessorService(DummyRegionServerEndpointProtos.DummyService::newStub,(s,c,done) -> s.dummyThrow(c,request,done),serverName).get();
    fail("Should have thrown an exception");
  }
 catch (  Exception e) {
    assertTrue(e.getCause() instanceof RetriesExhaustedException);
    assertTrue(e.getCause().getMessage().contains(WHAT_TO_THROW.getClass().getName().trim()));
  }
}
