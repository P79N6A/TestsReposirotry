@Test public void testMetricForProcedureWithChildren() throws Exception {
  int subProcCount=10;
  int failChildIndex=2;
  int yiledChildIndex=-1;
  ProcedureMetrics[] subprocs=new ProcedureMetrics[subProcCount];
  for (int i=0; i < subProcCount; ++i) {
    subprocs[i]=new ProcedureMetrics(failChildIndex != i,yiledChildIndex == i,3);
  }
  ProcedureMetrics proc=new ProcedureMetrics(true,true,3,subprocs);
  long id=ProcedureTestingUtility.submitAndWait(procExecutor,proc);
  assertNotEquals("ProcId zero!",0,id);
  beginCount+=subProcCount + 1;
  successCount+=subProcCount - (failChildIndex + 1);
  if (failChildIndex >= 0) {
    failedCount+=subProcCount + 1;
  }
 else {
    successCount++;
  }
  ProcedureTestingUtility.waitProcedure(procExecutor,proc);
  assertEquals("beginCount doesn't match!",beginCount,proc.beginCount);
  assertEquals("successCount doesn't match!",successCount,proc.successCount);
  assertEquals("failedCont doesn't match!",failedCount,proc.failedCount);
}
