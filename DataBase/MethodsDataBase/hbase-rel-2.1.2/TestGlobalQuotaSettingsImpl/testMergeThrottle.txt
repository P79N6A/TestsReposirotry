@Test public void testMergeThrottle() throws IOException {
  QuotaProtos.Quotas quota=QuotaProtos.Quotas.newBuilder().setThrottle(THROTTLE).build();
  QuotaProtos.TimedQuota writeQuota=REQUEST_THROTTLE.toBuilder().setSoftLimit(500).build();
  QuotaProtos.ThrottleRequest writeThrottle=QuotaProtos.ThrottleRequest.newBuilder().setTimedQuota(writeQuota).setType(QuotaProtos.ThrottleType.WRITE_NUMBER).build();
  GlobalQuotaSettingsImpl settings=new GlobalQuotaSettingsImpl("joe",null,null,quota);
  GlobalQuotaSettingsImpl merged=settings.merge(new ThrottleSettings("joe",null,null,writeThrottle));
  QuotaProtos.Throttle mergedThrottle=merged.getThrottleProto();
  assertTrue(mergedThrottle.hasReqNum());
  QuotaProtos.TimedQuota actualReqNum=mergedThrottle.getReqNum();
  assertEquals(REQUEST_THROTTLE.getSoftLimit(),actualReqNum.getSoftLimit());
  assertTrue(mergedThrottle.hasWriteNum());
  QuotaProtos.TimedQuota actualWriteNum=mergedThrottle.getWriteNum();
  assertEquals(writeQuota.getSoftLimit(),actualWriteNum.getSoftLimit());
}
