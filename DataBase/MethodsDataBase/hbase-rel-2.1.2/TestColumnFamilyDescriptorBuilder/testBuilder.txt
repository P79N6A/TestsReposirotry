@Test public void testBuilder() throws DeserializationException {
  ColumnFamilyDescriptorBuilder builder=ColumnFamilyDescriptorBuilder.newBuilder(HConstants.CATALOG_FAMILY).setInMemory(true).setScope(HConstants.REPLICATION_SCOPE_LOCAL).setBloomFilterType(BloomType.NONE);
  final int v=123;
  builder.setBlocksize(v);
  builder.setTimeToLive(v);
  builder.setBlockCacheEnabled(!HColumnDescriptor.DEFAULT_BLOCKCACHE);
  builder.setValue(Bytes.toBytes("a"),Bytes.toBytes("b"));
  builder.setMaxVersions(v);
  assertEquals(v,builder.build().getMaxVersions());
  builder.setMinVersions(v);
  assertEquals(v,builder.build().getMinVersions());
  builder.setKeepDeletedCells(KeepDeletedCells.TRUE);
  builder.setInMemory(!HColumnDescriptor.DEFAULT_IN_MEMORY);
  boolean inmemory=builder.build().isInMemory();
  builder.setScope(v);
  builder.setDataBlockEncoding(DataBlockEncoding.FAST_DIFF);
  builder.setBloomFilterType(BloomType.ROW);
  builder.setCompressionType(Algorithm.SNAPPY);
  builder.setMobEnabled(true);
  builder.setMobThreshold(1000L);
  builder.setDFSReplication((short)v);
  ColumnFamilyDescriptor hcd=builder.build();
  byte[] bytes=ColumnFamilyDescriptorBuilder.toByteArray(hcd);
  ColumnFamilyDescriptor deserializedHcd=ColumnFamilyDescriptorBuilder.parseFrom(bytes);
  assertTrue(hcd.equals(deserializedHcd));
  assertEquals(v,hcd.getBlocksize());
  assertEquals(v,hcd.getTimeToLive());
  assertTrue(Bytes.equals(hcd.getValue(Bytes.toBytes("a")),deserializedHcd.getValue(Bytes.toBytes("a"))));
  assertEquals(hcd.getMaxVersions(),deserializedHcd.getMaxVersions());
  assertEquals(hcd.getMinVersions(),deserializedHcd.getMinVersions());
  assertEquals(hcd.getKeepDeletedCells(),deserializedHcd.getKeepDeletedCells());
  assertEquals(inmemory,deserializedHcd.isInMemory());
  assertEquals(hcd.getScope(),deserializedHcd.getScope());
  assertTrue(deserializedHcd.getCompressionType().equals(Compression.Algorithm.SNAPPY));
  assertTrue(deserializedHcd.getDataBlockEncoding().equals(DataBlockEncoding.FAST_DIFF));
  assertTrue(deserializedHcd.getBloomFilterType().equals(BloomType.ROW));
  assertEquals(hcd.isMobEnabled(),deserializedHcd.isMobEnabled());
  assertEquals(hcd.getMobThreshold(),deserializedHcd.getMobThreshold());
  assertEquals(v,deserializedHcd.getDFSReplication());
}
