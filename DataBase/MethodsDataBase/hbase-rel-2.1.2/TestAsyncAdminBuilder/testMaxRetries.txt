@Test public void testMaxRetries() throws Exception {
  TEST_UTIL.getConfiguration().setInt(HConstants.HBASE_CLIENT_OPERATION_TIMEOUT,300000);
  TEST_UTIL.getConfiguration().set(CoprocessorHost.MASTER_COPROCESSOR_CONF_KEY,TestMaxRetriesCoprocessor.class.getName());
  TEST_UTIL.startMiniCluster(2);
  ASYNC_CONN=ConnectionFactory.createAsyncConnection(TEST_UTIL.getConfiguration()).get();
  try {
    getAdminBuilder.get().setMaxRetries(DEFAULT_RETRIES_NUMBER / 2).build().getNamespaceDescriptor(DEFAULT_NAMESPACE_NAME_STR).get();
    fail("We expect an exception here");
  }
 catch (  Exception e) {
  }
  try {
    getAdminBuilder.get().setMaxRetries(DEFAULT_RETRIES_NUMBER * 2).build().getNamespaceDescriptor(DEFAULT_NAMESPACE_NAME_STR).get();
  }
 catch (  Exception e) {
    fail("The Operation should succeed, unexpected exception: " + e.getMessage());
  }
}
