@Test public void testScanRawDeleteFamilyVersion() throws Exception {
  TableName tableName=TableName.valueOf(name.getMethodName());
  TEST_UTIL.createTable(tableName,FAMILY);
  Configuration conf=new Configuration(TEST_UTIL.getConfiguration());
  conf.set(RPC_CODEC_CONF_KEY,"");
  conf.set(DEFAULT_CODEC_CLASS,"");
  try (Connection connection=ConnectionFactory.createConnection(conf);Table table=connection.getTable(tableName)){
    Delete delete=new Delete(ROW);
    delete.addFamilyVersion(FAMILY,0L);
    table.delete(delete);
    Scan scan=new Scan(ROW).setRaw(true);
    ResultScanner scanner=table.getScanner(scan);
    int count=0;
    while (scanner.next() != null) {
      count++;
    }
    assertEquals(1,count);
  }
  finally {
    TEST_UTIL.deleteTable(tableName);
  }
}
