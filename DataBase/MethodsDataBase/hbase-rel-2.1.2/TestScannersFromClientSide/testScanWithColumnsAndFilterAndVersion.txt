@Test public void testScanWithColumnsAndFilterAndVersion() throws IOException {
  TableName tableName=TableName.valueOf(name.getMethodName());
  try (Table table=TEST_UTIL.createTable(tableName,FAMILY,4)){
    for (int i=0; i < 4; i++) {
      Put put=new Put(ROW);
      put.addColumn(FAMILY,QUALIFIER,VALUE);
      table.put(put);
    }
    Scan scan=new Scan();
    scan.addColumn(FAMILY,QUALIFIER);
    scan.setFilter(new QualifierFilter(CompareOperator.EQUAL,new BinaryComparator(QUALIFIER)));
    scan.readVersions(3);
    try (ResultScanner scanner=table.getScanner(scan)){
      Result result=scanner.next();
      assertEquals(3,result.size());
    }
   }
 }
