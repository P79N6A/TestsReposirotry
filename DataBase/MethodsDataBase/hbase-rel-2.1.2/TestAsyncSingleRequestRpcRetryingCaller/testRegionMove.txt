@Test public void testRegionMove() throws InterruptedException, ExecutionException, IOException {
  HRegionLocation loc=CONN.getRegionLocator(TABLE_NAME).getRegionLocation(ROW).get();
  int index=TEST_UTIL.getHBaseCluster().getServerWith(loc.getRegion().getRegionName());
  TEST_UTIL.getAdmin().move(loc.getRegion().getEncodedNameAsBytes(),Bytes.toBytes(TEST_UTIL.getHBaseCluster().getRegionServer(1 - index).getServerName().getServerName()));
  AsyncTable<?> table=CONN.getTableBuilder(TABLE_NAME).setRetryPause(100,TimeUnit.MILLISECONDS).setMaxRetries(30).build();
  table.put(new Put(ROW).addColumn(FAMILY,QUALIFIER,VALUE)).get();
  TEST_UTIL.getAdmin().move(loc.getRegion().getEncodedNameAsBytes(),Bytes.toBytes(loc.getServerName().getServerName()));
  Result result=table.get(new Get(ROW).addColumn(FAMILY,QUALIFIER)).get();
  assertArrayEquals(VALUE,result.getValue(FAMILY,QUALIFIER));
}
