@Test public void testMetricsSourceBaseSourcePassthrough(){
  String id="id";
  DynamicMetricsRegistry mockRegistry=mock(DynamicMetricsRegistry.class);
  MetricsReplicationSourceImpl singleRms=mock(MetricsReplicationSourceImpl.class);
  when(singleRms.getMetricsRegistry()).thenReturn(mockRegistry);
  MetricsReplicationSourceImpl globalRms=mock(MetricsReplicationSourceImpl.class);
  when(globalRms.getMetricsRegistry()).thenReturn(mockRegistry);
  MetricsReplicationSourceSource singleSourceSource=new MetricsReplicationSourceSourceImpl(singleRms,id);
  MetricsReplicationSourceSource globalSourceSource=new MetricsReplicationGlobalSourceSource(globalRms);
  MetricsReplicationSourceSource spyglobalSourceSource=spy(globalSourceSource);
  doNothing().when(spyglobalSourceSource).incrFailedRecoveryQueue();
  Map<String,MetricsReplicationSourceSource> singleSourceSourceByTable=new HashMap<>();
  MetricsSource source=new MetricsSource(id,singleSourceSource,spyglobalSourceSource,singleSourceSourceByTable);
  String gaugeName="gauge";
  String singleGaugeName="source.id." + gaugeName;
  String globalGaugeName="source." + gaugeName;
  long delta=1;
  String counterName="counter";
  String singleCounterName="source.id." + counterName;
  String globalCounterName="source." + counterName;
  long count=2;
  source.decGauge(gaugeName,delta);
  source.getMetricsContext();
  source.getMetricsDescription();
  source.getMetricsJmxContext();
  source.getMetricsName();
  source.incCounters(counterName,count);
  source.incGauge(gaugeName,delta);
  source.init();
  source.removeMetric(gaugeName);
  source.setGauge(gaugeName,delta);
  source.updateHistogram(counterName,count);
  source.incrFailedRecoveryQueue();
  verify(singleRms).decGauge(singleGaugeName,delta);
  verify(globalRms).decGauge(globalGaugeName,delta);
  verify(globalRms).getMetricsContext();
  verify(globalRms).getMetricsJmxContext();
  verify(globalRms).getMetricsName();
  verify(singleRms).incCounters(singleCounterName,count);
  verify(globalRms).incCounters(globalCounterName,count);
  verify(singleRms).incGauge(singleGaugeName,delta);
  verify(globalRms).incGauge(globalGaugeName,delta);
  verify(globalRms).init();
  verify(singleRms).removeMetric(singleGaugeName);
  verify(globalRms).removeMetric(globalGaugeName);
  verify(singleRms).setGauge(singleGaugeName,delta);
  verify(globalRms).setGauge(globalGaugeName,delta);
  verify(singleRms).updateHistogram(singleCounterName,count);
  verify(globalRms).updateHistogram(globalCounterName,count);
  verify(spyglobalSourceSource).incrFailedRecoveryQueue();
  boolean containsRandomNewTable=source.getSingleSourceSourceByTable().containsKey("RandomNewTable");
  Assert.assertEquals(false,containsRandomNewTable);
  source.setAgeOfLastShippedOpByTable(123L,"RandomNewTable");
  containsRandomNewTable=source.getSingleSourceSourceByTable().containsKey("RandomNewTable");
  Assert.assertEquals(true,containsRandomNewTable);
  MetricsReplicationSourceSource msr=source.getSingleSourceSourceByTable().get("RandomNewTable");
  Assert.assertTrue(msr.getLastShippedAge() > 0);
}
