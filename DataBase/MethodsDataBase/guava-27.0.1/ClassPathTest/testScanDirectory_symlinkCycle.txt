@AndroidIncompatible public void testScanDirectory_symlinkCycle() throws IOException {
  ClassLoader loader=ClassPathTest.class.getClassLoader();
  java.nio.file.Path root=createTempDirectory("ClassPathTest");
  try {
    java.nio.file.Path left=createDirectory(root.resolve("left"));
    createFile(left.resolve("some.txt"));
    java.nio.file.Path right=createDirectory(root.resolve("right"));
    createFile(right.resolve("another.txt"));
    createSymbolicLink(left.resolve("sibling"),right);
    createSymbolicLink(right.resolve("sibling"),left);
    ClassPath.DefaultScanner scanner=new ClassPath.DefaultScanner();
    scanner.scan(root.toFile(),loader);
    assertEquals(ImmutableSet.of(new ResourceInfo("left/some.txt",loader),new ResourceInfo("left/sibling/another.txt",loader),new ResourceInfo("right/another.txt",loader),new ResourceInfo("right/sibling/some.txt",loader)),scanner.getResources());
  }
  finally {
    deleteRecursivelyOrLog(root);
  }
}
