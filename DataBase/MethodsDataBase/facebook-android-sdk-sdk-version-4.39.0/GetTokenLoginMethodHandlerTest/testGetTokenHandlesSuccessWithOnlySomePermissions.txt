@Test public void testGetTokenHandlesSuccessWithOnlySomePermissions(){
  Bundle bundle=new Bundle();
  bundle.putStringArrayList(NativeProtocol.EXTRA_PERMISSIONS,new ArrayList<String>(Arrays.asList("go outside")));
  bundle.putLong(NativeProtocol.EXTRA_EXPIRES_SECONDS_SINCE_EPOCH,new Date().getTime() / 1000 + EXPIRES_IN_DELTA);
  bundle.putString(NativeProtocol.EXTRA_ACCESS_TOKEN,ACCESS_TOKEN);
  GetTokenLoginMethodHandler handler=new GetTokenLoginMethodHandler(mockLoginClient);
  LoginClient.Request request=createRequest();
  assertEquals(PERMISSIONS.size(),request.getPermissions().size());
  handler.getTokenCompleted(request,bundle);
  verify(mockLoginClient,never()).completeAndValidate(any(LoginClient.Result.class));
  verify(mockLoginClient,times(1)).tryNextHandler();
}
