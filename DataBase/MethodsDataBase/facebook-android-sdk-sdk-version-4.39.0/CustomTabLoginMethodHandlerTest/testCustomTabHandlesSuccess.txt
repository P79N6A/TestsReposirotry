@Test public void testCustomTabHandlesSuccess(){
  final Bundle bundle=new Bundle();
  bundle.putString("access_token",ACCESS_TOKEN);
  bundle.putString("expires_in",String.format("%d",EXPIRES_IN_DELTA));
  bundle.putString("code","Something else");
  bundle.putString("signed_request",SIGNED_REQUEST_STR);
  handler.onComplete(request,bundle,null);
  final ArgumentCaptor<LoginClient.Result> resultArgumentCaptor=ArgumentCaptor.forClass(LoginClient.Result.class);
  verify(mockLoginClient,times(1)).completeAndValidate(resultArgumentCaptor.capture());
  final LoginClient.Result result=resultArgumentCaptor.getValue();
  assertNotNull(result);
  assertEquals(LoginClient.Result.Code.SUCCESS,result.code);
  final AccessToken token=result.token;
  assertNotNull(token);
  assertEquals(ACCESS_TOKEN,token.getToken());
  assertDateDiffersWithinDelta(new Date(),token.getExpires(),EXPIRES_IN_DELTA * 1000,1000);
  TestUtils.assertSamePermissions(PERMISSIONS,token.getPermissions());
}
