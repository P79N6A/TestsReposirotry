@Test public void testStartStopTrackingAndBroadcast(){
  FacebookSdk.setApplicationId("123456789");
  FacebookSdk.setAutoLogAppEventsEnabled(false);
  FacebookSdk.sdkInitialize(RuntimeEnvironment.application);
  LocalBroadcastManager localBroadcastManager=LocalBroadcastManager.getInstance(RuntimeEnvironment.application);
  TestProfileTracker testProfileTracker=new TestProfileTracker();
  assertTrue(testProfileTracker.isTracking());
  testProfileTracker.stopTracking();
  assertFalse(testProfileTracker.isTracking());
  sendBroadcast(localBroadcastManager,null,ProfileTest.createDefaultProfile());
  assertFalse(testProfileTracker.isCallbackCalled);
  testProfileTracker.startTracking();
  assertTrue(testProfileTracker.isTracking());
  Profile profile=ProfileTest.createDefaultProfile();
  sendBroadcast(localBroadcastManager,null,profile);
  assertNull(testProfileTracker.oldProfile);
  assertEquals(profile,testProfileTracker.currentProfile);
  assertTrue(testProfileTracker.isCallbackCalled);
  Profile profile1=ProfileTest.createMostlyNullsProfile();
  Profile profile2=ProfileTest.createDefaultProfile();
  sendBroadcast(localBroadcastManager,profile1,profile2);
  ProfileTest.assertMostlyNullsObjectGetters(testProfileTracker.oldProfile);
  ProfileTest.assertDefaultObjectGetters(testProfileTracker.currentProfile);
  assertEquals(profile1,testProfileTracker.oldProfile);
  assertEquals(profile2,testProfileTracker.currentProfile);
  testProfileTracker.stopTracking();
}
