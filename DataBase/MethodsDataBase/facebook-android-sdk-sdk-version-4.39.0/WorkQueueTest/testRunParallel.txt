@Test public void testRunParallel(){
  final int workTotal=100;
  CountingRunnable run=new CountingRunnable();
  ScriptableExecutor executor=new ScriptableExecutor();
  WorkQueue manager=new WorkQueue(workTotal,executor);
  for (int i=0; i < workTotal; i++) {
    assertEquals(i,executor.getPendingCount());
    addActiveWorkItem(manager,run);
  }
  for (int i=0; i < workTotal; i++) {
    assertEquals(workTotal - i,executor.getPendingCount());
    assertEquals(i,run.getRunCount());
    executeNext(manager,executor);
  }
  assertEquals(0,executor.getPendingCount());
  assertEquals(workTotal,run.getRunCount());
}
