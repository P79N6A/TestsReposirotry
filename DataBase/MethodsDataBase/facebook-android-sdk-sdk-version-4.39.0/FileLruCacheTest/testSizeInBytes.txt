@Test public void testSizeInBytes() throws Exception {
  int count=17;
  int dataSize=53;
  int cacheSize=count * dataSize;
  byte[] data=generateBytes(dataSize);
  FileLruCache cache=new FileLruCache("testSizeInBytes",limitCacheSize(2 * cacheSize));
  try {
    TestUtils.clearFileLruCache(cache);
    for (int i=0; i < count; i++) {
      put(cache,i,data);
      int totalDataSize=(i + 1) * dataSize;
      assertTrue(cache.sizeInBytesForTest() > totalDataSize);
      assertTrue(cache.sizeInBytesForTest() < 2 * totalDataSize);
    }
    for (int i=0; i < count; i++) {
      String key=Integer.valueOf(i).toString();
      checkValue(cache,key,data);
    }
  }
  finally {
    TestUtils.clearAndDeleteLruCacheDirectory(cache);
  }
}
