@Test public void testCacheInputStream() throws Exception {
  int dataSize=1024;
  byte[] data=generateBytes(dataSize);
  String key="a";
  InputStream stream=new ByteArrayInputStream(data);
  FileLruCache cache=new FileLruCache("testCacheInputStream",limitCacheSize(2 * dataSize));
  try {
    TestUtils.clearFileLruCache(cache);
    InputStream wrapped=cache.interceptAndPut(key,stream);
    consumeAndClose(wrapped);
    checkValue(cache,key,data);
  }
  finally {
    TestUtils.clearAndDeleteLruCacheDirectory(cache);
  }
}
