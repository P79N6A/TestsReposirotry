@Test public void authenticateWhenPasswordServiceAndBadCredentialsThenNotUpdated(){
  when(this.userDetailsService.findByUsername(any())).thenReturn(Mono.just(this.user));
  when(this.encoder.matches(any(),any())).thenReturn(false);
  this.manager.setPasswordEncoder(this.encoder);
  this.manager.setUserDetailsPasswordService(this.userDetailsPasswordService);
  UsernamePasswordAuthenticationToken token=new UsernamePasswordAuthenticationToken(this.user,this.user.getPassword());
  assertThatThrownBy(() -> this.manager.authenticate(token).block()).isInstanceOf(BadCredentialsException.class);
  verifyZeroInteractions(this.userDetailsPasswordService);
}
