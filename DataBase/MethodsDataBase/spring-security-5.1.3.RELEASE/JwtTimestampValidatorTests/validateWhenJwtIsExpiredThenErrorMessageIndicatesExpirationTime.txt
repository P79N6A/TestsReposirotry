@Test public void validateWhenJwtIsExpiredThenErrorMessageIndicatesExpirationTime(){
  Instant oneHourAgo=Instant.now().minusSeconds(3600);
  Jwt jwt=new Jwt(MOCK_TOKEN_VALUE,MOCK_ISSUED_AT,oneHourAgo,MOCK_HEADER,MOCK_CLAIM_SET);
  JwtTimestampValidator jwtValidator=new JwtTimestampValidator();
  Collection<OAuth2Error> details=jwtValidator.validate(jwt).getErrors();
  Collection<String> messages=details.stream().map(OAuth2Error::getDescription).collect(Collectors.toList());
  assertThat(messages).contains("Jwt expired at " + oneHourAgo);
}
