@Test public void validateWhenJwtIsTooEarlyThenErrorMessageIndicatesNotBeforeTime(){
  Instant oneHourFromNow=Instant.now().plusSeconds(3600);
  Jwt jwt=new Jwt(MOCK_TOKEN_VALUE,MOCK_ISSUED_AT,null,MOCK_HEADER,Collections.singletonMap(JwtClaimNames.NBF,oneHourFromNow));
  JwtTimestampValidator jwtValidator=new JwtTimestampValidator();
  Collection<OAuth2Error> details=jwtValidator.validate(jwt).getErrors();
  Collection<String> messages=details.stream().map(OAuth2Error::getDescription).collect(Collectors.toList());
  assertThat(messages).contains("Jwt used before " + oneHourFromNow);
}
