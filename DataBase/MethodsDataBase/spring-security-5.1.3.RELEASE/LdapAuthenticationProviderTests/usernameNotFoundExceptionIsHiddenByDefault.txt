@Test(expected=BadCredentialsException.class) public void usernameNotFoundExceptionIsHiddenByDefault(){
  final LdapAuthenticator authenticator=mock(LdapAuthenticator.class);
  final UsernamePasswordAuthenticationToken joe=new UsernamePasswordAuthenticationToken("joe","password");
  when(authenticator.authenticate(joe)).thenThrow(new UsernameNotFoundException("nobody"));
  LdapAuthenticationProvider provider=new LdapAuthenticationProvider(authenticator);
  provider.authenticate(joe);
}
