@Test public void authenticateWithNamingException(){
  UsernamePasswordAuthenticationToken authRequest=new UsernamePasswordAuthenticationToken("ben","benspassword");
  LdapAuthenticator mockAuthenticator=mock(LdapAuthenticator.class);
  CommunicationException expectedCause=new CommunicationException(new javax.naming.CommunicationException());
  when(mockAuthenticator.authenticate(authRequest)).thenThrow(expectedCause);
  LdapAuthenticationProvider ldapProvider=new LdapAuthenticationProvider(mockAuthenticator);
  try {
    ldapProvider.authenticate(authRequest);
    fail("Expected Exception");
  }
 catch (  InternalAuthenticationServiceException success) {
    assertThat(success.getCause()).isSameAs(expectedCause);
  }
}
