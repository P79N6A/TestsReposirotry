@Test(expected=UsernameNotFoundException.class) public void usernameNotFoundExceptionIsNotHiddenIfConfigured(){
  final LdapAuthenticator authenticator=mock(LdapAuthenticator.class);
  final UsernamePasswordAuthenticationToken joe=new UsernamePasswordAuthenticationToken("joe","password");
  when(authenticator.authenticate(joe)).thenThrow(new UsernameNotFoundException("nobody"));
  LdapAuthenticationProvider provider=new LdapAuthenticationProvider(authenticator);
  provider.setHideUserNotFoundExceptions(false);
  provider.authenticate(joe);
}
