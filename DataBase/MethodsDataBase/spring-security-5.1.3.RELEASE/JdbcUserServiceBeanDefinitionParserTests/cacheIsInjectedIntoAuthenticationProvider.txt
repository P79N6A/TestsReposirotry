@Test public void cacheIsInjectedIntoAuthenticationProvider(){
  setContext("<authentication-manager>" + "  <authentication-provider>" + "    <jdbc-user-service cache-ref='userCache' data-source-ref='dataSource'/>"+ "  </authentication-provider>"+ "</authentication-manager>" + DATA_SOURCE + USER_CACHE_XML);
  ProviderManager mgr=(ProviderManager)appContext.getBean(BeanIds.AUTHENTICATION_MANAGER);
  DaoAuthenticationProvider provider=(DaoAuthenticationProvider)mgr.getProviders().get(0);
  assertThat(appContext.getBean("userCache")).isSameAs(provider.getUserCache());
  provider.authenticate(new UsernamePasswordAuthenticationToken("rod","koala"));
  assertThat(provider.getUserCache().getUserFromCache("rod")).isNotNull().withFailMessage("Cache should contain user after authentication");
}
