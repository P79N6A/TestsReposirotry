@Test public void authenticateWhenJwtDecodesThenAuthenticationHasAttributesContainedInJwt(){
  BearerTokenAuthenticationToken token=this.authentication();
  Map<String,Object> claims=new HashMap<>();
  claims.put("name","value");
  Jwt jwt=this.jwt(claims);
  when(this.jwtDecoder.decode("token")).thenReturn(jwt);
  when(this.jwtAuthenticationConverter.convert(jwt)).thenReturn(new JwtAuthenticationToken(jwt));
  JwtAuthenticationToken authentication=(JwtAuthenticationToken)this.provider.authenticate(token);
  assertThat(authentication.getTokenAttributes()).isEqualTo(claims);
}
