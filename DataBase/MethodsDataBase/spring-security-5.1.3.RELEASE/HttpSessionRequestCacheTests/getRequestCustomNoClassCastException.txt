@Test public void getRequestCustomNoClassCastException() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest("POST","/destination");
  MockHttpServletResponse response=new MockHttpServletResponse();
  HttpSessionRequestCache cache=new HttpSessionRequestCache(){
    @Override public void saveRequest(    HttpServletRequest request,    HttpServletResponse response){
      request.getSession().setAttribute(SAVED_REQUEST,new CustomSavedRequest(new DefaultSavedRequest(request,new PortResolverImpl())));
    }
  }
;
  cache.saveRequest(request,response);
  cache.saveRequest(request,response);
  assertThat(cache.getRequest(request,response)).isInstanceOf(CustomSavedRequest.class);
}
