@Test @Transactional public void cumulativePermissions(){
  Authentication auth=new TestingAuthenticationToken("ben","ignored","ROLE_ADMINISTRATOR");
  auth.setAuthenticated(true);
  SecurityContextHolder.getContext().setAuthentication(auth);
  ObjectIdentity topParentOid=new ObjectIdentityImpl(TARGET_CLASS,Long.valueOf(110));
  MutableAcl topParent=jdbcMutableAclService.createAcl(topParentOid);
  Permission cm=new CumulativePermission().set(BasePermission.READ).set(BasePermission.ADMINISTRATION);
  assertThat(cm.getMask()).isEqualTo(17);
  Sid benSid=new PrincipalSid(auth);
  topParent.insertAce(0,cm,benSid,true);
  assertThat(topParent.getEntries()).hasSize(1);
  topParent=jdbcMutableAclService.updateAcl(topParent);
  assertThat(topParent.getEntries().get(0).getPermission().getMask()).isEqualTo(17);
  assertThat(topParent.isGranted(Arrays.asList(cm),Arrays.asList(benSid),true)).isTrue();
  SecurityContextHolder.clearContext();
}
