@Test public void getServiceUrlDoesNotUseHostHeader() throws Exception {
  this.casServiceUrl="https://example.com/j_spring_security_cas";
  this.request.setServerName("evil.com");
  this.details=new DefaultServiceAuthenticationDetails(this.casServiceUrl,this.request,this.artifactPattern);
  assertThat(this.details.getServiceUrl()).isEqualTo("https://example.com/cas-sample/secure/");
}
