@Test public void additionalHeadersShouldBeAddedToTheResponse() throws Exception {
  List<HeaderWriter> headerWriters=new ArrayList<>();
  headerWriters.add(this.writer1);
  headerWriters.add(this.writer2);
  HeaderWriterFilter filter=new HeaderWriterFilter(headerWriters);
  MockHttpServletRequest request=new MockHttpServletRequest();
  MockHttpServletResponse response=new MockHttpServletResponse();
  MockFilterChain filterChain=new MockFilterChain();
  filter.doFilter(request,response,filterChain);
  verify(this.writer1).writeHeaders(request,response);
  verify(this.writer2).writeHeaders(request,response);
  HeaderWriterFilter.HeaderWriterRequest wrappedRequest=(HeaderWriterFilter.HeaderWriterRequest)filterChain.getRequest();
  assertThat(wrappedRequest.getRequest()).isEqualTo(request);
}
