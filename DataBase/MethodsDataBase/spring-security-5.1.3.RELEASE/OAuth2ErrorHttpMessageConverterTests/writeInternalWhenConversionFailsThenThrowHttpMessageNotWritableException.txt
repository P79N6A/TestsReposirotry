@Test public void writeInternalWhenConversionFailsThenThrowHttpMessageNotWritableException(){
  Converter errorParametersConverter=mock(Converter.class);
  when(errorParametersConverter.convert(any())).thenThrow(RuntimeException.class);
  this.messageConverter.setErrorParametersConverter(errorParametersConverter);
  OAuth2Error oauth2Error=new OAuth2Error("unauthorized_client","The client is not authorized","https://tools.ietf.org/html/rfc6749#section-5.2");
  MockHttpOutputMessage outputMessage=new MockHttpOutputMessage();
  assertThatThrownBy(() -> this.messageConverter.writeInternal(oauth2Error,outputMessage)).isInstanceOf(HttpMessageNotWritableException.class).hasMessageContaining("An error occurred writing the OAuth 2.0 Error");
}
