@Test public void ipAddressMatchesForEqualIpAddresses() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setRequestURI("/test");
  request.setRemoteAddr("192.168.1.1");
  WebSecurityExpressionRoot root=new WebSecurityExpressionRoot(mock(Authentication.class),new FilterInvocation(request,mock(HttpServletResponse.class),mock(FilterChain.class)));
  assertThat(root.hasIpAddress("192.168.1.1")).isTrue();
  request.setRemoteAddr("fa:db8:85a3::8a2e:370:7334");
  assertThat(root.hasIpAddress("fa:db8:85a3::8a2e:370:7334")).isTrue();
}
