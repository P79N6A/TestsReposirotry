@Test public void handleWhenNotOAuth2AuthenticatedThenStatus403() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest();
  MockHttpServletResponse response=new MockHttpServletResponse();
  Authentication authentication=new TestingAuthenticationToken("user","pass");
  request.setUserPrincipal(authentication);
  this.accessDeniedHandler.handle(request,response,null);
  assertThat(response.getStatus()).isEqualTo(403);
  assertThat(response.getHeader("WWW-Authenticate")).isEqualTo("Bearer");
}
