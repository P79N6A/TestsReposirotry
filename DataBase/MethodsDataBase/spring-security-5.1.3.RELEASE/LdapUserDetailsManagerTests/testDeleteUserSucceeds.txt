@Test public void testDeleteUserSucceeds(){
  InetOrgPerson.Essence p=new InetOrgPerson.Essence();
  p.setDn("whocares");
  p.setCn(new String[]{"Don Smeth"});
  p.setSn("Smeth");
  p.setUid("don");
  p.setAuthorities(TEST_AUTHORITIES);
  mgr.createUser(p.createUserDetails());
  mgr.setUserDetailsMapper(new InetOrgPersonContextMapper());
  InetOrgPerson don=(InetOrgPerson)mgr.loadUserByUsername("don");
  assertThat(don.getAuthorities()).hasSize(2);
  mgr.deleteUser("don");
  try {
    mgr.loadUserByUsername("don");
    fail("Expected UsernameNotFoundException after deleting user");
  }
 catch (  UsernameNotFoundException expected) {
  }
  assertThat(mgr.getUserAuthorities(mgr.usernameMapper.buildDn("don"),"don")).hasSize(0);
}
