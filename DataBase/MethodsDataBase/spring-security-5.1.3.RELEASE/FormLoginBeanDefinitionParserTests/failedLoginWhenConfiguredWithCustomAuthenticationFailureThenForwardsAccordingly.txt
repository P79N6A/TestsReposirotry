@Test public void failedLoginWhenConfiguredWithCustomAuthenticationFailureThenForwardsAccordingly() throws Exception {
  this.spring.configLocations(this.xml("WithAuthenticationFailureForwardUrl")).autowire();
  this.mvc.perform(post("/login").param("username","bob").param("password","invalidpassword")).andExpect(status().isOk()).andExpect(forwardedUrl("/failure_forward_url")).andExpect(request().attribute(WebAttributes.AUTHENTICATION_EXCEPTION,not(nullValue())));
}
