@Test @WithMockUser public void methodSecurityWhenAuthenticationTrustResolverIsBeanThenAutowires(){
  this.spring.register(CustomTrustResolverConfig.class).autowire();
  AuthenticationTrustResolver trustResolver=this.spring.getContext().getBean(AuthenticationTrustResolver.class);
  when(trustResolver.isAnonymous(any())).thenReturn(true,false);
  assertThatThrownBy(() -> this.service.preAuthorizeNotAnonymous()).isInstanceOf(AccessDeniedException.class);
  this.service.preAuthorizeNotAnonymous();
  verify(trustResolver,atLeastOnce()).isAnonymous(any());
}
