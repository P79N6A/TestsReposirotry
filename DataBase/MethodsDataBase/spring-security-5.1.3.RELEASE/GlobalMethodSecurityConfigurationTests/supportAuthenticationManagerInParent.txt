@Test @WithMockUser public void supportAuthenticationManagerInParent(){
  try (AnnotationConfigWebApplicationContext parent=new AnnotationConfigWebApplicationContext()){
    parent.register(Sec2479ParentConfig.class);
    parent.refresh();
    try (AnnotationConfigWebApplicationContext child=new AnnotationConfigWebApplicationContext()){
      child.setParent(parent);
      child.register(Sec2479ChildConfig.class);
      child.refresh();
      this.spring.context(child).autowire();
      assertThatThrownBy(() -> this.service.preAuthorize()).isInstanceOf(AccessDeniedException.class);
    }
   }
 }
