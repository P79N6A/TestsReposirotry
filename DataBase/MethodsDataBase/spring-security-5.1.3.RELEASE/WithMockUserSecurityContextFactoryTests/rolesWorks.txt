@Test public void rolesWorks(){
  when(withUser.value()).thenReturn("valueUser");
  when(withUser.password()).thenReturn("password");
  when(withUser.roles()).thenReturn(new String[]{"USER","CUSTOM"});
  when(withUser.authorities()).thenReturn(new String[]{});
  assertThat(factory.createSecurityContext(withUser).getAuthentication().getAuthorities()).extracting("authority").containsOnly("ROLE_USER","ROLE_CUSTOM");
}
