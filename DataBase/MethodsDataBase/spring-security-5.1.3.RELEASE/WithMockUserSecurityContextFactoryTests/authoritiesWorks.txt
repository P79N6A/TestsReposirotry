@Test public void authoritiesWorks(){
  when(withUser.value()).thenReturn("valueUser");
  when(withUser.password()).thenReturn("password");
  when(withUser.roles()).thenReturn(new String[]{"USER"});
  when(withUser.authorities()).thenReturn(new String[]{"USER","CUSTOM"});
  assertThat(factory.createSecurityContext(withUser).getAuthentication().getAuthorities()).extracting("authority").containsOnly("USER","CUSTOM");
}
