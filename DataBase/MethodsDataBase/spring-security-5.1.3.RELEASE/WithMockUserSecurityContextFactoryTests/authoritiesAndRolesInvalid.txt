@Test(expected=IllegalStateException.class) public void authoritiesAndRolesInvalid(){
  when(withUser.value()).thenReturn("valueUser");
  when(withUser.roles()).thenReturn(new String[]{"CUSTOM"});
  when(withUser.authorities()).thenReturn(new String[]{"USER","CUSTOM"});
  factory.createSecurityContext(withUser);
}
