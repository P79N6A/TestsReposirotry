/** 
 * SEC-571
 */
@Test public void testNoSessionIsCreatedIfAllowSessionCreationIsFalse() throws Exception {
  MockHttpServletRequest request=createMockAuthenticationRequest();
  MockFilterConfig config=new MockFilterConfig(null,null);
  MockFilterChain chain=new MockFilterChain(true);
  MockHttpServletResponse response=new MockHttpServletResponse();
  MockAuthenticationFilter filter=new MockAuthenticationFilter(false);
  failureHandler.setAllowSessionCreation(false);
  filter.setAuthenticationFailureHandler(failureHandler);
  filter.doFilter(request,response,chain);
  assertThat(request.getSession(false)).isNull();
}
