@Test public void testNullUsernameHandledGracefully() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest("POST","/");
  request.addParameter(UsernamePasswordAuthenticationFilter.SPRING_SECURITY_FORM_PASSWORD_KEY,"koala");
  UsernamePasswordAuthenticationFilter filter=new UsernamePasswordAuthenticationFilter();
  filter.setAuthenticationManager(createAuthenticationManager());
  assertThat(filter.attemptAuthentication(request,new MockHttpServletResponse())).isNotNull();
}
