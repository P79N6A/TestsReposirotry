@Test public void csrfProtectionForConnect() throws InterruptedException {
  loadConfig(SockJsSecurityConfig.class);
  SimpMessageHeaderAccessor headers=SimpMessageHeaderAccessor.create(SimpMessageType.CONNECT);
  Message<?> message=message(headers,"/authentication");
  MessageChannel messageChannel=clientInboundChannel();
  try {
    messageChannel.send(message);
    fail("Expected Exception");
  }
 catch (  MessageDeliveryException success) {
    assertThat(success.getCause()).isInstanceOf(MissingCsrfTokenException.class);
  }
}
