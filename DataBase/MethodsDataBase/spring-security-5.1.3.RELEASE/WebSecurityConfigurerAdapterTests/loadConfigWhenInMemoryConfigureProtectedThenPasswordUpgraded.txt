@Test public void loadConfigWhenInMemoryConfigureProtectedThenPasswordUpgraded() throws Exception {
  this.spring.register(InMemoryConfigureProtectedConfig.class).autowire();
  this.mockMvc.perform(formLogin()).andExpect(status().is3xxRedirection());
  UserDetailsService uds=this.spring.getContext().getBean(UserDetailsService.class);
  assertThat(uds.loadUserByUsername("user").getPassword()).startsWith("{bcrypt}");
}
