@Test public void loadConfigWhenUserDetailsServiceHasCircularReferenceThenStillLoads() throws Exception {
  this.spring.register(RequiresUserDetailsServiceConfig.class,UserDetailsServiceConfig.class).autowire();
  MyFilter myFilter=this.spring.getContext().getBean(MyFilter.class);
  Throwable thrown=catchThrowable(() -> myFilter.userDetailsService.loadUserByUsername("user"));
  assertThat(thrown).isNull();
  thrown=catchThrowable(() -> myFilter.userDetailsService.loadUserByUsername("admin"));
  assertThat(thrown).isInstanceOf(UsernameNotFoundException.class);
}
