@Test public void constructorWhenAuthoritiesIdTokenUserInfoProvidedThenCreated(){
  DefaultOidcUser user=new DefaultOidcUser(AUTHORITIES,ID_TOKEN,USER_INFO);
  assertThat(user.getClaims()).containsOnlyKeys(IdTokenClaimNames.ISS,IdTokenClaimNames.SUB,StandardClaimNames.NAME,StandardClaimNames.EMAIL);
  assertThat(user.getIdToken()).isEqualTo(ID_TOKEN);
  assertThat(user.getUserInfo()).isEqualTo(USER_INFO);
  assertThat(user.getName()).isEqualTo(SUBJECT);
  assertThat(user.getAuthorities()).hasSize(1);
  assertThat(user.getAuthorities().iterator().next()).isEqualTo(AUTHORITY);
  assertThat(user.getAttributes()).containsOnlyKeys(IdTokenClaimNames.ISS,IdTokenClaimNames.SUB,StandardClaimNames.NAME,StandardClaimNames.EMAIL);
}
