@Test(expected=UnsupportedOperationException.class) public void testAuthoritiesAreImmutable(){
  MockAuthenticationImpl token=new MockAuthenticationImpl("Test","Password",authorities);
  List<GrantedAuthority> gotAuthorities=(List<GrantedAuthority>)token.getAuthorities();
  assertThat(gotAuthorities).isNotSameAs(authorities);
  gotAuthorities.set(0,new SimpleGrantedAuthority("ROLE_SUPER_USER"));
}
