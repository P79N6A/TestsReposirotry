@Test public void accessIsAllowedIfPermissionIsGranted(){
  AclService service=mock(AclService.class);
  Acl acl=mock(Acl.class);
  when(acl.isGranted(any(List.class),any(List.class),anyBoolean())).thenReturn(true);
  when(service.readAclById(any(),any())).thenReturn(acl);
  AclEntryAfterInvocationProvider provider=new AclEntryAfterInvocationProvider(service,Arrays.asList(mock(Permission.class)));
  provider.setMessageSource(new SpringSecurityMessageSource());
  provider.setObjectIdentityRetrievalStrategy(mock(ObjectIdentityRetrievalStrategy.class));
  provider.setProcessDomainObjectClass(Object.class);
  provider.setSidRetrievalStrategy(mock(SidRetrievalStrategy.class));
  Object returned=new Object();
  assertThat(returned).isSameAs(provider.decide(mock(Authentication.class),new Object(),SecurityConfig.createList("AFTER_ACL_READ"),returned));
}
