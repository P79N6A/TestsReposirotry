@Test public void passwordNeedsResetIsCorrectlyMapped(){
  final String dataCode="773";
  provider.contextFactory=createContextFactoryThrowing(new AuthenticationException(msg + dataCode + ", xxxx]"));
  provider.setConvertSubErrorCodesToExceptions(true);
  thrown.expect(BadCredentialsException.class);
  thrown.expect(new BaseMatcher<BadCredentialsException>(){
    private Matcher<Object> causeInstance=CoreMatchers.instanceOf(ActiveDirectoryAuthenticationException.class);
    private Matcher<String> causeDataCode=CoreMatchers.equalTo(dataCode);
    public boolean matches(    Object that){
      Throwable t=(Throwable)that;
      ActiveDirectoryAuthenticationException cause=(ActiveDirectoryAuthenticationException)t.getCause();
      return causeInstance.matches(cause) && causeDataCode.matches(cause.getDataCode());
    }
    public void describeTo(    Description desc){
      desc.appendText("getCause() ");
      causeInstance.describeTo(desc);
      desc.appendText("getCause().getDataCode() ");
      causeDataCode.describeTo(desc);
    }
  }
);
  provider.authenticate(joe);
}
