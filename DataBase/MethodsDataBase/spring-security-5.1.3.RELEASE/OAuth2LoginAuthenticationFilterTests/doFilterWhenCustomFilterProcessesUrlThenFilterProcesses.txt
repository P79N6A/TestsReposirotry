@Test public void doFilterWhenCustomFilterProcessesUrlThenFilterProcesses() throws Exception {
  String filterProcessesUrl="/login/oauth2/custom/*";
  this.filter=spy(new OAuth2LoginAuthenticationFilter(this.clientRegistrationRepository,this.authorizedClientRepository,filterProcessesUrl));
  this.filter.setAuthenticationManager(this.authenticationManager);
  String requestUri="/login/oauth2/custom/" + this.registration2.getRegistrationId();
  String state="state";
  MockHttpServletRequest request=new MockHttpServletRequest("GET",requestUri);
  request.setServletPath(requestUri);
  request.addParameter(OAuth2ParameterNames.CODE,"code");
  request.addParameter(OAuth2ParameterNames.STATE,state);
  MockHttpServletResponse response=new MockHttpServletResponse();
  FilterChain filterChain=mock(FilterChain.class);
  this.setUpAuthorizationRequest(request,response,this.registration2,state);
  this.setUpAuthenticationResult(this.registration2);
  this.filter.doFilter(request,response,filterChain);
  verifyZeroInteractions(filterChain);
  verify(this.filter).attemptAuthentication(any(HttpServletRequest.class),any(HttpServletResponse.class));
}
