@Test public void missingAuthenticationManagerGivesSensibleErrorMessage(){
  try {
    setContext("<http auto-config='true' />");
  }
 catch (  BeanCreationException e) {
    Throwable cause=ultimateCause(e);
    assertThat(cause instanceof NoSuchBeanDefinitionException).isTrue();
    NoSuchBeanDefinitionException nsbe=(NoSuchBeanDefinitionException)cause;
    assertThat(nsbe.getBeanName()).isEqualTo(BeanIds.AUTHENTICATION_MANAGER);
    assertThat(nsbe.getMessage().endsWith(AuthenticationManagerFactoryBean.MISSING_BEAN_ERROR_MESSAGE));
  }
}
