/** 
 * SEC-2422: csrf expire CSRF token and session-management invalid-session-url
 */
@Test public void postWhenUsingCsrfAndCustomSessionManagementAndNoSessionThenStillRedirectsToInvalidSessionUrl() throws Exception {
  this.spring.configLocations(this.xml("WithSessionManagement")).autowire();
  MvcResult result=this.mvc.perform(post("/ok").param("_csrf","abc")).andExpect(redirectedUrl("/error/sessionError")).andReturn();
  MockHttpSession session=(MockHttpSession)result.getRequest().getSession();
  this.mvc.perform(post("/csrf").session(session)).andExpect(status().isForbidden());
}
