@Test public void testOperationWhenTargetPortIsUnknown() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest("GET","/bigWebApp");
  request.setQueryString("open=true");
  request.setScheme("https");
  request.setServerName("www.example.com");
  request.setServerPort(8768);
  MockHttpServletResponse response=new MockHttpServletResponse();
  RetryWithHttpEntryPoint ep=new RetryWithHttpEntryPoint();
  ep.setPortMapper(new PortMapperImpl());
  ep.setPortResolver(new MockPortResolver(8768,1234));
  ep.commence(request,response);
  assertThat(response.getRedirectedUrl()).isEqualTo("/bigWebApp?open=true");
}
