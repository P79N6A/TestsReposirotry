/** 
 * SEC-2292 Should not allow other cases through since spec states HTTP method is case sensitive http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1.1
 * @throws Exception if an error occurs
 */
@Test public void doFilterDefaultRequireCsrfProtectionMatcherAllowedMethodsCaseSensitive() throws Exception {
  this.filter=new CsrfFilter(this.tokenRepository);
  this.filter.setAccessDeniedHandler(this.deniedHandler);
  for (  String method : Arrays.asList("get","TrAcE","oPTIOnS","hEaD")) {
    resetRequestResponse();
    when(this.tokenRepository.loadToken(this.request)).thenReturn(this.token);
    this.request.setMethod(method);
    this.filter.doFilter(this.request,this.response,this.filterChain);
    verify(this.deniedHandler).handle(eq(this.request),eq(this.response),any(InvalidCsrfTokenException.class));
    verifyZeroInteractions(this.filterChain);
  }
}
