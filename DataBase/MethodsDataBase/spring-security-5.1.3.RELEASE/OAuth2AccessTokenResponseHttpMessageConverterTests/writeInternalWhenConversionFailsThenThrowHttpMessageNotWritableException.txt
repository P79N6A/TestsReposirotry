@Test public void writeInternalWhenConversionFailsThenThrowHttpMessageNotWritableException(){
  Converter tokenResponseParametersConverter=mock(Converter.class);
  when(tokenResponseParametersConverter.convert(any())).thenThrow(RuntimeException.class);
  this.messageConverter.setTokenResponseParametersConverter(tokenResponseParametersConverter);
  OAuth2AccessTokenResponse accessTokenResponse=OAuth2AccessTokenResponse.withToken("access-token-1234").tokenType(OAuth2AccessToken.TokenType.BEARER).expiresIn(Instant.now().plusSeconds(3600).toEpochMilli()).build();
  MockHttpOutputMessage outputMessage=new MockHttpOutputMessage();
  assertThatThrownBy(() -> this.messageConverter.writeInternal(accessTokenResponse,outputMessage)).isInstanceOf(HttpMessageNotWritableException.class).hasMessageContaining("An error occurred writing the OAuth 2.0 Access Token Response");
}
