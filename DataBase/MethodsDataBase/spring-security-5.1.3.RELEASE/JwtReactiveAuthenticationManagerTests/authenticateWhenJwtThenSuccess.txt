@Test public void authenticateWhenJwtThenSuccess(){
  BearerTokenAuthenticationToken token=new BearerTokenAuthenticationToken("token-1");
  when(this.jwtDecoder.decode(token.getToken())).thenReturn(Mono.just(this.jwt));
  Authentication authentication=this.manager.authenticate(token).block();
  assertThat(authentication).isNotNull();
  assertThat(authentication.isAuthenticated()).isTrue();
  assertThat(authentication.getAuthorities()).extracting(GrantedAuthority::getAuthority).containsOnly("SCOPE_message:read","SCOPE_message:write");
}
