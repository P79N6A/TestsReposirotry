@Test public void redirectIsNotPerformedIfResponseIsCommitted() throws Exception {
  SimpleUrlAuthenticationSuccessHandler ash=new SimpleUrlAuthenticationSuccessHandler("/target");
  MockHttpServletRequest request=new MockHttpServletRequest();
  MockHttpServletResponse response=new MockHttpServletResponse();
  response.setCommitted(true);
  ash.onAuthenticationSuccess(request,response,mock(Authentication.class));
  assertThat(response.getRedirectedUrl()).isNull();
}
