@Test public void credentialsAreClearedByDefault() throws Exception {
  UsernamePasswordAuthenticationToken token=new UsernamePasswordAuthenticationToken("Test","Password");
  ProviderManager mgr=makeProviderManager();
  Authentication result=mgr.authenticate(token);
  assertThat(result.getCredentials()).isNull();
  mgr.setEraseCredentialsAfterAuthentication(false);
  token=new UsernamePasswordAuthenticationToken("Test","Password");
  result=mgr.authenticate(token);
  assertThat(result.getCredentials()).isNotNull();
}
