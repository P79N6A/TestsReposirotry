@Test public void beforeTestExecutionWhenTestContextNotNullThenSecurityContextSet() throws Exception {
  SecurityContextImpl securityContext=new SecurityContextImpl();
  securityContext.setAuthentication(new TestingAuthenticationToken("user","passsword","ROLE_USER"));
  when(this.testContext.removeAttribute(WithSecurityContextTestExecutionListener.SECURITY_CONTEXT_ATTR_NAME)).thenReturn(securityContext);
  this.listener.beforeTestExecution(this.testContext);
  assertThat(TestSecurityContextHolder.getContext().getAuthentication()).isEqualTo(securityContext.getAuthentication());
}
