@Test public void userServiceReturnsExpectedData() throws Exception {
  setContext("<ldap-user-service id='ldapUDS' user-search-filter='(uid={0})' group-search-filter='member={0}' /><ldap-server ldif='classpath:test-server.ldif'/>");
  UserDetailsService uds=(UserDetailsService)appCtx.getBean("ldapUDS");
  UserDetails ben=uds.loadUserByUsername("ben");
  Set<String> authorities=AuthorityUtils.authorityListToSet(ben.getAuthorities());
  assertThat(authorities).hasSize(3);
  assertThat(authorities.contains("ROLE_DEVELOPERS")).isTrue();
}
