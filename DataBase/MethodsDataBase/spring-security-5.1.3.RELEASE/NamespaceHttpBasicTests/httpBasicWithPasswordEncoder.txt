@Test public void httpBasicWithPasswordEncoder() throws Exception {
  loadContext("<http>\n" + "		<intercept-url pattern=\"/**\" access=\"hasRole('USER')\" />\n" + "		<http-basic />\n"+ "	</http>\n"+ "\n"+ "	<authentication-manager id=\"authenticationManager\">\n"+ "		<authentication-provider>\n"+ "			<password-encoder ref=\"passwordEncoder\" />\n"+ "			<user-service>\n"+ "				<user name=\"user\" password=\"$2a$10$Zk1MxFEt7YYji4Ccy9xlfuewWzUMsmHZfy4UcCmNKVV6z5i/JNGJW\" authorities=\"ROLE_USER\"/>\n"+ "			</user-service>\n"+ "		</authentication-provider>\n"+ "	</authentication-manager>\n"+ "	<b:bean id=\"passwordEncoder\"\n"+ "		class=\"org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder\" />");
  this.request.addHeader("Authorization","Basic " + Base64.getEncoder().encodeToString("user:test".getBytes("UTF-8")));
  this.springSecurityFilterChain.doFilter(this.request,this.response,this.chain);
  assertThat(this.response.getStatus()).isEqualTo(HttpServletResponse.SC_OK);
}
