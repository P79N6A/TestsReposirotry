/** 
 * This test starts an LDAP server using LDAPs (LDAP over SSL). A self-signed certificate is being used, which was previously generated with: <pre> {@code keytool -genkey -alias spring -keyalg RSA -keystore spring.keystore -validity 3650 -storetype JKS \ -dname "CN=localhost, OU=Spring, O=Pivotal, L=Kailua-Kona, ST=HI, C=US" -keypass spring -storepass spring}</pre>
 * @throws Exception
 */
@Test public void startWithLdapOverSsl() throws Exception {
  final ClassPathResource keyStoreResource=new ClassPathResource("/org/springframework/security/ldap/server/spring.keystore");
  final File temporaryKeyStoreFile=new File(temporaryFolder.getRoot(),"spring.keystore");
  FileCopyUtils.copy(keyStoreResource.getInputStream(),new FileOutputStream(temporaryKeyStoreFile));
  assertThat(temporaryKeyStoreFile).isFile();
  ApacheDSContainer server=new ApacheDSContainer("dc=springframework,dc=org","classpath:test-server.ldif");
  List<Integer> ports=getDefaultPorts(1);
  server.setPort(ports.get(0));
  server.setLdapOverSslEnabled(true);
  server.setKeyStoreFile(temporaryKeyStoreFile);
  server.setCertificatePassord("spring");
  try {
    server.afterPropertiesSet();
  }
  finally {
    try {
      server.destroy();
    }
 catch (    Throwable t) {
    }
  }
}
