@Test public void startWithLdapOverSslWithWrongPassword() throws Exception {
  final ClassPathResource keyStoreResource=new ClassPathResource("/org/springframework/security/ldap/server/spring.keystore");
  final File temporaryKeyStoreFile=new File(temporaryFolder.getRoot(),"spring.keystore");
  FileCopyUtils.copy(keyStoreResource.getInputStream(),new FileOutputStream(temporaryKeyStoreFile));
  assertThat(temporaryKeyStoreFile).isFile();
  ApacheDSContainer server=new ApacheDSContainer("dc=springframework,dc=org","classpath:test-server.ldif");
  List<Integer> ports=getDefaultPorts(1);
  server.setPort(ports.get(0));
  server.setLdapOverSslEnabled(true);
  server.setKeyStoreFile(temporaryKeyStoreFile);
  server.setCertificatePassord("incorrect-password");
  try {
    server.afterPropertiesSet();
    fail("Expected a RuntimeException to be thrown.");
  }
 catch (  RuntimeException e) {
    assertThat(e).hasMessage("Server startup failed");
    assertThat(e).hasRootCauseInstanceOf(UnrecoverableKeyException.class);
  }
}
