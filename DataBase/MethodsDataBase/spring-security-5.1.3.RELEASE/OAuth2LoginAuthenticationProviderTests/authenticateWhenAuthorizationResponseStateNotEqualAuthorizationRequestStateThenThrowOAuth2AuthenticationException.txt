@Test public void authenticateWhenAuthorizationResponseStateNotEqualAuthorizationRequestStateThenThrowOAuth2AuthenticationException(){
  this.exception.expect(OAuth2AuthenticationException.class);
  this.exception.expectMessage(containsString("invalid_state_parameter"));
  when(this.authorizationRequest.getState()).thenReturn("12345");
  when(this.authorizationResponse.getState()).thenReturn("67890");
  this.authenticationProvider.authenticate(new OAuth2LoginAuthenticationToken(this.clientRegistration,this.authorizationExchange));
}
