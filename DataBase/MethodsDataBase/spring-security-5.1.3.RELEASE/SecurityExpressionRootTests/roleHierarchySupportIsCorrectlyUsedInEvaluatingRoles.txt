@Test public void roleHierarchySupportIsCorrectlyUsedInEvaluatingRoles() throws Exception {
  root.setRoleHierarchy(new RoleHierarchy(){
    public Collection<GrantedAuthority> getReachableGrantedAuthorities(    Collection<? extends GrantedAuthority> authorities){
      return AuthorityUtils.createAuthorityList("ROLE_C");
    }
  }
);
  assertThat(root.hasRole("C")).isTrue();
  assertThat(root.hasAuthority("ROLE_C")).isTrue();
  assertThat(root.hasRole("A")).isFalse();
  assertThat(root.hasRole("B")).isFalse();
  assertThat(root.hasAnyRole("C","A","B")).isTrue();
  assertThat(root.hasAnyAuthority("ROLE_C","ROLE_A","ROLE_B")).isTrue();
  assertThat(root.hasAnyRole("A","B")).isFalse();
}
