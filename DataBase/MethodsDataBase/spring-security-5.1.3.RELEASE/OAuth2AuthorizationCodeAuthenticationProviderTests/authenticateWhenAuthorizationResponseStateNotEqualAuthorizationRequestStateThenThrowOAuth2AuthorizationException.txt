@Test public void authenticateWhenAuthorizationResponseStateNotEqualAuthorizationRequestStateThenThrowOAuth2AuthorizationException(){
  when(this.authorizationRequest.getState()).thenReturn("12345");
  when(this.authorizationResponse.getState()).thenReturn("67890");
  assertThatThrownBy(() -> {
    this.authenticationProvider.authenticate(new OAuth2AuthorizationCodeAuthenticationToken(this.clientRegistration,this.authorizationExchange));
  }
).isInstanceOf(OAuth2AuthorizationException.class).hasMessageContaining("invalid_state_parameter");
}
