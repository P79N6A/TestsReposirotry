@Test public final void authenticateKnownUser() throws Exception {
  UserDetails ud=new User("dummyUser","dummyPwd",true,true,true,true,AuthorityUtils.NO_AUTHORITIES);
  PreAuthenticatedAuthenticationProvider provider=getProvider(ud);
  Authentication request=new PreAuthenticatedAuthenticationToken("dummyUser","dummyPwd");
  Authentication result=provider.authenticate(request);
  assertThat(result).isNotNull();
  assertThat(ud).isEqualTo(result.getPrincipal());
}
