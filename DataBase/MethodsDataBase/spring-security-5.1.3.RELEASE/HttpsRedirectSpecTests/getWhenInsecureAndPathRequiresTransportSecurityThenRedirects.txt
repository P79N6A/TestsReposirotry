@Test public void getWhenInsecureAndPathRequiresTransportSecurityThenRedirects(){
  this.spring.register(SometimesRedirectToHttpsConfig.class).autowire();
  this.client.get().uri("http://localhost:8080").exchange().expectStatus().isNotFound();
  this.client.get().uri("http://localhost:8080/secure").exchange().expectStatus().isFound().expectHeader().valueEquals(HttpHeaders.LOCATION,"https://localhost:8443/secure");
}
