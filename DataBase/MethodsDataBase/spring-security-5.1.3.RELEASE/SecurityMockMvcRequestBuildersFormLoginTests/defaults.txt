@Test public void defaults() throws Exception {
  MockHttpServletRequest request=formLogin().buildRequest(this.servletContext);
  CsrfToken token=(CsrfToken)request.getAttribute(CsrfRequestPostProcessor.TestCsrfTokenRepository.TOKEN_ATTR_NAME);
  assertThat(request.getParameter("username")).isEqualTo("user");
  assertThat(request.getParameter("password")).isEqualTo("password");
  assertThat(request.getMethod()).isEqualTo("POST");
  assertThat(request.getParameter(token.getParameterName())).isEqualTo(token.getToken());
  assertThat(request.getRequestURI()).isEqualTo("/login");
  assertThat(request.getParameter("_csrf")).isNotNull();
}
