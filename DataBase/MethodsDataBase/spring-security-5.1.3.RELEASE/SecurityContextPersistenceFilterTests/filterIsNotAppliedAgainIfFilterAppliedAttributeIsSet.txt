@Test public void filterIsNotAppliedAgainIfFilterAppliedAttributeIsSet() throws Exception {
  final FilterChain chain=mock(FilterChain.class);
  final MockHttpServletRequest request=new MockHttpServletRequest();
  final MockHttpServletResponse response=new MockHttpServletResponse();
  SecurityContextPersistenceFilter filter=new SecurityContextPersistenceFilter(mock(SecurityContextRepository.class));
  request.setAttribute(SecurityContextPersistenceFilter.FILTER_APPLIED,Boolean.TRUE);
  filter.doFilter(request,response,chain);
  verify(chain).doFilter(request,response);
}
