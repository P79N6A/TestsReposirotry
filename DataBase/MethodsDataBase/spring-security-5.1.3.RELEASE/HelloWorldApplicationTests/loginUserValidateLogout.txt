@Test public void loginUserValidateLogout() throws Exception {
  MvcResult mvcResult=this.mockMvc.perform(formLogin().user("user").password("password")).andExpect(authenticated()).andReturn();
  MockHttpSession httpSession=(MockHttpSession)mvcResult.getRequest().getSession(false);
  this.mockMvc.perform(post("/logout").with(csrf()).session(httpSession)).andExpect(unauthenticated());
  this.mockMvc.perform(get("/user/index").session(httpSession)).andExpect(unauthenticated()).andExpect(status().is3xxRedirection());
}
