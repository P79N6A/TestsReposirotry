@Test public void loginUserAccessProtected() throws Exception {
  MvcResult mvcResult=this.mockMvc.perform(formLogin().user("user").password("password")).andExpect(authenticated()).andReturn();
  MockHttpSession httpSession=(MockHttpSession)mvcResult.getRequest().getSession(false);
  this.mockMvc.perform(get("/user/index").session(httpSession)).andExpect(status().isOk());
}
