@Test public void filterWhenDefaultsAndAuthenticationFailThenUnauthorized(){
  when(this.authenticationManager.authenticate(any())).thenReturn(Mono.error(new BadCredentialsException("failed")));
  this.filter=new AuthenticationWebFilter(this.authenticationManager);
  WebTestClient client=WebTestClientBuilder.bindToWebFilters(this.filter).build();
  EntityExchangeResult<Void> result=client.get().uri("/").headers(headers -> headers.setBasicAuth("test","this")).exchange().expectStatus().isUnauthorized().expectHeader().valueMatches("WWW-Authenticate","Basic realm=\"Realm\"").expectBody().isEmpty();
  assertThat(result.getResponseCookies()).isEmpty();
}
