@Test public void nullPreAuthenticationClearsPreviousUser() throws Exception {
  SecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("oldUser","pass","ROLE_USER"));
  ConcretePreAuthenticatedProcessingFilter filter=new ConcretePreAuthenticatedProcessingFilter();
  filter.principal=null;
  filter.setCheckForPrincipalChanges(true);
  filter.doFilter(new MockHttpServletRequest(),new MockHttpServletResponse(),new MockFilterChain());
  assertThat(SecurityContextHolder.getContext().getAuthentication()).isNull();
}
