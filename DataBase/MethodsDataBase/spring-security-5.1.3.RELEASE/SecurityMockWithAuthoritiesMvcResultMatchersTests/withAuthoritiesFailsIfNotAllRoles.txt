@Test(expected=AssertionError.class) public void withAuthoritiesFailsIfNotAllRoles() throws Exception {
  List<SimpleGrantedAuthority> grantedAuthorities=new ArrayList<>();
  grantedAuthorities.add(new SimpleGrantedAuthority("ROLE_ADMIN"));
  mockMvc.perform(formLogin()).andExpect(authenticated().withAuthorities(grantedAuthorities));
}
