@Test public void testDoesNotReturnAdditionalAuthoritiesIfCalledWithoutARunAsSetting() throws Exception {
  UsernamePasswordAuthenticationToken inputToken=new UsernamePasswordAuthenticationToken("Test","Password",AuthorityUtils.createAuthorityList("ROLE_ONE","ROLE_TWO"));
  RunAsManagerImpl runAs=new RunAsManagerImpl();
  runAs.setKey("my_password");
  Authentication resultingToken=runAs.buildRunAs(inputToken,new Object(),SecurityConfig.createList("SOMETHING_WE_IGNORE"));
  assertThat(resultingToken).isNull();
}
