@Test public void csrfWhenUsedThenDoesNotImpactOriginalRepository() throws Exception {
  this.mockMvc.perform(post("/").with(csrf()));
  MockHttpServletRequest request=new MockHttpServletRequest();
  HttpSessionCsrfTokenRepository repo=new HttpSessionCsrfTokenRepository();
  CsrfToken token=repo.generateToken(request);
  repo.saveToken(token,request,new MockHttpServletResponse());
  MockHttpServletRequestBuilder requestWithCsrf=post("/").param(token.getParameterName(),token.getToken()).session((MockHttpSession)request.getSession());
  this.mockMvc.perform(requestWithCsrf).andExpect(status().isOk());
}
