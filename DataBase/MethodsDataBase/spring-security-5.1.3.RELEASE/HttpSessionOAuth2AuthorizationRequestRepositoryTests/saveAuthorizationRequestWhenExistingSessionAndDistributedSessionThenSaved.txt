@Test public void saveAuthorizationRequestWhenExistingSessionAndDistributedSessionThenSaved(){
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setSession(new MockDistributedHttpSession());
  OAuth2AuthorizationRequest authorizationRequest1=createAuthorizationRequest().build();
  this.authorizationRequestRepository.saveAuthorizationRequest(authorizationRequest1,request,new MockHttpServletResponse());
  OAuth2AuthorizationRequest authorizationRequest2=createAuthorizationRequest().build();
  this.authorizationRequestRepository.saveAuthorizationRequest(authorizationRequest2,request,new MockHttpServletResponse());
  request.addParameter(OAuth2ParameterNames.STATE,authorizationRequest2.getState());
  OAuth2AuthorizationRequest loadedAuthorizationRequest=this.authorizationRequestRepository.loadAuthorizationRequest(request);
  assertThat(loadedAuthorizationRequest).isEqualTo(authorizationRequest2);
}
