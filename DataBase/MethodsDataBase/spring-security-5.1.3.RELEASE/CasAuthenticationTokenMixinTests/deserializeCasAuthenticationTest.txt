@Test public void deserializeCasAuthenticationTest() throws IOException, JSONException {
  CasAuthenticationToken token=mapper.readValue(CAS_TOKEN_JSON,CasAuthenticationToken.class);
  assertThat(token).isNotNull();
  assertThat(token.getPrincipal()).isNotNull().isInstanceOf(User.class);
  assertThat(((User)token.getPrincipal()).getUsername()).isEqualTo("admin");
  assertThat(((User)token.getPrincipal()).getPassword()).isEqualTo("1234");
  assertThat(token.getUserDetails()).isNotNull().isInstanceOf(User.class);
  assertThat(token.getAssertion()).isNotNull().isInstanceOf(AssertionImpl.class);
  assertThat(token.getKeyHash()).isEqualTo(KEY.hashCode());
  assertThat(token.getUserDetails().getAuthorities()).extracting(GrantedAuthority::getAuthority).containsOnly("ROLE_USER");
  assertThat(token.getAssertion().getAuthenticationDate()).isEqualTo(START_DATE);
  assertThat(token.getAssertion().getValidFromDate()).isEqualTo(START_DATE);
  assertThat(token.getAssertion().getValidUntilDate()).isEqualTo(END_DATE);
  assertThat(token.getAssertion().getPrincipal().getName()).isEqualTo("assertName");
  assertThat(token.getAssertion().getAttributes()).hasSize(0);
}
