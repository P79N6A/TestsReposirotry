@Test public void constructorAuthorizationRequestResponseWhenAllParametersProvidedAndValidThenCreated(){
  OAuth2AuthorizationResponse authorizationResponse=mock(OAuth2AuthorizationResponse.class);
  when(authorizationResponse.getCode()).thenReturn("code");
  when(this.authorizationExchange.getAuthorizationResponse()).thenReturn(authorizationResponse);
  OAuth2AuthorizationCodeAuthenticationToken authentication=new OAuth2AuthorizationCodeAuthenticationToken(this.clientRegistration,this.authorizationExchange);
  assertThat(authentication.getPrincipal()).isEqualTo(this.clientRegistration.getClientId());
  assertThat(authentication.getCredentials()).isEqualTo(this.authorizationExchange.getAuthorizationResponse().getCode());
  assertThat(authentication.getAuthorities()).isEqualTo(Collections.emptyList());
  assertThat(authentication.getClientRegistration()).isEqualTo(this.clientRegistration);
  assertThat(authentication.getAuthorizationExchange()).isEqualTo(this.authorizationExchange);
  assertThat(authentication.getAccessToken()).isNull();
  assertThat(authentication.isAuthenticated()).isEqualTo(false);
}
