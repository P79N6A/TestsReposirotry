@Test public void testAuthenticateError(){
  OpenIDAuthenticationProvider provider=new OpenIDAuthenticationProvider();
  provider.setUserDetailsService(new MockUserDetailsService());
  Authentication preAuth=new OpenIDAuthenticationToken(OpenIDAuthenticationStatus.ERROR,USERNAME,"",null);
  assertThat(preAuth.isAuthenticated()).isFalse();
  try {
    provider.authenticate(preAuth);
    fail("Should throw an AuthenticationException");
  }
 catch (  AuthenticationServiceException expected) {
    assertThat(expected.getMessage()).isEqualTo("Error message from server: ");
  }
}
