@Test public void onlySavedRequestAttributeIsMigratedIfMigrateAttributesIsFalse() throws Exception {
  SessionFixationProtectionStrategy strategy=new SessionFixationProtectionStrategy();
  strategy.setMigrateSessionAttributes(false);
  HttpServletRequest request=new MockHttpServletRequest();
  HttpSession session=request.getSession();
  session.setAttribute("blah","blah");
  session.setAttribute("SPRING_SECURITY_SAVED_REQUEST_KEY","DefaultSavedRequest");
  strategy.onAuthentication(mock(Authentication.class),request,new MockHttpServletResponse());
  assertThat(request.getSession().getAttribute("blah")).isNull();
  assertThat(request.getSession().getAttribute("SPRING_SECURITY_SAVED_REQUEST_KEY")).isNotNull();
}
