@Test public void returnsEmptyListIfDelegateReturnsNull() throws Exception {
  List sources=new ArrayList();
  MethodSecurityMetadataSource delegate=mock(MethodSecurityMetadataSource.class);
  when(delegate.getAttributes(Matchers.<Method>any(),Matchers.any(Class.class))).thenReturn(null);
  sources.add(delegate);
  mds=new DelegatingMethodSecurityMetadataSource(sources);
  assertThat(mds.getMethodSecurityMetadataSources()).isSameAs(sources);
  assertThat(mds.getAllConfigAttributes().isEmpty()).isTrue();
  MethodInvocation mi=new SimpleMethodInvocation(null,String.class.getMethod("toString"));
  assertThat(mds.getAttributes(mi)).isEqualTo(Collections.emptyList());
  assertThat(mds.getAttributes(mi)).isEqualTo(Collections.emptyList());
}
