@Test public void oauth2LoginWhenSuccessThenAuthenticationSuccessEventPublished() throws Exception {
  loadConfig(OAuth2LoginConfig.class);
  OAuth2AuthorizationRequest authorizationRequest=createOAuth2AuthorizationRequest();
  this.authorizationRequestRepository.saveAuthorizationRequest(authorizationRequest,this.request,this.response);
  this.request.setParameter("code","code123");
  this.request.setParameter("state",authorizationRequest.getState());
  this.springSecurityFilterChain.doFilter(this.request,this.response,this.filterChain);
  assertThat(OAuth2LoginConfig.EVENTS).isNotEmpty();
  assertThat(OAuth2LoginConfig.EVENTS).hasSize(1);
  assertThat(OAuth2LoginConfig.EVENTS.get(0)).isInstanceOf(AuthenticationSuccessEvent.class);
}
