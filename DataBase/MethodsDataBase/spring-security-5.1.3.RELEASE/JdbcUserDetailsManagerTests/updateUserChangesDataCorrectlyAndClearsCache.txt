@Test public void updateUserChangesDataCorrectlyAndClearsCache(){
  insertJoe();
  User newJoe=new User("joe","newpassword",false,true,true,true,AuthorityUtils.createAuthorityList(new String[]{"D","F","E"}));
  manager.updateUser(newJoe);
  UserDetails joe=manager.loadUserByUsername("joe");
  assertThat(joe).isEqualTo(newJoe);
  assertThat(cache.getUserMap().containsKey("joe")).isFalse();
}
