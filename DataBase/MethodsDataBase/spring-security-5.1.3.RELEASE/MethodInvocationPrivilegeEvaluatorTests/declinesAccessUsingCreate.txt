@Test public void declinesAccessUsingCreate() throws Exception {
  Object object=new TargetObject();
  final MethodInvocation mi=MethodInvocationUtils.create(object,"makeLowerCase","foobar");
  MethodInvocationPrivilegeEvaluator mipe=new MethodInvocationPrivilegeEvaluator();
  mipe.setSecurityInterceptor(interceptor);
  when(mds.getAttributes(mi)).thenReturn(role);
  doThrow(new AccessDeniedException("rejected")).when(adm).decide(token,mi,role);
  assertThat(mipe.isAllowed(mi,token)).isFalse();
}
