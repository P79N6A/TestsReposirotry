@Test public void declinesAccessUsingCreateFromClass() throws Exception {
  final MethodInvocation mi=MethodInvocationUtils.createFromClass(new OtherTargetObject(),ITargetObject.class,"makeLowerCase",new Class[]{String.class},new Object[]{"helloWorld"});
  MethodInvocationPrivilegeEvaluator mipe=new MethodInvocationPrivilegeEvaluator();
  mipe.setSecurityInterceptor(interceptor);
  when(mds.getAttributes(mi)).thenReturn(role);
  doThrow(new AccessDeniedException("rejected")).when(adm).decide(token,mi,role);
  assertThat(mipe.isAllowed(mi,token)).isFalse();
}
