@Test public void autoLoginClearsCookieIfSignatureBlocksDoesNotMatchExpectedValue() throws Exception {
  udsWillReturnUser();
  Cookie cookie=new Cookie(SPRING_SECURITY_REMEMBER_ME_COOKIE_KEY,generateCorrectCookieContentForToken(System.currentTimeMillis() + 1000000,"someone","password","WRONG_KEY"));
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setCookies(cookie);
  MockHttpServletResponse response=new MockHttpServletResponse();
  assertThat(services.autoLogin(request,response)).isNull();
  Cookie returnedCookie=response.getCookie(SPRING_SECURITY_REMEMBER_ME_COOKIE_KEY);
  assertThat(returnedCookie).isNotNull();
  assertThat(returnedCookie.getMaxAge()).isZero();
}
