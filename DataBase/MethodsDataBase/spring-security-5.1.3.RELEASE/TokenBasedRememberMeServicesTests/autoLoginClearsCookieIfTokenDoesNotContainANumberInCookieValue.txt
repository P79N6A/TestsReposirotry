@Test public void autoLoginClearsCookieIfTokenDoesNotContainANumberInCookieValue() throws Exception {
  Cookie cookie=new Cookie(SPRING_SECURITY_REMEMBER_ME_COOKIE_KEY,new String(Base64.encodeBase64("username:NOT_A_NUMBER:signature".getBytes())));
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setCookies(cookie);
  MockHttpServletResponse response=new MockHttpServletResponse();
  assertThat(services.autoLogin(request,response)).isNull();
  Cookie returnedCookie=response.getCookie(SPRING_SECURITY_REMEMBER_ME_COOKIE_KEY);
  assertThat(returnedCookie).isNotNull();
  assertThat(returnedCookie.getMaxAge()).isZero();
}
