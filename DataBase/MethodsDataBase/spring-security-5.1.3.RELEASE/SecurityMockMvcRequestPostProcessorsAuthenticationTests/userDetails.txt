@Test public void userDetails(){
  authentication(authentication).postProcessRequest(request);
  verify(repository).saveContext(contextCaptor.capture(),eq(request),any(HttpServletResponse.class));
  SecurityContext context=contextCaptor.getValue();
  assertThat(context.getAuthentication()).isSameAs(authentication);
}
