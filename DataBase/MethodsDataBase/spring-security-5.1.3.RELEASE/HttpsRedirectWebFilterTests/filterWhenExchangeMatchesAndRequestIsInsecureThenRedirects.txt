@Test public void filterWhenExchangeMatchesAndRequestIsInsecureThenRedirects(){
  ServerWebExchangeMatcher matcher=mock(ServerWebExchangeMatcher.class);
  when(matcher.matches(any(ServerWebExchange.class))).thenReturn(ServerWebExchangeMatcher.MatchResult.match());
  this.filter.setRequiresHttpsRedirectMatcher(matcher);
  ServerWebExchange exchange=get("http://localhost:8080");
  this.filter.filter(exchange,this.chain).block();
  assertThat(statusCode(exchange)).isEqualTo(302);
  assertThat(redirectedUrl(exchange)).isEqualTo("https://localhost:8443");
  verify(matcher).matches(any(ServerWebExchange.class));
}
