@Test public void maxSessionsExpireLeastRecentExistingUser(){
  SessionInformation moreRecentSessionInfo=new SessionInformation(authentication.getPrincipal(),"unique",new Date(1374766999999L));
  when(sessionRegistry.getAllSessions(any(),anyBoolean())).thenReturn(Arrays.<SessionInformation>asList(moreRecentSessionInfo,sessionInformation));
  strategy.setMaximumSessions(2);
  strategy.onAuthentication(authentication,request,response);
  assertThat(sessionInformation.isExpired()).isTrue();
}
