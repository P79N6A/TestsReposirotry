@Test public void constructorWhenUsingCorrectParametersThenConstructedCorrectly(){
  Collection authorities=Arrays.asList(new SimpleGrantedAuthority("test"));
  Map claims=Maps.newHashMap("claim","value");
  Jwt jwt=this.jwt(claims);
  JwtAuthenticationToken token=new JwtAuthenticationToken(jwt,authorities);
  assertThat(token.getAuthorities()).isEqualTo(authorities);
  assertThat(token.getPrincipal()).isEqualTo(jwt);
  assertThat(token.getCredentials()).isEqualTo(jwt);
  assertThat(token.getToken()).isEqualTo(jwt);
  assertThat(token.getTokenAttributes()).isEqualTo(claims);
  assertThat(token.isAuthenticated()).isTrue();
}
