@Test public void filterWhenNotCompleteThenNotWritten(){
  WebTestHandler handler=WebTestHandler.bindToWebFilters(filter);
  WebHandlerResult result=handler.exchange(MockServerHttpRequest.get("/foo"));
  verify(writer,never()).writeHttpHeaders(any());
  result.getExchange().getResponse().setComplete();
  verify(writer).writeHttpHeaders(any());
}
