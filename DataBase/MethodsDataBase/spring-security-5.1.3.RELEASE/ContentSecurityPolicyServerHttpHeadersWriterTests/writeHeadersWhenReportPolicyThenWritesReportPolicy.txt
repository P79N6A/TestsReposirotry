@Test public void writeHeadersWhenReportPolicyThenWritesReportPolicy(){
  this.writer.setPolicyDirectives(DEFAULT_POLICY_DIRECTIVES);
  this.writer.setReportOnly(true);
  this.writer.writeHttpHeaders(this.exchange);
  HttpHeaders headers=this.exchange.getResponse().getHeaders();
  assertThat(headers).hasSize(1);
  assertThat(headers.get(ContentSecurityPolicyServerHttpHeadersWriter.CONTENT_SECURITY_POLICY_REPORT_ONLY)).containsOnly(DEFAULT_POLICY_DIRECTIVES);
}
