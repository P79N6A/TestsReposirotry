@Test public void extraRolesAreAdded() throws Exception {
  populator=new DefaultLdapAuthoritiesPopulator(getContextSource(),null){
    @Override protected Set<GrantedAuthority> getAdditionalRoles(    DirContextOperations user,    String username){
      return new HashSet<>(AuthorityUtils.createAuthorityList("ROLE_EXTRA"));
    }
  }
;
  Collection<GrantedAuthority> authorities=populator.getGrantedAuthorities(new DirContextAdapter(new DistinguishedName("cn=notused")),"notused");
  assertThat(authorities).hasSize(1);
  assertThat(AuthorityUtils.authorityListToSet(authorities).contains("ROLE_EXTRA")).isTrue();
}
