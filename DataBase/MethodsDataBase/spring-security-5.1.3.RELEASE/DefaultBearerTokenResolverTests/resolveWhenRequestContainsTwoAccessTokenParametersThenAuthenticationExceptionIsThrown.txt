@Test public void resolveWhenRequestContainsTwoAccessTokenParametersThenAuthenticationExceptionIsThrown(){
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.addParameter("access_token","token1","token2");
  assertThatCode(() -> this.resolver.resolve(request)).isInstanceOf(OAuth2AuthenticationException.class).hasMessageContaining("Found multiple bearer tokens in the request");
}
