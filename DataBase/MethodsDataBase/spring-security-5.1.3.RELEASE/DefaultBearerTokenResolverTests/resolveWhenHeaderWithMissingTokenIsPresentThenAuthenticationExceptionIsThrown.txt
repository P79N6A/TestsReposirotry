@Test public void resolveWhenHeaderWithMissingTokenIsPresentThenAuthenticationExceptionIsThrown(){
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.addHeader("Authorization","Bearer ");
  assertThatCode(() -> this.resolver.resolve(request)).isInstanceOf(OAuth2AuthenticationException.class).hasMessageContaining(("Bearer token is malformed"));
}
