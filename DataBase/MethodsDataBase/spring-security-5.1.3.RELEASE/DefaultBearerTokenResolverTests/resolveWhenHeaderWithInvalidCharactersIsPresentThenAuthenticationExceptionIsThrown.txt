@Test public void resolveWhenHeaderWithInvalidCharactersIsPresentThenAuthenticationExceptionIsThrown(){
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.addHeader("Authorization","Bearer an\"invalid\"token");
  assertThatCode(() -> this.resolver.resolve(request)).isInstanceOf(OAuth2AuthenticationException.class).hasMessageContaining(("Bearer token is malformed"));
}
