@Test public void resolveWhenValidHeaderIsPresentTogetherWithFormParameterThenAuthenticationExceptionIsThrown(){
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.addHeader("Authorization","Bearer " + TEST_TOKEN);
  request.setMethod("POST");
  request.setContentType("application/x-www-form-urlencoded");
  request.addParameter("access_token",TEST_TOKEN);
  assertThatCode(() -> this.resolver.resolve(request)).isInstanceOf(OAuth2AuthenticationException.class).hasMessageContaining("Found multiple bearer tokens in the request");
}
