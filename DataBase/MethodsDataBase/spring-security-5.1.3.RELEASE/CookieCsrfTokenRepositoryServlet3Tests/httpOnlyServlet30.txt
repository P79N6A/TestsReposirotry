@Test public void httpOnlyServlet30() throws Exception {
  spy(ReflectionUtils.class);
  when(ReflectionUtils.findMethod(Cookie.class,"setHttpOnly",boolean.class)).thenReturn(this.method);
  HttpServletRequest request=mock(HttpServletRequest.class);
  when(request.getContextPath()).thenReturn("/contextpath");
  HttpServletResponse response=mock(HttpServletResponse.class);
  ArgumentCaptor<Cookie> cookie=ArgumentCaptor.forClass(Cookie.class);
  CookieCsrfTokenRepository repository=new CookieCsrfTokenRepository();
  CsrfToken token=repository.generateToken(request);
  repository.saveToken(token,request,response);
  verify(response).addCookie(cookie.capture());
  verifyStatic(ReflectionUtils.class);
  ReflectionUtils.invokeMethod(same(this.method),eq(cookie.getValue()),eq(true));
}
