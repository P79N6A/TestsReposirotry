@Test public void traverseWrappedRequests(){
  HttpSessionSecurityContextRepository repo=new HttpSessionSecurityContextRepository();
  MockHttpServletRequest request=new MockHttpServletRequest();
  MockHttpServletResponse response=new MockHttpServletResponse();
  HttpRequestResponseHolder holder=new HttpRequestResponseHolder(request,response);
  SecurityContext context=repo.loadContext(holder);
  assertThat(request.getSession(false)).isNull();
  context.setAuthentication(testToken);
  repo.saveContext(context,new HttpServletRequestWrapper(holder.getRequest()),new HttpServletResponseWrapper(holder.getResponse()));
  assertThat(request.getSession(false)).isNotNull();
  assertThat(request.getSession().getAttribute(SPRING_SECURITY_CONTEXT_KEY)).isEqualTo(context);
}
