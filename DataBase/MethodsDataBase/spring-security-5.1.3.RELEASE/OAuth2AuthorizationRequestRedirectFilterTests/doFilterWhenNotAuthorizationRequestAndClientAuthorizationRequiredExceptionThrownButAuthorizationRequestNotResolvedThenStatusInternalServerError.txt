@Test public void doFilterWhenNotAuthorizationRequestAndClientAuthorizationRequiredExceptionThrownButAuthorizationRequestNotResolvedThenStatusInternalServerError() throws Exception {
  String requestUri="/path";
  MockHttpServletRequest request=new MockHttpServletRequest("GET",requestUri);
  request.setServletPath(requestUri);
  MockHttpServletResponse response=new MockHttpServletResponse();
  FilterChain filterChain=mock(FilterChain.class);
  doThrow(new ClientAuthorizationRequiredException(this.registration1.getRegistrationId())).when(filterChain).doFilter(any(ServletRequest.class),any(ServletResponse.class));
  OAuth2AuthorizationRequestResolver resolver=mock(OAuth2AuthorizationRequestResolver.class);
  OAuth2AuthorizationRequestRedirectFilter filter=new OAuth2AuthorizationRequestRedirectFilter(resolver);
  filter.doFilter(request,response,filterChain);
  verify(filterChain).doFilter(any(HttpServletRequest.class),any(HttpServletResponse.class));
  verifyZeroInteractions(filterChain);
  assertThat(response.getStatus()).isEqualTo(HttpStatus.INTERNAL_SERVER_ERROR.value());
  assertThat(response.getErrorMessage()).isEqualTo(HttpStatus.INTERNAL_SERVER_ERROR.getReasonPhrase());
}
