@Test public void getWhenBookmarkedRequestIsXRequestedWithThenPostAuthenticationRedirectsToRoot() throws Exception {
  this.spring.register(RequestCacheDefaultsConfig.class,DefaultSecurityConfig.class).autowire();
  MockHttpSession session=(MockHttpSession)this.mvc.perform(get("/messages").header("X-Requested-With","XMLHttpRequest")).andExpect(redirectedUrl("http://localhost/login")).andReturn().getRequest().getSession();
  this.mvc.perform(formLogin(session)).andExpect(redirectedUrl("/"));
}
