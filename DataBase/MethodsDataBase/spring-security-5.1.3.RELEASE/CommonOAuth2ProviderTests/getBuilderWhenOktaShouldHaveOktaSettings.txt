@Test public void getBuilderWhenOktaShouldHaveOktaSettings() throws Exception {
  ClientRegistration registration=builder(CommonOAuth2Provider.OKTA).authorizationUri("http://example.com/auth").tokenUri("http://example.com/token").userInfoUri("http://example.com/info").jwkSetUri("http://example.com/jwkset").build();
  ProviderDetails providerDetails=registration.getProviderDetails();
  assertThat(providerDetails.getAuthorizationUri()).isEqualTo("http://example.com/auth");
  assertThat(providerDetails.getTokenUri()).isEqualTo("http://example.com/token");
  assertThat(providerDetails.getUserInfoEndpoint().getUri()).isEqualTo("http://example.com/info");
  assertThat(providerDetails.getUserInfoEndpoint().getUserNameAttributeName()).isEqualTo(IdTokenClaimNames.SUB);
  assertThat(providerDetails.getJwkSetUri()).isEqualTo("http://example.com/jwkset");
  assertThat(registration.getClientAuthenticationMethod()).isEqualTo(ClientAuthenticationMethod.BASIC);
  assertThat(registration.getAuthorizationGrantType()).isEqualTo(AuthorizationGrantType.AUTHORIZATION_CODE);
  assertThat(registration.getRedirectUriTemplate()).isEqualTo(DEFAULT_REDIRECT_URL);
  assertThat(registration.getScopes()).containsOnly("openid","profile","email");
  assertThat(registration.getClientName()).isEqualTo("Okta");
  assertThat(registration.getRegistrationId()).isEqualTo("123");
}
