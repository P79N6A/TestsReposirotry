@Test public void checkWhenHasAuthorityAndAuthenticatedAndNoAuthoritiesThenReturnFalse(){
  when(authentication.isAuthenticated()).thenReturn(true);
  when(authentication.getAuthorities()).thenReturn(Collections.emptyList());
  boolean granted=manager.check(Mono.just(authentication),null).block().isGranted();
  assertThat(granted).isFalse();
}
