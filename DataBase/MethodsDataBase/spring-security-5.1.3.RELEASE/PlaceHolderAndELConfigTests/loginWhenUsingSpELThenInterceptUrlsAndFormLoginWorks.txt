/** 
 * SEC-1309
 */
@Test public void loginWhenUsingSpELThenInterceptUrlsAndFormLoginWorks() throws Exception {
  System.setProperty("secure.url","/secured");
  System.setProperty("secure.role","ROLE_NUNYA");
  System.setProperty("login.page","/loginPage");
  System.setProperty("default.target","/defaultTarget");
  System.setProperty("auth.failure","/authFailure");
  this.spring.configLocations(this.xml("InterceptUrlAndFormLoginWithSpEL")).autowire();
  this.mvc.perform(get("/secured")).andExpect(redirectedUrl("http://localhost/loginPage"));
  this.mvc.perform(post("/loginPage").param("username","user").param("password","password")).andExpect(redirectedUrl("/defaultTarget"));
  this.mvc.perform(post("/loginPage").param("username","user").param("password","wrong")).andExpect(redirectedUrl("/authFailure"));
}
