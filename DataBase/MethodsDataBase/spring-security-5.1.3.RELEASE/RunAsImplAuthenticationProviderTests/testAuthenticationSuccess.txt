@Test public void testAuthenticationSuccess(){
  RunAsUserToken token=new RunAsUserToken("my_password","Test","Password",AuthorityUtils.createAuthorityList("ROLE_ONE","ROLE_TWO"),UsernamePasswordAuthenticationToken.class);
  RunAsImplAuthenticationProvider provider=new RunAsImplAuthenticationProvider();
  provider.setKey("my_password");
  Authentication result=provider.authenticate(token);
  Assert.assertTrue("Should have returned RunAsUserToken",result instanceof RunAsUserToken);
  RunAsUserToken resultCast=(RunAsUserToken)result;
  assertThat(resultCast.getKeyHash()).isEqualTo("my_password".hashCode());
}
