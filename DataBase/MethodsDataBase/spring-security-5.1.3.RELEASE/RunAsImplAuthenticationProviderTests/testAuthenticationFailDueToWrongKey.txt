@Test(expected=BadCredentialsException.class) public void testAuthenticationFailDueToWrongKey(){
  RunAsUserToken token=new RunAsUserToken("wrong_key","Test","Password",AuthorityUtils.createAuthorityList("ROLE_ONE","ROLE_TWO"),UsernamePasswordAuthenticationToken.class);
  RunAsImplAuthenticationProvider provider=new RunAsImplAuthenticationProvider();
  provider.setKey("hello_world");
  provider.authenticate(token);
}
