@Test public void testOperationWhenAuthenticationExistsInContextHolder() throws Exception {
  Authentication originalAuth=new TestingAuthenticationToken("user","password","ROLE_A");
  SecurityContextHolder.getContext().setAuthentication(originalAuth);
  RememberMeAuthenticationFilter filter=new RememberMeAuthenticationFilter(mock(AuthenticationManager.class),new MockRememberMeServices(remembered));
  filter.afterPropertiesSet();
  MockHttpServletRequest request=new MockHttpServletRequest();
  FilterChain fc=mock(FilterChain.class);
  request.setRequestURI("x");
  filter.doFilter(request,new MockHttpServletResponse(),fc);
  assertThat(SecurityContextHolder.getContext().getAuthentication()).isSameAs(originalAuth);
  verify(fc).doFilter(any(HttpServletRequest.class),any(HttpServletResponse.class));
}
