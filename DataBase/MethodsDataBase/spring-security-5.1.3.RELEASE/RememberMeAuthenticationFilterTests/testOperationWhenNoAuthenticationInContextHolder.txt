@Test public void testOperationWhenNoAuthenticationInContextHolder() throws Exception {
  AuthenticationManager am=mock(AuthenticationManager.class);
  when(am.authenticate(remembered)).thenReturn(remembered);
  RememberMeAuthenticationFilter filter=new RememberMeAuthenticationFilter(am,new MockRememberMeServices(remembered));
  filter.afterPropertiesSet();
  MockHttpServletRequest request=new MockHttpServletRequest();
  FilterChain fc=mock(FilterChain.class);
  request.setRequestURI("x");
  filter.doFilter(request,new MockHttpServletResponse(),fc);
  assertThat(SecurityContextHolder.getContext().getAuthentication()).isSameAs(remembered);
  verify(fc).doFilter(any(HttpServletRequest.class),any(HttpServletResponse.class));
}
