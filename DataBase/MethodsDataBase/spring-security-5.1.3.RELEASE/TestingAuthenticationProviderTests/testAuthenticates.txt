@Test public void testAuthenticates(){
  TestingAuthenticationProvider provider=new TestingAuthenticationProvider();
  TestingAuthenticationToken token=new TestingAuthenticationToken("Test","Password","ROLE_ONE","ROLE_TWO");
  Authentication result=provider.authenticate(token);
  assertThat(result instanceof TestingAuthenticationToken).isTrue();
  TestingAuthenticationToken castResult=(TestingAuthenticationToken)result;
  assertThat(castResult.getPrincipal()).isEqualTo("Test");
  assertThat(castResult.getCredentials()).isEqualTo("Password");
  assertThat(AuthorityUtils.authorityListToSet(castResult.getAuthorities())).contains("ROLE_ONE","ROLE_TWO");
}
