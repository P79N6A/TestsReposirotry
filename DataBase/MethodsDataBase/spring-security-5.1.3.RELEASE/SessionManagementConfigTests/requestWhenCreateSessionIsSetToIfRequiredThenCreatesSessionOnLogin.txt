@Test public void requestWhenCreateSessionIsSetToIfRequiredThenCreatesSessionOnLogin() throws Exception {
  this.spring.configLocations(this.xml("CreateSessionIfRequired")).autowire();
  ServletContext servletContext=this.mvc.getDispatcherServlet().getServletContext();
  MockHttpServletRequest request=post("/login").param("username","user").param("password","password").buildRequest(servletContext);
  request=csrf().postProcessRequest(request);
  MockHttpServletResponse response=request(request,this.spring.getContext());
  assertThat(response.getStatus()).isEqualTo(HttpStatus.SC_MOVED_TEMPORARILY);
  assertThat(request.getSession(false)).isNotNull();
}
