@Test public void requestWhenCreateSessionIsSetToIfRequiredThenCreatesSessionOnLoginChallenge() throws Exception {
  this.spring.configLocations(this.xml("CreateSessionIfRequired")).autowire();
  ServletContext servletContext=this.mvc.getDispatcherServlet().getServletContext();
  MockHttpServletRequest request=get("/auth").buildRequest(servletContext);
  MockHttpServletResponse response=request(request,this.spring.getContext());
  assertThat(response.getStatus()).isEqualTo(HttpStatus.SC_MOVED_TEMPORARILY);
  assertThat(request.getSession(false)).isNotNull();
}
