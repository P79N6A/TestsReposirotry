@Test public void getTokenResponseWhenHeaderThenSuccess() throws Exception {
  enqueueJson("{\n" + "  \"access_token\":\"MTQ0NjJkZmQ5OTM2NDE1ZTZjNGZmZjI3\",\n" + "  \"token_type\":\"bearer\",\n"+ "  \"expires_in\":3600,\n"+ "  \"refresh_token\":\"IwOGYzYTlmM2YxOTQ5MGE3YmNmMDFkNTVk\",\n"+ "  \"scope\":\"create\"\n"+ "}");
  OAuth2ClientCredentialsGrantRequest request=new OAuth2ClientCredentialsGrantRequest(this.clientRegistration.build());
  OAuth2AccessTokenResponse response=this.client.getTokenResponse(request).block();
  RecordedRequest actualRequest=this.server.takeRequest();
  String body=actualRequest.getUtf8Body();
  assertThat(response.getAccessToken()).isNotNull();
  assertThat(actualRequest.getHeader(HttpHeaders.AUTHORIZATION)).isEqualTo("Basic Y2xpZW50LWlkOmNsaWVudC1zZWNyZXQ=");
  assertThat(body).isEqualTo("grant_type=client_credentials&scope=read%3Auser");
}
