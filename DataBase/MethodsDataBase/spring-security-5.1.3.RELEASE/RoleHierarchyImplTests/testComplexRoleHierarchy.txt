@Test public void testComplexRoleHierarchy(){
  List<GrantedAuthority> authoritiesInput1=AuthorityUtils.createAuthorityList("ROLE_A");
  List<GrantedAuthority> authoritiesOutput1=AuthorityUtils.createAuthorityList("ROLE_A","ROLE_B","ROLE_C","ROLE_D");
  List<GrantedAuthority> authoritiesInput2=AuthorityUtils.createAuthorityList("ROLE_B");
  List<GrantedAuthority> authoritiesOutput2=AuthorityUtils.createAuthorityList("ROLE_B","ROLE_D");
  List<GrantedAuthority> authoritiesInput3=AuthorityUtils.createAuthorityList("ROLE_C");
  List<GrantedAuthority> authoritiesOutput3=AuthorityUtils.createAuthorityList("ROLE_C","ROLE_D");
  List<GrantedAuthority> authoritiesInput4=AuthorityUtils.createAuthorityList("ROLE_D");
  List<GrantedAuthority> authoritiesOutput4=AuthorityUtils.createAuthorityList("ROLE_D");
  RoleHierarchyImpl roleHierarchyImpl=new RoleHierarchyImpl();
  roleHierarchyImpl.setHierarchy("ROLE_A > ROLE_B\nROLE_A > ROLE_C\nROLE_C > ROLE_D\nROLE_B > ROLE_D");
  assertThat(HierarchicalRolesTestHelper.containTheSameGrantedAuthorities(roleHierarchyImpl.getReachableGrantedAuthorities(authoritiesInput1),authoritiesOutput1)).isTrue();
  assertThat(HierarchicalRolesTestHelper.containTheSameGrantedAuthorities(roleHierarchyImpl.getReachableGrantedAuthorities(authoritiesInput2),authoritiesOutput2)).isTrue();
  assertThat(HierarchicalRolesTestHelper.containTheSameGrantedAuthorities(roleHierarchyImpl.getReachableGrantedAuthorities(authoritiesInput3),authoritiesOutput3)).isTrue();
  assertThat(HierarchicalRolesTestHelper.containTheSameGrantedAuthorities(roleHierarchyImpl.getReachableGrantedAuthorities(authoritiesInput4),authoritiesOutput4)).isTrue();
}
