@Test(expected=OpenIDConsumerException.class) public void messageExceptionFetchingAttributesRaisesOpenIDException() throws Exception {
  OpenID4JavaConsumer consumer=new OpenID4JavaConsumer(new NullAxFetchListFactory());
  Message msg=mock(Message.class);
  FetchResponse fr=mock(FetchResponse.class);
  when(msg.hasExtension(AxMessage.OPENID_NS_AX)).thenReturn(true);
  when(msg.getExtension(AxMessage.OPENID_NS_AX)).thenThrow(new MessageException(""));
  when(fr.getAttributeValues("a")).thenReturn(Arrays.asList("x","y"));
  consumer.fetchAxAttributes(msg,attributes);
}
