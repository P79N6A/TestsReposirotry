@Test public void testDecideDetectsUnacceptableChannel() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setQueryString("info=true");
  request.setServerName("localhost");
  request.setContextPath("/bigapp");
  request.setServletPath("/servlet");
  request.setScheme("http");
  request.setServerPort(8080);
  MockHttpServletResponse response=new MockHttpServletResponse();
  FilterInvocation fi=new FilterInvocation(request,response,mock(FilterChain.class));
  SecureChannelProcessor processor=new SecureChannelProcessor();
  processor.decide(fi,SecurityConfig.createList(new String[]{"SOME_IGNORED_ATTRIBUTE","REQUIRES_SECURE_CHANNEL"}));
  assertThat(fi.getResponse().isCommitted()).isTrue();
}
