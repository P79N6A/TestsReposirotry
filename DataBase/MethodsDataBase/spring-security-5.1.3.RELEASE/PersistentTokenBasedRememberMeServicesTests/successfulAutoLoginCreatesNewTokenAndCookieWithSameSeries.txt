@Test public void successfulAutoLoginCreatesNewTokenAndCookieWithSameSeries(){
  services=create(new PersistentRememberMeToken("joe","series","token",new Date()));
  services.setTokenLength(12);
  MockHttpServletResponse response=new MockHttpServletResponse();
  services.processAutoLoginCookie(new String[]{"series","token"},new MockHttpServletRequest(),response);
  assertThat(repo.getStoredToken().getSeries()).isEqualTo("series");
  assertThat(repo.getStoredToken().getTokenValue().length()).isEqualTo(16);
  String[] cookie=services.decodeCookie(response.getCookie("mycookiename").getValue());
  assertThat(cookie[0]).isEqualTo("series");
  assertThat(cookie[1]).isEqualTo(repo.getStoredToken().getTokenValue());
}
