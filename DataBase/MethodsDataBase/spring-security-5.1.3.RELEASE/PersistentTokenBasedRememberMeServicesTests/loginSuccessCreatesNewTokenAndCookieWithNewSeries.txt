@Test public void loginSuccessCreatesNewTokenAndCookieWithNewSeries(){
  services=create(null);
  services.setAlwaysRemember(true);
  services.setTokenLength(12);
  services.setSeriesLength(12);
  MockHttpServletResponse response=new MockHttpServletResponse();
  services.loginSuccess(new MockHttpServletRequest(),response,new UsernamePasswordAuthenticationToken("joe","password"));
  assertThat(repo.getStoredToken().getSeries().length()).isEqualTo(16);
  assertThat(repo.getStoredToken().getTokenValue().length()).isEqualTo(16);
  String[] cookie=services.decodeCookie(response.getCookie("mycookiename").getValue());
  assertThat(cookie[0]).isEqualTo(repo.getStoredToken().getSeries());
  assertThat(cookie[1]).isEqualTo(repo.getStoredToken().getTokenValue());
}
