@Test public void testAuthenticateFailsIfAccountExpired(){
  UsernamePasswordAuthenticationToken token=new UsernamePasswordAuthenticationToken("peter","opal");
  DaoAuthenticationProvider provider=createProvider();
  provider.setUserDetailsService(new MockUserDetailsServiceUserPeterAccountExpired());
  provider.setUserCache(new MockUserCache());
  try {
    provider.authenticate(token);
    fail("Should have thrown AccountExpiredException");
  }
 catch (  AccountExpiredException expected) {
  }
}
