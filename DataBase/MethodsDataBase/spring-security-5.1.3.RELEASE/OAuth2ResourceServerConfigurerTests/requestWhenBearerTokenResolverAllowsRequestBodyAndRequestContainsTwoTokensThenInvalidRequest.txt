@Test public void requestWhenBearerTokenResolverAllowsRequestBodyAndRequestContainsTwoTokensThenInvalidRequest() throws Exception {
  this.spring.register(AllowBearerTokenInRequestBodyConfig.class,JwtDecoderConfig.class,BasicController.class).autowire();
  JwtDecoder decoder=this.spring.getContext().getBean(JwtDecoder.class);
  when(decoder.decode(anyString())).thenReturn(JWT);
  this.mvc.perform(post("/authenticated").param("access_token",JWT_TOKEN).with(bearerToken(JWT_TOKEN)).with(csrf())).andExpect(status().isBadRequest()).andExpect(header().string(HttpHeaders.WWW_AUTHENTICATE,containsString("invalid_request")));
}
