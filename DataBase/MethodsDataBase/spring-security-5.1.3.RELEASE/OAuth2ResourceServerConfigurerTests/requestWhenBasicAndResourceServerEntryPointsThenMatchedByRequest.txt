@Test public void requestWhenBasicAndResourceServerEntryPointsThenMatchedByRequest() throws Exception {
  this.spring.register(BasicAndResourceServerConfig.class,JwtDecoderConfig.class).autowire();
  JwtDecoder decoder=this.spring.getContext().getBean(JwtDecoder.class);
  when(decoder.decode(anyString())).thenThrow(JwtException.class);
  this.mvc.perform(get("/authenticated").with(httpBasic("some","user"))).andExpect(status().isUnauthorized()).andExpect(header().string(HttpHeaders.WWW_AUTHENTICATE,startsWith("Basic")));
  this.mvc.perform(get("/authenticated")).andExpect(status().isUnauthorized()).andExpect(header().string(HttpHeaders.WWW_AUTHENTICATE,startsWith("Basic")));
  this.mvc.perform(get("/authenticated").with(bearerToken("invalid_token"))).andExpect(status().isUnauthorized()).andExpect(header().string(HttpHeaders.WWW_AUTHENTICATE,startsWith("Bearer")));
}
