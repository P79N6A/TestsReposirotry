@Test public void testMultipleRoleAttributeValuesAreMappedToAuthorities() throws Exception {
  LdapUserDetailsMapper mapper=new LdapUserDetailsMapper();
  mapper.setConvertToUpperCase(false);
  mapper.setRolePrefix("");
  mapper.setRoleAttributes(new String[]{"userRole"});
  DirContextAdapter ctx=new DirContextAdapter();
  ctx.setAttributeValues("userRole",new String[]{"X","Y","Z"});
  ctx.setAttributeValue("uid","ani");
  LdapUserDetailsImpl user=(LdapUserDetailsImpl)mapper.mapUserFromContext(ctx,"ani",AuthorityUtils.NO_AUTHORITIES);
  assertThat(user.getAuthorities()).hasSize(3);
}
