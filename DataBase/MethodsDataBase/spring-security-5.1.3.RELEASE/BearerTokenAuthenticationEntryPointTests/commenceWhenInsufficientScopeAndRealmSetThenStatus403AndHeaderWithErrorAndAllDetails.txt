@Test public void commenceWhenInsufficientScopeAndRealmSetThenStatus403AndHeaderWithErrorAndAllDetails() throws Exception {
  MockHttpServletRequest request=new MockHttpServletRequest();
  MockHttpServletResponse response=new MockHttpServletResponse();
  BearerTokenError error=new BearerTokenError(BearerTokenErrorCodes.INSUFFICIENT_SCOPE,HttpStatus.FORBIDDEN,"Insufficient scope","http://example.com","test.read test.write");
  this.authenticationEntryPoint.setRealmName("test");
  this.authenticationEntryPoint.commence(request,response,new OAuth2AuthenticationException(error));
  assertThat(response.getStatus()).isEqualTo(403);
  assertThat(response.getHeader("WWW-Authenticate")).isEqualTo("Bearer realm=\"test\", error=\"insufficient_scope\", error_description=\"Insufficient scope\", " + "error_uri=\"http://example.com\", scope=\"test.read test.write\"");
}
