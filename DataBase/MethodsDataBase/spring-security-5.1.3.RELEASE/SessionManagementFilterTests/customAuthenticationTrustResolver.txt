@Test public void customAuthenticationTrustResolver() throws Exception {
  AuthenticationTrustResolver trustResolver=mock(AuthenticationTrustResolver.class);
  SecurityContextRepository repo=mock(SecurityContextRepository.class);
  SessionManagementFilter filter=new SessionManagementFilter(repo);
  filter.setTrustResolver(trustResolver);
  HttpServletRequest request=new MockHttpServletRequest();
  authenticateUser();
  filter.doFilter(request,new MockHttpServletResponse(),new MockFilterChain());
  verify(trustResolver).isAnonymous(any(Authentication.class));
}
