@SuppressWarnings("unchecked") @Test public void callbackIsNotInvokedWhenPermissionDenied() throws Exception {
  doThrow(new AccessDeniedException("denied")).when(adm).decide(any(),any(),any());
  SecurityContextHolder.getContext().setAuthentication(token);
  try {
    interceptor.invoke(joinPoint,aspectJCallback);
    fail("Expected AccessDeniedException");
  }
 catch (  AccessDeniedException expected) {
  }
  verify(aspectJCallback,never()).proceedWithObject();
}
