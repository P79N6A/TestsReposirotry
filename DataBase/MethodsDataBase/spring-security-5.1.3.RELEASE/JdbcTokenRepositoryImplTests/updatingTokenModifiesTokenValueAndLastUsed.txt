@Test public void updatingTokenModifiesTokenValueAndLastUsed(){
  Timestamp ts=new Timestamp(System.currentTimeMillis() - 1);
  template.execute("insert into persistent_logins (series, username, token, last_used) values " + "('joesseries', 'joeuser', 'atoken', '" + ts.toString() + "')");
  repo.updateToken("joesseries","newtoken",new Date());
  Map<String,Object> results=template.queryForMap("select * from persistent_logins where series = 'joesseries'");
  assertThat(results.get("username")).isEqualTo("joeuser");
  assertThat(results.get("series")).isEqualTo("joesseries");
  assertThat(results.get("token")).isEqualTo("newtoken");
  Date lastUsed=(Date)results.get("last_used");
  assertThat(lastUsed.getTime() > ts.getTime()).isTrue();
}
