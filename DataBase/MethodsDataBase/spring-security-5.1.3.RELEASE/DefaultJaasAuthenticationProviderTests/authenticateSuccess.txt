@Test public void authenticateSuccess() throws Exception {
  Authentication auth=provider.authenticate(token);
  assertThat(auth.getPrincipal()).isEqualTo(token.getPrincipal());
  assertThat(auth.getCredentials()).isEqualTo(token.getCredentials());
  assertThat(auth.isAuthenticated()).isEqualTo(true);
  assertThat(auth.getAuthorities().isEmpty()).isEqualTo(false);
  verify(publisher).publishEvent(isA(JaasAuthenticationSuccessEvent.class));
  verifyNoMoreInteractions(publisher);
}
