@Test public void logout() throws Exception {
  SessionDestroyedEvent event=mock(SessionDestroyedEvent.class);
  SecurityContext securityContext=mock(SecurityContext.class);
  JaasAuthenticationToken token=mock(JaasAuthenticationToken.class);
  LoginContext context=mock(LoginContext.class);
  when(event.getSecurityContexts()).thenReturn(Arrays.asList(securityContext));
  when(securityContext.getAuthentication()).thenReturn(token);
  when(token.getLoginContext()).thenReturn(context);
  provider.onApplicationEvent(event);
  verify(event).getSecurityContexts();
  verify(securityContext).getAuthentication();
  verify(token).getLoginContext();
  verify(context).logout();
  verifyNoMoreInteractions(event,securityContext,token,context);
}
