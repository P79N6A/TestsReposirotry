@Test public void logoutNullLoginContext() throws Exception {
  SessionDestroyedEvent event=mock(SessionDestroyedEvent.class);
  SecurityContext securityContext=mock(SecurityContext.class);
  JaasAuthenticationToken token=mock(JaasAuthenticationToken.class);
  when(event.getSecurityContexts()).thenReturn(Arrays.asList(securityContext));
  when(securityContext.getAuthentication()).thenReturn(token);
  provider.onApplicationEvent(event);
  verify(event).getSecurityContexts();
  verify(securityContext).getAuthentication();
  verify(token).getLoginContext();
  verifyNoMoreInteractions(event,securityContext,token);
}
