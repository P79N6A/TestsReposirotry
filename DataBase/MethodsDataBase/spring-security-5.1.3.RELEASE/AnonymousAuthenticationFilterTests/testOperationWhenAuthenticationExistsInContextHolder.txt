@Test public void testOperationWhenAuthenticationExistsInContextHolder() throws Exception {
  Authentication originalAuth=new TestingAuthenticationToken("user","password","ROLE_A");
  SecurityContextHolder.getContext().setAuthentication(originalAuth);
  AnonymousAuthenticationFilter filter=new AnonymousAuthenticationFilter("qwerty","anonymousUsername",AuthorityUtils.createAuthorityList("ROLE_ANONYMOUS"));
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setRequestURI("x");
  executeFilterInContainerSimulator(mock(FilterConfig.class),filter,request,new MockHttpServletResponse(),new MockFilterChain(true));
  assertThat(SecurityContextHolder.getContext().getAuthentication()).isEqualTo(originalAuth);
}
