@Test public void authenticateWhenIdTokenAuthorizedPartyClaimNotEqualToClientIdThenThrowOAuth2AuthenticationException() throws Exception {
  this.exception.expect(OAuth2AuthenticationException.class);
  this.exception.expectMessage(containsString("invalid_id_token"));
  Map<String,Object> claims=new HashMap<>();
  claims.put(IdTokenClaimNames.ISS,"https://provider.com");
  claims.put(IdTokenClaimNames.SUB,"subject1");
  claims.put(IdTokenClaimNames.AUD,Arrays.asList("client1","client2"));
  claims.put(IdTokenClaimNames.AZP,"other-client");
  this.setUpIdToken(claims);
  this.authenticationProvider.authenticate(new OAuth2LoginAuthenticationToken(this.clientRegistration,this.authorizationExchange));
}
