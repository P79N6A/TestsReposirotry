@Test public void authenticateWhenTokenResponseDoesNotContainIdTokenThenThrowOAuth2AuthenticationException(){
  this.exception.expect(OAuth2AuthenticationException.class);
  this.exception.expectMessage(containsString("invalid_id_token"));
  OAuth2AccessTokenResponse accessTokenResponse=OAuth2AccessTokenResponse.withResponse(this.accessTokenSuccessResponse()).additionalParameters(Collections.emptyMap()).build();
  when(this.accessTokenResponseClient.getTokenResponse(any())).thenReturn(accessTokenResponse);
  this.authenticationProvider.authenticate(new OAuth2LoginAuthenticationToken(this.clientRegistration,this.authorizationExchange));
}
