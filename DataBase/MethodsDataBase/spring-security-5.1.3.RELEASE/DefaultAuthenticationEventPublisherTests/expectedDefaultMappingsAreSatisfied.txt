@Test public void expectedDefaultMappingsAreSatisfied() throws Exception {
  publisher=new DefaultAuthenticationEventPublisher();
  ApplicationEventPublisher appPublisher=mock(ApplicationEventPublisher.class);
  publisher.setApplicationEventPublisher(appPublisher);
  Authentication a=mock(Authentication.class);
  Exception cause=new Exception();
  Object extraInfo=new Object();
  publisher.publishAuthenticationFailure(new BadCredentialsException(""),a);
  publisher.publishAuthenticationFailure(new BadCredentialsException("",cause),a);
  verify(appPublisher,times(2)).publishEvent(isA(AuthenticationFailureBadCredentialsEvent.class));
  reset(appPublisher);
  publisher.publishAuthenticationFailure(new UsernameNotFoundException(""),a);
  publisher.publishAuthenticationFailure(new UsernameNotFoundException("",cause),a);
  publisher.publishAuthenticationFailure(new AccountExpiredException(""),a);
  publisher.publishAuthenticationFailure(new AccountExpiredException("",cause),a);
  publisher.publishAuthenticationFailure(new ProviderNotFoundException(""),a);
  publisher.publishAuthenticationFailure(new DisabledException(""),a);
  publisher.publishAuthenticationFailure(new DisabledException("",cause),a);
  publisher.publishAuthenticationFailure(new LockedException(""),a);
  publisher.publishAuthenticationFailure(new LockedException("",cause),a);
  publisher.publishAuthenticationFailure(new AuthenticationServiceException(""),a);
  publisher.publishAuthenticationFailure(new AuthenticationServiceException("",cause),a);
  publisher.publishAuthenticationFailure(new CredentialsExpiredException(""),a);
  publisher.publishAuthenticationFailure(new CredentialsExpiredException("",cause),a);
  verify(appPublisher,times(2)).publishEvent(isA(AuthenticationFailureBadCredentialsEvent.class));
  verify(appPublisher,times(2)).publishEvent(isA(AuthenticationFailureExpiredEvent.class));
  verify(appPublisher).publishEvent(isA(AuthenticationFailureProviderNotFoundEvent.class));
  verify(appPublisher,times(2)).publishEvent(isA(AuthenticationFailureDisabledEvent.class));
  verify(appPublisher,times(2)).publishEvent(isA(AuthenticationFailureLockedEvent.class));
  verify(appPublisher,times(2)).publishEvent(isA(AuthenticationFailureServiceExceptionEvent.class));
  verify(appPublisher,times(2)).publishEvent(isA(AuthenticationFailureCredentialsExpiredEvent.class));
  verifyNoMoreInteractions(appPublisher);
}
