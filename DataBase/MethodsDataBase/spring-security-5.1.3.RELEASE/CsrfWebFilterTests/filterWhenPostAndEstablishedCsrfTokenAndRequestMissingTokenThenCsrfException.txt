@Test public void filterWhenPostAndEstablishedCsrfTokenAndRequestMissingTokenThenCsrfException(){
  this.csrfFilter.setCsrfTokenRepository(this.repository);
  when(this.repository.loadToken(any())).thenReturn(Mono.just(this.token));
  Mono<Void> result=this.csrfFilter.filter(this.post,this.chain);
  StepVerifier.create(result).verifyComplete();
  assertThat(this.post.getResponse().getStatusCode()).isEqualTo(HttpStatus.FORBIDDEN);
}
