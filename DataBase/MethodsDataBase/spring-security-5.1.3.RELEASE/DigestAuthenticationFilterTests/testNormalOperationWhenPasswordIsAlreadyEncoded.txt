@Test public void testNormalOperationWhenPasswordIsAlreadyEncoded() throws Exception {
  String encodedPassword=DigestAuthUtils.encodePasswordInA1Format(USERNAME,REALM,PASSWORD);
  String responseDigest=DigestAuthUtils.generateDigest(true,USERNAME,REALM,encodedPassword,"GET",REQUEST_URI,QOP,NONCE,NC,CNONCE);
  request.addHeader("Authorization",createAuthorizationHeader(USERNAME,REALM,NONCE,REQUEST_URI,responseDigest,QOP,NC,CNONCE));
  executeFilterInContainerSimulator(filter,request,true);
  assertThat(SecurityContextHolder.getContext().getAuthentication()).isNotNull();
  assertThat(((UserDetails)SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getUsername()).isEqualTo(USERNAME);
}
