@Test public void testRenameFirstLevelDirectory() throws Exception {
  final AzureBlobFileSystem fs=getFileSystem();
  final List<Future<Void>> tasks=new ArrayList<>();
  ExecutorService es=Executors.newFixedThreadPool(10);
  for (int i=0; i < 1000; i++) {
    final Path fileName=new Path("/test/" + i);
    Callable<Void> callable=new Callable<Void>(){
      @Override public Void call() throws Exception {
        touch(fileName);
        return null;
      }
    }
;
    tasks.add(es.submit(callable));
  }
  for (  Future<Void> task : tasks) {
    task.get();
  }
  es.shutdownNow();
  Path source=new Path("/test");
  Path dest=new Path("/renamedDir");
  assertRenameOutcome(fs,source,dest,true);
  FileStatus[] files=fs.listStatus(dest);
  assertEquals("Wrong number of files in listing",1000,files.length);
  assertPathDoesNotExist(fs,"rename source dir",source);
}
