@Test public void testHDFSBackedProvider() throws Exception {
  File testSchedulerConfigurationDir=new File(TestMutableCSConfigurationProvider.class.getResource("").getPath() + TestMutableCSConfigurationProvider.class.getSimpleName());
  FileUtils.deleteDirectory(testSchedulerConfigurationDir);
  testSchedulerConfigurationDir.mkdirs();
  Configuration conf=new Configuration(false);
  conf.set(YarnConfiguration.SCHEDULER_CONFIGURATION_STORE_CLASS,YarnConfiguration.FS_CONFIGURATION_STORE);
  conf.set(YarnConfiguration.SCHEDULER_CONFIGURATION_FS_PATH,testSchedulerConfigurationDir.getAbsolutePath());
  writeConf(conf,testSchedulerConfigurationDir.getAbsolutePath());
  confProvider.init(conf);
  assertNull(confProvider.loadConfiguration(conf).get("yarn.scheduler.capacity.root.a.goodKey"));
  confProvider.logAndApplyMutation(TEST_USER,goodUpdate);
  confProvider.confirmPendingMutation(true);
  assertEquals("goodVal",confProvider.loadConfiguration(conf).get("yarn.scheduler.capacity.root.a.goodKey"));
  assertNull(confProvider.loadConfiguration(conf).get("yarn.scheduler.capacity.root.a.badKey"));
  confProvider.logAndApplyMutation(TEST_USER,badUpdate);
  confProvider.confirmPendingMutation(false);
  assertNull(confProvider.loadConfiguration(conf).get("yarn.scheduler.capacity.root.a.badKey"));
}
