@Test public void testSubClusterExpiry() throws Exception {
  getPolicyInfo().setHeadroomAlpha(1.0f);
  YarnConfiguration conf=new YarnConfiguration();
  conf.setLong(YarnConfiguration.FEDERATION_AMRMPROXY_SUBCLUSTER_TIMEOUT,500);
  initializePolicy(conf);
  List<ResourceRequest> resourceRequests=createSimpleRequest();
  prepPolicyWithHeadroom(true);
  Map<SubClusterId,List<ResourceRequest>> response=((FederationAMRMProxyPolicy)getPolicy()).splitResourceRequests(resourceRequests);
  prettyPrintRequests(response);
  validateSplit(response,resourceRequests);
  checkExpectedAllocation(response,"subcluster0",1,60);
  checkExpectedAllocation(response,"subcluster1",1,-1);
  checkExpectedAllocation(response,"subcluster2",1,15);
  checkExpectedAllocation(response,"subcluster5",1,25);
  checkTotalContainerAllocation(response,100);
  Thread.sleep(800);
  prepPolicyWithHeadroom(false);
  response=((FederationAMRMProxyPolicy)getPolicy()).splitResourceRequests(resourceRequests);
  prettyPrintRequests(response);
  validateSplit(response,resourceRequests);
  checkExpectedAllocation(response,"subcluster0",1,-1);
  checkExpectedAllocation(response,"subcluster1",1,-1);
  checkExpectedAllocation(response,"subcluster2",1,100);
  checkExpectedAllocation(response,"subcluster5",1,-1);
  checkTotalContainerAllocation(response,100);
}
