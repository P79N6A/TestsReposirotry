@Test public void testProcessSummationOneCell() throws IOException {
  FlowScanner fs=getFlowScannerForTestingCompaction();
  long currentTimestamp=System.currentTimeMillis();
  List<Tag> tags=new ArrayList<>();
  Tag t=HBaseTimelineServerUtils.createTag(AggregationOperation.SUM.getTagType(),"application_123458888888_999888");
  tags.add(t);
  byte[] tagByteArray=HBaseTimelineServerUtils.convertTagListToByteArray(tags);
  SortedSet<Cell> currentColumnCells=new TreeSet<Cell>(KeyValue.COMPARATOR);
  Cell c1=HBaseTimelineServerUtils.createNewCell(aRowKey,aFamily,aQualifier,currentTimestamp,Bytes.toBytes(1110L),tagByteArray);
  currentColumnCells.add(c1);
  List<Cell> cells=fs.processSummationMajorCompaction(currentColumnCells,new LongConverter(),currentTimestamp);
  assertNotNull(cells);
  assertEquals(1,cells.size());
  Cell c2=cells.get(0);
  assertEquals(c1,c2);
  assertEquals(currentTimestamp,c2.getTimestamp());
}
