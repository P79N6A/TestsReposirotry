/** 
 * Verify that if you explicitly name a committer, that takes priority over any filesystem committer.
 */
@Test public void testNamedCommitterFactory() throws Throwable {
  Configuration conf=new Configuration();
  conf.set(COMMITTER_FACTORY_CLASS,NAMED_COMMITTER_FACTORY);
  conf.set(NAMED_COMMITTER_CLASS,SimpleCommitter.class.getName());
  SimpleCommitter sc=createCommitter(NamedCommitterFactory.class,SimpleCommitter.class,HDFS_PATH,conf);
  assertEquals("Wrong output path from " + sc,HDFS_PATH,sc.getOutputPath());
}
