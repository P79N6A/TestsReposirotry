/** 
 * Checks that we return the right error if diskbalancer is not enabled.
 */
@Test public void testDiskBalancerDisabled() throws Exception {
  Configuration conf=new HdfsConfiguration();
  conf.setBoolean(DFSConfigKeys.DFS_DISK_BALANCER_ENABLED,false);
  restartDataNode();
  TestMover blockMover=new TestMover(cluster.getDataNodes().get(0).getFSDataset());
  DiskBalancer balancer=new DiskBalancerBuilder(conf).setMover(blockMover).build();
  thrown.expect(DiskBalancerException.class);
  thrown.expect(new DiskBalancerResultVerifier(DiskBalancerException.Result.DISK_BALANCER_NOT_ENABLED));
  balancer.queryWorkStatus();
}
