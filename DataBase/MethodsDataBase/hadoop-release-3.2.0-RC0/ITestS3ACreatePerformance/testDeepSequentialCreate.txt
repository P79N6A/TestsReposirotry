/** 
 * Test rate at which we can create deeply-nested files from a single thread.
 * @throws Exception
 */
@Test public void testDeepSequentialCreate() throws Exception {
  long numOperations=getOperationCount();
  S3AFileSystem fs=getFileSystem();
  NanoTimer timer=new NanoTimer();
  for (int i=0; i < numOperations; i++) {
    Path p=getPathIteration(i,PATH_DEPTH);
    OutputStream out=fs.create(p);
    out.write(40);
    out.close();
  }
  timer.end("Time to create %d files of depth %d",getOperationCount(),PATH_DEPTH);
  LOG.info("Time per create: {} msec",timer.nanosPerOperation(numOperations) / 1000);
}
