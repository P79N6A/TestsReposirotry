@Test(timeout=30000) public void testRestoreFailedStorageNN1DownNN2Down() throws Exception {
  setUpHaCluster(false);
  cluster.getDfsCluster().shutdownNameNode(0);
  cluster.getDfsCluster().shutdownNameNode(1);
  int exitCode=admin.run(new String[]{"-restoreFailedStorage","check"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  String message="restoreFailedStorage failed for.*";
  assertOutputMatches(message + newLine + message+ newLine);
  exitCode=admin.run(new String[]{"-restoreFailedStorage","true"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  message="restoreFailedStorage failed for.*";
  assertOutputMatches(message + newLine + message+ newLine);
  exitCode=admin.run(new String[]{"-restoreFailedStorage","false"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  message="restoreFailedStorage failed for.*";
  assertOutputMatches(message + newLine + message+ newLine);
}
