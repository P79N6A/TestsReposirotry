@Test public void testRenameThreadPoolExceptionFailure() throws Exception {
  NativeAzureFileSystem mockFs=Mockito.spy((NativeAzureFileSystem)fs);
  String path=mockFs.pathToKey(mockFs.makeAbsolute(new Path("root")));
  AzureFileSystemThreadPoolExecutor mockThreadPoolExecutor=Mockito.spy(((NativeAzureFileSystem)fs).getThreadPoolExecutor(renameThreads,"AzureBlobRenameThread","Rename",path,NativeAzureFileSystem.AZURE_RENAME_THREADS));
  Mockito.when(mockThreadPoolExecutor.getThreadPool(7)).thenThrow(new Exception());
  Mockito.doReturn(mockThreadPoolExecutor).when(mockFs).getThreadPoolExecutor(renameThreads,"AzureBlobRenameThread","Rename",path,NativeAzureFileSystem.AZURE_RENAME_THREADS);
  validateRenameFolder(mockFs,"root","rootnew");
  String content=logs.getOutput();
  assertInLog(content,"Failed to create thread pool with threads");
  assertInLog(content,"Serializing the Rename operation");
}
