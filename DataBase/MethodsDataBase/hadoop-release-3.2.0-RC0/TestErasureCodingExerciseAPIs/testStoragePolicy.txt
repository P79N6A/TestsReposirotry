/** 
 * FileSystem.[setStoragePolicy, unsetStoragePolicy] API call should succeed without failure.
 * @throws IOException if any IO operation failed.
 */
@Test public void testStoragePolicy() throws IOException {
  Path p=new Path("/storagePolicyTest");
  fs.mkdirs(p);
  final Path sp=new Path(p,"/sp");
  try (DataOutputStream dos=fs.create(sp)){
    dos.writeBytes("create with some content");
  }
   final BlockStoragePolicySuite suite=BlockStoragePolicySuite.createDefaultSuite();
  final BlockStoragePolicy hot=suite.getPolicy("HOT");
  fs.setStoragePolicy(sp,hot.getName());
  assertEquals(fs.getStoragePolicy(sp),hot);
  fs.unsetStoragePolicy(sp);
  assertEquals(fs.getStoragePolicy(sp),hot);
}
