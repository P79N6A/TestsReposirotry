@Test public void testExceptionResultsInNormalError() throws Exception {
  RefreshHandler exceptionalHandler=Mockito.mock(RefreshHandler.class);
  Mockito.when(exceptionalHandler.handleRefresh(Mockito.anyString(),Mockito.any(String[].class))).thenThrow(new RuntimeException("Exceptional Handler Throws Exception"));
  RefreshHandler otherExceptionalHandler=Mockito.mock(RefreshHandler.class);
  Mockito.when(otherExceptionalHandler.handleRefresh(Mockito.anyString(),Mockito.any(String[].class))).thenThrow(new RuntimeException("More Exceptions"));
  RefreshRegistry.defaultRegistry().register("exceptional",exceptionalHandler);
  RefreshRegistry.defaultRegistry().register("exceptional",otherExceptionalHandler);
  DFSAdmin admin=new DFSAdmin(config);
  String[] args=new String[]{"-refresh","localhost:" + cluster.getNameNodePort(),"exceptional"};
  int exitCode=admin.run(args);
  assertEquals(-1,exitCode);
  Mockito.verify(exceptionalHandler).handleRefresh("exceptional",new String[]{});
  Mockito.verify(otherExceptionalHandler).handleRefresh("exceptional",new String[]{});
  RefreshRegistry.defaultRegistry().unregisterAll("exceptional");
}
