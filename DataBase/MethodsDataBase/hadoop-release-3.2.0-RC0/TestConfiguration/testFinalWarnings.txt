@Test public void testFinalWarnings() throws Exception {
  StringWriter writer=new StringWriter();
  out=new BufferedWriter(writer);
  startConfig();
  declareProperty("prop","A","A",true);
  endConfig();
  byte[] bytes=writer.toString().getBytes();
  InputStream in1=new ByteArrayInputStream(bytes);
  writer=new StringWriter();
  out=new BufferedWriter(writer);
  startConfig();
  declareProperty("prop","BB","BB",true);
  endConfig();
  byte[] bytes2=writer.toString().getBytes();
  InputStream in2=new ByteArrayInputStream(bytes2);
  TestAppender appender=new TestAppender();
  final Logger logger=Logger.getRootLogger();
  logger.addAppender(appender);
  try {
    conf.addResource(in1);
    conf.addResource(in2);
    assertEquals("should see the first value","A",conf.get("prop"));
    List<LoggingEvent> events=appender.getLog();
    assertEquals("overriding a final parameter should cause logging",1,events.size());
    LoggingEvent loggingEvent=events.get(0);
    String renderedMessage=loggingEvent.getRenderedMessage();
    assertTrue("did not see expected string inside message " + renderedMessage,renderedMessage.contains("an attempt to override final parameter: " + "prop;  Ignoring."));
  }
  finally {
    logger.removeAppender(appender);
  }
}
