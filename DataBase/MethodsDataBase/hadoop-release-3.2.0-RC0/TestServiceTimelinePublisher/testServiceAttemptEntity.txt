@Test public void testServiceAttemptEntity(){
  Service service=createMockApplication();
  serviceTimelinePublisher.serviceAttemptRegistered(service,new YarnConfiguration());
  Collection<TimelineEntity> lastPublishedEntities=((DummyTimelineClient)timelineClient).getLastPublishedEntities();
  assertEquals(2,lastPublishedEntities.size());
  for (  TimelineEntity timelineEntity : lastPublishedEntities) {
    if (timelineEntity.getType() == ServiceTimelineEntityType.COMPONENT.toString()) {
      verifyComponentTimelineEntity(timelineEntity);
    }
 else {
      verifyServiceAttemptTimelineEntity(timelineEntity,null,true);
    }
  }
  ServiceContext context=new ServiceContext();
  context.attemptId=ApplicationAttemptId.newInstance(ApplicationId.fromString(service.getId()),1);
  String exitDiags="service killed";
  serviceTimelinePublisher.serviceAttemptUnregistered(context,FinalApplicationStatus.ENDED,exitDiags);
  lastPublishedEntities=((DummyTimelineClient)timelineClient).getLastPublishedEntities();
  for (  TimelineEntity timelineEntity : lastPublishedEntities) {
    if (timelineEntity.getType() == ServiceTimelineEntityType.SERVICE_ATTEMPT.toString()) {
      verifyServiceAttemptTimelineEntity(timelineEntity,exitDiags,false);
    }
  }
}
