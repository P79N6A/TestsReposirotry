@Test(timeout=200000) public void testContainersReleasedWhenExpired() throws Exception {
  ApplicationId applicationId=ApplicationId.newInstance(System.currentTimeMillis(),1);
  Service exampleApp=new Service();
  exampleApp.setId(applicationId.toString());
  exampleApp.setName("testContainersRecovers");
  exampleApp.setVersion("v1");
  String comp1Name="comp1";
  String comp1InstName="comp1-0";
  org.apache.hadoop.yarn.service.api.records.Component compA=createComponent(comp1Name,1,"sleep");
  exampleApp.addComponent(compA);
  MockServiceAM am=new MockServiceAM(exampleApp);
  ContainerId containerId=am.createContainerId(1);
  am.feedRegistryComponent(containerId,comp1Name,comp1InstName);
  conf.setLong(YarnServiceConf.CONTAINER_RECOVERY_TIMEOUT_MS,10);
  am.init(conf);
  am.start();
  Thread.sleep(100);
  GenericTestUtils.waitFor(() -> am.getComponent(comp1Name).getState().equals(ComponentState.FLEXING),100,2000);
  Assert.assertEquals(1,am.getComponent(comp1Name).getPendingInstances().size());
  am.feedContainerToComp(exampleApp,2,comp1Name);
  GenericTestUtils.waitFor(() -> am.getCompInstance(comp1Name,comp1InstName).getContainerStatus() != null,2000,200000);
  Assert.assertEquals("container state",org.apache.hadoop.yarn.api.records.ContainerState.RUNNING,am.getCompInstance(comp1Name,comp1InstName).getContainerStatus().getState());
}
