/** 
 * Verify that all healthy locations are correctly handled and that the check routine is invoked as expected.
 * @throws Exception
 */
@Test(timeout=30000) public void testAllLocationsHealthy() throws Exception {
  final List<StorageLocation> locations=makeMockLocations(HEALTHY,HEALTHY,HEALTHY);
  final Configuration conf=new HdfsConfiguration();
  conf.setInt(DFS_DATANODE_FAILED_VOLUMES_TOLERATED_KEY,0);
  StorageLocationChecker checker=new StorageLocationChecker(conf,new FakeTimer());
  List<StorageLocation> filteredLocations=checker.check(conf,locations);
  assertThat(filteredLocations.size(),is(3));
  for (  StorageLocation location : locations) {
    verify(location).check(any(StorageLocation.CheckContext.class));
  }
}
