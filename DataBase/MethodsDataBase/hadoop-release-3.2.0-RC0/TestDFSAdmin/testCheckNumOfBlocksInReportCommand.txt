@Test(timeout=300000L) public void testCheckNumOfBlocksInReportCommand() throws Exception {
  DistributedFileSystem dfs=cluster.getFileSystem();
  Path path=new Path("/tmp.txt");
  DatanodeInfo[] dn=dfs.getDataNodeStats();
  assertEquals(dn.length,NUM_DATANODES);
  int actualBlockCount=0;
  for (  DatanodeInfo d : dn) {
    actualBlockCount+=d.getNumBlocks();
  }
  assertEquals(0,actualBlockCount);
  DFSTestUtil.createFile(dfs,path,1024,(short)1,0);
  int expectedBlockCount=2;
  Thread.sleep(3 * 1000);
  dn=dfs.getDataNodeStats();
  assertEquals(dn.length,NUM_DATANODES);
  actualBlockCount=0;
  for (  DatanodeInfo d : dn) {
    actualBlockCount+=d.getNumBlocks();
  }
  assertEquals(expectedBlockCount,actualBlockCount);
}
