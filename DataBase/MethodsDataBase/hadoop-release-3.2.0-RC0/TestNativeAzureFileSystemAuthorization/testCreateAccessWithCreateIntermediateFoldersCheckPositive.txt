/** 
 * Positive test to verify Create access check. The test tries to create a file whose parent is non-existent to ensure that the intermediate folders between ancestor and direct parent are being created when proper ranger policies are configured.
 * @throws Throwable
 */
@Test public void testCreateAccessWithCreateIntermediateFoldersCheckPositive() throws Throwable {
  Path parentDir=new Path("/testCreateAccessCheckPositive/1/2/3");
  Path testPath=new Path(parentDir,"test.dat");
  authorizer.addAuthRuleForOwner("/",WRITE,true);
  fs.updateWasbAuthorizer(authorizer);
  try {
    fs.create(testPath);
    ContractTestUtils.assertPathExists(fs,"testPath was not created",testPath);
  }
  finally {
    allowRecursiveDelete(fs,"/testCreateAccessCheckPositive");
    fs.delete(new Path("/testCreateAccessCheckPositive"),true);
  }
}
