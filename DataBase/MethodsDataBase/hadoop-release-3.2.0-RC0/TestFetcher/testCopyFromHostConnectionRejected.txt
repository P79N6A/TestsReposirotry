@Test public void testCopyFromHostConnectionRejected() throws Exception {
  when(connection.getResponseCode()).thenReturn(Fetcher.TOO_MANY_REQ_STATUS_CODE);
  Fetcher<Text,Text> fetcher=new FakeFetcher<>(job,id,ss,mm,r,metrics,except,key,connection);
  fetcher.copyFromHost(host);
  Assert.assertEquals("No host failure is expected.",ss.hostFailureCount(host.getHostName()),0);
  Assert.assertEquals("No fetch failure is expected.",ss.fetchFailureCount(map1ID),0);
  Assert.assertEquals("No fetch failure is expected.",ss.fetchFailureCount(map2ID),0);
  verify(ss).penalize(eq(host),anyLong());
  verify(ss).putBackKnownMapOutput(any(MapHost.class),eq(map1ID));
  verify(ss).putBackKnownMapOutput(any(MapHost.class),eq(map2ID));
}
