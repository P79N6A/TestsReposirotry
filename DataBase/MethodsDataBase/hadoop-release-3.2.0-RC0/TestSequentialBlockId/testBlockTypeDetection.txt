/** 
 * Test that the block type (legacy or not) can be correctly detected based on its generation stamp.
 * @throws IOException
 */
@Test public void testBlockTypeDetection() throws IOException {
  BlockIdManager bid=mock(BlockIdManager.class);
  final long maxGenStampForLegacyBlocks=10000;
  when(bid.getLegacyGenerationStampLimit()).thenReturn(maxGenStampForLegacyBlocks);
  Block legacyBlock=spy(new Block());
  when(legacyBlock.getGenerationStamp()).thenReturn(maxGenStampForLegacyBlocks / 2);
  Block newBlock=spy(new Block());
  when(newBlock.getGenerationStamp()).thenReturn(maxGenStampForLegacyBlocks + 1);
  when(bid.isLegacyBlock(any(Block.class))).thenCallRealMethod();
  assertThat(bid.isLegacyBlock(legacyBlock),is(true));
  assertThat(bid.isLegacyBlock(newBlock),is(false));
}
