/** 
 * Test that the generation stamp for legacy and new blocks is updated as expected.
 * @throws IOException
 */
@Test public void testGenerationStampUpdate() throws IOException {
  BlockIdManager bid=mock(BlockIdManager.class);
  final long nextLegacyGenerationStamp=5000;
  final long nextGenerationStamp=20000;
  when(bid.getNextLegacyGenerationStamp()).thenReturn(nextLegacyGenerationStamp);
  when(bid.getNextGenerationStamp()).thenReturn(nextGenerationStamp);
  when(bid.nextGenerationStamp(anyBoolean())).thenCallRealMethod();
  assertThat(bid.nextGenerationStamp(true),is(nextLegacyGenerationStamp));
  assertThat(bid.nextGenerationStamp(false),is(nextGenerationStamp));
}
