@Test public void testGet() throws Exception {
  final String filePath="/a1/b1/c1/some_file";
  final String dirPath="/a1/b1/c1/d1";
  ms.put(new PathMetadata(makeFileStatus(filePath,100)));
  ms.put(new PathMetadata(makeDirStatus(dirPath)));
  PathMetadata meta=ms.get(strToPath(filePath));
  if (!allowMissing() || meta != null) {
    assertNotNull("Get found file",meta);
    verifyFileStatus(meta.getFileStatus(),100);
  }
  if (!(ms instanceof NullMetadataStore)) {
    ms.delete(strToPath(filePath));
    meta=ms.get(strToPath(filePath));
    assertTrue("Tombstone not left for deleted file",meta.isDeleted());
  }
  meta=ms.get(strToPath(dirPath));
  if (!allowMissing() || meta != null) {
    assertNotNull("Get found file (dir)",meta);
    assertTrue("Found dir",meta.getFileStatus().isDirectory());
  }
  meta=ms.get(strToPath("/bollocks"));
  assertNull("Don't get non-existent file",meta);
}
