@Test public void testRandomRootWalk() throws Exception {
  Set<FileStatus> ns=new HashSet<>();
  final long seed=r.nextLong();
  Path root=new Path("foo://bar:4344/dingos");
  String sroot=root.toString();
  int nroot=sroot.length();
  RandomTreeWalk t1=new RandomTreeWalk(root,seed,10,.1f);
  int i=0;
  for (  TreePath p : t1) {
    p.accept(i++);
    FileStatus stat=p.getFileStatus();
    assertTrue(ns.add(stat));
    assertEquals(sroot,stat.getPath().toString().substring(0,nroot));
  }
  RandomTreeWalk t2=new RandomTreeWalk(root,seed,10,.1f);
  int j=0;
  for (  TreePath p : t2) {
    p.accept(j++);
    FileStatus stat=p.getFileStatus();
    assertTrue(ns.remove(stat));
    assertEquals(sroot,stat.getPath().toString().substring(0,nroot));
  }
  assertTrue(ns.isEmpty());
}
