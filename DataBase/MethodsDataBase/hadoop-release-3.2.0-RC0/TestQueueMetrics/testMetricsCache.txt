@Test public void testMetricsCache(){
  MetricsSystem ms=new MetricsSystemImpl("cache");
  ms.start();
  try {
    String p1="root1";
    String leafQueueName="root1.leaf";
    QueueMetrics p1Metrics=QueueMetrics.forQueue(ms,p1,null,true,conf);
    Queue parentQueue1=mock(Queue.class);
    when(parentQueue1.getMetrics()).thenReturn(p1Metrics);
    QueueMetrics metrics=QueueMetrics.forQueue(ms,leafQueueName,parentQueue1,true,conf);
    Assert.assertNotNull("QueueMetrics for A shoudn't be null",metrics);
    QueueMetrics alterMetrics=QueueMetrics.forQueue(ms,leafQueueName,parentQueue1,true,conf);
    Assert.assertNotNull("QueueMetrics for alterMetrics shoudn't be null",alterMetrics);
  }
  finally {
    ms.shutdown();
  }
}
