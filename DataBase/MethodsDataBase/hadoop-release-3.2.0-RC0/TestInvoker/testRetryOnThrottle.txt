/** 
 * Repeatedly retry until a throttle eventually stops being raised.
 */
@Test public void testRetryOnThrottle() throws Throwable {
  final AtomicInteger counter=new AtomicInteger(0);
  invoker.retry("test",null,false,() -> {
    if (counter.incrementAndGet() < 5) {
      throw newThrottledException();
    }
  }
);
}
