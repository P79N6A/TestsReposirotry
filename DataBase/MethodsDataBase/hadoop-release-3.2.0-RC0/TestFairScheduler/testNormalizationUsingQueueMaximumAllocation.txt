@Test public void testNormalizationUsingQueueMaximumAllocation() throws IOException {
  int queueMaxAllocation=4096;
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println(" <queue name=\"queueA\">");
  out.println("  <maxContainerAllocation>" + queueMaxAllocation + " mb 1 vcores"+ "</maxContainerAllocation>");
  out.println(" </queue>");
  out.println(" <queue name=\"queueB\">");
  out.println(" </queue>");
  out.println("</allocations>");
  out.close();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  allocateAppAttempt("root.queueA",1,queueMaxAllocation + 1024);
  allocateAppAttempt("root.queueB",2,RM_SCHEDULER_MAXIMUM_ALLOCATION_MB_VALUE + 1024);
  scheduler.update();
  FSQueue queueToCheckA=scheduler.getQueueManager().getQueue("root.queueA");
  FSQueue queueToCheckB=scheduler.getQueueManager().getQueue("root.queueB");
  assertEquals(queueMaxAllocation,queueToCheckA.getDemand().getMemorySize());
  assertEquals(RM_SCHEDULER_MAXIMUM_ALLOCATION_MB_VALUE,queueToCheckB.getDemand().getMemorySize());
}
