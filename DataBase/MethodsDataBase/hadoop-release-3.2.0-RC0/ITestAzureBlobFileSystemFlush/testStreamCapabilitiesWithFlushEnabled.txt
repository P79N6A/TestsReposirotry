@Test public void testStreamCapabilitiesWithFlushEnabled() throws Exception {
  final AzureBlobFileSystem fs=this.getFileSystem();
  byte[] buffer=getRandomBytesArray();
  final Path testFilePath=path(methodName.getMethodName());
  try (FSDataOutputStream stream=getStreamAfterWrite(fs,testFilePath,buffer,true)){
    assertTrue(stream.hasCapability(StreamCapabilities.HFLUSH));
    assertTrue(stream.hasCapability(StreamCapabilities.HSYNC));
    assertFalse(stream.hasCapability(StreamCapabilities.DROPBEHIND));
    assertFalse(stream.hasCapability(StreamCapabilities.READAHEAD));
    assertFalse(stream.hasCapability(StreamCapabilities.UNBUFFER));
  }
 }
