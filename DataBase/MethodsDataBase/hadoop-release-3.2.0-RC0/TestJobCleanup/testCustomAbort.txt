/** 
 * Test if a failed job with custom committer runs the abort code.
 * @throws IOException
 */
@Test public void testCustomAbort() throws IOException {
  testSuccessfulJob(FileOutputCommitter.SUCCEEDED_FILE_NAME,CommitterWithCustomAbort.class,new String[]{ABORT_FAILED_FILE_NAME,ABORT_KILLED_FILE_NAME});
  testFailedJob(ABORT_FAILED_FILE_NAME,CommitterWithCustomAbort.class,new String[]{FileOutputCommitter.SUCCEEDED_FILE_NAME,ABORT_KILLED_FILE_NAME});
  testKilledJob(ABORT_KILLED_FILE_NAME,CommitterWithCustomAbort.class,new String[]{FileOutputCommitter.SUCCEEDED_FILE_NAME,ABORT_FAILED_FILE_NAME});
}
