/** 
 * A basic test to verify that we can write data and read it back again.
 * @throws Exception
 */
@Test public void testReadBack() throws Exception {
  File dbFile=Files.createTempDirectory("fileregionformat").toFile();
  try {
    LevelDBFileRegionAliasMap frf=new LevelDBFileRegionAliasMap();
    LevelDBFileRegionAliasMap.LevelDBOptions opts=new LevelDBFileRegionAliasMap.LevelDBOptions().filename(dbFile.getAbsolutePath());
    BlockAliasMap.Writer<FileRegion> writer=frf.getWriter(opts,BPID);
    FileRegion fr=new FileRegion(1,new Path("/file"),1,1,1);
    writer.store(fr);
    writer.close();
    BlockAliasMap.Reader<FileRegion> reader=frf.getReader(opts,BPID);
    FileRegion fr2=reader.resolve(new Block(1,1,1)).get();
    assertEquals(fr,fr2);
    reader.close();
  }
  finally {
    dbFile.delete();
  }
}
