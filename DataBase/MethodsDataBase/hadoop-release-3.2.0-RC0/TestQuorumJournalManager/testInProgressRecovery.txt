@Test public void testInProgressRecovery() throws Exception {
  EditLogOutputStream stm=qjm.startLogSegment(1,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  writeTxns(stm,1,5);
  writeTxns(stm,6,3);
  QuorumJournalManager qjm2=createSpyingQJM();
  qjm2.recoverUnfinalizedSegments();
  checkRecovery(cluster,1,8);
  List<EditLogInputStream> streams=new ArrayList<>();
  qjm2.selectInputStreams(streams,1,true,true);
  verifyEdits(streams,1,8);
}
