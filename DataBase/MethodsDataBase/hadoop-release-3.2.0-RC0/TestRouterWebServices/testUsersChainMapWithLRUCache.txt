/** 
 * Test if the different chains for users are generated, and LRU cache is working as expected.
 */
@Test public void testUsersChainMapWithLRUCache() throws YarnException, IOException, InterruptedException {
  getInterceptorChain("test1");
  getInterceptorChain("test2");
  getInterceptorChain("test3");
  getInterceptorChain("test4");
  getInterceptorChain("test5");
  getInterceptorChain("test6");
  getInterceptorChain("test7");
  getInterceptorChain("test8");
  Map<String,RequestInterceptorChainWrapper> pipelines=getRouterWebServices().getPipelines();
  Assert.assertEquals(8,pipelines.size());
  getInterceptorChain("test9");
  getInterceptorChain("test10");
  getInterceptorChain("test1");
  getInterceptorChain("test11");
  Assert.assertEquals(10,pipelines.size());
  RequestInterceptorChainWrapper chain=pipelines.get("test1");
  Assert.assertNotNull("test1 should not be evicted",chain);
  chain=pipelines.get("test2");
  Assert.assertNull("test2 should have been evicted",chain);
}
