/** 
 * Partial block movement with BlockMovementStatus#DN_BLK_STORAGE_MOVEMENT_SUCCESS. Here, first occurrence is #blockStorageMovementReportedItemsCheck() and then #blocksStorageMovementUnReportedItemsCheck().
 */
@Test(timeout=30000) public void testPartialBlockMovementShouldBeRetried1() throws Exception {
  Long item=new Long(1234);
  Block block1=new Block(item);
  Block block2=new Block(5678L);
  Long trackID=0L;
  DatanodeInfo dnInfo=DFSTestUtil.getLocalDatanodeInfo(9867);
  Set<StorageTypeNodePair> locs=new HashSet<>();
  locs.add(new StorageTypeNodePair(StorageType.ARCHIVE,dnInfo));
  Map<Block,Set<StorageTypeNodePair>> blocksMap=new HashMap<>();
  blocksMap.put(block1,locs);
  blocksMap.put(block2,locs);
  bsmAttemptedItems.add(trackID,trackID,0L,blocksMap,0);
  bsmAttemptedItems.notifyReportedBlock(dnInfo,StorageType.ARCHIVE,block1);
  bsmAttemptedItems.start();
  assertTrue("Failed to add to the retry list",checkItemMovedForRetry(trackID,5000));
  assertEquals("Failed to remove from the attempted list",0,bsmAttemptedItems.getAttemptedItemsCount());
}
