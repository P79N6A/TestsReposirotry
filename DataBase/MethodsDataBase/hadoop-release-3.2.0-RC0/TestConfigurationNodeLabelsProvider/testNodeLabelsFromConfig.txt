@Test public void testNodeLabelsFromConfig() throws IOException, InterruptedException {
  Configuration conf=new Configuration();
  modifyConf("A");
  nodeLabelsProvider.init(conf);
  nodeLabelsProvider.start();
  assertNLCollectionEquals(toNodeLabelSet("A"),nodeLabelsProvider.getDescriptors());
  TimerTask timerTask=nodeLabelsProvider.getTimerTask();
  modifyConf("X");
  timerTask.run();
  assertNLCollectionEquals(toNodeLabelSet("X"),nodeLabelsProvider.getDescriptors());
}
