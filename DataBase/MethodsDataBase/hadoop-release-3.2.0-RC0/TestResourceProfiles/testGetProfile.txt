@Test public void testGetProfile() throws Exception {
  Configuration conf=new Configuration();
  conf.setBoolean(YarnConfiguration.RM_RESOURCE_PROFILES_ENABLED,true);
  ResourceProfilesManager manager=new ResourceProfilesManagerImpl();
  conf.set(YarnConfiguration.RM_RESOURCE_PROFILES_SOURCE_FILE,"profiles/sample-profiles-2.json");
  manager.init(conf);
  Map<String,Resource> expected=new HashMap<>();
  expected.put("minimum",Resource.newInstance(1024,1));
  expected.put("default",Resource.newInstance(2048,2));
  expected.put("maximum",Resource.newInstance(8192,4));
  expected.put("small",Resource.newInstance(1024,1));
  expected.put("medium",Resource.newInstance(2048,1));
  expected.put("large",Resource.newInstance(4096,4));
  for (  Map.Entry<String,Resource> entry : expected.entrySet()) {
    String profile=entry.getKey();
    Resource res=entry.getValue();
    Assert.assertEquals("Profile " + profile + "' resources don't match",res,manager.getProfile(profile));
  }
}
