@Test public void testLoadProfiles() throws Exception {
  ResourceProfilesManager manager=new ResourceProfilesManagerImpl();
  Configuration conf=new Configuration();
  conf.setBoolean(YarnConfiguration.RM_RESOURCE_PROFILES_ENABLED,true);
  conf.set(YarnConfiguration.RM_RESOURCE_PROFILES_SOURCE_FILE,"profiles/sample-profiles-1.json");
  manager.init(conf);
  Map<String,Resource> profiles=manager.getResourceProfiles();
  Map<String,Resource> expected=new HashMap<>();
  expected.put("minimum",Resource.newInstance(1024,1));
  expected.put("default",Resource.newInstance(2048,2));
  expected.put("maximum",Resource.newInstance(8192,4));
  for (  Map.Entry<String,Resource> entry : expected.entrySet()) {
    String profile=entry.getKey();
    Resource res=entry.getValue();
    Assert.assertTrue("Mandatory profile '" + profile + "' missing",profiles.containsKey(profile));
    Assert.assertEquals("Profile " + profile + "' resources don't match",res,manager.getProfile(profile));
  }
}
