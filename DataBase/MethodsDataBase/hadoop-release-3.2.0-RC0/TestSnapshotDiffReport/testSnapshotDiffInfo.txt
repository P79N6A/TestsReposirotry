@Test public void testSnapshotDiffInfo() throws Exception {
  Path snapshotRootDirPath=dir;
  Path snapshotDirDescendantPath=new Path(snapshotRootDirPath,"desc");
  Path snapshotDirNonDescendantPath=new Path("/dummy/non/snap/desc");
  hdfs.mkdirs(snapshotDirDescendantPath);
  hdfs.mkdirs(snapshotDirNonDescendantPath);
  hdfs.allowSnapshot(snapshotRootDirPath);
  hdfs.createSnapshot(snapshotRootDirPath,"s0");
  hdfs.createSnapshot(snapshotRootDirPath,"s1");
  INodeDirectory snapshotRootDir=cluster.getNameNode().getNamesystem().getFSDirectory().getINode(snapshotRootDirPath.toUri().getPath()).asDirectory();
  INodeDirectory snapshotRootDescendantDir=cluster.getNameNode().getNamesystem().getFSDirectory().getINode(snapshotDirDescendantPath.toUri().getPath()).asDirectory();
  INodeDirectory snapshotRootNonDescendantDir=cluster.getNameNode().getNamesystem().getFSDirectory().getINode(snapshotDirNonDescendantPath.toUri().getPath()).asDirectory();
  try {
    SnapshotDiffInfo sdi=new SnapshotDiffInfo(snapshotRootDir,snapshotRootDescendantDir,new Snapshot(0,"s0",snapshotRootDescendantDir),new Snapshot(0,"s1",snapshotRootDescendantDir));
    LOG.info("SnapshotDiffInfo: " + sdi.getFrom() + " - "+ sdi.getTo());
  }
 catch (  IllegalArgumentException iae) {
    fail("Unexpected exception when constructing SnapshotDiffInfo: " + iae);
  }
  try {
    SnapshotDiffInfo sdi=new SnapshotDiffInfo(snapshotRootDir,snapshotRootNonDescendantDir,new Snapshot(0,"s0",snapshotRootNonDescendantDir),new Snapshot(0,"s1",snapshotRootNonDescendantDir));
    LOG.info("SnapshotDiffInfo: " + sdi.getFrom() + " - "+ sdi.getTo());
    fail("SnapshotDiffInfo construction should fail for non snapshot root " + "or non snapshot root descendant directories!");
  }
 catch (  IllegalArgumentException iae) {
  }
}
