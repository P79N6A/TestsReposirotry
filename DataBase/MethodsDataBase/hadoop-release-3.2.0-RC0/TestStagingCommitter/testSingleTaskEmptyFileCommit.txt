/** 
 * This originally verified that empty files weren't PUT. They are now.
 * @throws Exception on a failure
 */
@Test public void testSingleTaskEmptyFileCommit() throws Exception {
  committer.setupTask(tac);
  Path attemptPath=committer.getTaskAttemptPath(tac);
  String rand=UUID.randomUUID().toString();
  writeOutputFile(tac.getTaskAttemptID(),attemptPath,rand,0);
  committer.commitTask(tac);
  List<String> uploads=results.getUploads();
  assertEquals("Should initiate one upload",1,uploads.size());
  Path committedPath=committer.getCommittedTaskPath(tac);
  FileSystem dfs=committedPath.getFileSystem(conf);
  assertEquals("Should commit to HDFS",getDFS(),dfs);
  assertIsFile(dfs,committedPath);
  FileStatus[] stats=dfs.listStatus(committedPath);
  assertEquals("Should produce one commit file",1,stats.length);
  assertEquals("Should name the commits file with the task ID","task_job_0001_r_000002",stats[0].getPath().getName());
  PendingSet pending=PendingSet.load(dfs,stats[0].getPath());
  assertEquals("Should have one pending commit",1,pending.size());
}
