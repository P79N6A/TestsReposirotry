/** 
 * Tests the computation logic of uncompressed input bytes by {@link LoadJob#getUncompressedInputBytes(long,Configuration)}
 */
@Test public void testComputeUncompressedInputBytes(){
  long possiblyCompressedInputBytes=100000;
  float compressionRatio=0.45F;
  Configuration conf=new Configuration();
  CompressionEmulationUtil.setMapInputCompressionEmulationRatio(conf,compressionRatio);
  long result=CompressionEmulationUtil.getUncompressedInputBytes(possiblyCompressedInputBytes,conf);
  assertEquals(possiblyCompressedInputBytes,result);
  CompressionEmulationUtil.setInputCompressionEmulationEnabled(conf,true);
  result=CompressionEmulationUtil.getUncompressedInputBytes(possiblyCompressedInputBytes,conf);
  assertEquals((long)(possiblyCompressedInputBytes / compressionRatio),result);
}
