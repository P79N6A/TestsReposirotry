@Test public void testListStatusOfSnapshotDirs() throws IOException {
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(new HdfsConfiguration()).build();
  try {
    DistributedFileSystem dfs=cluster.getFileSystem();
    dfs.create(new Path("/parent/test1/dfsclose/file-0"));
    Path snapShotDir=new Path("/parent/test1/");
    dfs.allowSnapshot(snapShotDir);
    FileStatus status=dfs.getFileStatus(new Path("/parent/test1"));
    assertTrue(status.isSnapshotEnabled());
    status=dfs.getFileStatus(new Path("/parent/"));
    assertFalse(status.isSnapshotEnabled());
  }
  finally {
    cluster.shutdown();
  }
}
