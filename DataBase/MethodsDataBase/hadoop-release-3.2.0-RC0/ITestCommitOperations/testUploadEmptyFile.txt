@Test public void testUploadEmptyFile() throws Throwable {
  File tempFile=File.createTempFile("commit",".txt");
  CommitOperations actions=newCommitOperations();
  Path dest=methodPath("testUploadEmptyFile");
  S3AFileSystem fs=getFileSystem();
  fs.delete(dest,false);
  fullThrottle();
  SinglePendingCommit pendingCommit=actions.uploadFileToPendingCommit(tempFile,dest,null,DEFAULT_MULTIPART_SIZE);
  resetFailures();
  assertPathDoesNotExist("pending commit",dest);
  fullThrottle();
  actions.commitOrFail(pendingCommit);
  resetFailures();
  FileStatus status=verifyPathExists(fs,"uploaded file commit",dest);
  assertEquals("File length in " + status,0,status.getLen());
}
