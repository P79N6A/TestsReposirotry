@Test public void testRun() throws Exception {
  final URI uri=cluster.getFileSystem().getUri();
  final String pathString=uri.toString();
  Path fileSystemPath=new Path(pathString);
  Path source=new Path(fileSystemPath.toString() + "/tmp/source");
  Path target=new Path(fileSystemPath.toString() + "/tmp/target");
  Path listingPath=new Path(fileSystemPath.toString() + "/tmp/META/fileList.seq");
  DistCpOptions options=new DistCpOptions.Builder(Collections.singletonList(source),target).build();
  DistCpContext context=new DistCpContext(options);
  context.setTargetPathExists(false);
  new GlobbedCopyListing(new Configuration(),CREDENTIALS).buildListing(listingPath,context);
  verifyContents(listingPath);
}
