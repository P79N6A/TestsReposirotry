@Test public void testNamenodeMonitoring() throws Exception {
  for (  String ns : cluster.getNameservices()) {
    cluster.switchToActive(ns,"nn0");
    cluster.switchToStandby(ns,"nn1");
  }
  Collection<NamenodeHeartbeatService> heartbeatServices=routerContext.getRouter().getNamenodeHearbeatServices();
  for (  NamenodeHeartbeatService service : heartbeatServices) {
    service.periodicInvoke();
  }
  resolver.loadCache(true);
  List<? extends FederationNamenodeContext> namespaceInfo0=resolver.getNamenodesForNameserviceId(ns0);
  List<? extends FederationNamenodeContext> namespaceInfo1=resolver.getNamenodesForNameserviceId(ns1);
  assertEquals("nn0",namespaceInfo0.get(1).getNamenodeId());
  assertTrue(namespaceInfo0.get(1).getDateModified() < initializedTime);
  assertEquals("nn1",namespaceInfo0.get(0).getNamenodeId());
  assertTrue(namespaceInfo0.get(0).getDateModified() > initializedTime);
  assertEquals("nn0",namespaceInfo1.get(0).getNamenodeId());
  assertTrue(namespaceInfo1.get(0).getDateModified() > initializedTime);
  assertEquals("nn1",namespaceInfo1.get(1).getNamenodeId());
  assertTrue(namespaceInfo1.get(1).getDateModified() > initializedTime);
}
