@Test public void testSingleAppend() throws Throwable {
  FSDataOutputStream appendStream=null;
  try {
    int baseDataSize=50;
    byte[] baseDataBuffer=createBaseFileWithData(baseDataSize,testPath);
    int appendDataSize=20;
    byte[] appendDataBuffer=getTestData(appendDataSize);
    appendStream=fs.append(testPath,10);
    appendStream.write(appendDataBuffer);
    appendStream.close();
    byte[] testData=new byte[baseDataSize + appendDataSize];
    System.arraycopy(baseDataBuffer,0,testData,0,baseDataSize);
    System.arraycopy(appendDataBuffer,0,testData,baseDataSize,appendDataSize);
    assertTrue(verifyAppend(testData,testPath));
  }
  finally {
    if (appendStream != null) {
      appendStream.close();
    }
  }
}
