@Test public void testNodeAttributesFunctionality(){
  SchedulingRequest schedulingRequest=SchedulingRequest.newBuilder().executionType(ExecutionTypeRequest.newInstance(ExecutionType.GUARANTEED)).allocationRequestId(10L).priority(Priority.newInstance(1)).placementConstraintExpression(PlacementConstraints.targetNodeAttribute(PlacementConstraints.NODE,NodeAttributeOpCode.EQ,PlacementConstraints.PlacementTargets.nodeAttribute("java","1.8"),PlacementConstraints.PlacementTargets.nodePartition("")).build()).resourceSizing(ResourceSizing.newInstance(1,Resource.newInstance(1024,1))).build();
  allocator.updatePendingAsk(schedulerRequestKey,schedulingRequest,false);
  Set<NodeAttribute> attributes=new HashSet<>();
  attributes.add(NodeAttribute.newInstance("java",NodeAttributeType.STRING,"1.8"));
  boolean result=allocator.canAllocate(NodeType.NODE_LOCAL,TestUtils.getMockNodeWithAttributes("host1","/rack1",123,1024,attributes));
  Assert.assertTrue("Allocation should be success for java=1.8",result);
  SchedulingRequest schedulingRequest2=SchedulingRequest.newBuilder().executionType(ExecutionTypeRequest.newInstance(ExecutionType.GUARANTEED)).allocationRequestId(10L).priority(Priority.newInstance(1)).placementConstraintExpression(PlacementConstraints.targetNodeAttribute(PlacementConstraints.NODE,NodeAttributeOpCode.NE,PlacementConstraints.PlacementTargets.nodeAttribute("python","3"),PlacementConstraints.PlacementTargets.nodePartition("")).build()).resourceSizing(ResourceSizing.newInstance(1,Resource.newInstance(1024,1))).build();
  allocator=new SingleConstraintAppPlacementAllocator();
  allocator.initialize(appSchedulingInfo,schedulerRequestKey,rmContext);
  allocator.updatePendingAsk(schedulerRequestKey,schedulingRequest2,false);
  attributes=new HashSet<>();
  result=allocator.canAllocate(NodeType.NODE_LOCAL,TestUtils.getMockNodeWithAttributes("host1","/rack1",123,1024,attributes));
  Assert.assertTrue("Allocation should be success as python doesn't exist",result);
  allocator=new SingleConstraintAppPlacementAllocator();
  allocator.initialize(appSchedulingInfo,schedulerRequestKey,rmContext);
  allocator.updatePendingAsk(schedulerRequestKey,schedulingRequest2,false);
  attributes=new HashSet<>();
  attributes.add(NodeAttribute.newInstance("python",NodeAttributeType.STRING,"2"));
  result=allocator.canAllocate(NodeType.NODE_LOCAL,TestUtils.getMockNodeWithAttributes("host1","/rack1",123,1024,attributes));
  Assert.assertTrue("Allocation should be success as python=3 doesn't exist in node",result);
  allocator=new SingleConstraintAppPlacementAllocator();
  allocator.initialize(appSchedulingInfo,schedulerRequestKey,rmContext);
  allocator.updatePendingAsk(schedulerRequestKey,schedulingRequest2,false);
  attributes=new HashSet<>();
  attributes.add(NodeAttribute.newInstance("python",NodeAttributeType.STRING,"3"));
  result=allocator.canAllocate(NodeType.NODE_LOCAL,TestUtils.getMockNodeWithAttributes("host1","/rack1",123,1024,attributes));
  Assert.assertFalse("Allocation should fail as python=3 exist in node",result);
}
