/** 
 * Set the version value to a different number and verify that table init fails.
 */
@Test public void testTableVersionMismatch() throws Exception {
  String tableName="testTableVersionMismatch";
  Configuration conf=getFileSystem().getConf();
  conf.set(S3GUARD_DDB_TABLE_NAME_KEY,tableName);
  try (DynamoDBMetadataStore ddbms=new DynamoDBMetadataStore()){
    ddbms.initialize(conf);
    Table table=verifyTableInitialized(tableName,ddbms.getDynamoDB());
    table.deleteItem(VERSION_MARKER_PRIMARY_KEY);
    Item v200=createVersionMarker(VERSION_MARKER,200,0);
    table.putItem(v200);
    intercept(IOException.class,E_INCOMPATIBLE_VERSION,() -> ddbms.initTable());
    ddbms.destroy();
  }
 }
