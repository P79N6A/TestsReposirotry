@Test public void testProvisionTable() throws IOException {
  final String tableName="testProvisionTable";
  Configuration conf=getFileSystem().getConf();
  conf.set(S3GUARD_DDB_TABLE_NAME_KEY,tableName);
  try (DynamoDBMetadataStore ddbms=new DynamoDBMetadataStore()){
    ddbms.initialize(conf);
    DynamoDB dynamoDB=ddbms.getDynamoDB();
    final ProvisionedThroughputDescription oldProvision=dynamoDB.getTable(tableName).describe().getProvisionedThroughput();
    ddbms.provisionTable(oldProvision.getReadCapacityUnits() * 2,oldProvision.getWriteCapacityUnits() * 2);
    ddbms.initTable();
    final ProvisionedThroughputDescription newProvision=dynamoDB.getTable(tableName).describe().getProvisionedThroughput();
    LOG.info("Old provision = {}, new provision = {}",oldProvision,newProvision);
    assertEquals(oldProvision.getReadCapacityUnits() * 2,newProvision.getReadCapacityUnits().longValue());
    assertEquals(oldProvision.getWriteCapacityUnits() * 2,newProvision.getWriteCapacityUnits().longValue());
    ddbms.destroy();
  }
 }
