/** 
 * Test that initTable fails with IOException when table does not exist and table auto-creation is disabled.
 */
@Test public void testFailNonexistentTable() throws IOException {
  final String tableName="testFailNonexistentTable";
  final S3AFileSystem s3afs=getFileSystem();
  final Configuration conf=s3afs.getConf();
  conf.set(S3GUARD_DDB_TABLE_NAME_KEY,tableName);
  conf.unset(S3GUARD_DDB_TABLE_CREATE_KEY);
  try (DynamoDBMetadataStore ddbms=new DynamoDBMetadataStore()){
    ddbms.initialize(s3afs);
    fail("Should have failed as table does not exist and table auto-creation" + " is disabled");
  }
 catch (  IOException ignored) {
  }
}
