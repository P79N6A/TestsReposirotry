@Test public void testTableTagging() throws IOException {
  final Configuration conf=getFileSystem().getConf();
  conf.getPropsWithPrefix(S3GUARD_DDB_TABLE_TAG).keySet().forEach(propKey -> conf.unset(S3GUARD_DDB_TABLE_TAG + propKey));
  String tableName="testTableTagging-" + UUID.randomUUID();
  conf.set(S3GUARD_DDB_TABLE_NAME_KEY,tableName);
  conf.set(S3GUARD_DDB_TABLE_CREATE_KEY,"true");
  Map<String,String> tagMap=new HashMap<>();
  tagMap.put("hello","dynamo");
  tagMap.put("tag","youre it");
  for (  Map.Entry<String,String> tagEntry : tagMap.entrySet()) {
    conf.set(S3GUARD_DDB_TABLE_TAG + tagEntry.getKey(),tagEntry.getValue());
  }
  try (DynamoDBMetadataStore ddbms=new DynamoDBMetadataStore()){
    ddbms.initialize(conf);
    assertNotNull(ddbms.getTable());
    assertEquals(tableName,ddbms.getTable().getTableName());
    ListTagsOfResourceRequest listTagsOfResourceRequest=new ListTagsOfResourceRequest().withResourceArn(ddbms.getTable().getDescription().getTableArn());
    List<Tag> tags=ddbms.getAmazonDynamoDB().listTagsOfResource(listTagsOfResourceRequest).getTags();
    assertEquals(tagMap.size(),tags.size());
    for (    Tag tag : tags) {
      Assert.assertEquals(tagMap.get(tag.getKey()),tag.getValue());
    }
  }
 }
