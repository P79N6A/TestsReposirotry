@Test public void testDeleteTable() throws Exception {
  final String tableName="testDeleteTable";
  Path testPath=new Path(new Path(fsUri),"/" + tableName);
  final S3AFileSystem s3afs=getFileSystem();
  final Configuration conf=s3afs.getConf();
  conf.set(S3GUARD_DDB_TABLE_NAME_KEY,tableName);
  try (DynamoDBMetadataStore ddbms=new DynamoDBMetadataStore()){
    ddbms.initialize(s3afs);
    ddbms.listChildren(testPath);
    DynamoDB dynamoDB=ddbms.getDynamoDB();
    ddbms.destroy();
    verifyTableNotExist(tableName,dynamoDB);
    ddbms.destroy();
    verifyTableNotExist(tableName,dynamoDB);
    try {
      ddbms.listChildren(testPath);
      fail("Should have failed after the table is destroyed!");
    }
 catch (    IOException ignored) {
    }
    ddbms.destroy();
  }
 }
