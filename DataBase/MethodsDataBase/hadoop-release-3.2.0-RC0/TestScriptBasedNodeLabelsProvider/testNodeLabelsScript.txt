@Test public void testNodeLabelsScript() throws Exception {
  String scriptWithoutLabels="";
  String normalScript="echo NODE_PARTITION:Windows";
  String scrptWithMultipleLinesHavingNodeLabels="echo NODE_PARTITION:RAM\n echo NODE_PARTITION:JDK1_6";
  String timeOutScript=Shell.WINDOWS ? "@echo off\nping -n 4 127.0.0.1 >nul\n" + "echo NODE_PARTITION:ALL" : "sleep 4\necho NODE_PARTITION:ALL";
  writeNodeLabelsScriptFile(scriptWithoutLabels,true);
  nodeLabelsProvider.init(getConfForNodeLabelScript());
  nodeLabelsProvider.start();
  Thread.sleep(500l);
  TimerTask timerTask=nodeLabelsProvider.getTimerTask();
  timerTask.run();
  Assert.assertNull("Node Label Script runner should return null when script doesnt " + "give any Labels output",nodeLabelsProvider.getDescriptors());
  writeNodeLabelsScriptFile(normalScript,true);
  timerTask.run();
  assertNLCollectionEquals(toNodeLabelSet("Windows"),nodeLabelsProvider.getDescriptors());
  writeNodeLabelsScriptFile(scrptWithMultipleLinesHavingNodeLabels,true);
  timerTask.run();
  assertNLCollectionEquals(toNodeLabelSet("JDK1_6"),nodeLabelsProvider.getDescriptors());
  writeNodeLabelsScriptFile(timeOutScript,true);
  timerTask.run();
  Assert.assertNotEquals("Node Labels should not be set after timeout ",toNodeLabelSet("ALL"),nodeLabelsProvider.getDescriptors());
}
