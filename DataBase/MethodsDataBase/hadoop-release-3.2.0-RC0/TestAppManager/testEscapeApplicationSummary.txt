@Test(timeout=30000) public void testEscapeApplicationSummary(){
  RMApp app=mock(RMAppImpl.class);
  when(app.getApplicationId()).thenReturn(ApplicationId.newInstance(100L,1));
  when(app.getName()).thenReturn("Multiline\n\n\r\rAppName");
  when(app.getUser()).thenReturn("Multiline\n\n\r\rUserName");
  when(app.getQueue()).thenReturn("Multiline\n\n\r\rQueueName");
  when(app.getState()).thenReturn(RMAppState.RUNNING);
  when(app.getApplicationType()).thenReturn("MAPREDUCE");
  when(app.getSubmitTime()).thenReturn(1000L);
  Map<String,Long> resourceSecondsMap=new HashMap<>();
  resourceSecondsMap.put(ResourceInformation.MEMORY_MB.getName(),16384L);
  resourceSecondsMap.put(ResourceInformation.VCORES.getName(),64L);
  RMAppMetrics metrics=new RMAppMetrics(Resource.newInstance(1234,56),10,1,resourceSecondsMap,new HashMap<>());
  when(app.getRMAppMetrics()).thenReturn(metrics);
  RMAppManager.ApplicationSummary.SummaryBuilder summary=new RMAppManager.ApplicationSummary().createAppSummary(app);
  String msg=summary.toString();
  LOG.info("summary: " + msg);
  Assert.assertFalse(msg.contains("\n"));
  Assert.assertFalse(msg.contains("\r"));
  String escaped="\\n\\n\\r\\r";
  assertTrue(msg.contains("Multiline" + escaped + "AppName"));
  assertTrue(msg.contains("Multiline" + escaped + "UserName"));
  assertTrue(msg.contains("Multiline" + escaped + "QueueName"));
  assertTrue(msg.contains("submitTime=1000"));
  assertTrue(msg.contains("memorySeconds=16384"));
  assertTrue(msg.contains("vcoreSeconds=64"));
  assertTrue(msg.contains("preemptedAMContainers=1"));
  assertTrue(msg.contains("preemptedNonAMContainers=10"));
  assertTrue(msg.contains("preemptedResources=<memory:1234\\, vCores:56>"));
  assertTrue(msg.contains("applicationType=MAPREDUCE"));
}
