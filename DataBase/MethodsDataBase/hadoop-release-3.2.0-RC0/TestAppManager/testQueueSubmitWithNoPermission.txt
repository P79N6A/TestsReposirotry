@Test public void testQueueSubmitWithNoPermission() throws IOException {
  YarnConfiguration conf=new YarnConfiguration();
  conf.set(PREFIX + "root.acl_submit_applications"," ");
  conf.set(PREFIX + "root.acl_administer_queue"," ");
  conf.set(PREFIX + "root.default.acl_submit_applications"," ");
  conf.set(PREFIX + "root.default.acl_administer_queue"," ");
  conf.set(YarnConfiguration.YARN_ACL_ENABLE,"true");
  MockRM mockRM=new MockRM(conf);
  ClientRMService rmService=mockRM.getClientRMService();
  SubmitApplicationRequest req=Records.newRecord(SubmitApplicationRequest.class);
  ApplicationSubmissionContext sub=Records.newRecord(ApplicationSubmissionContext.class);
  sub.setApplicationId(appId);
  ResourceRequest resReg=ResourceRequest.newInstance(Priority.newInstance(0),ResourceRequest.ANY,Resource.newInstance(1024,1),1);
  sub.setAMContainerResourceRequests(Collections.singletonList(resReg));
  req.setApplicationSubmissionContext(sub);
  sub.setAMContainerSpec(mock(ContainerLaunchContext.class));
  try {
    rmService.submitApplication(req);
  }
 catch (  Exception e) {
    e.printStackTrace();
    if (e instanceof YarnException) {
      assertTrue(e.getCause() instanceof AccessControlException);
    }
 else {
      Assert.fail("Yarn exception is expected : " + e.getMessage());
    }
  }
 finally {
    mockRM.close();
  }
}
