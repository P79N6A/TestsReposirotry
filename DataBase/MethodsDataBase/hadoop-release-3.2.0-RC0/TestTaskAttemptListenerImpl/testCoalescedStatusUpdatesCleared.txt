@Test public void testCoalescedStatusUpdatesCleared() throws IOException, InterruptedException {
  configureMocks();
  startListener(true);
  listener.statusUpdate(attemptID,firstReduceStatus);
  listener.statusUpdate(attemptID,secondReduceStatus);
  ConcurrentMap<TaskAttemptId,AtomicReference<TaskAttemptStatus>> attemptIdToStatus=listener.getAttemptIdToStatus();
  attemptIdToStatus.get(attemptId).set(null);
  listener.statusUpdate(attemptID,thirdReduceStatus);
  verify(ea,times(2)).handle(eventCaptor.capture());
  TaskAttemptStatusUpdateEvent updateEvent=(TaskAttemptStatusUpdateEvent)eventCaptor.getValue();
  TaskAttemptStatus status=updateEvent.getTaskAttemptStatusRef().get();
  assertNull(status.fetchFailedMaps);
  assertEquals(Phase.REDUCE,status.phase);
}
