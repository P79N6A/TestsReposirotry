@Test public void testMetrics() throws Exception {
  disableNameservice("ns0");
  int numActive=0;
  int numDisabled=0;
  Router router=routerContext.getRouter();
  FederationMetrics metrics=router.getMetrics();
  String jsonString=metrics.getNameservices();
  JSONObject jsonObject=new JSONObject(jsonString);
  Iterator<?> keys=jsonObject.keys();
  while (keys.hasNext()) {
    String key=(String)keys.next();
    JSONObject json=jsonObject.getJSONObject(key);
    String nsId=json.getString("nameserviceId");
    String state=json.getString("state");
    if (nsId.equals("ns0")) {
      assertEquals("DISABLED",state);
      numDisabled++;
    }
 else {
      assertEquals("ACTIVE",state);
      numActive++;
    }
  }
  assertEquals(1,numActive);
  assertEquals(1,numDisabled);
}
