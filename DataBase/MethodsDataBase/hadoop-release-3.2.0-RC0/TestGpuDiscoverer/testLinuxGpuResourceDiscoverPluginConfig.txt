@Test public void testLinuxGpuResourceDiscoverPluginConfig() throws Exception {
  Assume.assumeTrue(Boolean.valueOf(System.getProperty("RunLinuxGpuResourceDiscoverPluginConfigTest")));
  Configuration conf=new Configuration(false);
  GpuDiscoverer plugin=new GpuDiscoverer();
  plugin.initialize(conf);
  Assert.assertEquals(GpuDiscoverer.DEFAULT_BINARY_NAME,plugin.getPathOfGpuBinary());
  Assert.assertNotNull(plugin.getEnvironmentToRunCommand().get("PATH"));
  Assert.assertTrue(plugin.getEnvironmentToRunCommand().get("PATH").contains("nvidia"));
  File fakeBinary=new File(getTestParentFolder(),GpuDiscoverer.DEFAULT_BINARY_NAME);
  touchFile(fakeBinary);
  conf.set(YarnConfiguration.NM_GPU_PATH_TO_EXEC,getTestParentFolder());
  plugin=new GpuDiscoverer();
  plugin.initialize(conf);
  Assert.assertEquals(fakeBinary.getAbsolutePath(),plugin.getPathOfGpuBinary());
  Assert.assertNull(plugin.getEnvironmentToRunCommand().get("PATH"));
  fakeBinary.delete();
  plugin=new GpuDiscoverer();
  plugin.initialize(conf);
  Assert.assertEquals(GpuDiscoverer.DEFAULT_BINARY_NAME,plugin.getPathOfGpuBinary());
  Assert.assertTrue(plugin.getEnvironmentToRunCommand().get("PATH").contains("nvidia"));
}
