@Test public void testCLCPBImplNullResourceVisibility() throws IOException {
  RecordFactory recordFactory=RecordFactoryProvider.getRecordFactory(null);
  try {
    LocalResource resource=recordFactory.newRecordInstance(LocalResource.class);
    resource.setResource(URL.fromPath(new Path(".")));
    resource.setSize(-1);
    resource.setVisibility(null);
    resource.setType(LocalResourceType.FILE);
    resource.setTimestamp(System.currentTimeMillis());
    Map<String,LocalResource> localResources=new HashMap<String,LocalResource>();
    localResources.put("null_visibility_resource",resource);
    ContainerLaunchContext containerLaunchContext=recordFactory.newRecordInstance(ContainerLaunchContext.class);
    containerLaunchContext.setLocalResources(localResources);
    Assert.fail("Setting an invalid local resource should be an error!");
  }
 catch (  NullPointerException e) {
    Assert.assertTrue(e.getMessage().contains("Null resource visibility for local resource"));
  }
}
