/** 
 * Validates the implementation of Seekable.seek and ensures there is no network I/O for forward seek.
 * @throws Exception
 */
@Test public void testValidateSeekBounds() throws Exception {
  assumeHugeFileExists();
  try (FSDataInputStream inputStream=this.getFileSystem().open(TEST_FILE_PATH)){
    ContractTestUtils.NanoTimer timer=new ContractTestUtils.NanoTimer();
    inputStream.seek(0);
    assertEquals(0,inputStream.getPos());
    intercept(EOFException.class,FSExceptionMessages.NEGATIVE_SEEK,new Callable<FSDataInputStream>(){
      @Override public FSDataInputStream call() throws Exception {
        inputStream.seek(-1);
        return inputStream;
      }
    }
);
    assertTrue("Test file length only " + testFileLength,testFileLength > 0);
    inputStream.seek(testFileLength);
    assertEquals(testFileLength,inputStream.getPos());
    intercept(EOFException.class,FSExceptionMessages.CANNOT_SEEK_PAST_EOF,new Callable<FSDataInputStream>(){
      @Override public FSDataInputStream call() throws Exception {
        inputStream.seek(testFileLength + 1);
        return inputStream;
      }
    }
);
    long elapsedTimeMs=timer.elapsedTimeMs();
    assertTrue(String.format("There should not be any network I/O (elapsedTimeMs=%1$d).",elapsedTimeMs),elapsedTimeMs < MAX_ELAPSEDTIMEMS);
  }
 }
