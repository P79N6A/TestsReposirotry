@Test public void testBasicRead() throws Exception {
  assumeHugeFileExists();
  try (FSDataInputStream inputStream=this.getFileSystem().open(TEST_FILE_PATH)){
    byte[] buffer=new byte[3 * MEGABYTE];
    inputStream.seek(5 * MEGABYTE);
    int numBytesRead=inputStream.read(buffer,0,KILOBYTE);
    assertEquals("Wrong number of bytes read",KILOBYTE,numBytesRead);
    int len=MEGABYTE;
    int offset=buffer.length - len;
    inputStream.seek(3 * MEGABYTE);
    numBytesRead=inputStream.read(buffer,offset,len);
    assertEquals("Wrong number of bytes read after seek",len,numBytesRead);
  }
 }
