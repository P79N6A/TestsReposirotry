@Test @TestDir @TestJetty @TestHdfs public void testGetSnapshottableDirectoryList() throws Exception {
  createHttpFSServer(false,false);
  String pathStr1="/tmp/tmp-snap-dirlist-test-1";
  createDirWithHttp(pathStr1,"700",null);
  Path path1=new Path(pathStr1);
  String pathStr2="/tmp/tmp-snap-dirlist-test-2";
  createDirWithHttp(pathStr2,"700",null);
  Path path2=new Path(pathStr2);
  DistributedFileSystem dfs=(DistributedFileSystem)FileSystem.get(path1.toUri(),TestHdfsHelper.getHdfsConf());
  verifyGetSnapshottableDirectoryList(dfs);
  dfs.allowSnapshot(path1);
  Assert.assertTrue(dfs.getFileStatus(path1).isSnapshotEnabled());
  verifyGetSnapshottableDirectoryList(dfs);
  dfs.allowSnapshot(path2);
  Assert.assertTrue(dfs.getFileStatus(path2).isSnapshotEnabled());
  verifyGetSnapshottableDirectoryList(dfs);
  dfs.delete(path2,true);
  verifyGetSnapshottableDirectoryList(dfs);
  dfs.delete(path1,true);
  verifyGetSnapshottableDirectoryList(dfs);
}
