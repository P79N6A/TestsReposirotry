@Test public void test_0201_RandomReadTest() throws Exception {
  assumeHugeFileExists();
  try (FSDataInputStream inputStream=fs.open(TEST_FILE_PATH)){
    final int bufferSize=4 * KILOBYTE;
    byte[] buffer=new byte[bufferSize];
    long position=0;
    verifyConsistentReads(inputStream,buffer,position);
    inputStream.seek(0);
    verifyConsistentReads(inputStream,buffer,position);
    int seekPosition=2 * KILOBYTE;
    inputStream.seek(seekPosition);
    position=seekPosition;
    verifyConsistentReads(inputStream,buffer,position);
    inputStream.seek(0);
    position=0;
    verifyConsistentReads(inputStream,buffer,position);
    seekPosition=5 * KILOBYTE;
    inputStream.seek(seekPosition);
    position=seekPosition;
    verifyConsistentReads(inputStream,buffer,position);
    seekPosition=10 * KILOBYTE;
    inputStream.seek(seekPosition);
    position=seekPosition;
    verifyConsistentReads(inputStream,buffer,position);
    seekPosition=4100 * KILOBYTE;
    inputStream.seek(seekPosition);
    position=seekPosition;
    verifyConsistentReads(inputStream,buffer,position);
    for (int i=4 * 1024 * 1023; i < 5000; i++) {
      seekPosition=i;
      inputStream.seek(seekPosition);
      position=seekPosition;
      verifyConsistentReads(inputStream,buffer,position);
    }
    inputStream.seek(0);
    position=0;
    buffer=new byte[1];
    for (int i=0; i < 5000; i++) {
      assertEquals(1,inputStream.skip(1));
      position++;
      verifyConsistentReads(inputStream,buffer,position);
      position++;
    }
  }
 }
