@Test public void testAccessContainerWithWrongVersion() throws Exception {
  AzureNativeFileSystemStore store=new AzureNativeFileSystemStore();
  MockStorageInterface mockStorage=new MockStorageInterface();
  store.setAzureStorageInteractionLayer(mockStorage);
  try (FileSystem fs=new NativeAzureFileSystem(store)){
    Configuration conf=new Configuration();
    AzureBlobStorageTestAccount.setMockAccountKey(conf);
    HashMap<String,String> metadata=new HashMap<String,String>();
    metadata.put(AzureNativeFileSystemStore.VERSION_METADATA_KEY,"2090-04-05");
    mockStorage.addPreExistingContainer(AzureBlobStorageTestAccount.getMockContainerUri(),metadata);
    AzureException ex=intercept(AzureException.class,new Callable<FileStatus[]>(){
      @Override public FileStatus[] call() throws Exception {
        fs.initialize(new URI(AzureBlobStorageTestAccount.MOCK_WASB_URI),conf);
        return fs.listStatus(new Path("/"));
      }
    }
);
    GenericTestUtils.assertExceptionContains("unsupported version: 2090-04-05.",ex);
  }
 }
