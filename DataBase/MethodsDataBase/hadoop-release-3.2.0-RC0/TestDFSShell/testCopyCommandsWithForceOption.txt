@Test(timeout=30000) public void testCopyCommandsWithForceOption() throws Exception {
  FsShell shell=null;
  final File localFile=new File(TEST_ROOT_DIR,"testFileForPut");
  final String localfilepath=new Path(localFile.getAbsolutePath()).toUri().toString();
  final String testdir="/tmp/TestDFSShell-testCopyCommandsWithForceOption-" + counter.getAndIncrement();
  final Path hdfsTestDir=new Path(testdir);
  try {
    dfs.mkdirs(hdfsTestDir);
    localFile.createNewFile();
    writeFile(dfs,new Path(testdir,"testFileForPut"));
    shell=new FsShell();
    String[] argv=new String[]{"-put","-f",localfilepath,testdir};
    int res=ToolRunner.run(shell,argv);
    assertEquals("put -f is not working",SUCCESS,res);
    argv=new String[]{"-put",localfilepath,testdir};
    res=ToolRunner.run(shell,argv);
    assertEquals("put command itself is able to overwrite the file",ERROR,res);
    argv=new String[]{"-copyFromLocal","-f",localfilepath,testdir};
    res=ToolRunner.run(shell,argv);
    assertEquals("copyFromLocal -f is not working",SUCCESS,res);
    argv=new String[]{"-copyFromLocal",localfilepath,testdir};
    res=ToolRunner.run(shell,argv);
    assertEquals("copyFromLocal command itself is able to overwrite the file",ERROR,res);
    argv=new String[]{"-cp","-f",localfilepath,testdir};
    res=ToolRunner.run(shell,argv);
    assertEquals("cp -f is not working",SUCCESS,res);
    argv=new String[]{"-cp",localfilepath,testdir};
    res=ToolRunner.run(shell,argv);
    assertEquals("cp command itself is able to overwrite the file",ERROR,res);
  }
  finally {
    if (null != shell)     shell.close();
    if (localFile.exists())     localFile.delete();
  }
}
