@Test(timeout=60000) public void testAssignMultipleOffswitchContainers() throws Exception {
  MockRM rm1=new MockRM();
  rm1.getRMContext().setNodeLabelManager(mgr);
  rm1.start();
  MockNM nm1=rm1.registerNode("h1:1234",80 * GB);
  RMApp app1=rm1.submitApp(1 * GB,"app","user",null,"default");
  MockAM am1=MockRM.launchAndRegisterAM(app1,rm1,nm1);
  am1.allocate("*",1 * GB,5,new ArrayList<ContainerId>());
  CapacityScheduler cs=(CapacityScheduler)rm1.getResourceScheduler();
  RMNode rmNode1=rm1.getRMContext().getRMNodes().get(nm1.getNodeId());
  cs.handle(new NodeUpdateSchedulerEvent(rmNode1));
  FiCaSchedulerApp schedulerApp1=cs.getApplicationAttempt(am1.getApplicationAttemptId());
  Assert.assertEquals(2,schedulerApp1.getLiveContainers().size());
  CapacitySchedulerConfiguration newCSConf=new CapacitySchedulerConfiguration();
  newCSConf.setInt(CapacitySchedulerConfiguration.OFFSWITCH_PER_HEARTBEAT_LIMIT,3);
  cs.reinitialize(newCSConf,rm1.getRMContext());
  cs.handle(new NodeUpdateSchedulerEvent(rmNode1));
  Assert.assertEquals(5,schedulerApp1.getLiveContainers().size());
  rm1.close();
}
