@Test public void testWriterOptions() throws Exception {
  TextWriter.Options opts=TextWriter.defaults();
  assertTrue(opts instanceof WriterOptions);
  WriterOptions wopts=(WriterOptions)opts;
  Path def=new Path(DFSConfigKeys.DFS_PROVIDED_ALIASMAP_TEXT_WRITE_DIR_DEFAULT);
  assertEquals(def,wopts.getDir());
  assertNull(wopts.getCodec());
  Path cp=new Path(OUTFILE_PATH,"blocks_" + BPID + ".csv");
  opts.dirName(new Path(OUTFILE_PATH));
  check(opts,cp,null);
  opts.codec("gzip");
  cp=new Path(OUTFILE_PATH,"blocks_" + BPID + ".csv.gz");
  check(opts,cp,org.apache.hadoop.io.compress.GzipCodec.class);
}
