/** 
 * Tests get/set working directory in DFS.
 */
@Test(timeout=30000) public void testHomeDirectory() throws IOException {
  final String[] homeBases=new String[]{"/home","/home/user"};
  Configuration conf=new HdfsConfiguration();
  for (  final String homeBase : homeBases) {
    conf.set(HdfsClientConfigKeys.DFS_USER_HOME_DIR_PREFIX_KEY,homeBase);
    MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).build();
    FileSystem fileSys=cluster.getFileSystem();
    try {
      Path home=fileSys.makeQualified(new Path(homeBase + "/" + getUserName(fileSys)));
      Path fsHome=fileSys.getHomeDirectory();
      assertEquals(home,fsHome);
    }
  finally {
      fileSys.close();
      cluster.shutdown();
    }
  }
}
