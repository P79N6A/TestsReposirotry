@Test(timeout=900000) public void testRandomOperationsWithSnapshots() throws IOException, InterruptedException, TimeoutException {
  long seed=System.currentTimeMillis();
  LOG.info("testRandomOperationsWithSnapshots, seed to be used: " + seed);
  generator=new Random(seed);
  int fileLen=generator.nextInt(MAX_NUM_FILE_LENGTH);
  createFiles(TESTDIRSTRING,fileLen);
  SnapshottableDirectoryStatus[] snapshottableDirectoryStatus=hdfs.getSnapshottableDirListing();
  for (  SnapshottableDirectoryStatus ssds : snapshottableDirectoryStatus) {
    snapshottableDirectories.add(ssds.getFullPath());
  }
  if (snapshottableDirectories.size() == 0) {
    hdfs.allowSnapshot(hdfs.getHomeDirectory());
    snapshottableDirectories.add(hdfs.getHomeDirectory());
  }
  int numberOfIterations=generator.nextInt(MAX_NUM_ITERATIONS);
  LOG.info("Number of iterations: " + numberOfIterations);
  int numberFileSystemOperations=generator.nextInt(MAX_NUM_FILESYSTEM_OPERATIONS - MIN_NUM_OPERATIONS + 1) + MIN_NUM_OPERATIONS;
  LOG.info("Number of FileSystem operations: " + numberFileSystemOperations);
  int numberSnapshotOperations=generator.nextInt(MAX_NUM_SNAPSHOT_OPERATIONS - MIN_NUM_OPERATIONS) + MIN_NUM_OPERATIONS;
  LOG.info("Number of Snapshot operations: " + numberSnapshotOperations);
  randomOperationsWithSnapshots(numberOfIterations,numberFileSystemOperations,numberSnapshotOperations);
}
