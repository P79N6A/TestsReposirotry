@Test public void testCostOfGetFileStatusOnNonEmptyDir() throws Throwable {
  describe("performing getFileStatus on a non-empty directory");
  S3AFileSystem fs=getFileSystem();
  Path dir=path("empty");
  fs.mkdirs(dir);
  Path simpleFile=new Path(dir,"simple.txt");
  touch(fs,simpleFile);
  resetMetricDiffs();
  S3AFileStatus status=fs.innerGetFileStatus(dir,true);
  if (status.isEmptyDirectory() == Tristate.TRUE) {
    String fsState=fs.toString();
    fail("FileStatus says directory isempty: " + status + "\n"+ ContractTestUtils.ls(fs,dir)+ "\n"+ fsState);
  }
  if (!fs.hasMetadataStore()) {
    metadataRequests.assertDiffEquals(2);
    listRequests.assertDiffEquals(1);
  }
}
