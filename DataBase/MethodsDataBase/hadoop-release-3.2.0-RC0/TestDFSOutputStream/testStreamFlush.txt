@Test public void testStreamFlush() throws Exception {
  FileSystem fs=cluster.getFileSystem();
  FSDataOutputStream os=fs.create(new Path("/normal-file"));
  assertTrue("DFSOutputStream should support hflush()!",os.hasCapability(StreamCapability.HFLUSH.getValue()));
  assertTrue("DFSOutputStream should support hsync()!",os.hasCapability(StreamCapability.HSYNC.getValue()));
  byte[] bytes=new byte[1024];
  InputStream is=new ByteArrayInputStream(bytes);
  IOUtils.copyBytes(is,os,bytes.length);
  os.hflush();
  IOUtils.copyBytes(is,os,bytes.length);
  os.hsync();
  os.close();
}
