@Test public void testRouterExitSafemode() throws InterruptedException, IllegalStateException, IOException {
  assertTrue(router.getSafemodeService().isInSafeMode());
  verifyRouter(RouterServiceState.SAFEMODE);
  long interval=conf.getTimeDuration(DFS_ROUTER_SAFEMODE_EXTENSION,TimeUnit.SECONDS.toMillis(2),TimeUnit.MILLISECONDS) + conf.getTimeDuration(DFS_ROUTER_CACHE_TIME_TO_LIVE_MS,TimeUnit.SECONDS.toMillis(1),TimeUnit.MILLISECONDS);
  Thread.sleep(interval);
  assertFalse(router.getSafemodeService().isInSafeMode());
  verifyRouter(RouterServiceState.RUNNING);
}
