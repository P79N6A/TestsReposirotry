@Test public void testEnumPrecedence() throws IllegalAccessException, IOException, InvalidConfigurationValueException {
  final String accountName="account";
  final String globalKey="fs.azure.enum";
  final String accountKey=globalKey + "." + accountName;
  final Configuration conf=new Configuration();
  final AbfsConfiguration abfsConf=new AbfsConfiguration(conf,accountName);
  conf.setEnum(globalKey,GetEnumType.FALSE);
  assertEquals("Default value returned even though account-agnostic config was set",abfsConf.getEnum(globalKey,GetEnumType.TRUE),GetEnumType.FALSE);
  conf.unset(globalKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getEnum(globalKey,GetEnumType.TRUE),GetEnumType.TRUE);
  conf.setEnum(accountKey,GetEnumType.FALSE);
  assertEquals("Default value returned even though account-specific config was set",abfsConf.getEnum(globalKey,GetEnumType.TRUE),GetEnumType.FALSE);
  conf.unset(accountKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getEnum(globalKey,GetEnumType.TRUE),GetEnumType.TRUE);
  conf.setEnum(accountKey,GetEnumType.TRUE);
  conf.setEnum(globalKey,GetEnumType.FALSE);
  assertEquals("Account-agnostic or default value returned even though account-specific config was set",abfsConf.getEnum(globalKey,GetEnumType.FALSE),GetEnumType.TRUE);
}
