@Test public void testClassPrecedence() throws IllegalAccessException, IOException, InvalidConfigurationValueException {
  final String accountName="account";
  final String globalKey="fs.azure.class";
  final String accountKey=globalKey + "." + accountName;
  final Configuration conf=new Configuration();
  final AbfsConfiguration abfsConf=new AbfsConfiguration(conf,accountName);
  final Class class0=GetClassImpl0.class;
  final Class class1=GetClassImpl1.class;
  final Class xface=GetClassInterface.class;
  conf.setClass(globalKey,class0,xface);
  assertEquals("Default value returned even though account-agnostic config was set",abfsConf.getClass(globalKey,class1,xface),class0);
  conf.unset(globalKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getClass(globalKey,class1,xface),class1);
  conf.setClass(accountKey,class0,xface);
  assertEquals("Default value returned even though account-specific config was set",abfsConf.getClass(globalKey,class1,xface),class0);
  conf.unset(accountKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getClass(globalKey,class1,xface),class1);
  conf.setClass(accountKey,class1,xface);
  conf.setClass(globalKey,class0,xface);
  assertEquals("Account-agnostic or default value returned even though account-specific config was set",abfsConf.getClass(globalKey,class0,xface),class1);
}
