@Test public void testBooleanPrecedence() throws IllegalAccessException, IOException, InvalidConfigurationValueException {
  final String accountName="account";
  final String globalKey="fs.azure.bool";
  final String accountKey=globalKey + "." + accountName;
  final Configuration conf=new Configuration();
  final AbfsConfiguration abfsConf=new AbfsConfiguration(conf,accountName);
  conf.setBoolean(globalKey,false);
  assertEquals("Default value returned even though account-agnostic config was set",abfsConf.getBoolean(globalKey,true),false);
  conf.unset(globalKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getBoolean(globalKey,true),true);
  conf.setBoolean(accountKey,false);
  assertEquals("Default value returned even though account-specific config was set",abfsConf.getBoolean(globalKey,true),false);
  conf.unset(accountKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getBoolean(globalKey,true),true);
  conf.setBoolean(accountKey,true);
  conf.setBoolean(globalKey,false);
  assertEquals("Account-agnostic or default value returned even though account-specific config was set",abfsConf.getBoolean(globalKey,false),true);
}
