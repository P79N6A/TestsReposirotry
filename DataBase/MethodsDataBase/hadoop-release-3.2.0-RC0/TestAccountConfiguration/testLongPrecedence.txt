@Test public void testLongPrecedence() throws IllegalAccessException, IOException, InvalidConfigurationValueException {
  final String accountName="account";
  final String globalKey="fs.azure.long";
  final String accountKey=globalKey + "." + accountName;
  final Configuration conf=new Configuration();
  final AbfsConfiguration abfsConf=new AbfsConfiguration(conf,accountName);
  conf.setLong(globalKey,0);
  assertEquals("Default value returned even though account-agnostic config was set",abfsConf.getLong(globalKey,1),0);
  conf.unset(globalKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getLong(globalKey,1),1);
  conf.setLong(accountKey,0);
  assertEquals("Default value returned even though account-specific config was set",abfsConf.getLong(globalKey,1),0);
  conf.unset(accountKey);
  assertEquals("Default value not returned even though config was unset",abfsConf.getLong(globalKey,1),1);
  conf.setLong(accountKey,1);
  conf.setLong(globalKey,0);
  assertEquals("Account-agnostic or default value returned even though account-specific config was set",abfsConf.getLong(globalKey,0),1);
}
