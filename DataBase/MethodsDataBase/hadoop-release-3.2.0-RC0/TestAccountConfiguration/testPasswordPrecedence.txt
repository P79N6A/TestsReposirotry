@Test public void testPasswordPrecedence() throws IllegalAccessException, IOException, InvalidConfigurationValueException {
  AbfsConfiguration abfsConf;
  final Configuration conf=new Configuration();
  final String accountName1="account1";
  final String accountName2="account2";
  final String accountName3="account3";
  final String globalKey="fs.azure.password";
  final String accountKey1=globalKey + "." + accountName1;
  final String accountKey2=globalKey + "." + accountName2;
  final String accountKey3=globalKey + "." + accountName3;
  final String globalValue="global";
  final String accountValue1="one";
  final String accountValue2="two";
  conf.set(accountKey1,accountValue1);
  conf.set(accountKey2,accountValue2);
  conf.set(globalKey,globalValue);
  abfsConf=new AbfsConfiguration(conf,accountName1);
  assertEquals("Wrong value returned when account-specific value was requested",abfsConf.getPasswordString(accountKey1),accountValue1);
  assertEquals("Account-specific value was not returned when one existed",abfsConf.getPasswordString(globalKey),accountValue1);
  abfsConf=new AbfsConfiguration(conf,accountName2);
  assertEquals("Wrong value returned when a different account-specific value was requested",abfsConf.getPasswordString(accountKey1),accountValue1);
  assertEquals("Wrong value returned when account-specific value was requested",abfsConf.getPasswordString(accountKey2),accountValue2);
  assertEquals("Account-agnostic value return even though account-specific value was set",abfsConf.getPasswordString(globalKey),accountValue2);
  abfsConf=new AbfsConfiguration(conf,accountName3);
  assertNull("Account-specific value returned when none was set",abfsConf.getPasswordString(accountKey3));
  assertEquals("Account-agnostic value not returned when no account-specific value was set",abfsConf.getPasswordString(globalKey),globalValue);
}
