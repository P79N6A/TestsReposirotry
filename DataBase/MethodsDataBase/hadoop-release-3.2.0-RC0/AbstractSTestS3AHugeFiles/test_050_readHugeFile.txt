/** 
 * Read in the entire file using read() calls.
 * @throws Throwable failure
 */
@Test public void test_050_readHugeFile() throws Throwable {
  assumeHugeFileExists();
  describe("Reading %s",hugefile);
  S3AFileSystem fs=getFileSystem();
  FileStatus status=fs.getFileStatus(hugefile);
  long size=status.getLen();
  long blocks=size / uploadBlockSize;
  byte[] data=new byte[uploadBlockSize];
  ContractTestUtils.NanoTimer timer=new ContractTestUtils.NanoTimer();
  try (FSDataInputStream in=fs.open(hugefile,uploadBlockSize)){
    for (long block=0; block < blocks; block++) {
      in.readFully(data);
    }
    LOG.info("Final stream state: {}",in);
  }
   long mb=Math.max(size / _1MB,1);
  timer.end("time to read file of %d MB ",mb);
  LOG.info("Time per MB to read = {} nS",toHuman(timer.nanosPerOperation(mb)));
  bandwidth(timer,size);
  logFSState();
}
