@Test public void testGetKeyProvider() throws IOException {
  HdfsAdmin hdfsAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
  Assert.assertNull("should return null for an non-encrypted cluster",hdfsAdmin.getKeyProvider());
  shutDownCluster();
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeysPublic.HADOOP_SECURITY_KEY_PROVIDER_PATH,getKeyProviderURI());
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
  cluster.waitActive();
  hdfsAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
  Assert.assertNotNull("should not return null for an encrypted cluster",hdfsAdmin.getKeyProvider());
}
