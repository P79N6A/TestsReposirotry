/** 
 * test that access via webhdfs puts proper entry in audit log 
 */
@Test public void testAuditWebHdfs() throws Exception {
  final Path file=new Path(fnames[0]);
  fs.setPermission(file,new FsPermission((short)0644));
  fs.setOwner(file,"root",null);
  setupAuditLogs();
  WebHdfsFileSystem webfs=WebHdfsTestUtil.getWebHdfsFileSystemAs(userGroupInfo,conf,WebHdfsConstants.WEBHDFS_SCHEME);
  InputStream istream=webfs.open(file);
  int val=istream.read();
  istream.close();
  verifyAuditLogsRepeat(true,3);
  assertTrue("failed to read from file",val >= 0);
}
