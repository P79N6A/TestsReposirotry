/** 
 * Tests that Xattrs should be cleaned if all blocks already satisfied.
 * @throws Exception
 */
@Test(timeout=300000) public void testSPSShouldNotLeakXattrIfStorageAlreadySatisfied() throws Exception {
  try {
    clusterSetUp();
    DFSTestUtil.waitExpectedStorageType(testFileName,StorageType.DISK,3,timeout,fs);
    fs.satisfyStoragePolicy(testFile);
    DFSTestUtil.waitExpectedStorageType(testFileName,StorageType.DISK,3,timeout,fs);
    DFSTestUtil.waitForXattrRemoved(testFileName,XATTR_SATISFY_STORAGE_POLICY,cluster.getNamesystem(),30000);
  }
  finally {
    clusterShutdown();
  }
}
