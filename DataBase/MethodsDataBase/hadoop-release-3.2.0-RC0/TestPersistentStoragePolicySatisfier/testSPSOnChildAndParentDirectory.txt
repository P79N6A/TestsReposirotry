/** 
 * Test SPS when satisfyStoragePolicy called on child file and parent directory. 1. Create one parent directory and child directory. 2. Create some file in both the directory. 3. Set storage policy for parent directory and call satisfyStoragePolicy. 4. Set storage policy for child directory and call satisfyStoragePolicy. 5. restart the namenode. All the file blocks should satisfy the policy.
 */
@Test(timeout=300000) public void testSPSOnChildAndParentDirectory() throws Exception {
  try {
    clusterSetUp();
    fs.setStoragePolicy(parentDir,"COLD");
    fs.satisfyStoragePolicy(childDir);
    DFSTestUtil.waitExpectedStorageType(childFileName,StorageType.ARCHIVE,3,30000,cluster.getFileSystem());
    fs.satisfyStoragePolicy(parentDir);
    DFSTestUtil.waitExpectedStorageType(parentFileName,StorageType.ARCHIVE,3,30000,cluster.getFileSystem());
  }
  finally {
    clusterShutdown();
  }
}
