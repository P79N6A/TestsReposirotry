/** 
 * Test SPS for directory tree which doesn't have files.
 */
@Test(timeout=300000) public void testSPSWithDirectoryTreeWithoutFile() throws Exception {
  try {
    hdfsCluster=startCluster(config,allDiskTypes,NUM_OF_DATANODES,STORAGES_PER_DATANODE,CAPACITY);
    hdfsCluster.waitActive();
    DistributedFileSystem fs=hdfsCluster.getFileSystem();
    fs.mkdirs(new Path("/root/C/H/O"));
    fs.mkdirs(new Path("/root/A"));
    fs.mkdirs(new Path("/root/D"));
    fs.mkdirs(new Path("/root/C/G"));
    fs.mkdirs(new Path("/root/C/I"));
    fs.satisfyStoragePolicy(new Path("/root"));
    DFSTestUtil.waitForXattrRemoved("/root",XATTR_SATISFY_STORAGE_POLICY,hdfsCluster.getNamesystem(),30000);
  }
  finally {
    shutdownCluster();
  }
}
