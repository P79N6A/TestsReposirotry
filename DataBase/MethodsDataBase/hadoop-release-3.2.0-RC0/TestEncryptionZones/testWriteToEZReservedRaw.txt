/** 
 * Tests that namenode doesn't generate edek if we are writing to /.reserved/raw directory.
 * @throws Exception
 */
@Test public void testWriteToEZReservedRaw() throws Exception {
  String unEncryptedBytes="hello world";
  final Path zonePath=new Path("/zone");
  fsWrapper.mkdir(zonePath,FsPermission.getDirDefault(),false);
  dfsAdmin.createEncryptionZone(zonePath,TEST_KEY,NO_TRASH);
  Path p1=new Path(zonePath,"p1");
  Path reservedRawPath=new Path("/.reserved/raw/" + p1.toString());
  OutputStream os=fs.create(reservedRawPath);
  os.close();
  try {
    fs.getXAttr(reservedRawPath,HdfsServerConstants.CRYPTO_XATTR_FILE_ENCRYPTION_INFO);
    fail("getXAttr should have thrown an exception");
  }
 catch (  IOException ioe) {
    assertExceptionContains("At least one of the attributes provided was " + "not found.",ioe);
  }
}
