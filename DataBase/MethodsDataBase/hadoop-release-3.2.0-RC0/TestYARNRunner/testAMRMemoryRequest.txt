@Test public void testAMRMemoryRequest() throws Exception {
  for (  String memoryName : ImmutableList.of(MRJobConfig.RESOURCE_TYPE_NAME_MEMORY,MRJobConfig.RESOURCE_TYPE_ALTERNATIVE_NAME_MEMORY)) {
    JobConf jobConf=new JobConf();
    jobConf.set(MRJobConfig.MR_AM_RESOURCE_PREFIX + memoryName,"3 Gi");
    yarnRunner=new YARNRunner(jobConf);
    submissionContext=buildSubmitContext(yarnRunner,jobConf);
    List<ResourceRequest> resourceRequests=submissionContext.getAMContainerResourceRequests();
    Assert.assertEquals(1,resourceRequests.size());
    ResourceRequest resourceRequest=resourceRequests.get(0);
    long memorySize=resourceRequest.getCapability().getMemorySize();
    Assert.assertEquals(3072,memorySize);
  }
}
