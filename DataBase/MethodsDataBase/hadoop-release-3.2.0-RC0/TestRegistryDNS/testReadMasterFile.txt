@Test public void testReadMasterFile() throws Exception {
  setRegistryDNS(new RegistryDNS("TestRegistry"));
  Configuration conf=new Configuration();
  conf.set(RegistryConstants.KEY_DNS_DOMAIN,"dev.test");
  conf.set(RegistryConstants.KEY_DNS_ZONE_SUBNET,"172.17.0");
  conf.setTimeDuration(RegistryConstants.KEY_DNS_TTL,30L,TimeUnit.SECONDS);
  conf.set(RegistryConstants.KEY_DNS_ZONES_DIR,getClass().getResource("/").getFile());
  if (isSecure()) {
    conf.setBoolean(RegistryConstants.KEY_DNSSEC_ENABLED,true);
    conf.set(RegistryConstants.KEY_DNSSEC_PUBLIC_KEY,"AwEAAe1Jev0Az1khlQCvf0nud1/CNHQwwPEu8BNchZthdDxKPVn29yrD " + "CHoAWjwiGsOSw3SzIPrawSbHzyJsjn0oLBhGrH6QedFGnydoxjNsw3m/ " + "SCmOjR/a7LGBAMDFKqFioi4gOyuN66svBeY+/5uw72+0ei9AQ20gqf6q "+ "l9Ozs5bV");
    conf.set(RegistryConstants.KEY_DNSSEC_PRIVATE_KEY_FILE,getClass().getResource("/test.private").getFile());
  }
  getRegistryDNS().setDomainName(conf);
  getRegistryDNS().initializeZones(conf);
  ServiceRecord record=getMarshal().fromBytes("somepath",CONTAINER_RECORD.getBytes());
  getRegistryDNS().register("/registry/users/root/services/org-apache-slider/test1/components/" + "ctr-e50-1451931954322-0016-01-000002",record);
  Record[] recs=assertDNSQuery("ctr-e50-1451931954322-0016-01-000002.dev.test.");
  assertEquals("wrong result","172.17.0.19",((ARecord)recs[0]).getAddress().getHostAddress());
  recs=assertDNSQuery("httpd-1.test1.root.dev.test.",1);
  assertTrue("not an ARecord",recs[0] instanceof ARecord);
  recs=assertDNSQuery("19.0.17.172.in-addr.arpa.",Type.PTR,1);
  assertEquals("wrong result","httpd-1.test1.root.dev.test.",((PTRRecord)recs[0]).getTarget().toString());
  Name name=Name.fromString("5.0.17.172.in-addr.arpa.");
  Record question=Record.newRecord(name,Type.PTR,DClass.IN);
  Message query=Message.newQuery(question);
  OPTRecord optRecord=new OPTRecord(4096,0,0,Flags.DO,null);
  query.addRecord(optRecord,Section.ADDITIONAL);
  byte[] responseBytes=getRegistryDNS().generateReply(query,null);
  Message response=new Message(responseBytes);
  recs=response.getSectionArray(Section.ANSWER);
  assertEquals("wrong result","cn005.dev.test.",((PTRRecord)recs[0]).getTarget().toString());
}
