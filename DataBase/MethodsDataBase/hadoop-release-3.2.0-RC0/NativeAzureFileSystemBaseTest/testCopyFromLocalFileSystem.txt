@Test public void testCopyFromLocalFileSystem() throws Exception {
  Path localFilePath=new Path(System.getProperty("test.build.data","azure_test"));
  FileSystem localFs=FileSystem.get(new Configuration());
  localFs.delete(localFilePath,true);
  try {
    writeStringToFile(localFs,localFilePath,"Testing");
    Path dstPath=methodPath();
    assertTrue(FileUtil.copy(localFs,localFilePath,fs,dstPath,false,fs.getConf()));
    assertPathExists("coied from local",dstPath);
    assertEquals("Testing",readStringFromFile(fs,dstPath));
    fs.delete(dstPath,true);
  }
  finally {
    localFs.delete(localFilePath,true);
  }
}
