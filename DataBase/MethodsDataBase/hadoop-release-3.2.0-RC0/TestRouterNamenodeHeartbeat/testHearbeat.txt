@Test public void testHearbeat() throws InterruptedException, IOException {
  if (cluster.isHighAvailability()) {
    for (    String ns : cluster.getNameservices()) {
      cluster.switchToActive(ns,NAMENODES[0]);
      cluster.switchToStandby(ns,NAMENODES[1]);
    }
  }
  Thread.sleep(5000);
  for (  String ns : cluster.getNameservices()) {
    List<? extends FederationNamenodeContext> nns=namenodeResolver.getNamenodesForNameserviceId(ns);
    FederationNamenodeContext active=nns.get(0);
    assertEquals(NAMENODES[0],active.getNamenodeId());
    FederationNamenodeContext standby=nns.get(1);
    assertEquals(NAMENODES[1],standby.getNamenodeId());
  }
  List<String> nss=cluster.getNameservices();
  String failoverNS=nss.get(0);
  String normalNs=nss.get(1);
  cluster.switchToStandby(failoverNS,NAMENODES[0]);
  cluster.switchToActive(failoverNS,NAMENODES[1]);
  Thread.sleep(5000);
  List<? extends FederationNamenodeContext> failoverNSs=namenodeResolver.getNamenodesForNameserviceId(failoverNS);
  FederationNamenodeContext active=failoverNSs.get(0);
  assertEquals(NAMENODES[1],active.getNamenodeId());
  FederationNamenodeContext standby=failoverNSs.get(1);
  assertEquals(NAMENODES[0],standby.getNamenodeId());
  List<? extends FederationNamenodeContext> normalNss=namenodeResolver.getNamenodesForNameserviceId(normalNs);
  active=normalNss.get(0);
  assertEquals(NAMENODES[0],active.getNamenodeId());
  standby=normalNss.get(1);
  assertEquals(NAMENODES[1],standby.getNamenodeId());
}
