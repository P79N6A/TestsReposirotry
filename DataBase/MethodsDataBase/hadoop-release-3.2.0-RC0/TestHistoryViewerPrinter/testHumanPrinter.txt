@Test public void testHumanPrinter() throws Exception {
  JobHistoryParser.JobInfo job=createJobInfo();
  HumanReadableHistoryViewerPrinter printer=new HumanReadableHistoryViewerPrinter(job,false,"http://",TimeZone.getTimeZone("GMT"));
  String outStr=run(printer);
  Assert.assertEquals("\n" + "Hadoop job: job_1317928501754_0001\n" + "=====================================\n"+ "User: rkanter\n"+ "JobName: my job\n"+ "JobConf: /tmp/job.xml\n"+ "Submitted At: 6-Oct-2011 19:15:01\n"+ "Launched At: 6-Oct-2011 19:15:02 (1sec)\n"+ "Finished At: 6-Oct-2011 19:15:16 (14sec)\n"+ "Status: SUCCEEDED\n"+ "Counters: \n"+ "\n"+ "|Group Name                    |Counter name                  |Map Value |Reduce Value|Total Value|\n"+ "---------------------------------------------------------------------------------------" + LINE_SEPARATOR + "|group1                        |counter1                      |5         |5         |5         "+ LINE_SEPARATOR+ "|group1                        |counter2                      |10        |10        |10        "+ LINE_SEPARATOR+ "|group2                        |counter1                      |15        |15        |15        "+ "\n\n"+ "====================================="+ LINE_SEPARATOR+ "\n"+ "Task Summary\n"+ "============================\n"+ "Kind\tTotal\tSuccessful\tFailed\tKilled\tStartTime\tFinishTime\n"+ "\n"+ "Setup\t1\t1\t\t0\t0\t6-Oct-2011 19:15:03\t6-Oct-2011 19:15:04 (1sec)\n"+ "Map\t6\t5\t\t1\t0\t6-Oct-2011 19:15:04\t6-Oct-2011 19:15:16 (12sec)\n"+ "Reduce\t1\t1\t\t0\t0\t6-Oct-2011 19:15:10\t6-Oct-2011 19:15:18 (8sec)\n"+ "Cleanup\t1\t1\t\t0\t0\t6-Oct-2011 19:15:11\t6-Oct-2011 19:15:20 (9sec)\n"+ "============================\n"+ LINE_SEPARATOR+ "\n"+ "Analysis"+ LINE_SEPARATOR+ "========="+ LINE_SEPARATOR+ "\n"+ "Time taken by best performing map task task_1317928501754_0001_m_000003: 3sec\n"+ "Average time taken by map tasks: 5sec\n"+ "Worse performing map tasks: \n"+ "TaskId\t\tTimetaken"+ LINE_SEPARATOR+ "task_1317928501754_0001_m_000007 7sec"+ LINE_SEPARATOR+ "task_1317928501754_0001_m_000006 6sec"+ LINE_SEPARATOR+ "task_1317928501754_0001_m_000005 5sec"+ LINE_SEPARATOR+ "task_1317928501754_0001_m_000004 4sec"+ LINE_SEPARATOR+ "task_1317928501754_0001_m_000003 3sec"+ LINE_SEPARATOR+ "The last map task task_1317928501754_0001_m_000007 finished at (relative to the Job launch time): 6-Oct-2011 19:15:16 (14sec)"+ LINE_SEPARATOR+ "\n"+ "Time taken by best performing shuffle task task_1317928501754_0001_r_000008: 8sec\n"+ "Average time taken by shuffle tasks: 8sec\n"+ "Worse performing shuffle tasks: \n"+ "TaskId\t\tTimetaken"+ LINE_SEPARATOR+ "task_1317928501754_0001_r_000008 8sec"+ LINE_SEPARATOR+ "The last shuffle task task_1317928501754_0001_r_000008 finished at (relative to the Job launch time): 6-Oct-2011 19:15:18 (16sec)"+ LINE_SEPARATOR+ "\n"+ "Time taken by best performing reduce task task_1317928501754_0001_r_000008: 0sec\n"+ "Average time taken by reduce tasks: 0sec\n"+ "Worse performing reduce tasks: \n"+ "TaskId\t\tTimetaken"+ LINE_SEPARATOR+ "task_1317928501754_0001_r_000008 0sec"+ LINE_SEPARATOR+ "The last reduce task task_1317928501754_0001_r_000008 finished at (relative to the Job launch time): 6-Oct-2011 19:15:18 (16sec)"+ LINE_SEPARATOR+ "========="+ LINE_SEPARATOR+ "\n"+ "FAILED MAP task list for job_1317928501754_0001\n"+ "TaskId\t\tStartTime\tFinishTime\tError\tInputSplits\n"+ "===================================================="+ LINE_SEPARATOR+ "task_1317928501754_0001_m_000002\t6-Oct-2011 19:15:04\t6-Oct-2011 19:15:06 (2sec)\t\t"+ LINE_SEPARATOR+ "\n"+ "FAILED task attempts by nodes\n"+ "Hostname\tFailedTasks\n"+ "==============================="+ LINE_SEPARATOR+ "localhost\ttask_1317928501754_0001_m_000002, "+ LINE_SEPARATOR,outStr);
}
