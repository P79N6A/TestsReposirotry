@Test public void testImportCommand() throws Exception {
  S3AFileSystem fs=getFileSystem();
  MetadataStore ms=getMetadataStore();
  Path parent=path("test-import");
  fs.mkdirs(parent);
  Path dir=new Path(parent,"a");
  fs.mkdirs(dir);
  Path emptyDir=new Path(parent,"emptyDir");
  fs.mkdirs(emptyDir);
  for (int i=0; i < 10; i++) {
    String child=String.format("file-%d",i);
    try (FSDataOutputStream out=fs.create(new Path(dir,child))){
      out.write(1);
    }
   }
  S3GuardTool.Import cmd=new S3GuardTool.Import(fs.getConf());
  cmd.setStore(ms);
  exec(cmd,"import",parent.toString());
  DirListingMetadata children=ms.listChildren(dir);
  assertEquals("Unexpected number of paths imported",10,children.getListing().size());
  assertEquals("Expected 2 items: empty directory and a parent directory",2,ms.listChildren(parent).getListing().size());
}
