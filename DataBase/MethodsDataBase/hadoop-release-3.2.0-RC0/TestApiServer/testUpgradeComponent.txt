@Test public void testUpgradeComponent(){
  Service goodService=ServiceClientTest.buildLiveGoodService();
  Component comp=goodService.getComponents().iterator().next();
  comp.setState(ComponentState.UPGRADING);
  Service serviceStatus=mockServerClient.getGoodServiceStatus();
  serviceStatus.setState(ServiceState.UPGRADING);
  Component liveComp=serviceStatus.getComponent(comp.getName());
  liveComp.setState(ComponentState.NEEDS_UPGRADE);
  Set<String> expectedInstances=new HashSet<>();
  liveComp.getContainers().forEach(container -> {
    expectedInstances.add(container.getComponentInstanceName());
    container.setState(ContainerState.NEEDS_UPGRADE);
  }
);
  mockServerClient.setExpectedInstances(expectedInstances);
  final Response actual=apiServer.updateComponent(request,goodService.getName(),comp.getName(),comp);
  assertEquals("Component upgrade is ",Response.status(Status.ACCEPTED).build().getStatus(),actual.getStatus());
}
