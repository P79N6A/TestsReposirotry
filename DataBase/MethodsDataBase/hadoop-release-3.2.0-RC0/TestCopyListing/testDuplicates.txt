@Test(timeout=10000) public void testDuplicates(){
  FileSystem fs=null;
  try {
    fs=FileSystem.get(getConf());
    List<Path> srcPaths=new ArrayList<Path>();
    srcPaths.add(new Path("/tmp/in/*/*"));
    TestDistCpUtils.createFile(fs,"/tmp/in/src1/1.txt");
    TestDistCpUtils.createFile(fs,"/tmp/in/src2/1.txt");
    Path target=new Path("/tmp/out");
    Path listingFile=new Path("/tmp/list");
    final DistCpOptions options=new DistCpOptions.Builder(srcPaths,target).build();
    final DistCpContext context=new DistCpContext(options);
    CopyListing listing=CopyListing.getCopyListing(getConf(),CREDENTIALS,context);
    try {
      listing.buildListing(listingFile,context);
      Assert.fail("Duplicates not detected");
    }
 catch (    DuplicateFileException ignore) {
    }
  }
 catch (  IOException e) {
    LOG.error("Exception encountered in test",e);
    Assert.fail("Test failed " + e.getMessage());
  }
 finally {
    TestDistCpUtils.delete(fs,"/tmp");
  }
}
