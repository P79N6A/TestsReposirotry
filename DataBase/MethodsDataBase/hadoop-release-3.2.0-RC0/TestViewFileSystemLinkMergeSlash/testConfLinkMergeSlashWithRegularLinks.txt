@Test public void testConfLinkMergeSlashWithRegularLinks() throws Exception {
  TEST_DIR.mkdirs();
  String clusterName="ClusterMerge";
  String expectedErrorMsg1="Mount table ClusterMerge has already been " + "configured with a merge slash link";
  String expectedErrorMsg2="Mount table ClusterMerge has already been " + "configured with regular links";
  URI viewFsUri=new URI(FsConstants.VIEWFS_SCHEME,clusterName,"/",null,null);
  Configuration conf=new Configuration();
  ConfigUtil.addLinkMergeSlash(conf,clusterName,TEST_DIR.toURI());
  ConfigUtil.addLink(conf,clusterName,"testDir",TEST_DIR.toURI());
  try {
    FileSystem.get(viewFsUri,conf);
    fail("Shouldn't allow both merge slash link and regular link on same " + "mount table.");
  }
 catch (  IOException e) {
    assertTrue("Unexpected error message: " + e.getMessage(),e.getMessage().contains(expectedErrorMsg1) || e.getMessage().contains(expectedErrorMsg2));
  }
}
