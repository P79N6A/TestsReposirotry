@Test public void testComponentUpgrade() throws Exception {
  ServiceContext context=createTestContext(rule,"testComponentUpgrade");
  Component comp=context.scheduler.getAllComponents().entrySet().iterator().next().getValue();
  ComponentEvent upgradeEvent=new ComponentEvent(comp.getName(),ComponentEventType.UPGRADE);
  comp.handle(upgradeEvent);
  Assert.assertEquals("component not in need upgrade state",ComponentState.NEEDS_UPGRADE,comp.getComponentSpec().getState());
}
