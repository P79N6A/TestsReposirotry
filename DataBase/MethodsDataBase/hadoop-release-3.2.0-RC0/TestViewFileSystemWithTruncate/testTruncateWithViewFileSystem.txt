@Test(timeout=30000) public void testTruncateWithViewFileSystem() throws Exception {
  Path filePath=new Path(mountOnNn1 + "/ttest");
  Path hdfFilepath=new Path("/tmp/TestViewFileSystemWithXAttrs/ttest");
  FSDataOutputStream out=fsView.create(filePath);
  out.writeBytes("drtatedasfdasfgdfas");
  out.close();
  int newLength=10;
  boolean isReady=fsView.truncate(filePath,newLength);
  if (!isReady) {
    GenericTestUtils.waitFor(new Supplier<Boolean>(){
      @Override public Boolean get(){
        try {
          return cluster.getFileSystem(0).isFileClosed(hdfFilepath);
        }
 catch (        IOException e) {
          return false;
        }
      }
    }
,100,60 * 1000);
  }
  assertEquals(newLength,fsView.getFileStatus(filePath).getLen());
}
