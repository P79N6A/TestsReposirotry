/** 
 * Check smmthread will leave safe mode if NN is not in transitionToActive.
 */
@Test(timeout=10000) public void testCheckSafeMode7() throws Exception {
  doReturn(false).when(fsn).inTransitionToActive();
  bmSafeMode.activate(BLOCK_TOTAL);
  Whitebox.setInternalState(bmSafeMode,"extension",5);
  setBlockSafe(BLOCK_THRESHOLD);
  bmSafeMode.checkSafeMode();
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      return getSafeModeStatus() == BMSafeModeStatus.OFF;
    }
  }
,100,10000);
}
