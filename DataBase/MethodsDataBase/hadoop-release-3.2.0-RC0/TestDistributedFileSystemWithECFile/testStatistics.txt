@SuppressWarnings("deprecation") @Test public void testStatistics() throws Exception {
  final String fileName="/ec/file";
  final int size=3200;
  createFile(fileName,size);
  InputStream in=null;
  try {
    in=fs.open(new Path(fileName));
    IOUtils.copyBytes(in,System.out,4096,false);
  }
  finally {
    IOUtils.closeStream(in);
  }
  Long totalBytesRead=0L;
  Long ecBytesRead=0L;
  for (  FileSystem.Statistics stat : FileSystem.getAllStatistics()) {
    totalBytesRead+=stat.getBytesRead();
    ecBytesRead+=stat.getBytesReadErasureCoded();
  }
  assertEquals(Long.valueOf(size),totalBytesRead);
  assertEquals(Long.valueOf(size),ecBytesRead);
  Long totalBytesReadThread=0L;
  Long ecBytesReadThread=0L;
  for (  FileSystem.Statistics stat : FileSystem.getAllStatistics()) {
    FileSystem.Statistics.StatisticsData data=stat.getThreadStatistics();
    totalBytesReadThread+=data.getBytesRead();
    ecBytesReadThread+=data.getBytesReadErasureCoded();
  }
  assertEquals(Long.valueOf(size),totalBytesReadThread);
  assertEquals(Long.valueOf(size),ecBytesReadThread);
}
