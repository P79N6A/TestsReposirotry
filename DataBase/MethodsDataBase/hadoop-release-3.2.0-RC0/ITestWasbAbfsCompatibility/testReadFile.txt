@Test public void testReadFile() throws Exception {
  boolean[] createFileWithAbfs=new boolean[]{false,true,false,true};
  boolean[] readFileWithAbfs=new boolean[]{false,true,true,false};
  AzureBlobFileSystem abfs=getFileSystem();
  Assume.assumeFalse(abfs.getIsNamespaceEnabled());
  NativeAzureFileSystem wasb=getWasbFileSystem();
  for (int i=0; i < 4; i++) {
    Path path=new Path("/testReadFile/~12/!008/testfile" + i);
    final FileSystem createFs=createFileWithAbfs[i] ? abfs : wasb;
    try (FSDataOutputStream nativeFsStream=createFs.create(path,true)){
      nativeFsStream.write(TEST_CONTEXT.getBytes());
      nativeFsStream.flush();
      nativeFsStream.hsync();
    }
     ContractTestUtils.assertIsFile(createFs,path);
    final FileSystem readFs=readFileWithAbfs[i] ? abfs : wasb;
    try (BufferedReader br=new BufferedReader(new InputStreamReader(readFs.open(path)))){
      String line=br.readLine();
      assertEquals("Wrong text from " + readFs,TEST_CONTEXT,line);
    }
     assertDeleted(readFs,path,true);
  }
}
