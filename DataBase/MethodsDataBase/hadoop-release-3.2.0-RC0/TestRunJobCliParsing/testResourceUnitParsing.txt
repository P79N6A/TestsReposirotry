@Test public void testResourceUnitParsing() throws Exception {
  Resource res=CliUtils.createResourceFromString("memory=20g,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(20 * 1024,3),res);
  res=CliUtils.createResourceFromString("memory=20G,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(20 * 1024,3),res);
  res=CliUtils.createResourceFromString("memory=20M,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(20,3),res);
  res=CliUtils.createResourceFromString("memory=20m,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(20,3),res);
  res=CliUtils.createResourceFromString("memory-mb=20,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(20,3),res);
  res=CliUtils.createResourceFromString("memory-mb=20m,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(20,3),res);
  res=CliUtils.createResourceFromString("memory-mb=20G,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(20 * 1024,3),res);
  res=CliUtils.createResourceFromString("memory=20,vcores=3",ResourceUtils.getResourcesTypeInfo());
  Assert.assertEquals(Resources.createResource(0,3),res);
  List<ResourceTypeInfo> resTypes=new ArrayList<>(ResourceUtils.getResourcesTypeInfo());
  resTypes.add(ResourceTypeInfo.newInstance(ResourceInformation.GPU_URI,""));
  ResourceUtils.reinitializeResources(resTypes);
  res=CliUtils.createResourceFromString("memory=2G,vcores=3,gpu=0",resTypes);
  Assert.assertEquals(2 * 1024,res.getMemorySize());
  Assert.assertEquals(0,res.getResourceValue(ResourceInformation.GPU_URI));
  res=CliUtils.createResourceFromString("memory=2G,vcores=3,gpu=3",resTypes);
  Assert.assertEquals(2 * 1024,res.getMemorySize());
  Assert.assertEquals(3,res.getResourceValue(ResourceInformation.GPU_URI));
  res=CliUtils.createResourceFromString("memory=2G,vcores=3",resTypes);
  Assert.assertEquals(2 * 1024,res.getMemorySize());
  Assert.assertEquals(0,res.getResourceValue(ResourceInformation.GPU_URI));
  res=CliUtils.createResourceFromString("memory=2G,vcores=3,yarn.io/gpu=0",resTypes);
  Assert.assertEquals(2 * 1024,res.getMemorySize());
  Assert.assertEquals(0,res.getResourceValue(ResourceInformation.GPU_URI));
  res=CliUtils.createResourceFromString("memory=2G,vcores=3,yarn.io/gpu=3",resTypes);
  Assert.assertEquals(2 * 1024,res.getMemorySize());
  Assert.assertEquals(3,res.getResourceValue(ResourceInformation.GPU_URI));
}
