/** 
 * Tests that attempting to add a new NameNode feature out of order with respect to minimum compatible layout version will fail fast.
 */
@Test(expected=AssertionError.class) public void testNameNodeFeatureMinimumCompatibleLayoutVersionOutOfOrder(){
  FeatureInfo ancestorF=LayoutVersion.Feature.RESERVED_REL2_4_0.getInfo();
  LayoutFeature f=mock(LayoutFeature.class);
  when(f.getInfo()).thenReturn(new FeatureInfo(ancestorF.getLayoutVersion() - 1,ancestorF.getLayoutVersion(),ancestorF.getMinimumCompatibleLayoutVersion() + 1,"Invalid feature.",false));
  Map<Integer,SortedSet<LayoutFeature>> features=new HashMap<>();
  LayoutVersion.updateMap(features,LayoutVersion.Feature.values());
  LayoutVersion.updateMap(features,new LayoutFeature[]{f});
}
