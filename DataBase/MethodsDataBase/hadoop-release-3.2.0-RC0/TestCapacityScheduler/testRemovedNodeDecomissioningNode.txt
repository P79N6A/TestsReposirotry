@Test public void testRemovedNodeDecomissioningNode() throws Exception {
  NodeManager nm=registerNode("host_decom",1234,2345,NetworkTopology.DEFAULT_RACK,Resources.createResource(8 * GB,4));
  RMNode node=resourceManager.getRMContext().getRMNodes().get(nm.getNodeId());
  NodeUpdateSchedulerEvent nodeUpdate=new NodeUpdateSchedulerEvent(node);
  resourceManager.getResourceScheduler().handle(nodeUpdate);
  ((CapacityScheduler)resourceManager.getResourceScheduler()).getNodeTracker().removeNode(nm.getNodeId());
  RMNode spyNode=Mockito.spy(resourceManager.getRMContext().getRMNodes().get(nm.getNodeId()));
  when(spyNode.getState()).thenReturn(NodeState.DECOMMISSIONING);
  resourceManager.getResourceScheduler().handle(new NodeUpdateSchedulerEvent(spyNode));
}
