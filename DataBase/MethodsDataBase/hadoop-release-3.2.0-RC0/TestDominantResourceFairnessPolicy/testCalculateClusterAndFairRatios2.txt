@Test public void testCalculateClusterAndFairRatios2(){
  ResourceUtils.resetResourceTypes(new Configuration());
  Resource used=Resources.createResource(10,5);
  Resource capacity=Resources.createResource(100,10);
  double[] shares=new double[2];
  DominantResourceFairnessComparator2 comparator=new DominantResourceFairnessComparator2();
  int dominant=comparator.calculateClusterAndFairRatios(used.getResources(),1.0f,capacity.getResources(),shares);
  assertEquals("Calculated usage ratio for memory (10MB out of 100MB) is " + "incorrect",0.1,shares[Resource.MEMORY_INDEX],.00001);
  assertEquals("Calculated usage ratio for vcores (5 out of 10) is " + "incorrect",0.5,shares[Resource.VCORES_INDEX],.00001);
  assertEquals("The wrong dominant resource index was returned",Resource.VCORES_INDEX,dominant);
}
