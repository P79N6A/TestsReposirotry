/** 
 * Test for the case where the shared edits dir doesn't have all of the recent edit logs.
 */
@Test public void testSharedEditsMissingLogs() throws Exception {
  removeStandbyNameDirs();
  CheckpointSignature sig=nn0.getRpcServer().rollEditLog();
  assertEquals(3,sig.getCurSegmentTxId());
  URI editsUri=cluster.getSharedEditsDir(0,maxNNCount - 1);
  File editsDir=new File(editsUri);
  File currentDir=new File(editsDir,"current");
  File editsSegment=new File(currentDir,NNStorage.getFinalizedEditsFileName(1,2));
  GenericTestUtils.assertExists(editsSegment);
  GenericTestUtils.assertExists(currentDir);
  assertTrue(editsSegment.delete());
  LogCapturer logs=GenericTestUtils.LogCapturer.captureLogs(LoggerFactory.getLogger(BootstrapStandby.class));
  try {
    assertEquals(BootstrapStandby.ERR_CODE_LOGS_UNAVAILABLE,forceBootstrap(1));
  }
  finally {
    logs.stopCapturing();
  }
  assertTrue(logs.getOutput().contains("Unable to read transaction ids 1-3 from the configured shared"));
}
