@Test public void testReadWriteHeavyBytesToFileWithStatistics() throws Exception {
  final AzureBlobFileSystem fs=getFileSystem();
  final FileSystem.Statistics abfsStatistics;
  final Path testFile=path(methodName.getMethodName());
  int testBufferSize;
  final byte[] sourceData;
  try (FSDataOutputStream stream=fs.create(testFile)){
    abfsStatistics=fs.getFsStatistics();
    abfsStatistics.reset();
    testBufferSize=5 * TEN * ONE_THOUSAND* BASE_SIZE;
    sourceData=new byte[testBufferSize];
    new Random().nextBytes(sourceData);
    stream.write(sourceData);
  }
   final byte[] remoteData=new byte[testBufferSize];
  int bytesRead;
  try (FSDataInputStream inputStream=fs.open(testFile,4 * ONE_MB)){
    bytesRead=inputStream.read(remoteData);
  }
   String stats=abfsStatistics.toString();
  assertEquals("Bytes read in " + stats,remoteData.length,abfsStatistics.getBytesRead());
  assertEquals("bytes written in " + stats,sourceData.length,abfsStatistics.getBytesWritten());
  assertEquals("bytesRead from read() call",testBufferSize,bytesRead);
  assertArrayEquals("round tripped data",sourceData,remoteData);
}
