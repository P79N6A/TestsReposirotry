@Test public void testBucketConfigurationPropagationResolution() throws Throwable {
  Configuration config=new Configuration(false);
  String basekey="fs.s3a.base";
  String baseref="fs.s3a.baseref";
  String baseref2="fs.s3a.baseref2";
  config.set(basekey,"orig");
  config.set(baseref2,"${fs.s3a.base}");
  setBucketOption(config,"b",basekey,"1024");
  setBucketOption(config,"b",baseref,"${fs.s3a.base}");
  Configuration updated=propagateBucketOptions(config,"b");
  assertOptionEquals(updated,basekey,"1024");
  assertOptionEquals(updated,baseref,"1024");
  assertOptionEquals(updated,baseref2,"1024");
}
