/** 
 * Verify a node can transition directly to AdminStates.IN_MAINTENANCE when DFS_NAMENODE_MAINTENANCE_REPLICATION_MIN_KEY is set to zero. Then later transition to NORMAL after maintenance expiration.
 */
@Test(timeout=360000) public void testZeroMinMaintenanceReplicationWithExpiration() throws Exception {
  LOG.info("Starting testZeroMinMaintenanceReplicationWithExpiration");
  setMinMaintenanceR(0);
  startCluster(1,1);
  final Path file=new Path("/testZeroMinMaintenanceReplicationWithExpiration.dat");
  FileSystem fileSys=getCluster().getFileSystem(0);
  writeFile(fileSys,file,1,1);
  DatanodeInfo nodeOutofService=takeNodeOutofService(0,null,Long.MAX_VALUE,null,AdminStates.IN_MAINTENANCE);
  takeNodeOutofService(0,nodeOutofService.getDatanodeUuid(),Time.now() + EXPIRATION_IN_MS,null,AdminStates.NORMAL);
  cleanupFile(fileSys,file);
}
