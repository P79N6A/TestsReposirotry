/** 
 * Test if the different chains for users are generated, and LRU cache is working as expected.
 */
@Test public void testUsersChainMapWithLRUCache() throws YarnException, IOException, InterruptedException {
  Map<String,RequestInterceptorChainWrapper> pipelines;
  RequestInterceptorChainWrapper chain;
  refreshQueues("test1");
  refreshQueues("test2");
  refreshQueues("test3");
  refreshQueues("test4");
  refreshQueues("test5");
  refreshQueues("test6");
  refreshQueues("test7");
  refreshQueues("test8");
  pipelines=super.getRouterRMAdminService().getPipelines();
  Assert.assertEquals(8,pipelines.size());
  refreshQueues("test9");
  refreshQueues("test10");
  refreshQueues("test1");
  refreshQueues("test11");
  Assert.assertEquals(10,pipelines.size());
  chain=pipelines.get("test1");
  Assert.assertNotNull("test1 should not be evicted",chain);
  chain=pipelines.get("test2");
  Assert.assertNull("test2 should have been evicted",chain);
}
