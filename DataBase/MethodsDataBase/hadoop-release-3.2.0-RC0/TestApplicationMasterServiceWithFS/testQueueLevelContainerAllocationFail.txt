@Test(timeout=3000000) public void testQueueLevelContainerAllocationFail() throws Exception {
  MockRM rm=new MockRM(configuration);
  rm.start();
  MockNM nm1=rm.registerNode("127.0.0.1:1234",6 * GB);
  RMApp app1=rm.submitApp(2 * GB,"queueA");
  nm1.nodeHeartbeat(true);
  RMAppAttempt attempt1=app1.getCurrentAppAttempt();
  MockAM am1=rm.sendAMLaunched(attempt1.getAppAttemptId());
  am1.registerAppAttempt();
  am1.addRequests(new String[]{"127.0.0.1"},MEMORY_ALLOCATION,1,1);
  try {
    allocateResponse=am1.schedule();
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertTrue(e instanceof InvalidResourceRequestException);
    Assert.assertEquals(InvalidResourceRequestException.InvalidResourceType.GREATER_THEN_MAX_ALLOCATION,((InvalidResourceRequestException)e).getInvalidResourceType());
  }
 finally {
    rm.stop();
  }
}
