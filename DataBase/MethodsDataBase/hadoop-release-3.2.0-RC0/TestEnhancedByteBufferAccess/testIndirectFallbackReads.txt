/** 
 * Test fallback reads on a stream which does not support the ByteBufferReadable * interface.
 */
@Test public void testIndirectFallbackReads() throws Exception {
  final String testPath=GenericTestUtils.getTestDir("indirectFallbackTestFile").getAbsolutePath();
  final int TEST_FILE_LENGTH=16385;
  final int RANDOM_SEED=23453;
  FileOutputStream fos=null;
  FileInputStream fis=null;
  try {
    fos=new FileOutputStream(testPath);
    Random random=new Random(RANDOM_SEED);
    byte original[]=new byte[TEST_FILE_LENGTH];
    random.nextBytes(original);
    fos.write(original);
    fos.close();
    fos=null;
    fis=new FileInputStream(testPath);
    testFallbackImpl(fis,original);
  }
  finally {
    IOUtils.cleanupWithLogger(LOG,fos,fis);
    new File(testPath).delete();
  }
}
