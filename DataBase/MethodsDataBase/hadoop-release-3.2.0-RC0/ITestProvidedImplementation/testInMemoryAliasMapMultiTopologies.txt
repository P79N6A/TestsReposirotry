@Test public void testInMemoryAliasMapMultiTopologies() throws Exception {
  MiniDFSNNTopology[] topologies=new MiniDFSNNTopology[]{MiniDFSNNTopology.simpleHATopology(),MiniDFSNNTopology.simpleFederatedTopology(3),MiniDFSNNTopology.simpleHAFederatedTopology(3)};
  for (  MiniDFSNNTopology topology : topologies) {
    LOG.info("Starting test with topology with HA = {}, federation = {}",topology.isHA(),topology.isFederated());
    setSeed();
    createInMemoryAliasMapImage();
    conf.setBoolean(DFS_PROVIDED_ALIASMAP_INMEMORY_ENABLED,true);
    conf.setInt(DFSConfigKeys.DFS_PROVIDED_ALIASMAP_LOAD_RETRIES,10);
    providedNameservice=topology.getNameservices().get(0).getId();
    configureAliasMapAddresses(topology,providedNameservice);
    startCluster(nnDirPath,2,new StorageType[]{StorageType.PROVIDED,StorageType.DISK},null,false,null,topology,new MiniDFSClusterBuilderAliasMap(conf));
    verifyPathsWithHAFailoverIfNecessary(topology,providedNameservice);
    shutdown();
  }
}
