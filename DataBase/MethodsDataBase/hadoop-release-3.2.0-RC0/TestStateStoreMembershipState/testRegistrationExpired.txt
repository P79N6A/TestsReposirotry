@Test public void testRegistrationExpired() throws InterruptedException, IOException {
  MembershipState report=createRegistration(NAMESERVICES[0],NAMENODES[0],ROUTERS[0],FederationNamenodeServiceState.ACTIVE);
  assertTrue(namenodeHeartbeat(report));
  assertTrue(getStateStore().loadCache(MembershipStore.class,true));
  MembershipState quorumEntry=getNamenodeRegistration(report.getNameserviceId(),report.getNamenodeId());
  assertNotNull(quorumEntry);
  assertEquals(ROUTERS[0],quorumEntry.getRouterId());
  assertEquals(FederationNamenodeServiceState.ACTIVE,quorumEntry.getState());
  Thread.sleep(6000);
  assertTrue(getStateStore().loadCache(MembershipStore.class,true));
  quorumEntry=getNamenodeRegistration(NAMESERVICES[0],NAMENODES[0]);
  assertNull(quorumEntry);
  quorumEntry=getNamenodeRegistration(report.getNameserviceId(),report.getNamenodeId());
  assertNull(quorumEntry);
  assertTrue(namenodeHeartbeat(report));
  assertTrue(getStateStore().loadCache(MembershipStore.class,true));
  quorumEntry=getNamenodeRegistration(report.getNameserviceId(),report.getNamenodeId());
  assertNotNull(quorumEntry);
  assertEquals(ROUTERS[0],quorumEntry.getRouterId());
  assertEquals(FederationNamenodeServiceState.ACTIVE,quorumEntry.getState());
}
