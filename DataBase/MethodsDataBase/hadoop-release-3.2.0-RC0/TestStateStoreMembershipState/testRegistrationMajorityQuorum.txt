@Test public void testRegistrationMajorityQuorum() throws InterruptedException, IOException {
  String ns="ns0";
  String nn="nn0";
  MembershipState report=createRegistration(ns,nn,ROUTERS[1],FederationNamenodeServiceState.ACTIVE);
  assertTrue(namenodeHeartbeat(report));
  Thread.sleep(1000);
  report=createRegistration(ns,nn,ROUTERS[2],FederationNamenodeServiceState.ACTIVE);
  assertTrue(namenodeHeartbeat(report));
  Thread.sleep(1000);
  report=createRegistration(ns,nn,ROUTERS[3],FederationNamenodeServiceState.ACTIVE);
  assertTrue(namenodeHeartbeat(report));
  report=createRegistration(ns,nn,ROUTERS[0],FederationNamenodeServiceState.STANDBY);
  assertTrue(namenodeHeartbeat(report));
  assertTrue(getStateStore().loadCache(MembershipStore.class,true));
  MembershipState quorumEntry=getNamenodeRegistration(report.getNameserviceId(),report.getNamenodeId());
  assertNotNull(quorumEntry);
  assertEquals(quorumEntry.getRouterId(),ROUTERS[3]);
}
