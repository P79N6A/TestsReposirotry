@Test public void testRegistrationNoQuorum() throws InterruptedException, IOException {
  MembershipState report1=createRegistration(NAMESERVICES[0],NAMENODES[0],ROUTERS[1],FederationNamenodeServiceState.STANDBY);
  assertTrue(namenodeHeartbeat(report1));
  Thread.sleep(100);
  MembershipState report2=createRegistration(NAMESERVICES[0],NAMENODES[0],ROUTERS[2],FederationNamenodeServiceState.ACTIVE);
  assertTrue(namenodeHeartbeat(report2));
  Thread.sleep(100);
  MembershipState report3=createRegistration(NAMESERVICES[0],NAMENODES[0],ROUTERS[3],FederationNamenodeServiceState.ACTIVE);
  assertTrue(namenodeHeartbeat(report3));
  Thread.sleep(100);
  MembershipState report4=createRegistration(NAMESERVICES[0],NAMENODES[0],ROUTERS[0],FederationNamenodeServiceState.STANDBY);
  assertTrue(namenodeHeartbeat(report4));
  assertTrue(getStateStore().loadCache(MembershipStore.class,true));
  MembershipState quorumEntry=getNamenodeRegistration(report1.getNameserviceId(),report1.getNamenodeId());
  assertNotNull(quorumEntry);
  assertEquals(ROUTERS[0],quorumEntry.getRouterId());
  assertEquals(FederationNamenodeServiceState.STANDBY,quorumEntry.getState());
}
