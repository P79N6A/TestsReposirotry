/** 
 * Test that tries to see if there is a deadlock between (a) the thread stopping the RM (b) thread processing the ZK event asking RM to transition to active The test times out if there is a deadlock.
 */
@Test(timeout=10000) public void testDeadlockShutdownBecomeActive() throws InterruptedException {
  MockRM rm=new MockRMWithElector(conf,1000);
  rm.start();
  LOG.info("Waiting for callback");
  while (!callbackCalled.get())   ;
  LOG.info("Stopping RM");
  rm.stop();
  LOG.info("Stopped RM");
}
