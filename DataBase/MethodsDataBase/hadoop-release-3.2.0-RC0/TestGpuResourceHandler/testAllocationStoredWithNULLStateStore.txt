@Test public void testAllocationStoredWithNULLStateStore() throws Exception {
  NMNullStateStoreService mockNMNULLStateStore=mock(NMNullStateStoreService.class);
  Configuration conf=new YarnConfiguration();
  conf.set(YarnConfiguration.NM_GPU_ALLOWED_DEVICES,"0:0,1:1,2:3,3:4");
  Context nmnctx=mock(Context.class);
  when(nmnctx.getNMStateStore()).thenReturn(mockNMNULLStateStore);
  when(nmnctx.getConf()).thenReturn(conf);
  GpuResourceHandlerImpl gpuNULLStateResourceHandler=new GpuResourceHandlerImpl(nmnctx,mockCGroupsHandler,mockPrivilegedExecutor);
  GpuDiscoverer.getInstance().initialize(conf);
  gpuNULLStateResourceHandler.bootstrap(conf);
  Assert.assertEquals(4,gpuNULLStateResourceHandler.getGpuAllocator().getAvailableGpus());
  Container container=mockContainerWithGpuRequest(1,3);
  gpuNULLStateResourceHandler.preStart(container);
  verify(nmnctx.getNMStateStore()).storeAssignedResources(container,ResourceInformation.GPU_URI,Arrays.asList(new GpuDevice(0,0),new GpuDevice(1,1),new GpuDevice(2,3)));
}
