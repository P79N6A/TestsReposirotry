@Test public void testUpdatePlacementRulesFactory() throws Exception {
  CapacitySchedulerConfiguration conf=new CapacitySchedulerConfiguration();
  setupQueueConfiguration(conf);
  conf.setClass(YarnConfiguration.RM_SCHEDULER,CapacityScheduler.class,ResourceScheduler.class);
  setupQueueMappingsForRules(conf,PARENT_QUEUE,true,new int[]{1,2,3});
  mockRM=new MockRM(conf);
  CapacityScheduler cs=(CapacityScheduler)mockRM.getResourceScheduler();
  cs.updatePlacementRules();
  mockRM.start();
  cs.start();
  List<PlacementRule> rules=cs.getRMContext().getQueuePlacementManager().getPlacementRules();
  List<String> placementRuleNames=new ArrayList<>();
  for (  PlacementRule pr : rules) {
    placementRuleNames.add(pr.getName());
  }
  assertThat(placementRuleNames,hasItems(QUEUE_MAPPING_RULE_USER_GROUP));
  assertThat(placementRuleNames,hasItems(QUEUE_MAPPING_RULE_APP_NAME));
}
