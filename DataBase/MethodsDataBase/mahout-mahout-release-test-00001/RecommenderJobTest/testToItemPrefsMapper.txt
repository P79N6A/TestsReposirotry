/** 
 * tests  {@link ToItemPrefsMapper}
 */
@Test public void testToItemPrefsMapper() throws Exception {
  Mapper<LongWritable,Text,VarLongWritable,VarLongWritable>.Context context=EasyMock.createMock(Mapper.Context.class);
  context.write(new VarLongWritable(12L),new EntityPrefWritable(34L,1.0f));
  context.write(new VarLongWritable(56L),new EntityPrefWritable(78L,2.0f));
  EasyMock.replay(context);
  ToItemPrefsMapper mapper=new ToItemPrefsMapper();
  mapper.map(new LongWritable(123L),new Text("12,34,1"),context);
  mapper.map(new LongWritable(456L),new Text("56,78,2"),context);
  EasyMock.verify(context);
}
