/** 
 * tests  {@link ToUserVectorsReducer} using boolean data
 */
@Test public void testToUserVectorReducerWithBooleanData() throws Exception {
  Reducer<VarLongWritable,VarLongWritable,VarLongWritable,VectorWritable>.Context context=EasyMock.createMock(Reducer.Context.class);
  Counter userCounters=EasyMock.createMock(Counter.class);
  EasyMock.expect(context.getCounter(ToUserVectorsReducer.Counters.USERS)).andReturn(userCounters);
  userCounters.increment(1);
  context.write(EasyMock.eq(new VarLongWritable(12L)),MathHelper.vectorMatches(MathHelper.elem(TasteHadoopUtils.idToIndex(34L),1.0),MathHelper.elem(TasteHadoopUtils.idToIndex(56L),1.0)));
  EasyMock.replay(context,userCounters);
  new ToUserVectorsReducer().reduce(new VarLongWritable(12L),Arrays.asList(new VarLongWritable(34L),new VarLongWritable(56L)),context);
  EasyMock.verify(context,userCounters);
}
