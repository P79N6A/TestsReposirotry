/** 
 * tests  {@link UserVectorSplitterMapper}
 */
@Test public void testUserVectorSplitterMapper() throws Exception {
  Mapper<VarLongWritable,VectorWritable,VarIntWritable,VectorOrPrefWritable>.Context context=EasyMock.createMock(Mapper.Context.class);
  context.write(EasyMock.eq(new VarIntWritable(34)),prefOfVectorOrPrefWritableMatches(123L,0.5f));
  context.write(EasyMock.eq(new VarIntWritable(56)),prefOfVectorOrPrefWritableMatches(123L,0.7f));
  EasyMock.replay(context);
  UserVectorSplitterMapper mapper=new UserVectorSplitterMapper();
  setField(mapper,"maxPrefsPerUserConsidered",10);
  RandomAccessSparseVector vector=new RandomAccessSparseVector(Integer.MAX_VALUE,100);
  vector.set(34,0.5);
  vector.set(56,0.7);
  mapper.map(new VarLongWritable(123L),new VectorWritable(vector),context);
  EasyMock.verify(context);
}
