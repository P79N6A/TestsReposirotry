@Test public void testVectorDistanceMapper() throws Exception {
  Mapper<WritableComparable<?>,VectorWritable,StringTuple,DoubleWritable>.Context context=EasyMock.createMock(Mapper.Context.class);
  StringTuple tuple=new StringTuple();
  tuple.add("foo");
  tuple.add("123");
  context.write(tuple,new DoubleWritable(Math.sqrt(2.0)));
  tuple=new StringTuple();
  tuple.add("foo2");
  tuple.add("123");
  context.write(tuple,new DoubleWritable(1));
  EasyMock.replay(context);
  Vector vector=new RandomAccessSparseVector(2);
  vector.set(0,2);
  vector.set(1,2);
  VectorDistanceMapper mapper=new VectorDistanceMapper();
  setField(mapper,"measure",new EuclideanDistanceMeasure());
  Collection<NamedVector> seedVectors=Lists.newArrayList();
  Vector seed1=new RandomAccessSparseVector(2);
  seed1.set(0,1);
  seed1.set(1,1);
  Vector seed2=new RandomAccessSparseVector(2);
  seed2.set(0,2);
  seed2.set(1,1);
  seedVectors.add(new NamedVector(seed1,"foo"));
  seedVectors.add(new NamedVector(seed2,"foo2"));
  setField(mapper,"seedVectors",seedVectors);
  mapper.map(new IntWritable(123),new VectorWritable(vector),context);
  EasyMock.verify(context);
}
