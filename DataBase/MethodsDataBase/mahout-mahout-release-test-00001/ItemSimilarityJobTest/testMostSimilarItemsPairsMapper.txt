/** 
 * Tests  {@link ItemSimilarityJob.MostSimilarItemPairsMapper}
 */
@Test public void testMostSimilarItemsPairsMapper() throws Exception {
  OpenIntLongHashMap indexItemIDMap=new OpenIntLongHashMap();
  indexItemIDMap.put(12,12L);
  indexItemIDMap.put(34,34L);
  indexItemIDMap.put(56,56L);
  Mapper<IntWritable,VectorWritable,EntityEntityWritable,DoubleWritable>.Context context=EasyMock.createMock(Mapper.Context.class);
  context.write(new EntityEntityWritable(34L,56L),new DoubleWritable(0.9));
  EasyMock.replay(context);
  Vector vector=new RandomAccessSparseVector(Integer.MAX_VALUE);
  vector.set(12,0.2);
  vector.set(56,0.9);
  ItemSimilarityJob.MostSimilarItemPairsMapper mapper=new ItemSimilarityJob.MostSimilarItemPairsMapper();
  setField(mapper,"indexItemIDMap",indexItemIDMap);
  setField(mapper,"maxSimilarItemsPerItem",1);
  mapper.map(new IntWritable(34),new VectorWritable(vector),context);
  EasyMock.verify(context);
}
