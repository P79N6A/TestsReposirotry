@Test public void testUnsignedLong() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutput out=new DataOutputStream(baos);
  Varint.writeUnsignedVarLong(0L,out);
  for (long i=1L; i > 0L && i <= (1L << 62); i<<=1) {
    Varint.writeUnsignedVarLong(i - 1,out);
    Varint.writeUnsignedVarLong(i,out);
  }
  Varint.writeUnsignedVarLong(Long.MAX_VALUE,out);
  DataInput in=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals(0L,Varint.readUnsignedVarLong(in));
  for (long i=1L; i > 0L && i <= (1L << 62); i<<=1) {
    assertEquals(i - 1,Varint.readUnsignedVarLong(in));
    assertEquals(i,Varint.readUnsignedVarLong(in));
  }
  assertEquals(Long.MAX_VALUE,Varint.readUnsignedVarLong(in));
}
