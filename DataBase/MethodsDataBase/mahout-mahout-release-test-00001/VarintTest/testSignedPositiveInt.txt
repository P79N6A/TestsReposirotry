@Test public void testSignedPositiveInt() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutput out=new DataOutputStream(baos);
  Varint.writeSignedVarInt(0,out);
  for (int i=1; i <= (1 << 29); i<<=1) {
    Varint.writeSignedVarLong(i - 1,out);
    Varint.writeSignedVarLong(i,out);
  }
  Varint.writeSignedVarInt((1 << 30) - 1,out);
  Varint.writeSignedVarInt((1 << 30),out);
  Varint.writeSignedVarInt(Integer.MAX_VALUE,out);
  DataInput in=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
  assertEquals(0,Varint.readSignedVarInt(in));
  for (int i=1; i <= (1 << 29); i<<=1) {
    assertEquals(i - 1,Varint.readSignedVarInt(in));
    assertEquals(i,Varint.readSignedVarInt(in));
  }
  assertEquals((1L << 30) - 1,Varint.readSignedVarInt(in));
  assertEquals((1L << 30),Varint.readSignedVarInt(in));
  assertEquals(Integer.MAX_VALUE,Varint.readSignedVarInt(in));
}
