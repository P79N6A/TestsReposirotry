@Test public void testHypercubeMapReduce() throws IOException {
  MapReduceDriver<Writable,VectorWritable,IntWritable,CentroidWritable,IntWritable,CentroidWritable> mapReduceDriver=new MapReduceDriver<>(new StreamingKMeansMapper(),new StreamingKMeansReducer());
  Configuration configuration=mapReduceDriver.getConfiguration();
  configure(configuration);
  System.out.printf("%s full test\n",configuration.get(StreamingKMeansDriver.SEARCHER_CLASS_OPTION));
  for (  Centroid datapoint : syntheticData.getFirst()) {
    mapReduceDriver.addInput(new IntWritable(0),new VectorWritable(datapoint));
  }
  List<org.apache.hadoop.mrunit.types.Pair<IntWritable,CentroidWritable>> results=mapReduceDriver.run();
  testReducerResults(syntheticData.getFirst().size(),results);
}
