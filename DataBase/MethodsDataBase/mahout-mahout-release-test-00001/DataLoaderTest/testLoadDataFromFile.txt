@Test public void testLoadDataFromFile() throws Exception {
  int nbAttributes=10;
  int datasize=100;
  String descriptor=Utils.randomDescriptor(rng,nbAttributes);
  Attribute[] attrs=DescriptorUtils.parseDescriptor(descriptor);
  double[][] source=Utils.randomDoubles(rng,descriptor,false,datasize);
  Collection<Integer> missings=Lists.newArrayList();
  String[] sData=prepareData(source,attrs,missings);
  Dataset dataset=DataLoader.generateDataset(descriptor,false,sData);
  Path dataPath=Utils.writeDataToTestFile(sData);
  FileSystem fs=dataPath.getFileSystem(getConfiguration());
  Data loaded=DataLoader.loadData(dataset,fs,dataPath);
  testLoadedData(source,attrs,missings,loaded);
  source=Utils.randomDoubles(rng,descriptor,true,datasize);
  missings=Lists.newArrayList();
  sData=prepareData(source,attrs,missings);
  dataset=DataLoader.generateDataset(descriptor,true,sData);
  dataPath=Utils.writeDataToTestFile(sData);
  fs=dataPath.getFileSystem(getConfiguration());
  loaded=DataLoader.loadData(dataset,fs,dataPath);
  testLoadedData(source,attrs,missings,loaded);
}
