/** 
 * Test method for {@link DataLoader#generateDataset(CharSequence,boolean,FileSystem,Path)}
 */
@Test public void testGenerateDatasetFromFile() throws Exception {
  int nbAttributes=10;
  int datasize=100;
  String descriptor=Utils.randomDescriptor(rng,nbAttributes);
  Attribute[] attrs=DescriptorUtils.parseDescriptor(descriptor);
  double[][] source=Utils.randomDoubles(rng,descriptor,false,datasize);
  Collection<Integer> missings=Lists.newArrayList();
  String[] sData=prepareData(source,attrs,missings);
  Dataset expected=DataLoader.generateDataset(descriptor,false,sData);
  Path path=Utils.writeDataToTestFile(sData);
  FileSystem fs=path.getFileSystem(getConfiguration());
  Dataset dataset=DataLoader.generateDataset(descriptor,false,fs,path);
  assertEquals(expected,dataset);
  source=Utils.randomDoubles(rng,descriptor,false,datasize);
  missings=Lists.newArrayList();
  sData=prepareData(source,attrs,missings);
  expected=DataLoader.generateDataset(descriptor,false,sData);
  path=Utils.writeDataToTestFile(sData);
  fs=path.getFileSystem(getConfiguration());
  dataset=DataLoader.generateDataset(descriptor,false,fs,path);
  assertEquals(expected,dataset);
}
