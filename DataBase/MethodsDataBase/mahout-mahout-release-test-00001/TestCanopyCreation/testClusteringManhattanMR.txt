/** 
 * Story: User can produce final point clustering using a Hadoop map/reduce job and a ManhattanDistanceMeasure.
 */
@Test public void testClusteringManhattanMR() throws Exception {
  List<VectorWritable> points=getPointsWritable();
  Configuration conf=getConfiguration();
  ClusteringTestUtils.writePointsToFile(points,true,getTestTempFilePath("testdata/file1"),fs,conf);
  ClusteringTestUtils.writePointsToFile(points,true,getTestTempFilePath("testdata/file2"),fs,conf);
  Path output=getTestTempDirPath("output");
  CanopyDriver.run(conf,getTestTempDirPath("testdata"),output,manhattanDistanceMeasure,3.1,2.1,true,0.0,false);
  Path path=new Path(output,"clusteredPoints/part-m-00000");
  long count=HadoopUtil.countRecords(path,conf);
  assertEquals("number of points",points.size(),count);
}
