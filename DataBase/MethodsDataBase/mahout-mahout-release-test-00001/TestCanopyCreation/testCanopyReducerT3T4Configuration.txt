/** 
 * Story: User can set T3 and T4 values to be used by the reducer for its T1 and T2 thresholds
 */
@Test public void testCanopyReducerT3T4Configuration() throws Exception {
  CanopyReducer reducer=new CanopyReducer();
  Configuration conf=getConfiguration();
  conf.set(CanopyConfigKeys.DISTANCE_MEASURE_KEY,"org.apache.mahout.common.distance.ManhattanDistanceMeasure");
  conf.set(CanopyConfigKeys.T1_KEY,String.valueOf(3.1));
  conf.set(CanopyConfigKeys.T2_KEY,String.valueOf(2.1));
  conf.set(CanopyConfigKeys.T3_KEY,String.valueOf(1.1));
  conf.set(CanopyConfigKeys.T4_KEY,String.valueOf(0.1));
  conf.set(CanopyConfigKeys.CF_KEY,"0");
  DummyRecordWriter<Text,ClusterWritable> writer=new DummyRecordWriter<>();
  Reducer<Text,VectorWritable,Text,ClusterWritable>.Context context=DummyRecordWriter.build(reducer,conf,writer,Text.class,VectorWritable.class);
  reducer.setup(context);
  assertEquals(1.1,reducer.getCanopyClusterer().getT1(),EPSILON);
  assertEquals(0.1,reducer.getCanopyClusterer().getT2(),EPSILON);
}
