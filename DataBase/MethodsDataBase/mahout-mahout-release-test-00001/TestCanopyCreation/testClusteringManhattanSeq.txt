/** 
 * Story: User can cluster points using sequential execution 
 */
@Test public void testClusteringManhattanSeq() throws Exception {
  List<VectorWritable> points=getPointsWritable();
  Configuration config=getConfiguration();
  ClusteringTestUtils.writePointsToFile(points,getTestTempFilePath("testdata/file1"),fs,config);
  Path output=getTestTempDirPath("output");
  CanopyDriver.run(config,getTestTempDirPath("testdata"),output,manhattanDistanceMeasure,3.1,2.1,true,0.0,true);
  Path path=new Path(output,"clusters-0-final/part-r-00000");
  int ix=0;
  for (  ClusterWritable clusterWritable : new SequenceFileValueIterable<ClusterWritable>(path,true,config)) {
    assertEquals("Center [" + ix + ']',manhattanCentroids.get(ix),clusterWritable.getValue().getCenter());
    ix++;
  }
  path=new Path(output,"clusteredPoints/part-m-0");
  long count=HadoopUtil.countRecords(path,config);
  assertEquals("number of points",points.size(),count);
}
