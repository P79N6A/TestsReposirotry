@Test public void testAffinityMatrixInputMapper() throws Exception {
  AffinityMatrixInputMapper mapper=new AffinityMatrixInputMapper();
  Configuration conf=getConfiguration();
  conf.setInt(Keys.AFFINITY_DIMENSIONS,RAW_DIMENSIONS);
  DummyRecordWriter<IntWritable,MatrixEntryWritable> writer=new DummyRecordWriter<>();
  Mapper<LongWritable,Text,IntWritable,MatrixEntryWritable>.Context context=DummyRecordWriter.build(mapper,conf,writer);
  for (  String s : RAW) {
    mapper.map(new LongWritable(),new Text(s),context);
  }
  assertEquals("Number of map results",RAW_DIMENSIONS,writer.getData().size());
  Set<IntWritable> keys=writer.getData().keySet();
  for (  IntWritable i : keys) {
    List<MatrixEntryWritable> row=writer.getData().get(i);
    assertEquals("Number of items in row",RAW_DIMENSIONS,row.size());
  }
}
