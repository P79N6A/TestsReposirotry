@Test public void testFPGFormatter() throws Exception {
  RegexMapper mapper=new RegexMapper();
  Configuration conf=getConfiguration();
  conf.set(RegexMapper.REGEX,"(?<=(\\?|&)q=).*?(?=&|$)");
  conf.set(RegexMapper.TRANSFORMER_CLASS,URLDecodeTransformer.class.getName());
  conf.set(RegexMapper.FORMATTER_CLASS,FPGFormatter.class.getName());
  DummyRecordWriter<LongWritable,Text> mapWriter=new DummyRecordWriter<>();
  Mapper<LongWritable,Text,LongWritable,Text>.Context mapContext=DummyRecordWriter.build(mapper,conf,mapWriter);
  mapper.setup(mapContext);
  RegexFormatter formatter=new FPGFormatter();
  for (int i=0; i < RegexUtilsTest.TEST_STRS.length; i++) {
    String testStr=RegexUtilsTest.TEST_STRS[i];
    LongWritable key=new LongWritable(i);
    mapper.map(key,new Text(testStr),mapContext);
    List<Text> value=mapWriter.getValue(key);
    if (!RegexUtilsTest.GOLD[i].isEmpty()) {
      assertEquals(1,value.size());
      assertEquals(formatter.format(RegexUtilsTest.GOLD[i]),value.get(0).toString());
    }
  }
}
