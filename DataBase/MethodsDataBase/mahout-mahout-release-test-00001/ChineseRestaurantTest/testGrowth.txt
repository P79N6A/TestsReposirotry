@Test public void testGrowth(){
  ChineseRestaurant s0=new ChineseRestaurant(10,0.0);
  ChineseRestaurant s5=new ChineseRestaurant(10,0.5);
  ChineseRestaurant s9=new ChineseRestaurant(10,0.9);
  Set<Double> splits=ImmutableSet.of(1.0,1.5,2.0,3.0,5.0,8.0);
  double offset0=0;
  int k=0;
  int i=0;
  Matrix m5=new DenseMatrix(20,3);
  Matrix m9=new DenseMatrix(20,3);
  while (i <= 200000) {
    double n=i / Math.pow(10,Math.floor(Math.log10(i)));
    if (splits.contains(n)) {
      if (i > 900) {
        double predict5=predictSize(m5.viewPart(0,k,0,3),i,0.5);
        assertEquals(predict5,Math.log(s5.size()),1);
        double predict9=predictSize(m9.viewPart(0,k,0,3),i,0.9);
        assertEquals(predict9,Math.log(s9.size()),1);
      }
 else       if (i > 50) {
        double x=10.5 * Math.log(i) - s0.size();
        m5.viewRow(k).assign(new double[]{Math.log(s5.size()),Math.log(i),1});
        m9.viewRow(k).assign(new double[]{Math.log(s9.size()),Math.log(i),1});
        k++;
        offset0+=(x - offset0) / k;
      }
      if (i > 10000) {
        assertEquals(0.0,(double)hapaxCount(s0) / s0.size(),0.25);
        assertEquals(0.5,(double)hapaxCount(s5) / s5.size(),0.1);
        assertEquals(0.9,(double)hapaxCount(s9) / s9.size(),0.05);
      }
    }
    s0.sample();
    s5.sample();
    s9.sample();
    i++;
  }
}
