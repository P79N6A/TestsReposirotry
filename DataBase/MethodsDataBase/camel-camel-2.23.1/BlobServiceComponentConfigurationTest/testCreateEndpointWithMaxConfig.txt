@Test public void testCreateEndpointWithMaxConfig() throws Exception {
  registerCredentials();
  ((JndiRegistry)((PropertyPlaceholderDelegateRegistry)context.getRegistry()).getRegistry()).bind("metadata",Collections.emptyMap());
  BlobServiceComponent component=new BlobServiceComponent(context);
  BlobServiceEndpoint endpoint=(BlobServiceEndpoint)component.createEndpoint("azure-blob://camelazure/container/blob?credentials=#creds&blobType=pageblob" + "&blobPrefix=blob1&fileDir=/tmp&blobOffset=512&operation=clearPageBlob&dataLength=1024" + "&streamWriteSize=512&streamReadSize=1024&closeStreamAfterRead=false&closeStreamAfterWrite=false"+ "&publicForRead=true&useFlatListing=false&blobMetadata=#metadata");
  assertEquals("camelazure",endpoint.getConfiguration().getAccountName());
  assertEquals("container",endpoint.getConfiguration().getContainerName());
  assertEquals("blob",endpoint.getConfiguration().getBlobName());
  assertNull(endpoint.getConfiguration().getAzureBlobClient());
  assertNotNull(endpoint.getConfiguration().getCredentials());
  assertEquals(BlobType.pageblob,endpoint.getConfiguration().getBlobType());
  assertEquals("blob1",endpoint.getConfiguration().getBlobPrefix());
  assertEquals("/tmp",endpoint.getConfiguration().getFileDir());
  assertEquals(Long.valueOf(512L),endpoint.getConfiguration().getBlobOffset());
  assertNotNull(endpoint.getConfiguration().getBlobMetadata());
  assertEquals(Long.valueOf(1024L),endpoint.getConfiguration().getDataLength());
  assertEquals(BlobServiceOperations.clearPageBlob,endpoint.getConfiguration().getOperation());
  assertEquals(512,endpoint.getConfiguration().getStreamWriteSize());
  assertEquals(1024,endpoint.getConfiguration().getStreamReadSize());
  assertFalse(endpoint.getConfiguration().isCloseStreamAfterRead());
  assertFalse(endpoint.getConfiguration().isCloseStreamAfterWrite());
  assertTrue(endpoint.getConfiguration().isPublicForRead());
  assertFalse(endpoint.getConfiguration().isUseFlatListing());
}
