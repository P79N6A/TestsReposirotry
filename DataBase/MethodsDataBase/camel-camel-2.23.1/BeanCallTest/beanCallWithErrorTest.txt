@Test public void beanCallWithErrorTest() throws Exception {
  new RouteBuilder(){
    @Override public void configure() throws Exception {
      onException(Throwable.class).to("direct:handle").handled(true);
      from("direct:num").bean(BeanCallTest.this,"processBodyWrongType").process(new UnwrapStreamProcessor()).to("mock:endpoint");
      from("direct:handle").setBody().constant("ERR").to("mock:endpoint");
    }
  }
.addRoutesToCamelContext(context);
  MockEndpoint mock=getMockEndpoint("mock:endpoint");
  mock.expectedMessageCount(1);
  context.start();
  template.sendBody("direct:num",1);
  mock.assertIsSatisfied();
  Exchange exchange=mock.getExchanges().get(0);
  assertEquals("ERR",exchange.getIn().getBody());
}
