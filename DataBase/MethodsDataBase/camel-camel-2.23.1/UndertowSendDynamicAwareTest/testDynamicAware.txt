@Test public void testDynamicAware() throws Exception {
  String out=fluentTemplate.to("direct:moes").withHeader("drink","beer").request(String.class);
  assertEquals("Drinking beer",out);
  out=fluentTemplate.to("direct:joes").withHeader("drink","wine").request(String.class);
  assertEquals("Drinking wine",out);
  boolean found=context.getEndpointMap().containsKey("undertow://http://localhost:" + getPort() + "?throwExceptionOnFailure=false");
  assertTrue("Should find static uri",found);
  assertEquals(4,context.getEndpointMap().size());
}
