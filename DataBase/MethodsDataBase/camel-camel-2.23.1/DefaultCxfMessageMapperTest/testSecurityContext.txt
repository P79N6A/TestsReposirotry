@Test public void testSecurityContext(){
  DefaultCxfMessageMapper mapper=new DefaultCxfMessageMapper();
  HttpServletRequest request=mock(HttpServletRequest.class);
  when(request.getUserPrincipal()).thenReturn(new SimplePrincipal("barry"));
  when(request.isUserInRole("role1")).thenReturn(true);
  when(request.isUserInRole("role2")).thenReturn(false);
  Exchange camelExchange=setupCamelExchange("/","/",request);
  Message cxfMessage=mapper.createCxfMessageFromCamelExchange(camelExchange,mock(HeaderFilterStrategy.class));
  SecurityContext sc=cxfMessage.get(SecurityContext.class);
  assertNotNull(sc);
  assertEquals("barry",sc.getUserPrincipal().getName());
  assertTrue(sc.isUserInRole("role1"));
  assertFalse(sc.isUserInRole("role2"));
}
