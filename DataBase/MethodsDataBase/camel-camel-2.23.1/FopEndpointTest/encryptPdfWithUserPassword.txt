@Test public void encryptPdfWithUserPassword() throws Exception {
  if (!canTest()) {
    return;
  }
  Endpoint endpoint=context().getEndpoint("fop:pdf");
  Producer producer=endpoint.createProducer();
  Exchange exchange=new DefaultExchange(context);
  final String password="secret";
  exchange.getIn().setHeader("CamelFop.Encrypt.userPassword",password);
  exchange.getIn().setBody(FopHelper.decorateTextWithXSLFO("Test Content"));
  producer.process(exchange);
  try (InputStream inputStream=exchange.getOut().getBody(InputStream.class)){
    PDDocument document=PDDocument.load(inputStream,password);
    assertTrue(document.isEncrypted());
  }
 }
