@Test public void testRestletProducerInFilterNotAllowedHeader() throws Exception {
  String notAcceptedHeaderKey=HEADER_FILTER + "ThisHeader";
  MockEndpoint mock=getMockEndpoint("mock:out");
  mock.whenAnyExchangeReceived(new Processor(){
    public void process(    Exchange exchange) throws Exception {
      Map<String,Object> headers=exchange.getIn().getHeaders();
      for (      String key : headers.keySet()) {
        assertFalse("Header should have been filtered: " + key,key.startsWith(HEADER_FILTER));
      }
    }
  }
);
  template.requestBodyAndHeader("direct:start",null,notAcceptedHeaderKey,"any value",String.class);
  mock.assertIsSatisfied();
}
