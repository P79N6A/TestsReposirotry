@Test public void testTracing() throws Exception {
  DefaultCamelContext context=new DefaultCamelContext();
  context.addRoutes(new RouteBuilder(){
    @Override public void configure() throws Exception {
      errorHandler(defaultErrorHandler().maximumRedeliveries(3).redeliveryDelay(2000L));
      from("direct:start").to("mock:result");
    }
  }
);
  context.setTracing(true);
  Tracer tracer=new Tracer();
  tracer.setDestinationUri("mock:traced");
  context.setDefaultTracer(tracer);
  context.start();
  MockEndpoint result=context.getEndpoint("mock:result",MockEndpoint.class);
  result.setExpectedMessageCount(1);
  MockEndpoint traced=context.getEndpoint("mock:traced",MockEndpoint.class);
  traced.setExpectedMessageCount(1);
  ProducerTemplate template=context.createProducerTemplate();
  template.sendBody("direct:start","foo");
  MockEndpoint.assertIsSatisfied(result,traced);
  context.stop();
}
