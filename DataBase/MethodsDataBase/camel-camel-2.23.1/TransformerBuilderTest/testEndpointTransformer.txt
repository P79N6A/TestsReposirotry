@Test public void testEndpointTransformer() throws Exception {
  CamelContext ctx=new DefaultCamelContext();
  RouteBuilder builder=new RouteBuilder(){
    @Override public void configure() throws Exception {
      transformer().fromType("json:foo").toType("xml:bar").withUri("direct:transformer");
      from("direct:transformer").log("test");
    }
  }
;
  ctx.addRoutes(builder);
  ctx.start();
  Transformer transformer=ctx.resolveTransformer(new DataType("json:foo"),new DataType("xml:bar"));
  assertNotNull(transformer);
  assertEquals(ProcessorTransformer.class,transformer.getClass());
  ProcessorTransformer pt=(ProcessorTransformer)transformer;
  Field f=ProcessorTransformer.class.getDeclaredField("processor");
  f.setAccessible(true);
  Object processor=f.get(pt);
  assertEquals(SendProcessor.class,processor.getClass());
  SendProcessor sp=(SendProcessor)processor;
  assertEquals("direct://transformer",sp.getEndpoint().getEndpointUri());
}
