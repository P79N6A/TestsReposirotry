@Test public void shouldStopTemplatesWithApplicationContextShutdown() throws Exception {
  assertTrue(((ServiceSupport)consumerTemplate).isStarted());
  assertTrue(((ServiceSupport)producerTemplate).isStarted());
  assertTrue(((ServiceSupport)fluentProducerTemplate).isStarted());
  applicationContext.close();
  assertFalse(applicationContext.isActive());
  assertTrue(((ServiceSupport)camelContext).isStopped());
  assertTrue(((ServiceSupport)consumerTemplate).isStopped());
  assertTrue(((ServiceSupport)producerTemplate).isStopped());
  assertTrue(((ServiceSupport)fluentProducerTemplate).isStopped());
}
