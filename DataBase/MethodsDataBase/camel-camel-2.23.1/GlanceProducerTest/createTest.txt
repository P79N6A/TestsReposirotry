@Test public void createTest() throws Exception {
  msg.setHeader(OpenstackConstants.OPERATION,OpenstackConstants.CREATE);
  msg.setHeader(OpenstackConstants.NAME,dummyImage.getName());
  msg.setHeader(GlanceConstants.OWNER,dummyImage.getOwner());
  msg.setHeader(GlanceConstants.MIN_DISK,dummyImage.getMinDisk());
  msg.setHeader(GlanceConstants.MIN_RAM,dummyImage.getMinRam());
  msg.setHeader(GlanceConstants.CHECKSUM,dummyImage.getChecksum());
  msg.setHeader(GlanceConstants.DISK_FORMAT,dummyImage.getDiskFormat());
  msg.setHeader(GlanceConstants.CONTAINER_FORMAT,dummyImage.getContainerFormat());
  final InputStream is=new FileInputStream(File.createTempFile("image",".iso"));
  msg.setBody(is);
  producer.process(exchange);
  verify(imageService).create(imageCaptor.capture(),payloadCaptor.capture());
  assertEquals(is,payloadCaptor.getValue().open());
  final Image result=msg.getBody(Image.class);
  assertNotNull(result.getId());
  assertEqualsImages(dummyImage,result);
}
