@Test public void testConsumerCacheZeroCapacity() throws Exception {
  ConsumerCache cache=new ConsumerCache(this,context,0);
  cache.start();
  assertEquals("Size should be 0",0,cache.size());
  Endpoint endpoint=context.getEndpoint("file:target/foo?fileName=foo.txt&initialDelay=0&delay=10");
  PollingConsumer consumer=cache.acquirePollingConsumer(endpoint);
  assertNotNull(consumer);
  assertEquals("Started",((org.apache.camel.support.ServiceSupport)consumer).getStatus().name());
  consumer.receive(50);
  boolean found=Thread.getAllStackTraces().keySet().stream().anyMatch(t -> t.getName().contains("target/foo"));
  assertFalse("Should not find file consumer thread",found);
  cache.releasePollingConsumer(endpoint,consumer);
  await().atMost(1,TimeUnit.SECONDS).untilAsserted(() -> assertEquals("Stopped",((ServiceSupport)consumer).getStatus().name()));
  found=Thread.getAllStackTraces().keySet().stream().anyMatch(t -> t.getName().contains("target/foo"));
  assertFalse("Should not find file consumer thread",found);
  cache.stop();
}
