@Test public void testReceptionOfTwoMessagesOneWithMedia() throws Exception {
  endpoint.expectedMinimumMessageCount(2);
  endpoint.assertIsSatisfied();
  Exchange mediaExchange=endpoint.getExchanges().get(1);
  IncomingMessage msg=mediaExchange.getIn().getBody(IncomingMessage.class);
  assertNotNull(msg.getPhoto());
  assertCollectionSize(msg.getPhoto(),4);
  assertEquals(4,msg.getPhoto().stream().map(ph -> ph.getFileId()).distinct().count());
}
