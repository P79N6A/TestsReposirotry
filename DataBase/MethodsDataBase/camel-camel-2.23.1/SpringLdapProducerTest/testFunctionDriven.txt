@Test public void testFunctionDriven() throws Exception {
  String dn="cn=dn";
  Exchange exchange=new DefaultExchange(context);
  Message in=new DefaultMessage(context);
  Map<String,Object> body=new HashMap<>();
  body.put(SpringLdapProducer.DN,dn);
  body.put(SpringLdapProducer.REQUEST,dn);
  body.put(SpringLdapProducer.FUNCTION,(BiFunction<LdapOperations,String,Void>)(l,q) -> {
    l.lookup(q);
    return null;
  }
);
  when(ldapEndpoint.getOperation()).thenReturn(LdapOperation.FUNCTION_DRIVEN);
  processBody(exchange,in,body);
  verify(ldapTemplate).lookup(eq(dn));
}
