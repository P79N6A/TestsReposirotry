@Test public void indexWithSnifferEnable() throws Exception {
  Map<String,String> map=createIndexedData();
  Map<String,Object> headers=new HashMap<>();
  headers.put(ElasticsearchConstants.PARAM_OPERATION,ElasticsearchOperation.Index);
  headers.put(ElasticsearchConstants.PARAM_INDEX_NAME,"facebook");
  headers.put(ElasticsearchConstants.PARAM_INDEX_TYPE,"post");
  headers.put(ElasticsearchConstants.PARAM_INDEX_ID,"4");
  String indexId=template.requestBodyAndHeaders("direct:indexWithSniffer",map,headers,String.class);
  assertNotNull("indexId should be set",indexId);
  assertEquals("Cluster must be of three nodes",runner.getNodeSize(),3);
  assertEquals("Index id 4 must exists",true,client.get(new GetRequest("facebook","post","4")).isExists());
  final BasicResponseHandler responseHandler=new BasicResponseHandler();
  String body=responseHandler.handleEntity(restClient.performRequest("GET","/_cluster/health?pretty").getEntity());
  assertStringContains(body,"\"number_of_data_nodes\" : 3");
}
