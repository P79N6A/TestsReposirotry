@Test public void onAcceptDataSmSuccess() throws Exception {
  SMPPSession session=mock(SMPPSession.class);
  DataSm dataSm=mock(DataSm.class);
  Exchange exchange=mock(Exchange.class);
  OptionalParameter[] optionalParameters=new OptionalParameter[]{};
  when(endpoint.createOnAcceptDataSm(dataSm,"1")).thenReturn(exchange);
  when(exchange.getException()).thenReturn(null);
  when(dataSm.getOptionalParameters()).thenReturn(optionalParameters);
  DataSmResult result=listener.onAcceptDataSm(dataSm,session);
  verify(endpoint).createOnAcceptDataSm(dataSm,"1");
  verify(processor).process(exchange);
  assertEquals("1",result.getMessageId());
  assertSame(optionalParameters,result.getOptionalParameters());
}
