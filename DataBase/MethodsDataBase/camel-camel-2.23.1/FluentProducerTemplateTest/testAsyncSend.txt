@Test public void testAsyncSend() throws Exception {
  MockEndpoint mock=getMockEndpoint("mock:async");
  mock.expectedMessageCount(2);
  FluentProducerTemplate fluent=context.createFluentProducerTemplate();
  Future<Exchange> future1=fluent.to("direct:async").withHeader("action","action-1").withBody("body-1").asyncSend();
  Future<Exchange> future2=fluent.to("direct:async").withHeader("action","action-2").withBody("body-2").asyncSend();
  Exchange exchange1=future1.get();
  Exchange exchange2=future2.get();
  assertEquals("action-1",exchange1.getIn().getHeader("action",String.class));
  assertEquals("body-1",exchange1.getIn().getBody(String.class));
  assertEquals("action-2",exchange2.getIn().getHeader("action",String.class));
  assertEquals("body-2",exchange2.getIn().getBody(String.class));
}
