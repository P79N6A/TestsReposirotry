@Test public void doStopShouldCloseTheSMPPSession() throws Exception {
  when(endpoint.getConnectionString()).thenReturn("smpp://smppclient@localhost:2775");
  when(endpoint.isSingleton()).thenReturn(true);
  producer.doStart();
  producer.doStop();
  verify(session).removeSessionStateListener(isA(SessionStateListener.class));
  verify(session).unbindAndClose();
}
