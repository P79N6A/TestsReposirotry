@Test public void testMultipleConsumers() throws Exception {
  context.addRoutes(new RouteBuilder(){
    @Override public void configure() throws Exception {
      from("reactive-streams:multipleConsumers?concurrentConsumers=3").process().message(m -> m.setHeader("thread",Thread.currentThread().getId())).to("mock:multipleBucket");
    }
  }
);
  context.start();
  Flux.range(0,1000).subscribe(crs.streamSubscriber("multipleConsumers",Number.class));
  MockEndpoint endpoint=getMockEndpoint("mock:multipleBucket");
  endpoint.expectedMessageCount(1000);
  endpoint.assertIsSatisfied();
  Assert.assertEquals(3,endpoint.getExchanges().stream().map(x -> x.getIn().getHeader("thread",String.class)).distinct().count());
}
