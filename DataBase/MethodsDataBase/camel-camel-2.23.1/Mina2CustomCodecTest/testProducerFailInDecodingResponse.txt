@Test public void testProducerFailInDecodingResponse() throws Exception {
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMessageCount(1);
  try {
    template.requestBody(String.format("mina2:tcp://localhost:%1$s?sync=true&codec=#failingCodec",getPort()),"Hello World");
    fail("Expecting that decode of result fails");
  }
 catch (  Exception e) {
    assertTrue(e instanceof CamelExecutionException);
    assertNotNull(e.getCause());
    Throwable rootCause=e;
    while (rootCause.getCause() != null) {
      rootCause=rootCause.getCause();
    }
    assertTrue(rootCause instanceof IllegalArgumentException);
    assertTrue(rootCause.getMessage().contains("Something went wrong in decode"));
  }
}
