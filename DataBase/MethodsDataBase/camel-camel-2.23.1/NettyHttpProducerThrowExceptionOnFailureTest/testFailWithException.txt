@Test public void testFailWithException() throws Exception {
  try {
    template().requestBody("netty4-http:http://localhost:{{port}}/fail?throwExceptionOnFailure=true",null,String.class);
    fail("Should throw an exception");
  }
 catch (  Throwable t) {
    NettyHttpOperationFailedException cause=(NettyHttpOperationFailedException)t.getCause();
    assertEquals(404,cause.getStatusCode());
  }
}
