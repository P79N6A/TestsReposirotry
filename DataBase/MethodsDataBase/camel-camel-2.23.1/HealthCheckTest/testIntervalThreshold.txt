@Test public void testIntervalThreshold() throws Exception {
  MyHealthCheck check=new MyHealthCheck();
  check.setState(HealthCheck.State.DOWN);
  check.getConfiguration().setEnabled(true);
  check.getConfiguration().setInterval(Duration.ofMillis(500));
  check.getConfiguration().setFailureThreshold(3);
  HealthCheck.Result result;
  int icount;
  int fcount;
  for (int i=0; i < check.getConfiguration().getFailureThreshold(); i++) {
    result=check.call();
    icount=(int)result.getDetails().get(AbstractHealthCheck.INVOCATION_COUNT);
    fcount=(int)result.getDetails().get(AbstractHealthCheck.FAILURE_COUNT);
    Assert.assertEquals(HealthCheck.State.UP,result.getState());
    Assert.assertEquals(i + 1,icount);
    Assert.assertEquals(i + 1,fcount);
    result=check.call();
    Assert.assertEquals(HealthCheck.State.UP,result.getState());
    Assert.assertEquals(icount,result.getDetails().get(AbstractHealthCheck.INVOCATION_COUNT));
    Assert.assertEquals(fcount,result.getDetails().get(AbstractHealthCheck.FAILURE_COUNT));
    Thread.sleep(550);
  }
  Assert.assertEquals(HealthCheck.State.DOWN,check.call().getState());
}
