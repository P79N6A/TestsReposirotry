@Test public void testOfferPeekAndPoll() throws Exception {
  final String val=context().getUuidGenerator().generateUuid();
  Message result;
  result=fluent.clearAll().withHeader(AtomixClientConstants.RESOURCE_ACTION,AtomixQueue.Action.OFFER).withBody(val).request(Message.class);
  assertTrue(result.getHeader(AtomixClientConstants.RESOURCE_ACTION_HAS_RESULT,Boolean.class));
  assertTrue(queue.contains(val).join());
  result=fluent.clearAll().withHeader(AtomixClientConstants.RESOURCE_ACTION,AtomixQueue.Action.PEEK).request(Message.class);
  assertTrue(result.getHeader(AtomixClientConstants.RESOURCE_ACTION_HAS_RESULT,Boolean.class));
  assertTrue(queue.contains(val).join());
  assertEquals(val,result.getBody());
  result=fluent.clearAll().withHeader(AtomixClientConstants.RESOURCE_ACTION,AtomixQueue.Action.POLL).request(Message.class);
  assertTrue(result.getHeader(AtomixClientConstants.RESOURCE_ACTION_HAS_RESULT,Boolean.class));
  assertFalse(queue.contains(val).join());
  assertEquals(val,result.getBody());
}
