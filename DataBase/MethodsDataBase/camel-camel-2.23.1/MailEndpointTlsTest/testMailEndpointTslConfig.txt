@Test public void testMailEndpointTslConfig() throws Exception {
  Properties properties=new Properties();
  properties.setProperty("mail." + protocol + ".starttls.enable","true");
  MailConfiguration cfg=new MailConfiguration();
  cfg.setPort(21);
  cfg.setProtocol(protocol);
  cfg.setHost("myhost");
  cfg.setUsername("james");
  cfg.setPassword("secret");
  cfg.setAdditionalJavaMailProperties(properties);
  assertTrue(cfg.isStartTlsEnabled());
  Properties javaMailProperties=cfg.createJavaMailSender().getJavaMailProperties();
  assertNull(javaMailProperties.get("mail." + protocol + ".ssl.socketFactory"));
  assertNull(javaMailProperties.get("mail." + protocol + ".ssl.socketFactory.port"));
}
