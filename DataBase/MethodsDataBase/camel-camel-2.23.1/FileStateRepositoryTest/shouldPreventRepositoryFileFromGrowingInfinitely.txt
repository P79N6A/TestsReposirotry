@Test public void shouldPreventRepositoryFileFromGrowingInfinitely() throws Exception {
  FileStateRepository repository=createRepository();
  repository.setMaxFileStoreSize(100);
  for (int i=0; i < 10; i++) {
    repository.setState("key","xxxxx".replace('x',(char)('0' + i)));
  }
  long previousSize=repositoryStore.length();
  repository.setState("key","value");
  assertTrue(repositoryStore.length() < previousSize);
}
