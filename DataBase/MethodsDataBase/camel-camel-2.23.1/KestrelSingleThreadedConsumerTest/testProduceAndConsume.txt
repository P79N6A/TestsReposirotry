@Test public void testProduceAndConsume() throws Exception {
  List<String> bodies=new ArrayList<>();
  for (int k=0; k < 10; ++k) {
    bodies.add("this is body #" + k);
  }
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMinimumMessageCount(bodies.size());
  mock.expectedBodiesReceivedInAnyOrder(bodies);
  for (  String body : bodies) {
    producerTemplate.sendBody(body);
  }
  mock.assertIsSatisfied();
}
