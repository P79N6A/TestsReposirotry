@Test public void testGenerateInvalidPayloadExceptionMessageWithEmbeddedStartOfBlock() throws Exception {
  byte[] basePayload=TEST_MESSAGE.getBytes();
  ByteArrayOutputStream payloadStream=new ByteArrayOutputStream(basePayload.length + 1);
  int embeddedStartOfBlockIndex=basePayload.length / 2;
  payloadStream.write(basePayload,0,embeddedStartOfBlockIndex);
  payloadStream.write(MllpProtocolConstants.START_OF_BLOCK);
  payloadStream.write(basePayload,embeddedStartOfBlockIndex,basePayload.length - embeddedStartOfBlockIndex);
  String expected="HL7 payload contains an embedded START_OF_BLOCK {0xb, ASCII <VT>} at index " + embeddedStartOfBlockIndex;
  assertEquals(expected,Hl7Util.generateInvalidPayloadExceptionMessage(payloadStream.toByteArray()));
}
