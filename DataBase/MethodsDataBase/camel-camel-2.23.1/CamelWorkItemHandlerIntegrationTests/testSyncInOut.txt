@Test public void testSyncInOut() throws Exception {
  String routeId="testSyncInOnlyExceptionRoute";
  RouteBuilder builder=new RouteBuilder(){
    @Override public void configure() throws Exception {
      from("direct:start").routeId(routeId).setBody(simple("${body.getParameter(\"Request\")}")).to("mock:result");
    }
  }
;
  context.addRoutes(builder);
  try {
    ServiceRegistry.get().register(JBPMConstants.GLOBAL_CAMEL_CONTEXT_SERVICE_KEY,context);
    String expectedBody="helloRequest";
    resultEndpoint.expectedBodiesReceived(expectedBody);
    WorkItemImpl workItem=new WorkItemImpl();
    workItem.setParameter(JBPMConstants.CAMEL_ENDPOINT_ID_WI_PARAM,"start");
    workItem.setParameter("Request",expectedBody);
    TestWorkItemManager manager=new TestWorkItemManager();
    AbstractCamelWorkItemHandler handler=new InOutCamelWorkItemHandler();
    handler.executeWorkItem(workItem,manager);
    assertThat(manager.getResults().size(),equalTo(1));
    resultEndpoint.assertIsSatisfied();
  }
  finally {
    context.removeRoute(routeId);
    ServiceRegistry.get().remove(JBPMConstants.GLOBAL_CAMEL_CONTEXT_SERVICE_KEY);
  }
}
