@Test public void testRetryFailure() throws Exception {
  final SalesforceComponent sf=context().getComponent("salesforce",SalesforceComponent.class);
  final String accessToken=sf.getSession().getAccessToken();
  final SslContextFactory sslContextFactory=new SslContextFactory();
  sslContextFactory.setSslContext(new SSLContextParameters().createSSLContext(context));
  final HttpClient httpClient=new HttpClient(sslContextFactory);
  httpClient.setConnectTimeout(60000);
  httpClient.start();
  final String uri=sf.getLoginConfig().getLoginUrl() + "/services/oauth2/revoke?token=" + accessToken;
  final Request logoutGet=httpClient.newRequest(uri).method(HttpMethod.GET).timeout(1,TimeUnit.MINUTES);
  final ContentResponse response=logoutGet.send();
  assertEquals(HttpStatus.OK_200,response.getStatus());
  final String password=sf.getLoginConfig().getPassword();
  sf.getLoginConfig().setPassword("bad_password");
  try {
    testGetGlobalObjects();
    fail("Expected CamelExecutionException!");
  }
 catch (  final CamelExecutionException e) {
    if (e.getCause() instanceof SalesforceException) {
      final SalesforceException cause=(SalesforceException)e.getCause();
      assertEquals("Expected 400 on authentication retry failure",HttpStatus.BAD_REQUEST_400,cause.getStatusCode());
    }
 else {
      fail("Expected SalesforceException!");
    }
  }
 finally {
    sf.getLoginConfig().setPassword(password);
  }
}
