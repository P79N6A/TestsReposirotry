@Test public void testUnregisterUndertowConsumersForPort() throws Exception {
  UndertowComponent component=context.getComponent("undertow",UndertowComponent.class);
  UndertowConsumer consumerFoo=(UndertowConsumer)context.getRoute("route-foo").getConsumer();
  UndertowConsumer consumerBar=(UndertowConsumer)context.getRoute("route-bar").getConsumer();
  component.unregisterEndpoint(consumerFoo.getEndpoint().getHttpHandlerRegistrationInfo(),consumerFoo.getEndpoint().getSslContext());
  component.unregisterEndpoint(consumerBar.getEndpoint().getHttpHandlerRegistrationInfo(),consumerBar.getEndpoint().getSslContext());
  try {
    template.requestBody("undertow:http://localhost:{{port}}/foo",null,String.class);
    fail("Expected exception when connecting to undertow endpoint");
  }
 catch (  CamelExecutionException e) {
    assertTrue(e.getExchange().getException() instanceof ConnectException);
  }
}
