@Test public void testLoadBalancer() throws Exception {
  DefaultServiceLoadBalancer loadBalancer=new DefaultServiceLoadBalancer();
  loadBalancer.setCamelContext(new DefaultCamelContext());
  loadBalancer.setServiceDiscovery(serviceDiscovery);
  loadBalancer.setServiceFilter(services -> services.stream().filter(s -> s.getPort() < 2000).collect(Collectors.toList()));
  loadBalancer.setServiceChooser(new RoundRobinServiceChooser());
  loadBalancer.process("no-name",service -> {
    assertEquals(1001,service.getPort());
    return false;
  }
);
  loadBalancer.process("no-name",service -> {
    assertEquals(1002,service.getPort());
    return false;
  }
);
}
