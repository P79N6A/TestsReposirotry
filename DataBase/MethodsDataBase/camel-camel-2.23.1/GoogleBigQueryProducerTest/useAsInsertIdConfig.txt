@Test public void useAsInsertIdConfig() throws Exception {
  configuration.setUseAsInsertId("row1");
  Map<String,String> object=new HashMap<>();
  object.put("row1","value1");
  producer.process(createExchangeWithBody(object));
  ArgumentCaptor<TableDataInsertAllRequest> dataCaptor=ArgumentCaptor.forClass(TableDataInsertAllRequest.class);
  verify(tabledataMock).insertAll(eq(projectId),eq(datasetId),eq(tableId),dataCaptor.capture());
  List<TableDataInsertAllRequest> requests=dataCaptor.getAllValues();
  assertEquals(1,requests.size());
  assertEquals(1,requests.get(0).getRows().size());
  assertEquals("value1",requests.get(0).getRows().get(0).getInsertId());
}
