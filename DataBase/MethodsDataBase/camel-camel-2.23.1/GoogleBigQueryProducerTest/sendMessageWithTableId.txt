@Test public void sendMessageWithTableId() throws Exception {
  Exchange exchange=createExchangeWithBody(new HashMap<>());
  exchange.getIn().setHeader(GoogleBigQueryConstants.TABLE_ID,"exchange_table_id");
  producer.process(exchange);
  ArgumentCaptor<TableDataInsertAllRequest> dataCaptor=ArgumentCaptor.forClass(TableDataInsertAllRequest.class);
  verify(tabledataMock).insertAll(eq(projectId),eq(datasetId),eq("exchange_table_id"),dataCaptor.capture());
  List<TableDataInsertAllRequest> requests=dataCaptor.getAllValues();
  assertEquals(1,requests.size());
  assertEquals(1,requests.get(0).getRows().size());
  assertNull(requests.get(0).getRows().get(0).getInsertId());
}
