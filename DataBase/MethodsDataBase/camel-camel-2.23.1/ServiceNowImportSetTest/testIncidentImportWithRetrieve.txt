@Test public void testIncidentImportWithRetrieve() throws Exception {
  MockEndpoint mock=getMockEndpoint("mock:servicenow");
  mock.reset();
  mock.expectedMessageCount(1);
  mock.expectedHeaderReceived(ServiceNowConstants.RESPONSE_TYPE,Incident.class);
  IncidentImportRequest incident=new IncidentImportRequest();
  incident.description=UUID.randomUUID().toString();
  template().sendBodyAndHeaders("direct:servicenow",incident,kvBuilder().put(ServiceNowConstants.RESOURCE,ServiceNowConstants.RESOURCE_IMPORT).put(ServiceNowConstants.ACTION,ServiceNowConstants.ACTION_CREATE).put(ServiceNowConstants.REQUEST_MODEL,IncidentImportRequest.class).put(ServiceNowConstants.RESPONSE_MODEL,Incident.class).put(ServiceNowConstants.RETRIEVE_TARGET_RECORD,true).put(ServiceNowParams.PARAM_TABLE_NAME,"u_test_imp_incident").build());
  mock.assertIsSatisfied();
  Incident response=mock.getExchanges().get(0).getIn().getBody(Incident.class);
  assertNotNull(response);
  assertEquals(incident.description,response.getDescription());
  assertNotNull(response.getNumber());
  assertNotNull(response.getId());
}
