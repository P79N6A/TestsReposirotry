@Test public void testJmsEndpoint() throws Exception {
  MBeanServer mbeanServer=getMBeanServer();
  Set<ObjectName> objectNames=mbeanServer.queryNames(new ObjectName("org.apache.camel:context=camel-*,type=endpoints,name=\"activemq://queue:start\""),null);
  assertEquals(1,objectNames.size());
  ObjectName name=objectNames.iterator().next();
  String uri=(String)mbeanServer.getAttribute(name,"EndpointUri");
  assertEquals("activemq://queue:start",uri);
  Boolean singleton=(Boolean)mbeanServer.getAttribute(name,"Singleton");
  assertTrue(singleton.booleanValue());
  Integer running=(Integer)mbeanServer.getAttribute(name,"RunningMessageListeners");
  assertEquals(1,running.intValue());
  Long size=(Long)mbeanServer.invoke(name,"queueSize",null,null);
  assertEquals(0,size.intValue());
  getMockEndpoint("mock:result").expectedMessageCount(2);
  template.sendBody("activemq:queue:start","Hello World");
  template.sendBody("activemq:queue:start","Bye World");
  assertMockEndpointsSatisfied();
  context.stopRoute("foo");
  template.sendBody("activemq:queue:start","Hi World");
  size=(Long)mbeanServer.invoke(name,"queueSize",null,null);
  assertEquals(1,size.intValue());
  String body=(String)mbeanServer.invoke(name,"browseMessageBody",new Object[]{0},new String[]{"java.lang.Integer"});
  assertEquals("Hi World",body);
}
