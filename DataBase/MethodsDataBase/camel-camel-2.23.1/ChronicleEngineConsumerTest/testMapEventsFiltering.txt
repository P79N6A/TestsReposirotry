@Test public void testMapEventsFiltering() throws Exception {
  final String key=UUID.randomUUID().toString();
  MockEndpoint mock=getMockEndpoint("mock:map-events-filtering");
  mock.expectedMessageCount(2);
  Map<String,String> map=client().acquireMap("/my/path",String.class,String.class);
  map.put(key,"val-1");
  map.put(key,"val-2");
  map.remove(key);
  mock.assertIsSatisfied();
  assertEquals(ChronicleEngineMapEventType.INSERT,mock.getExchanges().get(0).getIn().getHeader(ChronicleEngineConstants.MAP_EVENT_TYPE));
  assertEquals("val-1",mock.getExchanges().get(0).getIn().getBody(String.class));
  assertEquals(ChronicleEngineMapEventType.REMOVE,mock.getExchanges().get(1).getIn().getHeader(ChronicleEngineConstants.MAP_EVENT_TYPE));
  assertEquals("val-2",mock.getExchanges().get(1).getIn().getHeader(ChronicleEngineConstants.OLD_VALUE));
}
