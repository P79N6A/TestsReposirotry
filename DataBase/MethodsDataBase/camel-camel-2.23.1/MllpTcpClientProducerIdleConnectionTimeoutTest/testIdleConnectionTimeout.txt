@Test(expected=MllpJUnitResourceException.class) public void testIdleConnectionTimeout() throws Exception {
  complete.expectedMessageCount(2);
  writeEx.expectedMessageCount(0);
  receiveEx.expectedMessageCount(0);
  NotifyBuilder done=new NotifyBuilder(context).whenCompleted(2).create();
  source.sendBody(Hl7TestMessageGenerator.generateMessage());
  Thread.sleep(IDLE_TIMEOUT / 2);
  source.sendBody(Hl7TestMessageGenerator.generateMessage());
  assertTrue("Should have completed two exchanges",done.matches(5,TimeUnit.SECONDS));
  assertMockEndpointsSatisfied(5,TimeUnit.SECONDS);
  Thread.sleep((long)(IDLE_TIMEOUT * 1.1));
  mllpServer.checkClientConnections();
}
