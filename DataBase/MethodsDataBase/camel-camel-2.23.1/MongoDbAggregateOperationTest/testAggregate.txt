@Test public void testAggregate() throws Exception {
  assertEquals(0,testCollection.count());
  pumpDataIntoTestCollection();
  Object result=template.requestBody("direct:aggregate","[{ $match : {$or : [{\"scientist\" : \"Darwin\"},{\"scientist\" : \"Einstein\"}]}}," + "{ $group: { _id: \"$scientist\", count: { $sum: 1 }} },{ $sort : { _id : 1}} ]");
  assertTrue("Result is not of type List",result instanceof List);
  @SuppressWarnings("unchecked") List<BasicDBObject> resultList=(List<BasicDBObject>)result;
  assertListSize("Result does not contain 2 elements",resultList,2);
  assertEquals("First result DBOject._id should be Darwin","Darwin",resultList.get(0).get("_id"));
  assertEquals("First result DBOject.count should be 100",100,resultList.get(0).get("count"));
  assertEquals("Second result DBOject._id should be Einstein","Einstein",resultList.get(1).get("_id"));
  assertEquals("Second result DBOject.count should be 100",100,resultList.get(1).get("count"));
}
