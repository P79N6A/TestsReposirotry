@Test public void shouldSetReferences(){
  final SObjectTree tree=new SObjectTree();
  final SObjectNode account1=new SObjectNode(tree,simpleAccount);
  account1.addChild("Contacts",smith);
  account1.addChild("Contacts",evans);
  tree.addNode(account1);
  final SObjectNode account2=new SObjectNode(tree,simpleAccount2);
  tree.addNode(account2);
  final SObjectNode simpleAccountFromTree=tree.records.get(0);
  assertEquals("ref1",simpleAccountFromTree.getAttributes().getReferenceId());
  final Iterator<SObjectNode> simpleAccountNodes=simpleAccountFromTree.getChildNodes().iterator();
  assertEquals("ref2",simpleAccountNodes.next().getAttributes().getReferenceId());
  assertEquals("ref3",simpleAccountNodes.next().getAttributes().getReferenceId());
  assertEquals("ref4",account2.getAttributes().getReferenceId());
}
