@Test public void testServiceRegistry(){
  new ApplicationContextRunner().withConfiguration(AutoConfigurations.of(CamelAutoConfiguration.class,CamelCloudAutoConfiguration.class,CamelSpringCloudServiceRegistryAutoConfiguration.class)).withUserConfiguration(TestConfiguration.class).withPropertyValues("spring.main.banner-mode=off","ribbon.eureka.enabled=false","ribbon.enabled=false").run(context -> {
    CamelSpringCloudServiceRegistry camelRgistry=context.getBean(CamelSpringCloudServiceRegistry.class);
    final String serviceName="my-.service";
    final String serviceId=UUID.randomUUID().toString();
    final int port=ThreadLocalRandom.current().nextInt();
    camelRgistry.register(DefaultServiceDefinition.builder().withHost("localhost").withPort(port).withName(serviceName).withId(serviceId).build());
    MyServiceRegistry cloudRegistry=camelRgistry.getNativeServiceRegistry(MyServiceRegistry.class);
    assertThat(cloudRegistry.registrations).hasSize(1);
    assertThat(cloudRegistry.registrations.get(0)).hasFieldOrPropertyWithValue("serviceId",serviceName);
    assertThat(cloudRegistry.registrations.get(0)).hasFieldOrPropertyWithValue("host","localhost");
    assertThat(cloudRegistry.registrations.get(0)).hasFieldOrPropertyWithValue("port",port);
  }
);
}
