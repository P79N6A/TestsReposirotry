@Test public void setExceptionOnExchange() throws Exception {
  Session mockSession=Mockito.spy(TestSupport.createSession(sessionID));
  Mockito.doReturn(mockSession).when(producer).getSession(MessageUtils.getSessionID(inboundFixMessage));
  Mockito.doThrow(new TestException()).when(mockSession).send(isA(Message.class));
  producer.process(mockExchange);
  Mockito.verify(mockExchange).setException(isA(TestException.class));
}
