@Test public void testScanRefreshedFile() throws Exception {
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMessageCount(5);
  FileOutputStream fos=refreshFile(null);
  try {
    fos.write("Hello\nWorld\n".getBytes());
    Thread.sleep(150);
    context.startAllRoutes();
    Thread.sleep(1500);
    fos=refreshFile(fos);
    fos.write("Bye\nWorld\n".getBytes());
    fos.write("!\n".getBytes());
    Thread.sleep(1500);
  }
  finally {
    fos.close();
  }
  assertMockEndpointsSatisfied();
}
