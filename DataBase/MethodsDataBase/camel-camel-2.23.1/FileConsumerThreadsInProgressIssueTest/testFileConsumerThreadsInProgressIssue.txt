@Test public void testFileConsumerThreadsInProgressIssue() throws Exception {
  context.getShutdownStrategy().setTimeout(180);
  MockEndpoint mock=getMockEndpoint("mock:done");
  mock.expectedMessageCount(number);
  mock.expectsNoDuplicates(body());
  createManyFiles(number);
  context.startRoute("myRoute");
  mock.setResultWaitTime(180 * 1000);
  mock.assertIsSatisfied();
  context.stop();
  int found=0;
  log.info("=====================");
  log.info("Printing duplicates");
  for (  Map.Entry<String,Integer> ent : duplicate.entrySet()) {
    Integer count=ent.getValue();
    if (count > 1) {
      found++;
      log.info(ent.getKey() + " :: " + count);
    }
  }
  assertEquals("Should not contain duplicates",0,found);
}
