@Test public void testTypeConverterInSameBundleAsCamelRoute() throws Exception {
  URL blueprintUrl=ObjectHelper.loadResourceAsURL("org/apache/camel/itest/CamelTypeConverterTest.xml",CamelTypeConverterTest.class.getClassLoader());
  installBlueprintAsBundle("CamelTypeConverterTest",blueprintUrl,true,bundle -> {
    ((TinyBundle)bundle).add("META-INF/services/org/apache/camel/TypeConverter",new ByteArrayInputStream("org.apache.camel.itest.typeconverter.MyConverter".getBytes())).add(MyConverter.class,InnerClassStrategy.NONE).set(Constants.DYNAMICIMPORT_PACKAGE,"*");
  }
);
  CamelContext camel=getOsgiService(bundleContext,CamelContext.class);
  final Pojo pojo=new Pojo();
  String pojoName="Constantine";
  pojo.setName(pojoName);
  final DefaultExchange exchange=new DefaultExchange(camel);
  final String string=camel.getTypeConverter().mandatoryConvertTo(String.class,exchange,pojo);
  LOG.info("POJO -> String: {}",string);
  final Pojo copy=camel.getTypeConverter().mandatoryConvertTo(Pojo.class,exchange,string);
  LOG.info("String -> POJO: {}",copy);
  Assert.assertEquals(pojoName,copy.getName());
}
