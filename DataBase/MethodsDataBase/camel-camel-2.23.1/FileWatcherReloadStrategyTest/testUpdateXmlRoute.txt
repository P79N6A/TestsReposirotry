@Test public void testUpdateXmlRoute() throws Exception {
  deleteDirectory("target/dummy");
  createDirectory("target/dummy");
  final CountDownLatch latch=new CountDownLatch(2);
  context.getManagementStrategy().addEventNotifier(new EventNotifierSupport(){
    @Override public void notify(    EventObject event) throws Exception {
      latch.countDown();
    }
    @Override public boolean isEnabled(    EventObject event){
      return event instanceof RouteAddedEvent;
    }
  }
);
  context.start();
  assertEquals(0,context.getRoutes().size());
  log.info("Copying file to target/dummy");
  FileUtil.copyFile(new File("src/test/resources/org/apache/camel/model/barRoute.xml"),new File("target/dummy/barRoute.xml"));
  await().atMost(20,TimeUnit.SECONDS).untilAsserted(() -> assertEquals(1,context.getRoutes().size()));
  getMockEndpoint("mock:bar").expectedMessageCount(1);
  template.sendBody("direct:bar","Hello World");
  assertMockEndpointsSatisfied();
  resetMocks();
  log.info("Updating file in target/dummy");
  FileUtil.copyFile(new File("src/test/resources/org/apache/camel/model/barUpdatedRoute.xml"),new File("target/dummy/barRoute.xml"));
  boolean done=latch.await(20,TimeUnit.SECONDS);
  assertTrue("Should reload file within 20 seconds",done);
  Thread.sleep(500);
  getMockEndpoint("mock:bar").expectedBodiesReceived("Bye Camel");
  template.sendBody("direct:bar","Camel");
  assertMockEndpointsSatisfied();
}
