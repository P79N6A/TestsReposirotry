@Test public void testClientDisconnect() throws Exception {
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMessageCount(1);
  MockEndpoint onComplete=getMockEndpoint("mock:onComplete");
  onComplete.expectedMessageCount(1);
  TelnetClient telnetClient=new TelnetClient();
  telnetClient.connect("localhost",PORT);
  telnetClient.setTcpNoDelay(true);
  telnetClient.setReceiveBufferSize(1);
  BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(telnetClient.getOutputStream()));
  writer.write("GET " + CONTEXT + "/rest/customerservice/customers HTTP/1.1\nhost: localhost\n\n");
  writer.flush();
  telnetClient.disconnect();
  mock.assertIsSatisfied();
  onComplete.assertIsSatisfied();
}
