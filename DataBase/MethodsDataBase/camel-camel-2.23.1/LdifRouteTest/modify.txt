@Test @ApplyLdifFiles({"org/apache/camel/component/ldif/ModifySetup.ldif"}) public void modify() throws Exception {
  camel.addRoutes(createRouteBuilder(ENDPOINT_LDIF));
  camel.start();
  Endpoint endpoint=camel.getEndpoint(ENDPOINT_START);
  Exchange exchange=endpoint.createExchange();
  URL loc=this.getClass().getResource("/org/apache/camel/component/ldif/Modify.ldif");
  exchange.getIn().setBody(loc.toString());
  Exchange out=template.send(endpoint,exchange);
  List<String> ldifResults=defaultLdapModuleOutAssertions(out);
  assertThat(ldifResults,notNullValue());
  assertThat(ldifResults.size(),equalTo(1));
  assertThat(ldifResults.get(0),equalTo("success"));
  SearchResult sr;
  NamingEnumeration<SearchResult> searchResults=ldapContext.search("","(uid=test*)",SEARCH_CONTROLS);
  assertNotNull(searchResults);
  sr=searchResults.next();
  assertNotNull(sr);
  assertThat("uid=test4,ou=test,ou=system",equalTo(sr.getName()));
  Attributes attribs=sr.getAttributes();
  assertNotNull(attribs);
  Attribute attrib=attribs.get("sn");
  assertNotNull(attribs);
  assertThat(1,equalTo(attrib.size()));
  assertThat("5",equalTo(attrib.get(0).toString()));
  assertThat(false,equalTo(searchResults.hasMore()));
}
