@Test public void testAggregator() throws Exception {
  String allNames="Harpo Marx,Fiodor Karamazov,Chico Marx,Ivan Karamazov,Groucho Marx,Alexei Karamazov,Dimitri Karamazov";
  List<String> marxBrothers=new ArrayList<>();
  marxBrothers.add("Harpo");
  marxBrothers.add("Chico");
  marxBrothers.add("Groucho");
  List<String> karamazovBrothers=new ArrayList<>();
  karamazovBrothers.add("Fiodor");
  karamazovBrothers.add("Ivan");
  karamazovBrothers.add("Alexei");
  karamazovBrothers.add("Dimitri");
  Map<String,List<String>> allBrothers=new HashMap<>();
  allBrothers.put("Marx",marxBrothers);
  allBrothers.put("Karamazov",karamazovBrothers);
  MockEndpoint resultEndpoint=getMockEndpoint("mock:result");
  resultEndpoint.expectedMessageCount(1);
  resultEndpoint.expectedBodiesReceived(allBrothers);
  template.sendBody("direct:start",allNames);
  assertMockEndpointsSatisfied();
}
