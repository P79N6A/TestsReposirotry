@Test public void testSingleConsumer() throws Exception {
  Observable.intervalRange(0,1000,0,300,TimeUnit.MICROSECONDS).toFlowable(BackpressureStrategy.BUFFER).subscribe(CamelReactiveStreams.get(context()).streamSubscriber("singleConsumer",Long.class));
  MockEndpoint endpoint=getMockEndpoint("mock:singleBucket");
  endpoint.expectedMessageCount(1000);
  endpoint.assertIsSatisfied();
  Set<String> threads=endpoint.getExchanges().stream().map(x -> x.getIn().getHeader("thread",String.class)).collect(Collectors.toSet());
  assertEquals(1,threads.size());
  List<Long> nums=endpoint.getExchanges().stream().map(x -> x.getIn().getBody(Long.class)).collect(Collectors.toList());
  long prev=-1;
  for (  long n : nums) {
    assertEquals(prev + 1,n);
    prev=n;
  }
}
