@Test public void testDuplicateMessages() throws Exception {
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedBodiesReceived("one","two","three");
  template.sendBodyAndHeader("direct:start","one","messageId","1");
  template.sendBodyAndHeader("direct:start","two","messageId","2");
  template.sendBodyAndHeader("direct:start","one","messageId","1");
  template.sendBodyAndHeader("direct:start","two","messageId","2");
  template.sendBodyAndHeader("direct:start","one","messageId","1");
  template.sendBodyAndHeader("direct:start","three","messageId","3");
  mock.assertIsSatisfied();
}
