@Test public void testConfigurationWithHeaderExpression() throws Exception {
  if (!canTest()) {
    return;
  }
  MockEndpoint resultEndpoint=resolveMandatoryEndpoint("mock:result",MockEndpoint.class);
  resultEndpoint.expectedMessageCount(MESSAGE_COUNT);
  ExecutorService executor=Executors.newFixedThreadPool(MESSAGE_COUNT);
  try {
    sendMessagesWithHeaderExpression(executor,resultEndpoint,5,INTERVAL,MESSAGE_COUNT);
  }
  finally {
    executor.shutdownNow();
  }
}
