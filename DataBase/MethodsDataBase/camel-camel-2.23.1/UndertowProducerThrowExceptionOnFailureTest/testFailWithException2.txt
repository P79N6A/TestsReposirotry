@Test public void testFailWithException2() throws Exception {
  try {
    fluentTemplate().to("undertow:http://localhost:{{port2}}/test/fail?throwExceptionOnFailure=true").withHeader(Exchange.HTTP_METHOD,"PUT").withBody("This is not JSON format").request(String.class);
    fail("Should throw an exception");
  }
 catch (  CamelExecutionException e) {
    HttpOperationFailedException httpException=assertIsInstanceOf(HttpOperationFailedException.class,e.getCause());
    assertEquals(400,httpException.getStatusCode());
    assertEquals("text/plain",httpException.getResponseHeaders().get(Exchange.CONTENT_TYPE));
    assertEquals("Invalid json data",httpException.getResponseBody());
  }
}
