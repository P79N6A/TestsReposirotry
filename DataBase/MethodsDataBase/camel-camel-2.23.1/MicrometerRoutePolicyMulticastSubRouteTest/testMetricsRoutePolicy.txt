@Test public void testMetricsRoutePolicy() throws Exception {
  int count=10;
  getMockEndpoint("mock:foo").expectedMessageCount(count);
  getMockEndpoint("mock:bar1").expectedMessageCount(count);
  getMockEndpoint("mock:bar2").expectedMessageCount(count);
  for (int i=0; i < count; i++) {
    template.sendBody("direct:multicast","Hello World");
  }
  assertMockEndpointsSatisfied();
  List<Meter> meters=meterRegistry.getMeters();
  assertEquals(3,meters.size());
  meters.forEach(meter -> {
    Timer timer=(Timer)meter;
    assertEquals("Timer " + timer.getId() + " should have count of "+ count,count,timer.count());
  }
);
}
