@Test public void precedenceShouldBeFollowed(){
  final SalesforceEndpointConfig componentConfig=new SalesforceEndpointConfig();
  componentConfig.setDefaultReplayId(1L);
  componentConfig.setInitialReplayIdMap(Collections.singletonMap("my-topic-1",2L));
  componentConfig.setInitialReplayIdMap(Collections.singletonMap("my-topic-2",3L));
  final SalesforceEndpointConfig endpointConfig=new SalesforceEndpointConfig();
  endpointConfig.setDefaultReplayId(4L);
  endpointConfig.setInitialReplayIdMap(Collections.singletonMap("my-topic-1",5L));
  final SalesforceComponent component=mock(SalesforceComponent.class);
  when(component.getConfig()).thenReturn(componentConfig);
  final SalesforceEndpoint endpoint=mock(SalesforceEndpoint.class);
  when(endpoint.getReplayId()).thenReturn(null);
  when(endpoint.getComponent()).thenReturn(component);
  when(endpoint.getConfiguration()).thenReturn(endpointConfig);
  assertEquals("Expecting replayId for `my-topic-1` to be 5, as endpoint configuration has priority",Optional.of(5L),determineReplayIdFor(endpoint,"my-topic-1"));
  assertEquals("Expecting replayId for `my-topic-2` to be 3, as endpoint does not configure it",Optional.of(3L),determineReplayIdFor(endpoint,"my-topic-2"));
  assertEquals("Expecting replayId for `my-topic-3` to be 4, as it is endpoint's default",Optional.of(4L),determineReplayIdFor(endpoint,"my-topic-3"));
  endpointConfig.setDefaultReplayId(null);
  assertEquals("Expecting replayId for `my-topic-3` to be 1, as it is component's default when endpoint does not have a default",Optional.of(1L),determineReplayIdFor(endpoint,"my-topic-3"));
  when(endpoint.getReplayId()).thenReturn(6L);
  assertEquals("Expecting replayId for `my-topic-1` to be 6, as it is endpoint configured explicitly on the endpoint",Optional.of(6L),determineReplayIdFor(endpoint,"my-topic-1"));
  assertEquals("Expecting replayId for `my-topic-2` to be 6, as it is endpoint configured explicitly on the endpoint",Optional.of(6L),determineReplayIdFor(endpoint,"my-topic-2"));
  assertEquals("Expecting replayId for `my-topic-3` to be 6, as it is endpoint configured explicitly on the endpoint",Optional.of(6L),determineReplayIdFor(endpoint,"my-topic-3"));
}
