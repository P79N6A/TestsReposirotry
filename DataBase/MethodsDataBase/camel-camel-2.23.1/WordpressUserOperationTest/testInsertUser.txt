@Test public void testInsertUser() throws InterruptedException {
  MockEndpoint mock=getMockEndpoint("mock:resultInsert");
  mock.expectedBodyReceived().body(User.class);
  mock.expectedMessageCount(1);
  final User request=new User();
  request.setEmail("bill.denbrough@derry.com");
  request.setUsername("bdenbrough");
  request.setFirstName("Bill");
  request.setLastName("Denbrough");
  request.setNickname("Big Bill");
  final User response=(User)template.requestBody("direct:insertUser",request);
  assertThat(response.getId(),is(3));
  assertThat(response.getSlug(),is("bdenbrough"));
  assertMockEndpointsSatisfied();
}
