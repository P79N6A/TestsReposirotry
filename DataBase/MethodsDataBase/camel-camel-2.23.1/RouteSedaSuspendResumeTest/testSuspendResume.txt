@Test public void testSuspendResume() throws Exception {
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedBodiesReceived("A");
  template.sendBody("seda:foo","A");
  assertMockEndpointsSatisfied();
  log.info("Suspending");
  resetMocks();
  mock.expectedMessageCount(0);
  context.suspendRoute("foo");
  assertEquals("Suspended",context.getRouteStatus("foo").name());
  Route route=context.getRoute("foo");
  if (route instanceof StatefulService) {
    assertEquals("Suspended",((StatefulService)route).getStatus().name());
  }
  await().atMost(1,TimeUnit.SECONDS).until(() -> context.getEndpoint("seda:foo",SedaEndpoint.class).getQueue().size() == 0);
  template.sendBody("seda:foo","B");
  mock.assertIsSatisfied(100);
  log.info("Resuming");
  resetMocks();
  mock.expectedBodiesReceived("B");
  context.resumeRoute("foo");
  assertMockEndpointsSatisfied();
  assertEquals("Started",context.getRouteStatus("foo").name());
  route=context.getRoute("foo");
  if (route instanceof StatefulService) {
    assertEquals("Started",((StatefulService)route).getStatus().name());
  }
}
