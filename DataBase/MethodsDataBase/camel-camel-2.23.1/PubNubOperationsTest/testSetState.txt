@Test public void testSetState() throws Exception {
  stubFor(get(urlPathEqualTo("/v2/presence/sub-key/mySubscribeKey/channel/myChannel/uuid/myuuid/data")).willReturn(aResponse().withBody("{ \"status\": 200, \"message\": \"OK\", \"payload\": { \"age\" : 20, \"status\" : \"online\" }, \"service\": \"Presence\"}")));
  Map<String,Object> myState=new HashMap<>();
  myState.put("age",20);
  Map<String,Object> headers=new HashMap<>();
  headers.put(PubNubConstants.OPERATION,"SETSTATE");
  PNSetStateResult response=template.requestBodyAndHeaders("direct:publish",myState,headers,PNSetStateResult.class);
  assertNotNull(response);
  assertNotNull(response.getState());
  assertEquals(20,response.getState().getAsJsonObject().get("age").getAsInt());
}
