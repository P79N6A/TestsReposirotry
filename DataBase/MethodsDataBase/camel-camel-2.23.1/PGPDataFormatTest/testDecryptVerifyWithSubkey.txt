/** 
 * You get three keys with the UserId "keyflag", a primary key and its two sub-keys. The sub-key with KeyFlag  {@link KeyFlags#SIGN_DATA} should beused for signing and the sub-key with KeyFlag {@link KeyFlags#ENCRYPT_COMMS} or {@link KeyFlags#ENCRYPT_COMMS} or{@link KeyFlags#ENCRYPT_STORAGE} should be used for decryption.<p> Tests also the decryption and verifying part with the subkeys.
 * @throws Exception
 */
@Test public void testDecryptVerifyWithSubkey() throws Exception {
  String payload="Test Message";
  MockEndpoint mockSubkey=getMockEndpoint("mock:unencrypted");
  mockSubkey.expectedBodiesReceived(payload);
  template.sendBody("direct:subkey",payload);
  assertMockEndpointsSatisfied();
}
