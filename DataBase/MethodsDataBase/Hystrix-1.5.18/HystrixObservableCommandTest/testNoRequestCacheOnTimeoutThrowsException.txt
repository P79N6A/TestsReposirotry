@Test public void testNoRequestCacheOnTimeoutThrowsException() throws Exception {
  TestCircuitBreaker circuitBreaker=new TestCircuitBreaker();
  NoRequestCacheTimeoutWithoutFallback r1=new NoRequestCacheTimeoutWithoutFallback(circuitBreaker);
  try {
    System.out.println("r1 value: " + r1.observe().toBlocking().single());
    fail("expected a timeout");
  }
 catch (  HystrixRuntimeException e) {
    assertTrue(r1.isResponseTimedOut());
  }
  NoRequestCacheTimeoutWithoutFallback r2=new NoRequestCacheTimeoutWithoutFallback(circuitBreaker);
  try {
    r2.observe().toBlocking().single();
    fail("expected a timeout");
  }
 catch (  HystrixRuntimeException e) {
    assertTrue(r2.isResponseTimedOut());
  }
  NoRequestCacheTimeoutWithoutFallback r3=new NoRequestCacheTimeoutWithoutFallback(circuitBreaker);
  Future<Boolean> f3=r3.observe().toBlocking().toFuture();
  try {
    f3.get();
    fail("expected a timeout");
  }
 catch (  ExecutionException e) {
    e.printStackTrace();
    assertTrue(r3.isResponseTimedOut());
  }
  Thread.sleep(500);
  NoRequestCacheTimeoutWithoutFallback r4=new NoRequestCacheTimeoutWithoutFallback(circuitBreaker);
  try {
    r4.observe().toBlocking().single();
    fail("expected a timeout");
  }
 catch (  HystrixRuntimeException e) {
    e.printStackTrace();
    assertTrue(r4.isResponseTimedOut());
    assertFalse(r4.isResponseFromFallback());
  }
  assertCommandExecutionEvents(r1,HystrixEventType.TIMEOUT,HystrixEventType.FALLBACK_MISSING);
  assertCommandExecutionEvents(r2,HystrixEventType.TIMEOUT,HystrixEventType.FALLBACK_MISSING);
  assertCommandExecutionEvents(r3,HystrixEventType.TIMEOUT,HystrixEventType.FALLBACK_MISSING);
  assertCommandExecutionEvents(r4,HystrixEventType.TIMEOUT,HystrixEventType.FALLBACK_MISSING);
  assertEquals(0,circuitBreaker.metrics.getCurrentConcurrentExecutionCount());
  assertSaneHystrixRequestLog(4);
}
