@Test public void testAddCallback() throws Exception {
  final DynamicStringProperty node1=new DynamicStringProperty("n1","n1");
  final HystrixPropertiesChainedArchaiusProperty.StringProperty node2=new HystrixPropertiesChainedArchaiusProperty.StringProperty("n2",node1);
  final AtomicInteger callbackCount=new AtomicInteger(0);
  node2.addCallback(new Runnable(){
    @Override public void run(){
      callbackCount.incrementAndGet();
    }
  }
);
  assertTrue(0 == callbackCount.get());
  assertTrue("n1".equals(node2.get()));
  assertTrue(0 == callbackCount.get());
  ConfigurationManager.getConfigInstance().setProperty("n1","n11");
  assertTrue("n11".equals(node2.get()));
  assertTrue(0 == callbackCount.get());
  ConfigurationManager.getConfigInstance().setProperty("n2","n22");
  assertTrue("n22".equals(node2.get()));
  assertTrue(1 == callbackCount.get());
  ConfigurationManager.getConfigInstance().clearProperty("n1");
  assertTrue("n22".equals(node2.get()));
  assertTrue(1 == callbackCount.get());
  ConfigurationManager.getConfigInstance().setProperty("n2","n222");
  assertTrue("n222".equals(node2.get()));
  assertTrue(2 == callbackCount.get());
  ConfigurationManager.getConfigInstance().clearProperty("n2");
  assertTrue("n1".equals(node2.get()));
  assertTrue(3 == callbackCount.get());
}
