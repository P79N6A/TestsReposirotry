/** 
 * Test that on an open circuit that a single attempt will be allowed after a window of time to see if issues are resolved.
 */
@Test public void testSingleTestOnOpenCircuitAfterTimeWindow(){
  String key="cmd-F";
  try {
    int sleepWindow=200;
    HystrixCommand<Boolean> cmd1=new FailureCommand(key,60);
    HystrixCircuitBreaker cb=cmd1.circuitBreaker;
    assertTrue(cb.allowRequest());
    assertFalse(cb.isOpen());
    cmd1.execute();
    HystrixCommand<Boolean> cmd2=new FailureCommand(key,1);
    cmd2.execute();
    HystrixCommand<Boolean> cmd3=new FailureCommand(key,1);
    cmd3.execute();
    HystrixCommand<Boolean> cmd4=new FailureCommand(key,1);
    cmd4.execute();
    Thread.sleep(100);
    assertFalse(cb.allowRequest());
    assertTrue(cb.isOpen());
    Thread.sleep(sleepWindow + 50);
    assertTrue(cb.allowRequest());
    assertTrue(cb.isOpen());
    assertFalse(cb.allowRequest());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Error occurred: " + e.getMessage());
  }
}
