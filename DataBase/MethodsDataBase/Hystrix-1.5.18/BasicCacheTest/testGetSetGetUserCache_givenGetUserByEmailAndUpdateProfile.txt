@Test public void testGetSetGetUserCache_givenGetUserByEmailAndUpdateProfile(){
  User user=userService.getUserByEmail("email");
  HystrixInvokableInfo<?> getUserByIdCommand=getLastExecutedCommand();
  assertFalse(getUserByIdCommand.isResponseFromCache());
  assertEquals("1",user.getId());
  assertEquals("name",user.getName());
  assertEquals("email",user.getProfile().getEmail());
  user=userService.getUserByEmail("email");
  assertEquals("1",user.getId());
  getUserByIdCommand=getLastExecutedCommand();
  assertTrue(getUserByIdCommand.isResponseFromCache());
  assertEquals("email",user.getProfile().getEmail());
  Profile profile=new Profile();
  profile.setEmail("new_email");
  user.setProfile(profile);
  userService.updateProfile(user);
  user=userService.getUserByEmail("new_email");
  getUserByIdCommand=getLastExecutedCommand();
  assertFalse(getUserByIdCommand.isResponseFromCache());
  assertEquals("1",user.getId());
  assertEquals("name",user.getName());
  assertEquals("new_email",user.getProfile().getEmail());
  resetContext();
  user=userService.getUserByEmail("new_email");
  getUserByIdCommand=getLastExecutedCommand();
  assertEquals("1",user.getId());
  assertFalse(getUserByIdCommand.isResponseFromCache());
}
