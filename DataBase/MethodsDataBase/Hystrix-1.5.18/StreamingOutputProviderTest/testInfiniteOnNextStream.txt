@Test public void testInfiniteOnNextStream() throws Exception {
  final PipedInputStream is=new PipedInputStream();
  final PipedOutputStream os=new PipedOutputStream(is);
  final AtomicInteger writes=new AtomicInteger(0);
  final HystrixStream stream=new HystrixStream(streamOfOnNexts,100,new AtomicInteger(1));
  Thread streamingThread=startStreamingThread(stream,os);
  verifyStream(is,writes);
  Thread.sleep(1000);
  streamingThread.interrupt();
  os.close();
  is.close();
  System.out.println("Total lines:" + writes.get());
  assertTrue(writes.get() >= 9);
  assertTrue(stream.getConcurrentConnections().get() == 0);
}
