/** 
 * Test a command execution (asynchronously) that throws an HystrixException and didn't implement getFallback.
 */
@Test public void testQueueKnownFailureWithNoFallback(){
  TestHystrixCommand<Integer> command=getCommand(ExecutionIsolationStrategy.THREAD,AbstractTestHystrixCommand.ExecutionResult.HYSTRIX_FAILURE,AbstractTestHystrixCommand.FallbackResult.UNIMPLEMENTED);
  try {
    command.queue().get();
    fail("we shouldn't get here");
  }
 catch (  Exception e) {
    e.printStackTrace();
    if (e.getCause() instanceof HystrixRuntimeException) {
      HystrixRuntimeException de=(HystrixRuntimeException)e.getCause();
      assertNotNull(de.getFallbackException());
      assertNotNull(de.getImplementingClass());
    }
 else {
      fail("the cause should be HystrixRuntimeException");
    }
  }
  assertTrue(command.getExecutionTimeInMilliseconds() > -1);
  assertTrue(command.isFailedExecution());
  assertCommandExecutionEvents(command,HystrixEventType.FAILURE,HystrixEventType.FALLBACK_MISSING);
  assertNotNull(command.getExecutionException());
  assertEquals(0,command.getBuilder().metrics.getCurrentConcurrentExecutionCount());
  assertSaneHystrixRequestLog(1);
}
