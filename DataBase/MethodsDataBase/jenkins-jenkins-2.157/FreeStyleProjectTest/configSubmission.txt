/** 
 * Tests a trivial configuration round-trip. The goal is to catch a P1-level issue that prevents all the form submissions to fail.
 */
@Test public void configSubmission() throws Exception {
  FreeStyleProject project=j.createFreeStyleProject();
  Shell shell=new Shell("echo hello");
  project.getBuildersList().add(shell);
  WebClient webClient=j.createWebClient();
  HtmlPage page=webClient.getPage(project,"configure");
  HtmlForm form=page.getFormByName("config");
  j.submit(form);
  List<Builder> builders=project.getBuilders();
  assertEquals(1,builders.size());
  assertEquals(Shell.class,builders.get(0).getClass());
  assertEquals("echo hello",((Shell)builders.get(0)).getCommand().trim());
  assertTrue(builders.get(0) != shell);
}
