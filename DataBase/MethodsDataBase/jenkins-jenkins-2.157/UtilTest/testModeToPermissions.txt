@Test public void testModeToPermissions() throws Exception {
  assertEquals(PosixFilePermissions.fromString("rwxrwxrwx"),Util.modeToPermissions(0777));
  assertEquals(PosixFilePermissions.fromString("rwxr-xrwx"),Util.modeToPermissions(0757));
  assertEquals(PosixFilePermissions.fromString("rwxr-x---"),Util.modeToPermissions(0750));
  assertEquals(PosixFilePermissions.fromString("r-xr-x---"),Util.modeToPermissions(0550));
  assertEquals(PosixFilePermissions.fromString("r-xr-----"),Util.modeToPermissions(0540));
  assertEquals(PosixFilePermissions.fromString("--xr-----"),Util.modeToPermissions(0140));
  assertEquals(PosixFilePermissions.fromString("--xr---w-"),Util.modeToPermissions(0142));
  assertEquals(PosixFilePermissions.fromString("--xr--rw-"),Util.modeToPermissions(0146));
  assertEquals(PosixFilePermissions.fromString("-wxr--rw-"),Util.modeToPermissions(0346));
  assertEquals(PosixFilePermissions.fromString("---------"),Util.modeToPermissions(0000));
  assertEquals("Non-permission bits should be ignored",PosixFilePermissions.fromString("r-xr-----"),Util.modeToPermissions(0100540));
  expectedException.expectMessage(startsWith("Invalid mode"));
  Util.modeToPermissions(01777);
}
