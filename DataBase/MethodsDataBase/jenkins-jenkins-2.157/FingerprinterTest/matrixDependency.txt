@Test public void matrixDependency() throws Exception {
  MatrixProject matrixProject=j.jenkins.createProject(MatrixProject.class,"p");
  matrixProject.setAxes(new AxisList(new Axis("foo","a","b")));
  FreeStyleProject freestyleProject=createFreeStyleProjectWithFingerprints(singleContents,singleFiles);
  addFingerprinterToProject(matrixProject,singleContents,singleFiles);
  j.jenkins.rebuildDependencyGraph();
  j.buildAndAssertSuccess(matrixProject);
  j.buildAndAssertSuccess(freestyleProject);
  j.waitUntilNoActivity();
  j.jenkins.rebuildDependencyGraph();
  RunList<FreeStyleBuild> builds=freestyleProject.getBuilds();
  assertEquals("There should only be one FreestyleBuild",1,builds.size());
  FreeStyleBuild build=builds.iterator().next();
  assertEquals(Result.SUCCESS,build.getResult());
  List<AbstractProject> downstream=j.jenkins.getDependencyGraph().getDownstream(matrixProject);
  assertTrue(downstream.contains(freestyleProject));
  List<AbstractProject> upstream=j.jenkins.getDependencyGraph().getUpstream(freestyleProject);
  assertTrue(upstream.contains(matrixProject));
}
