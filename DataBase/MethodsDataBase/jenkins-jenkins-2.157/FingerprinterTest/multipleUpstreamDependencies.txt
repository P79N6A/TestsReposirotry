@Test public void multipleUpstreamDependencies() throws Exception {
  FreeStyleProject upstream=createFreeStyleProjectWithFingerprints(singleContents,singleFiles);
  FreeStyleProject upstream2=createFreeStyleProjectWithFingerprints(singleContents2,singleFiles2);
  FreeStyleProject downstream=createFreeStyleProjectWithFingerprints(doubleContents,doubleFiles);
  j.assertBuildStatusSuccess(upstream.scheduleBuild2(0).get());
  j.assertBuildStatusSuccess(upstream2.scheduleBuild2(0).get());
  j.assertBuildStatusSuccess(downstream.scheduleBuild2(0).get());
  j.jenkins.rebuildDependencyGraph();
  List<AbstractProject> downstreamProjects=upstream.getDownstreamProjects();
  List<AbstractProject> downstreamProjects2=upstream2.getDownstreamProjects();
  List<AbstractProject> upstreamProjects=downstream.getUpstreamProjects();
  assertEquals(1,downstreamProjects.size());
  assertEquals(1,downstreamProjects2.size());
  assertEquals(2,upstreamProjects.size());
  assertTrue(upstreamProjects.contains(upstream));
  assertTrue(upstreamProjects.contains(upstream2));
  assertTrue(downstreamProjects.contains(downstream));
}
