@Test @Issue("SECURITY-195") public void shouldNotEscapeJnlpSlavesResources() throws Exception {
  Slave slave=j.createSlave();
  assertJnlpJarUrlIsAllowed(slave,"agent.jar");
  assertJnlpJarUrlIsAllowed(slave,"slave.jar");
  assertJnlpJarUrlIsAllowed(slave,"remoting.jar");
  assertJnlpJarUrlIsAllowed(slave,"jenkins-cli.jar");
  assertJnlpJarUrlIsAllowed(slave,"hudson-cli.jar");
  assertJnlpJarUrlFails(slave,"web.xml");
  assertJnlpJarUrlFails(slave,"web.xml");
  assertJnlpJarUrlFails(slave,"classes/bundled-plugins.txt");
  assertJnlpJarUrlFails(slave,"classes/dependencies.txt");
  assertJnlpJarUrlFails(slave,"plugins/ant.hpi");
  assertJnlpJarUrlFails(slave,"nonexistentfolder/something.txt");
  assertJnlpJarUrlFails(slave,"../");
  assertJnlpJarUrlFails(slave,"..");
  assertJnlpJarUrlFails(slave,"..\\");
  assertJnlpJarUrlFails(slave,"../foo/bar");
  assertJnlpJarUrlFails(slave,"..\\foo\\bar");
  assertJnlpJarUrlFails(slave,"foo/../../bar");
  assertJnlpJarUrlFails(slave,"./../foo/bar");
}
