@Test @Issue("SECURITY-794") public void onlyAdminCanReachTheDoCheck() throws Exception {
  final String ADMIN="admin";
  final String USER="user";
  j.jenkins.setCrumbIssuer(null);
  j.jenkins.setSecurityRealm(j.createDummySecurityRealm());
  j.jenkins.setAuthorizationStrategy(new MockAuthorizationStrategy().grant(Jenkins.ADMINISTER).everywhere().to(ADMIN).grant(Jenkins.READ).everywhere().to(USER));
  User.getById(ADMIN,true);
  User.getById(USER,true);
  WebRequest request=new WebRequest(new URL(j.getURL() + "descriptorByName/hudson.tools.ZipExtractionInstaller/checkUrl"),HttpMethod.POST);
  request.setRequestBody(URLEncoder.encode("value=https://www.google.com",StandardCharsets.UTF_8.name()));
  JenkinsRule.WebClient adminWc=j.createWebClient();
  adminWc.login(ADMIN);
  assertEquals(200,adminWc.getPage(request).getWebResponse().getStatusCode());
  JenkinsRule.WebClient userWc=j.createWebClient();
  userWc.getOptions().setThrowExceptionOnFailingStatusCode(false);
  userWc.login(USER);
  assertEquals(403,userWc.getPage(request).getWebResponse().getStatusCode());
}
