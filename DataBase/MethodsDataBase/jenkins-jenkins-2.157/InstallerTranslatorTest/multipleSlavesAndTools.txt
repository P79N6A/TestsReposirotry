@Issue("JENKINS-17667") @Test public void multipleSlavesAndTools() throws Exception {
  String jdk1Path=Functions.isWindows() ? "C:\\jdk1" : "/opt/jdk1";
  String jdk2Path=Functions.isWindows() ? "C:\\jdk2" : "/opt/jdk2";
  Node slave1=r.createSlave();
  Node slave2=r.createSlave();
  JDK jdk1=new JDK("jdk1",null,Collections.singletonList(new InstallSourceProperty(Collections.singletonList(Functions.isWindows() ? new BatchCommandInstaller(null,"echo installed jdk1",jdk1Path) : new CommandInstaller(null,"echo installed jdk1",jdk1Path)))));
  JDK jdk2=new JDK("jdk2",null,Collections.singletonList(new InstallSourceProperty(Collections.singletonList(Functions.isWindows() ? new BatchCommandInstaller(null,"echo installed jdk2",jdk2Path) : new CommandInstaller(null,"echo installed jdk2",jdk2Path)))));
  r.jenkins.getJDKs().add(jdk1);
  r.jenkins.getJDKs().add(jdk2);
  FreeStyleProject p=r.createFreeStyleProject();
  p.setJDK(jdk1);
  p.getBuildersList().add(Functions.isWindows() ? new BatchFile("echo %JAVA_HOME%") : new Shell("echo $JAVA_HOME"));
  p.setAssignedNode(slave1);
  FreeStyleBuild b1=r.buildAndAssertSuccess(p);
  r.assertLogContains("installed jdk1",b1);
  r.assertLogContains(jdk1Path,b1);
  p.setJDK(jdk2);
  FreeStyleBuild b2=r.buildAndAssertSuccess(p);
  r.assertLogContains("installed jdk2",b2);
  r.assertLogContains(jdk2Path,b2);
  FreeStyleBuild b3=r.buildAndAssertSuccess(p);
  r.assertLogContains("installed jdk2",b3);
  r.assertLogContains(jdk2Path,b3);
  p.setAssignedNode(slave2);
  FreeStyleBuild b4=r.buildAndAssertSuccess(p);
  r.assertLogContains("installed jdk2",b4);
  r.assertLogContains(jdk2Path,b4);
  p.setJDK(jdk1);
  FreeStyleBuild b5=r.buildAndAssertSuccess(p);
  r.assertLogContains("installed jdk1",b5);
  r.assertLogContains(jdk1Path,b5);
  FreeStyleBuild b6=r.buildAndAssertSuccess(p);
  r.assertLogContains("installed jdk1",b6);
  r.assertLogContains(jdk1Path,b6);
}
