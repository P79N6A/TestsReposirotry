@Issue("JENKINS-23517") @Test public void offlineNodeForJDK() throws Exception {
  Node slave=new DumbSlave("disconnected-slave",null,"/wherever","1",Node.Mode.NORMAL,null,new JNLPLauncher(true),RetentionStrategy.NOOP,Collections.<NodeProperty<?>>emptyList());
  String globalDefaultLocation="/usr/lib/jdk";
  JDK jdk=new JDK("my-jdk",globalDefaultLocation,Collections.singletonList(new InstallSourceProperty(Collections.singletonList(new CommandInstaller(null,"irrelevant","/opt/jdk")))));
  r.jenkins.getJDKs().add(jdk);
  FreeStyleProject p=r.createFreeStyleProject();
  p.setJDK(jdk);
  StreamTaskListener listener=new StreamTaskListener(System.out,Charset.defaultCharset());
  String javaHomeProp="JAVA_HOME";
  assertEquals(globalDefaultLocation,p.getEnvironment(slave,listener).get(javaHomeProp));
  String slaveDefaultLocation="/System/JDK";
  slave.getNodeProperties().add(new ToolLocationNodeProperty(new ToolLocationNodeProperty.ToolLocation((ToolDescriptor)jdk.getDescriptor(),jdk.getName(),slaveDefaultLocation)));
  assertEquals(slaveDefaultLocation,p.getEnvironment(slave,listener).get(javaHomeProp));
}
