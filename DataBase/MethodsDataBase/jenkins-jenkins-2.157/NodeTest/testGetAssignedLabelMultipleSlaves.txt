/** 
 * Create two projects which have the same label and verify that both are accounted for when getting a count of the jobs tied to the current label.
 */
@Issue("JENKINS-26391") @Test public void testGetAssignedLabelMultipleSlaves() throws Exception {
  final Node node1=j.createOnlineSlave();
  node1.setLabelString("label1");
  final Node node2=j.createOnlineSlave();
  node1.setLabelString("label1");
  MavenModuleSet project=j.jenkins.createProject(MavenModuleSet.class,"p1");
  final Label label=j.jenkins.getLabel("label1");
  project.setAssignedLabel(label);
  j.assertBuildStatus(Result.FAILURE,project.scheduleBuild2(0).get());
  MavenModuleSet project2=j.jenkins.createProject(MavenModuleSet.class,"p2");
  project2.setAssignedLabel(label);
  j.assertBuildStatus(Result.FAILURE,project2.scheduleBuild2(0).get());
  label.reset();
  assertEquals("Two jobs should be tied to this label.",2,label.getTiedJobCount());
}
