/** 
 * Verify that when a label is removed from a job that the tied job count does not include the removed job.
 */
@Issue("JENKINS-26391") @Test public void testGetAssignedLabelWhenLabelRemoveFromProject() throws Exception {
  final Node node=j.createOnlineSlave();
  node.setLabelString("label1");
  MavenModuleSet project=j.jenkins.createProject(MavenModuleSet.class,"p");
  final Label label=j.jenkins.getLabel("label1");
  project.setAssignedLabel(label);
  j.assertBuildStatus(Result.FAILURE,project.scheduleBuild2(0).get());
  project.setAssignedLabel(null);
  label.reset();
  assertEquals("Label1 should have no tied jobs after the job label was removed.",0,label.getTiedJobCount());
}
