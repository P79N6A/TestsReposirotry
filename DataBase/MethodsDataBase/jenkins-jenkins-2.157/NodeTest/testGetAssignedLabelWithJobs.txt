/** 
 * Verify that the Label#getTiedJobCount does not perform a lazy loading operation.
 */
@Issue("JENKINS-26391") @Test public void testGetAssignedLabelWithJobs() throws Exception {
  final Node node=j.createOnlineSlave();
  node.setLabelString("label1 label2");
  MavenModuleSet mavenProject=j.jenkins.createProject(MavenModuleSet.class,"p");
  mavenProject.setAssignedLabel(j.jenkins.getLabel("label1"));
  RunLoadCounter.prepare(mavenProject);
  j.assertBuildStatus(Result.FAILURE,mavenProject.scheduleBuild2(0).get());
  Integer labelCount=RunLoadCounter.assertMaxLoads(mavenProject,0,new Callable<Integer>(){
    @Override public Integer call() throws Exception {
      final Label label=j.jenkins.getLabel("label1");
      label.reset();
      return label.getTiedJobCount();
    }
  }
);
  assertEquals("Should have only one job tied to label.",1,labelCount.intValue());
}
