@Test public void newInstallation(){
  rr.then(r -> {
    List<DetachedPlugin> detachedPlugins=ClassicPluginStrategy.getDetachedPlugins();
    assertThat("Detached plugins should exist",detachedPlugins,not(empty()));
    assertThat("Detached plugins should not be installed on a new instance",getInstalledDetachedPlugins(r,detachedPlugins),empty());
    assertNoFailedPlugins(r);
  }
);
  rr.then(r -> {
    List<DetachedPlugin> detachedPlugins=ClassicPluginStrategy.getDetachedPlugins();
    assertThat("Detached plugins should exist",detachedPlugins,not(empty()));
    assertThat("Detached plugins should not be installed after restarting",getInstalledDetachedPlugins(r,detachedPlugins),empty());
    assertNoFailedPlugins(r);
  }
);
}
