@Issue("JENKINS-48899") @Test @LocalData public void upgradeFromJenkins2WithNewerPlugin(){
  VersionNumber since=new VersionNumber("2.0");
  rr.then(r -> {
    List<DetachedPlugin> detachedPlugins=ClassicPluginStrategy.getDetachedPlugins(since);
    assertThat("Plugins have been detached since the pre-upgrade version",detachedPlugins.size(),greaterThan(1));
    assertThat("Plugins detached between the pre-upgrade version and the current version should be installed",getInstalledDetachedPlugins(r,detachedPlugins).size(),equalTo(detachedPlugins.size()));
    Plugin commandLauncher=r.jenkins.getPlugin("command-launcher");
    assertThat("Installed detached plugins should not be overwritten by older versions",commandLauncher.getWrapper().getVersionNumber(),equalTo(new VersionNumber("1.2")));
    assertNoFailedPlugins(r);
  }
);
}
