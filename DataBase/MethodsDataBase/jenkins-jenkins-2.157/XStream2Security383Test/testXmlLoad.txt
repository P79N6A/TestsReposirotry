@Test @Issue("SECURITY-383") public void testXmlLoad() throws Exception {
  File exploitFile=f.newFile();
  try {
    if (exploitFile.exists() && !exploitFile.delete()) {
      throw new IllegalStateException("file exists and cannot be deleted");
    }
    File tempJobDir=new File(j.jenkins.getRootDir(),"security383");
    String exploitXml=IOUtils.toString(XStream2Security383Test.class.getResourceAsStream("/hudson/util/XStream2Security383Test/config.xml"),"UTF-8");
    exploitXml=exploitXml.replace("@TOKEN@",exploitFile.getAbsolutePath());
    FileUtils.write(new File(tempJobDir,"config.xml"),exploitXml);
    try {
      Items.load(j.jenkins,tempJobDir);
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
    assertFalse("no file should be created here",exploitFile.exists());
  }
  finally {
    exploitFile.delete();
  }
}
