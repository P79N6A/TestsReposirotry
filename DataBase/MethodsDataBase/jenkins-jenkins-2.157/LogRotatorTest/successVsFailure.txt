@Test public void successVsFailure() throws Exception {
  FreeStyleProject project=j.createFreeStyleProject();
  project.setLogRotator(new LogRotator(-1,2,-1,-1));
  assertEquals(Result.SUCCESS,build(project));
  project.getBuildersList().replaceBy(Collections.singleton(new FailureBuilder()));
  assertEquals(Result.FAILURE,build(project));
  assertEquals(Result.FAILURE,build(project));
  assertEquals(1,numberOf(project.getLastSuccessfulBuild()));
  project.getBuildersList().replaceBy(Collections.<Builder>emptySet());
  assertEquals(Result.SUCCESS,build(project));
  assertEquals(4,numberOf(project.getLastSuccessfulBuild()));
  assertEquals(null,project.getBuildByNumber(1));
  assertEquals(null,project.getBuildByNumber(2));
  assertEquals(3,numberOf(project.getLastFailedBuild()));
}
