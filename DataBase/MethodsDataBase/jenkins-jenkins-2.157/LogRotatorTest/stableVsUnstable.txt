@Test @Issue("JENKINS-2417") public void stableVsUnstable() throws Exception {
  FreeStyleProject project=j.createFreeStyleProject();
  project.setLogRotator(new LogRotator(-1,2,-1,-1));
  assertEquals(Result.SUCCESS,build(project));
  project.getPublishersList().replaceBy(Collections.singleton(new TestsFail()));
  assertEquals(Result.UNSTABLE,build(project));
  assertEquals(Result.UNSTABLE,build(project));
  assertEquals(1,numberOf(project.getLastStableBuild()));
  project.getPublishersList().replaceBy(Collections.<Publisher>emptySet());
  assertEquals(Result.SUCCESS,build(project));
  assertEquals(null,project.getBuildByNumber(1));
  assertEquals(null,project.getBuildByNumber(2));
}
