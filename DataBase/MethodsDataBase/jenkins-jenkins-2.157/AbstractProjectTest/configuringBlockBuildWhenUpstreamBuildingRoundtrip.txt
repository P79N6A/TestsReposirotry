/** 
 * Tests round trip configuration of the blockBuildWhenUpstreamBuilding field
 */
@Test @Issue("JENKINS-4423") public void configuringBlockBuildWhenUpstreamBuildingRoundtrip() throws Exception {
  FreeStyleProject p=j.createFreeStyleProject();
  p.setBlockBuildWhenUpstreamBuilding(false);
  HtmlForm form=j.createWebClient().getPage(p,"configure").getFormByName("config");
  HtmlInput input=form.getInputByName("blockBuildWhenUpstreamBuilding");
  assertFalse("blockBuildWhenUpstreamBuilding check box is checked.",input.isChecked());
  input.setChecked(true);
  j.submit(form);
  assertTrue("blockBuildWhenUpstreamBuilding was not updated from configuration form",p.blockBuildWhenUpstreamBuilding());
  form=j.createWebClient().getPage(p,"configure").getFormByName("config");
  input=form.getInputByName("blockBuildWhenUpstreamBuilding");
  assert input.isChecked() : "blockBuildWhenUpstreamBuilding check box is not checked.";
}
