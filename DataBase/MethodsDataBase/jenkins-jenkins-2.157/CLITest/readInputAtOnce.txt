@Ignore("TODO sometimes fails, in CI & locally") @Test @Issue("JENKINS-54310") public void readInputAtOnce() throws Exception {
  home=tempHome();
  grabCliJar();
  try (ByteArrayOutputStream baos=new ByteArrayOutputStream()){
    int ret=new Launcher.LocalLauncher(StreamTaskListener.fromStderr()).launch().cmds("java","-Duser.home=" + home,"-jar",jar.getAbsolutePath(),"-s",r.getURL().toString(),"list-plugins").stdout(baos).stderr(baos).stdin(CLITest.class.getResourceAsStream("huge-stdin.txt")).join();
    assertThat(baos.toString(),not(containsString("java.io.IOException: Stream is closed")));
    assertEquals(0,ret);
  }
 }
