@Issue("JENKINS-10675") @Test public void useForwardedProtoWhenPresent(){
  configured("https://ci/jenkins/");
  accessing("http://ci/jenkins/");
  rootUrlFromRequestIs("http://ci/jenkins/");
  accessing("http://ci:8080/jenkins/");
  rootUrlFromRequestIs("http://ci:8080/jenkins/");
  accessing("https://ci/jenkins/");
  withHeader("X-Forwarded-Proto","https");
  rootUrlFromRequestIs("https://ci/jenkins/");
  accessing("http://ci/jenkins/");
  withHeader("X-Forwarded-Proto","http");
  rootUrlFromRequestIs("http://ci/jenkins/");
  accessing("http://ci/jenkins/");
  withHeader("X-Forwarded-Port","443");
  withHeader("X-Forwarded-Proto","https");
  rootUrlFromRequestIs("https://ci/jenkins/");
}
