@LocalData @Test public void configDotXmlPermission() throws Exception {
  ApiTokenTestHelper.enableLegacyBehavior();
  j.jenkins.setCrumbIssuer(null);
  JenkinsRule.WebClient wc=j.createWebClient();
  boolean saveEnabled=Item.EXTENDED_READ.getEnabled();
  Item.EXTENDED_READ.setEnabled(true);
  try {
    wc.assertFails("job/testJob/config.xml",HttpURLConnection.HTTP_FORBIDDEN);
    wc.withBasicApiToken(User.getById("alice",true));
    tryConfigDotXml(wc,500,"Both perms; should get 500");
    wc.withBasicApiToken(User.getById("bob",true));
    tryConfigDotXml(wc,500,"Config perm should imply EXTENDED_READ");
    wc.withBasicApiToken(User.getById("charlie",true));
    tryConfigDotXml(wc,403,"No permission, should get 403");
  }
  finally {
    Item.EXTENDED_READ.setEnabled(saveEnabled);
  }
}
