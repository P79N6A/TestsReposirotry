@Issue("JENKINS-16023") @Test public void getLastFailedBuild() throws Exception {
  final FreeStyleProject p=j.createFreeStyleProject();
  RunLoadCounter.prepare(p);
  p.getBuildersList().add(new FailureBuilder());
  j.assertBuildStatus(Result.FAILURE,p.scheduleBuild2(0).get());
  j.assertBuildStatus(Result.FAILURE,p.scheduleBuild2(0).get());
  j.assertBuildStatus(Result.FAILURE,p.scheduleBuild2(0).get());
  p.getBuildersList().remove(FailureBuilder.class);
  j.assertBuildStatusSuccess(p.scheduleBuild2(0));
  j.assertBuildStatusSuccess(p.scheduleBuild2(0));
  j.assertBuildStatusSuccess(p.scheduleBuild2(0));
  assertEquals(6,p.getLastSuccessfulBuild().getNumber());
  assertEquals(3,RunLoadCounter.assertMaxLoads(p,1,new Callable<Integer>(){
    @Override public Integer call() throws Exception {
      return p.getLastFailedBuild().getNumber();
    }
  }
).intValue());
}
