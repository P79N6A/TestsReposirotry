/** 
 * Makes sure that plugins can see Maven2 plugin that's refactored out in 1.296.
 */
@WithPlugin("tasks.jpi") @Test public void optionalMavenDependency() throws Exception {
  PluginWrapper.Dependency m2=null;
  PluginWrapper tasks=r.jenkins.getPluginManager().getPlugin("tasks");
  for (  PluginWrapper.Dependency d : tasks.getOptionalDependencies()) {
    if (d.shortName.equals("maven-plugin")) {
      assertNull(m2);
      m2=d;
    }
  }
  assertNotNull(m2);
  tasks.classLoader.loadClass(hudson.maven.agent.AbortException.class.getName());
}
