@Test public void disconnectNodeShouldSucceedWithCause() throws Exception {
  DumbSlave slave=j.createSlave("aNode","",null);
  slave.toComputer().waitUntilOnline();
  assertThat(slave.toComputer().isOnline(),equalTo(true));
  assertThat(slave.toComputer().getOfflineCause(),equalTo(null));
  CLICommandInvoker.Result result=command.authorizedTo(Computer.DISCONNECT,Jenkins.READ).invokeWithArgs("aNode","-m","aCause");
  assertThat(result,succeededSilently());
  assertThat(slave.toComputer().isOffline(),equalTo(true));
  assertThat(slave.toComputer().getOfflineCause(),instanceOf(OfflineCause.ByCLI.class));
  assertThat(((OfflineCause.ByCLI)slave.toComputer().getOfflineCause()).message,equalTo("aCause"));
  slave.toComputer().connect(true);
  slave.toComputer().waitUntilOnline();
  assertThat(slave.toComputer().isOnline(),equalTo(true));
  assertThat(slave.toComputer().getOfflineCause(),equalTo(null));
  result=command.authorizedTo(Computer.DISCONNECT,Jenkins.READ).invokeWithArgs("aNode","-m","anotherCause");
  assertThat(result,succeededSilently());
  assertThat(slave.toComputer().isOffline(),equalTo(true));
  assertThat(slave.toComputer().getOfflineCause(),instanceOf(OfflineCause.ByCLI.class));
  assertThat(((OfflineCause.ByCLI)slave.toComputer().getOfflineCause()).message,equalTo("anotherCause"));
  result=command.authorizedTo(Computer.DISCONNECT,Jenkins.READ).invokeWithArgs("aNode","-m","yetAnotherCause");
  assertThat(result,succeededSilently());
  assertThat(slave.toComputer().isOffline(),equalTo(true));
  assertThat(slave.toComputer().getOfflineCause(),instanceOf(OfflineCause.ByCLI.class));
  assertThat(((OfflineCause.ByCLI)slave.toComputer().getOfflineCause()).message,equalTo("yetAnotherCause"));
}
