/** 
 * Multicast based clients should be able to receive multiple replies.
 */
@Test public void multicast() throws Exception {
  UDPBroadcastThread second=new UDPBroadcastThread(j.jenkins);
  second.start();
  UDPBroadcastThread third=new UDPBroadcastThread(j.jenkins);
  third.start();
  second.ready.block();
  third.ready.block();
  try {
    DatagramSocket s=new DatagramSocket();
    sendQueryTo(s,UDPBroadcastThread.MULTICAST);
    s.setSoTimeout(15000);
    try {
      receiveAndVerify(s);
      receiveAndVerify(s);
    }
 catch (    SocketTimeoutException x) {
      Assume.assumeFalse(UDPBroadcastThread.udpHandlingProblem);
      throw x;
    }
  }
  finally {
    third.interrupt();
    second.interrupt();
  }
}
