@Issue({"JENKINS-6598","JENKINS-38514"}) @Test public void takeBlockedByProperty() throws Exception {
  r.jenkins.setNumExecutors(0);
  Slave slave=r.createSlave();
  FreeStyleProject project=r.createFreeStyleProject();
  Future<FreeStyleBuild> build=project.scheduleBuild2(0);
  r.assertBuildStatus(Result.SUCCESS,build.get(20,TimeUnit.SECONDS));
  slave.getNodeProperties().add(new RejectAllTasksProperty());
  build=project.scheduleBuild2(0);
  try {
    build.get(10,TimeUnit.SECONDS);
    fail("Expected timeout exception");
  }
 catch (  TimeoutException e) {
    List<BuildableItem> buildables=r.jenkins.getQueue().getBuildableItems();
    assertNotNull(buildables);
    assertEquals(1,buildables.size());
    BuildableItem item=buildables.get(0);
    assertEquals(project,item.task);
    assertNotNull(item.getCauseOfBlockage());
    assertEquals("rejecting everything",item.getCauseOfBlockage().getShortDescription());
  }
}
