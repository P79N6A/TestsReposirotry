@Issue({"SECURITY-131","SECURITY-155","SECURITY-705"}) @Test public void doDynamic() throws Exception {
  ((TestPluginManager)r.jenkins.pluginManager).installDetachedPlugin("credentials");
  r.createWebClient().goTo("plugin/credentials/images/24x24/credentials.png","image/png");
  r.createWebClient().goTo("plugin/credentials/images/../images/24x24/credentials.png","image/png");
  r.createWebClient().assertFails("plugin/credentials/images/%2E%2E/images/24x24/credentials.png",HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
  r.createWebClient().assertFails("plugin/credentials/images/%252E%252E/images/24x24/credentials.png",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/images/%25252E%25252E/images/24x24/credentials.png",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/images/..%2fWEB-INF/licenses.xml",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/./credentials.jpi",HttpServletResponse.SC_NOT_FOUND);
  r.createWebClient().assertFails("plugin/credentials/images/%2e%2e%2fWEB-INF/licenses.xml",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/images/%2e.%2fWEB-INF/licenses.xml",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/images/..%2f..%2f..%2f" + r.jenkins.getRootDir().getName() + "%2fsecrets%2fmaster.key",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/" + r.jenkins.getRootDir() + "/secrets/master.key",HttpServletResponse.SC_NOT_FOUND);
  r.createWebClient().assertFails("plugin/credentials/WEB-INF/licenses.xml",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/META-INF/MANIFEST.MF",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/web-inf/licenses.xml",HttpServletResponse.SC_BAD_REQUEST);
  r.createWebClient().assertFails("plugin/credentials/meta-inf/manifest.mf",HttpServletResponse.SC_BAD_REQUEST);
}
