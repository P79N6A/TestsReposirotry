/** 
 * Job is restricted. Label is on slave that can be started in cloud. Job is submitted to queue, which spawns an on demand slave.
 * @throws Exception 
 */
@Test public void testRestrictedLabelOnSlaveYesQueue() throws Exception {
  FreeStyleProject proj=j.createFreeStyleProject("JENKINS-21394-yesqueue");
  RequiresWorkspaceSCM requiresWorkspaceScm=new RequiresWorkspaceSCM(true);
  proj.setScm(requiresWorkspaceScm);
  j.jenkins.setNumExecutors(0);
  DummyCloudImpl2 c2=new DummyCloudImpl2(j,0);
  c2.label=new LabelAtom("test-cloud-label");
  j.jenkins.clouds.add(c2);
  proj.setAssignedLabel(c2.label);
  SCMTrigger t=new SCMTrigger("@daily",true);
  t.start(proj,true);
  proj.addTrigger(t);
  t.new Runner().run();
  Thread.sleep(1000);
  assertEquals(1,j.jenkins.getQueue().getItems().length);
}
