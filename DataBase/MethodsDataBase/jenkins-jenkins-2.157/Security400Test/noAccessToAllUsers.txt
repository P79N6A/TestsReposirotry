@Test @Issue("SECURITY-722") public void noAccessToAllUsers() throws Exception {
  j.jenkins.setCrumbIssuer(null);
  HudsonPrivateSecurityRealm securityRealm=new HudsonPrivateSecurityRealm(false,false,null);
  j.jenkins.setSecurityRealm(securityRealm);
  securityRealm.createAccount("admin","admin");
  j.jenkins.setAuthorizationStrategy(new MockAuthorizationStrategy().grant(Jenkins.ADMINISTER).everywhere().to("admin"));
{
    JenkinsRule.WebClient wc=j.createWebClient();
    wc.getOptions().setThrowExceptionOnFailingStatusCode(false);
    Page page=wc.goTo("securityRealm/allUsers/" + 0 + "/descriptorByName/jenkins.security.ApiTokenProperty/help/apiToken/");
    assertEquals(404,page.getWebResponse().getStatusCode());
    assertRequestWasBlockedAndResetFlag();
  }
{
    JenkinsRule.WebClient wc=j.createWebClient();
    wc.login("admin");
    wc.getOptions().setThrowExceptionOnFailingStatusCode(false);
    Page page=wc.goTo("securityRealm/allUsers/" + 0 + "/descriptorByName/jenkins.security.ApiTokenProperty/help/apiToken/");
    assertEquals(404,page.getWebResponse().getStatusCode());
    assertRequestWasBlockedAndResetFlag();
  }
}
