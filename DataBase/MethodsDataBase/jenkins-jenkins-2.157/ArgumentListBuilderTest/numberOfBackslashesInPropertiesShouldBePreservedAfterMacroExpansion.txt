@Test public void numberOfBackslashesInPropertiesShouldBePreservedAfterMacroExpansion() throws IOException {
  final Map<String,String> map=new HashMap<String,String>();
  map.put("ONE","one\\backslash");
  map.put("TWO","two\\\\backslashes");
  map.put("FOUR","four\\\\\\\\backslashes");
  final String properties=new StringBuilder().append("one=$ONE\n").append("two=$TWO\n").append("four=$FOUR\n").toString();
  final String args=new ArgumentListBuilder().addKeyValuePairsFromPropertyString("",properties,new VariableResolver.ByMap<String>(map)).toString();
  assertThat(args,containsString("one=one\\backslash"));
  assertThat(args,containsString("two=two\\\\backslashes"));
  assertThat(args,containsString("four=four\\\\\\\\backslashes"));
}
