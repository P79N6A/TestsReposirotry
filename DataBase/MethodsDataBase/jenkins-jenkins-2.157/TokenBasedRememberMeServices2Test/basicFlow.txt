@Test public void basicFlow() throws Exception {
  j.jenkins.setSecurityRealm(new StupidRealm());
  JenkinsRule.WebClient wc=j.createWebClient();
  wc.login("bob","bob",true);
  Cookie c=getRememberMeCookie(wc);
  assertNotNull(c);
  wc=j.createWebClient();
  wc.getCookieManager().addCookie(c);
  wc.goTo("");
  assertTrue(failureInduced);
  wc.executeOnServer(() -> {
    Authentication a=Jenkins.getAuthentication();
    assertEquals("bob",a.getName());
    assertEquals(ImmutableList.of("authenticated","myteam"),Arrays.asList(a.getAuthorities()).stream().map(GrantedAuthority::getAuthority).collect(Collectors.toList()));
    return null;
  }
);
}
