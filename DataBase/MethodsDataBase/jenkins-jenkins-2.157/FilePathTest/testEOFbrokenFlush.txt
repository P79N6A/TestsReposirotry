@Issue("JENKINS-10629") @Test public void testEOFbrokenFlush() throws IOException, InterruptedException {
  final File srcFolder=temp.newFolder("src");
  final File smallTar=new File(srcFolder,"small.tar");
  givenSomeContentInFile(smallTar,1537);
  final File dir=new File(srcFolder,"dir");
  dir.mkdirs();
  final File pomFile=new File(dir,"pom.xml");
  givenSomeContentInFile(pomFile,2049);
  FileUtils.copyFileToDirectory(pomFile,srcFolder);
  final File archive=temp.newFile("archive.tar");
  final FilePath tmpDirPath=new FilePath(srcFolder);
  int tarred=tmpDirPath.tar(Files.newOutputStream(archive.toPath()),"**");
  assertEquals("One file should have been compressed",3,tarred);
  final File dstFolder=temp.newFolder("dst");
  dstFolder.mkdirs();
  FilePath outDir=new FilePath(dstFolder);
  tmpDirPath.child("../" + archive.getName()).untar(outDir,TarCompression.NONE);
}
