@Test public void testImpersonateAndCurrent(){
  j.jenkins.setSecurityRealm(j.createDummySecurityRealm());
  User user=User.get("John Smith");
  assertNotSame("User John Smith should not be the current user.",User.current().getId(),user.getId());
  SecurityContextHolder.getContext().setAuthentication(user.impersonate());
  assertEquals("User John Smith should be the current user.",user.getId(),User.current().getId());
}
