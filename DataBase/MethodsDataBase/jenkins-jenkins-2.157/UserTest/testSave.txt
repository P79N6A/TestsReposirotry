@Test public void testSave() throws Exception {
{
    User user=User.get("John Smith",true,Collections.emptyMap());
  }
  j.jenkins.reload();
{
    User user=User.get("John Smith",false,Collections.emptyMap());
    assertNull("User should be null.",user);
    user=User.get("John Smithl",true,Collections.emptyMap());
    user.addProperty(new SomeUserProperty());
    user.save();
  }
  j.jenkins.reload();
{
    User user=User.get("John Smithl",false,Collections.emptyMap());
    assertNotNull("User should not be null.",user);
    assertNotNull("User should be saved with all changes.",user.getProperty(SomeUserProperty.class));
  }
}
