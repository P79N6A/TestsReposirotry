@Test public void disconnect() throws Exception {
  CLICommandInvoker command=new CLICommandInvoker(j,"disconnect-node");
  Slave slave=j.createOnlineSlave();
  assertTrue(slave.toComputer().isOnline());
  Result result=command.authorizedTo(Jenkins.READ,Computer.DISCONNECT).invokeWithArgs(slave.getNodeName(),"-m","Custom cause message");
  assertThat(result,succeededSilently());
  assertTrue(slave.toComputer().isOffline());
  UserCause cause=(UserCause)slave.toComputer().getOfflineCause();
  assertThat(cause.toString(),endsWith("Custom cause message"));
  assertThat(cause.getUser(),equalTo(command.user()));
}
