@Ignore("TODO fails unless CLICommand.main patched to replace (auth==Jenkins.ANONYMOUS) with (auth instanceof AnonymousAuthenticationToken), not just (Jenkins.ANONYMOUS.equals(auth)), since SecurityFilters.groovy sets userAttribute='anonymous,' so UserAttributeEditor.setAsText configures AnonymousProcessingFilter with a token with an empty authority which fails AbstractAuthenticationToken.equals") @Test public void overHttp() throws Exception {
  File jar=tmp.newFile("jenkins-cli.jar");
  FileUtils.copyURLToFile(r.jenkins.getJnlpJars("jenkins-cli.jar").getURL(),jar);
  r.jenkins.setSecurityRealm(r.createDummySecurityRealm());
  r.jenkins.setAuthorizationStrategy(new FullControlOnceLoggedInAuthorizationStrategy());
  r.jenkins.setSlaveAgentPort(-1);
  assertCLI(0,"Authenticated as: anonymous",jar,"who-am-i");
  assertCLI(0,null,jar,"login","--username","admin","--password","admin");
  try {
    assertCLI(0,"Authenticated as: admin",jar,"who-am-i");
  }
  finally {
    assertCLI(0,null,jar,"logout");
  }
}
