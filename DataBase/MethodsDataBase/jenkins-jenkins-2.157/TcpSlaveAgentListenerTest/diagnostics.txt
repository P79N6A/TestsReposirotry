@Test public void diagnostics() throws Exception {
  r.getInstance().setSlaveAgentPort(0);
  int p=r.jenkins.getTcpSlaveAgentListener().getPort();
  WebClient wc=r.createWebClient();
  TextPage text=(TextPage)wc.getPage("http://localhost:" + p + "/");
  String c=text.getContent();
  assertThat(c,containsString(Jenkins.VERSION));
  try {
    wc.getPage("http://localhost:" + p + "/xxx");
    fail("Expected 404");
  }
 catch (  FailingHttpStatusCodeException e) {
    assertThat(e.getStatusCode(),equalTo(404));
  }
}
