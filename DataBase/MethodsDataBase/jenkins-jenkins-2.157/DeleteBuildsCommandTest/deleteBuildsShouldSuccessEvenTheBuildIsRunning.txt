@Test public void deleteBuildsShouldSuccessEvenTheBuildIsRunning() throws Exception {
  assumeFalse("You can't delete files that are in use on Windows",Functions.isWindows());
  FreeStyleProject project=j.createFreeStyleProject("aProject");
  ExecutorTest.startBlockingBuild(project);
  assertThat(((FreeStyleProject)j.jenkins.getItem("aProject")).getBuilds(),hasSize(1));
  final CLICommandInvoker.Result result=command.authorizedTo(Jenkins.READ,Job.READ,Run.DELETE).invokeWithArgs("aProject","1");
  assertThat(result,succeeded());
  assertThat(result.stdout(),containsString("Deleted 1 builds"));
  assertThat(((FreeStyleProject)j.jenkins.getItem("aProject")).getBuilds(),hasSize(0));
  assertThat(project.isBuilding(),equalTo(false));
}
