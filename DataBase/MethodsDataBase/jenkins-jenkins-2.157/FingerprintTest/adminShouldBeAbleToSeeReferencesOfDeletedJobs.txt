@Test public void adminShouldBeAbleToSeeReferencesOfDeletedJobs() throws Exception {
  final FreeStyleProject project=createAndRunProjectWithPublisher("project","test.txt");
  final FreeStyleBuild build=project.getLastBuild();
  final Fingerprint fingerprint=getFingerprint(build,"test.txt");
  User user1=User.get("user1");
  setupProjectMatrixAuthStrategy(Jenkins.ADMINISTER);
  project.delete();
  try (ACLContext acl=ACL.as(user1)){
    Fingerprint.BuildPtr original=fingerprint.getOriginal();
    assertThat("user1 should able to see the origin",fingerprint.getOriginal(),notNullValue());
    assertThat("Job has been deleted, so Job reference should return null",fingerprint.getOriginal().getJob(),nullValue());
    assertEquals("user1 sees the wrong original name with Item.DISCOVER",project.getFullName(),original.getName());
    assertEquals("user1 sees the wrong original number with Item.DISCOVER",build.getNumber(),original.getNumber());
    assertEquals("user1 should be able to see the job in usages",1,fingerprint._getUsages().size());
  }
 }
