/** 
 * We don't allow prohibited fullnames since this may encumber auditing.
 */
@Issue("SECURITY-166") @Test public void fullNameOfUnknownCantSignup() throws Exception {
  HudsonPrivateSecurityRealm securityRealm=new HudsonPrivateSecurityRealm(true,false,null);
  j.jenkins.setSecurityRealm(securityRealm);
  JenkinsRule.WebClient wc=j.createWebClient();
  SignupPage signup=new SignupPage(wc.goTo("signup"));
  signup.enterUsername("unknown2");
  signup.enterPassword("unknown2");
  signup.enterFullName("unknown");
  signup.enterEmail("noone@nowhere.com");
  signup=new SignupPage(signup.submit(j));
  signup.assertErrorContains("prohibited as a full name");
  assertNull(User.get("unknown2",false,Collections.emptyMap()));
}
