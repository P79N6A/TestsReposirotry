@Issue("SECURITY-786") @Test public void controlCharacterAreNoMoreValid() throws Exception {
  HudsonPrivateSecurityRealm securityRealm=new HudsonPrivateSecurityRealm(true,false,null);
  j.jenkins.setSecurityRealm(securityRealm);
  String password="testPwd";
  String email="test@test.com";
  int i=0;
  checkUserCanBeCreatedWith(securityRealm,"test" + i,password,"Test" + i,email);
  assertNotNull(User.getById("test" + i,false));
  i++;
  checkUserCanBeCreatedWith(securityRealm,"te-st_123" + i,password,"Test" + i,email);
  assertNotNull(User.getById("te-st_123" + i,false));
  i++;
{
    checkUserCannotBeCreatedWith(securityRealm,"test " + i,password,"Test" + i,email);
    i++;
    checkUserCannotBeCreatedWith(securityRealm,"te@st" + i,password,"Test" + i,email);
    i++;
    checkUserCannotBeCreatedWith(securityRealm,"test.com" + i,password,"Test" + i,email);
    i++;
    checkUserCannotBeCreatedWith(securityRealm,"test,com" + i,password,"Test" + i,email);
    i++;
    checkUserCannotBeCreatedWith(securityRealm,"test,com" + i,password,"Test" + i,email);
    i++;
    checkUserCannotBeCreatedWith(securityRealm,"testécom" + i,password,"Test" + i,email);
    i++;
    checkUserCannotBeCreatedWith(securityRealm,"Stargåte" + i,password,"Test" + i,email);
    i++;
    checkUserCannotBeCreatedWith(securityRealm,"te\u0000st" + i,password,"Test" + i,email);
    i++;
  }
}
