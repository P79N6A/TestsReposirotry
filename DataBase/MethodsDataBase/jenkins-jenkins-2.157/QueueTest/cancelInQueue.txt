@Test public void cancelInQueue() throws Exception {
  DumbSlave slave=r.createOnlineSlave();
  assertFalse(slave.toComputer().isOffline());
  slave.toComputer().disconnect(null).get();
  assertTrue(slave.toComputer().isOffline());
  FreeStyleProject p=r.createFreeStyleProject();
  p.setAssignedNode(slave);
  QueueTaskFuture<FreeStyleBuild> f=p.scheduleBuild2(0);
  try {
    f.get(3,TimeUnit.SECONDS);
    fail("Should time out (as the slave is offline).");
  }
 catch (  TimeoutException e) {
  }
  Queue.Item item=Queue.getInstance().getItem(p);
  assertNotNull(item);
  Queue.getInstance().doCancelItem(item.getId());
  assertNull(Queue.getInstance().getItem(p));
  try {
    f.get(10,TimeUnit.SECONDS);
    fail("Should not get (as it is cancelled).");
  }
 catch (  CancellationException e) {
  }
}
