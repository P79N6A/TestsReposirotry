/** 
 * Can  {@link Queue} successfully recover removal?
 */
@Test public void persistence2() throws Exception {
  Queue q=r.jenkins.getQueue();
  resetQueueState();
  assertEquals(0,Queue.WaitingItem.getCurrentCounterValue());
  r.jenkins.setNumExecutors(0);
  FreeStyleProject testProject=r.createFreeStyleProject("test");
  testProject.scheduleBuild(new UserIdCause());
  q.save();
  System.out.println(FileUtils.readFileToString(new File(r.jenkins.getRootDir(),"queue.xml")));
  assertEquals(1,q.getItems().length);
  q.clear();
  assertEquals(0,q.getItems().length);
  testProject.delete();
  q.load();
  assertEquals(0,q.getItems().length);
  assertEquals(1,Queue.WaitingItem.getCurrentCounterValue());
}
