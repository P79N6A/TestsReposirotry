/** 
 * Checks the persistence of queue.
 */
@Test public void persistence() throws Exception {
  Queue q=r.jenkins.getQueue();
  r.jenkins.setNumExecutors(0);
  FreeStyleProject testProject=r.createFreeStyleProject("test");
  testProject.scheduleBuild(new UserIdCause());
  q.save();
  System.out.println(FileUtils.readFileToString(new File(r.jenkins.getRootDir(),"queue.xml")));
  assertEquals(1,q.getItems().length);
  q.clear();
  assertEquals(0,q.getItems().length);
  q.load();
  assertEquals(1,q.getItems().length);
  assertSame(q.getItems()[0].task,testProject);
}
