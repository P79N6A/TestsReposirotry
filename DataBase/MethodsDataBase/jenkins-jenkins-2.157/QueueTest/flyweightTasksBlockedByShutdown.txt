@Issue("JENKINS-10944") @Test public void flyweightTasksBlockedByShutdown() throws Exception {
  r.jenkins.doQuietDown(true,0);
  AtomicInteger cnt=new AtomicInteger();
  TestFlyweightTask task=new TestFlyweightTask(cnt,null);
  assertTrue(Queue.isBlockedByShutdown(task));
  r.jenkins.getQueue().schedule2(task,0);
  r.jenkins.getQueue().maintain();
  r.jenkins.doCancelQuietDown();
  assertFalse(Queue.isBlockedByShutdown(task));
  r.waitUntilNoActivity();
  assertEquals(1,cnt.get());
  assert task.exec instanceof OneOffExecutor : task.exec;
}
