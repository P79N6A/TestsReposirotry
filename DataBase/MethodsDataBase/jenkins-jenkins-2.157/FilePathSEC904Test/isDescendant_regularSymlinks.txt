@Test @Issue("SECURITY-904") public void isDescendant_regularSymlinks() throws IOException, InterruptedException {
  FilePath rootFolder=new FilePath(temp.newFolder("root"));
  FilePath workspaceFolder=rootFolder.child("workspace");
  FilePath aFolder=workspaceFolder.child("a");
  FilePath bFolder=workspaceFolder.child("b");
  FilePath protectedFolder=rootFolder.child("protected");
  FilePath regularFile=workspaceFolder.child("regular.txt");
  regularFile.write("regular-file",StandardCharsets.UTF_8.name());
  FilePath aFile=aFolder.child("a.txt");
  aFile.write("a-file",StandardCharsets.UTF_8.name());
  FilePath bFile=bFolder.child("a.txt");
  bFile.write("b-file",StandardCharsets.UTF_8.name());
  bFolder.child("_a").symlinkTo("../a",null);
  bFolder.child("_atxt").symlinkTo("../a/a.txt",null);
  workspaceFolder.child("_protected").symlinkTo("../protected",null);
  workspaceFolder.child("_nonexistent").symlinkTo("nonexistent",null);
  workspaceFolder.child("_nonexistentUp").symlinkTo("../nonexistent",null);
  workspaceFolder.child("_secrettxt").symlinkTo("../protected/secret.txt",null);
  FilePath secretFile=protectedFolder.child("secret.txt");
  secretFile.write("secrets",StandardCharsets.UTF_8.name());
  assertTrue(workspaceFolder.isDescendant("regular.txt"));
  assertTrue(workspaceFolder.isDescendant("_nonexistent"));
  assertTrue(workspaceFolder.isDescendant("a"));
  assertTrue(workspaceFolder.isDescendant("a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("a/../a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("b/../a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("b"));
  assertTrue(workspaceFolder.isDescendant("./b"));
  assertTrue(workspaceFolder.isDescendant("b/_a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("b/_a/../a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("b/_atxt"));
  assertFalse(workspaceFolder.isDescendant("_nonexistentUp"));
  assertFalse(workspaceFolder.isDescendant("_protected"));
  assertFalse(workspaceFolder.isDescendant("_protected/"));
  assertFalse(workspaceFolder.isDescendant("_protected/secret.txt"));
  assertFalse(workspaceFolder.isDescendant("./_protected/secret.txt"));
  assertFalse(workspaceFolder.isDescendant("_secrettxt"));
  assertFalse(workspaceFolder.isDescendant("./_secrettxt"));
}
