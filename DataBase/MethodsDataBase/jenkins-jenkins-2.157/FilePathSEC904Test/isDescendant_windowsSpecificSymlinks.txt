@Test @Issue("SECURITY-904") public void isDescendant_windowsSpecificSymlinks() throws Exception {
  assumeTrue(Functions.isWindows());
  File root=temp.newFolder("root");
  FilePath rootFolder=new FilePath(root);
  FilePath workspaceFolder=rootFolder.child("workspace");
  FilePath aFolder=workspaceFolder.child("a");
  FilePath bFolder=workspaceFolder.child("b");
  FilePath protectedFolder=rootFolder.child("protected");
  FilePath regularFile=workspaceFolder.child("regular.txt");
  regularFile.write("regular-file",StandardCharsets.UTF_8.name());
  FilePath aFile=aFolder.child("a.txt");
  aFile.write("a-file",StandardCharsets.UTF_8.name());
  FilePath bFile=bFolder.child("a.txt");
  bFile.write("b-file",StandardCharsets.UTF_8.name());
  createJunction(new File(root,"/workspace/b/_a"),new File(root,"/workspace/a"));
  createJunction(new File(root,"/workspace/_nonexistent"),new File(root,"/workspace/nonexistent"));
  createJunction(new File(root,"/workspace/_nonexistentUp"),new File(root,"/nonexistent"));
  createJunction(new File(root,"/workspace/_protected"),new File(root,"/protected"));
  FilePath secretFile=protectedFolder.child("secret.txt");
  secretFile.write("secrets",StandardCharsets.UTF_8.name());
  assertTrue(workspaceFolder.isDescendant("b"));
  assertTrue(workspaceFolder.isDescendant("b/_a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("b\\_a\\a.txt"));
  assertTrue(workspaceFolder.isDescendant("b\\_a\\../a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("b\\_a\\..\\a\\a.txt"));
  assertTrue(workspaceFolder.isDescendant(".\\b\\_a\\..\\a\\a.txt"));
  assertTrue(workspaceFolder.isDescendant("b/_a/../a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("./b/_a/../a/a.txt"));
  assertTrue(workspaceFolder.isDescendant("_nonexistent"));
  assertTrue(workspaceFolder.isDescendant("_nonexistent/"));
  assertTrue(workspaceFolder.isDescendant("_nonexistent/.."));
  assertTrue(workspaceFolder.isDescendant("_nonexistentUp"));
  assertFalse(workspaceFolder.isDescendant("_protected"));
  assertFalse(workspaceFolder.isDescendant("_protected/../a"));
}
