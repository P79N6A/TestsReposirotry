@Test public void sleepWorksTest() throws Exception {
  final int SUCCESSFUL_ATTEMPT=2;
  final String ACTION="print";
  final int SLEEP=500;
  RingBufferLogHandler handler=new RingBufferLogHandler(20);
  Logger retrierLogger=Logger.getLogger(Retrier.class.getName());
  Level currentLogLevel=retrierLogger.getLevel();
  retrierLogger.setLevel(Level.FINE);
  retrierLogger.addHandler(handler);
  Retrier<Boolean> r=new Retrier.Builder<>(() -> {
    LOG.info("action performed");
    return true;
  }
,(currentAttempt,result) -> currentAttempt == SUCCESSFUL_ATTEMPT,ACTION).withAttempts(SUCCESSFUL_ATTEMPT).withDelay(SLEEP).build();
  Instant start=Instant.now();
  Boolean finalResult=r.start();
  Instant finish=Instant.now();
  long timeElapsed=Duration.between(start,finish).toMillis();
  Assert.assertTrue(timeElapsed >= SLEEP);
  Assert.assertTrue(finalResult == null ? false : finalResult);
  String text=Messages.Retrier_Sleeping(SLEEP,ACTION);
  assertTrue(String.format("The log should contain '%s'",text),handler.getView().stream().anyMatch(m -> m.getMessage().contains(text)));
  retrierLogger.setLevel(currentLogLevel);
}
