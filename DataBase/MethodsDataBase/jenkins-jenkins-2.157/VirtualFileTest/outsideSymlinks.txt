@Issue("SECURITY-162") @Test public void outsideSymlinks() throws Exception {
  assumeFalse("Symlinks don't work well on Windows",Functions.isWindows());
  File ws=tmp.newFolder("ws");
  FileUtils.write(new File(ws,"safe"),"safe");
  Util.createSymlink(ws,"safe","supported",TaskListener.NULL);
  File other=tmp.newFolder("other");
  FileUtils.write(new File(other,"secret"),"s3cr3t");
  Util.createSymlink(ws,"../other/secret","hack",TaskListener.NULL);
  VirtualFile root=VirtualFile.forFile(ws);
  VirtualFile supported=root.child("supported");
  assertTrue(supported.isFile());
  assertTrue(supported.exists());
  assertEquals("safe",IOUtils.toString(supported.open(),(String)null));
  VirtualFile hack=root.child("hack");
  assertFalse(hack.isFile());
  assertFalse(hack.exists());
  try {
    hack.open();
    fail();
  }
 catch (  FileNotFoundException|NoSuchFileException x) {
  }
}
