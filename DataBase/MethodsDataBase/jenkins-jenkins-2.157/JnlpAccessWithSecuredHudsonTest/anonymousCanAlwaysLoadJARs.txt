@PresetData(DataSet.NO_ANONYMOUS_READACCESS) @Email("http://markmail.org/message/on4wkjdaldwi2atx") @Test public void anonymousCanAlwaysLoadJARs() throws Exception {
  ApiTokenTestHelper.enableLegacyBehavior();
  r.jenkins.setNodes(Collections.singletonList(createNewJnlpSlave("test")));
  JenkinsRule.WebClient wc=r.createWebClient();
  HtmlPage p=wc.withBasicApiToken(User.getById("alice",true)).goTo("computer/test/");
  JenkinsRule.WebClient jnlpAgent=r.createWebClient();
  XmlPage jnlp=(XmlPage)wc.goTo("computer/test/slave-agent.jnlp","application/x-java-jnlp-file");
  URL baseUrl=jnlp.getUrl();
  Document dom=new DOMReader().read(jnlp.getXmlDocument());
  for (  Element jar : (List<Element>)dom.selectNodes("//jar")) {
    URL url=new URL(baseUrl,jar.attributeValue("href"));
    System.out.println(url);
    Page jarResource=jnlpAgent.getPage(url);
    assertTrue(jarResource.getWebResponse().getContentType().toLowerCase(Locale.ENGLISH).startsWith("application/"));
  }
}
