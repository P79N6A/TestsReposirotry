@Test @Issue("SECURITY-170") public void nonParameterizedJobButWhitelisted() throws Exception {
  FreeStyleProject p=j.createFreeStyleProject();
  try {
    System.setProperty(ParametersAction.SAFE_PARAMETERS_SYSTEM_PROPERTY_NAME,"foo,bar");
    FreeStyleBuild build2=j.assertBuildStatusSuccess(p.scheduleBuild2(0,new Cause.UserIdCause(),new ParametersAction(new StringParameterValue("foo","baz"),new StringParameterValue("bar","bar"))));
    assertTrue("foo parameter is listed in getParameters",hasParameterWithName(build2.getAction(ParametersAction.class),"foo"));
    assertTrue("bar parameter is listed in getParameters",hasParameterWithName(build2.getAction(ParametersAction.class),"bar"));
  }
  finally {
    System.clearProperty(ParametersAction.SAFE_PARAMETERS_SYSTEM_PROPERTY_NAME);
  }
}
