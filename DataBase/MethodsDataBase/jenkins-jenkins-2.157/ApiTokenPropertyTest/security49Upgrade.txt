@Test public void security49Upgrade() throws Exception {
  j.jenkins.setSecurityRealm(j.createDummySecurityRealm());
  User u=User.get("foo");
  String historicalInitialValue=Util.getDigestOf(Jenkins.getInstance().getSecretKey() + ":" + u.getId());
  ApiTokenProperty t=new ApiTokenProperty(historicalInitialValue);
  u.addProperty(t);
  String apiToken1=t.getApiToken();
  assertNotEquals(apiToken1,Util.getDigestOf(historicalInitialValue));
  ApiTokenProperty t2=new ApiTokenProperty(historicalInitialValue);
  u.addProperty(t2);
  assertEquals(apiToken1,t2.getApiToken());
  t=new ApiTokenProperty(historicalInitialValue + "somethingElse");
  u.addProperty(t);
  assertEquals(t.getApiToken(),Util.getDigestOf(historicalInitialValue + "somethingElse"));
}
