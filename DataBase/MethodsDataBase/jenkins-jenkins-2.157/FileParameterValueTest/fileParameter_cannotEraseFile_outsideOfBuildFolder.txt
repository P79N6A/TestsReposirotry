@Test @Issue("SECURITY-1074") public void fileParameter_cannotEraseFile_outsideOfBuildFolder() throws Exception {
  FilePath root=j.jenkins.getRootPath();
  FreeStyleProject p=j.createFreeStyleProject();
  p.addProperty(new ParametersDefinitionProperty(Collections.singletonList(new FileParameterDefinition("../../../../../root-level.txt",null))));
  assertThat(root.child("root-level.txt").exists(),equalTo(false));
  String initialContent="do-not-erase-me";
  root.child("root-level.txt").write(initialContent,StandardCharsets.UTF_8.name());
  String uploadedContent="test-content";
  File uploadedFile=tmp.newFile();
  FileUtils.write(uploadedFile,uploadedContent);
  FreeStyleBuild build=p.scheduleBuild2(0,new Cause.UserIdCause(),new ParametersAction(new FileParameterValue("../../../../../root-level.txt",uploadedFile,"uploaded-file.txt"))).get();
  assertThat(build.getResult(),equalTo(Result.FAILURE));
  assertThat(root.child("root-level.txt").readToString(),equalTo(initialContent));
  JenkinsRule.WebClient wc=j.createWebClient();
  wc.getOptions().setThrowExceptionOnFailingStatusCode(false);
  checkUrlNot200AndNotContains(wc,build.getUrl() + "parameters/parameter/..%2F..%2F..%2F..%2F..%2Froot-level.txt/uploaded-file.txt",uploadedContent);
}
