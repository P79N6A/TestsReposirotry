@Test @Issue("SECURITY-1074") public void fileParameter_cannotCreateFile_outsideOfBuildFolder_backslashEdition() throws Exception {
  Assume.assumeTrue("Backslash are only dangerous on Windows",Functions.isWindows());
  FilePath root=j.jenkins.getRootPath();
  FreeStyleProject p=j.createFreeStyleProject();
  p.addProperty(new ParametersDefinitionProperty(Collections.singletonList(new FileParameterDefinition("..\\..\\..\\..\\..\\root-level.txt",null))));
  assertThat(root.child("root-level.txt").exists(),equalTo(false));
  String uploadedContent="test-content";
  File uploadedFile=tmp.newFile();
  FileUtils.write(uploadedFile,uploadedContent);
  FreeStyleBuild build=p.scheduleBuild2(0,new Cause.UserIdCause(),new ParametersAction(new FileParameterValue("..\\..\\..\\..\\..\\root-level.txt",uploadedFile,"uploaded-file.txt"))).get();
  assertThat(build.getResult(),equalTo(Result.FAILURE));
  assertThat(root.child("root-level.txt").exists(),equalTo(false));
  JenkinsRule.WebClient wc=j.createWebClient();
  wc.getOptions().setThrowExceptionOnFailingStatusCode(false);
  checkUrlNot200AndNotContains(wc,build.getUrl() + "parameters/parameter/..\\..\\..\\..\\..\\root-level.txt/uploaded-file.txt",uploadedContent);
  checkUrlNot200AndNotContains(wc,build.getUrl() + "parameters/parameter/..%2F..%2F..%2F..%2F..%2Froot-level.txt/uploaded-file.txt",uploadedContent);
}
