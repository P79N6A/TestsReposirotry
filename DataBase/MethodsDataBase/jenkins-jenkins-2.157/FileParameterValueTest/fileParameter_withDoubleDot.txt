@Test @Issue("SECURITY-1074") public void fileParameter_withDoubleDot() throws Exception {
  FreeStyleProject p=j.createFreeStyleProject();
  p.addProperty(new ParametersDefinitionProperty(Collections.singletonList(new FileParameterDefinition("..",null))));
  String uploadedContent="test-content";
  File uploadedFile=tmp.newFile();
  FileUtils.write(uploadedFile,uploadedContent);
  FreeStyleBuild build=p.scheduleBuild2(0,new Cause.UserIdCause(),new ParametersAction(new FileParameterValue("..",uploadedFile,"uploaded-file.txt"))).get();
  assertThat(build.getResult(),equalTo(Result.FAILURE));
  JenkinsRule.WebClient wc=j.createWebClient();
  wc.getOptions().setThrowExceptionOnFailingStatusCode(false);
  checkUrlNot200AndNotContains(wc,build.getUrl() + "parameters/uploaded-file.txt",uploadedContent);
  checkUrlNot200AndNotContains(wc,build.getUrl() + "parameters/parameter/../uploaded-file.txt",uploadedContent);
}
