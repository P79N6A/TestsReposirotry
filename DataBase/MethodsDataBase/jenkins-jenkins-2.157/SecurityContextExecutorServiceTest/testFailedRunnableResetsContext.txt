@Test @PresetData(PresetData.DataSet.NO_ANONYMOUS_READACCESS) public void testFailedRunnableResetsContext() throws Exception {
  Runnable r=new Runnable(){
    public void run(){
      SecurityContextHolder.setContext(nullContext);
      throw new RuntimeException("Simulate a failure");
    }
  }
;
  SecurityContextHolder.setContext(systemContext);
  try {
    wrappedService.execute(r);
  }
 catch (  AssertionError expectedException) {
    assertEquals(systemContext,SecurityContextHolder.getContext());
  }
  SecurityContextHolder.setContext(userContext);
  try {
    wrappedService.execute(r);
  }
 catch (  AssertionError expectedException) {
    assertEquals(userContext,SecurityContextHolder.getContext());
  }
}
