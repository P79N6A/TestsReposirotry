@Test public void relativeURLs() throws Exception {
  PersistedList<UpdateSite> sites=j.jenkins.getUpdateCenter().getSites();
  sites.clear();
  URL url=new URL(baseUrl,"/plugins/tasks-update-center.json");
  UpdateSite site=new UpdateSite(UpdateCenter.ID_DEFAULT,url.toString());
  sites.add(site);
  assertEquals(FormValidation.ok(),site.updateDirectly(false).get());
  Data data=site.getData();
  assertNotNull(data);
  assertEquals(new URL(url,"jenkins.war").toString(),data.core.url);
  assertEquals(new HashSet<String>(Arrays.asList("tasks","dummy")),data.plugins.keySet());
  assertEquals(new URL(url,"tasks.jpi").toString(),data.plugins.get("tasks").url);
  assertEquals("http://nowhere.net/dummy.hpi",data.plugins.get("dummy").url);
  UpdateSite.Plugin tasksPlugin=data.plugins.get("tasks");
  assertEquals("Wrong name of plugin found","Task Scanner Plug-in",tasksPlugin.getDisplayName());
}
