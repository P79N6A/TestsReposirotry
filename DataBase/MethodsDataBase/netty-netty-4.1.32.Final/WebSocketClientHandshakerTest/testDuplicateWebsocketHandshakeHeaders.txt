@Test public void testDuplicateWebsocketHandshakeHeaders(){
  URI uri=URI.create("ws://localhost:9999/foo");
  HttpHeaders inputHeaders=new DefaultHttpHeaders();
  String bogusSubProtocol="bogusSubProtocol";
  String bogusHeaderValue="bogusHeaderValue";
  for (  CharSequence header : getHandshakeHeaderNames()) {
    inputHeaders.add(header,bogusHeaderValue);
  }
  inputHeaders.add(getProtocolHeaderName(),bogusSubProtocol);
  String realSubProtocol="realSubProtocol";
  WebSocketClientHandshaker handshaker=newHandshaker(uri,realSubProtocol,inputHeaders);
  FullHttpRequest request=handshaker.newHandshakeRequest();
  HttpHeaders outputHeaders=request.headers();
  for (  CharSequence header : getHandshakeHeaderNames()) {
    assertEquals(1,outputHeaders.getAll(header).size());
    assertNotEquals(bogusHeaderValue,outputHeaders.get(header));
  }
  assertEquals(1,outputHeaders.getAll(getProtocolHeaderName()).size());
  assertEquals(realSubProtocol,outputHeaders.get(getProtocolHeaderName()));
  request.release();
}
