@Test public void testLineProtocol(){
  EmbeddedChannel ch=new EmbeddedChannel(new LineDecoder());
  ch.writeInbound(Unpooled.wrappedBuffer(new byte[]{'A'}));
  assertNull(ch.readInbound());
  ch.writeInbound(Unpooled.wrappedBuffer(new byte[]{'B'}));
  assertNull(ch.readInbound());
  ch.writeInbound(Unpooled.wrappedBuffer(new byte[]{'C'}));
  assertNull(ch.readInbound());
  ch.writeInbound(Unpooled.wrappedBuffer(new byte[]{'\n'}));
  ByteBuf buf=Unpooled.wrappedBuffer(new byte[]{'A','B','C'});
  ByteBuf buf2=ch.readInbound();
  assertEquals(buf,buf2);
  buf.release();
  buf2.release();
  ch.writeInbound(Unpooled.wrappedBuffer(new byte[]{'A'}));
  assertNull(ch.readInbound());
  ch.finish();
  assertNull(ch.readInbound());
}
