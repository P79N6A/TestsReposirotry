@Test public void testSingleDecode() throws Exception {
  LineDecoder decoder=new LineDecoder();
  decoder.setSingleDecode(true);
  EmbeddedChannel ch=new EmbeddedChannel(decoder);
  ch.writeInbound(Unpooled.wrappedBuffer(new byte[]{'C','\n','B','\n'}));
  ByteBuf buf=Unpooled.wrappedBuffer(new byte[]{'C'});
  ByteBuf buf2=ch.readInbound();
  assertEquals(buf,buf2);
  buf.release();
  buf2.release();
  assertNull("Must be null as it must only decode one frame",ch.readInbound());
  ch.read();
  ch.finish();
  buf=Unpooled.wrappedBuffer(new byte[]{'B'});
  buf2=ch.readInbound();
  assertEquals(buf,buf2);
  buf.release();
  buf2.release();
  assertNull(ch.readInbound());
}
