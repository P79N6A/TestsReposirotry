@Test public void dataWriteToClosedStreamShouldFail() throws Exception {
  createStream(STREAM_ID,false).close();
  ByteBuf data=mock(ByteBuf.class);
  ChannelPromise promise=newPromise();
  encoder.writeData(ctx,STREAM_ID,data,0,false,promise);
  assertTrue(promise.isDone());
  assertFalse(promise.isSuccess());
  assertThat(promise.cause(),instanceOf(IllegalArgumentException.class));
  verify(data).release();
}
