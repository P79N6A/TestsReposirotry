@Test public void rstStreamShouldCloseStream() throws Exception {
  writeAllFlowControlledFrames();
  encoder.writeHeaders(ctx,STREAM_ID,EmptyHttp2Headers.INSTANCE,0,true,newPromise());
  stream(STREAM_ID);
  ChannelPromise promise=newPromise();
  encoder.writeRstStream(ctx,STREAM_ID,PROTOCOL_ERROR.code(),promise);
  verify(lifecycleManager).resetStream(eq(ctx),eq(STREAM_ID),anyLong(),eq(promise));
}
