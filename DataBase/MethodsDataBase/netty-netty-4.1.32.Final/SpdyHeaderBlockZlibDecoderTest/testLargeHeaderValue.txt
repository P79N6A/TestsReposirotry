@Test public void testLargeHeaderValue() throws Exception {
  ByteBuf headerBlock=Unpooled.buffer(8220);
  headerBlock.writeBytes(zlibHeader);
  headerBlock.writeByte(0);
  headerBlock.writeByte(0x0c);
  headerBlock.writeByte(0x20);
  headerBlock.writeByte(0xf3);
  headerBlock.writeByte(0xdf);
  headerBlock.writeInt(1);
  headerBlock.writeInt(1);
  headerBlock.writeByte('n');
  headerBlock.writeInt(8191);
  for (int i=0; i < 8191; i++) {
    headerBlock.writeByte('v');
  }
  headerBlock.writeBytes(zlibSyncFlush);
  decoder.decode(ByteBufAllocator.DEFAULT,headerBlock,frame);
  decoder.endHeaderBlock(frame);
  assertFalse(headerBlock.isReadable());
  assertFalse(frame.isInvalid());
  assertFalse(frame.isTruncated());
  assertEquals(1,frame.headers().names().size());
  assertEquals(8191,frame.headers().get("n").length());
  headerBlock.release();
}
