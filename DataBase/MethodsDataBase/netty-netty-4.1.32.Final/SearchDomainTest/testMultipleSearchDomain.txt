@Test public void testMultipleSearchDomain() throws Exception {
  Set<String> domains=new HashSet<String>();
  domains.add("host1.foo.com");
  domains.add("host2.bar.com");
  domains.add("host3.bar.com");
  domains.add("host3.foo.com");
  TestDnsServer.MapRecordStoreA store=new TestDnsServer.MapRecordStoreA(domains);
  dnsServer=new TestDnsServer(store);
  dnsServer.start();
  resolver=newResolver().searchDomains(Arrays.asList("foo.com","bar.com")).build();
  String resolved=assertResolve(resolver,"host1");
  assertEquals(store.getAddress("host1.foo.com"),resolved);
  resolved=assertResolve(resolver,"host2");
  assertEquals(store.getAddress("host2.bar.com"),resolved);
  resolved=assertResolve(resolver,"host3");
  assertEquals(store.getAddress("host3.foo.com"),resolved);
  assertNotResolve(resolver,"host4");
}
