@Test public void testUnresolvedReplacedByResolved() throws Exception {
  InetSocketAddress unresolved=InetSocketAddress.createUnresolved("ns1",53);
  InetSocketAddress resolved1=new InetSocketAddress(InetAddress.getByAddress("ns2",new byte[]{10,0,0,2}),53);
  InetSocketAddress resolved2=new InetSocketAddress(InetAddress.getByAddress("ns1",new byte[]{10,0,0,1}),53);
  EventLoopGroup group=new DefaultEventLoopGroup(1);
  try {
    EventLoop loop=group.next();
    final DefaultAuthoritativeDnsServerCache cache=new DefaultAuthoritativeDnsServerCache();
    cache.cache("netty.io",unresolved,100,loop);
    cache.cache("netty.io",resolved1,10000,loop);
    DnsServerAddressStream entries=cache.get("netty.io");
    assertEquals(2,entries.size());
    assertEquals(unresolved,entries.next());
    assertEquals(resolved1,entries.next());
    cache.cache("netty.io",resolved2,100,loop);
    DnsServerAddressStream entries2=cache.get("netty.io");
    assertEquals(2,entries2.size());
    assertEquals(resolved2,entries2.next());
    assertEquals(resolved1,entries2.next());
  }
  finally {
    group.shutdownGracefully();
  }
}
