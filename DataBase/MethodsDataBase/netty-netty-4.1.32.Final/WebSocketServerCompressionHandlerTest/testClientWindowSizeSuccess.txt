@Test public void testClientWindowSizeSuccess(){
  EmbeddedChannel ch=new EmbeddedChannel(new WebSocketServerExtensionHandler(new PerMessageDeflateServerExtensionHandshaker(6,false,10,false,false)));
  HttpRequest req=newUpgradeRequest(PERMESSAGE_DEFLATE_EXTENSION + "; " + CLIENT_MAX_WINDOW);
  ch.writeInbound(req);
  HttpResponse res=newUpgradeResponse(null);
  ch.writeOutbound(res);
  HttpResponse res2=ch.readOutbound();
  List<WebSocketExtensionData> exts=WebSocketExtensionUtil.extractExtensions(res2.headers().get(HttpHeaderNames.SEC_WEBSOCKET_EXTENSIONS));
  Assert.assertEquals(PERMESSAGE_DEFLATE_EXTENSION,exts.get(0).name());
  Assert.assertEquals("10",exts.get(0).parameters().get(CLIENT_MAX_WINDOW));
  Assert.assertNotNull(ch.pipeline().get(PerMessageDeflateDecoder.class));
  Assert.assertNotNull(ch.pipeline().get(PerMessageDeflateEncoder.class));
}
