@Test public void testForEachByteAbort(){
  buffer.clear();
  for (int i=0; i < CAPACITY; i++) {
    buffer.writeByte(i + 1);
  }
  final int stop=CAPACITY / 2;
  assertThat(buffer.forEachByte(CAPACITY / 3,CAPACITY / 3,new ByteProcessor(){
    int i=CAPACITY / 3;
    @Override public boolean process(    byte value) throws Exception {
      assertThat(value,is((byte)(i + 1)));
      if (i == stop) {
        return false;
      }
      i++;
      return true;
    }
  }
),is(stop));
}
