@Test(timeout=5000) public void testGracefulShutdownTimeout() throws Exception {
  loopA.shutdownGracefully(2,2,TimeUnit.SECONDS);
  for (int i=0; i < 10; i++) {
    Thread.sleep(100);
    loopA.execute(NOOP);
  }
  try {
    for (int i=0; i < 20; i++) {
      Thread.sleep(100);
      loopA.execute(NOOP);
    }
    fail("shutdownGracefully() must reject a task after timeout.");
  }
 catch (  RejectedExecutionException e) {
  }
  assertThat(loopA.isShuttingDown(),is(true));
  assertThat(loopA.isShutdown(),is(true));
}
