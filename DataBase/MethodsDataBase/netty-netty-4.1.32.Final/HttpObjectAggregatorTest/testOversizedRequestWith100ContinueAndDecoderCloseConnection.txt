@Test public void testOversizedRequestWith100ContinueAndDecoderCloseConnection(){
  EmbeddedChannel embedder=new EmbeddedChannel(new HttpRequestDecoder(),new HttpObjectAggregator(4,true));
  embedder.writeInbound(Unpooled.copiedBuffer("PUT /upload HTTP/1.1\r\n" + "Expect: 100-continue\r\n" + "Content-Length: 100\r\n\r\n",CharsetUtil.US_ASCII));
  assertNull(embedder.readInbound());
  FullHttpResponse response=embedder.readOutbound();
  assertEquals(HttpResponseStatus.REQUEST_ENTITY_TOO_LARGE,response.status());
  assertEquals("0",response.headers().get(HttpHeaderNames.CONTENT_LENGTH));
  assertFalse(embedder.isOpen());
  assertFalse(embedder.finish());
}
