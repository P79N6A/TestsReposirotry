@Test(timeout=10000) public void testConnectDeadLock() throws Exception {
  final Bootstrap bootstrapA=new Bootstrap();
  bootstrapA.group(groupA);
  bootstrapA.channel(LocalChannel.class);
  bootstrapA.handler(dummyHandler);
  final Bootstrap bootstrapB=new Bootstrap();
  bootstrapB.group(groupB);
  bootstrapB.channel(LocalChannel.class);
  bootstrapB.handler(dummyHandler);
  List<Future<?>> bindFutures=new ArrayList<Future<?>>();
  for (int i=0; i < 1024; i++) {
    bindFutures.add(groupA.next().submit(new Runnable(){
      @Override public void run(){
        bootstrapB.connect(LocalAddress.ANY);
      }
    }
));
    bindFutures.add(groupB.next().submit(new Runnable(){
      @Override public void run(){
        bootstrapA.connect(LocalAddress.ANY);
      }
    }
));
  }
  for (  Future<?> f : bindFutures) {
    f.sync();
  }
}
