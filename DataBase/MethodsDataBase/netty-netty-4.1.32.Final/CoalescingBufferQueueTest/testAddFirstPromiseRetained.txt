@Test public void testAddFirstPromiseRetained(){
  writeQueue.add(cat,catPromise);
  assertQueueSize(3,false);
  writeQueue.add(mouse,mouseListener);
  assertQueueSize(8,false);
  ChannelPromise aggregatePromise=newPromise();
  assertEquals("catmous",dequeue(7,aggregatePromise));
  ByteBuf remainder=Unpooled.wrappedBuffer("mous".getBytes(CharsetUtil.US_ASCII));
  writeQueue.addFirst(remainder,aggregatePromise);
  ChannelPromise aggregatePromise2=newPromise();
  assertEquals("mouse",dequeue(5,aggregatePromise2));
  aggregatePromise2.setSuccess();
  assertTrue(catPromise.isSuccess());
  assertTrue(mouseSuccess);
  assertEquals(0,cat.refCnt());
  assertEquals(0,mouse.refCnt());
}
