@Test public void testSNIMatchersWithSNINameWithUnderscore() throws Exception {
  assumeTrue(PlatformDependent.javaVersion() >= 8);
  byte[] name="rb8hx3pww30y3tvw0mwy.v1_1".getBytes(CharsetUtil.UTF_8);
  SelfSignedCertificate ssc=new SelfSignedCertificate();
  serverSslCtx=SslContextBuilder.forServer(ssc.certificate(),ssc.privateKey()).sslProvider(sslServerProvider()).protocols(protocols()).ciphers(ciphers()).build();
  SSLEngine engine=wrapEngine(serverSslCtx.newEngine(UnpooledByteBufAllocator.DEFAULT));
  try {
    SSLParameters parameters=new SSLParameters();
    Java8SslTestUtils.setSNIMatcher(parameters,name);
    engine.setSSLParameters(parameters);
    assertTrue(unwrapEngine(engine).checkSniHostnameMatch(name));
    assertFalse(unwrapEngine(engine).checkSniHostnameMatch("other".getBytes(CharsetUtil.UTF_8)));
  }
  finally {
    cleanupServerSslEngine(engine);
    ssc.delete();
  }
}
