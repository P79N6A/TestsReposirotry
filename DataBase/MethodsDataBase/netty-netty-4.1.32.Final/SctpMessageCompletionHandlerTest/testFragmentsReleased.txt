@Test public void testFragmentsReleased(){
  EmbeddedChannel channel=new EmbeddedChannel(new SctpMessageCompletionHandler());
  ByteBuf buffer=Unpooled.wrappedBuffer(new byte[]{1,2,3,4});
  ByteBuf buffer2=Unpooled.wrappedBuffer(new byte[]{1,2,3,4});
  SctpMessage message=new SctpMessage(new TestMessageInfo(false,1),buffer);
  assertFalse(channel.writeInbound(message));
  assertEquals(1,buffer.refCnt());
  SctpMessage message2=new SctpMessage(new TestMessageInfo(false,2),buffer2);
  assertFalse(channel.writeInbound(message2));
  assertEquals(1,buffer2.refCnt());
  assertFalse(channel.finish());
  assertEquals(0,buffer.refCnt());
  assertEquals(0,buffer2.refCnt());
}
