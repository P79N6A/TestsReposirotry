@Test public void testPrependAdjustedLength() throws Exception {
  final EmbeddedChannel ch=new EmbeddedChannel(new LengthFieldPrepender(4,-1));
  ch.writeOutbound(msg);
  ByteBuf buf=ch.readOutbound();
  assertEquals(4,buf.readableBytes());
  assertEquals(msg.readableBytes() - 1,buf.readInt());
  buf.release();
  buf=ch.readOutbound();
  assertSame(buf,msg);
  buf.release();
}
