@Test public void testPrependLengthInLittleEndian() throws Exception {
  final EmbeddedChannel ch=new EmbeddedChannel(new LengthFieldPrepender(ByteOrder.LITTLE_ENDIAN,4,0,false));
  ch.writeOutbound(msg);
  ByteBuf buf=ch.readOutbound();
  assertEquals(4,buf.readableBytes());
  byte[] writtenBytes=new byte[buf.readableBytes()];
  buf.getBytes(0,writtenBytes);
  assertEquals(1,writtenBytes[0]);
  assertEquals(0,writtenBytes[1]);
  assertEquals(0,writtenBytes[2]);
  assertEquals(0,writtenBytes[3]);
  buf.release();
  buf=ch.readOutbound();
  assertSame(buf,msg);
  buf.release();
  assertFalse("The channel must have been completely read",ch.finish());
}
