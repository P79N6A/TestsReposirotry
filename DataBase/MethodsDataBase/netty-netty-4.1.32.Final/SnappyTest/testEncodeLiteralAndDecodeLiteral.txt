@Test public void testEncodeLiteralAndDecodeLiteral(){
  int[] lengths={0x11,0x100,0x1000,0x100000,0x1000001};
  for (  int len : lengths) {
    ByteBuf in=Unpooled.wrappedBuffer(new byte[len]);
    ByteBuf encoded=Unpooled.buffer(10);
    ByteBuf decoded=Unpooled.buffer(10);
    ByteBuf expected=Unpooled.wrappedBuffer(new byte[len]);
    try {
      encodeLiteral(in,encoded,len);
      byte tag=encoded.readByte();
      decodeLiteral(tag,encoded,decoded);
      assertEquals("Encoded or decoded literal was incorrect",expected,decoded);
    }
  finally {
      in.release();
      encoded.release();
      decoded.release();
      expected.release();
    }
  }
}
