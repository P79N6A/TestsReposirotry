@Test public void testLarge2ByteLiteralLengthAndCopyOffset(){
  ByteBuf compressed=Unpooled.buffer();
  ByteBuf actualDecompressed=Unpooled.buffer();
  ByteBuf expectedDecompressed=Unpooled.buffer().writeByte(0x01).writeZero(0x8000).writeByte(0x01);
  try {
    compressed.writeByte(0x82).writeByte(0x80).writeByte(0x02);
    compressed.writeByte(61 << 2);
    compressed.writeShortLE(0x8000);
    compressed.writeByte(0x01).writeZero(0x8000);
    compressed.writeByte(0x02);
    compressed.writeShortLE(0x8001);
    snappy.decode(compressed,actualDecompressed);
    assertEquals(expectedDecompressed,actualDecompressed);
  }
  finally {
    compressed.release();
    actualDecompressed.release();
    expectedDecompressed.release();
  }
}
