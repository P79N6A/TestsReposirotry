@Test public void testSetLengths(){
  ByteBuf key=Unpooled.copiedBuffer("Netty  Rocks!",CharsetUtil.UTF_8);
  ByteBuf extras=Unpooled.copiedBuffer("some extras",CharsetUtil.UTF_8);
  ByteBuf content=Unpooled.copiedBuffer("content",CharsetUtil.UTF_8);
  try {
    testSettingLengths(new DefaultBinaryMemcacheRequest(),0,0,0);
    testSettingLengths(new DefaultBinaryMemcacheRequest(key.retain()),key.readableBytes(),0,0);
    testSettingLengths(new DefaultBinaryMemcacheRequest(key.retain(),extras.retain()),key.readableBytes(),extras.readableBytes(),0);
    testSettingLengths(new DefaultBinaryMemcacheResponse(),0,0,0);
    testSettingLengths(new DefaultBinaryMemcacheResponse(key.retain()),key.readableBytes(),0,0);
    testSettingLengths(new DefaultBinaryMemcacheResponse(key.retain(),extras.retain()),key.readableBytes(),extras.readableBytes(),0);
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(key.retain(),extras.retain()),key.readableBytes(),extras.readableBytes(),0);
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(null,extras.retain()),0,extras.readableBytes(),0);
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(key.retain(),null),key.readableBytes(),0,0);
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(null,null),0,0,0);
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(key.retain(),extras.retain(),content.retain()),key.readableBytes(),extras.readableBytes(),content.readableBytes());
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(null,extras.retain(),content.retain()),0,extras.readableBytes(),content.readableBytes());
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(key.retain(),null,content.retain()),key.readableBytes(),0,content.readableBytes());
    testSettingLengths(new DefaultFullBinaryMemcacheRequest(null,null,content.retain()),0,0,content.readableBytes());
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(key.retain(),extras.retain()),key.readableBytes(),extras.readableBytes(),0);
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(null,extras.retain()),0,extras.readableBytes(),0);
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(key.retain(),null),key.readableBytes(),0,0);
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(null,null),0,0,0);
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(key.retain(),extras.retain(),content.retain()),key.readableBytes(),extras.readableBytes(),content.readableBytes());
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(null,extras.retain(),content.retain()),0,extras.readableBytes(),content.readableBytes());
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(key.retain(),null,content.retain()),key.readableBytes(),0,content.readableBytes());
    testSettingLengths(new DefaultFullBinaryMemcacheResponse(null,null,content.retain()),0,0,content.readableBytes());
  }
  finally {
    key.release();
    extras.release();
    content.release();
  }
}
