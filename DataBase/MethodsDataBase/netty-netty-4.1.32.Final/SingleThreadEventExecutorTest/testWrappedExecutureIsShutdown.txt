@Test public void testWrappedExecutureIsShutdown(){
  ExecutorService executorService=Executors.newSingleThreadExecutor();
  SingleThreadEventExecutor executor=new SingleThreadEventExecutor(null,executorService,false){
    @Override protected void run(){
      while (!confirmShutdown()) {
        Runnable task=takeTask();
        if (task != null) {
          task.run();
        }
      }
    }
  }
;
  executorService.shutdownNow();
  executeShouldFail(executor);
  executeShouldFail(executor);
  try {
    executor.shutdownGracefully().syncUninterruptibly();
    Assert.fail();
  }
 catch (  RejectedExecutionException expected) {
  }
  Assert.assertTrue(executor.isShutdown());
}
