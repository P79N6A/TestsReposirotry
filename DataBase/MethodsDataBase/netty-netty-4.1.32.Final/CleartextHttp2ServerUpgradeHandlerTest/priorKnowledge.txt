@Test public void priorKnowledge() throws Exception {
  setUpServerChannel();
  channel.writeInbound(Http2CodecUtil.connectionPrefaceBuf());
  ByteBuf settingsFrame=settingsFrameBuf();
  assertFalse(channel.writeInbound(settingsFrame));
  assertEquals(1,userEvents.size());
  assertTrue(userEvents.get(0) instanceof PriorKnowledgeUpgradeEvent);
  assertEquals(100,http2ConnectionHandler.connection().local().maxActiveStreams());
  assertEquals(65535,http2ConnectionHandler.connection().local().flowController().initialWindowSize());
  verify(frameListener).onSettingsRead(any(ChannelHandlerContext.class),eq(expectedSettings()));
}
