@Test public void testSerialization() throws Exception {
  ChannelId a=DefaultChannelId.newInstance();
  ChannelId b;
  ByteBuf buf=Unpooled.buffer();
  ObjectOutputStream out=new ObjectOutputStream(new ByteBufOutputStream(buf));
  try {
    out.writeObject(a);
    out.flush();
  }
  finally {
    out.close();
  }
  ObjectInputStream in=new ObjectInputStream(new ByteBufInputStream(buf,true));
  try {
    b=(ChannelId)in.readObject();
  }
  finally {
    in.close();
  }
  assertThat(a,is(b));
  assertThat(a,is(not(sameInstance(b))));
  assertThat(a.asLongText(),is(b.asLongText()));
}
