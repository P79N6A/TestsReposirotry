@Test public void testJsonObjectOverMultipleWrites(){
  EmbeddedChannel ch=new EmbeddedChannel(new JsonObjectDecoder());
  String objectPart1="{ \"firstname\": \"John";
  String objectPart2="\" ,\n \"surname\" :";
  String objectPart3="\"Doe\", age:22   \n}";
  ch.writeInbound(Unpooled.copiedBuffer("  \n\n  " + objectPart1,CharsetUtil.UTF_8));
  ch.writeInbound(Unpooled.copiedBuffer(objectPart2,CharsetUtil.UTF_8));
  ch.writeInbound(Unpooled.copiedBuffer(objectPart3 + "   \n\n  \n",CharsetUtil.UTF_8));
  ByteBuf res=ch.readInbound();
  assertEquals(objectPart1 + objectPart2 + objectPart3,res.toString(CharsetUtil.UTF_8));
  res.release();
  assertFalse(ch.finish());
}
