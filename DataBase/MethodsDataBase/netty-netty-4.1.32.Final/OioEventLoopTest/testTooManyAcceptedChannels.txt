@Test public void testTooManyAcceptedChannels() throws Exception {
  EventLoopGroup g=new OioEventLoopGroup(1);
  ServerBootstrap sb=new ServerBootstrap();
  sb.channel(OioServerSocketChannel.class);
  sb.group(g);
  sb.childHandler(new ChannelInboundHandlerAdapter());
  ChannelFuture f1=sb.bind(0);
  f1.sync();
  Socket s=new Socket(NetUtil.LOCALHOST,((InetSocketAddress)f1.channel().localAddress()).getPort());
  assertThat(s.getInputStream().read(),is(-1));
  s.close();
  g.shutdownGracefully();
}
