@Test public void flowControllerCorrectlyAccountsForBytesWithMerge() throws Http2Exception {
  controller.initialWindowSize(112);
  FakeFlowControlled data1=new FakeFlowControlled(5,2,true);
  FakeFlowControlled data2=new FakeFlowControlled(5,100,true);
  sendData(STREAM_A,data1);
  sendData(STREAM_A,data2);
  data1.assertNotWritten();
  data1.assertNotWritten();
  data2.assertMerged();
  controller.writePendingBytes();
  data1.assertFullyWritten();
  data2.assertNotWritten();
  verify(listener,never()).writabilityChanged(stream(STREAM_A));
  assertTrue(controller.isWritable(stream(STREAM_A)));
}
