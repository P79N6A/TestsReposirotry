@Test public void payloadLargerThanWindowShouldWritePartial() throws Http2Exception {
  controller.initialWindowSize(5);
  verify(listener,never()).writabilityChanged(stream(STREAM_A));
  assertTrue(controller.isWritable(stream(STREAM_A)));
  reset(listener);
  final FakeFlowControlled data=new FakeFlowControlled(10);
  sendData(STREAM_A,data);
  controller.writePendingBytes();
  data.assertPartiallyWritten(5);
  verify(listener,times(1)).writabilityChanged(stream(STREAM_A));
  assertFalse(controller.isWritable(stream(STREAM_A)));
  verifyNoMoreInteractions(listener);
}
