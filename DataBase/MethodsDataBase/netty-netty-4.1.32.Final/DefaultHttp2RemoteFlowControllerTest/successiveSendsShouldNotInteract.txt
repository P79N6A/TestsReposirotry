@Test public void successiveSendsShouldNotInteract() throws Http2Exception {
  incrementWindowSize(CONNECTION_STREAM_ID,-window(CONNECTION_STREAM_ID));
  assertEquals(0,window(CONNECTION_STREAM_ID));
  assertWritabilityChanged(1,false);
  reset(listener);
  FakeFlowControlled dataA=new FakeFlowControlled(10);
  sendData(STREAM_A,dataA);
  controller.writePendingBytes();
  dataA.assertNotWritten();
  incrementWindowSize(CONNECTION_STREAM_ID,8);
  assertWritabilityChanged(0,false);
  reset(listener);
  controller.writePendingBytes();
  dataA.assertPartiallyWritten(8);
  assertEquals(65527,window(STREAM_A));
  assertEquals(0,window(CONNECTION_STREAM_ID));
  assertWritabilityChanged(0,false);
  reset(listener);
  FakeFlowControlled dataB=new FakeFlowControlled(10);
  sendData(STREAM_B,dataB);
  controller.writePendingBytes();
  dataB.assertNotWritten();
  incrementWindowSize(CONNECTION_STREAM_ID,12);
  assertWritabilityChanged(0,false);
  reset(listener);
  controller.writePendingBytes();
  assertEquals(0,window(CONNECTION_STREAM_ID));
  assertWritabilityChanged(0,false);
  dataA.assertFullyWritten();
  assertEquals(65525,window(STREAM_A));
  dataB.assertFullyWritten();
  assertEquals(65525,window(STREAM_B));
  verifyNoMoreInteractions(listener);
}
