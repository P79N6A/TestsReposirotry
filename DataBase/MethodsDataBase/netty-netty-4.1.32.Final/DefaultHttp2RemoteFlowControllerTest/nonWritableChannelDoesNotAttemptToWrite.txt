@Test public void nonWritableChannelDoesNotAttemptToWrite() throws Exception {
  setChannelWritability(false);
  assertWritabilityChanged(1,false);
  reset(listener);
  FakeFlowControlled dataA=new FakeFlowControlled(1);
  FakeFlowControlled dataB=new FakeFlowControlled(1);
  final Http2Stream stream=stream(STREAM_A);
  controller.addFlowControlled(stream,dataA);
  controller.writePendingBytes();
  dataA.assertNotWritten();
  controller.incrementWindowSize(stream,100);
  controller.writePendingBytes();
  dataA.assertNotWritten();
  controller.addFlowControlled(stream,dataB);
  controller.writePendingBytes();
  dataA.assertNotWritten();
  dataB.assertNotWritten();
  assertWritabilityChanged(0,false);
  setChannelWritability(true);
  assertWritabilityChanged(1,true);
  controller.writePendingBytes();
  dataA.assertFullyWritten();
  dataB.assertFullyWritten();
}
