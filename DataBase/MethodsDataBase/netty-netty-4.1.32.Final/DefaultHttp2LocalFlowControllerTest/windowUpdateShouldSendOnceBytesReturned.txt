@Test public void windowUpdateShouldSendOnceBytesReturned() throws Http2Exception {
  int dataSize=(int)(DEFAULT_WINDOW_SIZE * DEFAULT_WINDOW_UPDATE_RATIO) + 1;
  receiveFlowControlledFrame(STREAM_ID,dataSize,0,false);
  assertFalse(consumeBytes(STREAM_ID,10));
  verifyWindowUpdateNotSent(STREAM_ID);
  verifyWindowUpdateNotSent(CONNECTION_STREAM_ID);
  assertTrue(consumeBytes(STREAM_ID,dataSize - 10));
  verifyWindowUpdateSent(STREAM_ID,dataSize);
  verifyWindowUpdateSent(CONNECTION_STREAM_ID,dataSize);
  verifyNoMoreInteractions(frameWriter);
}
