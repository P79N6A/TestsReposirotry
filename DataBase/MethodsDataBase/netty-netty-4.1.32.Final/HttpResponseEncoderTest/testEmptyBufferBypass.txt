@Test public void testEmptyBufferBypass() throws Exception {
  EmbeddedChannel channel=new EmbeddedChannel(new HttpResponseEncoder());
  channel.writeOutbound(Unpooled.EMPTY_BUFFER);
  ByteBuf buffer=channel.readOutbound();
  assertThat(buffer,is(sameInstance(Unpooled.EMPTY_BUFFER)));
  HttpResponse response=new DefaultHttpResponse(HttpVersion.HTTP_1_1,HttpResponseStatus.OK);
  assertTrue(channel.writeOutbound(response));
  buffer=channel.readOutbound();
  assertEquals("HTTP/1.1 200 OK\r\n\r\n",buffer.toString(CharsetUtil.US_ASCII));
  buffer.release();
  channel.writeOutbound(Unpooled.EMPTY_BUFFER);
  buffer=channel.readOutbound();
  assertThat(buffer,is(sameInstance(Unpooled.EMPTY_BUFFER)));
  assertFalse(channel.finish());
}
