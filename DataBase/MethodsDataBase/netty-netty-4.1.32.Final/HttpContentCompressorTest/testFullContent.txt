@Test public void testFullContent() throws Exception {
  EmbeddedChannel ch=new EmbeddedChannel(new HttpContentCompressor());
  ch.writeInbound(newRequest());
  FullHttpResponse res=new DefaultFullHttpResponse(HttpVersion.HTTP_1_1,HttpResponseStatus.OK,Unpooled.copiedBuffer("Hello, World",CharsetUtil.US_ASCII));
  ch.writeOutbound(res);
  assertEncodedResponse(ch);
  HttpContent c=ch.readOutbound();
  assertThat(ByteBufUtil.hexDump(c.content()),is("1f8b0800000000000000f248cdc9c9d75108cf2fca4901000000ffff"));
  c.release();
  c=ch.readOutbound();
  assertThat(ByteBufUtil.hexDump(c.content()),is("0300c6865b260c000000"));
  c.release();
  LastHttpContent last=ch.readOutbound();
  assertThat(last.content().readableBytes(),is(0));
  last.release();
  assertThat(ch.readOutbound(),is(nullValue()));
}
