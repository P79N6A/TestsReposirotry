@Test public void testReadOnlyOfDuplicate() throws Exception {
  ByteBuf buf=Unpooled.buffer(8).setIndex(1,7);
  ByteBuf dup=buf.duplicate().setIndex(2,6);
  ByteBuf ro=Unpooled.unmodifiableBuffer(dup);
  assertThat(ro,instanceOf(ReadOnlyByteBuf.class));
  assertThat(ro.unwrap(),sameInstance(buf));
  assertThat(ro.readerIndex(),is(dup.readerIndex()));
  assertThat(ro.writerIndex(),is(dup.writerIndex()));
  assertThat(ro.capacity(),is(dup.capacity()));
  assertThat(ro.maxCapacity(),is(dup.maxCapacity()));
}
