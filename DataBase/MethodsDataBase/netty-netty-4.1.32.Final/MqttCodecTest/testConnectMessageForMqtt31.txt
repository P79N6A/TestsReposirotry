@Test public void testConnectMessageForMqtt31() throws Exception {
  final MqttConnectMessage message=createConnectMessage(MqttVersion.MQTT_3_1);
  ByteBuf byteBuf=MqttEncoder.doEncode(ALLOCATOR,message);
  final List<Object> out=new LinkedList<Object>();
  mqttDecoder.decode(ctx,byteBuf,out);
  assertEquals("Expected one object but got " + out.size(),1,out.size());
  final MqttConnectMessage decodedMessage=(MqttConnectMessage)out.get(0);
  validateFixedHeaders(message.fixedHeader(),decodedMessage.fixedHeader());
  validateConnectVariableHeader(message.variableHeader(),decodedMessage.variableHeader());
  validateConnectPayload(message.payload(),decodedMessage.payload());
}
