@Test public void testUnSubscribeMessageTooLarge() throws Exception {
  final MqttUnsubscribeMessage message=createUnsubscribeMessage();
  ByteBuf byteBuf=MqttEncoder.doEncode(ALLOCATOR,message);
  try {
    final List<Object> out=new LinkedList<Object>();
    mqttDecoderLimitedMessageSize.decode(ctx,byteBuf,out);
    assertEquals("Expected one object but got " + out.size(),1,out.size());
    final MqttMessage decodedMessage=(MqttMessage)out.get(0);
    validateFixedHeaders(message.fixedHeader(),decodedMessage.fixedHeader());
    validateMessageIdVariableHeader(message.variableHeader(),(MqttMessageIdVariableHeader)decodedMessage.variableHeader());
    validateDecoderExceptionTooLargeMessage(decodedMessage);
  }
  finally {
    byteBuf.release();
  }
}
