@Test public void framesShouldBeMultiplexed(){
  TestableHttp2MultiplexCodec.Stream stream3=codec.newStream();
  stream3.id=3;
  TestableHttp2MultiplexCodec.Stream stream5=codec.newStream();
  stream5.id=5;
  TestableHttp2MultiplexCodec.Stream stream11=codec.newStream();
  stream11.id=11;
  LastInboundHandler inboundHandler3=streamActiveAndWriteHeaders(stream3);
  LastInboundHandler inboundHandler5=streamActiveAndWriteHeaders(stream5);
  LastInboundHandler inboundHandler11=streamActiveAndWriteHeaders(stream11);
  verifyFramesMultiplexedToCorrectChannel(stream3,inboundHandler3,1);
  verifyFramesMultiplexedToCorrectChannel(stream5,inboundHandler5,1);
  verifyFramesMultiplexedToCorrectChannel(stream11,inboundHandler11,1);
  codec.onHttp2Frame(new DefaultHttp2DataFrame(bb("hello"),false).stream(stream5));
  codec.onHttp2Frame(new DefaultHttp2DataFrame(bb("foo"),true).stream(stream3));
  codec.onHttp2Frame(new DefaultHttp2DataFrame(bb("world"),true).stream(stream5));
  codec.onHttp2Frame(new DefaultHttp2DataFrame(bb("bar"),true).stream(stream11));
  verifyFramesMultiplexedToCorrectChannel(stream5,inboundHandler5,2);
  verifyFramesMultiplexedToCorrectChannel(stream3,inboundHandler3,1);
  verifyFramesMultiplexedToCorrectChannel(stream11,inboundHandler11,1);
}
