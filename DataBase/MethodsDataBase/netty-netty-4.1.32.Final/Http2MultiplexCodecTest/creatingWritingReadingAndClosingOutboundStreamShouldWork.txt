@Test public void creatingWritingReadingAndClosingOutboundStreamShouldWork(){
  LastInboundHandler inboundHandler=new LastInboundHandler();
  childChannelInitializer.handler=inboundHandler;
  Http2StreamChannel childChannel=newOutboundStream();
  assertTrue(childChannel.isActive());
  assertTrue(inboundHandler.isChannelActive());
  Http2Headers headers=new DefaultHttp2Headers().scheme("https").method("GET").path("/foo.txt");
  childChannel.writeAndFlush(new DefaultHttp2HeadersFrame(headers));
  readOutboundHeadersAndAssignId();
  headers=new DefaultHttp2Headers().scheme("https").status("200");
  codec.onHttp2Frame(new DefaultHttp2HeadersFrame(headers).stream(childChannel.stream()));
  codec.onChannelReadComplete();
  Http2HeadersFrame headersFrame=inboundHandler.readInbound();
  assertNotNull(headersFrame);
  assertSame(headers,headersFrame.headers());
  childChannel.close();
  parentChannel.runPendingTasks();
  Http2ResetFrame rstFrame=parentChannel.readOutbound();
  assertNotNull(rstFrame);
  assertEquals(childChannel.stream(),rstFrame.stream());
  assertFalse(childChannel.isOpen());
  assertFalse(childChannel.isActive());
  assertFalse(inboundHandler.isChannelActive());
}
