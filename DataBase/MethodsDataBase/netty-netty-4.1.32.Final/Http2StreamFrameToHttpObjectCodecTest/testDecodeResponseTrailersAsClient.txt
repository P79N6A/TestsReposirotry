@Test public void testDecodeResponseTrailersAsClient() throws Exception {
  EmbeddedChannel ch=new EmbeddedChannel(new Http2StreamFrameToHttpObjectCodec(false));
  Http2Headers headers=new DefaultHttp2Headers();
  headers.set("key","value");
  assertTrue(ch.writeInbound(new DefaultHttp2HeadersFrame(headers,true)));
  LastHttpContent trailers=ch.readInbound();
  try {
    assertThat(trailers.content().readableBytes(),is(0));
    assertThat(trailers.trailingHeaders().get("key"),is("value"));
    assertFalse(trailers instanceof FullHttpRequest);
  }
  finally {
    trailers.release();
  }
  assertThat(ch.readInbound(),is(nullValue()));
  assertFalse(ch.finish());
}
