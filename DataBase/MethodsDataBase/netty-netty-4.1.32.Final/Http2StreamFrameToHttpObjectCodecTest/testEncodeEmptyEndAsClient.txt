@Test public void testEncodeEmptyEndAsClient() throws Exception {
  EmbeddedChannel ch=new EmbeddedChannel(new Http2StreamFrameToHttpObjectCodec(false));
  LastHttpContent end=LastHttpContent.EMPTY_LAST_CONTENT;
  assertTrue(ch.writeOutbound(end));
  Http2DataFrame emptyFrame=ch.readOutbound();
  try {
    assertThat(emptyFrame.content().readableBytes(),is(0));
    assertTrue(emptyFrame.isEndStream());
  }
  finally {
    emptyFrame.release();
  }
  assertThat(ch.readOutbound(),is(nullValue()));
  assertFalse(ch.finish());
}
