@Test public void testDowngradeEndData() throws Exception {
  EmbeddedChannel ch=new EmbeddedChannel(new Http2StreamFrameToHttpObjectCodec(true));
  ByteBuf hello=Unpooled.copiedBuffer("hello world",CharsetUtil.UTF_8);
  assertTrue(ch.writeInbound(new DefaultHttp2DataFrame(hello,true)));
  LastHttpContent content=ch.readInbound();
  try {
    assertThat(content.content().toString(CharsetUtil.UTF_8),is("hello world"));
    assertTrue(content.trailingHeaders().isEmpty());
  }
  finally {
    content.release();
  }
  assertThat(ch.readInbound(),is(nullValue()));
  assertFalse(ch.finish());
}
