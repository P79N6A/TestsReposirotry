@Test public void shouldAggregateChunksOnDecode(){
  int smallBatchSize=2;
  channel=new EmbeddedChannel(new BinaryMemcacheRequestDecoder(smallBatchSize),new BinaryMemcacheObjectAggregator(MAX_CONTENT_SIZE));
  ByteBuf incoming=Unpooled.buffer();
  incoming.writeBytes(SET_REQUEST_WITH_CONTENT);
  channel.writeInbound(incoming);
  FullBinaryMemcacheRequest request=channel.readInbound();
  assertThat(request,instanceOf(FullBinaryMemcacheRequest.class));
  assertThat(request,notNullValue());
  assertThat(request.key(),notNullValue());
  assertThat(request.extras(),nullValue());
  assertThat(request.content().readableBytes(),is(8));
  assertThat(request.content().readByte(),is((byte)0x01));
  assertThat(request.content().readByte(),is((byte)0x02));
  request.release();
  assertThat(channel.readInbound(),nullValue());
  assertFalse(channel.finish());
}
