@Test(expected=Http2Exception.class) public void dataReadForUnknownStreamShouldApplyFlowControlAndFail() throws Exception {
  when(connection.streamMayHaveExisted(STREAM_ID)).thenReturn(false);
  when(connection.stream(STREAM_ID)).thenReturn(null);
  final ByteBuf data=dummyData();
  int padding=10;
  int processedBytes=data.readableBytes() + padding;
  try {
    decode().onDataRead(ctx,STREAM_ID,data,padding,true);
  }
  finally {
    try {
      verify(localFlow).receiveFlowControlledFrame(eq((Http2Stream)null),eq(data),eq(padding),eq(true));
      verify(localFlow).consumeBytes(eq((Http2Stream)null),eq(processedBytes));
      verify(localFlow).frameWriter(any(Http2FrameWriter.class));
      verifyNoMoreInteractions(localFlow);
      verify(listener,never()).onDataRead(eq(ctx),anyInt(),any(ByteBuf.class),anyInt(),anyBoolean());
    }
  finally {
      data.release();
    }
  }
}
