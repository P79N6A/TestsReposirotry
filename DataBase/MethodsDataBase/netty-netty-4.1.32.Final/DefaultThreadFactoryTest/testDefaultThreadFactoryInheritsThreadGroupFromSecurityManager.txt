@Test(timeout=2000) public void testDefaultThreadFactoryInheritsThreadGroupFromSecurityManager() throws InterruptedException {
  final SecurityManager current=System.getSecurityManager();
  try {
    final ThreadGroup sticky=new ThreadGroup("sticky");
    System.setSecurityManager(new SecurityManager(){
      @Override public ThreadGroup getThreadGroup(){
        return sticky;
      }
      @Override public void checkPermission(      Permission perm){
      }
    }
);
    runStickyThreadGroupTest(new Callable<DefaultThreadFactory>(){
      @Override public DefaultThreadFactory call() throws Exception {
        return new DefaultThreadFactory("test");
      }
    }
,sticky);
  }
  finally {
    System.setSecurityManager(current);
  }
}
