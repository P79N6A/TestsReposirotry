@Test public void testFlushInbound() throws InterruptedException {
  final CountDownLatch latch=new CountDownLatch(1);
  EmbeddedChannel channel=new EmbeddedChannel(new ChannelInboundHandlerAdapter(){
    @Override public void channelReadComplete(    ChannelHandlerContext ctx) throws Exception {
      latch.countDown();
    }
  }
);
  channel.flushInbound();
  if (!latch.await(1L,TimeUnit.SECONDS)) {
    fail("Nobody called #channelReadComplete() in time.");
  }
}
