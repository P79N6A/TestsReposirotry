@Test public void testSSLEngineUnwrapNoSslRecord() throws Exception {
  clientSslCtx=SslContextBuilder.forClient().sslProvider(sslClientProvider()).protocols(protocols()).ciphers(ciphers()).build();
  SSLEngine client=wrapEngine(clientSslCtx.newEngine(UnpooledByteBufAllocator.DEFAULT));
  try {
    ByteBuffer src=allocateBuffer(client.getSession().getApplicationBufferSize());
    ByteBuffer dst=allocateBuffer(client.getSession().getPacketBufferSize());
    ByteBuffer empty=allocateBuffer(0);
    SSLEngineResult clientResult=client.wrap(empty,dst);
    assertEquals(SSLEngineResult.Status.OK,clientResult.getStatus());
    assertEquals(SSLEngineResult.HandshakeStatus.NEED_UNWRAP,clientResult.getHandshakeStatus());
    try {
      client.unwrap(src,dst);
      fail();
    }
 catch (    SSLException expected) {
    }
  }
  finally {
    cleanupClientSslEngine(client);
  }
}
