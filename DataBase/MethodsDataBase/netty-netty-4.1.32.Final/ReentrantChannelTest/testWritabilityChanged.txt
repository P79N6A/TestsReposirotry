@Test public void testWritabilityChanged() throws Exception {
  LocalAddress addr=new LocalAddress("testWritabilityChanged");
  ServerBootstrap sb=getLocalServerBootstrap();
  sb.bind(addr).sync().channel();
  Bootstrap cb=getLocalClientBootstrap();
  setInterest(Event.WRITE,Event.FLUSH,Event.WRITABILITY);
  Channel clientChannel=cb.connect(addr).sync().channel();
  clientChannel.config().setWriteBufferLowWaterMark(512);
  clientChannel.config().setWriteBufferHighWaterMark(1024);
  ChannelFuture future=clientChannel.write(createTestBuf(2000));
  clientChannel.flush();
  future.sync();
  clientChannel.close().sync();
  assertLog("WRITABILITY: writable=false\n" + "WRITE\n" + "WRITABILITY: writable=false\n"+ "WRITABILITY: writable=false\n"+ "FLUSH\n"+ "WRITABILITY: writable=true\n","WRITABILITY: writable=false\n" + "WRITE\n" + "WRITABILITY: writable=false\n"+ "FLUSH\n"+ "WRITABILITY: writable=true\n"+ "WRITABILITY: writable=true\n");
}
