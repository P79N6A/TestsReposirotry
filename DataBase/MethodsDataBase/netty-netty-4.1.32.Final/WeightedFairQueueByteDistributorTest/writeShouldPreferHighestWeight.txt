/** 
 * In this test, we root all streams at the connection, and then verify that data is split appropriately based on weight (all available data is the same). <pre> 0 / / \ \ A B   C D </pre>
 */
@Test public void writeShouldPreferHighestWeight() throws Http2Exception {
  setPriority(STREAM_A,0,(short)50,false);
  setPriority(STREAM_B,0,(short)200,false);
  setPriority(STREAM_C,0,(short)100,false);
  setPriority(STREAM_D,0,(short)100,false);
  initState(STREAM_A,1000,true);
  initState(STREAM_B,1000,true);
  initState(STREAM_C,1000,true);
  initState(STREAM_D,1000,true);
  distributor.allocationQuantum(1);
  assertTrue(write(1000));
  assertEquals(100,captureWrites(STREAM_A));
  assertEquals(450,captureWrites(STREAM_B));
  assertEquals(225,captureWrites(STREAM_C));
  assertEquals(225,captureWrites(STREAM_D));
}
