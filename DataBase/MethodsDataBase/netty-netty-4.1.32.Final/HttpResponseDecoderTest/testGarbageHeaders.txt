@Test public void testGarbageHeaders(){
  byte[] data=("<html>\r\n" + "<head><title>400 Bad Request</title></head>\r\n" + "<body bgcolor=\"white\">\r\n"+ "<center><h1>400 Bad Request</h1></center>\r\n"+ "<hr><center>nginx/1.1.19</center>\r\n"+ "</body>\r\n"+ "</html>\r\n").getBytes();
  EmbeddedChannel ch=new EmbeddedChannel(new HttpResponseDecoder());
  ch.writeInbound(Unpooled.wrappedBuffer(data));
  HttpResponse res=ch.readInbound();
  assertThat(res.protocolVersion(),sameInstance(HttpVersion.HTTP_1_0));
  assertThat(res.status().code(),is(999));
  assertThat(res.decoderResult().isFailure(),is(true));
  assertThat(res.decoderResult().isFinished(),is(true));
  assertThat(ch.readInbound(),is(nullValue()));
  ch.writeInbound(Unpooled.wrappedBuffer(data));
  assertThat(ch.readInbound(),is(nullValue()));
  ch.finish();
  assertThat(ch.readInbound(),is(nullValue()));
}
