@Test public void testAutoConsolidation(){
  CompositeByteBuf buf=compositeBuffer(2);
  buf.addComponent(wrappedBuffer(new byte[]{1}));
  assertEquals(1,buf.numComponents());
  buf.addComponent(wrappedBuffer(new byte[]{2,3}));
  assertEquals(2,buf.numComponents());
  buf.addComponent(wrappedBuffer(new byte[]{4,5,6}));
  assertEquals(1,buf.numComponents());
  assertTrue(buf.hasArray());
  assertNotNull(buf.array());
  assertEquals(0,buf.arrayOffset());
  buf.release();
}
