@Test public void testReleasesOnShrink(){
  ByteBuf b1=Unpooled.buffer(2).writeShort(1);
  ByteBuf b2=Unpooled.buffer(2).writeShort(2);
  ByteBuf composite=Unpooled.compositeBuffer().addComponents(b1,b2);
  assertEquals(4,composite.capacity());
  composite.capacity(2);
  assertEquals(2,composite.capacity());
  composite.release();
  assertEquals(0,composite.refCnt());
  assertEquals(0,b1.refCnt());
  assertEquals(0,b2.refCnt());
}
