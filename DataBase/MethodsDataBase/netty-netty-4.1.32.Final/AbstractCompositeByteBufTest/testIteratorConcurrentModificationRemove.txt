@Test(expected=ConcurrentModificationException.class) public void testIteratorConcurrentModificationRemove(){
  CompositeByteBuf cbuf=compositeBuffer();
  cbuf.addComponent(EMPTY_BUFFER);
  Iterator<ByteBuf> it=cbuf.iterator();
  cbuf.removeComponent(0);
  assertTrue(it.hasNext());
  try {
    it.next();
  }
  finally {
    cbuf.release();
  }
}
