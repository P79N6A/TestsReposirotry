@Test public void testReleasesItsComponents(){
  ByteBuf buffer=PooledByteBufAllocator.DEFAULT.buffer();
  buffer.writeBytes(new byte[]{1,2,3,4,5,6,7,8,9,10});
  ByteBuf s1=buffer.readSlice(2).retain();
  ByteBuf s2=s1.readSlice(2).retain();
  ByteBuf s3=s2.readSlice(2).retain();
  ByteBuf s4=s3.readSlice(2).retain();
  ByteBuf composite=PooledByteBufAllocator.DEFAULT.compositeBuffer().addComponent(s1).addComponents(s2,s3,s4).order(ByteOrder.LITTLE_ENDIAN);
  assertEquals(1,composite.refCnt());
  assertEquals(5,buffer.refCnt());
  ReferenceCountUtil.release(composite);
  assertEquals(0,composite.refCnt());
  assertEquals(1,buffer.refCnt());
  ReferenceCountUtil.release(buffer);
  assertEquals(0,buffer.refCnt());
}
