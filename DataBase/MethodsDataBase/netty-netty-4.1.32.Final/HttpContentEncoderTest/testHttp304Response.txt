@Test public void testHttp304Response() throws Exception {
  EmbeddedChannel ch=new EmbeddedChannel(new TestEncoder());
  HttpRequest req=new DefaultFullHttpRequest(HttpVersion.HTTP_1_1,HttpMethod.GET,"/");
  req.headers().set(HttpHeaderNames.ACCEPT_ENCODING,HttpHeaderValues.GZIP);
  ch.writeInbound(req);
  HttpResponse res=new DefaultHttpResponse(HttpVersion.HTTP_1_1,HttpResponseStatus.NOT_MODIFIED);
  res.headers().set(HttpHeaderNames.TRANSFER_ENCODING,HttpHeaderValues.CHUNKED);
  ch.writeOutbound(res);
  ch.writeOutbound(LastHttpContent.EMPTY_LAST_CONTENT);
  assertEmptyResponse(ch);
}
