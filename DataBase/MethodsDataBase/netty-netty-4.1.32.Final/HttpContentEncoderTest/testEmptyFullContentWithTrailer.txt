@Test public void testEmptyFullContentWithTrailer() throws Exception {
  EmbeddedChannel ch=new EmbeddedChannel(new TestEncoder());
  ch.writeInbound(new DefaultFullHttpRequest(HttpVersion.HTTP_1_1,HttpMethod.GET,"/"));
  FullHttpResponse res=new DefaultFullHttpResponse(HttpVersion.HTTP_1_1,HttpResponseStatus.OK,Unpooled.EMPTY_BUFFER);
  res.trailingHeaders().set(of("X-Test"),of("Netty"));
  ch.writeOutbound(res);
  Object o=ch.readOutbound();
  assertThat(o,is(instanceOf(FullHttpResponse.class)));
  res=(FullHttpResponse)o;
  assertThat(res.headers().get(HttpHeaderNames.TRANSFER_ENCODING),is(nullValue()));
  assertThat(res.headers().get(HttpHeaderNames.CONTENT_ENCODING),is(nullValue()));
  assertThat(res.content().readableBytes(),is(0));
  assertThat(res.content().toString(CharsetUtil.US_ASCII),is(""));
  assertEquals("Netty",res.trailingHeaders().get(of("X-Test")));
  assertThat(ch.readOutbound(),is(nullValue()));
}
