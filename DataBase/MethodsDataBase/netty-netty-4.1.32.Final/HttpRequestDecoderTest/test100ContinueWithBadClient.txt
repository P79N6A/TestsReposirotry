@Test public void test100ContinueWithBadClient(){
  HttpRequestDecoder decoder=new HttpRequestDecoder();
  EmbeddedChannel channel=new EmbeddedChannel(decoder);
  String oversized="PUT /file HTTP/1.1\r\n" + "Expect: 100-continue\r\n" + "Content-Length: 1048576000\r\n\r\n"+ "WAY_TOO_LARGE_DATA_BEGINS";
  channel.writeInbound(Unpooled.copiedBuffer(oversized,CharsetUtil.US_ASCII));
  assertThat(channel.readInbound(),is(instanceOf(HttpRequest.class)));
  HttpContent prematureData=channel.readInbound();
  prematureData.release();
  assertThat(channel.readInbound(),is(nullValue()));
  decoder.reset();
  String query="GET /max-file-size HTTP/1.1\r\n\r\n";
  channel.writeInbound(Unpooled.copiedBuffer(query,CharsetUtil.US_ASCII));
  assertThat(channel.readInbound(),is(instanceOf(HttpRequest.class)));
  assertThat(channel.readInbound(),is(instanceOf(LastHttpContent.class)));
  assertThat(channel.finish(),is(false));
}
