@Test public void getNestedJarFile() throws Exception {
  JarFile nestedJarFile=this.jarFile.getNestedJarFile(this.jarFile.getEntry("nested.jar"));
  Enumeration<java.util.jar.JarEntry> entries=nestedJarFile.entries();
  assertThat(entries.nextElement().getName()).isEqualTo("META-INF/");
  assertThat(entries.nextElement().getName()).isEqualTo("META-INF/MANIFEST.MF");
  assertThat(entries.nextElement().getName()).isEqualTo("3.dat");
  assertThat(entries.nextElement().getName()).isEqualTo("4.dat");
  assertThat(entries.nextElement().getName()).isEqualTo("\u00E4.dat");
  assertThat(entries.hasMoreElements()).isFalse();
  InputStream inputStream=nestedJarFile.getInputStream(nestedJarFile.getEntry("3.dat"));
  assertThat(inputStream.read()).isEqualTo(3);
  assertThat(inputStream.read()).isEqualTo(-1);
  URL url=nestedJarFile.getUrl();
  assertThat(url.toString()).isEqualTo("jar:" + this.rootJarFile.toURI() + "!/nested.jar!/");
  JarURLConnection conn=(JarURLConnection)url.openConnection();
  assertThat(conn.getJarFile()).isSameAs(nestedJarFile);
  assertThat(conn.getJarFileURL().toString()).isEqualTo("jar:" + this.rootJarFile.toURI() + "!/nested.jar");
  assertThat(conn.getInputStream()).isNotNull();
  JarInputStream jarInputStream=new JarInputStream(conn.getInputStream());
  assertThat(jarInputStream.getNextJarEntry().getName()).isEqualTo("3.dat");
  assertThat(jarInputStream.getNextJarEntry().getName()).isEqualTo("4.dat");
  assertThat(jarInputStream.getNextJarEntry().getName()).isEqualTo("\u00E4.dat");
  jarInputStream.close();
  assertThat(conn.getPermission()).isInstanceOf(FilePermission.class);
  FilePermission permission=(FilePermission)conn.getPermission();
  assertThat(permission.getActions()).isEqualTo("read");
  assertThat(permission.getName()).isEqualTo(this.rootJarFile.getPath());
}
