@Test public void registerUrlProtocolHandlerAddsToExistingRegistration(){
  String original=System.getProperty(PROTOCOL_HANDLER);
  try {
    System.setProperty(PROTOCOL_HANDLER,"com.example");
    JarFile.registerUrlProtocolHandler();
    String protocolHandler=System.getProperty(PROTOCOL_HANDLER);
    assertThat(protocolHandler).isEqualTo("com.example|" + HANDLERS_PACKAGE);
  }
  finally {
    if (original == null) {
      System.clearProperty(PROTOCOL_HANDLER);
    }
 else {
      System.setProperty(PROTOCOL_HANDLER,original);
    }
  }
}
