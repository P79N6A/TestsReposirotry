@Test public void trafficWithLongPollTimeouts() throws Exception {
  for (int i=0; i < 10; i++) {
    this.requestFactory.willRespond(HttpStatus.NO_CONTENT);
  }
  this.requestFactory.willRespond("hi");
  TunnelChannel channel=openTunnel(true);
  write(channel,"hello");
  assertThat(this.incomingData.toString()).isEqualTo("hi");
  assertThat(this.requestFactory.getExecutedRequests().size()).isGreaterThan(10);
}
