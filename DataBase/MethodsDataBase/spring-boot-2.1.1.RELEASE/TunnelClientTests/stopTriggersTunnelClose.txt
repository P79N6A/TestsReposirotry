@Test public void stopTriggersTunnelClose() throws Exception {
  TunnelClient client=new TunnelClient(0,this.tunnelConnection);
  int port=client.start();
  SocketChannel channel=SocketChannel.open(new InetSocketAddress(port));
  Thread.sleep(200);
  client.stop();
  assertThat(this.tunnelConnection.getOpenedTimes()).isEqualTo(1);
  assertThat(this.tunnelConnection.isOpen()).isFalse();
  assertThat(channel.read(ByteBuffer.allocate(1))).isEqualTo(-1);
}
