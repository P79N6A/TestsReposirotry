@Test public void updateAndRestart() throws Exception {
  URL url1=new URL("file:/proj/module-a.jar!/");
  URL url2=new URL("file:/proj/module-b.jar!/");
  URL url3=new URL("file:/proj/module-c.jar!/");
  URL url4=new URL("file:/proj/module-d.jar!/");
  URLClassLoader classLoaderA=new URLClassLoader(new URL[]{url1,url2});
  URLClassLoader classLoaderB=new URLClassLoader(new URL[]{url3,url4},classLoaderA);
  SourceFolderUrlFilter filter=new DefaultSourceFolderUrlFilter();
  MockRestartServer server=new MockRestartServer(filter,classLoaderB);
  ClassLoaderFiles files=new ClassLoaderFiles();
  ClassLoaderFile fileA=new ClassLoaderFile(Kind.ADDED,new byte[0]);
  ClassLoaderFile fileB=new ClassLoaderFile(Kind.ADDED,new byte[0]);
  files.addFile("my/module-a","ClassA.class",fileA);
  files.addFile("my/module-c","ClassB.class",fileB);
  server.updateAndRestart(files);
  Set<URL> expectedUrls=new LinkedHashSet<>(Arrays.asList(url1,url3));
  assertThat(server.restartUrls).isEqualTo(expectedUrls);
  assertThat(server.restartFiles).isEqualTo(files);
}
