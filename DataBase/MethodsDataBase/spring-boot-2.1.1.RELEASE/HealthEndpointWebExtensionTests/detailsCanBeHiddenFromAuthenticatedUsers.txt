@Test public void detailsCanBeHiddenFromAuthenticatedUsers(){
  this.contextRunner.withPropertyValues("management.endpoint.health.show-details=never").run((context) -> {
    HealthEndpointWebExtension extension=context.getBean(HealthEndpointWebExtension.class);
    assertThat(extension.health(mock(SecurityContext.class)).getBody().getDetails()).isEmpty();
  }
);
}
