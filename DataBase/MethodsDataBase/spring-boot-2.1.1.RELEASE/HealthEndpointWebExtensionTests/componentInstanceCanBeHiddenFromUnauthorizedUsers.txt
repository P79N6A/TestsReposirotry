@Test public void componentInstanceCanBeHiddenFromUnauthorizedUsers(){
  this.contextRunner.withPropertyValues("management.endpoint.health.show-details=when-authorized","management.endpoint.health.roles=ACTUATOR").run((context) -> {
    HealthEndpointWebExtension extension=context.getBean(HealthEndpointWebExtension.class);
    SecurityContext securityContext=mock(SecurityContext.class);
    given(securityContext.getPrincipal()).willReturn(mock(Principal.class));
    given(securityContext.isUserInRole("ACTUATOR")).willReturn(false);
    assertDetailsNotFound(extension.healthForComponentInstance(securityContext,"composite","one"));
  }
);
}
