@Test(expected=IOException.class) public void sslNeedsClientAuthenticationFailsWithoutClientCertificate() throws Exception {
  AbstractServletWebServerFactory factory=getFactory();
  addTestTxtFile(factory);
  factory.setSsl(getSsl(ClientAuth.NEED,"password","classpath:test.jks"));
  this.webServer=factory.getWebServer();
  this.webServer.start();
  SSLConnectionSocketFactory socketFactory=new SSLConnectionSocketFactory(new SSLContextBuilder().loadTrustMaterial(null,new TrustSelfSignedStrategy()).build());
  HttpClient httpClient=HttpClients.custom().setSSLSocketFactory(socketFactory).build();
  HttpComponentsClientHttpRequestFactory requestFactory=new HttpComponentsClientHttpRequestFactory(httpClient);
  getResponse(getLocalUrl("https","/test.txt"),requestFactory);
}
