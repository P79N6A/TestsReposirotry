@Test public void getChangedFilesWhenAFileIsAddedAndDeletedAndChanged() throws Exception {
  File folder1=new File(this.folder,"folder1");
  File file1=new File(folder1,"file1");
  File file2=new File(folder1,"file2");
  File newFile=new File(folder1,"newfile");
  FileCopyUtils.copy("updatedcontent".getBytes(),file1);
  file2.delete();
  newFile.createNewFile();
  FolderSnapshot updatedSnapshot=new FolderSnapshot(this.folder);
  ChangedFiles changedFiles=this.initialSnapshot.getChangedFiles(updatedSnapshot,null);
  assertThat(changedFiles.getSourceFolder()).isEqualTo(this.folder);
  assertThat(getChangedFile(changedFiles,file1).getType()).isEqualTo(Type.MODIFY);
  assertThat(getChangedFile(changedFiles,file2).getType()).isEqualTo(Type.DELETE);
  assertThat(getChangedFile(changedFiles,newFile).getType()).isEqualTo(Type.ADD);
}
