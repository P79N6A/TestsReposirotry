@Test public void keyStoreProviderIsUsedWhenCreatingKeyStore() throws Exception {
  Ssl ssl=new Ssl();
  ssl.setKeyPassword("password");
  ssl.setKeyStore("src/test/resources/test.jks");
  ssl.setKeyStoreProvider("com.example.KeyStoreProvider");
  SslBuilderCustomizer customizer=new SslBuilderCustomizer(8080,InetAddress.getLocalHost(),ssl,null);
  try {
    ReflectionTestUtils.invokeMethod(customizer,"getKeyManagers",ssl,null);
    fail();
  }
 catch (  IllegalStateException ex) {
    Throwable cause=ex.getCause();
    assertThat(cause).isInstanceOf(NoSuchProviderException.class);
    assertThat(cause).hasMessageContaining("com.example.KeyStoreProvider");
  }
}
