@Test public void neverMoreThanTwoHttpConnections() throws Exception {
  MockHttpConnection h1=new MockHttpConnection();
  this.server.handle(h1);
  MockHttpConnection h2=new MockHttpConnection("1",2);
  this.server.handle(h2);
  MockHttpConnection h3=new MockHttpConnection("2",3);
  this.server.handle(h3);
  h1.waitForResponse();
  assertThat(h1.getServletResponse().getStatus()).isEqualTo(429);
  this.serverChannel.disconnect();
  this.server.getServerThread().join();
}
