@Test public void failureResultsInSingleStackTrace() throws Exception {
  ThreadGroup group=new ThreadGroup("main");
  Thread thread=new Thread(group,"main"){
    @Override public void run(){
      SpringApplication application=new SpringApplication(FailingConfig.class);
      application.setWebApplicationType(WebApplicationType.NONE);
      application.run();
    }
  }
;
  thread.start();
  thread.join(6000);
  int occurrences=StringUtils.countOccurrencesOf(this.output.toString(),"Caused by: java.lang.RuntimeException: ExpectedError");
  assertThat(occurrences).as("Expected single stacktrace").isEqualTo(1);
}
