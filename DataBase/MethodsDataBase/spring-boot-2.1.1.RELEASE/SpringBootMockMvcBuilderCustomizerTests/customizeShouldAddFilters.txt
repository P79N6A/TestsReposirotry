@Test @SuppressWarnings("unchecked") public void customizeShouldAddFilters(){
  AnnotationConfigWebApplicationContext context=new AnnotationConfigWebApplicationContext();
  MockServletContext servletContext=new MockServletContext();
  context.setServletContext(servletContext);
  context.register(ServletConfiguration.class,FilterConfiguration.class);
  context.refresh();
  DefaultMockMvcBuilder builder=MockMvcBuilders.webAppContextSetup(context);
  this.customizer=new SpringBootMockMvcBuilderCustomizer(context);
  this.customizer.customize(builder);
  FilterRegistrationBean<?> registrationBean=(FilterRegistrationBean<?>)context.getBean("filterRegistrationBean");
  Filter testFilter=(Filter)context.getBean("testFilter");
  Filter otherTestFilter=registrationBean.getFilter();
  List<Filter> filters=(List<Filter>)ReflectionTestUtils.getField(builder,"filters");
  assertThat(filters).containsExactlyInAnyOrder(testFilter,otherTestFilter);
}
