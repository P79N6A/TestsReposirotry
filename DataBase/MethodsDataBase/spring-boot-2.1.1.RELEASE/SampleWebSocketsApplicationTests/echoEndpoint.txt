@Test public void echoEndpoint(){
  ConfigurableApplicationContext context=new SpringApplicationBuilder(ClientConfiguration.class,PropertyPlaceholderAutoConfiguration.class).properties("websocket.uri:ws://localhost:" + this.port + "/echo/websocket").run("--spring.main.web-application-type=none");
  long count=context.getBean(ClientConfiguration.class).latch.getCount();
  AtomicReference<String> messagePayloadReference=context.getBean(ClientConfiguration.class).messagePayload;
  context.close();
  assertThat(count).isEqualTo(0);
  assertThat(messagePayloadReference.get()).isEqualTo("Did you say \"Hello world!\"?");
}
