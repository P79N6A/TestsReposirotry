@Test public void customPersistenceUnitManager(){
  this.contextRunner.withUserConfiguration(TestConfigurationWithCustomPersistenceUnitManager.class).run((context) -> {
    LocalContainerEntityManagerFactoryBean entityManagerFactoryBean=context.getBean(LocalContainerEntityManagerFactoryBean.class);
    Field field=LocalContainerEntityManagerFactoryBean.class.getDeclaredField("persistenceUnitManager");
    field.setAccessible(true);
    assertThat(field.get(entityManagerFactoryBean)).isEqualTo(context.getBean(PersistenceUnitManager.class));
  }
);
}
