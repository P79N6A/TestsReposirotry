@Test public void accessManagerAllowRequest() throws Exception {
  given(this.accessManager.isAllowed(any(ServerHttpRequest.class))).willReturn(true);
  HandlerMapper mapper=mock(HandlerMapper.class);
  Handler handler=mock(Handler.class);
  given(mapper.getHandler(any(ServerHttpRequest.class))).willReturn(handler);
  Dispatcher dispatcher=new Dispatcher(this.accessManager,Collections.singleton(mapper));
  dispatcher.handle(this.serverRequest,this.serverResponse);
  verify(handler).handle(this.serverRequest,this.serverResponse);
}
