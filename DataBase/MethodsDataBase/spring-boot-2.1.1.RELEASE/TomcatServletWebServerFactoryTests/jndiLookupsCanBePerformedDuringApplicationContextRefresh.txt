@Test public void jndiLookupsCanBePerformedDuringApplicationContextRefresh() throws NamingException {
  Thread.currentThread().setContextClassLoader(getClass().getClassLoader());
  TomcatServletWebServerFactory factory=new TomcatServletWebServerFactory(0){
    @Override protected TomcatWebServer getTomcatWebServer(    Tomcat tomcat){
      tomcat.enableNaming();
      return super.getTomcatWebServer(tomcat);
    }
  }
;
  this.webServer=factory.getWebServer();
  new InitialContext().lookup("java:comp/env");
  this.webServer.start();
  assertThatExceptionOfType(NamingException.class).isThrownBy(() -> new InitialContext().lookup("java:comp/env"));
}
