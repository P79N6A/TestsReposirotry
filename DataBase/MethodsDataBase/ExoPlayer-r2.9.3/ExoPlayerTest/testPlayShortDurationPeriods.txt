/** 
 * Tests playback of periods with very short duration. 
 */
@Test public void testPlayShortDurationPeriods() throws Exception {
  Timeline timeline=new FakeTimeline(new TimelineWindowDefinition(100,0));
  FakeRenderer renderer=new FakeRenderer(Builder.VIDEO_FORMAT);
  ExoPlayerTestRunner testRunner=new Builder().setTimeline(timeline).setRenderers(renderer).build(context).start().blockUntilEnded(TIMEOUT_MS);
  Integer[] expectedReasons=new Integer[99];
  Arrays.fill(expectedReasons,Player.DISCONTINUITY_REASON_PERIOD_TRANSITION);
  testRunner.assertPositionDiscontinuityReasonsEqual(expectedReasons);
  testRunner.assertTimelinesEqual(timeline);
  testRunner.assertTimelineChangeReasonsEqual(Player.TIMELINE_CHANGE_REASON_PREPARED);
  assertThat(renderer.formatReadCount).isEqualTo(100);
  assertThat(renderer.sampleBufferReadCount).isEqualTo(100);
  assertThat(renderer.isEnded).isTrue();
}
