@Test public void testAdGroupWithLoadErrorIsSkipped() throws Exception {
  AdPlaybackState initialAdPlaybackState=FakeTimeline.createAdPlaybackState(1,5 * C.MICROS_PER_SECOND);
  Timeline fakeTimeline=new FakeTimeline(new TimelineWindowDefinition(1,0,true,false,C.MICROS_PER_SECOND,initialAdPlaybackState));
  AdPlaybackState errorAdPlaybackState=initialAdPlaybackState.withAdLoadError(0,0);
  final Timeline adErrorTimeline=new FakeTimeline(new TimelineWindowDefinition(1,0,true,false,C.MICROS_PER_SECOND,errorAdPlaybackState));
  final FakeMediaSource fakeMediaSource=new FakeMediaSource(fakeTimeline,null,Builder.VIDEO_FORMAT);
  ActionSchedule actionSchedule=new ActionSchedule.Builder("testAdGroupWithLoadErrorIsSkipped").pause().waitForPlaybackState(Player.STATE_READY).executeRunnable(() -> fakeMediaSource.setNewSourceInfo(adErrorTimeline,null)).waitForTimelineChanged(adErrorTimeline).play().build();
  ExoPlayerTestRunner testRunner=new ExoPlayerTestRunner.Builder().setMediaSource(fakeMediaSource).setActionSchedule(actionSchedule).build(context).start().blockUntilEnded(TIMEOUT_MS);
  testRunner.assertPositionDiscontinuityReasonsEqual(Player.DISCONTINUITY_REASON_AD_INSERTION);
}
