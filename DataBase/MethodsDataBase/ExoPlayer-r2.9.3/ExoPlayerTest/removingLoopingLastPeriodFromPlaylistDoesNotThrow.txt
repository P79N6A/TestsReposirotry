@Test public void removingLoopingLastPeriodFromPlaylistDoesNotThrow() throws Exception {
  Timeline timeline=new FakeTimeline(new TimelineWindowDefinition(true,true,100_000));
  MediaSource mediaSource=new FakeMediaSource(timeline,null);
  ConcatenatingMediaSource concatenatingMediaSource=new ConcatenatingMediaSource(mediaSource);
  ActionSchedule actionSchedule=new ActionSchedule.Builder("removingLoopingLastPeriodFromPlaylistDoesNotThrow").pause().waitForPlaybackState(Player.STATE_READY).playUntilPosition(0,90).setRepeatMode(Player.REPEAT_MODE_ALL).executeRunnable(concatenatingMediaSource::clear).build();
  new Builder().setMediaSource(concatenatingMediaSource).setActionSchedule(actionSchedule).build(context).start().blockUntilEnded(TIMEOUT_MS);
}
