@Test public void testDynamicTimelineChangeReason() throws Exception {
  Timeline timeline1=new FakeTimeline(new TimelineWindowDefinition(false,false,100000));
  final Timeline timeline2=new FakeTimeline(new TimelineWindowDefinition(false,false,20000));
  final FakeMediaSource mediaSource=new FakeMediaSource(timeline1,null,Builder.VIDEO_FORMAT);
  ActionSchedule actionSchedule=new ActionSchedule.Builder("testDynamicTimelineChangeReason").pause().waitForTimelineChanged(timeline1).executeRunnable(() -> mediaSource.setNewSourceInfo(timeline2,null)).waitForTimelineChanged(timeline2).play().build();
  ExoPlayerTestRunner testRunner=new ExoPlayerTestRunner.Builder().setMediaSource(mediaSource).setActionSchedule(actionSchedule).build(context).start().blockUntilEnded(TIMEOUT_MS);
  testRunner.assertTimelinesEqual(timeline1,timeline2);
  testRunner.assertTimelineChangeReasonsEqual(Player.TIMELINE_CHANGE_REASON_PREPARED,Player.TIMELINE_CHANGE_REASON_DYNAMIC);
}
