@Test public void testRedirectParseAndAttachCookie_dataSourceHandlesSetCookie_andPreservesOriginalRequestHeaders() throws HttpDataSourceException {
  dataSourceUnderTest=new CronetDataSource(mockCronetEngine,mockExecutor,mockContentTypePredicate,TEST_CONNECT_TIMEOUT_MS,TEST_READ_TIMEOUT_MS,true,Clock.DEFAULT,null,true);
  dataSourceUnderTest.addTransferListener(mockTransferListener);
  dataSourceUnderTest.setRequestProperty("Content-Type",TEST_CONTENT_TYPE);
  mockSingleRedirectSuccess();
  testResponseHeader.put("Set-Cookie","testcookie=testcookie; Path=/video");
  dataSourceUnderTest.open(testDataSpec);
  verify(mockUrlRequestBuilder).addHeader(eq("Cookie"),any(String.class));
  verify(mockUrlRequestBuilder,never()).addHeader(eq("Range"),any(String.class));
  verify(mockUrlRequestBuilder,times(2)).addHeader("Content-Type",TEST_CONTENT_TYPE);
  verify(mockUrlRequest,never()).followRedirect();
  verify(mockUrlRequest,times(2)).start();
}
