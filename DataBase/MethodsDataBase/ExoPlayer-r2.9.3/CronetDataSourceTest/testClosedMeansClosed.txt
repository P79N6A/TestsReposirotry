@Test public void testClosedMeansClosed() throws HttpDataSourceException {
  mockResponseStartSuccess();
  mockReadSuccess(0,16);
  int bytesRead=0;
  dataSourceUnderTest.open(testDataSpec);
  byte[] returnedBuffer=new byte[8];
  bytesRead+=dataSourceUnderTest.read(returnedBuffer,0,8);
  assertThat(returnedBuffer).isEqualTo(buildTestDataArray(0,8));
  assertThat(bytesRead).isEqualTo(8);
  dataSourceUnderTest.close();
  verify(mockTransferListener).onTransferEnd(dataSourceUnderTest,testDataSpec,true);
  try {
    bytesRead+=dataSourceUnderTest.read(returnedBuffer,0,8);
    fail();
  }
 catch (  IllegalStateException e) {
  }
  assertThat(bytesRead).isEqualTo(8);
}
