@Test public void testVariableSubstitution() throws IOException {
  Uri playlistUri=Uri.parse("https://example.com/substitution.m3u8");
  String playlistString="#EXTM3U\n" + "#EXT-X-VERSION:8\n" + "#EXT-X-DEFINE:NAME=\"underscore_1\",VALUE=\"{\"\n"+ "#EXT-X-DEFINE:NAME=\"dash-1\",VALUE=\"replaced_value.ts\"\n"+ "#EXT-X-TARGETDURATION:5\n"+ "#EXT-X-MEDIA-SEQUENCE:10\n"+ "#EXTINF:5.005,\n"+ "segment1.ts\n"+ "#EXT-X-MAP:URI=\"{$dash-1}\""+ "#EXTINF:5.005,\n"+ "segment{$underscore_1}$name_1}\n";
  InputStream inputStream=new ByteArrayInputStream(Util.getUtf8Bytes(playlistString));
  HlsMediaPlaylist playlist=(HlsMediaPlaylist)new HlsPlaylistParser().parse(playlistUri,inputStream);
  Segment segment=playlist.segments.get(1);
  assertThat(segment.initializationSegment.url).isEqualTo("replaced_value.ts");
  assertThat(segment.url).isEqualTo("segment{$name_1}");
}
