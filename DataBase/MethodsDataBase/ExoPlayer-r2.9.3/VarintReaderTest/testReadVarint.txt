@Test public void testReadVarint() throws IOException, InterruptedException {
  VarintReader reader=new VarintReader();
  testReadVarint(reader,true,DATA_1_BYTE_0,1,0);
  testReadVarint(reader,true,DATA_2_BYTE_0,2,0);
  testReadVarint(reader,true,DATA_3_BYTE_0,3,0);
  testReadVarint(reader,true,DATA_4_BYTE_0,4,0);
  testReadVarint(reader,true,DATA_5_BYTE_0,5,0);
  testReadVarint(reader,true,DATA_6_BYTE_0,6,0);
  testReadVarint(reader,true,DATA_7_BYTE_0,7,0);
  testReadVarint(reader,true,DATA_8_BYTE_0,8,0);
  testReadVarint(reader,true,DATA_1_BYTE_64,1,64);
  testReadVarint(reader,true,DATA_2_BYTE_64,2,64);
  testReadVarint(reader,true,DATA_3_BYTE_64,3,64);
  testReadVarint(reader,true,DATA_4_BYTE_64,4,64);
  testReadVarint(reader,true,DATA_5_BYTE_64,5,64);
  testReadVarint(reader,true,DATA_6_BYTE_64,6,64);
  testReadVarint(reader,true,DATA_7_BYTE_64,7,64);
  testReadVarint(reader,true,DATA_8_BYTE_64,8,64);
  testReadVarint(reader,true,DATA_1_BYTE_MAX,1,VALUE_1_BYTE_MAX);
  testReadVarint(reader,true,DATA_2_BYTE_MAX,2,VALUE_2_BYTE_MAX);
  testReadVarint(reader,true,DATA_3_BYTE_MAX,3,VALUE_3_BYTE_MAX);
  testReadVarint(reader,true,DATA_4_BYTE_MAX,4,VALUE_4_BYTE_MAX);
  testReadVarint(reader,true,DATA_5_BYTE_MAX,5,VALUE_5_BYTE_MAX);
  testReadVarint(reader,true,DATA_6_BYTE_MAX,6,VALUE_6_BYTE_MAX);
  testReadVarint(reader,true,DATA_7_BYTE_MAX,7,VALUE_7_BYTE_MAX);
  testReadVarint(reader,true,DATA_8_BYTE_MAX,8,VALUE_8_BYTE_MAX);
  testReadVarint(reader,false,DATA_1_BYTE_MAX,1,VALUE_1_BYTE_MAX_WITH_MASK);
  testReadVarint(reader,false,DATA_2_BYTE_MAX,2,VALUE_2_BYTE_MAX_WITH_MASK);
  testReadVarint(reader,false,DATA_3_BYTE_MAX,3,VALUE_3_BYTE_MAX_WITH_MASK);
  testReadVarint(reader,false,DATA_4_BYTE_MAX,4,VALUE_4_BYTE_MAX_WITH_MASK);
  testReadVarint(reader,false,DATA_5_BYTE_MAX,5,VALUE_5_BYTE_MAX_WITH_MASK);
  testReadVarint(reader,false,DATA_6_BYTE_MAX,6,VALUE_6_BYTE_MAX_WITH_MASK);
  testReadVarint(reader,false,DATA_7_BYTE_MAX,7,VALUE_7_BYTE_MAX_WITH_MASK);
  testReadVarint(reader,false,DATA_8_BYTE_MAX,8,VALUE_8_BYTE_MAX_WITH_MASK);
}
