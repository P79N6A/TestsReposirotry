@Test public void testResumeBeforeTotallyStopped() throws Throwable {
  setUpDownloadManager(2);
  FakeDownloadAction download1Action=createDownloadAction(uri1).ignoreInterrupts();
  FakeDownloadAction download2Action=createDownloadAction(uri2);
  FakeDownloadAction download3Action=createDownloadAction(uri3);
  download1Action.post().assertStarted();
  download2Action.post().assertStarted();
  download3Action.post().assertDoesNotStart();
  runOnMainThread(() -> downloadManager.stopDownloads());
  download2Action.assertStopped();
  runOnMainThread(() -> downloadManager.startDownloads());
  download2Action.assertStarted();
  download3Action.assertDoesNotStart();
  download1Action.unblock().assertStopped().assertStarted();
  download1Action.unblock();
  download2Action.unblock();
  download3Action.unblock();
  downloadManagerListener.blockUntilTasksCompleteAndThrowAnyDownloadError();
}
