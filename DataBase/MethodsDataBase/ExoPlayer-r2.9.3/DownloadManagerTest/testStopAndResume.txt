@Test public void testStopAndResume() throws Throwable {
  FakeDownloadAction download1Action=createDownloadAction(uri1);
  FakeDownloadAction remove2Action=createRemoveAction(uri2);
  FakeDownloadAction download2Action=createDownloadAction(uri2);
  FakeDownloadAction remove1Action=createRemoveAction(uri1);
  FakeDownloadAction download3Action=createDownloadAction(uri3);
  download1Action.post().assertStarted();
  remove2Action.post().assertStarted();
  download2Action.post().assertDoesNotStart();
  runOnMainThread(() -> downloadManager.stopDownloads());
  download1Action.assertStopped();
  remove2Action.unblock().assertCompleted();
  download2Action.assertDoesNotStart();
  remove1Action.post();
  download1Action.assertCanceled();
  remove1Action.assertStarted().unblock().assertCompleted();
  download3Action.post().assertDoesNotStart();
  runOnMainThread(() -> downloadManager.startDownloads());
  download2Action.assertStarted().unblock().assertCompleted();
  download3Action.assertStarted().unblock().assertCompleted();
  downloadManagerListener.blockUntilTasksCompleteAndThrowAnyDownloadError();
}
