@Test public void testRemoveChildSourceWithActiveMediaPeriod() throws IOException {
  FakeMediaSource childSource=createFakeMediaSource();
  mediaSource.addMediaSource(childSource);
  Timeline timeline=testRunner.prepareSource();
  MediaPeriod mediaPeriod=testRunner.createPeriod(new MediaPeriodId(timeline.getUidOfPeriod(0),0));
  mediaSource.removeMediaSource(0);
  testRunner.assertTimelineChangeBlocking();
  testRunner.releasePeriod(mediaPeriod);
  childSource.assertReleased();
  testRunner.releaseSource();
}
