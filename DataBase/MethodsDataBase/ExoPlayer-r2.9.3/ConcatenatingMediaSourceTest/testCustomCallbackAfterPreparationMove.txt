@Test public void testCustomCallbackAfterPreparationMove() throws IOException {
  DummyMainThread dummyMainThread=new DummyMainThread();
  try {
    testRunner.prepareSource();
    dummyMainThread.runOnMainThread(() -> mediaSource.addMediaSources(Arrays.asList(new MediaSource[]{createFakeMediaSource(),createFakeMediaSource()})));
    testRunner.assertTimelineChangeBlocking();
    final TimelineGrabber timelineGrabber=new TimelineGrabber(testRunner);
    dummyMainThread.runOnMainThread(() -> mediaSource.moveMediaSource(1,0,timelineGrabber));
    Timeline timeline=timelineGrabber.assertTimelineChangeBlocking();
    assertThat(timeline.getWindowCount()).isEqualTo(2);
  }
  finally {
    dummyMainThread.release();
  }
}
