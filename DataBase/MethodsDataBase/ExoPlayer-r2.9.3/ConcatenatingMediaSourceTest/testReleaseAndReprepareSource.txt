@Test public void testReleaseAndReprepareSource() throws IOException {
  FakeMediaSource[] fakeMediaSources=createMediaSources(2);
  mediaSource.addMediaSource(fakeMediaSources[0]);
  mediaSource.addMediaSource(fakeMediaSources[1]);
  Timeline timeline=testRunner.prepareSource();
  Object periodId0=timeline.getUidOfPeriod(0);
  Object periodId1=timeline.getUidOfPeriod(1);
  Object periodId2=timeline.getUidOfPeriod(2);
  testRunner.releaseSource();
  mediaSource.moveMediaSource(1,0);
  timeline=testRunner.prepareSource();
  Object newPeriodId0=timeline.getUidOfPeriod(0);
  Object newPeriodId1=timeline.getUidOfPeriod(1);
  Object newPeriodId2=timeline.getUidOfPeriod(2);
  assertThat(newPeriodId0).isEqualTo(periodId1);
  assertThat(newPeriodId1).isEqualTo(periodId2);
  assertThat(newPeriodId2).isEqualTo(periodId0);
}
