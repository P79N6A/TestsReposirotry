@Test public void testChildTimelineChangeWithActiveMediaPeriod() throws IOException {
  FakeMediaSource[] nestedChildSources=createMediaSources(2);
  ConcatenatingMediaSource childSource=new ConcatenatingMediaSource(nestedChildSources);
  mediaSource.addMediaSource(childSource);
  Timeline timeline=testRunner.prepareSource();
  MediaPeriod mediaPeriod=testRunner.createPeriod(new MediaPeriodId(timeline.getUidOfPeriod(1),0));
  childSource.moveMediaSource(0,1);
  timeline=testRunner.assertTimelineChangeBlocking();
  testRunner.preparePeriod(mediaPeriod,0);
  testRunner.assertCompletedMediaPeriodLoads(new MediaPeriodId(timeline.getUidOfPeriod(0),0));
}
