@Test public void testCustomInitialSectionReader() throws Exception {
  CustomTsPayloadReaderFactory factory=new CustomTsPayloadReaderFactory(false,true);
  TsExtractor tsExtractor=new TsExtractor(TsExtractor.MODE_MULTI_PMT,new TimestampAdjuster(0),factory);
  FakeExtractorInput input=new FakeExtractorInput.Builder().setData(TestUtil.getByteArray(RuntimeEnvironment.application,"ts/sample_with_sdt.ts")).setSimulateIOErrors(false).setSimulateUnknownLength(false).setSimulatePartialReads(false).build();
  tsExtractor.init(new FakeExtractorOutput());
  PositionHolder seekPositionHolder=new PositionHolder();
  int readResult=Extractor.RESULT_CONTINUE;
  while (readResult != Extractor.RESULT_END_OF_INPUT) {
    readResult=tsExtractor.read(input,seekPositionHolder);
    if (readResult == Extractor.RESULT_SEEK) {
      input.setPosition((int)seekPositionHolder.position);
    }
  }
  assertThat(factory.sdtReader.consumedSdts).isEqualTo(2);
}
