@Test public void testWidevineOfflineExpiredLicenseV22() throws Exception {
  if (Util.SDK_INT < 22) {
    return;
  }
  downloadLicense();
  long licenseDuration=offlineLicenseHelper.getLicenseDurationRemainingSec(offlineLicenseKeySetId).first;
  assertWithMessage("License duration should be less than 30 sec. " + "Server settings might have changed.").that(licenseDuration < 30).isTrue();
  while (licenseDuration > 0) {
synchronized (this) {
      wait(licenseDuration * 1000 + 2000);
    }
    long previousDuration=licenseDuration;
    licenseDuration=offlineLicenseHelper.getLicenseDurationRemainingSec(offlineLicenseKeySetId).first;
    assertWithMessage("License duration should be decreasing.").that(previousDuration > licenseDuration).isTrue();
  }
  testRunner.run();
}
