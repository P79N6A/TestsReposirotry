@Test public void testWidevineOfflineReleasedLicenseV22() throws Throwable {
  if (Util.SDK_INT < 22) {
    return;
  }
  downloadLicense();
  releaseLicense();
  try {
    testRunner.run();
    fail("Playback should fail because the license has been released.");
  }
 catch (  Throwable e) {
    while (true) {
      Throwable cause=e.getCause();
      if (cause == null || cause == e) {
        break;
      }
      e=cause;
    }
    if (!(e instanceof MediaDrmStateException)) {
      throw e;
    }
  }
}
