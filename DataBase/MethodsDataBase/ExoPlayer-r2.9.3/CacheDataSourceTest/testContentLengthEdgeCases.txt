@Test public void testContentLengthEdgeCases() throws Exception {
  CacheDataSource cacheDataSource=createCacheDataSource(false,true);
  assertReadData(cacheDataSource,true,TEST_DATA.length - 2,2);
  assertThat(cache.getContentLength(expectedCacheKey)).isEqualTo(C.LENGTH_UNSET);
  cacheDataSource=createCacheDataSource(false,true);
  assertReadDataContentLength(cacheDataSource,true,true);
  assertThat(cacheDataSource.open(new DataSpec(testDataUri,TEST_DATA.length - 2,C.LENGTH_UNSET,expectedCacheKey))).isEqualTo(2);
  assertThat(cacheDataSource.open(new DataSpec(Uri.parse("notCachedUri"),TEST_DATA.length - 2,C.LENGTH_UNSET,null))).isEqualTo(C.LENGTH_UNSET);
}
