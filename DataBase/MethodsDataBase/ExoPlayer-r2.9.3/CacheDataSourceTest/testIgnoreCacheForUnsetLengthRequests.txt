@Test public void testIgnoreCacheForUnsetLengthRequests() throws Exception {
  FakeDataSource upstream=new FakeDataSource();
  upstream.getDataSet().setData(testDataUri,TEST_DATA);
  CacheDataSource cacheDataSource=new CacheDataSource(cache,upstream,CacheDataSource.FLAG_IGNORE_CACHE_FOR_UNSET_LENGTH_REQUESTS);
  cacheDataSource.open(new DataSpec(testDataUri,0,C.LENGTH_UNSET,expectedCacheKey));
  TestUtil.readToEnd(cacheDataSource);
  cacheDataSource.close();
  assertThat(cache.getKeys()).isEmpty();
}
