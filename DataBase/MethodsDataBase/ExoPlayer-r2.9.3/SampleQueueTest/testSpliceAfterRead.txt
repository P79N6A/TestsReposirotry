@Test public void testSpliceAfterRead(){
  writeTestData();
  assertReadTestData(null,0,4);
  sampleQueue.splice();
  long spliceSampleTimeUs=SAMPLE_TIMESTAMPS[3];
  writeSample(DATA,spliceSampleTimeUs,FORMAT_SPLICED,C.BUFFER_FLAG_KEY_FRAME);
  assertReadTestData(SAMPLE_FORMATS[3],4,4);
  assertReadEndOfStream(false);
  sampleQueue.rewind();
  assertReadTestData(null,0,4);
  sampleQueue.splice();
  spliceSampleTimeUs=SAMPLE_TIMESTAMPS[3] + 1;
  writeSample(DATA,spliceSampleTimeUs,FORMAT_SPLICED,C.BUFFER_FLAG_KEY_FRAME);
  assertReadFormat(false,FORMAT_SPLICED);
  assertReadSample(spliceSampleTimeUs,true,DATA,0,DATA.length);
  assertReadEndOfStream(false);
}
