@Test public void testSkip() throws IOException {
  DataSourceInputStream inputStream=buildTestInputStream();
  long totalBytesSkipped=0;
  while (totalBytesSkipped < TEST_DATA.length) {
    long bytesSkipped=inputStream.skip(Long.MAX_VALUE);
    assertThat(bytesSkipped > 0).isTrue();
    totalBytesSkipped+=bytesSkipped;
    assertThat(inputStream.bytesRead()).isEqualTo(totalBytesSkipped);
  }
  assertThat(inputStream.bytesRead()).isEqualTo(TEST_DATA.length);
  assertThat(totalBytesSkipped).isEqualTo(TEST_DATA.length);
  assertThat(inputStream.read()).isEqualTo(-1);
  inputStream.close();
}
