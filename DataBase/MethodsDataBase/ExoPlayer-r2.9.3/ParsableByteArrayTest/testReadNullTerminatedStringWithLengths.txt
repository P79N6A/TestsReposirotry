@Test public void testReadNullTerminatedStringWithLengths(){
  byte[] bytes=new byte[]{'f','o','o',0,'b','a','r',0};
  ParsableByteArray parser=new ParsableByteArray(bytes);
  assertThat(parser.readNullTerminatedString(4)).isEqualTo("foo");
  assertThat(parser.getPosition()).isEqualTo(4);
  assertThat(parser.readNullTerminatedString(4)).isEqualTo("bar");
  assertThat(parser.getPosition()).isEqualTo(8);
  assertThat(parser.readNullTerminatedString()).isNull();
  parser=new ParsableByteArray(bytes);
  assertThat(parser.readNullTerminatedString(2)).isEqualTo("fo");
  assertThat(parser.getPosition()).isEqualTo(2);
  assertThat(parser.readNullTerminatedString(2)).isEqualTo("o");
  assertThat(parser.getPosition()).isEqualTo(4);
  assertThat(parser.readNullTerminatedString(3)).isEqualTo("bar");
  assertThat(parser.getPosition()).isEqualTo(7);
  assertThat(parser.readNullTerminatedString(1)).isEqualTo("");
  assertThat(parser.getPosition()).isEqualTo(8);
  assertThat(parser.readNullTerminatedString()).isNull();
  parser=new ParsableByteArray(bytes,4);
  assertThat(parser.readNullTerminatedString(4)).isEqualTo("foo");
  assertThat(parser.getPosition()).isEqualTo(4);
  assertThat(parser.readNullTerminatedString()).isNull();
  parser=new ParsableByteArray(bytes,3);
  assertThat(parser.readNullTerminatedString(3)).isEqualTo("foo");
  assertThat(parser.getPosition()).isEqualTo(3);
  assertThat(parser.readNullTerminatedString()).isNull();
}
