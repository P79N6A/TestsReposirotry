@Test public void testUpdateSelectedTrackSwitchDownIfNotBufferedEnough(){
  Format format1=videoFormat(500,320,240);
  Format format2=videoFormat(1000,640,480);
  Format format3=videoFormat(2000,960,720);
  TrackGroup trackGroup=new TrackGroup(format1,format2,format3);
  when(mockBandwidthMeter.getBitrateEstimate()).thenReturn(1000L,500L);
  adaptiveTrackSelection=adaptiveTrackSelectionWithMaxDurationForQualityDecreaseMs(trackGroup,25_000);
  adaptiveTrackSelection.updateSelectedTrack(0,24_999_000,C.TIME_UNSET,Collections.emptyList(),THREE_EMPTY_MEDIA_CHUNK_ITERATORS);
  assertThat(adaptiveTrackSelection.getSelectedFormat()).isEqualTo(format1);
  assertThat(adaptiveTrackSelection.getSelectionReason()).isEqualTo(C.SELECTION_REASON_ADAPTIVE);
}
