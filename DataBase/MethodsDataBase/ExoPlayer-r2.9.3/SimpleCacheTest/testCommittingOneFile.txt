@Test public void testCommittingOneFile() throws Exception {
  SimpleCache simpleCache=getSimpleCache();
  CacheSpan cacheSpan1=simpleCache.startReadWrite(KEY_1,0);
  assertThat(cacheSpan1.isCached).isFalse();
  assertThat(cacheSpan1.isOpenEnded()).isTrue();
  assertThat(simpleCache.startReadWriteNonBlocking(KEY_1,0)).isNull();
  NavigableSet<CacheSpan> cachedSpans=simpleCache.getCachedSpans(KEY_1);
  assertThat(cachedSpans.isEmpty()).isTrue();
  assertThat(simpleCache.getCacheSpace()).isEqualTo(0);
  assertThat(cacheDir.listFiles()).hasLength(0);
  addCache(simpleCache,KEY_1,0,15);
  Set<String> cachedKeys=simpleCache.getKeys();
  assertThat(cachedKeys).containsExactly(KEY_1);
  cachedSpans=simpleCache.getCachedSpans(KEY_1);
  assertThat(cachedSpans).contains(cacheSpan1);
  assertThat(simpleCache.getCacheSpace()).isEqualTo(15);
  simpleCache.releaseHoleSpan(cacheSpan1);
  CacheSpan cacheSpan2=simpleCache.startReadWrite(KEY_1,0);
  assertThat(cacheSpan2.isCached).isTrue();
  assertThat(cacheSpan2.isOpenEnded()).isFalse();
  assertThat(cacheSpan2.length).isEqualTo(15);
  assertCachedDataReadCorrect(cacheSpan2);
}
