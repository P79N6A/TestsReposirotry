@Test public void testExceptionDuringEvictionByLeastRecentlyUsedCacheEvictorNotHang() throws Exception {
  CachedContentIndex index=Mockito.spy(new CachedContentIndex(cacheDir));
  SimpleCache simpleCache=new SimpleCache(cacheDir,new LeastRecentlyUsedCacheEvictor(20),index);
  CacheSpan cacheSpan=simpleCache.startReadWrite(KEY_1,0);
  addCache(simpleCache,KEY_1,0,15);
  doAnswer(invocation -> {
    throw new CacheException("SimpleCacheTest");
  }
).when(index).store();
  try {
    addCache(simpleCache,KEY_1,15,15);
    assertWithMessage("Exception was expected").fail();
  }
 catch (  CacheException e) {
  }
  simpleCache.releaseHoleSpan(cacheSpan);
  NavigableSet<CacheSpan> cachedSpans=simpleCache.getCachedSpans(KEY_1);
  assertThat(cachedSpans).isNotEmpty();
  assertThat(cachedSpans).hasSize(1);
  assertThat(cachedSpans.pollFirst().position).isEqualTo(15);
}
