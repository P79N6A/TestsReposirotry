@Test public void testReloadCacheWithoutRelease() throws Exception {
  SimpleCache simpleCache=getSimpleCache();
  CacheSpan cacheSpan1=simpleCache.startReadWrite(KEY_1,0);
  addCache(simpleCache,KEY_1,0,15);
  simpleCache.releaseHoleSpan(cacheSpan1);
  CacheSpan cacheSpan2=simpleCache.startReadWrite(KEY_2,0);
  addCache(simpleCache,KEY_2,0,15);
  simpleCache.releaseHoleSpan(cacheSpan2);
  simpleCache.removeSpan(simpleCache.getCachedSpans(KEY_2).first());
  File cacheDir2=Util.createTempFile(RuntimeEnvironment.application,"ExoPlayerTest");
  cacheDir2.delete();
  cacheDir.renameTo(cacheDir2);
  simpleCache=new SimpleCache(cacheDir2,new NoOpCacheEvictor());
  CacheSpan cacheSpan3=simpleCache.startReadWrite(KEY_1,0);
  assertCachedDataReadCorrect(cacheSpan3);
  assertThat(simpleCache.getCachedSpans(KEY_2)).isEmpty();
  Util.recursiveDelete(cacheDir2);
}
