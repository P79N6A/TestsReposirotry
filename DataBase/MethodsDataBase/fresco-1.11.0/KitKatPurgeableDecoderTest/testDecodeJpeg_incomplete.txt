@Test public void testDecodeJpeg_incomplete(){
  assumeNotNull(mKitKatPurgeableDecoder);
  when(mFlexByteArrayPool.get(IMAGE_SIZE + 2)).thenReturn(mDecodeBufRef);
  CloseableReference<Bitmap> result=mKitKatPurgeableDecoder.decodeJPEGFromEncodedImage(mEncodedImage,DEFAULT_BITMAP_CONFIG,null,IMAGE_SIZE);
  verify(mFlexByteArrayPool).get(IMAGE_SIZE + 2);
  verifyStatic();
  BitmapFactory.decodeByteArray(same(mDecodeBuf),eq(0),eq(IMAGE_SIZE + 2),argThat(new BitmapFactoryOptionsMatcher()));
  assertEquals((byte)0xff,mDecodeBuf[5]);
  assertEquals((byte)0xd9,mDecodeBuf[6]);
  assertEquals(2,mByteBufferRef.getUnderlyingReferenceTestOnly().getRefCountTestOnly());
  assertEquals(mBitmap,result.get());
  assertTrue(result.isValid());
  assertEquals(1,mBitmapCounter.getCount());
  assertEquals(MockBitmapFactory.DEFAULT_BITMAP_SIZE,mBitmapCounter.getSize());
}
