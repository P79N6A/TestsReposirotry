@Test public void testHierarchy_WithBackgroundAndMultipleOverlays() throws Exception {
  GenericDraweeHierarchy dh=mBuilder.setPlaceholderImage(mPlaceholderImage,ScaleType.CENTER).setRetryImage(mRetryImage,ScaleType.FIT_CENTER).setFailureImage(mFailureImage,ScaleType.FIT_CENTER).setProgressBarImage(mProgressBarImage,ScaleType.CENTER).setActualImageScaleType(ScaleType.CENTER_CROP).setBackground(mBackground).setOverlays(Arrays.asList(mOverlay1,mOverlay2)).build();
  RootDrawable rootDrawable=(RootDrawable)dh.getTopLevelDrawable();
  FadeDrawable fadeDrawable=(FadeDrawable)rootDrawable.getCurrent();
  assertEquals(8,fadeDrawable.getNumberOfLayers());
  assertSame(mBackground,fadeDrawable.getDrawable(0));
  assertScaleTypeAndDrawable(mPlaceholderImage,ScaleType.CENTER,fadeDrawable.getDrawable(1));
  assertActualImageScaleType(ScaleType.CENTER_CROP,null,fadeDrawable.getDrawable(2));
  assertScaleTypeAndDrawable(mProgressBarImage,ScaleType.CENTER,fadeDrawable.getDrawable(3));
  assertScaleTypeAndDrawable(mRetryImage,ScaleType.FIT_CENTER,fadeDrawable.getDrawable(4));
  assertScaleTypeAndDrawable(mFailureImage,ScaleType.FIT_CENTER,fadeDrawable.getDrawable(5));
  assertSame(mOverlay1,fadeDrawable.getDrawable(6));
  assertSame(mOverlay2,fadeDrawable.getDrawable(7));
  verifyCallback(rootDrawable,mBackground);
  verifyCallback(rootDrawable,mPlaceholderImage);
  verifyCallback(rootDrawable,mOverlay2);
}
