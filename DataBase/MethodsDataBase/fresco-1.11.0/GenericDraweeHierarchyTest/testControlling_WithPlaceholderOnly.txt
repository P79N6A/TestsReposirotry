@Test public void testControlling_WithPlaceholderOnly() throws Exception {
  GenericDraweeHierarchy dh=mBuilder.setPlaceholderImage(mPlaceholderImage,null).setActualImageScaleType(null).setFadeDuration(250).build();
  final int placeholderImageIndex=1;
  final int actualImageIndex=2;
  FadeDrawable fadeDrawable=(FadeDrawable)dh.getTopLevelDrawable().getCurrent();
  assertEquals(mPlaceholderImage,fadeDrawable.getDrawable(placeholderImageIndex));
  assertEquals(ForwardingDrawable.class,fadeDrawable.getDrawable(actualImageIndex).getClass());
  ForwardingDrawable actualImageSettableDrawable=(ForwardingDrawable)fadeDrawable.getDrawable(actualImageIndex);
  assertEquals(ColorDrawable.class,actualImageSettableDrawable.getCurrent().getClass());
  assertEquals(true,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(false,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_NONE,fadeDrawable.getTransitionState());
  dh.setImage(mActualImage1,1f,false);
  assertEquals(mActualImage1,actualImageSettableDrawable.getCurrent());
  assertEquals(false,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(true,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_STARTING,fadeDrawable.getTransitionState());
  assertEquals(250,fadeDrawable.getTransitionDuration());
  dh.reset();
  assertEquals(ColorDrawable.class,actualImageSettableDrawable.getCurrent().getClass());
  assertEquals(true,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(false,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_NONE,fadeDrawable.getTransitionState());
  dh.setImage(mActualImage2,1f,true);
  assertEquals(mActualImage2,actualImageSettableDrawable.getCurrent());
  assertEquals(false,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(true,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_NONE,fadeDrawable.getTransitionState());
  dh.reset();
  assertEquals(ColorDrawable.class,actualImageSettableDrawable.getCurrent().getClass());
  assertEquals(true,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(false,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_NONE,fadeDrawable.getTransitionState());
  dh.setRetry(new RuntimeException());
  assertEquals(ColorDrawable.class,actualImageSettableDrawable.getCurrent().getClass());
  assertEquals(true,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(false,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_STARTING,fadeDrawable.getTransitionState());
  assertEquals(250,fadeDrawable.getTransitionDuration());
  dh.reset();
  assertEquals(ColorDrawable.class,actualImageSettableDrawable.getCurrent().getClass());
  assertEquals(true,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(false,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_NONE,fadeDrawable.getTransitionState());
  dh.setFailure(new RuntimeException());
  assertEquals(ColorDrawable.class,actualImageSettableDrawable.getCurrent().getClass());
  assertEquals(true,fadeDrawable.isLayerOn(placeholderImageIndex));
  assertEquals(false,fadeDrawable.isLayerOn(actualImageIndex));
  assertEquals(FadeDrawable.TRANSITION_STARTING,fadeDrawable.getTransitionState());
  assertEquals(250,fadeDrawable.getTransitionDuration());
}
