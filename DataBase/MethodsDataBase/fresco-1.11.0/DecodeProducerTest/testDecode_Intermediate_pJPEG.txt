@Test public void testDecode_Intermediate_pJPEG() throws Exception {
  setupNetworkUri();
  produceResults();
  JobScheduler.JobRunnable jobRunnable=getJobRunnable();
  when(mProgressiveJpegParser.isJpeg()).thenReturn(true);
  when(mProgressiveJpegParser.getBestScanEndOffset()).thenReturn(200);
  when(mProgressiveJpegParser.getBestScanNumber()).thenReturn(PREVIEW_SCAN);
  jobRunnable.run(mEncodedImage,Consumer.NO_FLAGS);
  InOrder inOrder=inOrder(mProducerListener,mImageDecoder);
  inOrder.verify(mProducerListener).onProducerStart(mRequestId,DecodeProducer.PRODUCER_NAME);
  inOrder.verify(mImageDecoder).decode(mEncodedImage,200,ImmutableQualityInfo.of(PREVIEW_SCAN,false,false),IMAGE_DECODE_OPTIONS);
  inOrder.verify(mProducerListener).onProducerFinishWithSuccess(eq(mRequestId),eq(DecodeProducer.PRODUCER_NAME),any(Map.class));
  inOrder.verifyNoMoreInteractions();
}
