@Test public void testCloneOrNull(){
  EncodedImage encodedImage=new EncodedImage(mByteBufferRef);
  encodedImage.setImageFormat(DefaultImageFormats.JPEG);
  encodedImage.setRotationAngle(0);
  encodedImage.setExifOrientation(5);
  encodedImage.setWidth(1);
  encodedImage.setHeight(2);
  encodedImage.setSampleSize(4);
  encodedImage.setBytesRange(BytesRange.toMax(1000));
  EncodedImage encodedImage2=EncodedImage.cloneOrNull(encodedImage);
  assertEquals(3,mByteBufferRef.getUnderlyingReferenceTestOnly().getRefCountTestOnly());
  assertSame(encodedImage.getByteBufferRef().getUnderlyingReferenceTestOnly(),encodedImage2.getByteBufferRef().getUnderlyingReferenceTestOnly());
  assertEquals(encodedImage.getImageFormat(),encodedImage2.getImageFormat());
  assertEquals(encodedImage.getRotationAngle(),encodedImage2.getRotationAngle());
  assertEquals(encodedImage.getExifOrientation(),encodedImage2.getExifOrientation());
  assertEquals(encodedImage.getHeight(),encodedImage2.getHeight());
  assertEquals(encodedImage.getWidth(),encodedImage2.getWidth());
  assertEquals(encodedImage.getSampleSize(),encodedImage2.getSampleSize());
  assertEquals(encodedImage.getBytesRange(),encodedImage2.getBytesRange());
  encodedImage=new EncodedImage(mInputStreamSupplier,100);
  encodedImage.setImageFormat(DefaultImageFormats.JPEG);
  encodedImage.setRotationAngle(0);
  encodedImage.setExifOrientation(5);
  encodedImage.setWidth(1);
  encodedImage.setHeight(2);
  encodedImage2=EncodedImage.cloneOrNull(encodedImage);
  assertSame(encodedImage.getInputStream(),encodedImage2.getInputStream());
  assertEquals(encodedImage2.getSize(),encodedImage.getSize());
}
