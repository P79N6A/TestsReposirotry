/** 
 * Test to make sure that the same item stored with two different versions of the cache will be stored with two different file names.
 * @throws UnsupportedEncodingException
 */
@Test public void testVersioning() throws IOException {
  CacheKey key=new SimpleCacheKey("version_test");
  byte[] value=new byte[32];
  value[0]='v';
  DiskStorage storage1=createDiskStorage(TESTCACHE_CURRENT_VERSION);
  DiskStorageCache cache1=createDiskCache(storage1,false);
  cache1.insert(key,WriterCallbacks.from(value));
  BinaryResource resource1=getResource(storage1,key);
  assertNotNull(resource1);
  DiskStorage storageSupplier2=createDiskStorage(TESTCACHE_NEXT_VERSION);
  DiskStorageCache cache2=createDiskCache(storageSupplier2,false);
  cache2.insert(key,WriterCallbacks.from(value));
  BinaryResource resource2=getResource(storageSupplier2,key);
  assertNotNull(resource2);
  assertFalse(resource2.equals(resource1));
}
