@Test public void testCacheEventListener() throws Exception {
  CacheKey key1=new SimpleCacheKey("foo");
  int value1Size=101;
  byte[] value1=new byte[value1Size];
  value1[80]='c';
  BinaryResource resource1=mCache.insert(key1,WriterCallbacks.from(value1));
  verifyListenerOnWriteAttempt(key1);
  String resourceId1=verifyListenerOnWriteSuccessAndGetResourceId(key1,value1Size);
  BinaryResource resource1Again=mCache.getResource(key1);
  assertEquals(resource1,resource1Again);
  verifyListenerOnHit(key1,resourceId1);
  BinaryResource resource1Again2=mCache.getResource(key1);
  assertEquals(resource1,resource1Again2);
  verifyListenerOnHit(key1,resourceId1);
  SimpleCacheKey missingKey=new SimpleCacheKey("nonexistent_key");
  BinaryResource res2=mCache.getResource(missingKey);
  assertNull(res2);
  verifyListenerOnMiss(missingKey);
  mCache.clearAll();
  verify(mCacheEventListener).onCleared();
  verifyNoMoreInteractions(mCacheEventListener);
}
