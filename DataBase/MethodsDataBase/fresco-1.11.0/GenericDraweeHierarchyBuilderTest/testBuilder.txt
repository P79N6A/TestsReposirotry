@Test public void testBuilder() throws Exception {
  GenericDraweeHierarchyBuilder builder=new GenericDraweeHierarchyBuilder(null);
  testInitialState(builder);
  builder.setFadeDuration(100);
  assertEquals(100,builder.getFadeDuration());
  builder.setDesiredAspectRatio(1.33f);
  assertEquals(1.33f,builder.getDesiredAspectRatio(),0);
  builder.setPlaceholderImage(mPlaceholderDrawable1);
  builder.setRetryImage(mRetryDrawable1);
  builder.setFailureImage(mFailureDrawable1);
  builder.setProgressBarImage(mProgressBarDrawable1);
  assertEquals(mPlaceholderDrawable1,builder.getPlaceholderImage());
  assertEquals(ScaleType.CENTER_INSIDE,builder.getPlaceholderImageScaleType());
  assertEquals(mRetryDrawable1,builder.getRetryImage());
  assertEquals(ScaleType.CENTER_INSIDE,builder.getRetryImageScaleType());
  assertEquals(mFailureDrawable1,builder.getFailureImage());
  assertEquals(ScaleType.CENTER_INSIDE,builder.getFailureImageScaleType());
  assertEquals(mProgressBarDrawable1,builder.getProgressBarImage());
  assertEquals(ScaleType.CENTER_INSIDE,builder.getProgressBarImageScaleType());
  builder.setPlaceholderImage(mPlaceholderDrawable2,ScaleType.CENTER);
  builder.setRetryImage(mRetryDrawable2,ScaleType.FIT_CENTER);
  builder.setFailureImage(mFailureDrawable2,ScaleType.FIT_END);
  builder.setProgressBarImage(mProgressBarDrawable2,ScaleType.CENTER_CROP);
  assertEquals(mPlaceholderDrawable2,builder.getPlaceholderImage());
  assertEquals(ScaleType.CENTER,builder.getPlaceholderImageScaleType());
  assertEquals(mRetryDrawable2,builder.getRetryImage());
  assertEquals(ScaleType.FIT_CENTER,builder.getRetryImageScaleType());
  assertEquals(mFailureDrawable2,builder.getFailureImage());
  assertEquals(ScaleType.FIT_END,builder.getFailureImageScaleType());
  assertEquals(mProgressBarDrawable2,builder.getProgressBarImage());
  assertEquals(ScaleType.CENTER_CROP,builder.getProgressBarImageScaleType());
  builder.setPlaceholderImage(mPlaceholderDrawable1);
  builder.setRetryImage(mRetryDrawable1);
  builder.setFailureImage(mFailureDrawable1);
  builder.setProgressBarImage(mProgressBarDrawable1);
  assertEquals(mPlaceholderDrawable1,builder.getPlaceholderImage());
  assertEquals(ScaleType.CENTER,builder.getPlaceholderImageScaleType());
  assertEquals(mRetryDrawable1,builder.getRetryImage());
  assertEquals(ScaleType.FIT_CENTER,builder.getRetryImageScaleType());
  assertEquals(mFailureDrawable1,builder.getFailureImage());
  assertEquals(ScaleType.FIT_END,builder.getFailureImageScaleType());
  assertEquals(mProgressBarDrawable1,builder.getProgressBarImage());
  assertEquals(ScaleType.CENTER_CROP,builder.getProgressBarImageScaleType());
  builder.setActualImageScaleType(ScaleType.FIT_START);
  assertEquals(ScaleType.FIT_START,builder.getActualImageScaleType());
  builder.setActualImageFocusPoint(mFocusPoint);
  AndroidGraphicsTestUtils.assertEquals(mFocusPoint,builder.getActualImageFocusPoint(),0f);
  builder.setActualImageScaleType(ScaleType.FOCUS_CROP);
  assertSame(ScaleType.FOCUS_CROP,builder.getActualImageScaleType());
  builder.setOverlays(Arrays.asList(mOverlayDrawable1,mOverlayDrawable2));
  assertArrayEquals(builder.getOverlays().toArray(),new Drawable[]{mOverlayDrawable1,mOverlayDrawable2});
  builder.setBackground(mBackgroundDrawable2);
  builder.setOverlay(mOverlayDrawable2);
  builder.setPressedStateOverlay(mPressedStateDrawable);
  assertSame(builder.getBackground(),mBackgroundDrawable2);
  assertArrayEquals(builder.getOverlays().toArray(),new Drawable[]{mOverlayDrawable2});
  assertEquals(builder.getPressedStateOverlay().getClass(),StateListDrawable.class);
  builder.setBackground(null);
  assertNull(builder.getBackground());
  builder.setOverlay(null);
  assertNull(builder.getOverlays());
  builder.setPressedStateOverlay(null);
  assertNull(builder.getPressedStateOverlay());
  builder.setRoundingParams(mRoundingParams);
  assertEquals(mRoundingParams,builder.getRoundingParams());
  builder.reset();
  testInitialState(builder);
}
