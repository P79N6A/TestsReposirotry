/** 
 * Interleaved results.
 */
@Test public void testLifecycle_I3_I2_I3_S2_I1_S1_C(){
  DataSource<Object> dataSource=getAndSubscribe();
  DataSubscriber<Object> subscriber1=verifyGetAndSubscribeM(mDataSourceSupplier1,mSrc1);
  DataSubscriber<Object> subscriber2=verifyGetAndSubscribeM(mDataSourceSupplier2,mSrc2);
  DataSubscriber<Object> subscriber3=verifyGetAndSubscribe(mDataSourceSupplier3,mSrc3);
  Object val3a=mock(Object.class);
  setState(mSrc3,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val3a,NOT_FAILED,null);
  subscriber3.onNewResult(mSrc3);
  verifySubscriber(dataSource,mSrc3,ON_NEW_RESULT);
  verifyState(dataSource,mSrc3,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val3a,NOT_FAILED,null);
  Object val2a=mock(Object.class);
  setState(mSrc2,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val2a,NOT_FAILED,null);
  subscriber2.onNewResult(mSrc2);
  verifySubscriber(dataSource,mSrc2,NO_INTERACTIONS);
  verifyState(dataSource,mSrc3,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val3a,NOT_FAILED,null);
  Object val3b=mock(Object.class);
  setState(mSrc3,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val3b,NOT_FAILED,null);
  subscriber3.onNewResult(mSrc3);
  verifySubscriber(dataSource,mSrc3,ON_NEW_RESULT);
  verifyState(dataSource,mSrc3,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val3b,NOT_FAILED,null);
  Object val2b=mock(Object.class);
  setState(mSrc2,NOT_CLOSED,FINISHED,WITH_RESULT,val2b,NOT_FAILED,null);
  subscriber2.onNewResult(mSrc2);
  mInOrder.verify(mSrc3).close();
  verifySubscriber(dataSource,mSrc2,ON_NEW_RESULT);
  verifyState(dataSource,mSrc2,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val2b,NOT_FAILED,null);
  Object val1a=mock(Object.class);
  setState(mSrc1,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val1a,NOT_FAILED,null);
  subscriber1.onNewResult(mSrc1);
  verifySubscriber(dataSource,mSrc1,NO_INTERACTIONS);
  verifyState(dataSource,mSrc2,NOT_CLOSED,NOT_FINISHED,WITH_RESULT,val2b,NOT_FAILED,null);
  Object val1b=mock(Object.class);
  setState(mSrc1,NOT_CLOSED,FINISHED,WITH_RESULT,val1b,NOT_FAILED,null);
  subscriber1.onNewResult(mSrc1);
  mInOrder.verify(mSrc2).close();
  verifySubscriber(dataSource,mSrc1,ON_NEW_RESULT);
  verifyState(dataSource,mSrc1,NOT_CLOSED,FINISHED,WITH_RESULT,val1b,NOT_FAILED,null);
  testClose(dataSource,mSrc1);
  verifyState(dataSource,null,CLOSED,FINISHED,WITHOUT_RESULT,null,NOT_FAILED,null);
}
