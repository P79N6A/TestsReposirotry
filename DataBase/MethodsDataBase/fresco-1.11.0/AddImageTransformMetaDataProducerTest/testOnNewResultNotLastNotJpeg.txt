@Test public void testOnNewResultNotLastNotJpeg(){
  when(ImageFormatChecker.getImageFormat_WrapIOException(any(InputStream.class))).thenReturn(DefaultImageFormats.WEBP_SIMPLE);
  when(BitmapUtil.decodeDimensions(any(InputStream.class))).thenReturn(null);
  mAddMetaDataConsumer.onNewResult(mIntermediateResult,Consumer.NO_FLAGS);
  ArgumentCaptor<EncodedImage> argumentCaptor=ArgumentCaptor.forClass(EncodedImage.class);
  verify(mConsumer).onNewResult(argumentCaptor.capture(),eq(Consumer.NO_FLAGS));
  EncodedImage encodedImage=argumentCaptor.getValue();
  assertTrue(EncodedImage.isValid(encodedImage));
  assertEquals(DefaultImageFormats.WEBP_SIMPLE,encodedImage.getImageFormat());
  assertEquals(0,encodedImage.getRotationAngle());
  assertEquals(-1,encodedImage.getWidth());
  assertEquals(-1,encodedImage.getHeight());
}
