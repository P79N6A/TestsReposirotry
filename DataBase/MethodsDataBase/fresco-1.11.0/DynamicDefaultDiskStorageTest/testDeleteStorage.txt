@Test public void testDeleteStorage() throws Exception {
  DynamicDefaultDiskStorage storage=createInternalCacheDirStorage();
  Assert.assertNull(storage.mCurrentState.delegate);
  storage.deleteOldStorageIfNecessary();
  storage.get();
  File versionDir=getStorageSubdirectory(new File(mContext.getCacheDir(),mBaseDirectoryName),mVersion);
  Assert.assertTrue(versionDir.exists());
  File dummyFile=new File(versionDir,"dummy");
  Assert.assertTrue(dummyFile.createNewFile());
  Assert.assertTrue(dummyFile.exists());
  storage.deleteOldStorageIfNecessary();
  Assert.assertFalse(dummyFile.exists());
  Assert.assertFalse(versionDir.exists());
  Assert.assertFalse(versionDir.getParentFile().exists());
}
