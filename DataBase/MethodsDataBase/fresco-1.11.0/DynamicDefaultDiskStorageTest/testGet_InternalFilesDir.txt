@Test public void testGet_InternalFilesDir() throws Exception {
  File dir=mContext.getFilesDir();
  DynamicDefaultDiskStorage supplier=createInternalFilesDirStorage();
  Assert.assertNull(supplier.mCurrentState.delegate);
  DiskStorage storage=supplier.get();
  Assert.assertEquals(storage,supplier.mCurrentState.delegate);
  Assert.assertTrue(storage instanceof DefaultDiskStorage);
  File baseDir=new File(dir,mBaseDirectoryName);
  Assert.assertTrue(baseDir.exists());
  Assert.assertTrue(getStorageSubdirectory(baseDir,1).exists());
  DiskStorage storage2=supplier.get();
  Assert.assertEquals(storage,storage2);
  File baseDirOrig=baseDir.getAbsoluteFile();
  Assert.assertTrue(baseDirOrig.renameTo(new File(dir,"dummydir")));
  DiskStorage storage3=supplier.get();
  Assert.assertNotSame(storage,storage3);
  Assert.assertTrue(storage3 instanceof DefaultDiskStorage);
  Assert.assertTrue(baseDir.exists());
  Assert.assertTrue(getStorageSubdirectory(baseDir,1).exists());
}
