@Test public void testAddConsumerChangesIsIntermediateResultExpectedIfNeeded(){
  mProducerContext1.setIsIntermediateResultExpected(false);
  mProducerContext2.setIsIntermediateResultExpected(true);
  mMultiplexProducer.produceResults(mConsumer1,mProducerContext1);
  assertFalse(mMultiplexedContext1.isIntermediateResultExpected());
  ProducerContextCallbacks callbacks=mock(ProducerContextCallbacks.class);
  mMultiplexedContext1.addCallbacks(callbacks);
  mMultiplexProducer.produceResults(mConsumer1,mProducerContext2);
  assertTrue(mMultiplexedContext1.isIntermediateResultExpected());
  verify(callbacks).onIsIntermediateResultExpectedChanged();
}
