@Test public void testFetchFromBitmapCacheDueToImageRequest(){
  Producer<CloseableReference<CloseableImage>> bitmapCacheSequence=mock(Producer.class);
  when(mImageRequest.getLowestPermittedRequestLevel()).thenReturn(ImageRequest.RequestLevel.BITMAP_MEMORY_CACHE);
  when(mProducerSequenceFactory.getDecodedImageProducerSequence(mImageRequest)).thenReturn(bitmapCacheSequence);
  mImagePipeline.fetchDecodedImage(mImageRequest,mCallerContext);
  verify(mRequestListener1).onRequestStart(mImageRequest,mCallerContext,"0",false);
  verify(mRequestListener2).onRequestStart(mImageRequest,mCallerContext,"0",false);
  ArgumentCaptor<ProducerContext> producerContextArgumentCaptor=ArgumentCaptor.forClass(ProducerContext.class);
  verify(bitmapCacheSequence).produceResults(any(Consumer.class),producerContextArgumentCaptor.capture());
  assertTrue(producerContextArgumentCaptor.getValue().isIntermediateResultExpected());
  assertEquals(producerContextArgumentCaptor.getValue().getPriority(),Priority.HIGH);
  assertEquals(producerContextArgumentCaptor.getValue().getLowestPermittedRequestLevel(),ImageRequest.RequestLevel.BITMAP_MEMORY_CACHE);
}
