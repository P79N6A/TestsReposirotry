@Test public void testOnSuccess_extraMap() throws IOException {
  doReturn(true).when(mProducerListener).requiresExtraMap(REQUEST_ID);
  doReturn(mResult).when(mResultSupplier).get();
  mStatefulProducerRunnable.run();
  verify(mConsumer).onNewResult(mResult,Consumer.IS_LAST);
  verify(mProducerListener).onProducerStart(REQUEST_ID,PRODUCER_NAME);
  verify(mProducerListener).onProducerFinishWithSuccess(REQUEST_ID,PRODUCER_NAME,mSuccessMap);
  verify(mProducerListener,never()).onUltimateProducerReached(anyString(),anyString(),anyBoolean());
  verify(mResult).close();
}
