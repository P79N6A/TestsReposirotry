@Test public void testDoesResizeIfJpegAndResizingEnabled() throws Exception {
  whenResizingEnabled();
  final int preferredWidth=300;
  final int preferredHeight=600;
  whenRequestWidthAndHeight(preferredWidth,preferredHeight);
  whenRequestSpecificRotation(RotationOptions.NO_ROTATION);
  provideIntermediateResult(DefaultImageFormats.JPEG,preferredWidth * 2,preferredHeight * 2,0,ExifInterface.ORIENTATION_NORMAL);
  verifyNoIntermediateResultPassedThrough();
  provideFinalResult(DefaultImageFormats.JPEG,preferredWidth * 2,preferredHeight * 2,0,ExifInterface.ORIENTATION_NORMAL);
  verifyAFinalResultPassedThroughResized();
  assertEquals(2,mFinalResult.getUnderlyingReferenceTestOnly().getRefCountTestOnly());
  assertTrue(mPooledByteBuffer.isClosed());
  verifyJpegTranscoderInteractions(4,0);
}
