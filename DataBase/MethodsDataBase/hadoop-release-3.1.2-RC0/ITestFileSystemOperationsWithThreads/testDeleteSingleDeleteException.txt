@Test public void testDeleteSingleDeleteException() throws Exception {
  NativeAzureFileSystem mockFs=Mockito.spy((NativeAzureFileSystem)fs);
  String path=mockFs.pathToKey(mockFs.makeAbsolute(new Path("root/0")));
  Mockito.doThrow(new IOException()).when(mockFs).deleteFile(path,true);
  createFolder(mockFs,"root");
  Path sourceFolder=new Path("root");
  boolean exception=false;
  try {
    mockFs.delete(sourceFolder,true);
  }
 catch (  IOException e) {
    exception=true;
  }
  assertTrue(exception);
  assertTrue(mockFs.exists(sourceFolder));
  String content=logs.getOutput();
  assertInLog(content,"Using thread pool for Delete operation with threads");
  assertInLog(content,"Encountered Exception for Delete operation for file " + path);
  assertInLog(content,"Terminating execution of Delete operation now as some other thread already got exception or operation failed");
}
