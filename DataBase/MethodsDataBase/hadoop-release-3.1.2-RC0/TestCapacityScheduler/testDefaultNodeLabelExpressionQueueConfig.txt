@Test public void testDefaultNodeLabelExpressionQueueConfig() throws Exception {
  CapacityScheduler cs=new CapacityScheduler();
  CapacitySchedulerConfiguration conf=new CapacitySchedulerConfiguration();
  setupQueueConfiguration(conf);
  conf.setDefaultNodeLabelExpression("root.a"," x");
  conf.setDefaultNodeLabelExpression("root.b"," y ");
  cs.setConf(new YarnConfiguration());
  cs.setRMContext(resourceManager.getRMContext());
  cs.init(conf);
  cs.start();
  QueueInfo queueInfoA=cs.getQueueInfo("a",true,false);
  Assert.assertEquals("Queue Name should be a","a",queueInfoA.getQueueName());
  Assert.assertEquals("Default Node Label Expression should be x","x",queueInfoA.getDefaultNodeLabelExpression());
  QueueInfo queueInfoB=cs.getQueueInfo("b",true,false);
  Assert.assertEquals("Queue Name should be b","b",queueInfoB.getQueueName());
  Assert.assertEquals("Default Node Label Expression should be y","y",queueInfoB.getDefaultNodeLabelExpression());
}
