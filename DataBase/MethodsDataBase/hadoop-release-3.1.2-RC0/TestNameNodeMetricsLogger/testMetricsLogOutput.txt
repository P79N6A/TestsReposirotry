/** 
 * Publish a fake metric under the "Hadoop:" domain and ensure it is logged by the metrics logger.
 */
@Test public void testMetricsLogOutput() throws IOException, InterruptedException, TimeoutException {
  TestFakeMetric metricsProvider=new TestFakeMetric();
  MBeans.register(this.getClass().getSimpleName(),"DummyMetrics",metricsProvider);
  makeNameNode(true);
  final PatternMatchingAppender appender=new PatternMatchingAppender("^.*FakeMetric42.*$");
  addAppender(NameNode.MetricsLog,appender);
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      return appender.isMatched();
    }
  }
,1000,60000);
}
