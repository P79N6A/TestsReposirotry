@Test public void testKerberosTicketIsDestroyedChecked() throws Exception {
  GenericTestUtils.setLogLevel(UserGroupInformation.LOG,Level.DEBUG);
  Set<User> users=new HashSet<>();
  users.add(new User("Foo"));
  Subject subject=new Subject(true,users,new HashSet<>(),new HashSet<>());
  UserGroupInformation ugi=spy(new UserGroupInformation(subject));
  doThrow(new IOException()).when(ugi).reloginFromTicketCache();
  Date d=new Date();
  KerberosPrincipal kp=new KerberosPrincipal("Foo");
  KerberosTicket tgt=spy(new KerberosTicket(new byte[]{},kp,kp,new byte[]{},0,null,d,d,d,d,null));
  tgt.destroy();
  UserGroupInformation.AutoRenewalForUserCredsRunnable userCredsRunnable=ugi.new AutoRenewalForUserCredsRunnable(tgt,Boolean.toString(Boolean.TRUE),100);
  userCredsRunnable.setRunRenewalLoop(false);
  userCredsRunnable.run();
  Mockito.verify(tgt,atLeastOnce()).isDestroyed();
}
