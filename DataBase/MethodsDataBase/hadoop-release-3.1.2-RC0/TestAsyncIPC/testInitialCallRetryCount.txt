/** 
 * Test if the rpc server gets the default retry count (0) from client.
 * @throws ExecutionException
 * @throws InterruptedException
 */
@Test(timeout=60000) public void testInitialCallRetryCount() throws IOException, InterruptedException, ExecutionException {
  final Client client=new Client(LongWritable.class,conf);
  final TestServer server=new TestIPC.TestServer(1,false,conf);
  server.callListener=new Runnable(){
    @Override public void run(){
      Assert.assertEquals(0,Server.getCallRetryCount());
    }
  }
;
  try {
    InetSocketAddress addr=NetUtils.getConnectAddress(server);
    server.start();
    final AsyncCaller caller=new AsyncCaller(client,addr,10);
    caller.run();
    caller.assertReturnValues();
  }
  finally {
    client.stop();
    server.stop();
  }
}
