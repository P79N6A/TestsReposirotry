/** 
 * This testcase tests whether the value returned by DFSUtil.getReplWorkMultiplier() is positive, and whether an IllegalArgumentException will be thrown  when a non-positive value is retrieved
 */
@Test public void testGetReplWorkMultiplier(){
  Configuration conf=new Configuration();
  int blocksReplWorkMultiplier=DFSUtil.getReplWorkMultiplier(conf);
  assertTrue(blocksReplWorkMultiplier > 0);
  conf.set(DFSConfigKeys.DFS_NAMENODE_REPLICATION_WORK_MULTIPLIER_PER_ITERATION,"3");
  blocksReplWorkMultiplier=DFSUtil.getReplWorkMultiplier(conf);
  assertEquals(blocksReplWorkMultiplier,3);
  conf.set(DFSConfigKeys.DFS_NAMENODE_REPLICATION_WORK_MULTIPLIER_PER_ITERATION,"-1");
  exception.expect(IllegalArgumentException.class);
  blocksReplWorkMultiplier=DFSUtil.getReplWorkMultiplier(conf);
}
