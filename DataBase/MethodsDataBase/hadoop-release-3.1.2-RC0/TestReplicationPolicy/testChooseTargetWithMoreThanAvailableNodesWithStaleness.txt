/** 
 * In this testcase, it tries to choose more targets than available nodes and check the result, with stale node avoidance on the write path enabled.
 * @throws Exception
 */
@Test public void testChooseTargetWithMoreThanAvailableNodesWithStaleness() throws Exception {
  try {
    namenode.getNamesystem().getBlockManager().getDatanodeManager().setNumStaleNodes(dataNodes.length);
    testChooseTargetWithMoreThanAvailableNodes();
  }
  finally {
    namenode.getNamesystem().getBlockManager().getDatanodeManager().setNumStaleNodes(0);
  }
}
