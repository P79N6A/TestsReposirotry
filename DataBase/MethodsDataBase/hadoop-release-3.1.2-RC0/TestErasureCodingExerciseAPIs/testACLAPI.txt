/** 
 * FileSystem.[getAclStatus, modifyAclEntries, removeAclEntries, removeAcl removeDefaultAcl] API call should succeed without failure.
 * @throws IOException if any IO operation failed.
 */
@Test public void testACLAPI() throws IOException {
  Path p=new Path("/aclTest");
  fs.mkdirs(p,FsPermission.createImmutable((short)0750));
  List<AclEntry> aclSpec=Lists.newArrayList(aclEntry(DEFAULT,USER,ALL),aclEntry(DEFAULT,USER,"foo",ALL),aclEntry(DEFAULT,GROUP,READ_EXECUTE),aclEntry(DEFAULT,OTHER,NONE));
  fs.setAcl(p,aclSpec);
  AclStatus as=fs.getAclStatus(p);
  for (  AclEntry entry : aclSpec) {
    assertTrue(String.format("as: %s, entry: %s",as,entry),as.getEntries().contains(entry));
  }
  List<AclEntry> maclSpec=Lists.newArrayList(aclEntry(ACCESS,USER,"bar",READ_EXECUTE),aclEntry(DEFAULT,USER,"bar",READ_EXECUTE));
  fs.modifyAclEntries(p,maclSpec);
  as=fs.getAclStatus(p);
  for (  AclEntry entry : maclSpec) {
    assertTrue(String.format("as: %s, entry: %s",as,entry),as.getEntries().contains(entry));
  }
  fs.removeAclEntries(p,maclSpec);
  fs.removeDefaultAcl(p);
  fs.removeAcl(p);
  assertEquals(0,fs.getAclStatus(p).getEntries().size());
}
