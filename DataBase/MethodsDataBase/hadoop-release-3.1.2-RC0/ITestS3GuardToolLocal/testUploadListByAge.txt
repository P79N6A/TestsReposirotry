@Test public void testUploadListByAge() throws Throwable {
  S3AFileSystem fs=getFileSystem();
  Path path=path(UPLOAD_PREFIX + "/" + UPLOAD_NAME);
  describe("Cleaning up any leftover uploads from previous runs.");
  clearAnyUploads(fs,path);
  describe("Uploading single part.");
  createPartUpload(fs,fs.pathToKey(path),128,1);
  try {
    LambdaTestUtils.eventually(5000,1000,() -> {
      assertEquals("Should be one upload",1,countUploadsAt(fs,path));
    }
);
    describe("Confirming CLI older age doesn't list");
    assertNumUploadsAge(path,0,600);
    describe("Confirming CLI older age doesn't delete");
    uploadCommandAssertCount(fs,ABORT_FORCE_OPTIONS,path,0,600);
    describe("Sleeping 1 second then confirming upload still there");
    Thread.sleep(1000);
    LambdaTestUtils.eventually(5000,1000,() -> {
      assertNumUploadsAge(path,1,1);
    }
);
    describe("Doing aged deletion");
    uploadCommandAssertCount(fs,ABORT_FORCE_OPTIONS,path,1,1);
    describe("Confirming age deletion happened");
    assertEquals("Should be no uploads",0,countUploadsAt(fs,path));
  }
 catch (  Throwable t) {
    clearAnyUploads(fs,path);
    throw t;
  }
}
