@Test(timeout=3000000) public void testAllocateResponseIdOverflow() throws Exception {
  MockRM rm=new MockRM(conf);
  try {
    rm.start();
    MockNM nm1=rm.registerNode("127.0.0.1:1234",6 * GB);
    RMApp app1=rm.submitApp(2048);
    nm1.nodeHeartbeat(true);
    RMAppAttempt attempt1=app1.getCurrentAppAttempt();
    MockAM am1=rm.sendAMLaunched(attempt1.getAppAttemptId());
    am1.registerAppAttempt();
    Assert.assertTrue(am1.setApplicationLastResponseId(Integer.MAX_VALUE));
    am1.schedule();
    Assert.assertEquals(0,am1.getResponseId());
    am1.schedule();
    Assert.assertEquals(1,am1.getResponseId());
  }
  finally {
    if (rm != null) {
      rm.stop();
    }
  }
}
