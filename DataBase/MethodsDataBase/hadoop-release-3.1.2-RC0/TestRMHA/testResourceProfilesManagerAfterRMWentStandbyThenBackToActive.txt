@Test public void testResourceProfilesManagerAfterRMWentStandbyThenBackToActive() throws Exception {
  configuration.setBoolean(YarnConfiguration.AUTO_FAILOVER_ENABLED,false);
  configuration.setBoolean(YarnConfiguration.RECOVERY_ENABLED,true);
  Configuration conf=new YarnConfiguration(configuration);
  conf.set(YarnConfiguration.RM_STORE,MemoryRMStateStore.class.getName());
  rm=new MockRM(conf);
  rm.init(conf);
  rm.start();
  StateChangeRequestInfo requestInfo=new StateChangeRequestInfo(HAServiceProtocol.RequestSource.REQUEST_BY_USER);
  checkMonitorHealth();
  checkStandbyRMFunctionality();
  rm.adminService.transitionToActive(requestInfo);
  checkMonitorHealth();
  checkActiveRMFunctionality();
  rm.adminService.transitionToStandby(requestInfo);
  checkMonitorHealth();
  checkStandbyRMFunctionality();
  rm.adminService.transitionToActive(requestInfo);
  checkMonitorHealth();
  checkActiveRMFunctionality();
  Assert.assertNotNull("ResourceProfilesManager should not be null!",rm.getRMContext().getResourceProfilesManager());
}
