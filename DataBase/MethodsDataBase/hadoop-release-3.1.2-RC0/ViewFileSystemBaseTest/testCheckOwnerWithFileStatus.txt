@Test public void testCheckOwnerWithFileStatus() throws IOException, InterruptedException {
  final UserGroupInformation userUgi=UserGroupInformation.createUserForTesting("user@HADOOP.COM",new String[]{"hadoop"});
  userUgi.doAs(new PrivilegedExceptionAction<Object>(){
    @Override public Object run() throws IOException {
      UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
      String doAsUserName=ugi.getUserName();
      assertEquals(doAsUserName,"user@HADOOP.COM");
      FileSystem vfs=FileSystem.get(FsConstants.VIEWFS_URI,conf);
      FileStatus stat=vfs.getFileStatus(new Path("/internalDir"));
      assertEquals(userUgi.getShortUserName(),stat.getOwner());
      return null;
    }
  }
);
}
