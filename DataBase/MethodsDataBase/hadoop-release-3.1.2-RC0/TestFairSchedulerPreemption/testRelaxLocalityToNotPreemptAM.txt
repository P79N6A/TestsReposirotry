@Test public void testRelaxLocalityToNotPreemptAM() throws Exception {
  takeAllResources("root.preemptable.child-1");
  RMNode node1=rmNodes.get(0);
  setAllAMContainersOnNode(node1.getNodeID());
  SchedulerNode node=scheduler.getNodeTracker().getNode(node1.getNodeID());
  ApplicationAttemptId greedyAppAttemptId=node.getCopiedListOfRunningContainers().get(0).getApplicationAttemptId();
  ResourceRequest nodeRequest=createResourceRequest(GB,node1.getHostName(),1,4,true);
  ResourceRequest rackRequest=createResourceRequest(GB * 10,node1.getRackName(),1,1,true);
  ResourceRequest anyRequest=createResourceRequest(GB * 10,ResourceRequest.ANY,1,1,true);
  List<ResourceRequest> resourceRequests=Arrays.asList(nodeRequest,rackRequest,anyRequest);
  ApplicationAttemptId starvedAppAttemptId=createSchedulingRequest("root.preemptable.child-2","default",resourceRequests);
  starvingApp=scheduler.getSchedulerApp(starvedAppAttemptId);
  clock.tickSec(1);
  scheduler.update();
  verifyPreemption(0,4);
  for (  RMContainer container : node.getCopiedListOfRunningContainers()) {
    assert (container.isAMContainer());
    assert (container.getApplicationAttemptId().equals(greedyAppAttemptId));
  }
}
