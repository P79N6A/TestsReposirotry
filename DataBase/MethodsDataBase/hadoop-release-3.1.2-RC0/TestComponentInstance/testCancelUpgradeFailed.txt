@Test public void testCancelUpgradeFailed() throws Exception {
  ServiceContext context=TestComponent.createTestContext(rule,"testCancelUpgradeFailed");
  Component component=context.scheduler.getAllComponents().entrySet().iterator().next().getValue();
  cancelCompUpgrade(component);
  ComponentInstance instance=component.getAllComponentInstances().iterator().next();
  ComponentInstanceEvent cancelEvent=new ComponentInstanceEvent(instance.getContainer().getId(),ComponentInstanceEventType.CANCEL_UPGRADE);
  instance.handle(cancelEvent);
  instance.handle(new ComponentInstanceEvent(instance.getContainer().getId(),ComponentInstanceEventType.STOP));
  Assert.assertEquals("instance not init",ComponentInstanceState.INIT,instance.getState());
}
