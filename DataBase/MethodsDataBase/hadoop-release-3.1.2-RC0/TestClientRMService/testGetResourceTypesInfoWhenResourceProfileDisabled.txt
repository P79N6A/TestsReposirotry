@Test public void testGetResourceTypesInfoWhenResourceProfileDisabled() throws Exception {
  YarnConfiguration conf=new YarnConfiguration();
  MockRM rm=new MockRM(conf){
    protected ClientRMService createClientRMService(){
      return new ClientRMService(this.rmContext,scheduler,this.rmAppManager,this.applicationACLsManager,this.queueACLsManager,this.getRMContext().getRMDelegationTokenSecretManager());
    }
  }
;
  rm.start();
  YarnRPC rpc=YarnRPC.create(conf);
  InetSocketAddress rmAddress=rm.getClientRMService().getBindAddress();
  LOG.info("Connecting to ResourceManager at " + rmAddress);
  ApplicationClientProtocol client=(ApplicationClientProtocol)rpc.getProxy(ApplicationClientProtocol.class,rmAddress,conf);
  GetAllResourceTypeInfoRequest request=GetAllResourceTypeInfoRequest.newInstance();
  GetAllResourceTypeInfoResponse response=client.getResourceTypeInfo(request);
  Assert.assertEquals(2,response.getResourceTypeInfo().size());
  Assert.assertEquals(ResourceInformation.MEMORY_MB.getName(),response.getResourceTypeInfo().get(0).getName());
  Assert.assertEquals(ResourceInformation.MEMORY_MB.getUnits(),response.getResourceTypeInfo().get(0).getDefaultUnit());
  Assert.assertEquals(ResourceInformation.VCORES.getName(),response.getResourceTypeInfo().get(1).getName());
  Assert.assertEquals(ResourceInformation.VCORES.getUnits(),response.getResourceTypeInfo().get(1).getDefaultUnit());
  rm.stop();
  rpc.stopProxy(client,conf);
}
