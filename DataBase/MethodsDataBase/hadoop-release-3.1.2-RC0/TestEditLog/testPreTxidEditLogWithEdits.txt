/** 
 * Test case for loading a very simple edit log from a format prior to the inclusion of edit transaction IDs in the log.
 */
@Test public void testPreTxidEditLogWithEdits() throws Exception {
  Configuration conf=getConf();
  MiniDFSCluster cluster=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(0).build();
    cluster.waitActive();
    final FSNamesystem namesystem=cluster.getNamesystem();
    long numEdits=testLoad(HADOOP20_SOME_EDITS,namesystem);
    assertEquals(3,numEdits);
    HdfsFileStatus fileInfo=namesystem.getFileInfo("/myfile",false,false,false);
    assertEquals("supergroup",fileInfo.getGroup());
    assertEquals(3,fileInfo.getReplication());
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}
