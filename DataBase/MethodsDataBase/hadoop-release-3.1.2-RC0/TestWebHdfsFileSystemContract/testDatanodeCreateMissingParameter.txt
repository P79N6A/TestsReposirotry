@Test public void testDatanodeCreateMissingParameter() throws IOException {
  final WebHdfsFileSystem webhdfs=(WebHdfsFileSystem)fs;
  final Path testDir=new Path(MessageFormat.format("/test/{0}/{1}",TestWebHdfsFileSystemContract.class,GenericTestUtils.getMethodName()));
  assertTrue(webhdfs.mkdirs(testDir));
  for (  String dnCreateParam : new String[]{CreateFlagParam.NAME,CreateParentParam.NAME,OverwriteParam.NAME}) {
    final HttpOpParam.Op op=PutOpParam.Op.CREATE;
    final Path newfile=new Path(testDir,"newfile_" + dnCreateParam);
    final URL url=webhdfs.toUrl(op,newfile);
    HttpURLConnection conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod(op.getType().toString());
    conn.setDoOutput(false);
    conn.setInstanceFollowRedirects(false);
    conn.connect();
    final String redirect=conn.getHeaderField("Location");
    conn.disconnect();
    WebHdfsFileSystem.LOG.info("redirect = " + redirect);
    String re="&" + dnCreateParam + "=[^&]*";
    String modified=redirect.replaceAll(re,"");
    WebHdfsFileSystem.LOG.info("modified = " + modified);
    conn=(HttpURLConnection)new URL(modified).openConnection();
    conn.setRequestMethod(op.getType().toString());
    conn.setDoOutput(op.getDoOutput());
    conn.connect();
    assertEquals(HttpServletResponse.SC_CREATED,conn.getResponseCode());
  }
}
