@Test public void testGetSubClustersForRack() throws YarnException {
  setUpGoodFile();
  Set<SubClusterId> rack1Expected=new HashSet<SubClusterId>();
  rack1Expected.add(SubClusterId.newInstance("subcluster1"));
  rack1Expected.add(SubClusterId.newInstance("subcluster2"));
  Set<SubClusterId> rack2Expected=new HashSet<SubClusterId>();
  rack2Expected.add(SubClusterId.newInstance("subcluster3"));
  Assert.assertEquals(rack1Expected,resolver.getSubClustersForRack("rack1"));
  Assert.assertEquals(rack2Expected,resolver.getSubClustersForRack("rack2"));
  try {
    resolver.getSubClustersForRack("rackDoesNotExist");
    Assert.fail();
  }
 catch (  YarnException e) {
    Assert.assertTrue(e.getMessage().startsWith("Cannot resolve rack"));
  }
}
