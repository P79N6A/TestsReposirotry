@Test public void testRootDirEZTrash() throws Exception {
  final HdfsAdmin dfsAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
  final String currentUser=UserGroupInformation.getCurrentUser().getShortUserName();
  final Path rootDir=new Path("/");
  dfsAdmin.createEncryptionZone(rootDir,TEST_KEY,NO_TRASH);
  final Path encFile=new Path("/encFile");
  final int len=8192;
  DFSTestUtil.createFile(fs,encFile,len,(short)1,0xFEED);
  Configuration clientConf=new Configuration(conf);
  clientConf.setLong(FS_TRASH_INTERVAL_KEY,1);
  FsShell shell=new FsShell(clientConf);
  verifyShellDeleteWithTrash(shell,encFile);
  Path encFileCurrentTrash=shell.getCurrentTrashDir(encFile);
  Path rootDirCurrentTrash=shell.getCurrentTrashDir(rootDir);
  assertEquals("Root trash should be equal with ezFile trash",encFileCurrentTrash,rootDirCurrentTrash);
  final WebHdfsFileSystem webFS=WebHdfsTestUtil.getWebHdfsFileSystem(conf,WebHdfsConstants.WEBHDFS_SCHEME);
  final Path expectedTrash=new Path(rootDir,new Path(FileSystem.TRASH_PREFIX,currentUser));
  Path webHDFSTrash=webFS.getTrashRoot(encFile);
  assertEquals(expectedTrash.toUri().getPath(),webHDFSTrash.toUri().getPath());
  assertEquals(encFileCurrentTrash.getParent().toUri().getPath(),webHDFSTrash.toUri().getPath());
}
