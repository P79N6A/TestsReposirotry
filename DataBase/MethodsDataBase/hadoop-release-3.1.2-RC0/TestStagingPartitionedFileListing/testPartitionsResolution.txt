@Test public void testPartitionsResolution() throws Throwable {
  File tempDir=getTempDir();
  File partitionsDir=new File(tempDir,"partitions");
  attemptPath=new Path(partitionsDir.toURI());
  attemptFS=FileSystem.getLocal(getJob().getConfiguration());
  deleteQuietly(attemptFS,attemptPath,true);
  attemptFS.mkdirs(attemptPath);
  assertTrue(Paths.getPartitions(attemptPath,new ArrayList<>(0)).isEmpty());
  String oct2017="year=2017/month=10";
  Path octLog=new Path(attemptPath,oct2017 + "/log-2017-10-04.txt");
  touch(attemptFS,octLog);
  assertThat(listPartitions(attemptFS,attemptPath),hasItem(oct2017));
  Path rootFile=new Path(attemptPath,"root.txt");
  touch(attemptFS,rootFile);
  assertThat(listPartitions(attemptFS,attemptPath),allOf(hasItem(oct2017),hasItem(StagingCommitterConstants.TABLE_ROOT)));
}
