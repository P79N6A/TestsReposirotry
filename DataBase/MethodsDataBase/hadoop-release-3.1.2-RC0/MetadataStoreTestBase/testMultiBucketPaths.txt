/** 
 * Test that the MetadataStore differentiates between the same path in two different buckets.
 */
@Test public void testMultiBucketPaths() throws Exception {
  String p1="s3a://bucket-a/path1";
  String p2="s3a://bucket-b/path2";
  PathMetadata meta=ms.get(new Path(p1));
  assertNull("Path should not be present yet.",meta);
  meta=ms.get(new Path(p2));
  assertNull("Path2 should not be present yet.",meta);
  ms.put(new PathMetadata(makeFileStatus(p1,100)));
  meta=ms.get(new Path(p2));
  assertNull("Path 2 should not match path 1.",meta);
  if (!allowMissing()) {
    ms.delete(new Path(p2));
    meta=ms.get(new Path(p1));
    assertNotNull("Path should not have been deleted",meta);
  }
  ms.delete(new Path(p1));
}
