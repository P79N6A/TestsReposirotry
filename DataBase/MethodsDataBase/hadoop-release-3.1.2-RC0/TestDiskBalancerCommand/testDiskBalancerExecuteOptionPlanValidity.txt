@Test(timeout=600000) public void testDiskBalancerExecuteOptionPlanValidity() throws Exception {
  final int numDatanodes=1;
  final Configuration hdfsConf=new HdfsConfiguration();
  hdfsConf.setBoolean(DFSConfigKeys.DFS_DISK_BALANCER_ENABLED,true);
  hdfsConf.set(DFSConfigKeys.DFS_DISK_BALANCER_PLAN_VALID_INTERVAL,"600s");
  final MiniDFSCluster miniCluster=DiskBalancerTestUtil.newImbalancedCluster(hdfsConf,numDatanodes,CAPACITIES,DEFAULT_BLOCK_SIZE,FILE_LEN);
  try {
    final String planFileFullName=runAndVerifyPlan(miniCluster,hdfsConf);
    final String cmdLine=String.format("hdfs diskbalancer -%s %s",EXECUTE,planFileFullName);
    sleep(10000);
    runCommand(cmdLine,hdfsConf,miniCluster);
  }
  finally {
    if (miniCluster != null) {
      miniCluster.shutdown();
    }
  }
}
