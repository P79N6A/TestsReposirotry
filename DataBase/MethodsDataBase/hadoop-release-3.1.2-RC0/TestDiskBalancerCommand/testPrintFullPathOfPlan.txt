@Test public void testPrintFullPathOfPlan() throws Exception {
  String parent=GenericTestUtils.getRandomizedTempPath();
  MiniDFSCluster miniCluster=null;
  try {
    Configuration hdfsConf=new HdfsConfiguration();
    List<String> outputs=null;
    miniCluster=DiskBalancerTestUtil.newImbalancedCluster(hdfsConf,1,CAPACITIES,DEFAULT_BLOCK_SIZE,FILE_LEN);
    final String cmdLine=String.format("hdfs diskbalancer -%s %s -%s %s",PLAN,miniCluster.getDataNodes().get(0).getDatanodeUuid(),OUTFILE,parent);
    outputs=runCommand(cmdLine,hdfsConf,miniCluster);
    final String planFileFullName=new Path(parent,miniCluster.getDataNodes().get(0).getDatanodeUuid()).toString();
    assertEquals("There must be two lines: the 1st is writing plan to," + " the 2nd is actual full path of plan file.",2,outputs.size());
    assertThat(outputs.get(0),containsString("Writing plan to"));
    assertThat(outputs.get(1),containsString(planFileFullName));
  }
  finally {
    if (miniCluster != null) {
      miniCluster.shutdown();
    }
  }
}
