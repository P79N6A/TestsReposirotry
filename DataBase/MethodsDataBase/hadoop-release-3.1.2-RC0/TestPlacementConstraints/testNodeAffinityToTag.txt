@Test public void testNodeAffinityToTag(){
  AbstractConstraint constraintExpr=targetIn(NODE,allocationTag("hbase-m"));
  SingleConstraint sConstraint=(SingleConstraint)constraintExpr;
  Assert.assertEquals(NODE,sConstraint.getScope());
  Assert.assertEquals(1,sConstraint.getMinCardinality());
  Assert.assertEquals(Integer.MAX_VALUE,sConstraint.getMaxCardinality());
  Assert.assertEquals(1,sConstraint.getTargetExpressions().size());
  TargetExpression tExpr=sConstraint.getTargetExpressions().iterator().next();
  Assert.assertEquals(AllocationTagNamespaceType.SELF.toString(),tExpr.getTargetKey());
  Assert.assertEquals(TargetType.ALLOCATION_TAG,tExpr.getTargetType());
  Assert.assertEquals(1,tExpr.getTargetValues().size());
  Assert.assertEquals("hbase-m",tExpr.getTargetValues().iterator().next());
  PlacementConstraint constraint=PlacementConstraints.build(constraintExpr);
  Assert.assertNotNull(constraint.getConstraintExpr());
}
