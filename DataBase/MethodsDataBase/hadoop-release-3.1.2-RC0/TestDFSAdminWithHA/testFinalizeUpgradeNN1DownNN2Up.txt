@Test(timeout=30000) public void testFinalizeUpgradeNN1DownNN2Up() throws Exception {
  setUpHaCluster(false);
  cluster.getDfsCluster().shutdownNameNode(0);
  cluster.getDfsCluster().transitionToActive(1);
  int exitCode=admin.run(new String[]{"-finalizeUpgrade"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  String message="Finalize upgrade failed for .*" + newLine + "Finalize upgrade successful for .*"+ newLine;
  assertOutputMatches(message);
}
