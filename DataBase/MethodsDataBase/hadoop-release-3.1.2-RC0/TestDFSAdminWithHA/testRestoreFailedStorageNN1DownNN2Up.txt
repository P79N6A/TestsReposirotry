@Test(timeout=30000) public void testRestoreFailedStorageNN1DownNN2Up() throws Exception {
  setUpHaCluster(false);
  cluster.getDfsCluster().shutdownNameNode(0);
  int exitCode=admin.run(new String[]{"-restoreFailedStorage","check"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  String message="restoreFailedStorage failed for.*" + newLine + "restoreFailedStorage is set to false for.*"+ newLine;
  assertOutputMatches(message);
  exitCode=admin.run(new String[]{"-restoreFailedStorage","true"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  message="restoreFailedStorage failed for.*" + newLine + "restoreFailedStorage is set to true for.*"+ newLine;
  assertOutputMatches(message);
  exitCode=admin.run(new String[]{"-restoreFailedStorage","false"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  message="restoreFailedStorage failed for.*" + newLine + "restoreFailedStorage is set to false for.*"+ newLine;
  assertOutputMatches(message);
}
