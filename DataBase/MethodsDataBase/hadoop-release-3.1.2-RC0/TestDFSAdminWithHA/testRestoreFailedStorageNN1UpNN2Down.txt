@Test(timeout=30000) public void testRestoreFailedStorageNN1UpNN2Down() throws Exception {
  setUpHaCluster(false);
  cluster.getDfsCluster().shutdownNameNode(1);
  int exitCode=admin.run(new String[]{"-restoreFailedStorage","check"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  String message="restoreFailedStorage is set to false for.*" + newLine + "restoreFailedStorage failed for.*"+ newLine;
  assertOutputMatches(message);
  exitCode=admin.run(new String[]{"-restoreFailedStorage","true"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  message="restoreFailedStorage is set to true for.*" + newLine + "restoreFailedStorage failed for.*"+ newLine;
  assertOutputMatches(message);
  exitCode=admin.run(new String[]{"-restoreFailedStorage","false"});
  assertNotEquals(err.toString().trim(),0,exitCode);
  message="restoreFailedStorage is set to false for.*" + newLine + "restoreFailedStorage failed for.*"+ newLine;
  assertOutputMatches(message);
}
