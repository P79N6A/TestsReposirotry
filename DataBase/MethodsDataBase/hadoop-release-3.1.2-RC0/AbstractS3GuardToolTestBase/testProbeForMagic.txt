@Test public void testProbeForMagic() throws Throwable {
  S3AFileSystem fs=getFileSystem();
  String name=fs.getUri().toString();
  S3GuardTool.BucketInfo cmd=new S3GuardTool.BucketInfo(getConfiguration());
  if (fs.hasCapability(CommitConstants.STORE_CAPABILITY_MAGIC_COMMITTER)) {
    exec(cmd,S3GuardTool.BucketInfo.MAGIC_FLAG,name);
  }
 else {
    ExitUtil.ExitException e=intercept(ExitUtil.ExitException.class,() -> exec(cmd,S3GuardTool.BucketInfo.MAGIC_FLAG,name));
    if (e.getExitCode() != E_BAD_STATE) {
      throw e;
    }
  }
}
