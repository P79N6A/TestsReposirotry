@Test public void testGroupMappingRefresh() throws Exception {
  DFSAdmin admin=new DFSAdmin(config);
  String[] args=new String[]{"-refreshUserToGroupsMappings"};
  Groups groups=Groups.getUserToGroupsMappingService(config);
  String user=UserGroupInformation.getCurrentUser().getUserName();
  LOG.debug("First attempt:");
  List<String> g1=groups.getGroups(user);
  LOG.debug(g1.toString());
  LOG.debug("Second attempt, should be the same:");
  List<String> g2=groups.getGroups(user);
  LOG.debug(g2.toString());
  for (int i=0; i < g2.size(); i++) {
    assertEquals("Should be same group ",g1.get(i),g2.get(i));
  }
  admin.run(args);
  LOG.debug("Third attempt(after refresh command), should be different:");
  List<String> g3=groups.getGroups(user);
  LOG.debug(g3.toString());
  for (int i=0; i < g3.size(); i++) {
    assertFalse("Should be different group: " + g1.get(i) + " and "+ g3.get(i),g1.get(i).equals(g3.get(i)));
  }
  LOG.debug("Fourth attempt(after timeout), should be different:");
  GenericTestUtils.waitFor(() -> {
    List<String> g4;
    try {
      g4=groups.getGroups(user);
    }
 catch (    IOException e) {
      return false;
    }
    LOG.debug(g4.toString());
    return !g3.equals(g4);
  }
,50,Math.toIntExact(groupRefreshTimeoutSec * 1000 * 30));
}
