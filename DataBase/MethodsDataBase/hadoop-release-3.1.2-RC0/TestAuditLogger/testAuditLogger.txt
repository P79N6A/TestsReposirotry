/** 
 * Tests that AuditLogger works as expected.
 */
@Test public void testAuditLogger() throws IOException {
  Configuration conf=new HdfsConfiguration();
  conf.set(DFS_NAMENODE_AUDIT_LOGGERS_KEY,DummyAuditLogger.class.getName());
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).build();
  try {
    cluster.waitClusterUp();
    assertTrue(DummyAuditLogger.initialized);
    DummyAuditLogger.resetLogCount();
    FileSystem fs=cluster.getFileSystem();
    long time=System.currentTimeMillis();
    fs.setTimes(new Path("/"),time,time);
    assertEquals(1,DummyAuditLogger.logCount);
  }
  finally {
    cluster.shutdown();
  }
}
