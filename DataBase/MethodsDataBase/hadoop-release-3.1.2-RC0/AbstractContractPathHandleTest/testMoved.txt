@Test public void testMoved() throws IOException {
  describe("verify open(PathHandle, moved(*))");
  assumeSupportsFileReference();
  HandleOpt.Location loc=HandleOpt.getOpt(HandleOpt.Location.class,opts).orElseThrow(IllegalArgumentException::new);
  FileStatus stat=testFile(B1);
  ContractTestUtils.rename(getFileSystem(),stat.getPath(),path(stat.getPath() + "2"));
  PathHandle fd=getHandleOrSkip(stat);
  try (FSDataInputStream in=getFileSystem().open(fd)){
    assertTrue("Failed to detect location change",loc.allowChange());
    verifyRead(in,B1,0,B1.length);
  }
 catch (  InvalidPathHandleException e) {
    assertFalse("Failed to allow location change",loc.allowChange());
  }
}
