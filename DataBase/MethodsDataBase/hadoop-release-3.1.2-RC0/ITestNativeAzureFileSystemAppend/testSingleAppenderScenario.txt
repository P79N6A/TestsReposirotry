@Test public void testSingleAppenderScenario() throws Throwable {
  FSDataOutputStream appendStream1=null;
  FSDataOutputStream appendStream2=null;
  IOException ioe=null;
  try {
    createBaseFileWithData(0,testPath);
    appendStream1=fs.append(testPath,10);
    boolean encounteredException=false;
    try {
      appendStream2=fs.append(testPath,10);
    }
 catch (    IOException ex) {
      encounteredException=true;
      ioe=ex;
    }
    appendStream1.close();
    assertTrue(encounteredException);
    GenericTestUtils.assertExceptionContains("Unable to set Append lease on the Blob",ioe);
  }
  finally {
    if (appendStream1 != null) {
      appendStream1.close();
    }
    if (appendStream2 != null) {
      appendStream2.close();
    }
  }
}
