/** 
 * Test if the different chains for users are generated, and LRU cache is working as expected.
 */
@Test public void testUsersChainMapWithLRUCache() throws YarnException, IOException, InterruptedException {
  Map<String,RequestInterceptorChainWrapper> pipelines;
  RequestInterceptorChainWrapper chain;
  getNewApplication("test1");
  getNewApplication("test2");
  getNewApplication("test3");
  getNewApplication("test4");
  getNewApplication("test5");
  getNewApplication("test6");
  getNewApplication("test7");
  getNewApplication("test8");
  pipelines=super.getRouterClientRMService().getPipelines();
  Assert.assertEquals(8,pipelines.size());
  getNewApplication("test9");
  getNewApplication("test10");
  getNewApplication("test1");
  getNewApplication("test11");
  Assert.assertEquals(10,pipelines.size());
  chain=pipelines.get("test1");
  Assert.assertNotNull("test1 should not be evicted",chain);
  chain=pipelines.get("test2");
  Assert.assertNull("test2 should have been evicted",chain);
}
