@Test public void test_0200_ListStatusPerformance() throws Exception {
  ContractTestUtils.NanoTimer timer=new ContractTestUtils.NanoTimer();
  FileStatus[] fileList=fs.listStatus(TEST_DIR_PATH);
  long elapsedMs=timer.elapsedTimeMs();
  LOG.info(String.format("files=%1$d, elapsedMs=%2$d",fileList.length,elapsedMs));
  Map<Path,FileStatus> foundInList=new HashMap<>(expectedFileCount);
  for (  FileStatus fileStatus : fileList) {
    foundInList.put(fileStatus.getPath(),fileStatus);
    LOG.info("{}: {}",fileStatus.getPath(),fileStatus.isDirectory() ? "dir" : "file");
  }
  assertEquals("Mismatch between expected files and actual",expectedFileCount,fileList.length);
  ContractTestUtils.NanoTimer initialStatusCallTimer=new ContractTestUtils.NanoTimer();
  RemoteIterator<LocatedFileStatus> listing=fs.listFiles(TEST_DIR_PATH,true);
  long initialListTime=initialStatusCallTimer.elapsedTimeMs();
  timer=new ContractTestUtils.NanoTimer();
  while (listing.hasNext()) {
    FileStatus fileStatus=listing.next();
    Path path=fileStatus.getPath();
    FileStatus removed=foundInList.remove(path);
    assertNotNull("Did not find " + path + "{} in the previous listing",removed);
  }
  elapsedMs=timer.elapsedTimeMs();
  LOG.info("time for listFiles() initial call: {} millis;" + " time to iterate: {} millis",initialListTime,elapsedMs);
  assertEquals("Not all files from listStatus() were found in listFiles()",0,foundInList.size());
}
