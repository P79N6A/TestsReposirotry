/** 
 * Ensure that the correct hint is passed to the block receiver when the client is remote AND dfs.datanode.allow.non.local.lazy.persist is set to true.
 */
@Test public void testOverrideWithRemoteClient() throws IOException {
  ArgumentCaptor<Boolean> captor=ArgumentCaptor.forClass(Boolean.class);
  DataXceiver xceiver=makeStubDataXceiver(PeerLocality.REMOTE,NonLocalLazyPersist.ALLOWED,captor);
  for (  Boolean lazyPersistSetting : Arrays.asList(true,false)) {
    issueWriteBlockCall(xceiver,lazyPersistSetting);
    assertThat(captor.getValue(),is(lazyPersistSetting));
  }
}
