/** 
 * Test Pseudo Local File System methods like getFileStatus(), create(), open(), exists() for <li> valid file paths and <li> invalid file paths.
 * @throws IOException
 */
@Test public void testPseudoLocalFsFileNames() throws IOException {
  PseudoLocalFs pfs=new PseudoLocalFs();
  Configuration conf=new Configuration();
  conf.setClass("fs.pseudo.impl",PseudoLocalFs.class,FileSystem.class);
  Path path=new Path("pseudo:///myPsedoFile.1234");
  FileSystem testFs=path.getFileSystem(conf);
  assertEquals("Failed to obtain a pseudo local file system object from path",pfs.getUri().getScheme(),testFs.getUri().getScheme());
  path=new Path("file:///myPsedoFile.12345");
  validateGetFileStatus(pfs,path,false);
  validateCreate(pfs,path,false);
  validateOpen(pfs,path,false);
  validateExists(pfs,path,false);
  path=new Path("pseudo:///myPsedoFile");
  validateGetFileStatus(pfs,path,false);
  validateCreate(pfs,path,false);
  validateOpen(pfs,path,false);
  validateExists(pfs,path,false);
  path=new Path("pseudo:///myPsedoFile.txt");
  validateGetFileStatus(pfs,path,false);
  validateCreate(pfs,path,false);
  validateOpen(pfs,path,false);
  validateExists(pfs,path,false);
  long fileSize=231456;
  path=PseudoLocalFs.generateFilePath("my.Psedo.File",fileSize);
  assertEquals("generateFilePath() failed.",fileSize,pfs.validateFileNameFormat(path));
  validateGetFileStatus(pfs,path,true);
  validateCreate(pfs,path,true);
  validateOpen(pfs,path,true);
  validateExists(pfs,path,true);
  path=new Path("myPsedoFile.1237");
  path=pfs.makeQualified(path);
  validateGetFileStatus(pfs,path,true);
  validateCreate(pfs,path,true);
  validateOpen(pfs,path,true);
  validateExists(pfs,path,true);
}
