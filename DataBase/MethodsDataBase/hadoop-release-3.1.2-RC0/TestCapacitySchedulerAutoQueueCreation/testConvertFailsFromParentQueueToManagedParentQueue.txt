@Test public void testConvertFailsFromParentQueueToManagedParentQueue() throws Exception {
  CapacityScheduler newCS=new CapacityScheduler();
  try {
    CapacitySchedulerConfiguration newConf=new CapacitySchedulerConfiguration();
    setupQueueConfiguration(newConf);
    newConf.setAutoCreatedLeafQueueConfigCapacity(A,A_CAPACITY / 10);
    newConf.setAutoCreateChildQueueEnabled(A,true);
    newCS.setConf(new YarnConfiguration());
    newCS.setRMContext(mockRM.getRMContext());
    newCS.init(cs.getConf());
    newCS.start();
    final ParentQueue a1Queue=(ParentQueue)newCS.getQueue("a");
    a1Queue.stopQueue();
    newCS.reinitialize(newConf,new RMContextImpl(null,null,null,null,null,null,new RMContainerTokenSecretManager(newConf),new NMTokenSecretManagerInRM(newConf),new ClientToAMTokenSecretManagerInRM(),null));
    fail("Expected exception while converting a parent queue to" + " an auto create enabled parent queue");
  }
 catch (  IOException e) {
  }
 finally {
    newCS.stop();
  }
}
