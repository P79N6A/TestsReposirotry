@Test public void testIncludesFromInputStreamWhenResourceAdded() throws Exception {
  tearDown();
  out=new BufferedWriter(new FileWriter(CONFIG_FOR_ENUM));
  startConfig();
  appendProperty("e","SecondLevelInclude");
  appendProperty("f","SecondLevelInclude");
  endConfig();
  out=new BufferedWriter(new FileWriter(CONFIG2));
  startConfig();
  startInclude(CONFIG_FOR_ENUM);
  endInclude();
  appendProperty("c","FirstLevelInclude");
  appendProperty("d","FirstLevelInclude");
  endConfig();
  out=new BufferedWriter(new FileWriter(CONFIG));
  startConfig();
  startInclude(CONFIG2);
  endInclude();
  appendProperty("a","1");
  appendProperty("b","2");
  endConfig();
  File file=new File(CONFIG);
  BufferedInputStream bis=new BufferedInputStream(new FileInputStream(file));
  conf.addResource(bis);
  assertEquals("1",conf.get("a"));
  assertEquals("2",conf.get("b"));
  assertEquals("FirstLevelInclude",conf.get("c"));
  assertEquals("FirstLevelInclude",conf.get("d"));
  assertEquals("SecondLevelInclude",conf.get("e"));
  assertEquals("SecondLevelInclude",conf.get("f"));
  out=new BufferedWriter(new FileWriter(CONFIG_MULTI_BYTE));
  startConfig();
  appendProperty("g","3");
  appendProperty("h","4");
  endConfig();
  Path fileResource=new Path(CONFIG_MULTI_BYTE);
  conf.addResource(fileResource);
  assertEquals("1",conf.get("a"));
  assertEquals("2",conf.get("b"));
  assertEquals("FirstLevelInclude",conf.get("c"));
  assertEquals("FirstLevelInclude",conf.get("d"));
  assertEquals("SecondLevelInclude",conf.get("e"));
  assertEquals("SecondLevelInclude",conf.get("f"));
  assertEquals("3",conf.get("g"));
  assertEquals("4",conf.get("h"));
  tearDown();
}
