/** 
 * Test namenode format with -format -nonInteractive options when a non empty name directory exists. Format should not succeed.
 * @throws IOException
 */
@Test public void testFormatWithNonInteractive() throws IOException {
  File data=new File(hdfsDir,"file");
  if (!data.mkdirs()) {
    fail("Failed to create dir " + data.getPath());
  }
  String[] argv={"-format","-nonInteractive"};
  try {
    NameNode.createNameNode(argv,config);
    fail("createNameNode() did not call System.exit()");
  }
 catch (  ExitException e) {
    assertEquals("Format should have been aborted with exit code 1",1,e.status);
  }
  File version=new File(hdfsDir,"current/VERSION");
  assertFalse("Check version should not exist",version.exists());
}
