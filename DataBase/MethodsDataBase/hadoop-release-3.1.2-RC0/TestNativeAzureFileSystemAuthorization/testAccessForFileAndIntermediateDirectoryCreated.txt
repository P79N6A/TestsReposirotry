/** 
 * Test access for file and intermediate directory after creating file with intermediate directory.
 */
@Test public void testAccessForFileAndIntermediateDirectoryCreated() throws Throwable {
  Path parentDir=new Path("/testAccessDirectory");
  Path intermediateDir=new Path(parentDir,"intermediateDir");
  Path testPath=new Path(intermediateDir,"test.dat");
  authorizer.addAuthRuleForOwner("/",WRITE,true);
  authorizer.addAuthRuleForOwner(parentDir.toString(),WRITE,true);
  authorizer.addAuthRuleForOwner(parentDir.toString() + "/*",WRITE,true);
  authorizer.addAuthRuleForOwner(parentDir.toString() + "/*",READ,true);
  fs.updateWasbAuthorizer(authorizer);
  try {
    fs.mkdirs(parentDir);
    fs.create(testPath);
    assertPathExists(fs,"testPath was not created",testPath);
    fs.access(parentDir,FsAction.WRITE);
    fs.access(parentDir,FsAction.WRITE_EXECUTE);
    fs.access(intermediateDir,FsAction.ALL);
    fs.access(intermediateDir,FsAction.READ_WRITE);
    fs.access(testPath,FsAction.ALL);
    fs.access(testPath,FsAction.READ_WRITE);
  }
  finally {
    recursiveDelete(testPath);
  }
}
