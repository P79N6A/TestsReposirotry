@Test(timeout=5000) public void testReRegister() throws YarnException, IOException, InterruptedException {
  launchUAM(attemptId);
  registerApplicationMaster(RegisterApplicationMasterRequest.newInstance(null,0,null),attemptId);
  uam.setShouldReRegisterNext();
  allocateAsync(AllocateRequest.newInstance(0,0,null,null,null),callback,attemptId);
  waitForCallBackCountAndCheckZeroPending(callback,1);
  uam.setShouldReRegisterNext();
  finishApplicationMaster(FinishApplicationMasterRequest.newInstance(null,null,null),attemptId);
}
