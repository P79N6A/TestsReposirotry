@Test public void testDeleteTable() throws Exception {
  final String tableName="testDeleteTable";
  final S3AFileSystem s3afs=getFileSystem();
  final Configuration conf=s3afs.getConf();
  conf.set(S3GUARD_DDB_TABLE_NAME_KEY,tableName);
  try (DynamoDBMetadataStore ddbms=new DynamoDBMetadataStore()){
    ddbms.initialize(s3afs);
    ddbms.listChildren(new Path(S3URI));
    ddbms.destroy();
    verifyTableNotExist(tableName);
    ddbms.destroy();
    verifyTableNotExist(tableName);
    try {
      ddbms.listChildren(new Path(S3URI));
      fail("Should have failed after the table is destroyed!");
    }
 catch (    IOException ignored) {
    }
  }
 }
