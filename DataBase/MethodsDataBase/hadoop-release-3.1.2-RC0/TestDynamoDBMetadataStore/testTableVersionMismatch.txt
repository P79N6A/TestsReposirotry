/** 
 * Set the version value to a different number and verify that table init fails.
 */
@Test public void testTableVersionMismatch() throws Exception {
  final DynamoDBMetadataStore ddbms=createContract().getMetadataStore();
  String tableName=getFileSystem().getConf().get(S3GUARD_DDB_TABLE_NAME_KEY,BUCKET);
  Table table=verifyTableInitialized(tableName);
  table.deleteItem(VERSION_MARKER_PRIMARY_KEY);
  Item v200=createVersionMarker(VERSION_MARKER,200,0);
  table.putItem(v200);
  intercept(IOException.class,E_INCOMPATIBLE_VERSION,new VoidCallable(){
    @Override public void call() throws Exception {
      ddbms.initTable();
    }
  }
);
}
