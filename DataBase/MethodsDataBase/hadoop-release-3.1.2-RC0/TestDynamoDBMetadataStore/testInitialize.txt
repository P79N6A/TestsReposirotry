/** 
 * This tests that after initialize() using an S3AFileSystem object, the instance should have been initialized successfully, and tables are ACTIVE.
 */
@Test public void testInitialize() throws IOException {
  final String tableName="testInitializeWithFileSystem";
  final S3AFileSystem s3afs=getFileSystem();
  final Configuration conf=s3afs.getConf();
  conf.set(S3GUARD_DDB_TABLE_NAME_KEY,tableName);
  try (DynamoDBMetadataStore ddbms=new DynamoDBMetadataStore()){
    ddbms.initialize(s3afs);
    verifyTableInitialized(tableName);
    assertNotNull(ddbms.getTable());
    assertEquals(tableName,ddbms.getTable().getTableName());
    String expectedRegion=conf.get(S3GUARD_DDB_REGION_KEY,s3afs.getBucketLocation(tableName));
    assertEquals("DynamoDB table should be in configured region or the same" + " region as S3 bucket",expectedRegion,ddbms.getRegion());
  }
 }
