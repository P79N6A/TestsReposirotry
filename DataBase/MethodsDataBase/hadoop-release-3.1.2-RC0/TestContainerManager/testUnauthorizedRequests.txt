@Test public void testUnauthorizedRequests() throws IOException, YarnException {
  containerManager.start();
  ContainerId cId=createContainerId(0,1);
  ContainerLaunchContext containerLaunchContext=recordFactory.newRecordInstance(ContainerLaunchContext.class);
  StartContainerRequest scRequest=StartContainerRequest.newInstance(containerLaunchContext,createContainerToken(cId,DUMMY_RM_IDENTIFIER,context.getNodeId(),user,context.getContainerTokenSecretManager()));
  List<StartContainerRequest> list=new ArrayList<>();
  list.add(scRequest);
  StartContainersRequest allRequests=StartContainersRequest.newInstance(list);
  StartContainersResponse startResponse=containerManager.startContainers(allRequests);
  Assert.assertFalse("Should not be authorized to start container",startResponse.getSuccessfullyStartedContainers().contains(cId));
  Assert.assertTrue("Start container request should fail",startResponse.getFailedRequests().containsKey(cId));
  ContainerTokenIdentifier containerTokenIdentifier=BuilderUtils.newContainerTokenIdentifier(scRequest.getContainerToken());
  Container container=new ContainerImpl(conf,null,containerLaunchContext,null,metrics,containerTokenIdentifier,context);
  context.getContainers().put(cId,container);
  List<ContainerId> containerIds=new ArrayList<>();
  containerIds.add(cId);
  StopContainersRequest stopRequest=StopContainersRequest.newInstance(containerIds);
  StopContainersResponse stopResponse=containerManager.stopContainers(stopRequest);
  Assert.assertFalse("Should not be authorized to stop container",stopResponse.getSuccessfullyStoppedContainers().contains(cId));
  Assert.assertTrue("Stop container request should fail",stopResponse.getFailedRequests().containsKey(cId));
  containerIds=new ArrayList<>();
  containerIds.add(cId);
  GetContainerStatusesRequest request=GetContainerStatusesRequest.newInstance(containerIds);
  GetContainerStatusesResponse response=containerManager.getContainerStatuses(request);
  Assert.assertEquals("Should not be authorized to get container status",response.getContainerStatuses().size(),0);
  Assert.assertTrue("Get status request should fail",response.getFailedRequests().containsKey(cId));
}
