@Test public void testProvidedWithHierarchicalTopology() throws Exception {
  conf.setClass(ImageWriter.Options.UGI_CLASS,FsUGIResolver.class,UGIResolver.class);
  String packageName="org.apache.hadoop.hdfs.server.blockmanagement";
  String[] policies=new String[]{"BlockPlacementPolicyDefault","BlockPlacementPolicyRackFaultTolerant","BlockPlacementPolicyWithNodeGroup","BlockPlacementPolicyWithUpgradeDomain"};
  createImage(new FSTreeWalk(providedPath,conf),nnDirPath,FixedBlockResolver.class);
  String[] racks={"/pod0/rack0","/pod0/rack0","/pod0/rack1","/pod0/rack1","/pod1/rack0","/pod1/rack0","/pod1/rack1","/pod1/rack1"};
  for (  String policy : policies) {
    LOG.info("Using policy: " + packageName + "."+ policy);
    conf.set(DFS_BLOCK_REPLICATOR_CLASSNAME_KEY,packageName + "." + policy);
    startCluster(nnDirPath,racks.length,new StorageType[]{StorageType.PROVIDED,StorageType.DISK},null,false,racks);
    verifyFileSystemContents();
    setAndUnsetReplication("/" + filePrefix + (numFiles - 1)+ fileSuffix);
    cluster.shutdown();
  }
}
