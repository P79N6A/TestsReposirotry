/** 
 * Test the case where address passed to DomainSocketFactory#getPathInfo is unresolved. In such a case an exception should be thrown.
 */
@Test(timeout=60000) public void testGetPathInfoWithUnresolvedHost() throws Exception {
  TemporarySocketDirectory sockDir=new TemporarySocketDirectory();
  Configuration conf=createShortCircuitConf("testGetPathInfoWithUnresolvedHost",sockDir);
  conf.set(DFS_CLIENT_CONTEXT,"testGetPathInfoWithUnresolvedHost_Context");
  conf.setBoolean(DFS_CLIENT_DOMAIN_SOCKET_DATA_TRAFFIC,true);
  DfsClientConf.ShortCircuitConf shortCircuitConf=new DfsClientConf.ShortCircuitConf(conf);
  DomainSocketFactory domainSocketFactory=new DomainSocketFactory(shortCircuitConf);
  InetSocketAddress targetAddr=InetSocketAddress.createUnresolved("random",32456);
  thrown.expect(IOException.class);
  thrown.expectMessage("Unresolved host: " + targetAddr);
  domainSocketFactory.getPathInfo(targetAddr,shortCircuitConf);
  sockDir.close();
}
