/** 
 * Test the safe mode monitor. The monitor will make block manager leave the safe mode after  extension period.
 */
@Test(timeout=30000) public void testSafeModeMonitor() throws Exception {
  bmSafeMode.activate(BLOCK_TOTAL);
  setBlockSafe(BLOCK_THRESHOLD);
  bmSafeMode.checkSafeMode();
  assertTrue(bmSafeMode.isInSafeMode());
  waitForExtensionPeriod();
  assertFalse(bmSafeMode.isInSafeMode());
}
