@Test public void testAppendOption(){
  final DistCpOptions.Builder builder=new DistCpOptions.Builder(Collections.singletonList(new Path("hdfs://localhost:8020/source")),new Path("hdfs://localhost:8020/target/")).withSyncFolder(true).withAppend(true);
  Assert.assertTrue(builder.build().shouldAppend());
  try {
    new DistCpOptions.Builder(Collections.singletonList(new Path("hdfs://localhost:8020/source")),new Path("hdfs://localhost:8020/target/")).withAppend(true).build();
    fail("Append should fail if update option is not specified");
  }
 catch (  IllegalArgumentException e) {
    assertExceptionContains("Append is valid only with update options",e);
  }
  try {
    new DistCpOptions.Builder(Collections.singletonList(new Path("hdfs://localhost:8020/source")),new Path("hdfs://localhost:8020/target/")).withSyncFolder(true).withAppend(true).withCRC(true).build();
    fail("Append should fail if skipCrc option is specified");
  }
 catch (  IllegalArgumentException e) {
    assertExceptionContains("Append is disallowed when skipping CRC",e);
  }
}
