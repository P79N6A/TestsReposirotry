@Test public void testSetAtomicCommit(){
  final DistCpOptions.Builder builder=new DistCpOptions.Builder(Collections.singletonList(new Path("hdfs://localhost:8020/source")),new Path("hdfs://localhost:8020/target/"));
  Assert.assertFalse(builder.build().shouldAtomicCommit());
  builder.withAtomicCommit(true);
  Assert.assertTrue(builder.build().shouldAtomicCommit());
  try {
    builder.withSyncFolder(true).build();
    Assert.fail("Atomic and sync folders were mutually exclusive");
  }
 catch (  IllegalArgumentException ignore) {
  }
}
