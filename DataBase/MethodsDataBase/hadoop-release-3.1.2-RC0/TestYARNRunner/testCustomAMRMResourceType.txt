@Test public void testCustomAMRMResourceType() throws Exception {
  initResourceTypes();
  String customResourceName="a-custom-resource";
  JobConf jobConf=new JobConf();
  jobConf.setInt(MRJobConfig.MR_AM_RESOURCE_PREFIX + customResourceName,5);
  jobConf.setInt(MRJobConfig.MR_AM_CPU_VCORES,3);
  yarnRunner=new YARNRunner(jobConf);
  submissionContext=buildSubmitContext(yarnRunner,jobConf);
  List<ResourceRequest> resourceRequests=submissionContext.getAMContainerResourceRequests();
  Assert.assertEquals(1,resourceRequests.size());
  ResourceRequest resourceRequest=resourceRequests.get(0);
  ResourceInformation resourceInformation=resourceRequest.getCapability().getResourceInformation(customResourceName);
  Assert.assertEquals("Expecting the default unit (G)","G",resourceInformation.getUnits());
  Assert.assertEquals(5L,resourceInformation.getValue());
  Assert.assertEquals(3,resourceRequest.getCapability().getVirtualCores());
}
