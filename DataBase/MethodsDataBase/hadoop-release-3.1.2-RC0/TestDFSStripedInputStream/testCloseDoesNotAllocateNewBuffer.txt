@Test public void testCloseDoesNotAllocateNewBuffer() throws Exception {
  final int numBlocks=2;
  DFSTestUtil.createStripedFile(cluster,filePath,null,numBlocks,stripesPerBlock,false,ecPolicy);
  try (DFSInputStream in=fs.getClient().open(filePath.toString())){
    assertTrue(in instanceof DFSStripedInputStream);
    final DFSStripedInputStream stream=(DFSStripedInputStream)in;
    final ElasticByteBufferPool ebbp=(ElasticByteBufferPool)stream.getBufferPool();
    LOG.info("Current pool size: direct: " + ebbp.size(true) + ", indirect: "+ ebbp.size(false));
    emptyBufferPoolForCurrentPolicy(ebbp,true);
    emptyBufferPoolForCurrentPolicy(ebbp,false);
    final int startSizeDirect=ebbp.size(true);
    final int startSizeIndirect=ebbp.size(false);
    stream.close();
    assertEquals(startSizeDirect,ebbp.size(true));
    assertEquals(startSizeIndirect,ebbp.size(false));
  }
 }
