/** 
 * File count on root , should return total value of files in Filesystem when one folder contains files more than "dfs.content-summary.limit".
 */
@Test public void testHugeFileCount() throws IOException {
  final Path parent=new Path(PathUtils.getTestDir(getClass()).getPath(),GenericTestUtils.getMethodName());
  assertTrue(dfs.mkdirs(parent));
  for (int i=1; i <= 5; i++) {
    FSDataOutputStream out=dfs.create(new Path(parent,"Folder1/" + "file" + i),(short)1);
    out.close();
  }
  FSDataOutputStream out=dfs.create(new Path(parent,"Folder2/file6"),(short)1);
  out.close();
  ContentSummary contentSummary=dfs.getContentSummary(parent);
  compareQuotaUsage(contentSummary,dfs,parent);
  assertEquals(6,contentSummary.getFileCount());
}
