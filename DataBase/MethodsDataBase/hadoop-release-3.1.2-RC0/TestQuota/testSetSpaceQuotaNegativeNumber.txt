/** 
 * Test to set space quote using negative number.
 */
@Test(timeout=30000) public void testSetSpaceQuotaNegativeNumber() throws Exception {
  final DFSAdmin dfsAdmin=new DFSAdmin(conf);
  final Path dir=new Path(PathUtils.getTestDir(getClass()).getPath(),GenericTestUtils.getMethodName());
  assertTrue(dfs.mkdirs(dir));
  final List<String> outs=Lists.newArrayList();
  resetStream();
  outs.clear();
  final int ret=ToolRunner.run(dfsAdmin,new String[]{"-setSpaceQuota","-10",dir.toString()});
  assertEquals(-1,ret);
  scanIntoList(ERR_STREAM,outs);
  assertEquals("It should be two lines of error messages," + " the 1st one is about Illegal option," + " the 2nd one is about SetSpaceQuota usage.",2,outs.size());
  assertThat(outs.get(0),is(allOf(containsString("setSpaceQuota"),containsString("Illegal option"))));
}
