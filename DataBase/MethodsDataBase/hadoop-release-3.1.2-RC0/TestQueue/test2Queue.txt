/** 
 * test for Qmanager with empty configuration
 * @throws IOException
 */
@Test(timeout=5000) public void test2Queue() throws IOException {
  Configuration conf=getConfiguration();
  QueueManager manager=new QueueManager(conf);
  manager.setSchedulerInfo("first","queueInfo");
  manager.setSchedulerInfo("second","queueInfoqueueInfo");
  Queue root=manager.getRoot();
  assertTrue(root.getChildren().size() == 2);
  Iterator<Queue> iterator=root.getChildren().iterator();
  Queue firstSubQueue=iterator.next();
  assertEquals("first",firstSubQueue.getName());
  assertEquals(firstSubQueue.getAcls().get("mapred.queue.first.acl-submit-job").toString(),"Users [user1, user2] and members of the groups [group1, group2] are allowed");
  Queue secondSubQueue=iterator.next();
  assertEquals("second",secondSubQueue.getName());
  assertEquals(firstSubQueue.getState().getStateName(),"running");
  assertEquals(secondSubQueue.getState().getStateName(),"stopped");
  assertTrue(manager.isRunning("first"));
  assertFalse(manager.isRunning("second"));
  assertEquals(firstSubQueue.getSchedulingInfo(),"queueInfo");
  assertEquals(secondSubQueue.getSchedulingInfo(),"queueInfoqueueInfo");
  Set<String> template=new HashSet<String>();
  template.add("first");
  template.add("second");
  assertEquals(manager.getLeafQueueNames(),template);
}
