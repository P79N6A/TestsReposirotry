/** 
 * Test dividing a byte range that located above the 2GB range, which is {@link Integer#MAX_VALUE}. HDFS-12860 occurs when  {@link VerticalRange#offsetInBlock} is larger than{@link Integer#MAX_VALUE}Take RS-6-3-1024k EC policy as example: <li>cellSize = 1MB</li> <li>The first  {@link VerticalRange#offsetInBlock} that is larger than{@link Integer#MAX_VALUE} is Math.ceilInteger.MAX_VALUE / cellSize = 2048</li> <li>The first offset in block group that causes HDFS-12860 is: 2048 * cellSize * dataBlocks (6)</li>
 */
@Test public void testDivideOneStripeLargeBlockSize(){
  ByteBuffer buffer=ByteBuffer.allocate(stripeSize);
  long offsetInInternalBlk=Integer.MAX_VALUE / cellSize + 10;
  long rangeStartInBlockGroup=offsetInInternalBlk * dataBlocks * cellSize;
  long rangeEndInBlockGroup=rangeStartInBlockGroup + dataBlocks / 2 * cellSize - 1;
  long blockGroupSize=4096L * cellSize * groupSize;
  LocatedStripedBlock blockGroup=createDummyLocatedBlock(blockGroupSize);
  AlignedStripe[] stripes=StripedBlockUtil.divideOneStripe(ecPolicy,cellSize,blockGroup,rangeStartInBlockGroup,rangeEndInBlockGroup,buffer);
  long offset=offsetInInternalBlk * cellSize;
  assertTrue(offset > Integer.MAX_VALUE);
  assertEquals(offset,stripes[0].range.offsetInBlock);
  assertEquals(1,stripes.length);
}
