@Test public void testReadFileWithMissingBlocks() throws Exception {
  try {
    setup();
    Path srcPath=new Path("/foo");
    final byte[] expected=StripedFileTestUtil.generateBytes(fileLength);
    DFSTestUtil.writeFile(fs,srcPath,new String(expected));
    StripedFileTestUtil.waitBlockGroupsReported(fs,srcPath.toUri().getPath());
    StripedFileTestUtil.verifyLength(fs,srcPath,fileLength);
    for (int missingData=1; missingData <= dataBlocks; missingData++) {
      for (int missingParity=0; missingParity <= parityBlocks - missingData; missingParity++) {
        readFileWithMissingBlocks(srcPath,fileLength,missingData,missingParity,expected);
      }
    }
  }
  finally {
    tearDown();
  }
}
