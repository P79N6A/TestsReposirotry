@Test public void testCompactionDisabled() throws Throwable {
  try (FSDataOutputStream appendStream=fs.create(TEST_PATH_NORMAL)){
    SyncableDataOutputStream dataOutputStream=null;
    OutputStream wrappedStream=appendStream.getWrappedStream();
    if (wrappedStream instanceof NativeAzureFileSystem.NativeAzureFsOutputStream) {
      NativeAzureFileSystem.NativeAzureFsOutputStream fsOutputStream=(NativeAzureFileSystem.NativeAzureFsOutputStream)wrappedStream;
      dataOutputStream=(SyncableDataOutputStream)fsOutputStream.getOutStream();
    }
 else     if (wrappedStream instanceof SyncableDataOutputStream) {
      dataOutputStream=(SyncableDataOutputStream)wrappedStream;
    }
 else {
      Assert.fail("Unable to determine type of " + wrappedStream + " class of "+ wrappedStream.getClass());
    }
    Assert.assertFalse("Data output stream is a BlockBlobAppendStream: " + dataOutputStream,dataOutputStream.getOutStream() instanceof BlockBlobAppendStream);
  }
 }
