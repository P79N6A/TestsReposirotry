@Test public void testJobCommit() throws Exception {
  Path jobAttemptPath=jobCommitter.getJobAttemptPath(job);
  FileSystem fs=jobAttemptPath.getFileSystem(conf);
  Set<String> uploads=runTasks(job,4,3);
  assertNotEquals(0,uploads.size());
  assertPathExists(fs,"No job attempt path",jobAttemptPath);
  jobCommitter.commitJob(job);
  assertEquals("Should have aborted no uploads",0,results.getAborts().size());
  assertEquals("Should have deleted no uploads",0,results.getDeletes().size());
  assertEquals("Should have committed all uploads",uploads,getCommittedIds(results.getCommits()));
  assertPathDoesNotExist(fs,"jobAttemptPath not deleted",jobAttemptPath);
}
