@Test public void testSingleTaskCommit() throws Exception {
  Path file=new Path(commitTask(committer,tac,1).iterator().next());
  List<String> uploads=results.getUploads();
  assertEquals("Should initiate one upload: " + results,1,uploads.size());
  Path committedPath=committer.getCommittedTaskPath(tac);
  FileSystem dfs=committedPath.getFileSystem(conf);
  assertEquals("Should commit to HDFS: " + committer,getDFS(),dfs);
  FileStatus[] stats=dfs.listStatus(committedPath);
  assertEquals("Should produce one commit file: " + results,1,stats.length);
  assertEquals("Should name the commits file with the task ID: " + results,"task_job_0001_r_000002",stats[0].getPath().getName());
  PendingSet pending=PendingSet.load(dfs,stats[0].getPath());
  assertEquals("Should have one pending commit",1,pending.size());
  SinglePendingCommit commit=pending.getCommits().get(0);
  assertEquals("Should write to the correct bucket:" + results,BUCKET,commit.getBucket());
  assertEquals("Should write to the correct key: " + results,OUTPUT_PREFIX + "/" + file.getName(),commit.getDestinationKey());
  assertValidUpload(results.getTagsByUpload(),commit);
}
