@Test public void testProxyGetDatanodeReport() throws Exception {
  DatanodeInfo[] combinedData=routerProtocol.getDatanodeReport(DatanodeReportType.ALL);
  Set<Integer> individualData=new HashSet<Integer>();
  for (  String nameservice : cluster.getNameservices()) {
    NamenodeContext n=cluster.getNamenode(nameservice,null);
    DFSClient client=n.getClient();
    ClientProtocol clientProtocol=client.getNamenode();
    DatanodeInfo[] data=clientProtocol.getDatanodeReport(DatanodeReportType.ALL);
    for (int i=0; i < data.length; i++) {
      DatanodeInfo info=data[i];
      individualData.add(info.getXferPort());
    }
  }
  assertEquals(combinedData.length,individualData.size());
}
