/** 
 * Tests that after renaming a directory, the original directory and its contents are indeed missing and the corresponding new paths are visible.
 * @throws Exception
 */
@Test public void testConsistentListAfterRename() throws Exception {
  Path[] mkdirs={path("d1/f"),path("d1/f" + DEFAULT_DELAY_KEY_SUBSTRING)};
  Path[] srcdirs={path("d1")};
  Path[] dstdirs={path("d2")};
  Path[] yesdirs={path("d2"),path("d2/f"),path("d2/f" + DEFAULT_DELAY_KEY_SUBSTRING)};
  Path[] nodirs={path("d1"),path("d1/f"),path("d1/f" + DEFAULT_DELAY_KEY_SUBSTRING)};
  doTestRenameSequence(mkdirs,srcdirs,dstdirs,yesdirs,nodirs);
  getFileSystem().delete(path("d1"),true);
  getFileSystem().delete(path("d2"),true);
}
