@Test public void testConsistentListStatusAfterPut() throws Exception {
  S3AFileSystem fs=getFileSystem();
  Assume.assumeTrue(fs.hasMetadataStore());
  Path inconsistentPath=path("a/b/dir3-" + DEFAULT_DELAY_KEY_SUBSTRING);
  Path[] testDirs={path("a/b/dir1"),path("a/b/dir2"),inconsistentPath};
  for (  Path path : testDirs) {
    assertTrue(fs.mkdirs(path));
  }
  FileStatus[] paths=fs.listStatus(path("a/b/"));
  List<Path> list=new ArrayList<>();
  for (  FileStatus fileState : paths) {
    list.add(fileState.getPath());
  }
  assertTrue(list.contains(path("a/b/dir1")));
  assertTrue(list.contains(path("a/b/dir2")));
  assertTrue(list.contains(inconsistentPath));
}
