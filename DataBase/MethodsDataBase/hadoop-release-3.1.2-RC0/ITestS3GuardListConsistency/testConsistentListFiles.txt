/** 
 * Tests that the S3AFS listFiles() call will return consistent file list.
 */
@Test public void testConsistentListFiles() throws Exception {
  final S3AFileSystem fs=getFileSystem();
  Assume.assumeTrue(fs.hasMetadataStore());
  final int[] numOfPaths={0,2};
  for (  int dirNum : numOfPaths) {
    for (    int normalFile : numOfPaths) {
      for (      int delayedFile : new int[]{0,1}) {
        for (        boolean recursive : new boolean[]{true,false}) {
          doTestListFiles(fs,dirNum,normalFile,delayedFile,recursive);
        }
      }
    }
  }
}
