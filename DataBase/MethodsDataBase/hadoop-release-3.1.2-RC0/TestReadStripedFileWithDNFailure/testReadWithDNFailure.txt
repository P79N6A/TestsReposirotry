/** 
 * Shutdown tolerable number of Datanode before reading. Verify the decoding works correctly.
 */
@Test public void testReadWithDNFailure() throws Exception {
  try {
    setup();
    ReadStripedFileWithDecodingHelper.testReadWithDNFailure(cluster,dfs,fileLength,dnFailureNum);
  }
 catch (  IOException ioe) {
    String fileType=fileLength < (BLOCK_SIZE * NUM_DATA_UNITS) ? "smallFile" : "largeFile";
    LOG.error("Failed to read file with DN failure:" + " fileType = " + fileType + ", dnFailureNum = "+ dnFailureNum);
  }
 finally {
    tearDown();
  }
}
