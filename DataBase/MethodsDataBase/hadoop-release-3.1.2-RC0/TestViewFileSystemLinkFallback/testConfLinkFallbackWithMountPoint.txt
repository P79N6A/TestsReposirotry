@Test public void testConfLinkFallbackWithMountPoint() throws Exception {
  TEST_DIR.mkdirs();
  Configuration conf=new Configuration();
  String clusterName="ClusterX";
  String mountPoint="/user";
  URI viewFsUri=new URI(FsConstants.VIEWFS_SCHEME,clusterName,"/",null,null);
  String expectedErrorMsg="Invalid linkFallback entry in config: " + "linkFallback./user";
  String mountTableEntry=Constants.CONFIG_VIEWFS_PREFIX + "." + clusterName+ "."+ Constants.CONFIG_VIEWFS_LINK_FALLBACK+ "."+ mountPoint;
  conf.set(mountTableEntry,TEST_DIR.toURI().toString());
  try {
    FileSystem.get(viewFsUri,conf);
    fail("Shouldn't allow linkMergeSlash to take extra mount points!");
  }
 catch (  IOException e) {
    assertTrue("Unexpected error: " + e.getMessage(),e.getMessage().contains(expectedErrorMsg));
  }
}
