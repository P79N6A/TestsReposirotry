/** 
 * Do a basic write test against an HDFS cluster with Kerberos enabled. We assume that if a basic write succeeds, more complex operations will also succeed.
 * @throws Exception thrown if things break
 */
@Test public void testWithSecureHDFS() throws Exception {
  final String path="hdfs://" + cluster.getNameNode().getHostAndPort() + "/tmp/test";
  final MetricsSystem ms=initMetricsSystem(path,true,false,true);
  assertMetricsContents(sink.doAs(new PrivilegedExceptionAction<String>(){
    @Override public String run() throws Exception {
      return doWriteTest(ms,path,1);
    }
  }
));
}
