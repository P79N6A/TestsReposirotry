@Test(timeout=60000) public void testSnapshotCommandsWithURI() throws Exception {
  Configuration config=new HdfsConfiguration();
  config.set("fs.defaultFS","hdfs://127.0.0.1:1024");
  String path=fs.getUri() + "/Fully/QPath";
  DFSTestUtil.DFSAdminRun("-allowSnapshot " + path,0,"Allowing snapshot on " + path + " succeeded",config);
  DFSTestUtil.FsShellRun("-createSnapshot " + path + " sn1",config);
  DFSTestUtil.createFile(fs,new Path(fs.getUri() + "/Fully/QPath/File1"),1024,(short)1,100);
  DFSTestUtil.createFile(fs,new Path(fs.getUri() + "/Fully/QPath/File2"),1024,(short)1,100);
  DFSTestUtil.FsShellRun("-createSnapshot " + path + " sn2",config);
  SnapshotDiffReport report=fs.getSnapshotDiffReport(new Path(path),"sn1","sn2");
  DFSTestUtil.toolRun(new SnapshotDiff(config),path + " sn1 sn2",0,report.toString());
  DFSTestUtil.FsShellRun("-renameSnapshot " + path + " sn2 sn3",config);
  DFSTestUtil.FsShellRun("-deleteSnapshot " + path + " sn1",config);
  DFSTestUtil.FsShellRun("-deleteSnapshot " + path + " sn3",config);
  DFSTestUtil.DFSAdminRun("-disallowSnapshot " + path,0,"Disallowing snapshot on " + path + " succeeded",config);
  fs.delete(new Path("/Fully/QPath"),true);
}
