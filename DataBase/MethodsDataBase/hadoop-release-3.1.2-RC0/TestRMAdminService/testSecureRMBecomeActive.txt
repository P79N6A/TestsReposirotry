@Test public void testSecureRMBecomeActive() throws IOException, YarnException {
  StateChangeRequestInfo requestInfo=new StateChangeRequestInfo(HAServiceProtocol.RequestSource.REQUEST_BY_USER);
  updateConfigurationForRMHA();
  configuration.setBoolean(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHORIZATION,true);
  configuration.set(YarnConfiguration.RM_HA_ID,"rm1");
  uploadDefaultConfiguration();
  ResourceManager resourceManager=new ResourceManager();
  try {
    resourceManager.init(configuration);
    resourceManager.start();
    Assert.assertTrue(resourceManager.getRMContext().getHAServiceState() == HAServiceState.STANDBY);
    resourceManager.adminService.transitionToActive(requestInfo);
  }
  finally {
    resourceManager.close();
  }
}
