/** 
 * Test that a configuration with no leader election configured fails.
 */
@Test public void testHAConfWithoutLeaderElection(){
  Configuration conf=new Configuration(configuration);
  conf.setBoolean(YarnConfiguration.RM_HA_ENABLED,true);
  conf.setBoolean(YarnConfiguration.AUTO_FAILOVER_ENABLED,true);
  conf.setBoolean(YarnConfiguration.AUTO_FAILOVER_EMBEDDED,false);
  conf.setBoolean(YarnConfiguration.CURATOR_LEADER_ELECTOR,false);
  conf.set(YarnConfiguration.RM_HA_IDS,"rm1,rm2");
  int base=100;
  for (  String confKey : YarnConfiguration.getServiceAddressConfKeys(configuration)) {
    conf.set(HAUtil.addSuffix(confKey,"rm1"),"0.0.0.0:" + (base + 20));
    conf.set(HAUtil.addSuffix(confKey,"rm2"),"0.0.0.0:" + (base + 40));
    base=base * 2;
  }
  conf.set(YarnConfiguration.RM_HA_ID,"rm1");
  checkBadConfiguration(conf);
}
