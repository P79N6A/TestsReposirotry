@Test public void testGetMandatoryProfiles() throws Exception {
  ResourceProfilesManager manager=new ResourceProfilesManagerImpl();
  Configuration conf=new Configuration();
  conf.setBoolean(YarnConfiguration.RM_RESOURCE_PROFILES_ENABLED,true);
  conf.set(YarnConfiguration.RM_RESOURCE_PROFILES_SOURCE_FILE,"profiles/sample-profiles-1.json");
  manager.init(conf);
  Map<String,Resource> expected=new HashMap<>();
  expected.put("minimum",Resource.newInstance(1024,1));
  expected.put("default",Resource.newInstance(2048,2));
  expected.put("maximum",Resource.newInstance(8192,4));
  Assert.assertEquals("Profile 'minimum' resources don't match",expected.get("minimum"),manager.getMinimumProfile());
  Assert.assertEquals("Profile 'default' resources don't match",expected.get("default"),manager.getDefaultProfile());
  Assert.assertEquals("Profile 'maximum' resources don't match",expected.get("maximum"),manager.getMaximumProfile());
}
