@Test public void testFailuresValidityInterval(){
  ContainerRetryContext retryContext=ContainerRetryContext.newInstance(ContainerRetryPolicy.RETRY_ON_ALL_ERRORS,null,1,0,10);
  SlidingWindowRetryPolicy.RetryContext windowRetryContext=new SlidingWindowRetryPolicy.RetryContext(retryContext);
  Assert.assertTrue("retry 1",retryPolicy.shouldRetry(windowRetryContext,12));
  retryPolicy.updateRetryContext(windowRetryContext);
  Assert.assertEquals("remaining retries",1,windowRetryContext.getRemainingRetries());
  clock.setTime(20);
  Assert.assertTrue("retry 2",retryPolicy.shouldRetry(windowRetryContext,12));
  retryPolicy.updateRetryContext(windowRetryContext);
  Assert.assertEquals("remaining retries",1,windowRetryContext.getRemainingRetries());
  clock.setTime(40);
  Assert.assertTrue("retry 3",retryPolicy.shouldRetry(windowRetryContext,12));
  retryPolicy.updateRetryContext(windowRetryContext);
  Assert.assertEquals("remaining retries",1,windowRetryContext.getRemainingRetries());
  clock.setTime(45);
  Assert.assertFalse("retry failed",retryPolicy.shouldRetry(windowRetryContext,12));
  retryPolicy.updateRetryContext(windowRetryContext);
  Assert.assertEquals("remaining retries",0,windowRetryContext.getRemainingRetries());
}
