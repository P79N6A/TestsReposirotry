@Test(timeout=30000) public void testAskWithNodeLabels(){
  AMRMClientImpl<ContainerRequest> client=new AMRMClientImpl<ContainerRequest>();
  client.addContainerRequest(new ContainerRequest(Resource.newInstance(1024,1),null,null,Priority.UNDEFINED,true,"x"));
  assertEquals(1,client.ask.size());
  assertEquals("x",client.ask.iterator().next().getNodeLabelExpression());
  client.addContainerRequest(new ContainerRequest(Resource.newInstance(1024,1),null,null,Priority.UNDEFINED,true,"x"));
  client.addContainerRequest(new ContainerRequest(Resource.newInstance(1024,1),null,null,Priority.UNDEFINED,true,"a"));
  assertEquals(1,client.ask.size());
  assertEquals("a",client.ask.iterator().next().getNodeLabelExpression());
  client.addContainerRequest(new ContainerRequest(Resource.newInstance(1024,1),null,null,Priority.UNDEFINED,true,"y"));
  assertEquals(1,client.ask.size());
  for (  ResourceRequest req : client.ask) {
    if (ResourceRequest.ANY.equals(req.getResourceName())) {
      assertEquals("y",req.getNodeLabelExpression());
    }
 else {
      Assert.assertNull(req.getNodeLabelExpression());
    }
  }
  client.addContainerRequest(new ContainerRequest(Resource.newInstance(1024,1),new String[]{"rack1"},new String[]{"node1","node2"},Priority.UNDEFINED,true,"y"));
  for (  ResourceRequest req : client.ask) {
    if (ResourceRequest.ANY.equals(req.getResourceName())) {
      assertEquals("y",req.getNodeLabelExpression());
    }
 else {
      Assert.assertNull(req.getNodeLabelExpression());
    }
  }
}
