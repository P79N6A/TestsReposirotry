@Test public void testBucketConfigurationSkipsUnmodifiable() throws Throwable {
  Configuration config=new Configuration(false);
  String impl="fs.s3a.impl";
  config.set(impl,"orig");
  setBucketOption(config,"b",impl,"b");
  String metastoreImpl="fs.s3a.metadatastore.impl";
  String ddb="org.apache.hadoop.fs.s3a.s3guard.DynamoDBMetadataStore";
  setBucketOption(config,"b",metastoreImpl,ddb);
  setBucketOption(config,"b","impl2","b2");
  setBucketOption(config,"b","bucket.b.loop","b3");
  assertOptionEquals(config,"fs.s3a.bucket.b.impl","b");
  Configuration updated=propagateBucketOptions(config,"b");
  assertOptionEquals(updated,impl,"orig");
  assertOptionEquals(updated,"fs.s3a.impl2","b2");
  assertOptionEquals(updated,metastoreImpl,ddb);
  assertOptionEquals(updated,"fs.s3a.bucket.b.loop",null);
}
