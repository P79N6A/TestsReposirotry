@SuppressWarnings("unchecked") @Test public <T extends TokenIdentifier>void testCacheForUgi() throws Exception {
  final Configuration conf=newConf();
  UserGroupInformation ugiA=UserGroupInformation.createRemoteUser("foo");
  UserGroupInformation ugiB=UserGroupInformation.createRemoteUser("bar");
  FileSystem fsA=getCachedFS(ugiA,conf);
  FileSystem fsA1=getCachedFS(ugiA,conf);
  assertSame(fsA,fsA1);
  FileSystem fsB=getCachedFS(ugiB,conf);
  assertNotSame(fsA,fsB);
  Token<T> t1=mock(Token.class);
  UserGroupInformation ugiA2=UserGroupInformation.createRemoteUser("foo");
  fsA=getCachedFS(ugiA2,conf);
  assertNotSame(fsA,fsA1);
  ugiA.addToken(t1);
  fsA=getCachedFS(ugiA,conf);
  assertSame(fsA,fsA1);
}
