@Test public void testGetFlows() throws Exception {
  Client client=createClient();
  try {
    URI uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows");
    verifyFlowEntites(client,uri,3,new int[]{3,2,1},new String[]{"flow1","flow_name","flow_name2"});
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/flows/");
    verifyFlowEntites(client,uri,3,new int[]{3,2,1},new String[]{"flow1","flow_name","flow_name2"});
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?limit=1");
    verifyFlowEntites(client,uri,1,new int[]{3},new String[]{"flow1"});
    long firstFlowActivity=HBaseTimelineSchemaUtils.getTopOfTheDayTimestamp(1425016501000L);
    DateFormat fmt=TimelineReaderWebServices.DATE_FORMAT.get();
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange="+ fmt.format(firstFlowActivity)+ "-"+ fmt.format(dayTs));
    verifyFlowEntites(client,uri,3,new int[]{3,2,1},new String[]{"flow1","flow_name","flow_name2"});
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange="+ fmt.format(dayTs + (4 * 86400000L)));
    verifyFlowEntites(client,uri,0,new int[]{},new String[]{});
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange=-"+ fmt.format(dayTs));
    verifyFlowEntites(client,uri,3,new int[]{3,2,1},new String[]{"flow1","flow_name","flow_name2"});
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange="+ fmt.format(firstFlowActivity)+ "-");
    verifyFlowEntites(client,uri,3,new int[]{3,2,1},new String[]{"flow1","flow_name","flow_name2"});
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange=20150711:20150714");
    verifyHttpResponse(client,uri,Status.BAD_REQUEST);
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange=20150714-20150711");
    verifyHttpResponse(client,uri,Status.BAD_REQUEST);
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange=2015071129-20150712");
    verifyHttpResponse(client,uri,Status.BAD_REQUEST);
    uri=URI.create("http://localhost:" + getServerPort() + "/ws/v2/"+ "timeline/clusters/cluster1/flows?daterange=20150711-2015071243");
    verifyHttpResponse(client,uri,Status.BAD_REQUEST);
  }
  finally {
    client.destroy();
  }
}
