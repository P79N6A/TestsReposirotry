@Test(timeout=10000) public void testNetworkTagIDMatchPattern() throws Exception {
  Path jsonFilePath=new Path(jsonDirDirPath,"test.json");
  File jsonFile=new File(jsonFilePath.toString());
  NetworkTagMappingJsonManager manager=new NetworkTagMappingJsonManager();
  JSONObject json=new JSONObject();
  JSONArray userArray=new JSONArray();
  JSONObject user1=new JSONObject();
  user1.put("name","user1");
  user1.put("network-tag-id","1x88888888");
  userArray.put(user1);
  json.put("users",userArray);
  writeJson(jsonFile,json.toString());
  conf.set(YarnConfiguration.NM_NETWORK_TAG_MAPPING_FILE_PATH,jsonFile.getAbsolutePath());
  try {
    manager.initialize(conf);
    fail("Should get an exception. " + "Becase we did not set network-tag-id for user1 correctly");
  }
 catch (  Exception ex) {
    assertTrue(ex.getMessage().contains("User-network-tag-id mapping configuraton error."));
  }
  json.remove("users");
  userArray=new JSONArray();
  user1=new JSONObject();
  user1.put("name","user1");
  user1.put("network-tag-id","0x88888888");
  userArray.put(user1);
  json.put("users",userArray);
  JSONArray groupArray=new JSONArray();
  JSONObject group1=new JSONObject();
  group1.put("name","team1");
  group1.put("network-tag-id","0x2000003");
  groupArray.put(group1);
  json.put("groups",groupArray);
  if (fs.exists(jsonFilePath)) {
    fs.delete(jsonFilePath,false);
  }
  assertFalse(fs.exists(jsonFilePath));
  writeJson(jsonFile,json.toString());
  try {
    manager.initialize(conf);
    fail("Should get an exception. " + "Becase we did not set network-tag-id for group1 correctly");
  }
 catch (  Exception ex) {
    assertTrue(ex.getMessage().contains("Group-network-tag-id mapping configuraton error."));
  }
  json.remove("groups");
  groupArray=new JSONArray();
  group1=new JSONObject();
  group1.put("name","team1");
  group1.put("network-tag-id","0x20002003");
  groupArray.put(group1);
  json.put("groups",groupArray);
  json.put("default-network-tag-id","0x99");
  if (fs.exists(jsonFilePath)) {
    fs.delete(jsonFilePath,false);
  }
  assertFalse(fs.exists(jsonFilePath));
  writeJson(jsonFile,json.toString());
  try {
    manager.initialize(conf);
    fail("Should get an exception. " + "Becase we did not set default-network-tag-id correctly");
  }
 catch (  Exception ex) {
    assertTrue(ex.getMessage().contains("Configuration error on default-network-tag-id."));
  }
  json.remove("default-network-tag-id");
  json.put("default-network-tag-id","0x99999999");
  if (fs.exists(jsonFilePath)) {
    fs.delete(jsonFilePath,false);
  }
  assertFalse(fs.exists(jsonFilePath));
  writeJson(jsonFile,json.toString());
  manager.initialize(conf);
}
