/** 
 * Test user-defined comparator for Map/Reduce. We provide our own comparator that is the reverse of the default int  comparator. Keys should be sorted in reverse order in the reducer. 
 * @throws Exception
 */
@Test public void testUserMRComparator() throws Exception {
  conf.setMapperClass(IdentityMapper.class);
  conf.setReducerClass(DescendingKeysReducer.class);
  conf.setOutputKeyComparatorClass(DecreasingIntComparator.class);
  RunningJob r_job=jc.submitJob(conf);
  while (!r_job.isComplete()) {
    Thread.sleep(1000);
  }
  if (!r_job.isSuccessful()) {
    fail("Oops! The job broke due to an unexpected error");
  }
}
