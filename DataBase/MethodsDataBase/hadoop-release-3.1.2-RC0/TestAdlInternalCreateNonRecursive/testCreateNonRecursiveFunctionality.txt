@Test public void testCreateNonRecursiveFunctionality() throws IOException {
  if (inputFileAlreadyExist) {
    FileSystem.create(adlStore,inputFileName,inputPermission);
  }
  if (inputParentAlreadyExist) {
    adlStore.mkdirs(inputFileName.getParent());
  }
 else {
    adlStore.delete(inputFileName.getParent(),true);
  }
  try {
    adlStore.createNonRecursive(inputFileName,inputPermission,inputOverride,CommonConfigurationKeysPublic.IO_FILE_BUFFER_SIZE_DEFAULT,adlStore.getDefaultReplication(inputFileName),adlStore.getDefaultBlockSize(inputFileName),null);
  }
 catch (  IOException e) {
    if (expectedExceptionType == null) {
      throw e;
    }
    Assert.assertEquals(expectedExceptionType,e.getClass());
    return;
  }
  if (expectedExceptionType != null) {
    Assert.fail("CreateNonRecursive should have failed with exception " + expectedExceptionType.getName());
  }
}
