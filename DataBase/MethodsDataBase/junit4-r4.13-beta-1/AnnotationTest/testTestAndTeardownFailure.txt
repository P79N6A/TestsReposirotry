public void testTestAndTeardownFailure() throws Exception {
  JUnitCore core=new JUnitCore();
  Result runner=core.run(TestAndTeardownFailureTest.class);
  assertEquals(1,runner.getRunCount());
  assertEquals(2,runner.getFailureCount());
  assertThat(runner.getFailures().toString(),allOf(containsString("hereAfter"),containsString("inTest")));
}
