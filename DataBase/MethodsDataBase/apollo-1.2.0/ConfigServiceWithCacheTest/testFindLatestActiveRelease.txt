@Test public void testFindLatestActiveRelease() throws Exception {
  when(releaseMessageService.findLatestReleaseMessageForMessages(Lists.newArrayList(someKey))).thenReturn(someReleaseMessage);
  when(releaseService.findLatestActiveRelease(someAppId,someClusterName,someNamespaceName)).thenReturn(someRelease);
  when(someReleaseMessage.getId()).thenReturn(someNotificationId);
  Release release=configServiceWithCache.findLatestActiveRelease(someAppId,someClusterName,someNamespaceName,someNotificationMessages);
  Release anotherRelease=configServiceWithCache.findLatestActiveRelease(someAppId,someClusterName,someNamespaceName,someNotificationMessages);
  int retryTimes=100;
  for (int i=0; i < retryTimes; i++) {
    configServiceWithCache.findLatestActiveRelease(someAppId,someClusterName,someNamespaceName,someNotificationMessages);
  }
  assertEquals(someRelease,release);
  assertEquals(someRelease,anotherRelease);
  verify(releaseMessageService,times(1)).findLatestReleaseMessageForMessages(Lists.newArrayList(someKey));
  verify(releaseService,times(1)).findLatestActiveRelease(someAppId,someClusterName,someNamespaceName);
}
