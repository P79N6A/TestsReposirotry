@Test(expected=ServiceException.class) public void testDuplicateLock(){
  when(bizConfig.isNamespaceLockSwitchOff()).thenReturn(false);
  when(namespaceService.findOne(NAMESPACE_ID)).thenReturn(mockNamespace());
  when(namespaceLockService.findLock(NAMESPACE_ID)).thenReturn(null);
  when(namespaceLockService.tryLock(any())).thenThrow(DataIntegrityViolationException.class);
  namespaceLockAspect.acquireLock(NAMESPACE_ID,CURRENT_USER);
  verify(bizConfig).isNamespaceLockSwitchOff();
  verify(namespaceService).findOne(NAMESPACE_ID);
  verify(namespaceLockService,times(2)).findLock(NAMESPACE_ID);
  verify(namespaceLockService).tryLock(any());
}
