@Test public void testWhenConfigRepositoryHasErrorAndThenRecovered() throws Exception {
  Properties someProperties=new Properties();
  String key=ConfigConsts.CONFIG_FILE_CONTENT_KEY;
  String someValue="someValue";
  someProperties.setProperty(key,someValue);
  someSourceType=ConfigSourceType.LOCAL;
  when(configRepository.getConfig()).thenThrow(new RuntimeException("someError"));
  when(configRepository.getSourceType()).thenReturn(someSourceType);
  JsonConfigFile configFile=new JsonConfigFile(someNamespace,configRepository);
  assertFalse(configFile.hasContent());
  assertNull(configFile.getContent());
  assertEquals(ConfigSourceType.NONE,configFile.getSourceType());
  configFile.onRepositoryChange(someNamespace,someProperties);
  assertTrue(configFile.hasContent());
  assertEquals(someValue,configFile.getContent());
  assertEquals(someSourceType,configFile.getSourceType());
}
