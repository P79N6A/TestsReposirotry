@Test public void testOnRepositoryChange() throws Exception {
  RepositoryChangeListener someListener=mock(RepositoryChangeListener.class);
  LocalFileConfigRepository localFileConfigRepository=new LocalFileConfigRepository(someNamespace,upstreamRepo);
  assertEquals(someSourceType,localFileConfigRepository.getSourceType());
  localFileConfigRepository.setLocalCacheDir(someBaseDir,true);
  localFileConfigRepository.addChangeListener(someListener);
  localFileConfigRepository.getConfig();
  Properties anotherProperties=new Properties();
  anotherProperties.put("anotherKey","anotherValue");
  ConfigSourceType anotherSourceType=ConfigSourceType.NONE;
  when(upstreamRepo.getSourceType()).thenReturn(anotherSourceType);
  localFileConfigRepository.onRepositoryChange(someNamespace,anotherProperties);
  final ArgumentCaptor<Properties> captor=ArgumentCaptor.forClass(Properties.class);
  verify(someListener,times(1)).onRepositoryChange(eq(someNamespace),captor.capture());
  assertEquals(anotherProperties,captor.getValue());
  assertEquals(anotherSourceType,localFileConfigRepository.getSourceType());
}
