@Test public void testQueryConfigFileWithPrivateNamespace() throws Exception {
  String someClientSideReleaseKey="1";
  String someServerSideNewReleaseKey="2";
  String somePrivateNamespace="datasource";
  HttpServletResponse someResponse=mock(HttpServletResponse.class);
  String somePrivateNamespaceName=String.format("%s.%s",somePrivateNamespace,"xml");
  AppNamespace appNamespace=mock(AppNamespace.class);
  when(configService.loadConfig(someAppId,someClientIp,someAppId,someClusterName,somePrivateNamespace,someDataCenter,someNotificationMessages)).thenReturn(someRelease);
  when(someRelease.getReleaseKey()).thenReturn(someServerSideNewReleaseKey);
  when(namespaceUtil.filterNamespaceName(somePrivateNamespaceName)).thenReturn(somePrivateNamespace);
  when(namespaceUtil.normalizeNamespace(someAppId,somePrivateNamespace)).thenReturn(somePrivateNamespace);
  when(appNamespaceService.findByAppIdAndNamespace(someAppId,somePrivateNamespace)).thenReturn(appNamespace);
  ApolloConfig result=configController.queryConfig(someAppId,someClusterName,somePrivateNamespaceName,someDataCenter,someClientSideReleaseKey,someClientIp,someMessagesAsString,someRequest,someResponse);
  assertEquals(someAppId,result.getAppId());
  assertEquals(someClusterName,result.getCluster());
  assertEquals(somePrivateNamespaceName,result.getNamespaceName());
  assertEquals(someServerSideNewReleaseKey,result.getReleaseKey());
}
