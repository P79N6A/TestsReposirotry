@Test public void testWhenConfigRepositoryHasErrorAndThenRecovered() throws Exception {
  Properties someProperties=new Properties();
  String key=ConfigConsts.CONFIG_FILE_CONTENT_KEY;
  String someValue="someValue";
  someProperties.setProperty(key,someValue);
  when(configRepository.getConfig()).thenThrow(new RuntimeException("someError"));
  XmlConfigFile configFile=new XmlConfigFile(someNamespace,configRepository);
  assertFalse(configFile.hasContent());
  assertNull(configFile.getContent());
  configFile.onRepositoryChange(someNamespace,someProperties);
  assertTrue(configFile.hasContent());
  assertEquals(someValue,configFile.getContent());
}
