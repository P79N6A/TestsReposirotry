@Test public void testAutoUpdateWithDeletedProperties() throws Exception {
  int initialTimeout=1000;
  int initialBatch=2000;
  Properties properties=assembleProperties(TIMEOUT_PROPERTY,String.valueOf(initialTimeout),BATCH_PROPERTY,String.valueOf(initialBatch));
  SimpleConfig config=prepareConfig(ConfigConsts.NAMESPACE_APPLICATION,properties);
  ClassPathXmlApplicationContext context=new ClassPathXmlApplicationContext("spring/XmlConfigPlaceholderTest1.xml");
  TestXmlBean bean=context.getBean(TestXmlBean.class);
  assertEquals(initialTimeout,bean.getTimeout());
  assertEquals(initialBatch,bean.getBatch());
  Properties newProperties=new Properties();
  config.onRepositoryChange(ConfigConsts.NAMESPACE_APPLICATION,newProperties);
  TimeUnit.MILLISECONDS.sleep(100);
  assertEquals(DEFAULT_TIMEOUT,bean.getTimeout());
  assertEquals(DEFAULT_BATCH,bean.getBatch());
}
