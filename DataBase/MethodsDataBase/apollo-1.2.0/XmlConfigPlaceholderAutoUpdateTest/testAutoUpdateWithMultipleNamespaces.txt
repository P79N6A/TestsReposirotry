@Test public void testAutoUpdateWithMultipleNamespaces() throws Exception {
  int initialTimeout=1000;
  int initialBatch=2000;
  int newTimeout=1001;
  int newBatch=2001;
  Properties applicationProperties=assembleProperties(TIMEOUT_PROPERTY,String.valueOf(initialTimeout));
  Properties fxApolloProperties=assembleProperties(BATCH_PROPERTY,String.valueOf(initialBatch));
  SimpleConfig applicationConfig=prepareConfig(ConfigConsts.NAMESPACE_APPLICATION,applicationProperties);
  SimpleConfig fxApolloConfig=prepareConfig(FX_APOLLO_NAMESPACE,fxApolloProperties);
  ClassPathXmlApplicationContext context=new ClassPathXmlApplicationContext("spring/XmlConfigPlaceholderTest3.xml");
  TestXmlBean bean=context.getBean(TestXmlBean.class);
  assertEquals(initialTimeout,bean.getTimeout());
  assertEquals(initialBatch,bean.getBatch());
  Properties newApplicationProperties=assembleProperties(TIMEOUT_PROPERTY,String.valueOf(newTimeout));
  applicationConfig.onRepositoryChange(ConfigConsts.NAMESPACE_APPLICATION,newApplicationProperties);
  TimeUnit.MILLISECONDS.sleep(100);
  assertEquals(newTimeout,bean.getTimeout());
  assertEquals(initialBatch,bean.getBatch());
  Properties newFxApolloProperties=assembleProperties(BATCH_PROPERTY,String.valueOf(newBatch));
  fxApolloConfig.onRepositoryChange(FX_APOLLO_NAMESPACE,newFxApolloProperties);
  TimeUnit.MILLISECONDS.sleep(100);
  assertEquals(newTimeout,bean.getTimeout());
  assertEquals(newBatch,bean.getBatch());
}
