@Test public void testUserAgentPrefixAndSuffixAreAdded() throws Exception {
  String prefix="somePrefix", suffix="someSuffix";
  Request<?> request=mockRequest(SERVER_NAME,HttpMethodName.PUT,URI_NAME,true);
  HttpResponseHandler<AmazonWebServiceResponse<Object>> handler=createStubResponseHandler();
  EasyMock.replay(handler);
  ClientConfiguration config=new ClientConfiguration().withUserAgentPrefix(prefix).withUserAgentSuffix(suffix);
  Capture<HttpRequestBase> capturedRequest=new Capture<HttpRequestBase>();
  EasyMock.reset(httpClient);
  EasyMock.expect(httpClient.execute(EasyMock.capture(capturedRequest),EasyMock.<HttpContext>anyObject())).andReturn(createBasicHttpResponse()).once();
  EasyMock.replay(httpClient);
  AmazonHttpClient client=new AmazonHttpClient(config,httpClient,null);
  client.requestExecutionBuilder().request(request).execute(handler);
  String userAgent=capturedRequest.getValue().getFirstHeader("User-Agent").getValue();
  Assert.assertTrue(userAgent.startsWith(prefix));
  Assert.assertTrue(userAgent.endsWith(suffix));
}
