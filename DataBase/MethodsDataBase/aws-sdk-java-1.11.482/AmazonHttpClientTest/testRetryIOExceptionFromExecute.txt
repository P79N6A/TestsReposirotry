@Test public void testRetryIOExceptionFromExecute() throws IOException {
  IOException exception=new IOException("BOOM");
  EasyMock.reset(httpClient);
  EasyMock.expect(httpClient.getConnectionManager()).andReturn(null).anyTimes();
  EasyMock.expect(httpClient.execute(EasyMock.<HttpUriRequest>anyObject(),EasyMock.<HttpContext>anyObject())).andThrow(exception).times(4);
  EasyMock.replay(httpClient);
  ExecutionContext context=new ExecutionContext();
  Request<?> request=new DefaultRequest<Object>("testsvc");
  request.setEndpoint(java.net.URI.create("http://testsvc.region.amazonaws.com"));
  request.setContent(new ByteArrayInputStream(new byte[0]));
  try {
    client.requestExecutionBuilder().request(request).executionContext(context).execute();
    Assert.fail("No exception when request repeatedly fails!");
  }
 catch (  AmazonClientException e) {
    Assert.assertSame(exception,e.getCause());
  }
  EasyMock.verify(httpClient);
}
