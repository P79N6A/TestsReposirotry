@Test public void testNonProxyHostsSetting() throws Exception {
  clearProxyProperties();
  ClientConfiguration config;
  config=new ClientConfiguration().withNonProxyHosts("foo.com");
  assertEquals("foo.com",config.getNonProxyHosts());
  config.setProtocol(Protocol.HTTP);
  assertEquals("foo.com",config.getNonProxyHosts());
  System.setProperty("http.nonProxyHosts","foo.com");
  config=new ClientConfiguration();
  assertEquals("foo.com",config.getNonProxyHosts());
  config.setProtocol(Protocol.HTTP);
  assertEquals("foo.com",config.getNonProxyHosts());
  System.clearProperty("http.nonProxyHosts");
  System.setProperty("http.nonProxyHosts","bar.com");
  config=new ClientConfiguration().withNonProxyHosts("foo.com");
  assertEquals("foo.com",config.getNonProxyHosts());
  config.setProtocol(Protocol.HTTP);
  assertEquals("foo.com",config.getNonProxyHosts());
  System.clearProperty("http.nonProxyHosts");
  config=new ClientConfiguration();
  assertNull(config.getNonProxyHosts());
  config.setProtocol(Protocol.HTTP);
  assertNull(config.getNonProxyHosts());
}
