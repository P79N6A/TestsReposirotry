@Test public void request_has_proxy_config_when_proxy_auth_enabled() throws Exception {
  List<ProxyAuthenticationMethod> authMethods=Arrays.asList(ProxyAuthenticationMethod.BASIC,ProxyAuthenticationMethod.DIGEST,ProxyAuthenticationMethod.KERBEROS,ProxyAuthenticationMethod.NTLM,ProxyAuthenticationMethod.SPNEGO);
  List<String> expectedAuthMethods=Arrays.asList(AuthSchemes.BASIC,AuthSchemes.DIGEST,AuthSchemes.KERBEROS,AuthSchemes.NTLM,AuthSchemes.SPNEGO);
  ClientConfiguration configuration=new ClientConfiguration().withProxyHost("localhost").withProxyPort(80).withProxyUsername("user").withProxyPassword("password").withProxyAuthenticationMethods(authMethods);
  HttpClientSettings settings=HttpClientSettings.adapt(configuration);
  HttpRequestBase requestBase=requestFactory.create(newDefaultRequest(HttpMethodName.POST),settings);
  Assert.assertEquals(expectedAuthMethods,requestBase.getConfig().getProxyPreferredAuthSchemes());
}
