/** 
 * When readResource is called with default retry policy and IOException occurs, the request is not retried.
 */
@Test @SuppressWarnings("unchecked") public void readResouceWithDefaultRetryPolicy_DoesNotRetry_ForIoException() throws IOException {
  Mockito.when(mockConnection.connectToEndpoint(eq(endpoint),any(Map.class))).thenThrow(new IOException());
  try {
    new EC2CredentialsUtils(mockConnection).readResource(endpoint);
    fail("Expected an IOexception");
  }
 catch (  IOException exception) {
    Mockito.verify(mockConnection,Mockito.times(1)).connectToEndpoint(eq(endpoint),any(Map.class));
  }
}
