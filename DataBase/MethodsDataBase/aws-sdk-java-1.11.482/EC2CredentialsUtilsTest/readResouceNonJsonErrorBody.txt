/** 
 * When server returns a status code other than 200 and 404 and error body message is not in Json format, the test throws AmazonServiceException.
 */
@Test public void readResouceNonJsonErrorBody() throws IOException {
  generateStub(500,"Non Json error body");
  try {
    ec2CredentialsUtils.readResource(endpoint);
    fail("Expected AmazonServiceException");
  }
 catch (  AmazonServiceException ase) {
    assertEquals(500,ase.getStatusCode());
    assertNotNull(ase.getErrorMessage());
  }
}
