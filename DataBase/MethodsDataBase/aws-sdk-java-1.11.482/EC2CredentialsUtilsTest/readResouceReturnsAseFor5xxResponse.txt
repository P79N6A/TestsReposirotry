/** 
 * When server returns a status code other than 200 and 404, the test should throw AmazonServiceException. The request is not retried.
 */
@Test public void readResouceReturnsAseFor5xxResponse() throws IOException {
  generateStub(500,"{\"code\":\"500 Internal Server Error\",\"message\":\"ERROR_MESSAGE\"}");
  try {
    ec2CredentialsUtils.readResource(endpoint);
    fail("Expected AmazonServiceException");
  }
 catch (  AmazonServiceException ase) {
    assertEquals(500,ase.getStatusCode());
    assertEquals("500 Internal Server Error",ase.getErrorCode());
    assertEquals("ERROR_MESSAGE",ase.getErrorMessage());
  }
}
