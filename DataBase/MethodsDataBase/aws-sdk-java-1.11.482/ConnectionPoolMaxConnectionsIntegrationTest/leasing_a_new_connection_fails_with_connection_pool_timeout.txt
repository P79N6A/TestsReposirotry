@Test(timeout=60 * 1000) public void leasing_a_new_connection_fails_with_connection_pool_timeout() throws Exception {
  String localhostEndpoint="http://localhost:" + server.getPort();
  AmazonHttpClient httpClient=new AmazonHttpClient(new ClientConfiguration().withMaxConnections(1).withConnectionTimeout(100).withMaxErrorRetry(0));
  Request<?> request=new EmptyHttpRequest(localhostEndpoint,HttpMethodName.GET);
  httpClient.requestExecutionBuilder().request(request).execute(new EmptyAWSResponseHandler());
  try {
    httpClient.requestExecutionBuilder().request(request).execute();
    Assert.fail("Connection pool timeout exception is expected!");
  }
 catch (  AmazonClientException e) {
    Assert.assertTrue(e.getCause() instanceof ConnectionPoolTimeoutException);
  }
}
