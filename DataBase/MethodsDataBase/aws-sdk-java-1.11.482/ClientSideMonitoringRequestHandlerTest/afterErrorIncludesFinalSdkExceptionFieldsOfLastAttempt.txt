@Test public void afterErrorIncludesFinalSdkExceptionFieldsOfLastAttempt(){
  Request<?> request=getRequest();
  HandlerAfterAttemptContext failedAttempt=HandlerAfterAttemptContext.builder().withRequest(request).withResponse(getResponse(request)).withException(new RuntimeException("ErrorMessage")).build();
  requestHandler.afterAttempt(failedAttempt);
  requestHandler.afterAttempt(failedAttempt);
  requestHandler.afterAttempt(failedAttempt);
  requestHandler.afterError(failedAttempt.getRequest(),failedAttempt.getResponse(),failedAttempt.getException());
  verifyFinalFields(getCapturedEvent(ApiCallMonitoringEvent.class),getCapturedEvents(ApiCallAttemptMonitoringEvent.class,3).get(2));
}
