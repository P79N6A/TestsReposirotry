/** 
 * Headers are case insensitive so the request id should still be parsed in this test
 */
@Test public void handle_UnmarshallerReturnsException_WithCaseInsensitiveRequestId() throws Exception {
  httpResponse.setStatusCode(500);
  httpResponse.addHeader(StringUtils.upperCase(HttpResponseHandler.X_AMZN_REQUEST_ID_HEADER),"1234");
  expectUnmarshallerMatches();
  when(unmarshaller.unmarshall((JsonNode)anyObject())).thenReturn(new CustomException("error"));
  AmazonServiceException ase=responseHandler.handle(httpResponse);
  assertEquals("1234",ase.getRequestId());
}
