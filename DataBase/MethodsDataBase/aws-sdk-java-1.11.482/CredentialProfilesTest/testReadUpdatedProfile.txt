/** 
 * Test verifying we pick up a change to a file.
 */
@Test public void testReadUpdatedProfile() throws URISyntaxException, IOException {
  ProfilesConfigFile fixture=new ProfilesConfigFile(ProfileResourceLoader.basicProfile().asFile());
  File modifiable=File.createTempFile("UpdatableProfile",".tst");
  ProfilesConfigFileWriter.dumpToFile(modifiable,true,fixture.getAllProfiles().values().toArray(new Profile[1]));
  ProfilesConfigFile test=new ProfilesConfigFile(modifiable);
  AWSCredentials orig=test.getCredentials(DEFAULT_PROFILE_NAME);
  assertEquals("defaultAccessKey",orig.getAWSAccessKeyId());
  assertEquals("defaultSecretAccessKey",orig.getAWSSecretKey());
  try {
    Thread.sleep(2000);
  }
 catch (  Exception e) {
  }
  Profile newProfile=new Profile(DEFAULT_PROFILE_NAME,new BasicAWSCredentials("newAccessKey","newSecretKey"));
  ProfilesConfigFileWriter.modifyOneProfile(modifiable,DEFAULT_PROFILE_NAME,newProfile);
  test.refresh();
  AWSCredentials updated=test.getCredentials(DEFAULT_PROFILE_NAME);
  assertEquals("newAccessKey",updated.getAWSAccessKeyId());
  assertEquals("newSecretKey",updated.getAWSSecretKey());
}
