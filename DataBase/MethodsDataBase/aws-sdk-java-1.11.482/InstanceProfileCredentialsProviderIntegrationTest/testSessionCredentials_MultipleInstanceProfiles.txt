/** 
 * Tests that we correctly handle the metadata service returning credentials when multiple instance profiles are available.
 */
@Test public void testSessionCredentials_MultipleInstanceProfiles() throws Exception {
  mockServer.setResponseFileName("sessionResponse");
  mockServer.setAvailableSecurityCredentials("test-credentials");
  InstanceProfileCredentialsProvider credentialsProvider=new InstanceProfileCredentialsProvider();
  AWSSessionCredentials credentials=(AWSSessionCredentials)credentialsProvider.getCredentials();
  assertEquals("ACCESS_KEY_ID",credentials.getAWSAccessKeyId());
  assertEquals("SECRET_ACCESS_KEY",credentials.getAWSSecretKey());
  assertEquals("TOKEN_TOKEN_TOKEN",credentials.getSessionToken());
}
