/** 
 * Customers may not need to explicitly configure a builder with a region if one can be found from the  {@link AwsRegionProvider} implementation. We mock the provider to yield consistentresults for the tests.
 */
@Test public void regionProvidedByChain_WhenRegionNotFoundInMetadata_ThrowsIllegalArgumentException(){
  try {
    RegionUtils.initializeWithMetadata(new RegionMetadata(Mockito.mock(RegionMetadataProvider.class)));
    AwsRegionProvider mockRegionProvider=mock(AwsRegionProvider.class);
    when(mockRegionProvider.getRegion()).thenReturn("ap-southeast-2");
    new ConcreteAsyncBuilder(mockRegionProvider).build();
    fail("Expected SdkClientException");
  }
 catch (  SdkClientException e) {
    assertThat(e.getMessage(),containsString("Could not find region information"));
  }
 finally {
    RegionUtils.initialize();
  }
}
