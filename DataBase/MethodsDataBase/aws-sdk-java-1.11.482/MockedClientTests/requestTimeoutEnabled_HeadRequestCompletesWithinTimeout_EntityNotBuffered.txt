/** 
 * Response to HEAD requests don't have an entity so we shouldn't try to wrap the response in a {@link BufferedHttpEntity}.
 */
@Test public void requestTimeoutEnabled_HeadRequestCompletesWithinTimeout_EntityNotBuffered() throws Exception {
  ClientConfiguration config=new ClientConfiguration().withRequestTimeout(5 * 1000).withMaxErrorRetry(0);
  ConnectionManagerAwareHttpClient rawHttpClient=createRawHttpClientSpy(config);
  HttpResponseProxy responseProxy=createHttpHeadResponseProxy();
  doReturn(responseProxy).when(rawHttpClient).execute(any(HttpHead.class),any(HttpContext.class));
  httpClient=new AmazonHttpClient(config,rawHttpClient,null);
  try {
    execute(httpClient,createMockHeadRequest());
    fail("Exception expected");
  }
 catch (  AmazonClientException e) {
    NullResponseHandler.assertIsUnmarshallingException(e);
  }
  assertNull(responseProxy.getEntity());
}
