@Test public void shouldCreateBuilderThatBuildsMeteredStoreWithCachingAndLoggingEnabled(){
  final MaterializedInternal<String,String,KeyValueStore<Bytes,byte[]>> materialized=new MaterializedInternal<>(Materialized.as("store"));
  materialized.generateStoreNameIfNeeded(nameProvider,storePrefix);
  final KeyValueStoreMaterializer<String,String> materializer=new KeyValueStoreMaterializer<>(materialized);
  final StoreBuilder<KeyValueStore<String,String>> builder=materializer.materialize();
  final KeyValueStore<String,String> store=builder.build();
  final WrappedStateStore caching=(WrappedStateStore)((WrappedStateStore)store).wrappedStore();
  final StateStore logging=caching.wrappedStore();
  assertThat(store,instanceOf(MeteredKeyValueStore.class));
  assertThat(caching,instanceOf(CachedStateStore.class));
  assertThat(logging,instanceOf(ChangeLoggingKeyValueBytesStore.class));
}
