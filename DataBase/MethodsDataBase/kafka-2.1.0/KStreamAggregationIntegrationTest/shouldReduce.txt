@Test public void shouldReduce() throws Exception {
  produceMessages(mockTime.milliseconds());
  groupedStream.reduce(reducer,Materialized.<String,String,KeyValueStore<Bytes,byte[]>>as("reduce-by-key")).toStream().to(outputTopic,Produced.with(Serdes.String(),Serdes.String()));
  startStreams();
  produceMessages(mockTime.milliseconds());
  final List<KeyValue<String,String>> results=receiveMessages(new StringDeserializer(),new StringDeserializer(),10);
  Collections.sort(results,KStreamAggregationIntegrationTest::compare);
  assertThat(results,is(Arrays.asList(KeyValue.pair("A","A"),KeyValue.pair("A","A:A"),KeyValue.pair("B","B"),KeyValue.pair("B","B:B"),KeyValue.pair("C","C"),KeyValue.pair("C","C:C"),KeyValue.pair("D","D"),KeyValue.pair("D","D:D"),KeyValue.pair("E","E"),KeyValue.pair("E","E:E"))));
}
