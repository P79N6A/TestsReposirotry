@Test public void testCountCoalesced(){
  final StreamsBuilder builder=new StreamsBuilder();
  final String input="count-test-input";
  final MockProcessorSupplier<String,Long> supplier=new MockProcessorSupplier<>();
  builder.table(input,consumed).groupBy(MockMapper.<String,String>selectValueKeyValueMapper(),stringSerialzied).count(Materialized.<String,Long,KeyValueStore<Bytes,byte[]>>as("count")).toStream().process(supplier);
  driver.setUp(builder,stateDir);
  final MockProcessor<String,Long> proc=supplier.theCapturedProcessor();
  driver.process(input,"A","green");
  driver.process(input,"B","green");
  driver.process(input,"A","blue");
  driver.process(input,"C","yellow");
  driver.process(input,"D","green");
  driver.flushState();
  assertEquals(Utils.mkList("blue:1","yellow:1","green:2"),proc.processed);
}
