@Test public void testDrivingInternalRepartitioningForwardingTimestampTopology(){
  driver=new TopologyTestDriver(createInternalRepartitioningWithValueTimestampTopology(),props);
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key1","value1@1000"));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key2","value2@2000"));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key3","value3@3000"));
  assertThat(driver.readOutput(OUTPUT_TOPIC_1,STRING_DESERIALIZER,STRING_DESERIALIZER),equalTo(new ProducerRecord<>(OUTPUT_TOPIC_1,null,1000L,"key1","value1")));
  assertThat(driver.readOutput(OUTPUT_TOPIC_1,STRING_DESERIALIZER,STRING_DESERIALIZER),equalTo(new ProducerRecord<>(OUTPUT_TOPIC_1,null,2000L,"key2","value2")));
  assertThat(driver.readOutput(OUTPUT_TOPIC_1,STRING_DESERIALIZER,STRING_DESERIALIZER),equalTo(new ProducerRecord<>(OUTPUT_TOPIC_1,null,3000L,"key3","value3")));
}
