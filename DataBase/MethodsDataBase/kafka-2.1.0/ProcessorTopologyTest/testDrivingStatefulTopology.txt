@Test public void testDrivingStatefulTopology(){
  final String storeName="entries";
  driver=new TopologyTestDriver(createStatefulTopology(storeName),props);
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key1","value1"));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key2","value2"));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key3","value3"));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key1","value4"));
  assertNoOutputRecord(OUTPUT_TOPIC_1);
  final KeyValueStore<String,String> store=driver.getKeyValueStore(storeName);
  assertEquals("value4",store.get("key1"));
  assertEquals("value2",store.get("key2"));
  assertEquals("value3",store.get("key3"));
  assertNull(store.get("key4"));
}
