@Test public void testDrivingSimpleTopology(){
  final int partition=10;
  driver=new TopologyTestDriver(createSimpleTopology(partition),props);
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key1","value1"));
  assertNextOutputRecord(OUTPUT_TOPIC_1,"key1","value1",partition);
  assertNoOutputRecord(OUTPUT_TOPIC_2);
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key2","value2"));
  assertNextOutputRecord(OUTPUT_TOPIC_1,"key2","value2",partition);
  assertNoOutputRecord(OUTPUT_TOPIC_2);
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key3","value3"));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key4","value4"));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC_1,"key5","value5"));
  assertNoOutputRecord(OUTPUT_TOPIC_2);
  assertNextOutputRecord(OUTPUT_TOPIC_1,"key3","value3",partition);
  assertNextOutputRecord(OUTPUT_TOPIC_1,"key4","value4",partition);
  assertNextOutputRecord(OUTPUT_TOPIC_1,"key5","value5",partition);
}
