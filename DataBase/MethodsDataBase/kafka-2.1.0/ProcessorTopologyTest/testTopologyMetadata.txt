@Test public void testTopologyMetadata(){
  topology.addSource("source-1","topic-1");
  topology.addSource("source-2","topic-2","topic-3");
  topology.addProcessor("processor-1",new MockProcessorSupplier<>(),"source-1");
  topology.addProcessor("processor-2",new MockProcessorSupplier<>(),"source-1","source-2");
  topology.addSink("sink-1","topic-3","processor-1");
  topology.addSink("sink-2","topic-4","processor-1","processor-2");
  final ProcessorTopology processorTopology=topology.getInternalBuilder("X").build();
  assertEquals(6,processorTopology.processors().size());
  assertEquals(2,processorTopology.sources().size());
  assertEquals(3,processorTopology.sourceTopics().size());
  assertNotNull(processorTopology.source("topic-1"));
  assertNotNull(processorTopology.source("topic-2"));
  assertNotNull(processorTopology.source("topic-3"));
  assertEquals(processorTopology.source("topic-2"),processorTopology.source("topic-3"));
}
