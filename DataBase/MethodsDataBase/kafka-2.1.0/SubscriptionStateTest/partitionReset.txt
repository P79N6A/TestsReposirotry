@Test public void partitionReset(){
  state.assignFromUser(singleton(tp0));
  state.seek(tp0,5);
  assertEquals(5L,(long)state.position(tp0));
  state.requestOffsetReset(tp0);
  assertFalse(state.isFetchable(tp0));
  assertTrue(state.isOffsetResetNeeded(tp0));
  assertEquals(null,state.position(tp0));
  state.seek(tp0,0);
  assertTrue(state.isFetchable(tp0));
  assertFalse(state.isOffsetResetNeeded(tp0));
}
