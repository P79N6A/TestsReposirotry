@Test public void verifyAssignmentListener(){
  final AtomicReference<Set<TopicPartition>> assignmentRef=new AtomicReference<>();
  state.addListener(new SubscriptionState.Listener(){
    @Override public void onAssignment(    Set<TopicPartition> assignment){
      assignmentRef.set(assignment);
    }
  }
);
  Set<TopicPartition> userAssignment=Utils.mkSet(tp0,tp1);
  state.assignFromUser(userAssignment);
  assertEquals(userAssignment,assignmentRef.get());
  state.unsubscribe();
  assertEquals(Collections.emptySet(),assignmentRef.get());
  Set<TopicPartition> autoAssignment=Utils.mkSet(t1p0);
  state.subscribe(singleton(topic1),rebalanceListener);
  state.assignFromSubscribed(autoAssignment);
  assertEquals(autoAssignment,assignmentRef.get());
}
