@Test public void unsubscription(){
  state.subscribe(Pattern.compile(".*"),rebalanceListener);
  state.subscribeFromPattern(new HashSet<>(Arrays.asList(topic,topic1)));
  state.assignFromSubscribed(singleton(tp1));
  assertEquals(singleton(tp1),state.assignedPartitions());
  assertEquals(1,state.numAssignedPartitions());
  state.unsubscribe();
  assertEquals(0,state.subscription().size());
  assertTrue(state.assignedPartitions().isEmpty());
  assertEquals(0,state.numAssignedPartitions());
  state.assignFromUser(singleton(tp0));
  assertEquals(singleton(tp0),state.assignedPartitions());
  assertEquals(1,state.numAssignedPartitions());
  state.unsubscribe();
  assertEquals(0,state.subscription().size());
  assertTrue(state.assignedPartitions().isEmpty());
  assertEquals(0,state.numAssignedPartitions());
}
