@Test public void partitionAssignment(){
  state.assignFromUser(singleton(tp0));
  assertEquals(singleton(tp0),state.assignedPartitions());
  assertEquals(1,state.numAssignedPartitions());
  assertFalse(state.hasAllFetchPositions());
  state.seek(tp0,1);
  assertTrue(state.isFetchable(tp0));
  assertEquals(1L,state.position(tp0).longValue());
  state.assignFromUser(Collections.<TopicPartition>emptySet());
  assertTrue(state.assignedPartitions().isEmpty());
  assertEquals(0,state.numAssignedPartitions());
  assertFalse(state.isAssigned(tp0));
  assertFalse(state.isFetchable(tp0));
}
