@Test public void shouldCaptureCommitsAndAllowReset(){
  final AbstractProcessor<String,Long> processor=new AbstractProcessor<String,Long>(){
    private int count=0;
    @Override public void process(    final String key,    final Long value){
      if (++count > 2)       context().commit();
    }
  }
;
  final MockProcessorContext context=new MockProcessorContext();
  processor.init(context);
  processor.process("foo",5L);
  processor.process("barbaz",50L);
  assertFalse(context.committed());
  processor.process("foobar",500L);
  assertTrue(context.committed());
  context.resetCommit();
  assertFalse(context.committed());
}
