@Test public void shouldUpdateStateWithReceivedRecordsForAllTopicPartition(){
  stateConsumer.initialize();
  consumer.addRecord(new ConsumerRecord<>("topic-one",1,20L,new byte[0],new byte[0]));
  consumer.addRecord(new ConsumerRecord<>("topic-two",1,31L,new byte[0],new byte[0]));
  consumer.addRecord(new ConsumerRecord<>("topic-two",1,32L,new byte[0],new byte[0]));
  stateConsumer.pollAndUpdate();
  assertEquals(1,stateMaintainer.updatedPartitions.get(topicOne).intValue());
  assertEquals(2,stateMaintainer.updatedPartitions.get(topicTwo).intValue());
}
