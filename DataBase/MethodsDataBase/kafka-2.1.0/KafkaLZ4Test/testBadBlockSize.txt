@Test public void testBadBlockSize() throws Exception {
  if (!close || (useBrokenFlagDescriptorChecksum && !ignoreFlagDescriptorChecksum))   return;
  thrown.expect(IOException.class);
  thrown.expectMessage(CoreMatchers.containsString("exceeded max"));
  byte[] compressed=compressedBytes();
  final ByteBuffer buffer=ByteBuffer.wrap(compressed).order(ByteOrder.LITTLE_ENDIAN);
  int blockSize=buffer.getInt(7);
  blockSize=(blockSize & LZ4_FRAME_INCOMPRESSIBLE_MASK) | (1 << 24 & ~LZ4_FRAME_INCOMPRESSIBLE_MASK);
  buffer.putInt(7,blockSize);
  testDecompression(buffer);
}
