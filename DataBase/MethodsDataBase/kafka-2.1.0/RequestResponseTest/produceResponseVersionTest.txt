@Test public void produceResponseVersionTest(){
  Map<TopicPartition,ProduceResponse.PartitionResponse> responseData=new HashMap<>();
  responseData.put(new TopicPartition("test",0),new ProduceResponse.PartitionResponse(Errors.NONE,10000,RecordBatch.NO_TIMESTAMP,100));
  ProduceResponse v0Response=new ProduceResponse(responseData);
  ProduceResponse v1Response=new ProduceResponse(responseData,10);
  ProduceResponse v2Response=new ProduceResponse(responseData,10);
  assertEquals("Throttle time must be zero",0,v0Response.throttleTimeMs());
  assertEquals("Throttle time must be 10",10,v1Response.throttleTimeMs());
  assertEquals("Throttle time must be 10",10,v2Response.throttleTimeMs());
  assertEquals("Should use schema version 0",ApiKeys.PRODUCE.responseSchema((short)0),v0Response.toStruct((short)0).schema());
  assertEquals("Should use schema version 1",ApiKeys.PRODUCE.responseSchema((short)1),v1Response.toStruct((short)1).schema());
  assertEquals("Should use schema version 2",ApiKeys.PRODUCE.responseSchema((short)2),v2Response.toStruct((short)2).schema());
  assertEquals("Response data does not match",responseData,v0Response.responses());
  assertEquals("Response data does not match",responseData,v1Response.responses());
  assertEquals("Response data does not match",responseData,v2Response.responses());
}
