@Test public void produceResponseV5Test(){
  Map<TopicPartition,ProduceResponse.PartitionResponse> responseData=new HashMap<>();
  TopicPartition tp0=new TopicPartition("test",0);
  responseData.put(tp0,new ProduceResponse.PartitionResponse(Errors.NONE,10000,RecordBatch.NO_TIMESTAMP,100));
  ProduceResponse v5Response=new ProduceResponse(responseData,10);
  short version=5;
  ByteBuffer buffer=v5Response.serialize(version,new ResponseHeader(0));
  buffer.rewind();
  ResponseHeader.parse(buffer);
  Struct deserializedStruct=ApiKeys.PRODUCE.parseResponse(version,buffer);
  ProduceResponse v5FromBytes=(ProduceResponse)AbstractResponse.parseResponse(ApiKeys.PRODUCE,deserializedStruct);
  assertEquals(1,v5FromBytes.responses().size());
  assertTrue(v5FromBytes.responses().containsKey(tp0));
  ProduceResponse.PartitionResponse partitionResponse=v5FromBytes.responses().get(tp0);
  assertEquals(100,partitionResponse.logStartOffset);
  assertEquals(10000,partitionResponse.baseOffset);
  assertEquals(10,v5FromBytes.throttleTimeMs());
  assertEquals(responseData,v5Response.responses());
}
