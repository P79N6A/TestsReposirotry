@Test public void produceRequestToStringTest(){
  ProduceRequest request=createProduceRequest(ApiKeys.PRODUCE.latestVersion());
  assertEquals(1,request.partitionRecordsOrFail().size());
  assertFalse(request.toString(false).contains("partitionSizes"));
  assertTrue(request.toString(false).contains("numPartitions=1"));
  assertTrue(request.toString(true).contains("partitionSizes"));
  assertFalse(request.toString(true).contains("numPartitions"));
  request.clearPartitionRecords();
  try {
    request.partitionRecordsOrFail();
    fail("partitionRecordsOrFail should fail after clearPartitionRecords()");
  }
 catch (  IllegalStateException e) {
  }
  assertFalse(request.toString(false).contains("partitionSizes"));
  assertTrue(request.toString(false).contains("numPartitions=1"));
  assertTrue(request.toString(true).contains("partitionSizes"));
  assertFalse(request.toString(true).contains("numPartitions"));
}
