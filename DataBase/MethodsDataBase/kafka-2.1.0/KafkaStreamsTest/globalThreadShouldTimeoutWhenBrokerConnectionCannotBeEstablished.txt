@Test public void globalThreadShouldTimeoutWhenBrokerConnectionCannotBeEstablished(){
  final Properties props=new Properties();
  props.put(StreamsConfig.APPLICATION_ID_CONFIG,"appId");
  props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG,"localhost:1");
  props.put(StreamsConfig.METRIC_REPORTER_CLASSES_CONFIG,MockMetricsReporter.class.getName());
  props.put(StreamsConfig.STATE_DIR_CONFIG,TestUtils.tempDirectory().getPath());
  props.put(StreamsConfig.NUM_STREAM_THREADS_CONFIG,NUM_THREADS);
  props.put(ConsumerConfig.DEFAULT_API_TIMEOUT_MS_CONFIG,200);
  builder.globalTable("anyTopic");
  final KafkaStreams streams=new KafkaStreams(builder.build(),props);
  try {
    streams.start();
    fail("expected start() to time out and throw an exception.");
  }
 catch (  final StreamsException expected) {
  }
 finally {
    streams.close();
  }
}
