@Test public void testInitializesAndDestroysMetricsReporters(){
  final int oldInitCount=MockMetricsReporter.INIT_COUNT.get();
  final KafkaStreams streams=new KafkaStreams(builder.build(),props);
  try {
    final int newInitCount=MockMetricsReporter.INIT_COUNT.get();
    final int initDiff=newInitCount - oldInitCount;
    assertTrue("some reporters should be initialized by calling on construction",initDiff > 0);
    streams.start();
    final int oldCloseCount=MockMetricsReporter.CLOSE_COUNT.get();
    streams.close();
    assertEquals(oldCloseCount + initDiff,MockMetricsReporter.CLOSE_COUNT.get());
  }
  finally {
    streams.close();
  }
}
