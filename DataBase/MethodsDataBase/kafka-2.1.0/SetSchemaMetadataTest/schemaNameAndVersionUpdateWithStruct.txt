@Test public void schemaNameAndVersionUpdateWithStruct(){
  final String fieldName1="f1";
  final String fieldName2="f2";
  final String fieldValue1="value1";
  final int fieldValue2=1;
  final Schema schema=SchemaBuilder.struct().name("my.orig.SchemaDefn").field(fieldName1,Schema.STRING_SCHEMA).field(fieldName2,Schema.INT32_SCHEMA).build();
  final Struct value=new Struct(schema).put(fieldName1,fieldValue1).put(fieldName2,fieldValue2);
  final Map<String,String> props=new HashMap<>();
  props.put("schema.name","foo");
  props.put("schema.version","42");
  xform.configure(props);
  final SinkRecord record=new SinkRecord("",0,null,null,schema,value,0);
  final SinkRecord updatedRecord=xform.apply(record);
  assertEquals("foo",updatedRecord.valueSchema().name());
  assertEquals(new Integer(42),updatedRecord.valueSchema().version());
  assertMatchingSchema((Struct)updatedRecord.value(),updatedRecord.valueSchema());
}
