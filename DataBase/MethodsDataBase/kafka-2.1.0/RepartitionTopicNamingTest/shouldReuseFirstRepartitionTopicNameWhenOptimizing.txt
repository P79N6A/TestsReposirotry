@Test public void shouldReuseFirstRepartitionTopicNameWhenOptimizing(){
  final String optimizedTopology=buildTopology(StreamsConfig.OPTIMIZE).describe().toString();
  final String unOptimizedTopology=buildTopology(StreamsConfig.NO_OPTIMIZATION).describe().toString();
  final Pattern repartitionTopicPattern=Pattern.compile("Sink: .*-repartition");
  assertThat(optimizedTopology,is(EXPECTED_OPTIMIZED_TOPOLOGY));
  assertThat(1,is(getCountOfRepartitionTopicsFound(optimizedTopology,repartitionTopicPattern)));
  assertTrue(optimizedTopology.contains(firstRepartitionTopicName + "-repartition"));
  assertThat(unOptimizedTopology,is(EXPECTED_UNOPTIMIZED_TOPOLOGY));
  assertThat(4,is(getCountOfRepartitionTopicsFound(unOptimizedTopology,repartitionTopicPattern)));
  assertTrue(unOptimizedTopology.contains(firstRepartitionTopicName + "-repartition"));
  assertTrue(unOptimizedTopology.contains(secondRepartitionTopicName + "-repartition"));
  assertTrue(unOptimizedTopology.contains(thirdRepartitionTopicName + "-repartition"));
  assertTrue(unOptimizedTopology.contains(fourthRepartitionTopicName + "-left-repartition"));
}
