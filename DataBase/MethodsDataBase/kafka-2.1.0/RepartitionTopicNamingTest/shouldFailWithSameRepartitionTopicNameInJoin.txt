@Test public void shouldFailWithSameRepartitionTopicNameInJoin(){
  try {
    final StreamsBuilder builder=new StreamsBuilder();
    final KStream<String,String> stream1=builder.<String,String>stream("topic").selectKey((k,v) -> k);
    final KStream<String,String> stream2=builder.<String,String>stream("topic2").selectKey((k,v) -> k);
    final KStream<String,String> stream3=builder.<String,String>stream("topic3").selectKey((k,v) -> k);
    final KStream<String,String> joined=stream1.join(stream2,(v1,v2) -> v1 + v2,JoinWindows.of(30),Joined.named("join-repartition"));
    joined.join(stream3,(v1,v2) -> v1 + v2,JoinWindows.of(30),Joined.named("join-repartition"));
    builder.build();
    fail("Should not build re-using repartition topic name");
  }
 catch (  final TopologyException te) {
  }
}
