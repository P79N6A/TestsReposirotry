@Test public void shouldReduceWindowed(){
  final Map<Windowed<String>,String> results=new HashMap<>();
  windowedStream.reduce(MockReducer.STRING_ADDER).toStream().foreach(new ForeachAction<Windowed<String>,String>(){
    @Override public void apply(    final Windowed<String> key,    final String value){
      results.put(key,value);
    }
  }
);
  try (final TopologyTestDriver driver=new TopologyTestDriver(builder.build(),props,0L)){
    processData(driver);
  }
   assertThat(results.get(new Windowed<>("1",new TimeWindow(0,500))),equalTo("1+2"));
  assertThat(results.get(new Windowed<>("2",new TimeWindow(500,1000))),equalTo("1"));
  assertThat(results.get(new Windowed<>("1",new TimeWindow(500,1000))),equalTo("3"));
}
