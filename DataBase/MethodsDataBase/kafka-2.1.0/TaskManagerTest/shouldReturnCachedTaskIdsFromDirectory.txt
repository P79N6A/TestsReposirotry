@Test public void shouldReturnCachedTaskIdsFromDirectory() throws IOException {
  final File[] taskFolders=Utils.mkList(testFolder.newFolder("0_1"),testFolder.newFolder("0_2"),testFolder.newFolder("0_3"),testFolder.newFolder("1_1"),testFolder.newFolder("dummy")).toArray(new File[0]);
  assertTrue((new File(taskFolders[0],ProcessorStateManager.CHECKPOINT_FILE_NAME)).createNewFile());
  assertTrue((new File(taskFolders[1],ProcessorStateManager.CHECKPOINT_FILE_NAME)).createNewFile());
  assertTrue((new File(taskFolders[3],ProcessorStateManager.CHECKPOINT_FILE_NAME)).createNewFile());
  expect(activeTaskCreator.stateDirectory()).andReturn(stateDirectory).once();
  expect(stateDirectory.listTaskDirectories()).andReturn(taskFolders).once();
  EasyMock.replay(activeTaskCreator,stateDirectory);
  final Set<TaskId> tasks=taskManager.cachedTasksIds();
  EasyMock.verify(activeTaskCreator,stateDirectory);
  assertThat(tasks,equalTo(Utils.mkSet(task01,task02,task11)));
}
