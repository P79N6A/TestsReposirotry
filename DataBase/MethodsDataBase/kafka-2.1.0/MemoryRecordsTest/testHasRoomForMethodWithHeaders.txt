@Test public void testHasRoomForMethodWithHeaders(){
  if (magic >= RecordBatch.MAGIC_VALUE_V2) {
    MemoryRecordsBuilder builder=MemoryRecords.builder(ByteBuffer.allocate(100),magic,compression,TimestampType.CREATE_TIME,0L);
    RecordHeaders headers=new RecordHeaders();
    headers.add("hello","world.world".getBytes());
    headers.add("hello","world.world".getBytes());
    headers.add("hello","world.world".getBytes());
    headers.add("hello","world.world".getBytes());
    headers.add("hello","world.world".getBytes());
    builder.append(logAppendTime,"key".getBytes(),"value".getBytes());
    assertTrue(builder.hasRoomFor(logAppendTime,"key".getBytes(),"value".getBytes(),Record.EMPTY_HEADERS));
    assertFalse(builder.hasRoomFor(logAppendTime,"key".getBytes(),"value".getBytes(),headers.toArray()));
  }
}
