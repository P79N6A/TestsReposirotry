@Test public void testOuterRepartitioned() throws Exception {
  STREAMS_CONFIG.put(StreamsConfig.APPLICATION_ID_CONFIG,appID + "-outer");
  final List<List<String>> expectedResult=Arrays.asList(null,null,Collections.singletonList("A-null"),Collections.singletonList("A-a"),Collections.singletonList("B-a"),Arrays.asList("A-b","B-b"),null,null,Arrays.asList("C-a","C-b"),Arrays.asList("A-c","B-c","C-c"),null,null,null,Arrays.asList("A-d","B-d","C-d"),Arrays.asList("D-a","D-b","D-c","D-d"));
  leftStream.map(MockMapper.<Long,String>noOpKeyValueMapper()).outerJoin(rightStream.flatMap(MockMapper.<Long,String>noOpFlatKeyValueMapper()).selectKey(MockMapper.<Long,String>selectKeyKeyValueMapper()),valueJoiner,JoinWindows.of(ofSeconds(10))).to(OUTPUT_TOPIC);
  runTest(expectedResult);
}
