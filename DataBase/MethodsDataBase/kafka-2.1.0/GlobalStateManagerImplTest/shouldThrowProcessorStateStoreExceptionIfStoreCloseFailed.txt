@Test(expected=ProcessorStateException.class) public void shouldThrowProcessorStateStoreExceptionIfStoreCloseFailed() throws IOException {
  stateManager.initialize();
  initializeConsumer(1,1,t1);
  stateManager.register(new NoOpReadOnlyStore(store1.name()){
    @Override public void close(){
      throw new RuntimeException("KABOOM!");
    }
  }
,stateRestoreCallback);
  stateManager.close(Collections.<TopicPartition,Long>emptyMap());
}
