@Test public void shouldCheckpointOffsets() throws IOException {
  final Map<TopicPartition,Long> offsets=Collections.singletonMap(t1,25L);
  stateManager.initialize();
  stateManager.checkpoint(offsets);
  final Map<TopicPartition,Long> result=readOffsetsCheckpoint();
  assertThat(result,equalTo(offsets));
  assertThat(stateManager.checkpointed(),equalTo(offsets));
}
