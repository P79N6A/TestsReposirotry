@Test public void testReloadOnStartWithNoNewRecordsPresent() throws Exception {
  expectStart();
  expectStop();
  PowerMock.replayAll();
  Map<TopicPartition,Long> endOffsets=new HashMap<>();
  endOffsets.put(TP0,7L);
  endOffsets.put(TP1,7L);
  consumer.updateEndOffsets(endOffsets);
  consumer.updateBeginningOffsets(endOffsets);
  consumer.schedulePollTask(new Runnable(){
    @Override public void run(){
      throw new WakeupException();
    }
  }
);
  store.start();
  assertEquals(CONSUMER_ASSIGNMENT,consumer.assignment());
  assertEquals(7L,consumer.position(TP0));
  assertEquals(7L,consumer.position(TP1));
  store.stop();
  assertFalse(Whitebox.<Thread>getInternalState(store,"thread").isAlive());
  assertTrue(consumer.closed());
  PowerMock.verifyAll();
}
