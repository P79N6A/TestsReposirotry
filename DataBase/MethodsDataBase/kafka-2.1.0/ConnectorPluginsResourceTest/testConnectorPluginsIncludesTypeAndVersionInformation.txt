@Test public void testConnectorPluginsIncludesTypeAndVersionInformation() throws Exception {
  expectPlugins();
  ConnectorPluginInfo sinkInfo=newInfo(TestSinkConnector.class);
  ConnectorPluginInfo sourceInfo=newInfo(TestSourceConnector.class);
  ConnectorPluginInfo unknownInfo=newInfo(ConnectorPluginsResourceTestConnector.class);
  assertEquals(ConnectorType.SINK,sinkInfo.type());
  assertEquals(ConnectorType.SOURCE,sourceInfo.type());
  assertEquals(ConnectorType.UNKNOWN,unknownInfo.type());
  assertEquals(TestSinkConnector.VERSION,sinkInfo.version());
  assertEquals(TestSourceConnector.VERSION,sourceInfo.version());
  final ObjectMapper objectMapper=new ObjectMapper();
  String serializedSink=objectMapper.writeValueAsString(ConnectorType.SINK);
  String serializedSource=objectMapper.writeValueAsString(ConnectorType.SOURCE);
  String serializedUnknown=objectMapper.writeValueAsString(ConnectorType.UNKNOWN);
  assertTrue(serializedSink.contains("sink"));
  assertTrue(serializedSource.contains("source"));
  assertTrue(serializedUnknown.contains("unknown"));
  assertEquals(ConnectorType.SINK,objectMapper.readValue(serializedSink,ConnectorType.class));
  assertEquals(ConnectorType.SOURCE,objectMapper.readValue(serializedSource,ConnectorType.class));
  assertEquals(ConnectorType.UNKNOWN,objectMapper.readValue(serializedUnknown,ConnectorType.class));
}
