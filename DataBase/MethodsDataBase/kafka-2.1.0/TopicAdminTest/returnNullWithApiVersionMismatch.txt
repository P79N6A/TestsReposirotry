/** 
 * 0.11.0.0 clients can talk with older brokers, but the CREATE_TOPIC API was added in 0.10.1.0. That means, if our TopicAdmin talks to a pre 0.10.1 broker, it should receive an UnsupportedVersionException, should create no topics, and return false.
 */
@Test public void returnNullWithApiVersionMismatch(){
  final NewTopic newTopic=TopicAdmin.defineTopic("myTopic").partitions(1).compacted().build();
  Cluster cluster=createCluster(1);
  try (AdminClientUnitTestEnv env=new AdminClientUnitTestEnv(cluster)){
    env.kafkaClient().setNode(cluster.controller());
    env.kafkaClient().setNodeApiVersions(NodeApiVersions.create());
    env.kafkaClient().prepareResponse(createTopicResponseWithUnsupportedVersion(newTopic));
    TopicAdmin admin=new TopicAdmin(null,env.adminClient());
    boolean created=admin.createTopic(newTopic);
    assertFalse(created);
  }
 }
