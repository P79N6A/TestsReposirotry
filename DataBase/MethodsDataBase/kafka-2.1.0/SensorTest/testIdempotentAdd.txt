@Test public void testIdempotentAdd(){
  final Metrics metrics=new Metrics();
  final Sensor sensor=metrics.sensor("sensor");
  assertTrue(sensor.add(metrics.metricName("test-metric","test-group"),new Avg()));
  assertTrue(sensor.add(metrics.metricName("test-metric","test-group"),new Avg()));
  final Sensor anotherSensor=metrics.sensor("another-sensor");
  try {
    anotherSensor.add(metrics.metricName("test-metric","test-group"),new Avg());
    fail("should have thrown");
  }
 catch (  final IllegalArgumentException ignored) {
  }
  assertTrue(sensor.add(metrics.metricName("test-metric","test-group"),new Sum()));
  assertEquals(1,sensor.metrics().size());
  assertEquals(org.apache.kafka.common.metrics.stats.Avg.class,sensor.metrics().get(0).measurable().getClass());
}
