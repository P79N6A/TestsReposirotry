@SuppressWarnings("unchecked") @Test public void shouldTransitionToDeadOnClose() throws InterruptedException {
  initializeConsumer();
  globalStreamThread.start();
  globalStreamThread.shutdown();
  globalStreamThread.join();
  assertEquals(GlobalStreamThread.State.DEAD,globalStreamThread.state());
}
