@Test public void testSetCreateTimeV1(){
  MemoryRecords records=MemoryRecords.withRecords(RecordBatch.MAGIC_VALUE_V1,0L,CompressionType.GZIP,TimestampType.CREATE_TIME,new SimpleRecord(1L,"a".getBytes(),"1".getBytes()),new SimpleRecord(2L,"b".getBytes(),"2".getBytes()),new SimpleRecord(3L,"c".getBytes(),"3".getBytes()));
  long createTime=15L;
  ByteBufferLegacyRecordBatch batch=new ByteBufferLegacyRecordBatch(records.buffer());
  batch.setMaxTimestamp(TimestampType.CREATE_TIME,createTime);
  assertEquals(TimestampType.CREATE_TIME,batch.timestampType());
  assertEquals(createTime,batch.maxTimestamp());
  assertTrue(batch.isValid());
  List<MutableRecordBatch> recordBatches=Utils.toList(records.batches().iterator());
  assertEquals(1,recordBatches.size());
  assertEquals(TimestampType.CREATE_TIME,recordBatches.get(0).timestampType());
  assertEquals(createTime,recordBatches.get(0).maxTimestamp());
  long expectedTimestamp=1L;
  for (  Record record : records.records())   assertEquals(expectedTimestamp++,record.timestamp());
}
