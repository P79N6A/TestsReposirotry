@Test(expected=UnsupportedOperationException.class) public void testSetLogAppendTimeNotAllowedV0(){
  MemoryRecords records=MemoryRecords.withRecords(RecordBatch.MAGIC_VALUE_V0,0L,CompressionType.GZIP,TimestampType.CREATE_TIME,new SimpleRecord(1L,"a".getBytes(),"1".getBytes()),new SimpleRecord(2L,"b".getBytes(),"2".getBytes()),new SimpleRecord(3L,"c".getBytes(),"3".getBytes()));
  long logAppendTime=15L;
  ByteBufferLegacyRecordBatch batch=new ByteBufferLegacyRecordBatch(records.buffer());
  batch.setMaxTimestamp(TimestampType.LOG_APPEND_TIME,logAppendTime);
}
