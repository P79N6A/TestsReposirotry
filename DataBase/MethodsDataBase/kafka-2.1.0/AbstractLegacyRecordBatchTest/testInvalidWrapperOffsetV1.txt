@Test(expected=InvalidRecordException.class) public void testInvalidWrapperOffsetV1(){
  SimpleRecord[] simpleRecords=new SimpleRecord[]{new SimpleRecord(1L,"a".getBytes(),"1".getBytes()),new SimpleRecord(2L,"b".getBytes(),"2".getBytes()),new SimpleRecord(3L,"c".getBytes(),"3".getBytes())};
  MemoryRecords records=MemoryRecords.withRecords(RecordBatch.MAGIC_VALUE_V1,0L,CompressionType.GZIP,TimestampType.CREATE_TIME,simpleRecords);
  ByteBufferLegacyRecordBatch batch=new ByteBufferLegacyRecordBatch(records.buffer());
  batch.setLastOffset(1L);
  batch.iterator();
}
