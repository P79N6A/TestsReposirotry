@Test(expected=IllegalArgumentException.class) public void testSetNoTimestampTypeNotAllowed(){
  MemoryRecords records=MemoryRecords.withRecords(RecordBatch.MAGIC_VALUE_V1,0L,CompressionType.GZIP,TimestampType.CREATE_TIME,new SimpleRecord(1L,"a".getBytes(),"1".getBytes()),new SimpleRecord(2L,"b".getBytes(),"2".getBytes()),new SimpleRecord(3L,"c".getBytes(),"3".getBytes()));
  ByteBufferLegacyRecordBatch batch=new ByteBufferLegacyRecordBatch(records.buffer());
  batch.setMaxTimestamp(TimestampType.NO_TIMESTAMP_TYPE,RecordBatch.NO_TIMESTAMP);
}
