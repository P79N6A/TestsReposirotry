@Test public void shouldMaterializeAggregated(){
  stream.aggregate(MockInitializer.STRING_INIT,MockAggregator.TOSTRING_ADDER,sessionMerger,Materialized.<String,String,SessionStore<Bytes,byte[]>>as("aggregated").withValueSerde(Serdes.String()));
  try (final TopologyTestDriver driver=new TopologyTestDriver(builder.build(),props,0L)){
    processData(driver);
    final SessionStore<String,String> sessionStore=driver.getSessionStore("aggregated");
    final List<KeyValue<Windowed<String>,String>> data=StreamsTestUtils.toList(sessionStore.fetch("1","2"));
    assertThat(data,equalTo(Arrays.asList(KeyValue.pair(new Windowed<>("1",new SessionWindow(10,15)),"0+0+1+2"),KeyValue.pair(new Windowed<>("1",new SessionWindow(600,600)),"0+3"),KeyValue.pair(new Windowed<>("2",new SessionWindow(600,600)),"0+1"))));
  }
 }
