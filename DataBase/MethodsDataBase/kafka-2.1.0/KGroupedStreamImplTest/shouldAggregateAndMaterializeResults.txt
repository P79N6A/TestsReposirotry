@SuppressWarnings("unchecked") @Test public void shouldAggregateAndMaterializeResults(){
  groupedStream.aggregate(MockInitializer.STRING_INIT,MockAggregator.TOSTRING_ADDER,Materialized.<String,String,KeyValueStore<Bytes,byte[]>>as("aggregate").withKeySerde(Serdes.String()).withValueSerde(Serdes.String()));
  try (final TopologyTestDriver driver=new TopologyTestDriver(builder.build(),props)){
    processData(driver);
    final KeyValueStore<String,String> aggregate=driver.getKeyValueStore("aggregate");
    assertThat(aggregate.get("1"),equalTo("0+A+C+D"));
    assertThat(aggregate.get("2"),equalTo("0+B"));
    assertThat(aggregate.get("3"),equalTo("0+E+F"));
  }
 }
