@Test public void testStructAddField() throws Exception {
  Schema source=SchemaBuilder.struct().field("field",Schema.INT32_SCHEMA).build();
  Struct sourceStruct=new Struct(source);
  sourceStruct.put("field",1);
  Schema target=SchemaBuilder.struct().field("field",Schema.INT32_SCHEMA).field("field2",SchemaBuilder.int32().defaultValue(123).build()).build();
  Struct targetStruct=(Struct)SchemaProjector.project(source,sourceStruct,target);
  assertEquals(1,(int)targetStruct.getInt32("field"));
  assertEquals(123,(int)targetStruct.getInt32("field2"));
  Schema incompatibleTargetSchema=SchemaBuilder.struct().field("field",Schema.INT32_SCHEMA).field("field2",Schema.INT32_SCHEMA).build();
  try {
    SchemaProjector.project(source,sourceStruct,incompatibleTargetSchema);
    fail("Incompatible schema.");
  }
 catch (  DataException e) {
  }
}
