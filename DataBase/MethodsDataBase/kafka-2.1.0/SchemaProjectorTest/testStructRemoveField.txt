@Test public void testStructRemoveField() throws Exception {
  Schema source=SchemaBuilder.struct().field("field",Schema.INT32_SCHEMA).field("field2",Schema.INT32_SCHEMA).build();
  Struct sourceStruct=new Struct(source);
  sourceStruct.put("field",1);
  sourceStruct.put("field2",234);
  Schema target=SchemaBuilder.struct().field("field",Schema.INT32_SCHEMA).build();
  Struct targetStruct=(Struct)SchemaProjector.project(source,sourceStruct,target);
  assertEquals(1,targetStruct.get("field"));
  try {
    targetStruct.get("field2");
    fail("field2 is not part of the projected struct");
  }
 catch (  DataException e) {
  }
}
