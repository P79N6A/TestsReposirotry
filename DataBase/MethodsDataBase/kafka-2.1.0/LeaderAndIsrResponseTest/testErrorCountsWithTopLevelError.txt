@Test public void testErrorCountsWithTopLevelError(){
  Map<TopicPartition,Errors> errors=new HashMap<>();
  errors.put(new TopicPartition("foo",0),Errors.NONE);
  errors.put(new TopicPartition("foo",1),Errors.NOT_LEADER_FOR_PARTITION);
  LeaderAndIsrResponse response=new LeaderAndIsrResponse(Errors.UNKNOWN_SERVER_ERROR,errors);
  assertEquals(Collections.singletonMap(Errors.UNKNOWN_SERVER_ERROR,2),response.errorCounts());
}
