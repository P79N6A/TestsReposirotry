@Test public void testErrorCountsNoTopLevelError(){
  Map<TopicPartition,Errors> errors=new HashMap<>();
  errors.put(new TopicPartition("foo",0),Errors.NONE);
  errors.put(new TopicPartition("foo",1),Errors.CLUSTER_AUTHORIZATION_FAILED);
  LeaderAndIsrResponse response=new LeaderAndIsrResponse(Errors.NONE,errors);
  Map<Errors,Integer> errorCounts=response.errorCounts();
  assertEquals(2,errorCounts.size());
  assertEquals(1,errorCounts.get(Errors.NONE).intValue());
  assertEquals(1,errorCounts.get(Errors.CLUSTER_AUTHORIZATION_FAILED).intValue());
}
