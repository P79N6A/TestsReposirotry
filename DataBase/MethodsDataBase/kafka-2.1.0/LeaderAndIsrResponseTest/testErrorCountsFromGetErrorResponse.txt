@Test public void testErrorCountsFromGetErrorResponse(){
  HashMap<TopicPartition,LeaderAndIsrRequest.PartitionState> partitionStates=new HashMap<>();
  partitionStates.put(new TopicPartition("foo",0),new LeaderAndIsrRequest.PartitionState(15,1,10,Collections.singletonList(10),20,Collections.singletonList(10),false));
  partitionStates.put(new TopicPartition("foo",1),new LeaderAndIsrRequest.PartitionState(15,1,10,Collections.singletonList(10),20,Collections.singletonList(10),false));
  LeaderAndIsrRequest request=new LeaderAndIsrRequest.Builder(ApiKeys.LEADER_AND_ISR.latestVersion(),15,20,partitionStates,Collections.<Node>emptySet()).build();
  LeaderAndIsrResponse response=request.getErrorResponse(0,Errors.CLUSTER_AUTHORIZATION_FAILED.exception());
  assertEquals(Collections.singletonMap(Errors.CLUSTER_AUTHORIZATION_FAILED,2),response.errorCounts());
}
