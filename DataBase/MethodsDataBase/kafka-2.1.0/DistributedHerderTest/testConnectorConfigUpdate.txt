@Test public void testConnectorConfigUpdate() throws Exception {
  EasyMock.expect(member.memberId()).andStubReturn("member");
  EasyMock.expect(worker.connectorNames()).andStubReturn(Collections.singleton(CONN1));
  expectRebalance(1,Arrays.asList(CONN1),Collections.<ConnectorTaskId>emptyList());
  expectPostRebalanceCatchup(SNAPSHOT);
  worker.startConnector(EasyMock.eq(CONN1),EasyMock.<Map<String,String>>anyObject(),EasyMock.<ConnectorContext>anyObject(),EasyMock.eq(herder),EasyMock.eq(TargetState.STARTED));
  PowerMock.expectLastCall().andReturn(true);
  EasyMock.expect(worker.getPlugins()).andReturn(plugins);
  EasyMock.expect(worker.isRunning(CONN1)).andReturn(true);
  EasyMock.expect(worker.connectorTaskConfigs(CONN1,conn1SinkConfig)).andReturn(TASK_CONFIGS);
  member.poll(EasyMock.anyInt());
  PowerMock.expectLastCall();
  member.wakeup();
  member.ensureActive();
  PowerMock.expectLastCall();
  EasyMock.expect(configBackingStore.snapshot()).andReturn(SNAPSHOT);
  worker.stopConnector(CONN1);
  PowerMock.expectLastCall().andReturn(true);
  worker.startConnector(EasyMock.eq(CONN1),EasyMock.<Map<String,String>>anyObject(),EasyMock.<ConnectorContext>anyObject(),EasyMock.eq(herder),EasyMock.eq(TargetState.STARTED));
  PowerMock.expectLastCall().andReturn(true);
  EasyMock.expect(worker.getPlugins()).andReturn(plugins);
  EasyMock.expect(worker.isRunning(CONN1)).andReturn(true);
  EasyMock.expect(worker.connectorTaskConfigs(CONN1,conn1SinkConfig)).andReturn(TASK_CONFIGS);
  member.poll(EasyMock.anyInt());
  PowerMock.expectLastCall();
  PowerMock.replayAll();
  herder.tick();
  configUpdateListener.onConnectorConfigUpdate(CONN1);
  herder.tick();
  PowerMock.verifyAll();
}
