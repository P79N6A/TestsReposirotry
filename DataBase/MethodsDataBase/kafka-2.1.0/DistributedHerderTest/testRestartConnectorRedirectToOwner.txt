@Test public void testRestartConnectorRedirectToOwner() throws Exception {
  EasyMock.expect(member.memberId()).andStubReturn("leader");
  expectRebalance(1,Collections.<String>emptyList(),Collections.<ConnectorTaskId>emptyList());
  expectPostRebalanceCatchup(SNAPSHOT);
  member.poll(EasyMock.anyInt());
  PowerMock.expectLastCall();
  member.wakeup();
  PowerMock.expectLastCall();
  member.ensureActive();
  PowerMock.expectLastCall();
  member.poll(EasyMock.anyInt());
  PowerMock.expectLastCall();
  String ownerUrl="ownerUrl";
  EasyMock.expect(member.ownerUrl(CONN1)).andReturn(ownerUrl);
  PowerMock.replayAll();
  herder.tick();
  time.sleep(1000L);
  assertStatistics(3,1,100,1000L);
  FutureCallback<Void> callback=new FutureCallback<>();
  herder.restartConnector(CONN1,callback);
  herder.tick();
  time.sleep(2000L);
  assertStatistics(3,1,100,3000L);
  try {
    callback.get(1000L,TimeUnit.MILLISECONDS);
    fail("Expected NotLeaderException to be raised");
  }
 catch (  ExecutionException e) {
    assertTrue(e.getCause() instanceof NotAssignedException);
    NotAssignedException notAssignedException=(NotAssignedException)e.getCause();
    assertEquals(ownerUrl,notAssignedException.forwardUrl());
  }
  PowerMock.verifyAll();
}
