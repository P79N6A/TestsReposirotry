@Test public void testExponentialReconnectBackoff() throws UnknownHostException {
  final int reconnectBackoffExpBase=2;
  double reconnectBackoffMaxExp=Math.log(reconnectBackoffMax / (double)Math.max(reconnectBackoffMs,1)) / Math.log(reconnectBackoffExpBase);
  for (int i=0; i < 10; i++) {
    connectionStates.connecting(nodeId1,time.milliseconds(),"localhost",ClientDnsLookup.DEFAULT);
    connectionStates.disconnected(nodeId1,time.milliseconds());
    long expectedBackoff=Math.round(Math.pow(reconnectBackoffExpBase,Math.min(i,reconnectBackoffMaxExp)) * reconnectBackoffMs);
    long currentBackoff=connectionStates.connectionDelay(nodeId1,time.milliseconds());
    assertEquals(expectedBackoff,currentBackoff,reconnectBackoffJitter * expectedBackoff);
    time.sleep(connectionStates.connectionDelay(nodeId1,time.milliseconds()) + 1);
  }
}
