@Test public void shouldReduce() throws Exception {
  produceMessages(System.currentTimeMillis());
  groupedStream.reduce(reducer,Materialized.as("reduce-by-key")).toStream().to(outputTopic,Produced.with(Serdes.String(),Serdes.String()));
  startStreams();
  produceMessages(System.currentTimeMillis());
  validateReceivedMessages(new StringDeserializer(),new StringDeserializer(),Arrays.asList(KeyValue.pair("A","A:A"),KeyValue.pair("B","B:B"),KeyValue.pair("C","C:C"),KeyValue.pair("D","D:D"),KeyValue.pair("E","E:E")));
}
