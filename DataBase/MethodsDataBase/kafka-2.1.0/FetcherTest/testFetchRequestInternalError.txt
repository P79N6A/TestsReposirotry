/** 
 * Test the case where the client makes a post KIP-74 FetchRequest, but the server replies with only a partial request. For v3 and later FetchRequests, the implementation of KIP-74 changed the behavior so that at least one message is always returned. Therefore, this case should not happen, and it indicates that an internal error has taken place.
 */
@Test public void testFetchRequestInternalError(){
  makeFetchRequestWithIncompleteRecord();
  try {
    fetcher.fetchedRecords();
    fail("RecordTooLargeException should have been raised");
  }
 catch (  KafkaException e) {
    assertTrue(e.getMessage().startsWith("Failed to make progress reading messages"));
    assertEquals(0,subscriptions.position(tp0).longValue());
  }
}
