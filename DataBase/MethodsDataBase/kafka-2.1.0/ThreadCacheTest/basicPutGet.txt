@Test public void basicPutGet() throws IOException {
  final List<KeyValue<String,String>> toInsert=Arrays.asList(new KeyValue<>("K1","V1"),new KeyValue<>("K2","V2"),new KeyValue<>("K3","V3"),new KeyValue<>("K4","V4"),new KeyValue<>("K5","V5"));
  final KeyValue<String,String> kv=toInsert.get(0);
  final ThreadCache cache=new ThreadCache(logContext,toInsert.size() * memoryCacheEntrySize(kv.key.getBytes(),kv.value.getBytes(),""),new MockStreamsMetrics(new Metrics()));
  for (  final KeyValue<String,String> kvToInsert : toInsert) {
    final Bytes key=Bytes.wrap(kvToInsert.key.getBytes());
    final byte[] value=kvToInsert.value.getBytes();
    cache.put(namespace,key,new LRUCacheEntry(value,null,true,1L,1L,1,""));
  }
  for (  final KeyValue<String,String> kvToInsert : toInsert) {
    final Bytes key=Bytes.wrap(kvToInsert.key.getBytes());
    final LRUCacheEntry entry=cache.get(namespace,key);
    assertEquals(entry.isDirty(),true);
    assertEquals(new String(entry.value()),kvToInsert.value);
  }
  assertEquals(cache.gets(),5);
  assertEquals(cache.puts(),5);
  assertEquals(cache.evicts(),0);
  assertEquals(cache.flushes(),0);
}
