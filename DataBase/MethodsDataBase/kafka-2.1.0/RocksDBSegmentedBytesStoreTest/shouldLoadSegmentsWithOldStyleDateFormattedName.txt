@Test public void shouldLoadSegmentsWithOldStyleDateFormattedName(){
  final Segments segments=new Segments(storeName,retention,segmentInterval);
  final String key="a";
  bytesStore.put(serializeKey(new Windowed<>(key,windows[0])),serializeValue(50L));
  bytesStore.put(serializeKey(new Windowed<>(key,windows[3])),serializeValue(100L));
  bytesStore.close();
  final String firstSegmentName=segments.segmentName(0);
  final String[] nameParts=firstSegmentName.split("\\.");
  final Long segmentId=Long.parseLong(nameParts[1]);
  final SimpleDateFormat formatter=new SimpleDateFormat("yyyyMMddHHmm");
  formatter.setTimeZone(new SimpleTimeZone(0,"UTC"));
  final String formatted=formatter.format(new Date(segmentId * segmentInterval));
  final File parent=new File(stateDir,storeName);
  final File oldStyleName=new File(parent,nameParts[0] + "-" + formatted);
  assertTrue(new File(parent,firstSegmentName).renameTo(oldStyleName));
  bytesStore=new RocksDBSegmentedBytesStore(storeName,"metrics-scope",retention,segmentInterval,schema);
  bytesStore.init(context,bytesStore);
  final List<KeyValue<Windowed<String>,Long>> results=toList(bytesStore.fetch(Bytes.wrap(key.getBytes()),0L,60_000L));
  assertThat(results,equalTo(Arrays.asList(KeyValue.pair(new Windowed<>(key,windows[0]),50L),KeyValue.pair(new Windowed<>(key,windows[3]),100L))));
}
