@Test public void shouldRollSegments(){
  final Segments segments=new Segments(storeName,retention,segmentInterval);
  final String key="a";
  bytesStore.put(serializeKey(new Windowed<>(key,windows[0])),serializeValue(50));
  bytesStore.put(serializeKey(new Windowed<>(key,windows[1])),serializeValue(100));
  bytesStore.put(serializeKey(new Windowed<>(key,windows[2])),serializeValue(500));
  assertEquals(Collections.singleton(segments.segmentName(0)),segmentDirs());
  bytesStore.put(serializeKey(new Windowed<>(key,windows[3])),serializeValue(1000));
  assertEquals(Utils.mkSet(segments.segmentName(0),segments.segmentName(1)),segmentDirs());
  final List<KeyValue<Windowed<String>,Long>> results=toList(bytesStore.fetch(Bytes.wrap(key.getBytes()),0,1500));
  assertEquals(Arrays.asList(KeyValue.pair(new Windowed<>(key,windows[0]),50L),KeyValue.pair(new Windowed<>(key,windows[1]),100L),KeyValue.pair(new Windowed<>(key,windows[2]),500L)),results);
}
