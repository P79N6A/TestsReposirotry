@Test public void shouldRespectBulkLoadOptionsDuringInit(){
  bytesStore.init(context,bytesStore);
  final String key="a";
  bytesStore.put(serializeKey(new Windowed<>(key,windows[0])),serializeValue(50L));
  bytesStore.put(serializeKey(new Windowed<>(key,windows[3])),serializeValue(100L));
  assertEquals(2,bytesStore.getSegments().size());
  final StateRestoreListener restoreListener=context.getRestoreListener(bytesStore.name());
  restoreListener.onRestoreStart(null,bytesStore.name(),0L,0L);
  for (  final Segment segment : bytesStore.getSegments()) {
    Assert.assertThat(segment.getOptions().level0FileNumCompactionTrigger(),equalTo(1 << 30));
  }
  restoreListener.onRestoreEnd(null,bytesStore.name(),0L);
  for (  final Segment segment : bytesStore.getSegments()) {
    Assert.assertThat(segment.getOptions().level0FileNumCompactionTrigger(),equalTo(4));
  }
}
