@Test public void shouldRestoreToByteStore(){
  assertEquals(0,bytesStore.getSegments().size());
  final String key="a";
  final Collection<KeyValue<byte[],byte[]>> records=new ArrayList<>();
  records.add(new KeyValue<>(serializeKey(new Windowed<>(key,windows[0])).get(),serializeValue(50L)));
  records.add(new KeyValue<>(serializeKey(new Windowed<>(key,windows[3])).get(),serializeValue(100L)));
  bytesStore.restoreAllInternal(records);
  assertEquals(2,bytesStore.getSegments().size());
  for (  final Segment segment : bytesStore.getSegments()) {
    Assert.assertThat(segment.getOptions().level0FileNumCompactionTrigger(),equalTo(1 << 30));
  }
  final List<KeyValue<Windowed<String>,Long>> expected=new ArrayList<>();
  expected.add(new KeyValue<>(new Windowed<>(key,windows[0]),50L));
  expected.add(new KeyValue<>(new Windowed<>(key,windows[3]),100L));
  final List<KeyValue<Windowed<String>,Long>> results=toList(bytesStore.all());
  assertEquals(expected,results);
}
