@Test public void shouldFetchAllSegments(){
  final Segments segments=new Segments(storeName,retention,segmentInterval);
  final String key="a";
  bytesStore.put(serializeKey(new Windowed<>(key,windows[0])),serializeValue(50L));
  assertEquals(Collections.singleton(segments.segmentName(0)),segmentDirs());
  bytesStore.put(serializeKey(new Windowed<>(key,windows[3])),serializeValue(100L));
  assertEquals(Utils.mkSet(segments.segmentName(0),segments.segmentName(1)),segmentDirs());
  final List<KeyValue<Windowed<String>,Long>> results=toList(bytesStore.fetchAll(0L,60_000L));
  assertEquals(Arrays.asList(KeyValue.pair(new Windowed<>(key,windows[0]),50L),KeyValue.pair(new Windowed<>(key,windows[3]),100L)),results);
}
