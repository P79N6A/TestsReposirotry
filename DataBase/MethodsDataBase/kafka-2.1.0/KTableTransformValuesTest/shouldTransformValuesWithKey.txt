@Test public void shouldTransformValuesWithKey(){
  builder.addStateStore(storeBuilder(STORE_NAME)).addStateStore(storeBuilder(OTHER_STORE_NAME)).table(INPUT_TOPIC,CONSUMED).transformValues(new ExclamationValueTransformerSupplier(STORE_NAME,OTHER_STORE_NAME),STORE_NAME,OTHER_STORE_NAME).toStream().process(capture);
  driver=new TopologyTestDriver(builder.build(),props());
  driver.pipeInput(recordFactory.create(INPUT_TOPIC,"A","a",0L));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC,"B","b",0L));
  driver.pipeInput(recordFactory.create(INPUT_TOPIC,"D",(String)null,0L));
  assertThat(output(),hasItems("A:A->a!","B:B->b!","D:D->null!"));
  assertThat("Store should not be materialized",driver.getKeyValueStore(QUERYABLE_NAME),is(nullValue()));
}
