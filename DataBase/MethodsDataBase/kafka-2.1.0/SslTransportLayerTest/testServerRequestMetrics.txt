@Test public void testServerRequestMetrics() throws Exception {
  String node="0";
  server=createEchoServer(SecurityProtocol.SSL);
  createSelector(sslClientConfigs,16384,16384,16384);
  InetSocketAddress addr=new InetSocketAddress("localhost",server.port());
  selector.connect(node,addr,102400,102400);
  NetworkTestUtils.waitForChannelReady(selector,node);
  int messageSize=1024 * 1024;
  String message=TestUtils.randomString(messageSize);
  selector.send(new NetworkSend(node,ByteBuffer.wrap(message.getBytes())));
  while (selector.completedReceives().isEmpty()) {
    selector.poll(100L);
  }
  int totalBytes=messageSize + 4;
  server.waitForMetric("incoming-byte",totalBytes);
  server.waitForMetric("outgoing-byte",totalBytes);
  server.waitForMetric("request",1);
  server.waitForMetric("response",1);
}
