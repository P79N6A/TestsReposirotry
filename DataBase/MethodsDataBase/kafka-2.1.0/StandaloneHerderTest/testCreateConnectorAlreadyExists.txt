@Test public void testCreateConnectorAlreadyExists() throws Exception {
  connector=PowerMock.createMock(BogusSourceConnector.class);
  expectAdd(SourceSink.SOURCE);
  Map<String,String> config=connectorConfig(SourceSink.SOURCE);
  Connector connectorMock=PowerMock.createMock(SourceConnector.class);
  expectConfigValidation(connectorMock,true,config,config);
  EasyMock.expect(worker.configTransformer()).andReturn(transformer).times(2);
  final Capture<Map<String,String>> configCapture=EasyMock.newCapture();
  EasyMock.expect(transformer.transform(EasyMock.capture(configCapture))).andAnswer(configCapture::getValue);
  EasyMock.expect(worker.getPlugins()).andReturn(plugins).times(2);
  EasyMock.expect(plugins.compareAndSwapLoaders(connectorMock)).andReturn(delegatingLoader);
  EasyMock.expect(Plugins.compareAndSwapLoaders(delegatingLoader)).andReturn(pluginLoader);
  createCallback.onCompletion(EasyMock.<AlreadyExistsException>anyObject(),EasyMock.<Herder.Created<ConnectorInfo>>isNull());
  PowerMock.expectLastCall();
  PowerMock.replayAll();
  herder.putConnectorConfig(CONNECTOR_NAME,config,false,createCallback);
  herder.putConnectorConfig(CONNECTOR_NAME,config,false,createCallback);
  PowerMock.verifyAll();
}
