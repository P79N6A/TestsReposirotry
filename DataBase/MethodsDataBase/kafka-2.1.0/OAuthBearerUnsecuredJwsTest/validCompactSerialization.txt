@Test public void validCompactSerialization(){
  String subject="foo";
  long issuedAt=100;
  long expirationTime=issuedAt + 60 * 60;
  List<String> scope=Arrays.asList("scopeValue1","scopeValue2");
  String validCompactSerialization=compactSerialization(subject,issuedAt,expirationTime,scope);
  OAuthBearerUnsecuredJws jws=new OAuthBearerUnsecuredJws(validCompactSerialization,"sub","scope");
  assertEquals(1,jws.header().size());
  assertEquals("none",jws.header().get("alg"));
  assertEquals(4,jws.claims().size());
  assertEquals(subject,jws.claims().get("sub"));
  assertEquals(subject,jws.principalName());
  assertEquals(issuedAt,Number.class.cast(jws.claims().get("iat")).longValue());
  assertEquals(expirationTime,Number.class.cast(jws.claims().get("exp")).longValue());
  assertEquals(expirationTime * 1000,jws.lifetimeMs());
  assertEquals(scope,jws.claims().get("scope"));
  assertEquals(new HashSet<>(scope),jws.scope());
  assertEquals(3,jws.splits().size());
  assertEquals(validCompactSerialization.split("\\.")[0],jws.splits().get(0));
  assertEquals(validCompactSerialization.split("\\.")[1],jws.splits().get(1));
  assertEquals("",jws.splits().get(2));
}
