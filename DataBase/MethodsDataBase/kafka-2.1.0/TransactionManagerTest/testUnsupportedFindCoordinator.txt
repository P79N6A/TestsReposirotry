@Test public void testUnsupportedFindCoordinator(){
  transactionManager.initializeTransactions();
  client.prepareUnsupportedVersionResponse(new MockClient.RequestMatcher(){
    @Override public boolean matches(    AbstractRequest body){
      FindCoordinatorRequest findCoordinatorRequest=(FindCoordinatorRequest)body;
      assertEquals(findCoordinatorRequest.coordinatorType(),CoordinatorType.TRANSACTION);
      assertEquals(findCoordinatorRequest.coordinatorKey(),transactionalId);
      return true;
    }
  }
);
  sender.run(time.milliseconds());
  sender.run(time.milliseconds());
  assertTrue(transactionManager.hasFatalError());
  assertTrue(transactionManager.lastError() instanceof UnsupportedVersionException);
}
