@Test public void testDisconnectAndRetry(){
  transactionManager.initializeTransactions();
  prepareFindCoordinatorResponse(Errors.NONE,true,CoordinatorType.TRANSACTION,transactionalId);
  sender.run(time.milliseconds());
  prepareFindCoordinatorResponse(Errors.NONE,false,CoordinatorType.TRANSACTION,transactionalId);
  sender.run(time.milliseconds());
  sender.run(time.milliseconds());
  assertEquals(brokerNode,transactionManager.coordinator(CoordinatorType.TRANSACTION));
}
