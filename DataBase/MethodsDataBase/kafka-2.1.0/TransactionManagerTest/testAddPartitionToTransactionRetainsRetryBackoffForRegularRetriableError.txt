@Test public void testAddPartitionToTransactionRetainsRetryBackoffForRegularRetriableError(){
  long pid=13131L;
  short epoch=1;
  TopicPartition partition=new TopicPartition("foo",0);
  doInitTransactions(pid,epoch);
  transactionManager.beginTransaction();
  transactionManager.maybeAddPartitionToTransaction(partition);
  assertTrue(transactionManager.hasPartitionsToAdd());
  assertFalse(transactionManager.isPartitionAdded(partition));
  assertTrue(transactionManager.isPartitionPendingAdd(partition));
  prepareAddPartitionsToTxn(partition,Errors.COORDINATOR_NOT_AVAILABLE);
  sender.run(time.milliseconds());
  TransactionManager.TxnRequestHandler handler=transactionManager.nextRequestHandler(false);
  assertNotNull(handler);
  assertEquals(DEFAULT_RETRY_BACKOFF_MS,handler.retryBackoffMs());
}
