@Test(expected=InvalidRecordException.class) public void testInvalidVarlong(){
  byte attributes=0;
  int sizeOfBodyInBytes=11;
  ByteBuffer buf=ByteBuffer.allocate(sizeOfBodyInBytes + ByteUtils.sizeOfVarint(sizeOfBodyInBytes) + 1);
  ByteUtils.writeVarint(sizeOfBodyInBytes,buf);
  int recordStartPosition=buf.position();
  buf.put(attributes);
  ByteUtils.writeVarlong(Long.MAX_VALUE,buf);
  buf.put(recordStartPosition + 10,Byte.MIN_VALUE);
  buf.flip();
  DefaultRecord.readFrom(buf,0L,0L,RecordBatch.NO_SEQUENCE,null);
}
