@Test(expected=InvalidRecordException.class) public void testInvalidValueSize() throws IOException {
  byte attributes=0;
  long timestampDelta=2;
  int offsetDelta=1;
  int sizeOfBodyInBytes=100;
  int valueSize=105;
  ByteBuffer buf=ByteBuffer.allocate(sizeOfBodyInBytes + ByteUtils.sizeOfVarint(sizeOfBodyInBytes));
  ByteUtils.writeVarint(sizeOfBodyInBytes,buf);
  buf.put(attributes);
  ByteUtils.writeVarlong(timestampDelta,buf);
  ByteUtils.writeVarint(offsetDelta,buf);
  ByteUtils.writeVarint(-1,buf);
  ByteUtils.writeVarint(valueSize,buf);
  buf.position(buf.limit());
  buf.flip();
  DefaultRecord.readFrom(buf,0L,0L,RecordBatch.NO_SEQUENCE,null);
}
