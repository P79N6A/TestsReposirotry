@Test public void testKTable(){
  final StreamsBuilder builder=new StreamsBuilder();
  final String topic1="topic1";
  final KTable<String,Integer> table1=builder.table(topic1,Consumed.with(Serdes.String(),Serdes.Integer()));
  final MockProcessorSupplier<String,Integer> supplier=new MockProcessorSupplier<>();
  table1.toStream().process(supplier);
  final ConsumerRecordFactory<String,Integer> integerFactory=new ConsumerRecordFactory<>(new StringSerializer(),new IntegerSerializer());
  try (final TopologyTestDriver driver=new TopologyTestDriver(builder.build(),props)){
    driver.pipeInput(integerFactory.create(topic1,"A",1));
    driver.pipeInput(integerFactory.create(topic1,"B",2));
    driver.pipeInput(integerFactory.create(topic1,"C",3));
    driver.pipeInput(integerFactory.create(topic1,"D",4));
    driver.pipeInput(integerFactory.create(topic1,"A",null));
    driver.pipeInput(integerFactory.create(topic1,"B",null));
  }
   assertEquals(Utils.mkList("A:1","B:2","C:3","D:4","A:null","B:null"),supplier.theCapturedProcessor().processed);
}
