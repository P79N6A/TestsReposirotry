@Test public void kTableShouldLogAndMeterOnSkippedRecords(){
  final StreamsBuilder builder=new StreamsBuilder();
  final String topic="topic";
  builder.table(topic,stringConsumed);
  final LogCaptureAppender appender=LogCaptureAppender.createAndRegister();
  try (final TopologyTestDriver driver=new TopologyTestDriver(builder.build(),props)){
    driver.pipeInput(recordFactory.create(topic,null,"value"));
    LogCaptureAppender.unregister(appender);
    assertEquals(1.0,getMetricByName(driver.metrics(),"skipped-records-total","stream-metrics").metricValue());
    assertThat(appender.getMessages(),hasItem("Skipping record due to null key. topic=[topic] partition=[0] offset=[0]"));
  }
 }
