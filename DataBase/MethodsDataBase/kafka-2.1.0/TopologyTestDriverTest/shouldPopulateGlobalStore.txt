@Test public void shouldPopulateGlobalStore(){
  testDriver=new TopologyTestDriver(setupGlobalStoreTopology(SOURCE_TOPIC_1),config);
  final KeyValueStore<byte[],byte[]> globalStore=testDriver.getKeyValueStore(SOURCE_TOPIC_1 + "-globalStore");
  Assert.assertNotNull(globalStore);
  Assert.assertNotNull(testDriver.getAllStateStores().get(SOURCE_TOPIC_1 + "-globalStore"));
  testDriver.pipeInput(consumerRecord1);
  final List<Record> processedRecords=mockProcessors.get(0).processedRecords;
  assertEquals(1,processedRecords.size());
  final Record record=processedRecords.get(0);
  final Record expectedResult=new Record(consumerRecord1,0L);
  assertThat(record,equalTo(expectedResult));
}
