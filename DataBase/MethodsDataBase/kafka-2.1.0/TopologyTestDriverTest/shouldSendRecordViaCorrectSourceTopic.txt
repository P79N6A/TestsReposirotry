@Test public void shouldSendRecordViaCorrectSourceTopic(){
  testDriver=new TopologyTestDriver(setupMultipleSourceTopology(SOURCE_TOPIC_1,SOURCE_TOPIC_2),config);
  final List<Record> processedRecords1=mockProcessors.get(0).processedRecords;
  final List<Record> processedRecords2=mockProcessors.get(1).processedRecords;
  testDriver.pipeInput(consumerRecord1);
  assertEquals(1,processedRecords1.size());
  assertEquals(0,processedRecords2.size());
  Record record=processedRecords1.get(0);
  Record expectedResult=new Record(consumerRecord1,0L);
  assertThat(record,equalTo(expectedResult));
  testDriver.pipeInput(consumerRecord2);
  assertEquals(1,processedRecords1.size());
  assertEquals(1,processedRecords2.size());
  record=processedRecords2.get(0);
  expectedResult=new Record(consumerRecord2,0L);
  assertThat(record,equalTo(expectedResult));
}
