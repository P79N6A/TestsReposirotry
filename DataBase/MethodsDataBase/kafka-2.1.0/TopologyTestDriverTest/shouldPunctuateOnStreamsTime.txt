@Test public void shouldPunctuateOnStreamsTime(){
  final MockPunctuator mockPunctuator=new MockPunctuator();
  testDriver=new TopologyTestDriver(setupSingleProcessorTopology(10L,PunctuationType.STREAM_TIME,mockPunctuator),config);
  final List<Long> expectedPunctuations=new LinkedList<>();
  expectedPunctuations.add(42L);
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,42L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,42L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  expectedPunctuations.add(51L);
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,51L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,52L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  expectedPunctuations.add(61L);
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,61L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,65L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  expectedPunctuations.add(71L);
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,71L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,72L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  expectedPunctuations.add(95L);
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,95L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  expectedPunctuations.add(101L);
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,101L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
  testDriver.pipeInput(consumerRecordFactory.create(SOURCE_TOPIC_1,key1,value1,102L));
  assertThat(mockPunctuator.punctuatedAt,equalTo(expectedPunctuations));
}
