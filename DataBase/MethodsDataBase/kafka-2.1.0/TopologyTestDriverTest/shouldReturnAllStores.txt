@Test public void shouldReturnAllStores(){
  final Topology topology=setupSourceSinkTopology();
  topology.addProcessor("processor",() -> null,"source");
  topology.addStateStore(new KeyValueStoreBuilder<>(Stores.inMemoryKeyValueStore("store"),Serdes.ByteArray(),Serdes.ByteArray(),new SystemTime()),"processor");
  topology.addGlobalStore(new KeyValueStoreBuilder<>(Stores.inMemoryKeyValueStore("globalStore"),Serdes.ByteArray(),Serdes.ByteArray(),new SystemTime()).withLoggingDisabled(),"sourceProcessorName",Serdes.ByteArray().deserializer(),Serdes.ByteArray().deserializer(),"globalTopicName","globalProcessorName",() -> null);
  testDriver=new TopologyTestDriver(topology,config);
  final Set<String> expectedStoreNames=new HashSet<>();
  expectedStoreNames.add("store");
  expectedStoreNames.add("globalStore");
  final Map<String,StateStore> allStores=testDriver.getAllStateStores();
  assertThat(allStores.keySet(),equalTo(expectedStoreNames));
  for (  final StateStore store : allStores.values()) {
    assertNotNull(store);
  }
}
