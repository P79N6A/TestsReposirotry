@Test public void testShiftOffsetByWhenBetweenBeginningAndEndOffset(){
  final Map<TopicPartition,Long> endOffsets=new HashMap<>();
  endOffsets.put(topicPartition,4L);
  consumer.updateEndOffsets(endOffsets);
  final Map<TopicPartition,Long> beginningOffsets=new HashMap<>();
  beginningOffsets.put(topicPartition,0L);
  consumer.updateBeginningOffsets(beginningOffsets);
  streamsResetter.shiftOffsetsBy(consumer,inputTopicPartitions,3L);
  final ConsumerRecords<byte[],byte[]> records=consumer.poll(Duration.ofMillis(500));
  assertEquals(2,records.count());
}
