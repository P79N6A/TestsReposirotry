@Test public void testRestartTaskOwnerRedirect() throws Throwable {
  ConnectorTaskId taskId=new ConnectorTaskId(CONNECTOR_NAME,0);
  final Capture<Callback<Void>> cb=Capture.newInstance();
  herder.restartTask(EasyMock.eq(taskId),EasyMock.capture(cb));
  String ownerUrl="http://owner:8083";
  expectAndCallbackException(cb,new NotAssignedException("not owner test",ownerUrl));
  EasyMock.expect(RestClient.httpRequest(EasyMock.eq("http://owner:8083/connectors/" + CONNECTOR_NAME + "/tasks/0/restart?forward=false"),EasyMock.eq("POST"),EasyMock.isNull(),EasyMock.<TypeReference>anyObject(),EasyMock.anyObject(WorkerConfig.class))).andReturn(new RestClient.HttpResponse<>(202,new HashMap<String,String>(),null));
  PowerMock.replayAll();
  connectorsResource.restartTask(CONNECTOR_NAME,0,true);
  PowerMock.verifyAll();
}
