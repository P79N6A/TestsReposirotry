@Test public void testRewindOnRebalanceDuringPoll() throws Exception {
  expectInitializeTask();
  expectPollInitialAssignment();
  expectRebalanceDuringPoll().andAnswer(new IAnswer<Object>(){
    @Override public Object answer() throws Throwable {
      Map<TopicPartition,Long> offsets=sinkTaskContext.getValue().offsets();
      assertEquals(0,offsets.size());
      return null;
    }
  }
);
  expectStopTask();
  PowerMock.replayAll();
  workerTask.initialize(TASK_CONFIG);
  workerTask.initializeAndStart();
  workerTask.iteration();
  workerTask.iteration();
  workerTask.stop();
  workerTask.close();
  PowerMock.verifyAll();
}
