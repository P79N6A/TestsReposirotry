@Test public void validServerFinalMessage() throws SaslException {
  String serverSignature=randomBytesAsString();
  ServerFinalMessage m=new ServerFinalMessage("unknown-user",null);
  checkServerFinalMessage(m,"unknown-user",null);
  m=new ServerFinalMessage(null,toBytes(serverSignature));
  checkServerFinalMessage(m,null,serverSignature);
  String str=String.format("v=%s",serverSignature);
  m=createScramMessage(ServerFinalMessage.class,str);
  checkServerFinalMessage(m,null,serverSignature);
  m=new ServerFinalMessage(m.toBytes());
  checkServerFinalMessage(m,null,serverSignature);
  str="e=other-error";
  m=createScramMessage(ServerFinalMessage.class,str);
  checkServerFinalMessage(m,"other-error",null);
  m=new ServerFinalMessage(m.toBytes());
  checkServerFinalMessage(m,"other-error",null);
  for (  String extension : VALID_EXTENSIONS) {
    str=String.format("v=%s,%s",serverSignature,extension);
    checkServerFinalMessage(createScramMessage(ServerFinalMessage.class,str),null,serverSignature);
  }
}
