@Test public void validClientFinalMessage() throws SaslException {
  String nonce=formatter.secureRandomString();
  String channelBinding=randomBytesAsString();
  String proof=randomBytesAsString();
  ClientFinalMessage m=new ClientFinalMessage(toBytes(channelBinding),nonce);
  assertNull("Invalid proof",m.proof());
  m.proof(toBytes(proof));
  checkClientFinalMessage(m,channelBinding,nonce,proof);
  String str=String.format("c=%s,r=%s,p=%s",channelBinding,nonce,proof);
  m=createScramMessage(ClientFinalMessage.class,str);
  checkClientFinalMessage(m,channelBinding,nonce,proof);
  m=new ClientFinalMessage(m.toBytes());
  checkClientFinalMessage(m,channelBinding,nonce,proof);
  for (  String extension : VALID_EXTENSIONS) {
    str=String.format("c=%s,r=%s,%s,p=%s",channelBinding,nonce,extension,proof);
    checkClientFinalMessage(createScramMessage(ClientFinalMessage.class,str),channelBinding,nonce,proof);
  }
}
