@Test public void validServerFirstMessage() throws SaslException {
  String clientNonce=formatter.secureRandomString();
  String serverNonce=formatter.secureRandomString();
  String nonce=clientNonce + serverNonce;
  String salt=randomBytesAsString();
  ServerFirstMessage m=new ServerFirstMessage(clientNonce,serverNonce,toBytes(salt),8192);
  checkServerFirstMessage(m,nonce,salt,8192);
  String str=String.format("r=%s,s=%s,i=4096",nonce,salt);
  m=createScramMessage(ServerFirstMessage.class,str);
  checkServerFirstMessage(m,nonce,salt,4096);
  m=new ServerFirstMessage(m.toBytes());
  checkServerFirstMessage(m,nonce,salt,4096);
  for (  String reserved : VALID_RESERVED) {
    str=String.format("%s,r=%s,s=%s,i=4096",reserved,nonce,salt);
    checkServerFirstMessage(createScramMessage(ServerFirstMessage.class,str),nonce,salt,4096);
  }
  for (  String extension : VALID_EXTENSIONS) {
    str=String.format("r=%s,s=%s,i=4096,%s",nonce,salt,extension);
    checkServerFirstMessage(createScramMessage(ServerFirstMessage.class,str),nonce,salt,4096);
  }
}
