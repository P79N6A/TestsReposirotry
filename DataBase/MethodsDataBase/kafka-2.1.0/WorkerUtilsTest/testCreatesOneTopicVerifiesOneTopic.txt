@Test public void testCreatesOneTopicVerifiesOneTopic() throws Throwable {
  final String existingTopic="existing-topic";
  List<TopicPartitionInfo> tpInfo=new ArrayList<>();
  tpInfo.add(new TopicPartitionInfo(0,broker1,singleReplica,Collections.<Node>emptyList()));
  tpInfo.add(new TopicPartitionInfo(1,broker2,singleReplica,Collections.<Node>emptyList()));
  adminClient.addTopic(false,existingTopic,tpInfo,null);
  Map<String,NewTopic> topics=new HashMap<>();
  topics.put(existingTopic,new NewTopic(existingTopic,tpInfo.size(),TEST_REPLICATION_FACTOR));
  topics.put(TEST_TOPIC,NEW_TEST_TOPIC);
  WorkerUtils.createTopics(log,adminClient,topics,false);
  assertEquals(Utils.mkSet(existingTopic,TEST_TOPIC),adminClient.listTopics().names().get());
}
