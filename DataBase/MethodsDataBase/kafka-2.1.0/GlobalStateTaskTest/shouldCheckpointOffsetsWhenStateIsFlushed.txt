@Test public void shouldCheckpointOffsetsWhenStateIsFlushed(){
  final Map<TopicPartition,Long> expectedOffsets=new HashMap<>();
  expectedOffsets.put(t1,102L);
  expectedOffsets.put(t2,100L);
  globalStateTask.initialize();
  globalStateTask.update(new ConsumerRecord<>(topic1,1,101,"foo".getBytes(),"foo".getBytes()));
  globalStateTask.flushState();
  assertThat(stateMgr.checkpointed(),equalTo(expectedOffsets));
}
