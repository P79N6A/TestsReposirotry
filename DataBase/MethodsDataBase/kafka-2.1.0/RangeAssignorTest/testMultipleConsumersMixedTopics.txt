@Test public void testMultipleConsumersMixedTopics(){
  String topic1="topic1";
  String topic2="topic2";
  String consumer1="consumer1";
  String consumer2="consumer2";
  String consumer3="consumer3";
  Map<String,Integer> partitionsPerTopic=new HashMap<>();
  partitionsPerTopic.put(topic1,3);
  partitionsPerTopic.put(topic2,2);
  Map<String,Subscription> consumers=new HashMap<>();
  consumers.put(consumer1,new Subscription(topics(topic1)));
  consumers.put(consumer2,new Subscription(topics(topic1,topic2)));
  consumers.put(consumer3,new Subscription(topics(topic1)));
  Map<String,List<TopicPartition>> assignment=assignor.assign(partitionsPerTopic,consumers);
  assertAssignment(partitions(tp(topic1,0)),assignment.get(consumer1));
  assertAssignment(partitions(tp(topic1,1),tp(topic2,0),tp(topic2,1)),assignment.get(consumer2));
  assertAssignment(partitions(tp(topic1,2)),assignment.get(consumer3));
}
