@Test public void testMaxUsableProduceMagic(){
  ApiVersions apiVersions=new ApiVersions();
  assertEquals(RecordBatch.CURRENT_MAGIC_VALUE,apiVersions.maxUsableProduceMagic());
  apiVersions.update("0",NodeApiVersions.create());
  assertEquals(RecordBatch.CURRENT_MAGIC_VALUE,apiVersions.maxUsableProduceMagic());
  apiVersions.update("1",NodeApiVersions.create(Collections.singleton(new ApiVersionsResponse.ApiVersion(ApiKeys.PRODUCE.id,(short)0,(short)2))));
  assertEquals(RecordBatch.MAGIC_VALUE_V1,apiVersions.maxUsableProduceMagic());
  apiVersions.remove("1");
  assertEquals(RecordBatch.CURRENT_MAGIC_VALUE,apiVersions.maxUsableProduceMagic());
}
