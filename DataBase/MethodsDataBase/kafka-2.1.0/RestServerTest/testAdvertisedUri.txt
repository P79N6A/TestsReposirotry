@Test public void testAdvertisedUri(){
  Map<String,String> configMap=new HashMap<>(baseWorkerProps());
  configMap.put(WorkerConfig.LISTENERS_CONFIG,"http://localhost:8080,https://localhost:8443");
  DistributedConfig config=new DistributedConfig(configMap);
  server=new RestServer(config);
  Assert.assertEquals("http://localhost:8080/",server.advertisedUrl().toString());
  configMap=new HashMap<>(baseWorkerProps());
  configMap.put(WorkerConfig.LISTENERS_CONFIG,"http://localhost:8080,https://localhost:8443");
  configMap.put(WorkerConfig.REST_ADVERTISED_LISTENER_CONFIG,"https");
  config=new DistributedConfig(configMap);
  server=new RestServer(config);
  Assert.assertEquals("https://localhost:8443/",server.advertisedUrl().toString());
  configMap=new HashMap<>(baseWorkerProps());
  configMap.put(WorkerConfig.LISTENERS_CONFIG,"https://localhost:8443");
  config=new DistributedConfig(configMap);
  server=new RestServer(config);
  Assert.assertEquals("https://localhost:8443/",server.advertisedUrl().toString());
  configMap=new HashMap<>(baseWorkerProps());
  configMap.put(WorkerConfig.LISTENERS_CONFIG,"https://localhost:8443");
  configMap.put(WorkerConfig.REST_ADVERTISED_LISTENER_CONFIG,"http");
  configMap.put(WorkerConfig.REST_ADVERTISED_HOST_NAME_CONFIG,"somehost");
  configMap.put(WorkerConfig.REST_ADVERTISED_PORT_CONFIG,"10000");
  config=new DistributedConfig(configMap);
  server=new RestServer(config);
  Assert.assertEquals("http://somehost:10000/",server.advertisedUrl().toString());
  configMap=new HashMap<>(baseWorkerProps());
  configMap.put(WorkerConfig.REST_HOST_NAME_CONFIG,"my-hostname");
  configMap.put(WorkerConfig.REST_PORT_CONFIG,"8080");
  config=new DistributedConfig(configMap);
  server=new RestServer(config);
  Assert.assertEquals("http://my-hostname:8080/",server.advertisedUrl().toString());
}
