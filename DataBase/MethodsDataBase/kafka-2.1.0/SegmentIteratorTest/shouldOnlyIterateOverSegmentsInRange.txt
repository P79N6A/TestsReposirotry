@Test public void shouldOnlyIterateOverSegmentsInRange(){
  iterator=new SegmentIterator(Arrays.asList(segmentOne,segmentTwo).iterator(),hasNextCondition,Bytes.wrap("a".getBytes()),Bytes.wrap("b".getBytes()));
  assertTrue(iterator.hasNext());
  assertEquals("a",new String(iterator.peekNextKey().get()));
  assertEquals(KeyValue.pair("a","1"),toStringKeyValue(iterator.next()));
  assertTrue(iterator.hasNext());
  assertEquals("b",new String(iterator.peekNextKey().get()));
  assertEquals(KeyValue.pair("b","2"),toStringKeyValue(iterator.next()));
  assertFalse(iterator.hasNext());
}
