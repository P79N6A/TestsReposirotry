@Test public void shouldIterateOverAllSegments(){
  iterator=new SegmentIterator(Arrays.asList(segmentOne,segmentTwo).iterator(),hasNextCondition,Bytes.wrap("a".getBytes()),Bytes.wrap("z".getBytes()));
  assertTrue(iterator.hasNext());
  assertEquals("a",new String(iterator.peekNextKey().get()));
  assertEquals(KeyValue.pair("a","1"),toStringKeyValue(iterator.next()));
  assertTrue(iterator.hasNext());
  assertEquals("b",new String(iterator.peekNextKey().get()));
  assertEquals(KeyValue.pair("b","2"),toStringKeyValue(iterator.next()));
  assertTrue(iterator.hasNext());
  assertEquals("c",new String(iterator.peekNextKey().get()));
  assertEquals(KeyValue.pair("c","3"),toStringKeyValue(iterator.next()));
  assertTrue(iterator.hasNext());
  assertEquals("d",new String(iterator.peekNextKey().get()));
  assertEquals(KeyValue.pair("d","4"),toStringKeyValue(iterator.next()));
  assertFalse(iterator.hasNext());
}
