/** 
 * Test the truncateTo method lops off messages and appropriately updates the size
 */
@Test public void testTruncate() throws IOException {
  RecordBatch batch=batches(fileRecords).get(0);
  int end=fileRecords.searchForOffsetWithSize(1,0).position;
  fileRecords.truncateTo(end);
  assertEquals(Collections.singletonList(batch),batches(fileRecords));
  assertEquals(batch.sizeInBytes(),fileRecords.sizeInBytes());
}
