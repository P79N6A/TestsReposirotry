/** 
 * Test that the message set iterator obeys start and end slicing
 */
@Test public void testIteratorWithLimits() throws IOException {
  RecordBatch batch=batches(fileRecords).get(1);
  int start=fileRecords.searchForOffsetWithSize(1,0).position;
  int size=batch.sizeInBytes();
  FileRecords slice=fileRecords.slice(start,size);
  assertEquals(Collections.singletonList(batch),batches(slice));
  FileRecords slice2=fileRecords.slice(start,size - 1);
  assertEquals(Collections.emptyList(),batches(slice2));
}
