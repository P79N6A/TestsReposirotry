@Test public void shouldCloseOpenIteratorsWhenStoreClosedAndThrowInvalidStateStoreOnHasNextAndNext(){
  context.setTime(1L);
  store.put(1,"hi");
  store.put(2,"goodbye");
  final KeyValueIterator<Integer,String> iteratorOne=store.range(1,5);
  final KeyValueIterator<Integer,String> iteratorTwo=store.range(1,4);
  assertTrue(iteratorOne.hasNext());
  assertTrue(iteratorTwo.hasNext());
  store.close();
  try {
    iteratorOne.hasNext();
    fail("should have thrown InvalidStateStoreException on closed store");
  }
 catch (  final InvalidStateStoreException e) {
  }
  try {
    iteratorOne.next();
    fail("should have thrown InvalidStateStoreException on closed store");
  }
 catch (  final InvalidStateStoreException e) {
  }
  try {
    iteratorTwo.hasNext();
    fail("should have thrown InvalidStateStoreException on closed store");
  }
 catch (  final InvalidStateStoreException e) {
  }
  try {
    iteratorTwo.next();
    fail("should have thrown InvalidStateStoreException on closed store");
  }
 catch (  final InvalidStateStoreException e) {
  }
}
