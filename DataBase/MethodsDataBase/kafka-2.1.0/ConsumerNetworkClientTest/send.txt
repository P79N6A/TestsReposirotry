@Test public void send(){
  client.prepareResponse(heartbeatResponse(Errors.NONE));
  RequestFuture<ClientResponse> future=consumerClient.send(node,heartbeat());
  assertEquals(1,consumerClient.pendingRequestCount());
  assertEquals(1,consumerClient.pendingRequestCount(node));
  assertFalse(future.isDone());
  consumerClient.poll(future);
  assertTrue(future.isDone());
  assertTrue(future.succeeded());
  ClientResponse clientResponse=future.value();
  HeartbeatResponse response=(HeartbeatResponse)clientResponse.responseBody();
  assertEquals(Errors.NONE,response.error());
}
