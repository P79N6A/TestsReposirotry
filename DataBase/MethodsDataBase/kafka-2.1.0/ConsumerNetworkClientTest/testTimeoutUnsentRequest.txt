@Test public void testTimeoutUnsentRequest(){
  client.delayReady(node,1000);
  RequestFuture<ClientResponse> future=consumerClient.send(node,heartbeat(),500);
  consumerClient.pollNoWakeup();
  assertTrue(consumerClient.hasPendingRequests());
  assertFalse(client.hasInFlightRequests());
  time.sleep(501);
  consumerClient.pollNoWakeup();
  assertFalse(consumerClient.hasPendingRequests());
  assertTrue(future.failed());
  assertTrue(future.exception() instanceof TimeoutException);
}
