@Test public void testRejoinGroup(){
  String otherTopic="otherTopic";
  subscriptions.subscribe(singleton(topic1),rebalanceListener);
  joinAsFollowerAndReceiveAssignment("consumer",coordinator,singletonList(t1p));
  assertEquals(1,rebalanceListener.revokedCount);
  assertTrue(rebalanceListener.revoked.isEmpty());
  assertEquals(1,rebalanceListener.assignedCount);
  assertEquals(singleton(t1p),rebalanceListener.assigned);
  subscriptions.subscribe(new HashSet<>(Arrays.asList(topic1,otherTopic)),rebalanceListener);
  client.prepareResponse(joinGroupFollowerResponse(2,"consumer","leader",Errors.NONE));
  client.prepareResponse(syncGroupResponse(singletonList(t1p),Errors.NONE));
  coordinator.joinGroupIfNeeded(time.timer(Long.MAX_VALUE));
  assertEquals(2,rebalanceListener.revokedCount);
  assertEquals(singleton(t1p),rebalanceListener.revoked);
  assertEquals(2,rebalanceListener.assignedCount);
  assertEquals(singleton(t1p),rebalanceListener.assigned);
}
