@Test public void testCommitOffsetMetadata(){
  subscriptions.assignFromUser(singleton(t1p));
  client.prepareResponse(groupCoordinatorResponse(node,Errors.NONE));
  coordinator.ensureCoordinatorReady(time.timer(Long.MAX_VALUE));
  prepareOffsetCommitRequest(singletonMap(t1p,100L),Errors.NONE);
  AtomicBoolean success=new AtomicBoolean(false);
  Map<TopicPartition,OffsetAndMetadata> offsets=singletonMap(t1p,new OffsetAndMetadata(100L,"hello"));
  coordinator.commitOffsetsAsync(offsets,callback(offsets,success));
  coordinator.invokeCompletedOffsetCommitCallbacks();
  assertTrue(success.get());
}
