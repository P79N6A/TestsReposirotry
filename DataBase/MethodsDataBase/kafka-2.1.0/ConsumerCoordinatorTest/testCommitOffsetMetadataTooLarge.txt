@Test(expected=OffsetMetadataTooLarge.class) public void testCommitOffsetMetadataTooLarge(){
  client.prepareResponse(groupCoordinatorResponse(node,Errors.NONE));
  coordinator.ensureCoordinatorReady(time.timer(Long.MAX_VALUE));
  prepareOffsetCommitRequest(singletonMap(t1p,100L),Errors.OFFSET_METADATA_TOO_LARGE);
  coordinator.commitOffsetsSync(singletonMap(t1p,new OffsetAndMetadata(100L,"metadata")),time.timer(Long.MAX_VALUE));
}
