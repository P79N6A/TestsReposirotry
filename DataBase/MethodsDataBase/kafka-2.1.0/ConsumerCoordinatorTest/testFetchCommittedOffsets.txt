@Test public void testFetchCommittedOffsets(){
  client.prepareResponse(groupCoordinatorResponse(node,Errors.NONE));
  coordinator.ensureCoordinatorReady(time.timer(Long.MAX_VALUE));
  long offset=500L;
  String metadata="blahblah";
  Optional<Integer> leaderEpoch=Optional.of(15);
  OffsetFetchResponse.PartitionData data=new OffsetFetchResponse.PartitionData(offset,leaderEpoch,metadata,Errors.NONE);
  client.prepareResponse(new OffsetFetchResponse(Errors.NONE,singletonMap(t1p,data)));
  Map<TopicPartition,OffsetAndMetadata> fetchedOffsets=coordinator.fetchCommittedOffsets(singleton(t1p),time.timer(Long.MAX_VALUE));
  assertNotNull(fetchedOffsets);
  assertEquals(new OffsetAndMetadata(offset,leaderEpoch,metadata),fetchedOffsets.get(t1p));
}
