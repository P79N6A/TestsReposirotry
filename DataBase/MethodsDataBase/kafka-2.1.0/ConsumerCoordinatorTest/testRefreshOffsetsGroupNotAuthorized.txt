@Test public void testRefreshOffsetsGroupNotAuthorized(){
  client.prepareResponse(groupCoordinatorResponse(node,Errors.NONE));
  coordinator.ensureCoordinatorReady(time.timer(Long.MAX_VALUE));
  subscriptions.assignFromUser(singleton(t1p));
  client.prepareResponse(offsetFetchResponse(Errors.GROUP_AUTHORIZATION_FAILED));
  try {
    coordinator.refreshCommittedOffsetsIfNeeded(time.timer(Long.MAX_VALUE));
    fail("Expected group authorization error");
  }
 catch (  GroupAuthorizationException e) {
    assertEquals(groupId,e.groupId());
  }
}
