@Test(expected=InvalidReceiveException.class) public void testOversizeRequest() throws IOException {
  TransportLayer transportLayer=mock(TransportLayer.class);
  Map<String,?> configs=Collections.singletonMap(BrokerSecurityConfigs.SASL_ENABLED_MECHANISMS_CONFIG,Collections.singletonList(SCRAM_SHA_256.mechanismName()));
  SaslServerAuthenticator authenticator=setupAuthenticator(configs,transportLayer,SCRAM_SHA_256.mechanismName());
  when(transportLayer.read(any(ByteBuffer.class))).then(invocation -> {
    invocation.<ByteBuffer>getArgument(0).putInt(SaslServerAuthenticator.MAX_RECEIVE_SIZE + 1);
    return 4;
  }
);
  authenticator.authenticate();
  verify(transportLayer).read(any(ByteBuffer.class));
}
