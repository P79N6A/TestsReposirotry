@Test(expected=IllegalArgumentException.class) public void testAppendAtInvalidOffset(){
  ByteBuffer buffer=ByteBuffer.allocate(1024);
  buffer.position(bufferOffset);
  long logAppendTime=System.currentTimeMillis();
  MemoryRecordsBuilder builder=new MemoryRecordsBuilder(buffer,RecordBatch.MAGIC_VALUE_V1,compressionType,TimestampType.CREATE_TIME,0L,logAppendTime,RecordBatch.NO_PRODUCER_ID,RecordBatch.NO_PRODUCER_EPOCH,RecordBatch.NO_SEQUENCE,false,false,RecordBatch.NO_PARTITION_LEADER_EPOCH,buffer.capacity());
  builder.appendWithOffset(0L,System.currentTimeMillis(),"a".getBytes(),null);
  builder.appendWithOffset(0L,System.currentTimeMillis(),"b".getBytes(),null);
}
