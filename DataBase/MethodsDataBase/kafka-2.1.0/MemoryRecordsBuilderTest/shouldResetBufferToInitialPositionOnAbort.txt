@Test public void shouldResetBufferToInitialPositionOnAbort() throws Exception {
  expectExceptionWithZStd(compressionType,RecordBatch.MAGIC_VALUE_V0);
  ByteBuffer buffer=ByteBuffer.allocate(128);
  buffer.position(bufferOffset);
  MemoryRecordsBuilder builder=new MemoryRecordsBuilder(buffer,RecordBatch.MAGIC_VALUE_V0,compressionType,TimestampType.CREATE_TIME,0L,0L,RecordBatch.NO_PRODUCER_ID,RecordBatch.NO_PRODUCER_EPOCH,RecordBatch.NO_SEQUENCE,false,false,RecordBatch.NO_PARTITION_LEADER_EPOCH,buffer.capacity());
  builder.append(0L,"a".getBytes(),"1".getBytes());
  builder.abort();
  assertEquals(bufferOffset,builder.buffer().position());
}
