@Test public void testWriteTransactionalRecordSet(){
  ByteBuffer buffer=ByteBuffer.allocate(128);
  buffer.position(bufferOffset);
  long pid=9809;
  short epoch=15;
  int sequence=2342;
  MemoryRecordsBuilder builder=new MemoryRecordsBuilder(buffer,RecordBatch.CURRENT_MAGIC_VALUE,compressionType,TimestampType.CREATE_TIME,0L,0L,pid,epoch,sequence,true,false,RecordBatch.NO_PARTITION_LEADER_EPOCH,buffer.capacity());
  builder.append(System.currentTimeMillis(),"foo".getBytes(),"bar".getBytes());
  MemoryRecords records=builder.build();
  List<MutableRecordBatch> batches=Utils.toList(records.batches().iterator());
  assertEquals(1,batches.size());
  assertTrue(batches.get(0).isTransactional());
}
