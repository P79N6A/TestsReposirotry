@Test(expected=IllegalArgumentException.class) public void testWriteTransactionalWithInvalidPID(){
  ByteBuffer buffer=ByteBuffer.allocate(128);
  buffer.position(bufferOffset);
  long pid=RecordBatch.NO_PRODUCER_ID;
  short epoch=15;
  int sequence=2342;
  MemoryRecordsBuilder builder=new MemoryRecordsBuilder(buffer,RecordBatch.CURRENT_MAGIC_VALUE,compressionType,TimestampType.CREATE_TIME,0L,0L,pid,epoch,sequence,true,false,RecordBatch.NO_PARTITION_LEADER_EPOCH,buffer.capacity());
  builder.close();
}
