@Test(expected=IllegalArgumentException.class) public void testWriteEndTxnMarkerNonControlBatch(){
  ByteBuffer buffer=ByteBuffer.allocate(128);
  buffer.position(bufferOffset);
  long pid=9809;
  short epoch=15;
  int sequence=RecordBatch.NO_SEQUENCE;
  MemoryRecordsBuilder builder=new MemoryRecordsBuilder(buffer,RecordBatch.CURRENT_MAGIC_VALUE,compressionType,TimestampType.CREATE_TIME,0L,0L,pid,epoch,sequence,true,false,RecordBatch.NO_PARTITION_LEADER_EPOCH,buffer.capacity());
  builder.appendEndTxnMarker(RecordBatch.NO_TIMESTAMP,new EndTransactionMarker(ControlRecordType.ABORT,0));
}
