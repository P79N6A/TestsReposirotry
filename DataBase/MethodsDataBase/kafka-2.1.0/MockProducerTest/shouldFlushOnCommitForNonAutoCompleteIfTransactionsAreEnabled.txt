@Test public void shouldFlushOnCommitForNonAutoCompleteIfTransactionsAreEnabled(){
  buildMockProducer(false);
  producer.initTransactions();
  producer.beginTransaction();
  Future<RecordMetadata> md1=producer.send(record1);
  Future<RecordMetadata> md2=producer.send(record2);
  assertFalse(md1.isDone());
  assertFalse(md2.isDone());
  producer.commitTransaction();
  assertTrue(md1.isDone());
  assertTrue(md2.isDone());
}
