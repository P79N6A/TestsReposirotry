@Test public void shouldDropMessagesOnAbortIfTransactionsAreEnabled(){
  buildMockProducer(true);
  producer.initTransactions();
  producer.beginTransaction();
  producer.send(record1);
  producer.send(record2);
  producer.abortTransaction();
  assertTrue(producer.history().isEmpty());
  producer.beginTransaction();
  producer.commitTransaction();
  assertTrue(producer.history().isEmpty());
}
