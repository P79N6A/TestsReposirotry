@Test public void testPause() throws Exception {
  createWorkerTask();
  sourceTask.initialize(EasyMock.anyObject(SourceTaskContext.class));
  EasyMock.expectLastCall();
  sourceTask.start(TASK_PROPS);
  EasyMock.expectLastCall();
  statusListener.onStartup(taskId);
  EasyMock.expectLastCall();
  AtomicInteger count=new AtomicInteger(0);
  CountDownLatch pollLatch=expectPolls(10,count);
  statusListener.onPause(taskId);
  EasyMock.expectLastCall();
  sourceTask.stop();
  EasyMock.expectLastCall();
  expectOffsetFlush(true);
  statusListener.onShutdown(taskId);
  EasyMock.expectLastCall();
  producer.close(EasyMock.anyLong(),EasyMock.anyObject(TimeUnit.class));
  EasyMock.expectLastCall();
  transformationChain.close();
  EasyMock.expectLastCall();
  PowerMock.replayAll();
  workerTask.initialize(TASK_CONFIG);
  Future<?> taskFuture=executor.submit(workerTask);
  assertTrue(awaitLatch(pollLatch));
  workerTask.transitionTo(TargetState.PAUSED);
  int priorCount=count.get();
  Thread.sleep(100);
  assertTrue(count.get() - priorCount <= 1);
  workerTask.stop();
  assertTrue(workerTask.awaitStop(1000));
  taskFuture.get();
  PowerMock.verifyAll();
}
