@Test public void shouldCloseStateManagerIfFailureOnTaskClose(){
  task=createStatefulTaskThatThrowsExceptionOnClose();
  task.initializeStateStores();
  task.initializeTopology();
  try {
    task.close(true,false);
    fail("should have thrown an exception");
  }
 catch (  final Exception e) {
  }
  task=null;
  assertFalse(stateStore.isOpen());
}
