@SuppressWarnings("unchecked") @Test public void testProcessOrder(){
  task=createStatelessTask(createConfig(false));
  task.addRecords(partition1,Arrays.asList(getConsumerRecord(partition1,10),getConsumerRecord(partition1,20),getConsumerRecord(partition1,30)));
  task.addRecords(partition2,Arrays.asList(getConsumerRecord(partition2,25),getConsumerRecord(partition2,35),getConsumerRecord(partition2,45)));
  assertTrue(task.process());
  assertEquals(5,task.numBuffered());
  assertEquals(1,source1.numReceived);
  assertEquals(0,source2.numReceived);
  assertTrue(task.process());
  assertEquals(4,task.numBuffered());
  assertEquals(2,source1.numReceived);
  assertEquals(0,source2.numReceived);
  assertTrue(task.process());
  assertEquals(3,task.numBuffered());
  assertEquals(2,source1.numReceived);
  assertEquals(1,source2.numReceived);
  assertTrue(task.process());
  assertEquals(2,task.numBuffered());
  assertEquals(3,source1.numReceived);
  assertEquals(1,source2.numReceived);
  assertTrue(task.process());
  assertEquals(1,task.numBuffered());
  assertEquals(3,source1.numReceived);
  assertEquals(2,source2.numReceived);
  assertTrue(task.process());
  assertEquals(0,task.numBuffered());
  assertEquals(3,source1.numReceived);
  assertEquals(3,source2.numReceived);
}
