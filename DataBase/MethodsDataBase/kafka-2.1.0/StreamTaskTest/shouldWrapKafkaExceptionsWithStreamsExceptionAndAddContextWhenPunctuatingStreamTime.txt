@Test public void shouldWrapKafkaExceptionsWithStreamsExceptionAndAddContextWhenPunctuatingStreamTime(){
  task=createStatelessTask(createConfig(false));
  task.initializeStateStores();
  task.initializeTopology();
  try {
    task.punctuate(processorStreamTime,1,PunctuationType.STREAM_TIME,new Punctuator(){
      @Override public void punctuate(      final long timestamp){
        throw new KafkaException("KABOOM!");
      }
    }
);
    fail("Should've thrown StreamsException");
  }
 catch (  final StreamsException e) {
    final String message=e.getMessage();
    assertTrue("message=" + message + " should contain processor",message.contains("processor '" + processorStreamTime.name() + "'"));
    assertThat(task.processorContext.currentNode(),nullValue());
  }
}
