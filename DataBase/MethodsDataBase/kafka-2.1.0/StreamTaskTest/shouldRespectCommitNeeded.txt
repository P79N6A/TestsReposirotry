@Test public void shouldRespectCommitNeeded(){
  task=createStatelessTask(createConfig(false));
  task.initializeStateStores();
  task.initializeTopology();
  assertFalse(task.commitNeeded());
  task.addRecords(partition1,singletonList(getConsumerRecord(partition1,0)));
  assertTrue(task.process());
  assertTrue(task.commitNeeded());
  task.commit();
  assertFalse(task.commitNeeded());
  assertTrue(task.maybePunctuateStreamTime());
  assertTrue(task.commitNeeded());
  task.commit();
  assertFalse(task.commitNeeded());
  time.sleep(10);
  assertTrue(task.maybePunctuateSystemTime());
  assertTrue(task.commitNeeded());
  task.commit();
  assertFalse(task.commitNeeded());
}
