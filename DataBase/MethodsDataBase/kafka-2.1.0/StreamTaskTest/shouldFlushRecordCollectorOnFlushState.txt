@Test public void shouldFlushRecordCollectorOnFlushState(){
  final AtomicBoolean flushed=new AtomicBoolean(false);
  final StreamsMetricsImpl streamsMetrics=new MockStreamsMetrics(new Metrics());
  final StreamTask streamTask=new StreamTask(taskId00,partitions,topology,consumer,changelogReader,createConfig(false),streamsMetrics,stateDirectory,null,time,() -> producer=new MockProducer<>(false,bytesSerializer,bytesSerializer),new NoOpRecordCollector(){
    @Override public void flush(){
      flushed.set(true);
    }
  }
,metrics.sensor("dummy"));
  streamTask.flushState();
  assertTrue(flushed.get());
}
