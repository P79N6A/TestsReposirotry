@Test public void testErrorInRebalancePartitionAssignment() throws Exception {
  RuntimeException exception=new RuntimeException("Assignment error");
  createTask(initialState);
  expectInitializeTask();
  expectPollInitialAssignment();
  expectRebalanceAssignmentError(exception);
  PowerMock.replayAll();
  workerTask.initialize(TASK_CONFIG);
  workerTask.initializeAndStart();
  workerTask.iteration();
  try {
    workerTask.iteration();
    fail("Poll should have raised the rebalance exception");
  }
 catch (  RuntimeException e) {
    assertEquals(exception,e);
  }
  PowerMock.verifyAll();
}
