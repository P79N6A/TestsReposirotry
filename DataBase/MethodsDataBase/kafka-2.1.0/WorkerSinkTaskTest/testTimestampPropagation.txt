@Test public void testTimestampPropagation() throws Exception {
  final Long timestamp=System.currentTimeMillis();
  final TimestampType timestampType=TimestampType.CREATE_TIME;
  createTask(initialState);
  expectInitializeTask();
  expectPollInitialAssignment();
  expectConsumerPoll(1,timestamp,timestampType);
  expectConversionAndTransformation(1);
  Capture<Collection<SinkRecord>> records=EasyMock.newCapture(CaptureType.ALL);
  sinkTask.put(EasyMock.capture(records));
  PowerMock.replayAll();
  workerTask.initialize(TASK_CONFIG);
  workerTask.initializeAndStart();
  workerTask.iteration();
  workerTask.iteration();
  SinkRecord record=records.getValue().iterator().next();
  assertEquals(timestamp,record.timestamp());
  assertEquals(timestampType,record.timestampType());
  PowerMock.verifyAll();
}
