@Test public void testLatestUsableVersion(){
  NodeApiVersions apiVersions=NodeApiVersions.create(Collections.singleton(new ApiVersion(ApiKeys.PRODUCE.id,(short)1,(short)3)));
  assertEquals(3,apiVersions.latestUsableVersion(ApiKeys.PRODUCE));
  assertEquals(1,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)0,(short)1));
  assertEquals(1,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)1,(short)1));
  assertEquals(2,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)1,(short)2));
  assertEquals(3,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)1,(short)3));
  assertEquals(2,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)2,(short)2));
  assertEquals(3,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)2,(short)3));
  assertEquals(3,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)3,(short)3));
  assertEquals(3,apiVersions.latestUsableVersion(ApiKeys.PRODUCE,(short)3,(short)4));
}
