@Test public void shouldAllowJoinUnmaterializedJoinedKTable(){
  final KTable<Bytes,String> table1=builder.table("table-topic1");
  final KTable<Bytes,String> table2=builder.table("table-topic2");
  builder.<Bytes,String>stream("stream-topic").join(table1.join(table2,MockValueJoiner.TOSTRING_JOINER),MockValueJoiner.TOSTRING_JOINER);
  builder.build();
  final ProcessorTopology topology=builder.internalTopologyBuilder.rewriteTopology(new StreamsConfig(props)).build();
  assertThat(topology.stateStores().size(),equalTo(2));
  assertThat(topology.processorConnectedStateStores("KSTREAM-JOIN-0000000010"),equalTo(Utils.mkSet(topology.stateStores().get(0).name(),topology.stateStores().get(1).name())));
  assertThat(topology.processorConnectedStateStores("KTABLE-MERGE-0000000007").isEmpty(),is(true));
}
