@Test public void shouldUseSerdesDefinedInMaterializedToConsumeGlobalTable(){
  final String topic="topic";
  builder.globalTable(topic,Materialized.<Long,String,KeyValueStore<Bytes,byte[]>>as("store").withKeySerde(Serdes.Long()).withValueSerde(Serdes.String()));
  final ConsumerRecordFactory<Long,String> recordFactory=new ConsumerRecordFactory<>(new LongSerializer(),new StringSerializer());
  try (final TopologyTestDriver driver=new TopologyTestDriver(builder.build(),props)){
    driver.pipeInput(recordFactory.create(topic,1L,"value1"));
    driver.pipeInput(recordFactory.create(topic,2L,"value2"));
    final KeyValueStore<Long,String> store=driver.getKeyValueStore("store");
    assertThat(store.get(1L),equalTo("value1"));
    assertThat(store.get(2L),equalTo("value2"));
  }
 }
