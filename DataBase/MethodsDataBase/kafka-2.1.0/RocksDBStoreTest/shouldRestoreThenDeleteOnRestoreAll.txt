@Test public void shouldRestoreThenDeleteOnRestoreAll(){
  final List<KeyValue<byte[],byte[]>> entries=getKeyValueEntries();
  rocksDBStore.init(context,rocksDBStore);
  context.restore(rocksDBStore.name(),entries);
  assertEquals(stringDeserializer.deserialize(null,rocksDBStore.get(new Bytes(stringSerializer.serialize(null,"1")))),"a");
  assertEquals(stringDeserializer.deserialize(null,rocksDBStore.get(new Bytes(stringSerializer.serialize(null,"2")))),"b");
  assertEquals(stringDeserializer.deserialize(null,rocksDBStore.get(new Bytes(stringSerializer.serialize(null,"3")))),"c");
  entries.clear();
  entries.add(new KeyValue<>("2".getBytes(UTF_8),"b".getBytes(UTF_8)));
  entries.add(new KeyValue<>("3".getBytes(UTF_8),"c".getBytes(UTF_8)));
  entries.add(new KeyValue<>("1".getBytes(UTF_8),null));
  context.restore(rocksDBStore.name(),entries);
  final KeyValueIterator<Bytes,byte[]> iterator=rocksDBStore.all();
  final Set<String> keys=new HashSet<>();
  while (iterator.hasNext()) {
    keys.add(stringDeserializer.deserialize(null,iterator.next().key.get()));
  }
  assertThat(keys,equalTo(Utils.mkSet("2","3")));
}
