@Test public void testChecksum(){
  assertEquals(record.checksum(),record.computeChecksum());
  byte attributes=LegacyRecord.computeAttributes(magic,this.compression,TimestampType.CREATE_TIME);
  assertEquals(record.checksum(),LegacyRecord.computeChecksum(magic,attributes,this.timestamp,this.key == null ? null : this.key.array(),this.value == null ? null : this.value.array()));
  assertTrue(record.isValid());
  for (int i=LegacyRecord.CRC_OFFSET + LegacyRecord.CRC_LENGTH; i < record.sizeInBytes(); i++) {
    LegacyRecord copy=copyOf(record);
    copy.buffer().put(i,(byte)69);
    assertFalse(copy.isValid());
    try {
      copy.ensureValid();
      fail("Should fail the above test.");
    }
 catch (    InvalidRecordException e) {
    }
  }
}
