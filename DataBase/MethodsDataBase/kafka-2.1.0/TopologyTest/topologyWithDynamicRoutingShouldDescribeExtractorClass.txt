@Test public void topologyWithDynamicRoutingShouldDescribeExtractorClass(){
  final StreamsBuilder builder=new StreamsBuilder();
  final TopicNameExtractor topicNameExtractor=new TopicNameExtractor(){
    @Override public String extract(    final Object key,    final Object value,    final RecordContext recordContext){
      return recordContext.topic() + "-" + key;
    }
    @Override public String toString(){
      return "anonymous topic name extractor. topic is [recordContext.topic()]-[key]";
    }
  }
;
  builder.stream("input-topic").to(topicNameExtractor);
  final TopologyDescription describe=builder.build().describe();
  assertEquals("Topologies:\n" + "   Sub-topology: 0\n" + "    Source: KSTREAM-SOURCE-0000000000 (topics: [input-topic])\n"+ "      --> KSTREAM-SINK-0000000001\n"+ "    Sink: KSTREAM-SINK-0000000001 (extractor class: anonymous topic name extractor. topic is [recordContext.topic()]-[key])\n"+ "      <-- KSTREAM-SOURCE-0000000000\n\n",describe.toString());
}
