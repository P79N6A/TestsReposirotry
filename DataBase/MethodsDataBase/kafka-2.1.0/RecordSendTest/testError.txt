/** 
 * Test that an asynchronous request will eventually throw the right exception
 */
@Test(expected=ExecutionException.class) public void testError() throws Exception {
  FutureRecordMetadata future=new FutureRecordMetadata(asyncRequest(baseOffset,new CorruptRecordException(),50L),relOffset,RecordBatch.NO_TIMESTAMP,0L,0,0);
  future.get();
}
