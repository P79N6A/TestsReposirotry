@Test public void shouldCloseTaskOnResumeSuspendedIfTaskMigratedException(){
  mockRunningTaskSuspension();
  t1.resume();
  t1.initializeTopology();
  EasyMock.expectLastCall().andThrow(new TaskMigratedException());
  t1.close(false,true);
  EasyMock.expectLastCall();
  EasyMock.replay(t1);
  assertThat(suspendTask(),nullValue());
  try {
    assignedTasks.maybeResumeSuspendedTask(taskId1,Collections.singleton(tp1));
    fail("Should have thrown TaskMigratedException.");
  }
 catch (  final TaskMigratedException expected) {
  }
  assertThat(assignedTasks.runningTaskIds(),equalTo(Collections.EMPTY_SET));
  EasyMock.verify(t1);
}
