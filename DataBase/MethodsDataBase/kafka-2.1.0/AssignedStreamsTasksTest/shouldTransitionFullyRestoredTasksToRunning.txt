@Test public void shouldTransitionFullyRestoredTasksToRunning(){
  final Set<TopicPartition> task1Partitions=Utils.mkSet(tp1);
  EasyMock.expect(t1.initializeStateStores()).andReturn(false);
  EasyMock.expect(t1.partitions()).andReturn(task1Partitions).anyTimes();
  EasyMock.expect(t1.changelogPartitions()).andReturn(Utils.mkSet(changeLog1,changeLog2)).anyTimes();
  EasyMock.expect(t1.hasStateStores()).andReturn(true).anyTimes();
  t1.initializeTopology();
  EasyMock.expectLastCall().once();
  EasyMock.replay(t1);
  addAndInitTask();
  assignedTasks.updateRestored(Utils.mkSet(changeLog1));
  assertThat(assignedTasks.runningTaskIds(),equalTo(Collections.<TaskId>emptySet()));
  assignedTasks.updateRestored(Utils.mkSet(changeLog2));
  assertThat(assignedTasks.runningTaskIds(),equalTo(Collections.singleton(taskId1)));
}
