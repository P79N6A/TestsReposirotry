@Test public void shouldMergeTwoStreams(){
  final String topic1="topic-1";
  final String topic2="topic-2";
  final KStream<String,String> source1=builder.stream(topic1);
  final KStream<String,String> source2=builder.stream(topic2);
  final KStream<String,String> merged=source1.merge(source2);
  merged.process(processorSupplier);
  try (final TopologyTestDriver driver=new TopologyTestDriver(builder.build(),props)){
    driver.pipeInput(recordFactory.create(topic1,"A","aa"));
    driver.pipeInput(recordFactory.create(topic2,"B","bb"));
    driver.pipeInput(recordFactory.create(topic2,"C","cc"));
    driver.pipeInput(recordFactory.create(topic1,"D","dd"));
  }
   assertEquals(Utils.mkList("A:aa","B:bb","C:cc","D:dd"),processorSupplier.theCapturedProcessor().processed);
}
