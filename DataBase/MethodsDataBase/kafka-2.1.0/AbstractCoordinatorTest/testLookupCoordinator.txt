@Test public void testLookupCoordinator(){
  setupCoordinator();
  mockClient.setNode(null);
  RequestFuture<Void> noBrokersAvailableFuture=coordinator.lookupCoordinator();
  assertTrue("Failed future expected",noBrokersAvailableFuture.failed());
  mockClient.setNode(node);
  RequestFuture<Void> future=coordinator.lookupCoordinator();
  assertFalse("Request not sent",future.isDone());
  assertSame("New request sent while one is in progress",future,coordinator.lookupCoordinator());
  mockClient.prepareResponse(groupCoordinatorResponse(node,Errors.NONE));
  coordinator.ensureCoordinatorReady(mockTime.timer(Long.MAX_VALUE));
  assertNotSame("New request not sent after previous completed",future,coordinator.lookupCoordinator());
}
