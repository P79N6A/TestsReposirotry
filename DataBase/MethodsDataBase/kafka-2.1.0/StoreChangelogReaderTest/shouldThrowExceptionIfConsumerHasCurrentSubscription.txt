@Test public void shouldThrowExceptionIfConsumerHasCurrentSubscription(){
  final StateRestorer mockRestorer=EasyMock.mock(StateRestorer.class);
  mockRestorer.setUserRestoreListener(stateRestoreListener);
  expect(mockRestorer.partition()).andReturn(new TopicPartition("sometopic",0)).andReturn(new TopicPartition("sometopic",0)).andReturn(new TopicPartition("sometopic",0)).andReturn(new TopicPartition("sometopic",0));
  EasyMock.replay(mockRestorer);
  changelogReader.register(mockRestorer);
  consumer.subscribe(Collections.singleton("sometopic"));
  try {
    changelogReader.restore(active);
    fail("Should have thrown IllegalStateException");
  }
 catch (  final StreamsException expected) {
  }
}
