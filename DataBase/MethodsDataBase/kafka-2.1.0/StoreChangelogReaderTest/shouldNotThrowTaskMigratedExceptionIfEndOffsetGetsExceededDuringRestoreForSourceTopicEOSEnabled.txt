@Test public void shouldNotThrowTaskMigratedExceptionIfEndOffsetGetsExceededDuringRestoreForSourceTopicEOSEnabled(){
  final int totalMessages=10;
  assignPartition(totalMessages,topicPartition);
  addRecords(5,topicPartition,0);
  addRecords(5,topicPartition,6);
  consumer.assign(Collections.<TopicPartition>emptyList());
  consumer.updateEndOffsets(Collections.singletonMap(topicPartition,12L));
  changelogReader.register(new StateRestorer(topicPartition,restoreListener,null,6,true,"storeName"));
  expect(active.restoringTaskFor(topicPartition)).andReturn(task);
  replay(active);
  changelogReader.restore(active);
  assertThat(callback.restored.size(),equalTo(5));
}
