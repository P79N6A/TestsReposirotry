@Test public void shouldRequestTopicsAndHandleTimeoutException(){
  final AtomicBoolean functionCalled=new AtomicBoolean(false);
  final MockConsumer<byte[],byte[]> consumer=new MockConsumer<byte[],byte[]>(OffsetResetStrategy.EARLIEST){
    @Override public Map<String,List<PartitionInfo>> listTopics(){
      functionCalled.set(true);
      throw new TimeoutException("KABOOM!");
    }
  }
;
  final StoreChangelogReader changelogReader=new StoreChangelogReader(consumer,Duration.ZERO,stateRestoreListener,logContext);
  changelogReader.register(new StateRestorer(topicPartition,restoreListener,null,Long.MAX_VALUE,true,"storeName"));
  changelogReader.restore(active);
  assertTrue(functionCalled.get());
}
