@Test public void shouldCompleteImmediatelyWhenEndOffsetIs0(){
  final Collection<TopicPartition> expected=Collections.singleton(topicPartition);
  setupConsumer(0,topicPartition);
  changelogReader.register(new StateRestorer(topicPartition,restoreListener,null,Long.MAX_VALUE,true,"store"));
  expect(active.restoringTaskFor(topicPartition)).andStubReturn(task);
  replay(active,task);
  final Collection<TopicPartition> restored=changelogReader.restore(active);
  assertThat(restored,equalTo(expected));
}
