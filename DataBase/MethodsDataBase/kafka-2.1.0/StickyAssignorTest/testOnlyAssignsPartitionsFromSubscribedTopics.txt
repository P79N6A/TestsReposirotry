@Test public void testOnlyAssignsPartitionsFromSubscribedTopics(){
  String topic="topic";
  String otherTopic="other";
  String consumerId="consumer";
  Map<String,Integer> partitionsPerTopic=new HashMap<>();
  partitionsPerTopic.put(topic,3);
  partitionsPerTopic.put(otherTopic,3);
  Map<String,Subscription> subscriptions=Collections.singletonMap(consumerId,new Subscription(topics(topic)));
  Map<String,List<TopicPartition>> assignment=assignor.assign(partitionsPerTopic,subscriptions);
  assertEquals(partitions(tp(topic,0),tp(topic,1),tp(topic,2)),assignment.get(consumerId));
  verifyValidityAndBalance(subscriptions,assignment);
  assertTrue(isFullyBalanced(assignment));
}
