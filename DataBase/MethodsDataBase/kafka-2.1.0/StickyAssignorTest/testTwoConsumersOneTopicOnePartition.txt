@Test public void testTwoConsumersOneTopicOnePartition(){
  String topic="topic";
  String consumer1="consumer1";
  String consumer2="consumer2";
  Map<String,Integer> partitionsPerTopic=new HashMap<>();
  partitionsPerTopic.put(topic,1);
  Map<String,Subscription> subscriptions=new HashMap<>();
  subscriptions.put(consumer1,new Subscription(topics(topic)));
  subscriptions.put(consumer2,new Subscription(topics(topic)));
  Map<String,List<TopicPartition>> assignment=assignor.assign(partitionsPerTopic,subscriptions);
  assertEquals(partitions(tp(topic,0)),assignment.get(consumer1));
  assertEquals(Collections.<TopicPartition>emptyList(),assignment.get(consumer2));
  verifyValidityAndBalance(subscriptions,assignment);
  assertTrue(isFullyBalanced(assignment));
}
