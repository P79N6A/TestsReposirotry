@Test public void buildDefaultRecordBatchWithProducerId(){
  long pid=23423L;
  short epoch=145;
  int baseSequence=983;
  ByteBuffer buffer=ByteBuffer.allocate(2048);
  MemoryRecordsBuilder builder=MemoryRecords.builder(buffer,RecordBatch.MAGIC_VALUE_V2,CompressionType.NONE,TimestampType.CREATE_TIME,1234567L,RecordBatch.NO_TIMESTAMP,pid,epoch,baseSequence);
  builder.appendWithOffset(1234567,1L,"a".getBytes(),"v".getBytes());
  builder.appendWithOffset(1234568,2L,"b".getBytes(),"v".getBytes());
  MemoryRecords records=builder.build();
  for (  MutableRecordBatch batch : records.batches()) {
    assertTrue(batch.isValid());
    assertEquals(1234567,batch.baseOffset());
    assertEquals(1234568,batch.lastOffset());
    assertEquals(2L,batch.maxTimestamp());
    assertEquals(pid,batch.producerId());
    assertEquals(epoch,batch.producerEpoch());
    assertEquals(baseSequence,batch.baseSequence());
    assertEquals(baseSequence + 1,batch.lastSequence());
    for (    Record record : batch) {
      assertTrue(record.isValid());
    }
  }
}
