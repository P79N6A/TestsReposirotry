@Test public void testSetLogAppendTime(){
  MemoryRecords records=MemoryRecords.withRecords(RecordBatch.MAGIC_VALUE_V2,0L,CompressionType.NONE,TimestampType.CREATE_TIME,new SimpleRecord(1L,"a".getBytes(),"1".getBytes()),new SimpleRecord(2L,"b".getBytes(),"2".getBytes()),new SimpleRecord(3L,"c".getBytes(),"3".getBytes()));
  long logAppendTime=15L;
  DefaultRecordBatch batch=new DefaultRecordBatch(records.buffer());
  batch.setMaxTimestamp(TimestampType.LOG_APPEND_TIME,logAppendTime);
  assertEquals(TimestampType.LOG_APPEND_TIME,batch.timestampType());
  assertEquals(logAppendTime,batch.maxTimestamp());
  assertTrue(batch.isValid());
  List<MutableRecordBatch> recordBatches=Utils.toList(records.batches().iterator());
  assertEquals(1,recordBatches.size());
  assertEquals(logAppendTime,recordBatches.get(0).maxTimestamp());
  assertEquals(TimestampType.LOG_APPEND_TIME,recordBatches.get(0).timestampType());
  for (  Record record : records.records())   assertEquals(logAppendTime,record.timestamp());
}
