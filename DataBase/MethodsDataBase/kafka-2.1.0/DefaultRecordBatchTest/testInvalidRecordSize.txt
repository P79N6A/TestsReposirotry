@Test(expected=InvalidRecordException.class) public void testInvalidRecordSize(){
  MemoryRecords records=MemoryRecords.withRecords(RecordBatch.MAGIC_VALUE_V2,0L,CompressionType.NONE,TimestampType.CREATE_TIME,new SimpleRecord(1L,"a".getBytes(),"1".getBytes()),new SimpleRecord(2L,"b".getBytes(),"2".getBytes()),new SimpleRecord(3L,"c".getBytes(),"3".getBytes()));
  ByteBuffer buffer=records.buffer();
  buffer.putInt(DefaultRecordBatch.LENGTH_OFFSET,10);
  DefaultRecordBatch batch=new DefaultRecordBatch(buffer);
  assertFalse(batch.isValid());
  batch.ensureValid();
}
