@Test public void buildDefaultRecordBatch(){
  ByteBuffer buffer=ByteBuffer.allocate(2048);
  MemoryRecordsBuilder builder=MemoryRecords.builder(buffer,RecordBatch.MAGIC_VALUE_V2,CompressionType.NONE,TimestampType.CREATE_TIME,1234567L);
  builder.appendWithOffset(1234567,1L,"a".getBytes(),"v".getBytes());
  builder.appendWithOffset(1234568,2L,"b".getBytes(),"v".getBytes());
  MemoryRecords records=builder.build();
  for (  MutableRecordBatch batch : records.batches()) {
    assertTrue(batch.isValid());
    assertEquals(1234567,batch.baseOffset());
    assertEquals(1234568,batch.lastOffset());
    assertEquals(2L,batch.maxTimestamp());
    assertEquals(RecordBatch.NO_PRODUCER_ID,batch.producerId());
    assertEquals(RecordBatch.NO_PRODUCER_EPOCH,batch.producerEpoch());
    assertEquals(RecordBatch.NO_SEQUENCE,batch.baseSequence());
    assertEquals(RecordBatch.NO_SEQUENCE,batch.lastSequence());
    for (    Record record : batch) {
      assertTrue(record.isValid());
    }
  }
}
