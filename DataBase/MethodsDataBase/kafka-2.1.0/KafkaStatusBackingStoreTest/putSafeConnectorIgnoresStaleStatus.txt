@Test public void putSafeConnectorIgnoresStaleStatus(){
  byte[] value=new byte[0];
  String otherWorkerId="anotherhost:8083";
  KafkaBasedLog<String,byte[]> kafkaBasedLog=mock(KafkaBasedLog.class);
  Converter converter=mock(Converter.class);
  KafkaStatusBackingStore store=new KafkaStatusBackingStore(new MockTime(),converter,STATUS_TOPIC,kafkaBasedLog);
  Map<String,Object> statusMap=new HashMap<>();
  statusMap.put("worker_id",otherWorkerId);
  statusMap.put("state","RUNNING");
  statusMap.put("generation",1L);
  expect(converter.toConnectData(STATUS_TOPIC,value)).andReturn(new SchemaAndValue(null,statusMap));
  replayAll();
  store.read(consumerRecord(0,"status-connector-conn",value));
  store.putSafe(new ConnectorStatus(CONNECTOR,ConnectorStatus.State.UNASSIGNED,WORKER_ID,0));
  ConnectorStatus status=new ConnectorStatus(CONNECTOR,ConnectorStatus.State.RUNNING,otherWorkerId,1);
  assertEquals(status,store.get(CONNECTOR));
  verifyAll();
}
