@Test public void shouldNotChangeOffsetsIfAckedOffsetsIsNull() throws IOException {
  final Map<TopicPartition,Long> offsets=Collections.singletonMap(persistentStorePartition,99L);
  checkpoint.write(offsets);
  final MockKeyValueStore persistentStore=new MockKeyValueStore(persistentStoreName,true);
  final ProcessorStateManager stateMgr=new ProcessorStateManager(taskId,noPartitions,false,stateDirectory,Collections.emptyMap(),changelogReader,false,logContext);
  stateMgr.register(persistentStore,persistentStore.stateRestoreCallback);
  stateMgr.close(null);
  final Map<TopicPartition,Long> read=checkpoint.read();
  assertThat(read,equalTo(offsets));
}
