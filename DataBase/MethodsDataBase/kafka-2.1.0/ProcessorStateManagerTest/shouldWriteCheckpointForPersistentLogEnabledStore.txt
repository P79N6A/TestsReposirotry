@Test public void shouldWriteCheckpointForPersistentLogEnabledStore() throws IOException {
  final ProcessorStateManager stateMgr=new ProcessorStateManager(taskId,noPartitions,false,stateDirectory,Collections.singletonMap(persistentStore.name(),persistentStoreTopicName),changelogReader,false,logContext);
  stateMgr.register(persistentStore,persistentStore.stateRestoreCallback);
  stateMgr.checkpoint(Collections.singletonMap(persistentStorePartition,10L));
  final Map<TopicPartition,Long> read=checkpoint.read();
  assertThat(read,equalTo(Collections.singletonMap(persistentStorePartition,11L)));
}
