@Test public void testGetStore() throws IOException {
  final MockKeyValueStore mockKeyValueStore=new MockKeyValueStore(nonPersistentStoreName,false);
  final ProcessorStateManager stateMgr=new ProcessorStateManager(new TaskId(0,1),noPartitions,false,stateDirectory,Collections.emptyMap(),changelogReader,false,logContext);
  try {
    stateMgr.register(mockKeyValueStore,mockKeyValueStore.stateRestoreCallback);
    assertNull(stateMgr.getStore("noSuchStore"));
    assertEquals(mockKeyValueStore,stateMgr.getStore(nonPersistentStoreName));
  }
  finally {
    stateMgr.close(Collections.emptyMap());
  }
}
