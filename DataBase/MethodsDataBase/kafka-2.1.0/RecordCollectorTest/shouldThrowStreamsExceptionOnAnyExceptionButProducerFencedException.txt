@SuppressWarnings("unchecked") @Test(expected=StreamsException.class) public void shouldThrowStreamsExceptionOnAnyExceptionButProducerFencedException(){
  final RecordCollector collector=new RecordCollectorImpl("test",logContext,new DefaultProductionExceptionHandler(),new Metrics().sensor("skipped-records"));
  collector.init(new MockProducer(cluster,true,new DefaultPartitioner(),byteArraySerializer,byteArraySerializer){
    @Override public synchronized Future<RecordMetadata> send(    final ProducerRecord record,    final Callback callback){
      throw new KafkaException();
    }
  }
);
  collector.send("topic1","3","0",null,null,stringSerializer,stringSerializer,streamPartitioner);
}
