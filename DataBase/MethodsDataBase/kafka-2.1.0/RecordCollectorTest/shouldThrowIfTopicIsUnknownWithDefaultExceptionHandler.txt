@SuppressWarnings("unchecked") @Test(expected=StreamsException.class) public void shouldThrowIfTopicIsUnknownWithDefaultExceptionHandler(){
  final RecordCollector collector=new RecordCollectorImpl("test",logContext,new DefaultProductionExceptionHandler(),new Metrics().sensor("skipped-records"));
  collector.init(new MockProducer(cluster,true,new DefaultPartitioner(),byteArraySerializer,byteArraySerializer){
    @Override public List<PartitionInfo> partitionsFor(    final String topic){
      return Collections.EMPTY_LIST;
    }
  }
);
  collector.send("topic1","3","0",null,null,stringSerializer,stringSerializer,streamPartitioner);
}
