@Test public void shouldExhaustRetriesOnTimeoutExceptionForMakeReady(){
  mockAdminClient.timeoutNextRequest(4);
  final InternalTopicConfig internalTopicConfig=new RepartitionTopicConfig(topic,Collections.<String,String>emptyMap());
  internalTopicConfig.setNumberOfPartitions(1);
  try {
    internalTopicManager.makeReady(Collections.singletonMap(topic,internalTopicConfig));
    fail("Should have thrown StreamsException.");
  }
 catch (  final StreamsException expected) {
    assertNull(expected.getCause());
    assertEquals("Could not create topics. This can happen if the Kafka cluster is temporary not available. You can increase admin client config `retries` to be resilient against this error.",expected.getMessage());
  }
}
