@Test public void shouldUpdateSegmentFileNameFromOldDateFormatToNewFormat() throws Exception {
  final long segmentInterval=60_000L;
  segments=new Segments(storeName,NUM_SEGMENTS * segmentInterval,segmentInterval);
  final String storeDirectoryPath=stateDirectory.getAbsolutePath() + File.separator + storeName;
  final File storeDirectory=new File(storeDirectoryPath);
  storeDirectory.mkdirs();
  final SimpleDateFormat formatter=new SimpleDateFormat("yyyyMMddHHmm");
  formatter.setTimeZone(new SimpleTimeZone(0,"UTC"));
  for (int segmentId=0; segmentId < NUM_SEGMENTS; ++segmentId) {
    final File oldSegment=new File(storeDirectoryPath + File.separator + storeName+ "-"+ formatter.format(new Date(segmentId * segmentInterval)));
    oldSegment.createNewFile();
  }
  segments.openExisting(context);
  for (int segmentId=0; segmentId < NUM_SEGMENTS; ++segmentId) {
    final String segmentName=storeName + "." + (long)segmentId * segmentInterval;
    final File newSegment=new File(storeDirectoryPath + File.separator + segmentName);
    assertTrue(newSegment.exists());
  }
}
