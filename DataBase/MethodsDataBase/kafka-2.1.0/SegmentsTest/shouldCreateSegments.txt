@Test public void shouldCreateSegments(){
  final Segment segment1=segments.getOrCreateSegmentIfLive(0,context);
  final Segment segment2=segments.getOrCreateSegmentIfLive(1,context);
  final Segment segment3=segments.getOrCreateSegmentIfLive(2,context);
  assertTrue(new File(context.stateDir(),"test/test.0").isDirectory());
  assertTrue(new File(context.stateDir(),"test/test." + SEGMENT_INTERVAL).isDirectory());
  assertTrue(new File(context.stateDir(),"test/test." + 2 * SEGMENT_INTERVAL).isDirectory());
  assertTrue(segment1.isOpen());
  assertTrue(segment2.isOpen());
  assertTrue(segment3.isOpen());
}
