@Test @SuppressWarnings("unchecked") public void shouldHandleNullValuesWhenThrowingStreamsExceptionOnKeyValueTypeSerializerMismatch(){
  final String invalidKeyToTriggerSerializerMismatch="";
  context.setTime(1);
  try {
    sink.process(invalidKeyToTriggerSerializerMismatch,null);
    fail("Should have thrown StreamsException");
  }
 catch (  final StreamsException e) {
    assertThat(e.getCause(),instanceOf(ClassCastException.class));
    assertThat(e.getMessage(),containsString("unknown because value is null"));
  }
}
