@Test @SuppressWarnings("unchecked") public void shouldThrowStreamsExceptionOnKeyValueTypeSerializerMismatch(){
  final String keyOfDifferentTypeThanSerializer="key with different type";
  final String valueOfDifferentTypeThanSerializer="value with different type";
  context.setTime(0);
  try {
    sink.process(keyOfDifferentTypeThanSerializer,valueOfDifferentTypeThanSerializer);
    fail("Should have thrown StreamsException");
  }
 catch (  final StreamsException e) {
    assertThat(e.getCause(),instanceOf(ClassCastException.class));
  }
}
