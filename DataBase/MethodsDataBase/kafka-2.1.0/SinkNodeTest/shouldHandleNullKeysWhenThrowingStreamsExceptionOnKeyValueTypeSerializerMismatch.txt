@Test @SuppressWarnings("unchecked") public void shouldHandleNullKeysWhenThrowingStreamsExceptionOnKeyValueTypeSerializerMismatch(){
  final String invalidValueToTriggerSerializerMismatch="";
  context.setTime(1);
  try {
    sink.process(null,invalidValueToTriggerSerializerMismatch);
    fail("Should have thrown StreamsException");
  }
 catch (  final StreamsException e) {
    assertThat(e.getCause(),instanceOf(ClassCastException.class));
    assertThat(e.getMessage(),containsString("unknown because key is null"));
  }
}
