@Test public void testTokenAuthenticationOverSaslScram() throws Exception {
  SecurityProtocol securityProtocol=SecurityProtocol.SASL_SSL;
  TestJaasConfig jaasConfig=configureMechanisms("SCRAM-SHA-256",Arrays.asList("SCRAM-SHA-256"));
  Map<String,Object> options=new HashMap<>();
  String tokenId="token1";
  String tokenHmac="abcdefghijkl";
  options.put("username",tokenId);
  options.put("password",tokenHmac);
  options.put(ScramLoginModule.TOKEN_AUTH_CONFIG,"true");
  jaasConfig.createOrUpdateEntry(TestJaasConfig.LOGIN_CONTEXT_CLIENT,ScramLoginModule.class.getName(),options);
  server=createEchoServer(securityProtocol);
  createAndCheckClientConnectionFailure(securityProtocol,"0");
  KafkaPrincipal owner=SecurityUtils.parseKafkaPrincipal("User:Owner");
  KafkaPrincipal renewer=SecurityUtils.parseKafkaPrincipal("User:Renewer1");
  TokenInformation tokenInfo=new TokenInformation(tokenId,owner,Collections.singleton(renewer),System.currentTimeMillis(),System.currentTimeMillis(),System.currentTimeMillis());
  server.tokenCache().addToken(tokenId,tokenInfo);
  createAndCheckClientConnectionFailure(securityProtocol,"0");
  updateTokenCredentialCache(tokenId,tokenHmac);
  createAndCheckClientConnection(securityProtocol,"0");
}
