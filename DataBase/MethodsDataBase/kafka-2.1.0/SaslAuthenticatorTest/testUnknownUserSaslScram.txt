/** 
 * Tests that SASL/SCRAM clients without valid username fail authentication.
 */
@Test public void testUnknownUserSaslScram() throws Exception {
  SecurityProtocol securityProtocol=SecurityProtocol.SASL_SSL;
  TestJaasConfig jaasConfig=configureMechanisms("SCRAM-SHA-256",Arrays.asList("SCRAM-SHA-256"));
  Map<String,Object> options=new HashMap<>();
  options.put("username","unknownUser");
  options.put("password",TestJaasConfig.PASSWORD);
  jaasConfig.createOrUpdateEntry(TestJaasConfig.LOGIN_CONTEXT_CLIENT,ScramLoginModule.class.getName(),options);
  String node="0";
  server=createEchoServer(securityProtocol);
  updateScramCredentialCache(TestJaasConfig.USERNAME,TestJaasConfig.PASSWORD);
  createAndCheckClientAuthenticationFailure(securityProtocol,node,"SCRAM-SHA-256",null);
  server.verifyAuthenticationMetrics(0,1);
}
