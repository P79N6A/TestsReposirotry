/** 
 * Tests SASL login callback class override.
 */
@Test public void testClientLoginCallbackOverride() throws Exception {
  SecurityProtocol securityProtocol=SecurityProtocol.SASL_PLAINTEXT;
  TestJaasConfig jaasConfig=configureMechanisms("PLAIN",Collections.singletonList("PLAIN"));
  jaasConfig.createOrUpdateEntry(TestJaasConfig.LOGIN_CONTEXT_CLIENT,TestPlainLoginModule.class.getName(),Collections.emptyMap());
  server=createEchoServer(securityProtocol);
  saslClientConfigs.put(SaslConfigs.SASL_LOGIN_CALLBACK_HANDLER_CLASS,TestLoginCallbackHandler.class.getName());
  createAndCheckClientConnection(securityProtocol,"1");
  saslClientConfigs.remove(SaslConfigs.SASL_LOGIN_CALLBACK_HANDLER_CLASS);
  try {
    createClientConnection(securityProtocol,"invalid");
  }
 catch (  Exception e) {
    assertTrue("Unexpected exception " + e.getCause(),e.getCause() instanceof LoginException);
  }
}
