/** 
 * Tests that SASL/SCRAM clients fail authentication if password is invalid.
 */
@Test public void testInvalidPasswordSaslScram() throws Exception {
  SecurityProtocol securityProtocol=SecurityProtocol.SASL_SSL;
  TestJaasConfig jaasConfig=configureMechanisms("SCRAM-SHA-256",Arrays.asList("SCRAM-SHA-256"));
  Map<String,Object> options=new HashMap<>();
  options.put("username",TestJaasConfig.USERNAME);
  options.put("password","invalidpassword");
  jaasConfig.createOrUpdateEntry(TestJaasConfig.LOGIN_CONTEXT_CLIENT,ScramLoginModule.class.getName(),options);
  String node="0";
  server=createEchoServer(securityProtocol);
  updateScramCredentialCache(TestJaasConfig.USERNAME,TestJaasConfig.PASSWORD);
  createAndCheckClientAuthenticationFailure(securityProtocol,node,"SCRAM-SHA-256",null);
  server.verifyAuthenticationMetrics(0,1);
}
