/** 
 * Tests that  {@link org.apache.kafka.clients.Metadata#awaitUpdate(int,long)} doesn'twait forever with a max timeout value of 0
 * @throws Exception
 * @see <a href=https://issues.apache.org/jira/browse/KAFKA-1836>KAFKA-1836</a>
 */
@Test public void testMetadataUpdateWaitTime() throws Exception {
  long time=0;
  metadata.update(Cluster.empty(),Collections.<String>emptySet(),time);
  assertFalse("No update needed.",metadata.timeToNextUpdate(time) == 0);
  try {
    metadata.awaitUpdate(metadata.requestUpdate(),0);
    fail("Wait on metadata update was expected to timeout, but it didn't");
  }
 catch (  TimeoutException te) {
  }
  final long twoSecondWait=2000;
  try {
    metadata.awaitUpdate(metadata.requestUpdate(),twoSecondWait);
    fail("Wait on metadata update was expected to timeout, but it didn't");
  }
 catch (  TimeoutException te) {
  }
}
