public static void printResultSetUseColumnName(ResultSet rs,PrintStream out) throws SQLException {
  ResultSetMetaData metadata=rs.getMetaData();
  int columnCount=metadata.getColumnCount();
  for (int columnIndex=1; columnIndex <= columnCount; ++columnIndex) {
    if (columnIndex != 1) {
      out.print('\t');
    }
    out.print(metadata.getColumnName(columnIndex));
  }
  out.println();
  while (rs.next()) {
    for (int columnIndex=1; columnIndex <= columnCount; ++columnIndex) {
      if (columnIndex != 1) {
        out.print('\t');
      }
      String columnName=metadata.getColumnName(columnIndex);
      int type=metadata.getColumnType(columnIndex);
      if (type == Types.VARCHAR || type == Types.CHAR || type == Types.NVARCHAR || type == Types.NCHAR) {
        out.print(rs.getString(columnName));
      }
 else       if (type == Types.DATE) {
        Date date=rs.getDate(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(date.toString());
        }
      }
 else       if (type == Types.BIT) {
        boolean value=rs.getBoolean(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(Boolean.toString(value));
        }
      }
 else       if (type == Types.BOOLEAN) {
        boolean value=rs.getBoolean(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(Boolean.toString(value));
        }
      }
 else       if (type == Types.TINYINT) {
        byte value=rs.getByte(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(Byte.toString(value));
        }
      }
 else       if (type == Types.SMALLINT) {
        short value=rs.getShort(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(Short.toString(value));
        }
      }
 else       if (type == Types.INTEGER) {
        int value=rs.getInt(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(Integer.toString(value));
        }
      }
 else       if (type == Types.BIGINT) {
        long value=rs.getLong(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(Long.toString(value));
        }
      }
 else       if (type == Types.TIMESTAMP) {
        out.print(String.valueOf(rs.getTimestamp(columnName)));
      }
 else       if (type == Types.DECIMAL) {
        out.print(String.valueOf(rs.getBigDecimal(columnName)));
      }
 else       if (type == Types.CLOB) {
        out.print(String.valueOf(rs.getString(columnName)));
      }
 else       if (type == Types.JAVA_OBJECT) {
        Object objec=rs.getObject(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(String.valueOf(objec));
        }
      }
 else       if (type == Types.LONGVARCHAR) {
        Object objec=rs.getString(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(String.valueOf(objec));
        }
      }
 else {
        Object objec=rs.getObject(columnName);
        if (rs.wasNull()) {
          out.print("null");
        }
 else {
          out.print(String.valueOf(objec));
        }
      }
    }
    out.println();
  }
}
