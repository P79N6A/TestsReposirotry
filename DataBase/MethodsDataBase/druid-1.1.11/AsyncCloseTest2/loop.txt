protected void loop() throws InterruptedException {
  dataSource.shrink();
  Assert.assertEquals(0,dataSource.getActiveCount());
  Assert.assertEquals(0,dataSource.getPoolingCount());
  final int COUNT=1024 * 128;
  final CountDownLatch closeLatch=new CountDownLatch(COUNT * 2);
  Runnable connTask=new Runnable(){
    @Override public void run(){
      try {
        Connection conn=dataSource.getConnection();
        Statement stmt=conn.createStatement();
        CloseTask closeTask=new CloseTask(conn,closeLatch);
        closeExecutor.submit(closeTask);
        closeExecutor.submit(closeTask);
        try {
          stmt.execute("select 1");
        }
  finally {
          stmt.close();
          conn.close();
        }
      }
 catch (      SQLException e) {
        errorCount.incrementAndGet();
      }
    }
  }
;
  for (int i=0; i < COUNT; ++i) {
    connExecutor.submit(connTask);
  }
  closeLatch.await();
  Assert.assertEquals("expect activeCount zero",0,dataSource.getActiveCount());
}
