protected void setUp() throws Exception {
  dataSource=new DruidDataSource();
  dataSource.setUrl("jdbc:mock:xxx");
  dataSource.setTestOnBorrow(true);
  dataSource.setValidationQuery("select 'x'");
  dataSource.setValidConnectionChecker(new ValidConnectionCheckerAdapter(){
    @Override public boolean isValidConnection(    Connection c,    String query,    int validationQueryTimeout){
      int count=validCount.getAndIncrement();
      if (count == 0) {
        return true;
      }
      if (count == 1) {
        return false;
      }
      return true;
    }
  }
);
}
