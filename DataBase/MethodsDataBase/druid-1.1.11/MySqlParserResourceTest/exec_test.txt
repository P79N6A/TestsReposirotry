public void exec_test(String resource) throws Exception {
  InputStream is=null;
  is=Thread.currentThread().getContextClassLoader().getResourceAsStream(resource);
  Reader reader=new InputStreamReader(is,"UTF-8");
  String input=Utils.read(reader);
  JdbcUtils.close(reader);
  String[] items=input.split("---------------------------");
  String sql=items[0].trim();
  String expect=items[1].trim();
  MySqlStatementParser parser=new MySqlStatementParser(sql);
  List<SQLStatement> statementList=parser.parseStatementList();
  Assert.assertEquals(1,statementList.size());
  String text=output(statementList);
  expect=expect.replaceAll("\\r\\n","\n");
  Assert.assertEquals("errror resource " + resource,expect,text.trim());
  String mergeExpect=null;
  if (items.length == 3) {
    mergeExpect=items[2].trim();
  }
  if (mergeExpect != null) {
    mergValidate(sql,mergeExpect);
  }
}
