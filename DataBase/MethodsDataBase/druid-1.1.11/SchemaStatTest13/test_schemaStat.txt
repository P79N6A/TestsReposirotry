public void test_schemaStat() throws Exception {
  String sql="select a.id, b.name from (select t1.* from table1 t1 left join table3 t3 on cast(t1.id as bigint) = t3.id) a inner join table2 b on a.id = b.id";
  String dbType=JdbcConstants.ORACLE;
  SQLStatementParser parser=SQLParserUtils.createSQLStatementParser(sql,dbType);
  SQLStatement stmt=parser.parseStatementList().get(0);
  System.out.println(stmt);
  SchemaStatVisitor statVisitor=SQLUtils.createSchemaStatVisitor(dbType);
  stmt.accept(statVisitor);
  Set<TableStat.Relationship> relationships=statVisitor.getRelationships();
  System.out.println("columns : " + statVisitor.getColumns());
  System.out.println("groups : " + statVisitor.getGroupByColumns());
  System.out.println("relationships : " + statVisitor.getRelationships());
  System.out.println("conditions : " + statVisitor.getConditions());
  assertEquals(2,relationships.size());
  Assert.assertEquals(5,statVisitor.getColumns().size());
  Assert.assertEquals(3,statVisitor.getConditions().size());
  assertEquals(0,statVisitor.getFunctions().size());
}
