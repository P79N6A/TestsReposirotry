private void concurrent(final int threadCount) throws Exception {
  Thread[] threads=new Thread[threadCount];
  final CountDownLatch startLatch=new CountDownLatch(1);
  final CountDownLatch endLatch=new CountDownLatch(threadCount);
  for (int i=0; i < threadCount; ++i) {
    threads[i]=new Thread("thread-" + i){
      public void run(){
        try {
          startLatch.await();
          for (int i=0; i < 1000; ++i) {
            Connection conn=dataSource.getConnection();
            conn.close();
          }
        }
 catch (        Exception e) {
          e.printStackTrace();
        }
 finally {
          endLatch.countDown();
        }
      }
    }
;
  }
  startLatch.countDown();
  for (int i=0; i < threadCount; ++i) {
    threads[i].start();
  }
  endLatch.await();
}
