/** 
 * This unit test should register events and event handlers correctly with the event dispatcher and events should be dispatched accordingly.
 */
@Test public void testEventDriverPattern(){
  EventDispatcher dispatcher=spy(new EventDispatcher());
  UserCreatedEventHandler userCreatedEventHandler=spy(new UserCreatedEventHandler());
  UserUpdatedEventHandler userUpdatedEventHandler=spy(new UserUpdatedEventHandler());
  dispatcher.registerHandler(UserCreatedEvent.class,userCreatedEventHandler);
  dispatcher.registerHandler(UserUpdatedEvent.class,userUpdatedEventHandler);
  User user=new User("iluwatar");
  UserCreatedEvent userCreatedEvent=new UserCreatedEvent(user);
  UserUpdatedEvent userUpdatedEvent=new UserUpdatedEvent(user);
  dispatcher.dispatch(userCreatedEvent);
  verify(userCreatedEventHandler).onEvent(userCreatedEvent);
  verify(dispatcher).dispatch(userCreatedEvent);
  dispatcher.dispatch(userUpdatedEvent);
  verify(userUpdatedEventHandler).onEvent(userUpdatedEvent);
  verify(dispatcher).dispatch(userUpdatedEvent);
}
