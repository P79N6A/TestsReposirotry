@Test public void testFindWizardsWithSpell() throws Exception {
  final Set<Wizard> wizards=new HashSet<>();
  wizards.add(mock(Wizard.class));
  wizards.add(mock(Wizard.class));
  wizards.add(mock(Wizard.class));
  final Spellbook spellbook=mock(Spellbook.class);
  when(spellbook.getWizards()).thenReturn(wizards);
  final SpellbookDao spellbookDao=mock(SpellbookDao.class);
  final WizardDao wizardDao=mock(WizardDao.class);
  final Spell spell=mock(Spell.class);
  when(spell.getSpellbook()).thenReturn(spellbook);
  final String spellName="spellname";
  final SpellDao spellDao=mock(SpellDao.class);
  when(spellDao.findByName(eq(spellName))).thenReturn(spell);
  final MagicServiceImpl service=new MagicServiceImpl(wizardDao,spellbookDao,spellDao);
  verifyZeroInteractions(wizardDao,spellbookDao,spellDao,spellbook);
  final List<Wizard> result=service.findWizardsWithSpell(spellName);
  verify(spellDao).findByName(eq(spellName));
  verify(spellbook).getWizards();
  assertNotNull(result);
  assertEquals(3,result.size());
  verifyNoMoreInteractions(wizardDao,spellbookDao,spellDao);
}
