/** 
 * Verify reader and writer can only get the lock to read and write orderly
 */
@Test public void testReadAndWrite() throws Exception {
  ReaderWriterLock lock=new ReaderWriterLock();
  Reader reader1=new Reader("Reader 1",lock.readLock());
  Writer writer1=new Writer("Writer 1",lock.writeLock());
  ExecutorService executeService=Executors.newFixedThreadPool(2);
  executeService.submit(reader1);
  Thread.sleep(150);
  executeService.submit(writer1);
  executeService.shutdown();
  try {
    executeService.awaitTermination(10,TimeUnit.SECONDS);
  }
 catch (  InterruptedException e) {
    LOGGER.error("Error waiting for ExecutorService shutdown",e);
  }
  assertTrue(appender.logContains("Reader 1 begin"));
  assertTrue(appender.logContains("Reader 1 finish"));
  assertTrue(appender.logContains("Writer 1 begin"));
  assertTrue(appender.logContains("Writer 1 finish"));
}
