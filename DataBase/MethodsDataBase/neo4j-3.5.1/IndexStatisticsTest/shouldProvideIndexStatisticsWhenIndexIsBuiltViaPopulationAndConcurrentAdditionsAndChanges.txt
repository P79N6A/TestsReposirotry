@Test public void shouldProvideIndexStatisticsWhenIndexIsBuiltViaPopulationAndConcurrentAdditionsAndChanges() throws Exception {
  indexOnlineMonitor.initialize(1);
  long[] nodes=repeatCreateNamedPeopleFor(NAMES.length * CREATION_MULTIPLIER);
  int initialNodes=nodes.length;
  IndexReference index=createPersonNameIndex();
  UpdatesTracker updatesTracker=executeCreationsAndUpdates(nodes,CREATION_MULTIPLIER);
  awaitIndexesOnline();
  assertIndexedNodesMatchesStoreNodes();
  int seenWhilePopulating=initialNodes + updatesTracker.createdDuringPopulation();
  double expectedSelectivity=UNIQUE_NAMES / seenWhilePopulating;
  assertCorrectIndexSelectivity(expectedSelectivity,indexSelectivity(index));
  assertCorrectIndexSize(seenWhilePopulating,indexSize(index));
  int expectedIndexUpdates=updatesTracker.createdAfterPopulation() + updatesTracker.updatedAfterPopulation();
  assertCorrectIndexUpdates(expectedIndexUpdates,indexUpdates(index));
}
