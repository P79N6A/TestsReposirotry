@Test public void useWritableIndexSearcherInReadOnlyModeForNonSingleInstance() throws Exception {
  IndexIdentifier indexIdentifier=identifier("foo");
  prepareIndexesByIdentifiers(indexIdentifier);
  stopDataSource();
  Config readOnlyConfig=Config.defaults(readOnlyConfig());
  dataSource=life.add(getLuceneDataSource(readOnlyConfig,OperationalMode.ha));
  IndexReference indexSearcher=dataSource.getIndexSearcher(indexIdentifier);
  assertTrue("Writable index reference should be used in read only mode in ha mode.",WritableIndexReference.class.isInstance(indexSearcher));
}
