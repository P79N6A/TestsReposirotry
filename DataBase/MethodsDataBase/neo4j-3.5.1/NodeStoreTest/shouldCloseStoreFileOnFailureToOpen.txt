@Test public void shouldCloseStoreFileOnFailureToOpen(){
  final MutableBoolean fired=new MutableBoolean();
  FileSystemAbstraction fs=new DelegatingFileSystemAbstraction(efs.get()){
    @Override public StoreChannel open(    File fileName,    OpenMode openMode) throws IOException {
      return new DelegatingStoreChannel(super.open(fileName,openMode)){
        @Override public void readAll(        ByteBuffer dst) throws IOException {
          fired.setValue(true);
          throw new IOException("Proving a point here");
        }
      }
;
    }
  }
;
  try (PageCache pageCache=pageCacheRule.getPageCache(fs)){
    newNodeStore(fs);
    fail("Should fail");
  }
 catch (  Exception e) {
    assertTrue(contains(e,IOException.class));
    assertTrue(fired.booleanValue());
  }
}
