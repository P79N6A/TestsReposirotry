@Test public void shouldHandleRandomUpdates() throws Exception {
  Set<IndexEntryUpdate<IndexDescriptor>> expectedData=new HashSet<>();
  Iterator<IndexEntryUpdate<IndexDescriptor>> newDataGenerator=valueCreatorUtil.randomUpdateGenerator(random);
  int rounds=50;
  for (int round=0; round < rounds; round++) {
    IndexEntryUpdate<IndexDescriptor>[] batch=generateRandomUpdates(expectedData,newDataGenerator,random.nextInt(5,20),(float)round / rounds * 2);
    processAll(batch);
    applyUpdatesToExpectedData(expectedData,batch);
    forceAndCloseAccessor();
    verifyUpdates(expectedData.toArray(new IndexEntryUpdate[0]));
    setupAccessor();
  }
}
