@Test public void shouldSeeAllNodesAddedInTransaction() throws Exception {
  if (index.type() != UNIQUE) {
    try (Transaction ignore=graphDatabaseAPI.beginTx()){
      long nodeID1=createNode();
      long nodeID2=createNode();
      long nodeID3=createNode();
      KernelTransaction ktx=ktx();
      Set<Long> result=new HashSet<>();
      try (NodeValueIndexCursor cursor=seek(ktx)){
        while (cursor.next()) {
          result.add(cursor.nodeReference());
        }
      }
       assertThat(result,containsInAnyOrder(nodeID1,nodeID2,nodeID3));
    }
   }
}
