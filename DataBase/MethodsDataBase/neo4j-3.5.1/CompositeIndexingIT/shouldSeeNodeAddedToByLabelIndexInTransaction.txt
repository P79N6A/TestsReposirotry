@Test public void shouldSeeNodeAddedToByLabelIndexInTransaction() throws Exception {
  try (Transaction ignore=graphDatabaseAPI.beginTx()){
    KernelTransaction ktx=ktx();
    Write write=ktx.dataWrite();
    long nodeID=write.nodeCreate();
    for (    int propID : index.schema().getPropertyIds()) {
      write.nodeSetProperty(nodeID,propID,Values.intValue(propID));
    }
    write.nodeAddLabel(nodeID,LABEL_ID);
    try (NodeValueIndexCursor cursor=seek(ktx)){
      assertTrue(cursor.next());
      assertThat(cursor.nodeReference(),equalTo(nodeID));
      assertFalse(cursor.next());
    }
   }
 }
