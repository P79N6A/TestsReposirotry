@Test public void doNotTruncateCheckpointsAfterLastTransaction() throws IOException {
  File file=logFiles.getLogFileForVersion(logVersion);
  LogPositionMarker marker=new LogPositionMarker();
  writeSomeData(file,pair -> {
    LogEntryWriter writer=pair.first();
    writer.writeStartEntry(1,1,1L,1L,ArrayUtils.EMPTY_BYTE_ARRAY);
    writer.writeCommitEntry(1L,2L);
    writer.writeCheckPointEntry(new LogPosition(logVersion,LogHeader.LOG_HEADER_SIZE));
    writer.writeCheckPointEntry(new LogPosition(logVersion,LogHeader.LOG_HEADER_SIZE));
    writer.writeCheckPointEntry(new LogPosition(logVersion,LogHeader.LOG_HEADER_SIZE));
    writer.writeCheckPointEntry(new LogPosition(logVersion,LogHeader.LOG_HEADER_SIZE));
    Consumer<LogPositionMarker> other=pair.other();
    other.accept(marker);
    return true;
  }
);
  assertTrue(recover(storeDir,logFiles));
  assertEquals(marker.getByteOffset(),file.length());
}
