@Test public void shouldTellTransactionIdStoreAfterSuccessfulRecovery() throws Exception {
  File file=logFiles.getLogFileForVersion(logVersion);
  final LogPositionMarker marker=new LogPositionMarker();
  final byte[] additionalHeaderData=new byte[0];
  final int masterId=0;
  final int authorId=1;
  final long transactionId=4;
  final long commitTimestamp=5;
  writeSomeData(file,pair -> {
    LogEntryWriter writer=pair.first();
    Consumer<LogPositionMarker> consumer=pair.other();
    writer.writeStartEntry(masterId,authorId,2L,3L,additionalHeaderData);
    writer.writeCommitEntry(transactionId,commitTimestamp);
    consumer.accept(marker);
    return true;
  }
);
  boolean recoveryRequired=recover(storeDir,logFiles);
  assertTrue(recoveryRequired);
  long[] lastClosedTransaction=transactionIdStore.getLastClosedTransaction();
  assertEquals(transactionId,lastClosedTransaction[0]);
  assertEquals(LogEntryStart.checksum(additionalHeaderData,masterId,authorId),transactionIdStore.getLastCommittedTransaction().checksum());
  assertEquals(commitTimestamp,transactionIdStore.getLastCommittedTransaction().commitTimestamp());
  assertEquals(logVersion,lastClosedTransaction[1]);
  assertEquals(marker.getByteOffset(),lastClosedTransaction[2]);
}
