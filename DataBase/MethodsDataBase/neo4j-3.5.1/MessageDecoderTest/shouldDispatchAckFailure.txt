@Test public void shouldDispatchAckFailure() throws Exception {
  BoltStateMachine stateMachine=mock(BoltStateMachine.class);
  SynchronousBoltConnection connection=new SynchronousBoltConnection(stateMachine);
  channel=new EmbeddedChannel(newDecoder(connection));
  channel.writeInbound(Unpooled.wrappedBuffer(serialize(packerUnderTest,AckFailureMessage.INSTANCE)));
  channel.finishAndReleaseAll();
  verify(stateMachine).process(eq(AckFailureMessage.INSTANCE),any());
}
