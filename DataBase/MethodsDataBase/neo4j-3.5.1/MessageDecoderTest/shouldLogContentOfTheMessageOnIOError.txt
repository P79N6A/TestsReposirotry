@Test public void shouldLogContentOfTheMessageOnIOError() throws Exception {
  BoltConnection connection=mock(BoltConnection.class);
  BoltResponseMessageWriter responseMessageHandler=mock(BoltResponseMessageWriter.class);
  BoltRequestMessageReader requestMessageReader=new BoltRequestMessageReaderV1(connection,responseMessageHandler,NullLogService.getInstance());
  LogService logService=mock(LogService.class);
  Log log=mock(Log.class);
  when(logService.getInternalLog(MessageDecoder.class)).thenReturn(log);
  channel=new EmbeddedChannel(new MessageDecoder(packerUnderTest::newUnpacker,requestMessageReader,logService));
  byte invalidMessageSignature=Byte.MAX_VALUE;
  byte[] messageBytes=packMessageWithSignature(invalidMessageSignature);
  try {
    channel.writeInbound(Unpooled.wrappedBuffer(messageBytes));
    fail("Exception expected");
  }
 catch (  Exception ignore) {
  }
  assertMessageHexDumpLogged(log,messageBytes);
}
