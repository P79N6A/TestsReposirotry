@Test public void shouldCallExternalErrorOnInitWithNullKeys() throws Exception {
  BoltStateMachine stateMachine=mock(BoltStateMachine.class);
  SynchronousBoltConnection connection=new SynchronousBoltConnection(stateMachine);
  channel=new EmbeddedChannel(newDecoder(connection));
  String userAgent="Test/User Agent 1.0";
  Map<String,Object> authToken=MapUtil.map("scheme","basic",null,"user","credentials","password");
  channel.writeInbound(Unpooled.wrappedBuffer(serialize(packerUnderTest,new InitMessage(userAgent,authToken))));
  channel.finishAndReleaseAll();
  verify(stateMachine).handleExternalFailure(eq(Neo4jError.from(Status.Request.Invalid,"Value `null` is not supported as key in maps, must be a non-nullable string.")),any());
}
