@Test public void logConstraintJobProgress() throws Exception {
  createNode(map(name,"irrelephant"),FIRST);
  AssertableLogProvider logProvider=new AssertableLogProvider();
  FlippableIndexProxy index=mock(FlippableIndexProxy.class);
  when(index.getState()).thenReturn(InternalIndexState.POPULATING);
  IndexPopulator populator=spy(indexPopulator(false));
  try {
    IndexPopulationJob job=newIndexPopulationJob(populator,index,indexStoreView,logProvider,EntityType.NODE,indexDescriptor(FIRST,name,true));
    job.run();
    LogMatcherBuilder match=inLog(IndexPopulationJob.class);
    logProvider.assertExactly(match.info("Index population started: [%s]",":FIRST(name)"),match.info("Index created. Starting data checks. Index [%s] is %s.",":FIRST(name)","POPULATING"));
  }
  finally {
    populator.close(true);
  }
}
