@Test void additionsDeliveredToIndexWriter() throws Exception {
  LuceneIndexWriter writer=mock(LuceneIndexWriter.class);
  NonUniqueLuceneIndexPopulatingUpdater updater=newUpdater(writer);
  String expectedString1=documentRepresentingProperties(1,"foo").toString();
  String expectedString2=documentRepresentingProperties(2,"bar").toString();
  String expectedString3=documentRepresentingProperties(3,"qux").toString();
  String expectedString4=documentRepresentingProperties(4,"git","bit").toString();
  updater.process(add(1,SCHEMA_DESCRIPTOR,"foo"));
  verifydocument(writer,newTermForChangeOrRemove(1),expectedString1);
  updater.process(add(2,SCHEMA_DESCRIPTOR,"bar"));
  verifydocument(writer,newTermForChangeOrRemove(2),expectedString2);
  updater.process(add(3,SCHEMA_DESCRIPTOR,"qux"));
  verifydocument(writer,newTermForChangeOrRemove(3),expectedString3);
  updater.process(add(4,COMPOSITE_SCHEMA_DESCRIPTOR,"git","bit"));
  verifydocument(writer,newTermForChangeOrRemove(4),expectedString4);
}
