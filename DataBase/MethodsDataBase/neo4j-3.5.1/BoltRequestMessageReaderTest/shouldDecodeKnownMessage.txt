@Test public void shouldDecodeKnownMessage() throws Exception {
  Unpacker unpacker=mock(Unpacker.class);
  when(unpacker.unpackStructSignature()).thenReturn('a');
  RequestMessage message=mock(RequestMessage.class);
  BoltResponseHandler responseHandler=responseHandlerMock();
  RequestMessageDecoder decoder=new TestRequestMessageDecoder('a',responseHandler,message);
  BoltStateMachine stateMachine=mock(BoltStateMachine.class);
  BoltConnection connection=new SynchronousBoltConnection(stateMachine);
  BoltRequestMessageReader reader=new TestBoltRequestMessageReader(connection,responseHandlerMock(),singletonList(decoder));
  reader.read(unpacker);
  verify(stateMachine).process(message,responseHandler);
}
