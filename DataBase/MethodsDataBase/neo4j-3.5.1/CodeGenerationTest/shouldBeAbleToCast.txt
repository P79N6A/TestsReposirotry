@Test public void shouldBeAbleToCast() throws Throwable {
  ClassHandle handle;
  try (ClassGenerator simple=generateClass(NamedBase.class,"SimpleClass")){
    simple.field(String.class,"foo");
    simple.generate(MethodTemplate.constructor(param(String.class,"name"),param(Object.class,"foo")).invokeSuper(new ExpressionTemplate[]{load("name",typeReference(String.class))},new TypeReference[]{typeReference(String.class)}).put(self(simple.handle()),String.class,"foo",cast(String.class,load("foo",typeReference(Object.class)))).build());
    handle=simple.handle();
  }
   Object instance=constructor(handle.loadClass(),String.class,Object.class).invoke("Pontus","Tobias");
  assertEquals("SimpleClass",instance.getClass().getSimpleName());
  assertThat(instance,instanceOf(NamedBase.class));
  assertEquals("Pontus",((NamedBase)instance).name);
  assertEquals("Tobias",getField(instance,"foo"));
}
