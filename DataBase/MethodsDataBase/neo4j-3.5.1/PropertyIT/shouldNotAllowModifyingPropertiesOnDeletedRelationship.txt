@Test public void shouldNotAllowModifyingPropertiesOnDeletedRelationship() throws Exception {
  Transaction transaction=newTransaction(AnonymousContext.writeToken());
  int prop1=transaction.tokenWrite().propertyKeyGetOrCreateForName("prop1");
  int type=transaction.tokenWrite().relationshipTypeGetOrCreateForName("RELATED");
  long startNodeId=transaction.dataWrite().nodeCreate();
  long endNodeId=transaction.dataWrite().nodeCreate();
  long rel=transaction.dataWrite().relationshipCreate(startNodeId,type,endNodeId);
  transaction.dataWrite().relationshipSetProperty(rel,prop1,Values.stringValue("As"));
  transaction.dataWrite().relationshipDelete(rel);
  try {
    transaction.dataWrite().relationshipRemoveProperty(rel,prop1);
    fail("Should have failed.");
  }
 catch (  EntityNotFoundException e) {
    assertThat(e.getMessage(),equalTo("Unable to load RELATIONSHIP with id " + rel + "."));
  }
  commit();
}
