@Test public void shouldValidateUniquenessIndexes() throws Exception {
  NeoStores store=mock(NeoStores.class);
  IndexingService indexes=mock(IndexingService.class);
  IntegrityValidator validator=new IntegrityValidator(store,indexes);
  UniquenessConstraintDescriptor constraint=ConstraintDescriptorFactory.uniqueForLabel(1,1);
  doThrow(new UniquePropertyValueValidationException(constraint,ConstraintValidationException.Phase.VERIFICATION,new RuntimeException())).when(indexes).validateIndex(2L);
  ConstraintRule record=ConstraintRule.constraintRule(1L,constraint,2L);
  try {
    validator.validateSchemaRule(record);
    fail("Should have thrown integrity error.");
  }
 catch (  Exception e) {
  }
}
