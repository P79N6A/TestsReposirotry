@Test public void shouldRecoverTransactionWherePropertyIsRemovedInTheFuture() throws Exception {
  createIndex(label,"key");
  Node node=createNodeWithProperty("key","value");
  checkPoint();
  addLabel(node,label);
  removeProperty(node,"key");
  flush.flush(db);
  crashAndRestart();
  try (Transaction tx=db.beginTx()){
    assertEquals("Updates not propagated correctly during recovery",Collections.<Node>emptyList(),Iterators.asList(db.findNodes(label,"key","value")));
    tx.success();
  }
 }
