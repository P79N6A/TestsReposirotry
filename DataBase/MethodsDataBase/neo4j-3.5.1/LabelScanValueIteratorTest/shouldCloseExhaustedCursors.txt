@Test public void shouldCloseExhaustedCursors() throws Exception {
  RawCursor<Hit<LabelScanKey,LabelScanValue>,IOException> cursor=mock(RawCursor.class);
  when(cursor.next()).thenReturn(false);
  Collection<RawCursor<Hit<LabelScanKey,LabelScanValue>,IOException>> toRemoveFrom=new HashSet<>();
  LabelScanValueIterator iterator=new LabelScanValueIterator(cursor,toRemoveFrom,NO_ID);
  verify(cursor,never()).close();
  exhaust(iterator);
  verify(cursor,times(1)).close();
  iterator.hasNext();
  verify(cursor,times(1)).close();
  assertTrue(toRemoveFrom.isEmpty());
}
