@Test public void shouldConsiderNodesChangedInSameTxInIndexSeek(){
  createNodes(db,LABEL,nonMatching[0]);
  LongSet toChangeToMatch=createNodes(db,LABEL,nonMatching[1]);
  LongSet toChangeToNotMatch=createNodes(db,LABEL,values);
  MutableLongSet expected=createNodes(db,LABEL,values);
  MutableLongSet found=new LongHashSet();
  try (Transaction tx=db.beginTx()){
    LongIterator toMatching=toChangeToMatch.longIterator();
    while (toMatching.hasNext()) {
      long id=toMatching.next();
      setProperties(id,values);
      expected.add(id);
    }
    LongIterator toNotMatching=toChangeToNotMatch.longIterator();
    while (toNotMatching.hasNext()) {
      long id=toNotMatching.next();
      setProperties(id,nonMatching[2]);
      expected.remove(id);
    }
    collectNodes(found,indexSeek.findNodes(keys,values,db));
  }
   assertThat(found,equalTo(expected));
}
