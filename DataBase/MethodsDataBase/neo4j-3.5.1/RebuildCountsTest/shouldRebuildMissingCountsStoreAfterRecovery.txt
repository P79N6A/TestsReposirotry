@Test public void shouldRebuildMissingCountsStoreAfterRecovery() throws IOException, TransactionFailureException {
  createAliensAndHumans();
  rotateLog();
  deleteHumans();
  FileSystemAbstraction fs=crash();
  deleteCounts(fs);
  restart(fs);
  try (org.neo4j.internal.kernel.api.Transaction tx=((GraphDatabaseAPI)db).getDependencyResolver().resolveDependency(Kernel.class).beginTransaction(explicit,AUTH_DISABLED)){
    assertEquals(ALIENS,tx.dataRead().countsForNode(-1));
    assertEquals(ALIENS,tx.dataRead().countsForNode(labelId(ALIEN)));
    assertEquals(0,tx.dataRead().countsForNode(labelId(HUMAN)));
  }
   LogMatcherBuilder matcherBuilder=inLog(MetaDataStore.class);
  internalLogProvider.assertAtLeastOnce(matcherBuilder.warn("Missing counts store, rebuilding it."));
  internalLogProvider.assertAtLeastOnce(matcherBuilder.warn("Counts store rebuild completed."));
}
