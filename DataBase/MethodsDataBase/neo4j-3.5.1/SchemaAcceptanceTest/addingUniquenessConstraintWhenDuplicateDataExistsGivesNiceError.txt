@Test public void addingUniquenessConstraintWhenDuplicateDataExistsGivesNiceError(){
  try (Transaction transaction=db.beginTx()){
    db.createNode(label).setProperty(propertyKey,"value1");
    db.createNode(label).setProperty(propertyKey,"value1");
    transaction.success();
  }
   try {
    createUniquenessConstraint(label,propertyKey);
    fail("Expected exception to be thrown");
  }
 catch (  ConstraintViolationException e) {
    assertThat(e.getMessage(),containsString("Unable to create CONSTRAINT ON ( my_label:MY_LABEL ) ASSERT my_label.my_property_key IS UNIQUE"));
  }
}
