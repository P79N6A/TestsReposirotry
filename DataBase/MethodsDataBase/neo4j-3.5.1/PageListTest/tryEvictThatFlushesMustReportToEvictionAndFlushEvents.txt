@Test public void tryEvictThatFlushesMustReportToEvictionAndFlushEvents() throws Exception {
  pageList.unlockExclusive(pageRef);
  int filePageSize=313;
  PageSwapper swapper=new DummyPageSwapper("a",filePageSize);
  int swapperId=swappers.allocate(swapper);
  doFault(swapperId,42);
  pageList.unlockExclusiveAndTakeWriteLock(pageRef);
  pageList.unlockWrite(pageRef);
  assertTrue(pageList.isModified(pageRef));
  EvictionAndFlushRecorder recorder=new EvictionAndFlushRecorder();
  assertTrue(pageList.tryEvict(pageRef,() -> recorder));
  assertThat(recorder.evictionClosed,is(true));
  assertThat(recorder.filePageId,is(42L));
  assertThat(recorder.swapper,sameInstance(swapper));
  assertThat(recorder.evictionException,is(nullValue()));
  assertThat(recorder.cachePageId,is(pageRef));
  assertThat(recorder.bytesWritten,is((long)filePageSize));
  assertThat(recorder.flushDone,is(true));
  assertThat(recorder.flushException,is(nullValue()));
  assertThat(recorder.pagesFlushed,is(1));
}
