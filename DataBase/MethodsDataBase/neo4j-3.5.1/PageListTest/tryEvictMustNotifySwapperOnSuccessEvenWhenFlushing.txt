@Test public void tryEvictMustNotifySwapperOnSuccessEvenWhenFlushing() throws Exception {
  pageList.unlockExclusive(pageRef);
  AtomicBoolean evictionNotified=new AtomicBoolean();
  PageSwapper swapper=new DummyPageSwapper("a",313){
    @Override public void evicted(    long filePageId){
      evictionNotified.set(true);
      assertThat(filePageId,is(42L));
    }
  }
;
  int swapperId=swappers.allocate(swapper);
  doFault(swapperId,42);
  pageList.unlockExclusiveAndTakeWriteLock(pageRef);
  pageList.unlockWrite(pageRef);
  assertTrue(pageList.isModified(pageRef));
  assertTrue(pageList.tryEvict(pageRef,EvictionRunEvent.NULL));
  assertTrue(evictionNotified.get());
  assertFalse(pageList.isModified(pageRef));
}
