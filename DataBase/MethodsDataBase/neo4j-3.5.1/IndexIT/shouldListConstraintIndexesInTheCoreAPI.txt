@Test public void shouldListConstraintIndexesInTheCoreAPI() throws Exception {
  Transaction transaction=newTransaction(AUTH_DISABLED);
  transaction.schemaWrite().uniquePropertyConstraintCreate(SchemaDescriptorFactory.forLabel(transaction.tokenWrite().labelGetOrCreateForName("Label1"),transaction.tokenWrite().propertyKeyGetOrCreateForName("property1")));
  commit();
  try (org.neo4j.graphdb.Transaction ignore=db.beginTx()){
    Set<IndexDefinition> indexes=Iterables.asSet(db.schema().getIndexes());
    assertEquals(1,indexes.size());
    IndexDefinition index=indexes.iterator().next();
    assertEquals("Label1",single(index.getLabels()).name());
    assertEquals(asSet("property1"),Iterables.asSet(index.getPropertyKeys()));
    assertTrue("index should be a constraint index",index.isConstraintIndex());
    try {
      index.drop();
      fail("expected exception");
    }
 catch (    IllegalStateException e) {
      assertEquals("Constraint indexes cannot be dropped directly, " + "instead drop the owning uniqueness constraint.",e.getMessage());
    }
  }
 }
