@Test public void queryIndexWithSortByStringAfterSamePropertyUpdate(){
  Index<Node> index=nodeIndex(stringMap());
  commitTx();
  String nameProperty="NODE_NAME";
  Label heroes=Label.label("heroes");
  String[] names=new String[]{"Fry","Leela","Bender","Amy","Hubert","Calculon"};
  try (Transaction transaction=graphDb.beginTx()){
    for (    String name : names) {
      Node node=graphDb.createNode(heroes);
      node.setProperty(nameProperty,name);
      index.add(node,nameProperty,name);
    }
    transaction.success();
  }
   try (Transaction transaction=graphDb.beginTx()){
    ResourceIterator<Node> nodes=graphDb.findNodes(heroes);
    nodes.stream().forEach(node -> {
      node.setProperty(nameProperty,"junior " + node.getProperty(nameProperty));
      index.remove(node,nameProperty);
      index.add(node,nameProperty,node.getProperty(nameProperty));
    }
);
    transaction.success();
  }
   String[] sortedNames=new String[]{"junior Leela","junior Hubert","junior Fry","junior Calculon","junior Bender","junior Amy"};
  queryAndSortNodesByStringProperty(index,nameProperty,sortedNames);
}
