@Test public void shouldReportNodesThatAreNotIndexed() throws Exception {
  IndexSamplingConfig samplingConfig=new IndexSamplingConfig(Config.defaults());
  Iterator<StoreIndexDescriptor> indexDescriptorIterator=new SchemaStorage(fixture.directStoreAccess().nativeStores().getSchemaStore()).indexesGetAll();
  NeoStoreIndexStoreView storeView=new NeoStoreIndexStoreView(LockService.NO_LOCK_SERVICE,fixture.directStoreAccess().nativeStores().getRawNeoStores());
  while (indexDescriptorIterator.hasNext()) {
    StoreIndexDescriptor indexDescriptor=indexDescriptorIterator.next();
    IndexAccessor accessor=fixture.directStoreAccess().indexes().lookup(indexDescriptor.providerDescriptor()).getOnlineAccessor(indexDescriptor,samplingConfig);
    try (IndexUpdater updater=accessor.newUpdater(IndexUpdateMode.ONLINE)){
      for (      long nodeId : indexedNodes) {
        EntityUpdates updates=storeView.nodeAsUpdates(nodeId);
        for (        IndexEntryUpdate<?> update : updates.forIndexKeys(asList(indexDescriptor))) {
          updater.process(IndexEntryUpdate.remove(nodeId,indexDescriptor,update.values()));
        }
      }
    }
     accessor.force(IOLimiter.UNLIMITED);
    accessor.close();
  }
  ConsistencySummaryStatistics stats=check();
  on(stats).verify(RecordType.NODE,3).andThatsAllFolks();
}
