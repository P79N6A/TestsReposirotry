@Test public void shouldScanRelationshipInTransaction() throws Exception {
  final int nRelationshipsInStore=10;
  int type;
  long n1, n2;
  try (Transaction tx=beginTransaction()){
    n1=tx.dataWrite().nodeCreate();
    n2=tx.dataWrite().nodeCreate();
    type=tx.tokenWrite().relationshipTypeGetOrCreateForName("R");
    relateNTimes(nRelationshipsInStore,type,n1,n2,tx);
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    long r=tx.dataWrite().relationshipCreate(n1,type,n2);
    try (RelationshipScanCursor relationship=tx.cursors().allocateRelationshipScanCursor()){
      tx.dataRead().allRelationshipsScan(relationship);
      assertCountRelationships(relationship,nRelationshipsInStore + 1,n1,type,n2);
    }
     tx.success();
  }
 }
