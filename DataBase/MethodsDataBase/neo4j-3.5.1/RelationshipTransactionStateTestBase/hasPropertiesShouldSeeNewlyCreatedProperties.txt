@Test public void hasPropertiesShouldSeeNewlyCreatedProperties() throws Exception {
  long relationship;
  try (Transaction tx=beginTransaction()){
    Write write=tx.dataWrite();
    int token=tx.tokenWrite().relationshipTypeGetOrCreateForName("R");
    relationship=write.relationshipCreate(write.nodeCreate(),token,write.nodeCreate());
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    try (RelationshipScanCursor cursor=tx.cursors().allocateRelationshipScanCursor()){
      tx.dataRead().singleRelationship(relationship,cursor);
      assertTrue(cursor.next());
      assertFalse(hasProperties(cursor,tx));
      tx.dataWrite().relationshipSetProperty(relationship,tx.tokenWrite().propertyKeyGetOrCreateForName("prop"),stringValue("foo"));
      assertTrue(hasProperties(cursor,tx));
    }
   }
 }
