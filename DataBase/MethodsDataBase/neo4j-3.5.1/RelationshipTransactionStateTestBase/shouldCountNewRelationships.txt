@Test public void shouldCountNewRelationships() throws Exception {
  int relationship;
  try (Transaction tx=beginTransaction()){
    Write write=tx.dataWrite();
    relationship=tx.tokenWrite().relationshipTypeGetOrCreateForName("R");
    write.relationshipCreate(write.nodeCreate(),relationship,write.nodeCreate());
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    Write write=tx.dataWrite();
    write.relationshipCreate(write.nodeCreate(),relationship,write.nodeCreate());
    long countsTxState=tx.dataRead().countsForRelationship(-1,relationship,-1);
    long countsNoTxState=tx.dataRead().countsForRelationshipWithoutTxState(-1,relationship,-1);
    assertEquals(2,countsTxState);
    assertEquals(1,countsNoTxState);
  }
 }
