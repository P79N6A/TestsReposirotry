@Test public void groupCursorShouldNewRelationshipBetweenAlreadyConnectedSparseNodes() throws Exception {
  long start;
  long end;
  long existingRelationship;
  int type;
  try (Transaction tx=beginTransaction()){
    Write write=tx.dataWrite();
    start=write.nodeCreate();
    end=write.nodeCreate();
    type=tx.tokenWrite().relationshipTypeGetOrCreateForName("R");
    existingRelationship=write.relationshipCreate(start,type,end);
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    Write write=tx.dataWrite();
    long newRelationship=write.relationshipCreate(start,type,write.nodeCreate());
    try (NodeCursor node=tx.cursors().allocateNodeCursor();RelationshipTraversalCursor traversal=tx.cursors().allocateRelationshipTraversalCursor();RelationshipGroupCursor group=tx.cursors().allocateRelationshipGroupCursor()){
      Read read=tx.dataRead();
      read.singleNode(start,node);
      assertTrue(node.next());
      assertFalse(node.isDense());
      node.relationships(group);
      assertTrue(group.next());
      assertEquals(type,group.type());
      assertEquals(2,group.outgoingCount());
      assertEquals(0,group.incomingCount());
      assertEquals(0,group.loopCount());
      assertRelationships(OUT,group,traversal,newRelationship,existingRelationship);
      assertFalse(group.next());
    }
   }
 }
