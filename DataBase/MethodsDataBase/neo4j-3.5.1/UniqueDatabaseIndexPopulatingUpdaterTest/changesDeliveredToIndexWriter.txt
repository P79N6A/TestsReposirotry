@Test void changesDeliveredToIndexWriter() throws Exception {
  LuceneIndexWriter writer=mock(LuceneIndexWriter.class);
  UniqueLuceneIndexPopulatingUpdater updater=newUpdater(writer);
  updater.process(change(1,descriptor,"before1","after1"));
  updater.process(change(2,descriptor,"before2","after2"));
  verify(writer).updateDocument(newTermForChangeOrRemove(1),documentRepresentingProperties((long)1,"after1"));
  verify(writer).updateDocument(newTermForChangeOrRemove(2),documentRepresentingProperties((long)2,"after2"));
}
