@Test public void shouldCalculateCorrectEstimatesOnEmptyData() throws Exception {
  Groups groups=new Groups();
  Collection<DataFactory> nodeData=asList(generateData(defaultFormatNodeFileHeader(),new MutableLong(),0,0,":ID","nodes-1.csv",groups));
  Collection<DataFactory> relationshipData=asList(generateData(defaultFormatRelationshipFileHeader(),new MutableLong(),0,0,":START_ID,:TYPE,:END_ID","rels-1.csv",groups));
  Input input=new CsvInput(nodeData,defaultFormatNodeFileHeader(),relationshipData,defaultFormatRelationshipFileHeader(),IdType.INTEGER,COMMAS,Collector.EMPTY,groups);
  Input.Estimates estimates=input.calculateEstimates(new PropertyValueRecordSizeCalculator(LATEST_RECORD_FORMATS.property().getRecordSize(NO_STORE_HEADER),parseInt(GraphDatabaseSettings.string_block_size.getDefaultValue()),0,parseInt(GraphDatabaseSettings.array_block_size.getDefaultValue()),0));
  assertEquals(0,estimates.numberOfNodes());
  assertEquals(0,estimates.numberOfRelationships());
  assertEquals(0,estimates.numberOfRelationshipProperties());
  assertEquals(0,estimates.numberOfNodeProperties());
  assertEquals(0,estimates.numberOfNodeLabels());
}
