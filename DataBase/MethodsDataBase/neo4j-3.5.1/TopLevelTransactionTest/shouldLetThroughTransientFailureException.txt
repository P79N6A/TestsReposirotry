@Test public void shouldLetThroughTransientFailureException() throws Exception {
  KernelTransaction kernelTransaction=mock(KernelTransaction.class);
  when(kernelTransaction.isOpen()).thenReturn(true);
  doThrow(new TransientDatabaseFailureException("Just a random failure")).when(kernelTransaction).close();
  TopLevelTransaction transaction=new TopLevelTransaction(kernelTransaction);
  transaction.success();
  try {
    transaction.close();
    fail("Should have failed");
  }
 catch (  TransientFailureException e) {
  }
}
