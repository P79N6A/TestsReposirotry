@Test public void shouldInvokeHandleSchedulingErrorIfNoThreadsAvailable() throws Throwable {
  AtomicInteger handleSchedulingErrorCounter=new AtomicInteger(0);
  BoltConnection newConnection=newConnection(UUID.randomUUID().toString());
  doAnswer(newCountingAnswer(handleSchedulingErrorCounter)).when(newConnection).handleSchedulingError(any());
  blockAllThreads();
  boltScheduler.created(newConnection);
  CompletableFuture.runAsync(() -> boltScheduler.enqueued(newConnection,Jobs.noop()));
  Predicates.awaitForever(() -> handleSchedulingErrorCounter.get() > 0,500,MILLISECONDS);
  assertEquals(1,handleSchedulingErrorCounter.get());
  afterExecuteEvent.countDown();
  afterExecuteBarrier.await();
}
