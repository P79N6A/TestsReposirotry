@Test public void shouldFailNicelyWhenUnsafeAPISafeMode() throws Throwable {
  List<CallableProcedure> procList=compiler.compileProcedure(ProcedureWithUnsafeAPI.class,null,false);
  verify(log).warn(notAvailableMessage("org.neo4j.kernel.impl.proc.listCoolPeople"));
  assertThat(procList.size(),equalTo(1));
  try {
    procList.get(0).apply(new BasicContext(),new Object[0],resourceTracker);
    fail();
  }
 catch (  ProcedureException e) {
    assertThat(e.getMessage(),notAvailableMessageMatcher("org.neo4j.kernel.impl.proc.listCoolPeople"));
  }
}
