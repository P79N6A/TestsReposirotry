@Test public void shouldFailNicelyWhenUnsafeAPISafeModeFunction() throws Throwable {
  List<CallableUserFunction> procList=compiler.compileFunction(FunctionWithUnsafeAPI.class);
  verify(log).warn(notAvailableMessage("org.neo4j.kernel.impl.proc.listCoolPeople"));
  assertThat(procList.size(),equalTo(1));
  try {
    procList.get(0).apply(new BasicContext(),new AnyValue[0]);
    fail();
  }
 catch (  ProcedureException e) {
    assertThat(e.getMessage(),notAvailableMessageMatcher("org.neo4j.kernel.impl.proc.listCoolPeople"));
  }
}
