@Test public void reportNotUsedRelationshipReferencedInChain() throws Exception {
  prepareDbWithDeletedRelationshipPartOfTheChain();
  Date timestamp=new Date();
  ConsistencyCheckService service=new ConsistencyCheckService(timestamp);
  Config configuration=Config.defaults(settings());
  ConsistencyCheckService.Result result=runFullConsistencyCheck(service,configuration);
  assertFalse(result.isSuccessful());
  File reportFile=result.reportFile();
  assertTrue("Consistency check report file should be generated.",reportFile.exists());
  assertThat("Expected to see report about not deleted relationship record present as part of a chain",Files.readAllLines(reportFile.toPath()).toString(),containsString("The relationship record is not in use, but referenced from relationships chain."));
}
