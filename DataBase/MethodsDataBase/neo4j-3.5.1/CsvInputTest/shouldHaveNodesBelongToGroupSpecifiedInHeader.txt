@Test public void shouldHaveNodesBelongToGroupSpecifiedInHeader() throws Exception {
  IdType idType=IdType.INTEGER;
  Iterable<DataFactory> data=dataIterable(data("123,one\n" + "456,two"));
  Groups groups=new Groups();
  Group group=groups.getOrCreate("MyGroup");
  Input input=new CsvInput(data,header(entry(null,Type.ID,group.name(),idType.extractor(extractors)),entry("name",Type.PROPERTY,extractors.string())),datas(),defaultFormatRelationshipFileHeader(),idType,config(COMMAS),silentBadCollector(0));
  try (InputIterator nodes=input.nodes().iterator()){
    assertNextNode(nodes,group,123L,properties("name","one"),labels());
    assertNextNode(nodes,group,456L,properties("name","two"),labels());
    assertFalse(readNext(nodes));
  }
 }
