@Test public void shouldHaveRelationshipsSpecifyStartEndNodeIdGroupsInHeader() throws Exception {
  IdType idType=IdType.INTEGER;
  Iterable<DataFactory> data=dataIterable(data("123,TYPE,234\n" + "345,TYPE,456"));
  Groups groups=new Groups();
  Group startNodeGroup=groups.getOrCreate("StartGroup");
  Group endNodeGroup=groups.getOrCreate("EndGroup");
  Iterable<DataFactory> nodeHeader=dataIterable(data(":ID(" + startNodeGroup.name() + ")"),data(":ID(" + endNodeGroup.name() + ")"));
  Input input=new CsvInput(nodeHeader,defaultFormatNodeFileHeader(),data,header(entry(null,Type.START_ID,startNodeGroup.name(),idType.extractor(extractors)),entry(null,Type.TYPE,extractors.string()),entry(null,Type.END_ID,endNodeGroup.name(),idType.extractor(extractors))),idType,config(COMMAS),silentBadCollector(0));
  try (InputIterator relationships=input.relationships().iterator()){
    assertRelationship(relationships,startNodeGroup,123L,endNodeGroup,234L,"TYPE",properties());
    assertRelationship(relationships,startNodeGroup,345L,endNodeGroup,456L,"TYPE",properties());
    assertFalse(readNext(relationships));
  }
 }
