@Test public void shouldComputeDegreeWithoutType() throws Exception {
  long node;
  try (Transaction tx=transaction()){
    Write write=tx.dataWrite();
    node=write.nodeCreate();
    write.relationshipCreate(node,tx.tokenWrite().relationshipTypeGetOrCreateForName("R1"),write.nodeCreate());
    write.relationshipCreate(node,tx.tokenWrite().relationshipTypeGetOrCreateForName("R2"),write.nodeCreate());
    write.relationshipCreate(write.nodeCreate(),tx.tokenWrite().relationshipTypeGetOrCreateForName("R3"),node);
    write.relationshipCreate(node,tx.tokenWrite().relationshipTypeGetOrCreateForName("R4"),node);
    tx.success();
  }
   try (Transaction tx=transaction()){
    Read read=tx.dataRead();
    CursorFactory cursors=tx.cursors();
    try (NodeCursor nodes=cursors.allocateNodeCursor()){
      assertThat(CompiledExpandUtils.nodeGetDegreeIfDense(read,node,nodes,cursors,OUTGOING),equalTo(3));
      assertThat(CompiledExpandUtils.nodeGetDegreeIfDense(read,node,nodes,cursors,INCOMING),equalTo(2));
      assertThat(CompiledExpandUtils.nodeGetDegreeIfDense(read,node,nodes,cursors,BOTH),equalTo(4));
    }
   }
 }
