@Test public void shouldUseConfiguredCertificate() throws Exception {
  SecureSocketConnection connection=new SecureSocketConnection();
  try {
    connection.connect(server.lookupConnector(DEFAULT_CONNECTOR_KEY)).send(util.acceptedVersions(1,0,0,0));
    Set<X509Certificate> certificatesSeen=connection.getServerCertificatesSeen();
    assertThat(certificatesSeen,contains(loadCertificateFromDisk()));
  }
  finally {
    connection.disconnect();
  }
}
