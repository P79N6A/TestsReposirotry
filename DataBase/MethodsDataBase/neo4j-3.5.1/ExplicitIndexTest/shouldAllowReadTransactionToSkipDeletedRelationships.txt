@Test public void shouldAllowReadTransactionToSkipDeletedRelationships(){
  String indexName="index";
  Index<Relationship> relationshipIndex;
  Relationship relationship;
  String key="key";
  String value="value";
  try (Transaction tx=db.beginTx()){
    relationshipIndex=db.index().forRelationships(indexName);
    relationship=db.createNode().createRelationshipTo(db.createNode(),MyRelTypes.TEST);
    relationshipIndex.add(relationship,key,value);
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    relationship.delete();
    tx.success();
  }
   try (Transaction tx=db.beginTransaction(explicit,new SecurityContext(ANONYMOUS,READ))){
    IndexHits<Relationship> hits=relationshipIndex.get(key,value);
    assertNull(hits.getSingle());
  }
 }
