@Test public void relationshipIndexShouldBeAbleToReindexInSameTransaction(){
  Node startNode;
  Node endNode;
  Relationship relationship;
  RelationshipIndex index;
  try (Transaction tx=db.beginTx()){
    startNode=db.createNode();
    endNode=db.createNode();
    relationship=startNode.createRelationshipTo(endNode,TYPE);
    index=db.index().forRelationships(TYPE.name());
    index.add(relationship,"key",new ValueContext(1).indexNumeric());
    tx.success();
  }
   assertTrue("Find relationship by property",relationshipExistsByQuery(index,startNode,endNode,false));
  assertTrue("Find relationship by property and start node",relationshipExistsByQuery(index,startNode,endNode,true));
  try (Transaction tx=db.beginTx()){
    index.remove(relationship);
    index.add(relationship,"key",new ValueContext(2).indexNumeric());
    tx.success();
  }
   assertTrue("Find relationship by property",relationshipExistsByQuery(index,startNode,endNode,false));
  assertTrue("Find relationship by property and start node",relationshipExistsByQuery(index,startNode,endNode,true));
}
