@Test public void shouldFailNicelyOnNullKeysInMap() throws Throwable {
  HashMap<String,Object> params=new HashMap<>();
  HashMap<String,Object> inner=new HashMap<>();
  inner.put(null,42L);
  inner.put("foo",1337L);
  params.put("p",inner);
  negotiateBoltV3();
  connection.send(util.chunk(new RunMessage("RETURN {p}",asMapValue(params)),PullAllMessage.INSTANCE));
  assertThat(connection,util.eventuallyReceives(msgFailure(Status.Request.Invalid,"Value `null` is not supported as key in maps, must be a non-nullable string."),msgIgnored()));
  connection.send(util.chunk(ResetMessage.INSTANCE,new RunMessage("RETURN 1"),PullAllMessage.INSTANCE));
  assertThat(connection,util.eventuallyReceives(msgSuccess(),msgSuccess(),msgRecord(eqRecord(equalTo(longValue(1L)))),msgSuccess()));
}
