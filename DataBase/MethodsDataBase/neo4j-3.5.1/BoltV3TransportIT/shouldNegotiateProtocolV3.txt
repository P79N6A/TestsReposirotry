@Test public void shouldNegotiateProtocolV3() throws Exception {
  connection.connect(address).send(util.acceptedVersions(3,0,0,0)).send(util.chunk(new HelloMessage(map("user_agent",USER_AGENT))));
  assertThat(connection,eventuallyReceives(new byte[]{0,0,0,3}));
  assertThat(connection,util.eventuallyReceives(msgSuccess(allOf(hasKey("server"),hasKey("connection_id")))));
}
