@Test public void shouldSendFailureMessageForBeginWithInvalidTransactionMetadata() throws Exception {
  negotiateBoltV3();
  String txMetadata="Tx metadata can't be a string for BEGIN";
  Map<String,Object> metadata=map("tx_metadata",txMetadata);
  connection.send(util.chunk(32,beginMessage(metadata)));
  assertThat(connection,util.eventuallyReceives(msgFailure(Status.Request.Invalid,txMetadata)));
}
