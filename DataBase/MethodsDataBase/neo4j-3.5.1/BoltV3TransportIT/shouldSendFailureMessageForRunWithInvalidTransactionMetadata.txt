@Test public void shouldSendFailureMessageForRunWithInvalidTransactionMetadata() throws Exception {
  negotiateBoltV3();
  String txMetadata="Tx metadata can't be a string for RUN";
  Map<String,Object> metadata=map("tx_metadata",txMetadata);
  connection.send(util.chunk(32,runMessage(metadata)));
  assertThat(connection,util.eventuallyReceives(msgFailure(Status.Request.Invalid,txMetadata)));
}
