@Test public void scanStoreMustLogCrashPointerCleanupDuringRecovery() throws Exception {
  dirtyDatabase();
  AssertableLogProvider logProvider=new AssertableLogProvider(true);
  factory.setUserLogProvider(logProvider);
  factory.setInternalLogProvider(logProvider);
  startDatabase().shutdown();
  logProvider.assertContainsLogCallContaining("Label index cleanup job registered");
  logProvider.assertContainsLogCallContaining("Label index cleanup job started");
  logProvider.assertContainsMessageMatching(Matchers.stringContainsInOrder(Iterables.asIterable("Label index cleanup job finished","Number of pages visited","Number of cleaned crashed pointers","Time spent")));
  logProvider.assertContainsLogCallContaining("Label index cleanup job closed");
}
