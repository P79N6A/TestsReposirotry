@Test void truncatedFilesMustBeEmpty() throws Exception {
  File file=file("file");
  PageSwapperFactory factory=createSwapperFactory();
  PageSwapper swapper=createSwapperAndFile(factory,file);
  assertThat(swapper.getLastPageId(),is(-1L));
  long page=createPage();
  putInt(page,0,0xcafebabe);
  write(swapper,10,page);
  clear(page);
  read(swapper,10,sizeOfAsInt(page),page);
  assertThat(getInt(page,0),is(0xcafebabe));
  assertThat(swapper.getLastPageId(),is(10L));
  swapper.close();
  swapper=createSwapper(factory,file,cachePageSize(),NO_CALLBACK,false,false);
  clear(page);
  read(swapper,10,sizeOfAsInt(page),page);
  assertThat(getInt(page,0),is(0xcafebabe));
  assertThat(swapper.getLastPageId(),is(10L));
  swapper.truncate();
  clear(page);
  read(swapper,10,sizeOfAsInt(page),page);
  assertThat(getInt(page,0),is(0));
  assertThat(swapper.getLastPageId(),is(-1L));
  swapper.close();
  swapper=createSwapper(factory,file,cachePageSize(),NO_CALLBACK,false,false);
  clear(page);
  read(swapper,10,sizeOfAsInt(page),page);
  assertThat(getInt(page,0),is(0));
  assertThat(swapper.getLastPageId(),is(-1L));
  swapper.close();
}
