@Test public void shouldHoldSharedIndexLockIfNodeIsConcurrentlyCreated() throws Exception {
  NodeValueIndexCursor cursor=mock(NodeValueIndexCursor.class);
  when(cursor.next()).thenReturn(false,true);
  when(cursor.nodeReference()).thenReturn(42L);
  long nodeId=LockingNodeUniqueIndexSeek.apply(locks,LockTracer.NONE,() -> cursor,uniqueNodeIndexSeeker,index,predicate);
  assertEquals(42L,nodeId);
  order.verify(locks).acquireShared(LockTracer.NONE,INDEX_ENTRY,resourceId);
  order.verify(locks).releaseShared(INDEX_ENTRY,resourceId);
  order.verify(locks).acquireExclusive(LockTracer.NONE,INDEX_ENTRY,resourceId);
  order.verify(locks).acquireShared(LockTracer.NONE,INDEX_ENTRY,resourceId);
  order.verify(locks).releaseExclusive(INDEX_ENTRY,resourceId);
  verifyNoMoreInteractions(locks);
  verify(cursor).close();
}
