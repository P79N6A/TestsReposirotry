@Test public void shouldArchiveFailedIndex() throws Exception {
  db.withSetting(GraphDatabaseSettings.archive_failed_index,"true");
  try (Transaction tx=db.beginTx()){
    Node node=db.createNode(PERSON);
    node.setProperty("name","Fry");
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    Node node=db.createNode(PERSON);
    node.setProperty("name",Values.pointValue(CoordinateReferenceSystem.WGS84,1,2));
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    db.schema().constraintFor(PERSON).assertPropertyIsUnique("name").create();
    tx.success();
  }
   assertThat(archiveFile(),nullValue());
  db.restartDatabase(new SabotageNativeIndex(random.random()));
  indexStateShouldBe(equalTo(ONLINE));
  assertThat(archiveFile(),notNullValue());
}
