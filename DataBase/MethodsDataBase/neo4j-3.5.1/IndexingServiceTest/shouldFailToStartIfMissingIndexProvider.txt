@Test public void shouldFailToStartIfMissingIndexProvider() throws Exception {
  String otherProviderKey="something-completely-different";
  IndexProviderDescriptor otherDescriptor=new IndexProviderDescriptor(otherProviderKey,"no-version");
  StoreIndexDescriptor rule=storeIndex(1,2,3,otherDescriptor);
  newIndexingServiceWithMockedDependencies(mock(IndexPopulator.class),mock(IndexAccessor.class),new DataUpdates(),rule);
  try {
    life.init();
    fail("initIndexes with mismatching index provider should fail");
  }
 catch (  LifecycleException e) {
    assertThat(e.getCause().getMessage(),containsString(PROVIDER_DESCRIPTOR.name()));
    assertThat(e.getCause().getMessage(),containsString(otherProviderKey));
  }
}
