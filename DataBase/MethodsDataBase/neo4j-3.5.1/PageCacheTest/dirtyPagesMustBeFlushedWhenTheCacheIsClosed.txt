@Test void dirtyPagesMustBeFlushedWhenTheCacheIsClosed(){
  assertTimeout(ofMillis(SHORT_TIMEOUT_MILLIS),() -> {
    configureStandardPageCache();
    long startPageId=0;
    long endPageId=recordCount / recordsPerFilePage;
    File file=file("a");
    try (PagedFile pagedFile=map(file,filePageSize);PageCursor cursor=pagedFile.io(startPageId,PF_SHARED_WRITE_LOCK)){
      while (cursor.getCurrentPageId() < endPageId && cursor.next()) {
        writeRecords(cursor);
      }
    }
  finally {
      pageCache.close();
    }
    verifyRecordsInFile(file,recordCount);
  }
);
}
