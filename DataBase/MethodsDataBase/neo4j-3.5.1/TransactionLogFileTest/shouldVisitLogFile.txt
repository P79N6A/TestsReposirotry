@Test public void shouldVisitLogFile() throws Exception {
  String name="log";
  FileSystemAbstraction fs=fileSystemRule.get();
  LogFiles logFiles=LogFilesBuilder.builder(directory.databaseLayout(),fs).withTransactionIdStore(transactionIdStore).withLogVersionRepository(logVersionRepository).build();
  life.start();
  life.add(logFiles);
  LogFile logFile=logFiles.getLogFile();
  FlushablePositionAwareChannel writer=logFile.getWriter();
  LogPositionMarker mark=new LogPositionMarker();
  writer.getCurrentPosition(mark);
  for (int i=0; i < 5; i++) {
    writer.put((byte)i);
  }
  writer.prepareForFlush();
  final AtomicBoolean called=new AtomicBoolean();
  logFile.accept(channel -> {
    for (int i=0; i < 5; i++) {
      assertEquals((byte)i,channel.get());
    }
    called.set(true);
    return true;
  }
,mark.newPosition());
  assertTrue(called.get());
}
