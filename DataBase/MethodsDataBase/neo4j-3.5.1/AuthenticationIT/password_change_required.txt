@Test @Documented("Required password changes\n" + "\n" + "In some cases, like the very first time Neo4j is accessed, the user will be required to choose\n"+ "a new password. The database will signal that a new password is required and deny access.\n"+ "\n"+ "See <<rest-api-security-user-status-and-password-changing>> for how to set a new password.") public void password_change_required() throws JsonParseException, IOException {
  startServer(true);
  RESTRequestGenerator.ResponseEntity response=gen.get().expectedStatus(403).withHeader(HttpHeaders.AUTHORIZATION,HTTP.basicAuthHeader("neo4j","neo4j")).get(dataURL());
  JsonNode data=JsonHelper.jsonNode(response.entity());
  JsonNode firstError=data.get("errors").get(0);
  assertThat(firstError.get("code").asText(),equalTo("Neo.ClientError.Security.Forbidden"));
  assertThat(firstError.get("message").asText(),equalTo("User is required to change their password."));
  assertThat(data.get("password_change").asText(),equalTo(passwordURL("neo4j")));
}
