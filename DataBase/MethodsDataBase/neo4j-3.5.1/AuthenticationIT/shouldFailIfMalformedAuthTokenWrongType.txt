@Test public void shouldFailIfMalformedAuthTokenWrongType() throws Throwable {
  connection.connect(address).send(util.defaultAcceptedVersions()).send(util.chunk(new InitMessage("TestClient/1.1",map("principal",singletonList("neo4j"),"credentials","neo4j","scheme","basic"))));
  assertThat(connection,util.eventuallyReceivesSelectedProtocolVersion());
  assertThat(connection,util.eventuallyReceives(msgFailure(Status.Security.Unauthorized,"Unsupported authentication token, the value associated with the key `principal` " + "must be a String but was: ArrayList")));
  assertThat(connection,eventuallyDisconnects());
}
