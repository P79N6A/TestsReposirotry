@Test public void successfulJobsShouldTriggerSchedulingOfPendingJobs() throws Throwable {
  AtomicInteger counter=new AtomicInteger();
  String id=UUID.randomUUID().toString();
  BoltConnection connection=newConnection(id);
  when(connection.processNextBatch()).thenAnswer(inv -> counter.incrementAndGet() > 0);
  when(connection.hasPendingJobs()).thenReturn(true).thenReturn(false);
  boltScheduler.start();
  boltScheduler.created(connection);
  boltScheduler.enqueued(connection,Jobs.noop());
  Predicates.await(() -> counter.get() > 1,1,MINUTES);
  verify(connection,times(2)).processNextBatch();
}
