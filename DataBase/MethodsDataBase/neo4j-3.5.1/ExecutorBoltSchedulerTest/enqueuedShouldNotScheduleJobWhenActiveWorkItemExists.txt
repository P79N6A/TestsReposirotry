@Test public void enqueuedShouldNotScheduleJobWhenActiveWorkItemExists() throws Throwable {
  String id=UUID.randomUUID().toString();
  BoltConnection connection=newConnection(id);
  AtomicBoolean exitCondition=new AtomicBoolean();
  when(connection.processNextBatch()).thenAnswer(inv -> awaitExit(exitCondition));
  boltScheduler.start();
  boltScheduler.created(connection);
  boltScheduler.enqueued(connection,Jobs.noop());
  Predicates.await(() -> boltScheduler.isActive(connection),1,MINUTES);
  boltScheduler.enqueued(connection,Jobs.noop());
  exitCondition.set(true);
  Predicates.await(() -> !boltScheduler.isActive(connection),1,MINUTES);
  verify(connection).processNextBatch();
}
