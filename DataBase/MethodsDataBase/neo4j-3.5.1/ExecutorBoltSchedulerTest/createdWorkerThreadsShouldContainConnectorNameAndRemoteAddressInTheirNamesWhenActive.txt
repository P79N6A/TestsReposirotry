@Test public void createdWorkerThreadsShouldContainConnectorNameAndRemoteAddressInTheirNamesWhenActive() throws Exception {
  final AtomicReference<String> capturedThreadName=new AtomicReference<>();
  AtomicInteger processNextBatchCount=new AtomicInteger();
  String id=UUID.randomUUID().toString();
  BoltConnection connection=newConnection(id);
  AtomicBoolean exitCondition=new AtomicBoolean();
  when(connection.processNextBatch()).thenAnswer(inv -> {
    capturedThreadName.set(Thread.currentThread().getName());
    processNextBatchCount.incrementAndGet();
    return awaitExit(exitCondition);
  }
);
  boltScheduler.start();
  boltScheduler.created(connection);
  boltScheduler.enqueued(connection,Jobs.noop());
  Predicates.await(() -> processNextBatchCount.get() > 0,1,MINUTES);
  assertThat(capturedThreadName.get(),containsString(String.format("[%s]",CONNECTOR_KEY)));
  assertThat(capturedThreadName.get(),containsString(String.format("[%s]",connection.remoteAddress())));
  exitCondition.set(true);
}
