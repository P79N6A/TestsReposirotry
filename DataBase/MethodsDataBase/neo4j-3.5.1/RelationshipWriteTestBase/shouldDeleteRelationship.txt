@Test public void shouldDeleteRelationship() throws Exception {
  long n1, r;
  try (org.neo4j.graphdb.Transaction tx=graphDb.beginTx()){
    Node node1=graphDb.createNode();
    Node node2=graphDb.createNode();
    n1=node1.getId();
    r=node1.createRelationshipTo(node2,RelationshipType.withName("R")).getId();
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    assertTrue("should delete relationship",tx.dataWrite().relationshipDelete(r));
    tx.success();
  }
   try (org.neo4j.graphdb.Transaction ignore=graphDb.beginTx()){
    assertEquals(0,graphDb.getNodeById(n1).getDegree());
  }
 }
