@Test public void shouldCreateRelationshipBetweenInTransactionNodes() throws Exception {
  long n1, n2, r;
  try (Transaction tx=beginTransaction()){
    n1=tx.dataWrite().nodeCreate();
    n2=tx.dataWrite().nodeCreate();
    int label=tx.token().relationshipTypeGetOrCreateForName("R");
    r=tx.dataWrite().relationshipCreate(n1,label,n2);
    tx.success();
  }
   try (org.neo4j.graphdb.Transaction ignore=graphDb.beginTx()){
    List<Relationship> relationships=Iterables.asList(graphDb.getNodeById(n1).getRelationships());
    assertEquals(1,relationships.size());
    assertEquals(relationships.get(0).getId(),r);
  }
 }
