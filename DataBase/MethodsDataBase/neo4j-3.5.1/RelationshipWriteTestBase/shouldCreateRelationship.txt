@Test public void shouldCreateRelationship() throws Exception {
  long n1, n2;
  try (org.neo4j.graphdb.Transaction tx=graphDb.beginTx()){
    n1=graphDb.createNode().getId();
    n2=graphDb.createNode().getId();
    tx.success();
  }
   long r;
  try (Transaction tx=beginTransaction()){
    int label=tx.token().relationshipTypeGetOrCreateForName("R");
    r=tx.dataWrite().relationshipCreate(n1,label,n2);
    tx.success();
  }
   try (org.neo4j.graphdb.Transaction ignore=graphDb.beginTx()){
    List<Relationship> relationships=Iterables.asList(graphDb.getNodeById(n1).getRelationships());
    assertEquals(1,relationships.size());
    assertEquals(relationships.get(0).getId(),r);
  }
 }
