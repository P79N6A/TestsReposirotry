@Test public void shouldUpdatePropertyToRelationshipInTransaction() throws Exception {
  long relationshipId;
  String propertyKey="prop";
  try (org.neo4j.graphdb.Transaction tx=graphDb.beginTx()){
    Node node1=graphDb.createNode();
    Node node2=graphDb.createNode();
    relationshipId=node1.createRelationshipTo(node2,RelationshipType.withName("R")).getId();
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    int token=tx.token().propertyKeyGetOrCreateForName(propertyKey);
    assertThat(tx.dataWrite().relationshipSetProperty(relationshipId,token,stringValue("hello")),equalTo(NO_VALUE));
    assertThat(tx.dataWrite().relationshipSetProperty(relationshipId,token,stringValue("world")),equalTo(stringValue("hello")));
    assertThat(tx.dataWrite().relationshipSetProperty(relationshipId,token,intValue(1337)),equalTo(stringValue("world")));
    tx.success();
  }
   try (org.neo4j.graphdb.Transaction ignore=graphDb.beginTx()){
    assertThat(graphDb.getRelationshipById(relationshipId).getProperty("prop"),equalTo(1337));
  }
 }
