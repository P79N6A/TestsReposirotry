@Test public void shouldContinueThroughEmptyIdBatch(){
  IdSequence idSource=mock(IdSequence.class);
  Iterator<IdRange> ranges=asList(new IdRange(EMPTY_LONG_ARRAY,0,BATCH_SIZE),new IdRange(EMPTY_LONG_ARRAY,BATCH_SIZE,0),new IdRange(EMPTY_LONG_ARRAY,BATCH_SIZE,BATCH_SIZE)).iterator();
  when(idSource.nextIdBatch(anyInt())).thenAnswer(invocation -> ranges.next());
  RenewableBatchIdSequence ids=new RenewableBatchIdSequence(idSource,BATCH_SIZE,excessIds::add);
  for (long expectedId=0; expectedId < BATCH_SIZE * 2; expectedId++) {
    assertEquals(expectedId,ids.nextId());
  }
}
