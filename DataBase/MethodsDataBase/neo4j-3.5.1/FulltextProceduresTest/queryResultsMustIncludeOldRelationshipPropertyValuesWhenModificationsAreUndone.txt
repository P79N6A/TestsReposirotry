@Test public void queryResultsMustIncludeOldRelationshipPropertyValuesWhenModificationsAreUndone(){
  db=createDatabase();
  try (Transaction tx=db.beginTx()){
    createSimpleRelationshipIndex();
    tx.success();
  }
   long relId;
  try (Transaction tx=db.beginTx()){
    awaitIndexesOnline();
    Node node=db.createNode();
    Relationship rel=node.createRelationshipTo(node,REL);
    rel.setProperty(PROP,"primo");
    relId=rel.getId();
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    Relationship rel=db.getRelationshipById(relId);
    assertQueryFindsIds(db,false,"rels","primo",relId);
    assertQueryFindsIds(db,false,"rels","secundo");
    rel.setProperty(PROP,"secundo");
    assertQueryFindsIds(db,false,"rels","primo");
    assertQueryFindsIds(db,false,"rels","secundo",relId);
    rel.setProperty(PROP,"primo");
    assertQueryFindsIds(db,false,"rels","primo",relId);
    assertQueryFindsIds(db,false,"rels","secundo");
    tx.success();
  }
 }
