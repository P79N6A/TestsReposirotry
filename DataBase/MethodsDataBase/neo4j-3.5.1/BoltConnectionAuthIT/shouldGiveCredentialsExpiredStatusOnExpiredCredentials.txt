@Test public void shouldGiveCredentialsExpiredStatusOnExpiredCredentials() throws Throwable {
  BoltStateMachine machine=env.newMachine(BOLT_CHANNEL);
  BoltResponseRecorder recorder=new BoltResponseRecorder();
  InitMessage init=new InitMessage(USER_AGENT,newBasicAuthToken("neo4j","neo4j"));
  machine.process(init,recorder);
  machine.process(new RunMessage("CREATE ()",EMPTY_MAP),recorder);
  assertThat(recorder.nextResponse(),succeededWithMetadata("credentials_expired",TRUE));
  assertThat(recorder.nextResponse(),failedWithStatus(Status.Security.CredentialsExpired));
}
