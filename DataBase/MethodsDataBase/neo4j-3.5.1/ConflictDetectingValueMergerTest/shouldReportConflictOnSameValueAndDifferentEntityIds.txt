@Test public void shouldReportConflictOnSameValueAndDifferentEntityIds(){
  Value value=Values.of(123);
  long entityId1=10;
  long entityId2=20;
  NativeIndexValue merged=detector.merge(key(entityId1,value),key(entityId2,value),NativeIndexValue.INSTANCE,NativeIndexValue.INSTANCE);
  assertNull(merged);
  try {
    detector.checkConflict(array(value));
    fail("Should've detected conflict");
  }
 catch (  IndexEntryConflictException e) {
    assertEquals(entityId1,e.getExistingNodeId());
    assertEquals(entityId2,e.getAddedNodeId());
    assertEquals(value,e.getSinglePropertyValue());
  }
}
