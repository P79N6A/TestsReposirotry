@Test public void shouldEncodeSmallSetOfRandomData(){
  int size=random.nextInt(10_000) + 2;
  ValueType type=ValueType.values()[random.nextInt(ValueType.values().length)];
  IdMapper mapper=mapper(type.encoder(),type.radix(),NO_MONITOR);
  ValueGenerator values=new ValueGenerator(type.data(random.random()));
  for (int nodeId=0; nodeId < size; nodeId++) {
    mapper.put(values.apply(nodeId),nodeId,GLOBAL);
  }
  mapper.prepare(values,mock(Collector.class),NONE);
  for (int nodeId=0; nodeId < size; nodeId++) {
    Object value=values.values.get(nodeId);
    assertEquals("Expected " + value + " to map to "+ nodeId,nodeId,mapper.get(value,GLOBAL));
  }
}
