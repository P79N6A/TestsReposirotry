@Test public void shouldObserveFirstRelationshipAsEmptyInEachDirection(){
  cache=new NodeRelationshipCache(NumberArrayFactory.AUTO_WITHOUT_PAGECACHE,1,100,base);
  int nodes=100;
  int typeId=5;
  Direction[] directions=Direction.values();
  GroupVisitor groupVisitor=mock(GroupVisitor.class);
  cache.setForwardScan(true,true);
  cache.setNodeCount(nodes + 1);
  for (int i=0; i < nodes; i++) {
    assertEquals(-1L,cache.getFirstRel(nodes,groupVisitor));
    cache.incrementCount(i);
    long previous=cache.getAndPutRelationship(i,typeId,directions[i % directions.length],random.nextInt(1_000_000),true);
    assertEquals(-1L,previous);
  }
  cache.setForwardScan(false,true);
  for (int i=0; i < nodes; i++) {
    long previous=cache.getAndPutRelationship(i,typeId,directions[i % directions.length],random.nextInt(1_000_000),false);
    assertEquals(-1L,previous);
  }
  cache.setForwardScan(true,true);
  for (int i=0; i < nodes; i++) {
    assertEquals(-1L,cache.getFirstRel(nodes,groupVisitor));
  }
}
