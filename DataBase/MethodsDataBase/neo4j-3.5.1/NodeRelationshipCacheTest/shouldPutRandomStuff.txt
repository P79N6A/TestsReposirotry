@Test public void shouldPutRandomStuff(){
  int typeId=10;
  int nodes=10_000;
  MutableLongObjectMap<long[]> key=new LongObjectHashMap<>(nodes);
  cache=new NodeRelationshipCache(NumberArrayFactory.HEAP,1,1000,base);
  cache.setNodeCount(nodes);
  for (long nodeId=0; nodeId < nodes; nodeId++) {
    if (random.nextBoolean()) {
      cache.incrementCount(nodeId);
    }
  }
  for (int i=0; i < 100_000; i++) {
    long nodeId=random.nextLong(nodes);
    boolean dense=cache.isDense(nodeId);
    Direction direction=random.among(Direction.values());
    long relationshipId=random.nextLong(1_000_000);
    long previousHead=cache.getAndPutRelationship(nodeId,typeId,direction,relationshipId,false);
    long[] keyIds=key.get(nodeId);
    int keyIndex=dense ? direction.ordinal() : 0;
    if (keyIds == null) {
      key.put(nodeId,keyIds=minusOneLongs(Direction.values().length));
    }
    assertEquals(keyIds[keyIndex],previousHead);
    keyIds[keyIndex]=relationshipId;
  }
}
