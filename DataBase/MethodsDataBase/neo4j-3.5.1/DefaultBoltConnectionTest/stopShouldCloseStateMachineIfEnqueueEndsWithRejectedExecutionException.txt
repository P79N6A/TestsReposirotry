@Test public void stopShouldCloseStateMachineIfEnqueueEndsWithRejectedExecutionException(){
  BoltConnection connection=newConnection();
  doAnswer(i -> {
    connection.handleSchedulingError(new RejectedExecutionException());
    return null;
  }
).when(queueMonitor).enqueued(ArgumentMatchers.eq(connection),ArgumentMatchers.any(Job.class));
  connection.stop();
  verify(stateMachine).markForTermination();
  verify(stateMachine).close();
}
