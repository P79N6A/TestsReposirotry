@Test public void processNextBatchShouldNotifyQueueMonitorAboutDrain(){
  List<Job> drainedJobs=new ArrayList<>();
  Job job=Jobs.noop();
  BoltConnection connection=newConnection();
  doAnswer(inv -> drainedJobs.addAll(inv.getArgument(1))).when(queueMonitor).drained(same(connection),anyCollection());
  connection.enqueue(job);
  connection.processNextBatch();
  verify(queueMonitor).drained(same(connection),anyCollection());
  assertTrue(drainedJobs.contains(job));
}
