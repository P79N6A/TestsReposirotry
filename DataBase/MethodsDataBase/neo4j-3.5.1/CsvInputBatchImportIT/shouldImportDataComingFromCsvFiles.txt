@Test public void shouldImportDataComingFromCsvFiles() throws Exception {
  Config dbConfig=Config.builder().withSetting(db_timezone,LogTimeZone.SYSTEM.name()).build();
  try (JobScheduler scheduler=new ThreadPoolJobScheduler()){
    BatchImporter importer=new ParallelBatchImporter(directory.databaseLayout(),fileSystemRule.get(),null,smallBatchSizeConfig(),NullLogService.getInstance(),invisible(),AdditionalInitialIds.EMPTY,dbConfig,RecordFormatSelector.defaultFormat(),NO_MONITOR,scheduler);
    List<InputEntity> nodeData=randomNodeData();
    List<InputEntity> relationshipData=randomRelationshipData(nodeData);
    importer.doImport(csv(nodeDataAsFile(nodeData),relationshipDataAsFile(relationshipData),IdType.STRING,lowBufferSize(COMMAS),silentBadCollector(0)));
    verifyImportedData(nodeData,relationshipData);
  }
 }
