@Test public void closeShouldWaitAllOperationToFinish(){
  clientA.acquireShared(LockTracer.NONE,NODE,1L);
  clientA.acquireShared(LockTracer.NONE,NODE,3L);
  clientB.acquireShared(LockTracer.NONE,NODE,1L);
  acquireShared(clientC,LockTracer.NONE,NODE,2L);
  acquireExclusive(clientB,LockTracer.NONE,NODE,1L).callAndAssertWaiting();
  acquireExclusive(clientC,LockTracer.NONE,NODE,1L).callAndAssertWaiting();
  clientB.close();
  clientC.close();
  clientA.close();
  LockCountVisitor lockCountVisitor=new LockCountVisitor();
  locks.accept(lockCountVisitor);
  assertEquals(0,lockCountVisitor.getLockCount());
}
