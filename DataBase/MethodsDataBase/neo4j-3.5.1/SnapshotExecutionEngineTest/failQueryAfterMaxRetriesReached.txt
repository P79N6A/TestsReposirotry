@Test public void failQueryAfterMaxRetriesReached() throws QueryExecutionKernelException {
  when(versionContext.isDirty()).thenReturn(true);
  try {
    executionEngine.executeWithRetries("query",Collections.emptyMap(),transactionalContext,executor);
  }
 catch (  QueryExecutionKernelException e) {
    assertEquals("Unable to get clean data snapshot for query 'query' after 5 attempts.",e.getMessage());
  }
  verify(executor,times(5)).execute(any(),anyMap(),any());
  verify(versionContext,times(5)).initRead();
}
