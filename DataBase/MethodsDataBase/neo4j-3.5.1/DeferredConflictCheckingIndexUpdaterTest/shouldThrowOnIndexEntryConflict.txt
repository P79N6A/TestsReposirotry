@Test public void shouldThrowOnIndexEntryConflict() throws Exception {
  IndexUpdater actual=mock(IndexUpdater.class);
  IndexReader reader=mock(IndexReader.class);
  when(reader.query(anyVararg())).thenAnswer(invocation -> iterator(101,202));
  DeferredConflictCheckingIndexUpdater updater=new DeferredConflictCheckingIndexUpdater(actual,() -> reader,descriptor);
  updater.process(add(0,descriptor,tuple(10,11)));
  try {
    updater.close();
    fail("Should have failed");
  }
 catch (  IndexEntryConflictException e) {
    assertThat(e.getMessage(),containsString("101"));
    assertThat(e.getMessage(),containsString("202"));
  }
}
