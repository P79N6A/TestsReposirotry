@Test public void shouldBeAbleToHandleSwappingOfIndexValues() throws Exception {
  populator=newPopulator();
  addUpdate(populator,1,"value1");
  addUpdate(populator,2,"value2");
  IndexUpdater updater=populator.newPopulatingUpdater(nodePropertyAccessor);
  updater.process(change(1,schemaDescriptor,"value1","value2"));
  updater.process(change(2,schemaDescriptor,"value2","value1"));
  populator.close(true);
  assertEquals(asList(2L),getAllNodes(getDirectory(),"value1"));
  assertEquals(asList(1L),getAllNodes(getDirectory(),"value2"));
}
