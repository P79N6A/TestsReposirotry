@Test public void shouldFailAtVerificationStageWithAlreadyIndexedStringValue() throws Exception {
  populator=newPopulator();
  String value="value1";
  addUpdate(populator,1,value);
  addUpdate(populator,2,"value2");
  addUpdate(populator,3,value);
  when(nodePropertyAccessor.getNodePropertyValue(1,PROPERTY_KEY_ID)).thenReturn(Values.of(value));
  when(nodePropertyAccessor.getNodePropertyValue(3,PROPERTY_KEY_ID)).thenReturn(Values.of(value));
  try {
    populator.verifyDeferredConstraints(nodePropertyAccessor);
    fail("should have thrown exception");
  }
 catch (  IndexEntryConflictException conflict) {
    assertEquals(1,conflict.getExistingNodeId());
    assertEquals(Values.of(value),conflict.getSinglePropertyValue());
    assertEquals(3,conflict.getAddedNodeId());
  }
}
