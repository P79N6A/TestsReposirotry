@Test void asyncWorkThatThrowsInAwaitMustRememberException() throws Exception {
  Future<Void> stuckAtSemaphore=makeWorkStuckAtSemaphore(1);
  RuntimeException boo=new RuntimeException("boo");
  AsyncApply asyncApply=sync.applyAsync(new AddWork(10){
    @Override public void apply(    Adder adder){
      super.apply(adder);
      throw boo;
    }
  }
);
  refillSemaphore();
  stuckAtSemaphore.get();
  try {
    asyncApply.await();
    fail("Should have thrown");
  }
 catch (  ExecutionException e) {
    assertThat(e.getCause(),sameInstance(boo));
  }
  assertThat(sum.sum(),is(11L));
  assertThat(count.sum(),is(2L));
  try {
    asyncApply.await();
    fail("Should have thrown");
  }
 catch (  ExecutionException e) {
    assertThat(e.getCause(),sameInstance(boo));
  }
  assertThat(sum.sum(),is(11L));
  assertThat(count.sum(),is(2L));
}
