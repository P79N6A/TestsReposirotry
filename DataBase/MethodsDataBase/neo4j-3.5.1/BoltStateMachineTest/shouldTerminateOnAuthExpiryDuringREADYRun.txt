@SuppressWarnings("unchecked") @Test public void shouldTerminateOnAuthExpiryDuringREADYRun() throws Throwable {
  TransactionStateMachineSPI transactionSPI=mock(TransactionStateMachineSPI.class);
  doThrow(new AuthorizationExpiredException("Auth expired!")).when(transactionSPI).beginTransaction(any(),any(),any());
  BoltStateMachine machine=newMachineWithTransactionSPI(transactionSPI);
  try {
    machine.process(new RunMessage("THIS WILL BE IGNORED",EMPTY_PARAMS),nullResponseHandler());
    fail("Exception expected");
  }
 catch (  BoltConnectionAuthFatality e) {
    assertEquals("Auth expired!",e.getCause().getMessage());
  }
}
