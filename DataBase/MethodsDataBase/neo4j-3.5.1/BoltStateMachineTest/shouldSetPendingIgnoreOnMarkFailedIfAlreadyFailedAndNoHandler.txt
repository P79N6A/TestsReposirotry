@Test public void shouldSetPendingIgnoreOnMarkFailedIfAlreadyFailedAndNoHandler() throws Exception {
  BoltStateMachine machine=newMachine();
  Neo4jError error1=Neo4jError.from(new RuntimeException());
  machine.markFailed(error1);
  Neo4jError error2=Neo4jError.from(Status.Request.NoThreadsAvailable,"no threads");
  machine.markFailed(error2);
  assertTrue(pendingIgnore(machine));
  assertEquals(error1,pendingError(machine));
  assertThat(machine,inState(FailedState.class));
}
