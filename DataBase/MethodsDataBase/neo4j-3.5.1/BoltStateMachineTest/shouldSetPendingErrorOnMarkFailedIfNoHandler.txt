@Test public void shouldSetPendingErrorOnMarkFailedIfNoHandler(){
  BoltStateMachineV1SPI spi=mock(BoltStateMachineV1SPI.class);
  BoltChannel boltChannel=mock(BoltChannel.class);
  BoltStateMachine machine=new BoltStateMachineV1(spi,boltChannel,Clock.systemUTC());
  Neo4jError error=Neo4jError.from(Status.Request.NoThreadsAvailable,"no threads");
  machine.markFailed(error);
  assertEquals(error,pendingError(machine));
  assertThat(machine,inState(FailedState.class));
}
