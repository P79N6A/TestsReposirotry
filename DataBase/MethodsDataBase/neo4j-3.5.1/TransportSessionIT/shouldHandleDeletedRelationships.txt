@Test public void shouldHandleDeletedRelationships() throws Throwable {
  connection.connect(address).send(util.defaultAcceptedVersions()).send(util.chunk(new InitMessage("TestClient/1.1",emptyMap()),new RunMessage("CREATE ()-[r:T {prop: 42}]->() DELETE r RETURN r"),PullAllMessage.INSTANCE));
  assertThat(connection,util.eventuallyReceivesSelectedProtocolVersion());
  Matcher<Map<? extends String,?>> entryFieldsMatcher=hasEntry(is("fields"),equalTo(singletonList("r")));
  assertThat(connection,util.eventuallyReceives(msgSuccess(),msgSuccess(CoreMatchers.allOf(entryFieldsMatcher,hasKey("result_available_after")))));
  assertThat(connection,eventuallyReceives(bytes(0x00,0x0B,0xB1,0x71,0x91,0xB5,0x52,0x00,0x00,0x01,0x81,0x54,0xA0,0x00,0x00)));
  assertThat(connection,util.eventuallyReceives(msgSuccess()));
}
