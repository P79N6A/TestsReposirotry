@Test void tryToStopComponentOnStartFailure() throws Throwable {
  LifeSupport lifeSupport=newLifeSupport();
  Lifecycle component=mock(Lifecycle.class);
  doThrow(new RuntimeException("Start exceptions")).when(component).start();
  doThrow(new RuntimeException("Stop exceptions")).when(component).stop();
  lifeSupport.add(component);
  try {
    lifeSupport.start();
    fail("Failure was expected");
  }
 catch (  Exception e) {
    String message=getExceptionStackTrace(e);
    assertThat(message,containsString("Exception during graceful attempt to stop partially started component. " + "Please use non suppressed exception to see original component failure."));
  }
  assertEquals(LifecycleStatus.STOPPED,lifeSupport.getStatus());
  verify(component).stop();
}
