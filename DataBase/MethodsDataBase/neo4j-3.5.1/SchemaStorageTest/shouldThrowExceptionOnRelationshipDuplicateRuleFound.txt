@Test public void shouldThrowExceptionOnRelationshipDuplicateRuleFound() throws DuplicateSchemaRuleException, SchemaRuleNotFoundException {
  TokenNameLookup tokenNameLookup=getDefaultTokenNameLookup();
  SchemaStorage schemaStorageSpy=Mockito.spy(storage);
  Mockito.when(schemaStorageSpy.loadAllSchemaRules(any(),any(),anyBoolean())).thenReturn(Iterators.iterator(getRelationshipPropertyExistenceConstraintRule(1L,TYPE1,PROP1),getRelationshipPropertyExistenceConstraintRule(2L,TYPE1,PROP1)));
  expectedException.expect(DuplicateSchemaRuleException.class);
  expectedException.expect(new KernelExceptionUserMessageMatcher(tokenNameLookup,"Multiple relationship property existence constraints found for -[:Type1(prop1)]-."));
  schemaStorageSpy.constraintsGetSingle(ConstraintDescriptorFactory.existsForRelType(typeId(TYPE1),propId(PROP1)));
}
