@Test void mustFlushDirtyPagesOnEvictingFirstPage() throws Exception {
  writeInitialDataTo(file("a"));
  RecordingPageCacheTracer tracer=new RecordingPageCacheTracer();
  RecordingPageCursorTracer cursorTracer=new RecordingPageCursorTracer();
  ConfigurablePageCursorTracerSupplier<RecordingPageCursorTracer> cursorTracerSupplier=new ConfigurablePageCursorTracerSupplier<>(cursorTracer);
  try (MuninnPageCache pageCache=createPageCache(fs,2,blockCacheFlush(tracer),cursorTracerSupplier);PagedFile pagedFile=map(pageCache,file("a"),8)){
    try (PageCursor cursor=pagedFile.io(0,PF_SHARED_WRITE_LOCK)){
      assertTrue(cursor.next());
      cursor.putLong(0L);
    }
     cursorTracer.reportEvents();
    assertNotNull(cursorTracer.observe(Fault.class));
    assertEquals(1,cursorTracer.faults());
    assertEquals(1,tracer.faults());
    long clockArm=pageCache.evictPages(1,0,tracer.beginPageEvictions(1));
    assertThat(clockArm,is(1L));
    assertNotNull(tracer.observe(Evict.class));
    ByteBuffer buf=readIntoBuffer("a");
    assertThat(buf.getLong(),is(0L));
    assertThat(buf.getLong(),is(y));
  }
 }
