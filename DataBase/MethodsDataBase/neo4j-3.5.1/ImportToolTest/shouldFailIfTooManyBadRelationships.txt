@Test public void shouldFailIfTooManyBadRelationships() throws Exception {
  List<String> nodeIds=asList("a","b","c");
  Configuration config=Configuration.COMMAS;
  File nodeData=nodeData(true,config,nodeIds,TRUE);
  List<RelationshipDataLine> relationships=Arrays.asList(relationship("a","b","TYPE"),relationship("c","bogus","TYPE"),relationship("b","c","KNOWS"),relationship("c","a","KNOWS"),relationship("missing","a","KNOWS"));
  File relationshipData=relationshipData(true,config,relationships.iterator(),TRUE,true);
  File bad=badFile();
  try {
    importTool("--into",dbRule.getDatabaseDirAbsolutePath(),"--nodes",nodeData.getAbsolutePath(),"--bad",bad.getAbsolutePath(),"--bad-tolerance","1","--relationships",relationshipData.getAbsolutePath());
    fail();
  }
 catch (  Exception e) {
    assertExceptionContains(e,relationshipData.getAbsolutePath(),InputException.class);
  }
}
