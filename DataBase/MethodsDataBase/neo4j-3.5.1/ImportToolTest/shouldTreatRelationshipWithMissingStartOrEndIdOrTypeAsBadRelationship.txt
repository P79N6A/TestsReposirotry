@Test public void shouldTreatRelationshipWithMissingStartOrEndIdOrTypeAsBadRelationship() throws Exception {
  List<String> nodeIds=asList("a","b","c");
  Configuration config=Configuration.COMMAS;
  File nodeData=nodeData(true,config,nodeIds,TRUE);
  List<RelationshipDataLine> relationships=Arrays.asList(relationship("a",null,"TYPE"),relationship(null,"b","TYPE"),relationship("a","b",null));
  File relationshipData=relationshipData(true,config,relationships.iterator(),TRUE,true);
  File bad=badFile();
  importTool("--into",dbRule.getDatabaseDirAbsolutePath(),"--nodes",nodeData.getAbsolutePath(),"--bad",bad.getAbsolutePath(),"--skip-bad-relationships","true","--relationships",relationshipData.getAbsolutePath());
  String badContents=FileUtils.readTextFile(bad,Charset.defaultCharset());
  assertEquals(badContents,3,occurencesOf(badContents,"is missing data"));
}
