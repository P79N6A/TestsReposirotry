@Test public void shouldListAddedPropertiesEvenIfPropertiesHaveBeenReplaced(){
  PropertyContainerStateImpl state=new PropertyContainerStateImpl(1,OnHeapCollectionsFactory.INSTANCE);
  state.addProperty(1,Values.of("Hello"));
  state.addProperty(1,Values.of("WAT"));
  state.addProperty(2,Values.of("Hello"));
  Iterator<StorageProperty> added=state.addedProperties();
  assertThat(Iterators.asList(added),equalTo(asList(new PropertyKeyValue(1,Values.of("WAT")),new PropertyKeyValue(2,Values.of("Hello")))));
}
