@Test(expected=TransactionTerminatedException.class) public void shouldThrowOnTerminationInCommit() throws Exception {
  KernelTransaction transaction=newTransaction(loginContext());
  transactionInitializer.accept(transaction);
  transaction.success();
  transaction.markForTermination(Status.General.UnknownError);
  transaction.close();
}
