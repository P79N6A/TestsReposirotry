@Test public void terminatedTxMarkedForBothSuccessAndFailureThrowsOnClose(){
  Locks.Client locksClient=mock(Locks.Client.class);
  KernelTransactionImplementation tx=newTransaction(loginContext(),locksClient);
  transactionInitializer.accept(tx);
  tx.success();
  tx.failure();
  tx.markForTermination(Status.General.UnknownError);
  try {
    tx.close();
    fail();
  }
 catch (  Exception e) {
    assertThat(e,instanceOf(TransactionTerminatedException.class));
  }
}
