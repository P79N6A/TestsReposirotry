@Test public void givenAccessGuardWithConditionWhenGrantAndDenyThenNotifyListeners(){
  Log log=mock(Log.class);
  final DatabaseAvailabilityGuard databaseAvailabilityGuard=getDatabaseAvailabilityGuard(clock,log);
  databaseAvailabilityGuard.require(REQUIREMENT_1);
  final AtomicBoolean notified=new AtomicBoolean();
  AvailabilityListener availabilityListener=new AvailabilityListener(){
    @Override public void available(){
    }
    @Override public void unavailable(){
      notified.set(true);
    }
  }
;
  databaseAvailabilityGuard.addListener(availabilityListener);
  databaseAvailabilityGuard.fulfill(REQUIREMENT_1);
  databaseAvailabilityGuard.require(REQUIREMENT_1);
  assertThat(notified.get(),equalTo(true));
}
