@Test public void givenAccessGuardWith2ConditionsWhenGrantTwiceAndDenyOnceAndAwaitThenTimeoutAndReturnFalse(){
  Log log=mock(Log.class);
  DatabaseAvailabilityGuard databaseAvailabilityGuard=getDatabaseAvailabilityGuard(clock,log);
  databaseAvailabilityGuard.require(REQUIREMENT_1);
  databaseAvailabilityGuard.require(REQUIREMENT_2);
  databaseAvailabilityGuard.fulfill(REQUIREMENT_1);
  databaseAvailabilityGuard.fulfill(REQUIREMENT_1);
  databaseAvailabilityGuard.require(REQUIREMENT_2);
  long start=clock.millis();
  long timeout=1000;
  boolean result=databaseAvailabilityGuard.isAvailable(timeout);
  long end=clock.millis();
  long waitTime=end - start;
  assertFalse(result);
  assertThat(waitTime,greaterThanOrEqualTo(timeout));
}
