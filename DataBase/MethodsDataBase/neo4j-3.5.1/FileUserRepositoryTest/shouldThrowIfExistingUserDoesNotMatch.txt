@Test public void shouldThrowIfExistingUserDoesNotMatch() throws Throwable {
  FileUserRepository users=new FileUserRepository(fs,authFile,logProvider);
  User user=new User.Builder("jake",LegacyCredential.INACCESSIBLE).withRequiredPasswordChange(true).build();
  users.create(user);
  User modifiedUser=user.augment().withCredentials(LegacyCredential.forPassword("foo")).build();
  User updatedUser=user.augment().withCredentials(LegacyCredential.forPassword("bar")).build();
  try {
    users.update(modifiedUser,updatedUser);
    fail("expected exception not thrown");
  }
 catch (  ConcurrentModificationException e) {
  }
}
