@Test public void shouldClearPasswordOnLogin() throws Throwable {
  when(authStrategy.authenticate(any(),any())).thenReturn(AuthenticationResult.SUCCESS);
  manager.start();
  manager.newUser("jake",password("abc123"),true);
  byte[] password=password("abc123");
  Map<String,Object> authToken=AuthToken.newBasicAuthToken("jake",password);
  manager.login(authToken);
  assertThat(password,equalTo(clearedPasswordWithSameLenghtAs("abc123")));
  assertThat(authToken.get(AuthToken.CREDENTIALS),equalTo(clearedPasswordWithSameLenghtAs("abc123")));
}
