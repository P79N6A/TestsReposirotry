@Test public void shouldFailWhenAuthTokenIsInvalid() throws Throwable {
  manager.start();
  assertException(() -> manager.login(map(AuthToken.SCHEME_KEY,"supercool",AuthToken.PRINCIPAL,"neo4j")),InvalidAuthTokenException.class,"Unsupported authentication token, scheme 'supercool' is not supported.");
  assertException(() -> manager.login(map(AuthToken.SCHEME_KEY,"none")),InvalidAuthTokenException.class,"Unsupported authentication token, scheme 'none' is only allowed when auth is disabled");
  assertException(() -> manager.login(map("key","value")),InvalidAuthTokenException.class,"Unsupported authentication token, missing key `scheme`");
  assertException(() -> manager.login(map(AuthToken.SCHEME_KEY,"basic",AuthToken.PRINCIPAL,"neo4j")),InvalidAuthTokenException.class,"Unsupported authentication token, missing key `credentials`");
  assertException(() -> manager.login(map(AuthToken.SCHEME_KEY,"basic",AuthToken.CREDENTIALS,"very-secret")),InvalidAuthTokenException.class,"Unsupported authentication token, missing key `principal`");
}
