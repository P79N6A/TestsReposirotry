@Test public void shouldClearPasswordOnInvalidAuthToken() throws Throwable {
  manager.start();
  byte[] password=password("abc123");
  Map<String,Object> authToken=AuthToken.newBasicAuthToken("jake",password);
  authToken.put(AuthToken.SCHEME_KEY,null);
  try {
    manager.login(authToken);
    fail("exception expected");
  }
 catch (  InvalidAuthTokenException e) {
  }
  assertThat(password,equalTo(clearedPasswordWithSameLenghtAs("abc123")));
  assertThat(authToken.get(AuthToken.CREDENTIALS),equalTo(clearedPasswordWithSameLenghtAs("abc123")));
}
