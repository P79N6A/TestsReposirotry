@Test public void mustSupportScanningAllRecordsWithRecordCursor() throws Exception {
  File file=createMetaDataFile();
  MetaDataStore.Position[] positions=MetaDataStore.Position.values();
  long storeVersion=versionStringToLong(Standard.LATEST_RECORD_FORMATS.storeVersion());
  writeCorrectMetaDataRecord(file,positions,storeVersion);
  List<Long> actualValues=new ArrayList<>();
  try (MetaDataStore store=newMetaDataStore()){
    MetaDataRecord record=store.newRecord();
    try (PageCursor cursor=store.openPageCursorForReading(0)){
      long highId=store.getHighId();
      for (long id=0; id < highId; id++) {
        store.getRecordByCursor(id,record,RecordLoad.NORMAL,cursor);
        if (record.inUse()) {
          actualValues.add(record.getValue());
        }
      }
    }
   }
   List<Long> expectedValues=Arrays.stream(positions).map(p -> {
    if (p == MetaDataStore.Position.STORE_VERSION) {
      return storeVersion;
    }
 else {
      return p.ordinal() + 1L;
    }
  }
).collect(Collectors.toList());
  assertThat(actualValues,is(expectedValues));
}
