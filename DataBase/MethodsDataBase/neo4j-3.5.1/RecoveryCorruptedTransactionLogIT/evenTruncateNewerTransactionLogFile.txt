@Test public void evenTruncateNewerTransactionLogFile() throws IOException {
  GraphDatabaseAPI database=(GraphDatabaseAPI)databaseFactory.newEmbeddedDatabase(storeDir);
  TransactionIdStore transactionIdStore=getTransactionIdStore(database);
  long lastClosedTransactionBeforeStart=transactionIdStore.getLastClosedTransactionId();
  for (int i=0; i < 10; i++) {
    generateTransaction(database);
  }
  long numberOfClosedTransactions=getTransactionIdStore(database).getLastClosedTransactionId() - lastClosedTransactionBeforeStart;
  database.shutdown();
  removeLastCheckpointRecordFromLastLogFile();
  addRandomBytesToLastLogFile(this::randomBytes);
  database=startDbNoRecoveryOfCorruptedLogs();
  database.shutdown();
  assertEquals(numberOfClosedTransactions,recoveryMonitor.getNumberOfRecoveredTransactions());
}
