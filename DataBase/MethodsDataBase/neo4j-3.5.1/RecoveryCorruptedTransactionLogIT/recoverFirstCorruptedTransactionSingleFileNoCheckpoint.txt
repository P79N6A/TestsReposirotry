@Test public void recoverFirstCorruptedTransactionSingleFileNoCheckpoint() throws IOException {
  addCorruptedCommandsToLastLogFile();
  GraphDatabaseService recoveredDatabase=startDbNoRecoveryOfCorruptedLogs();
  recoveredDatabase.shutdown();
  logProvider.assertContainsMessageContaining("Fail to read transaction log version 0.");
  logProvider.assertContainsMessageContaining("Fail to read first transaction of log version 0.");
  logProvider.assertContainsMessageContaining("Recovery required from position LogPosition{logVersion=0, byteOffset=16}");
  logProvider.assertContainsMessageContaining("Fail to recover all transactions. Any later transactions after" + " position LogPosition{logVersion=0, byteOffset=16} are unreadable and will be truncated.");
  assertEquals(0,logFiles.getHighestLogVersion());
  ObjectLongMap<Class> logEntriesDistribution=getLogEntriesDistribution(logFiles);
  assertEquals(1,logEntriesDistribution.size());
  assertEquals(1,logEntriesDistribution.get(CheckPoint.class));
}
