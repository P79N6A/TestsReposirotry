@Test(timeout=TEST_TIMEOUT) public void notifyAboutExplicitIndexFolderRemoval() throws InterruptedException, IOException {
  String monitoredDirectory=getExplicitIndexDirectory(testDirectory.databaseLayout());
  FileWatcher fileWatcher=getFileWatcher(database);
  CheckPointer checkPointer=getCheckpointer(database);
  DeletionLatchEventListener deletionListener=new DeletionLatchEventListener(monitoredDirectory);
  String metadataStore=testDirectory.databaseLayout().metadataStore().getName();
  ModificationEventListener modificationEventListener=new ModificationEventListener(metadataStore);
  fileWatcher.addFileWatchEventListener(deletionListener);
  fileWatcher.addFileWatchEventListener(modificationEventListener);
  do {
    createNode(database);
    forceCheckpoint(checkPointer);
  }
 while (!modificationEventListener.awaitModificationNotification());
  deleteStoreDirectory(storeDir,monitoredDirectory);
  deletionListener.awaitDeletionNotification();
  logProvider.assertContainsMessageContaining("'" + monitoredDirectory + "' which belongs to the store was deleted while database was running.");
}
