@Test public void shouldProduceCompleteBatchesPerOwner(){
  Configuration config=Configuration.withBatchSize(DEFAULT,10);
  Iterator<RelationshipGroupRecord> groups=groups(new Group(1,3),new Group(2,3),new Group(3,4),new Group(4,2),new Group(5,10),new Group(6,35),new Group(7,2)).iterator();
  final AtomicInteger processCounter=new AtomicInteger();
  Stage stage=new Stage(getClass().getSimpleName(),null,config,0){
{
      add(new ReadGroupsFromCacheStep(control(),config,groups,1));
      add(new VerifierStep(control(),config,processCounter));
    }
  }
;
  superviseDynamicExecution(stage);
  assertEquals(4,processCounter.get());
}
