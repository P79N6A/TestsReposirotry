@Test public void shouldOnlyDeleteAffectedKeyWhenRemovingPropertyFromNode(){
  String key1="foo";
  String key2="bar";
  String value1="bip";
  String value2="bop";
  newTransaction();
  AutoIndexer<Node> nodeAutoIndexer=graphDb.index().getNodeAutoIndexer();
  nodeAutoIndexer.startAutoIndexingProperty(key1);
  nodeAutoIndexer.startAutoIndexingProperty(key2);
  nodeAutoIndexer.setEnabled(true);
  Node node=graphDb.createNode();
  node.setProperty(key1,value1);
  node.setProperty(key2,value2);
  newTransaction();
  node.removeProperty(key1);
  newTransaction();
  assertEquals(0,count(nodeAutoIndexer.getAutoIndex().get(key1,value1)));
  assertEquals(1,count(nodeAutoIndexer.getAutoIndex().get(key2,value2)));
}
