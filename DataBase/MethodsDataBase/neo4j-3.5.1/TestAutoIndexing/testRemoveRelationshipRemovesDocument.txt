@Test public void testRemoveRelationshipRemovesDocument(){
  newTransaction();
  AutoIndexer<Relationship> autoIndexer=graphDb.index().getRelationshipAutoIndexer();
  autoIndexer.startAutoIndexingProperty("foo");
  autoIndexer.setEnabled(true);
  Node node1=graphDb.createNode();
  Node node2=graphDb.createNode();
  Relationship rel=node1.createRelationshipTo(node2,RelationshipType.withName("foo"));
  rel.setProperty("foo","bar");
  newTransaction();
  try (IndexHits<Relationship> relationshipIndexHits=graphDb.index().forRelationships("relationship_auto_index").query("_id_:*")){
    assertThat(relationshipIndexHits.size(),equalTo(1));
  }
   newTransaction();
  rel.delete();
  newTransaction();
  try (IndexHits<Relationship> relationshipIndexHits=graphDb.index().forRelationships("relationship_auto_index").query("_id_:*")){
    assertThat(relationshipIndexHits.size(),equalTo(0));
  }
 }
