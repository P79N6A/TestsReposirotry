@Test public void shouldHandleConcurrentGetOrCreate() throws Throwable {
  Groups groups=new Groups();
  Race race=new Race();
  String name="MyGroup";
  for (int i=0; i < Runtime.getRuntime().availableProcessors(); i++) {
    race.addContestant(() -> {
      Group group=groups.getOrCreate(name);
      assertEquals(LOWEST_NONGLOBAL_ID,group.id());
    }
);
  }
  race.go();
  Group otherGroup=groups.getOrCreate("MyOtherGroup");
  assertEquals(LOWEST_NONGLOBAL_ID + 1,otherGroup.id());
}
