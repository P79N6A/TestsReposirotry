@Test @DisabledOnOs(OS.WINDOWS) void shouldReportAHelpfulErrorIfWeDontHaveWritePermissionsForLock() throws Exception {
  StoreLayout storeLayout=DatabaseLayout.of(databaseDirectory.toFile()).getStoreLayout();
  try (FileSystemAbstraction fileSystem=new DefaultFileSystemAbstraction();StoreLocker storeLocker=new StoreLocker(fileSystem,storeLayout)){
    storeLocker.checkLock();
    try (Closeable ignored=withPermissions(storeLayout.storeLockFile().toPath(),emptySet())){
      CommandFailed commandFailed=assertThrows(CommandFailed.class,() -> execute("foo.db"));
      assertEquals(commandFailed.getMessage(),"you do not have permission to dump the database -- is Neo4j running as a different user?");
    }
   }
 }
