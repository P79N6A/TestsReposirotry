@Test void shouldRespectTheStoreLock() throws Exception {
  Path databaseDirectory=homeDir.resolve("data/databases/foo.db");
  StoreLayout storeLayout=DatabaseLayout.of(databaseDirectory.toFile()).getStoreLayout();
  try (FileSystemAbstraction fileSystem=new DefaultFileSystemAbstraction();StoreLocker storeLocker=new StoreLocker(fileSystem,storeLayout)){
    storeLocker.checkLock();
    CommandFailed commandFailed=assertThrows(CommandFailed.class,() -> execute("foo.db"));
    assertEquals("the database is in use -- stop Neo4j and try again",commandFailed.getMessage());
  }
 }
