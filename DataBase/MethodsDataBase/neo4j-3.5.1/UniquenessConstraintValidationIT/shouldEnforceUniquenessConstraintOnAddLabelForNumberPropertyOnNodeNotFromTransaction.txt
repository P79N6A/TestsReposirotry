@Test public void shouldEnforceUniquenessConstraintOnAddLabelForNumberPropertyOnNodeNotFromTransaction() throws Exception {
  constrainedNode("Label1","key1",1);
  Transaction transaction=newTransaction(AnonymousContext.writeToken());
  long node=createNode(transaction,"key1",1);
  commit();
  transaction=newTransaction(AnonymousContext.writeToken());
  try {
    int label=transaction.tokenWrite().labelGetOrCreateForName("Label1");
    transaction.dataWrite().nodeAddLabel(node,label);
    fail("should have thrown exception");
  }
 catch (  UniquePropertyValueValidationException e) {
    assertThat(e.getUserMessage(tokenLookup(transaction)),containsString("`key1` = 1"));
  }
  commit();
}
