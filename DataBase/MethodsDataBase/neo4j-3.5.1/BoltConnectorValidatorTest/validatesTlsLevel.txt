@Test public void validatesTlsLevel(){
  String key="dbms.connector.bolt.tls_level";
  assertEquals(stringMap(key,EncryptionLevel.DISABLED.name()),cv.validate(stringMap(key,EncryptionLevel.DISABLED.name()),warningConsumer));
  assertEquals(stringMap(key,EncryptionLevel.OPTIONAL.name()),cv.validate(stringMap(key,EncryptionLevel.OPTIONAL.name()),warningConsumer));
  assertEquals(stringMap(key,EncryptionLevel.REQUIRED.name()),cv.validate(stringMap(key,EncryptionLevel.REQUIRED.name()),warningConsumer));
  key="dbms.connector.bla.tls_level";
  String type="dbms.connector.bla.type";
  assertEquals(stringMap(key,EncryptionLevel.DISABLED.name(),type,BOLT.name()),cv.validate(stringMap(key,EncryptionLevel.DISABLED.name(),type,BOLT.name()),warningConsumer));
  assertEquals(stringMap(key,EncryptionLevel.OPTIONAL.name(),type,BOLT.name()),cv.validate(stringMap(key,EncryptionLevel.OPTIONAL.name(),type,BOLT.name()),warningConsumer));
  assertEquals(stringMap(key,EncryptionLevel.REQUIRED.name(),type,BOLT.name()),cv.validate(stringMap(key,EncryptionLevel.REQUIRED.name(),type,BOLT.name()),warningConsumer));
  expected.expect(InvalidSettingException.class);
  expected.expectMessage("Bad value 'BOBO' for setting 'dbms.connector.bla.tls_level': must be one of [REQUIRED, OPTIONAL, " + "DISABLED] case sensitive");
  cv.validate(stringMap(key,"BOBO",type,BOLT.name()),warningConsumer);
}
