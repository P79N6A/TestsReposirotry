@Test void shouldStoreFailure() throws Exception {
  FailureStorage storage=new FailureStorage(fs,indexFolderLayout);
  storage.reserveForIndex();
  String failure=format("A failure message%nspanning%nmultiple lines.");
  storage.storeIndexFailure(failure);
  File failureFile=storage.failureFile();
  assertTrue(fs.fileExists(failureFile));
  assertTrue(fs.getFileSize(failureFile) > 100);
  assertEquals(failure,storage.loadIndexFailure());
}
