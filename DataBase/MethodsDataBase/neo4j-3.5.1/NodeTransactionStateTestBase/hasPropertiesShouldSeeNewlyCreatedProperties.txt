@Test public void hasPropertiesShouldSeeNewlyCreatedProperties() throws Exception {
  long node;
  try (Transaction tx=beginTransaction()){
    node=tx.dataWrite().nodeCreate();
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    try (NodeCursor cursor=tx.cursors().allocateNodeCursor();PropertyCursor props=tx.cursors().allocatePropertyCursor()){
      tx.dataRead().singleNode(node,cursor);
      assertTrue(cursor.next());
      assertFalse(hasProperties(cursor,props));
      tx.dataWrite().nodeSetProperty(node,tx.tokenWrite().propertyKeyGetOrCreateForName("prop"),stringValue("foo"));
      assertTrue(hasProperties(cursor,props));
    }
   }
 }
