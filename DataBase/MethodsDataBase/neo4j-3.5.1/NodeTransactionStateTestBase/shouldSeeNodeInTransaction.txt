@Test public void shouldSeeNodeInTransaction() throws Exception {
  long nodeId;
  try (Transaction tx=beginTransaction()){
    nodeId=tx.dataWrite().nodeCreate();
    try (NodeCursor node=tx.cursors().allocateNodeCursor()){
      tx.dataRead().singleNode(nodeId,node);
      assertTrue("should access node",node.next());
      assertEquals(nodeId,node.nodeReference());
      assertFalse("should only find one node",node.next());
    }
     tx.success();
  }
   try (org.neo4j.graphdb.Transaction ignore=graphDb.beginTx()){
    assertEquals(nodeId,graphDb.getNodeById(nodeId).getId());
  }
 }
