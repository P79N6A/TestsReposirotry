@Test(timeout=5_000L) public void checkPointShouldWaitForWriter() throws Exception {
  try (GBPTree<MutableLong,MutableLong> index=index().build()){
    Barrier.Control barrier=new Barrier.Control();
    Future<?> write=executor.submit(throwing(() -> {
      try (Writer<MutableLong,MutableLong> writer=index.writer()){
        writer.put(new MutableLong(1),new MutableLong(1));
        barrier.reached();
      }
     }
));
    barrier.awaitUninterruptibly();
    Future<?> checkpoint=executor.submit(throwing(() -> index.checkpoint(UNLIMITED)));
    shouldWait(checkpoint);
    barrier.release();
    checkpoint.get();
    write.get();
  }
 }
