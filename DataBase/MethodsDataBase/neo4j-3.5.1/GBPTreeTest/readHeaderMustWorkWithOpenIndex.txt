@Test public void readHeaderMustWorkWithOpenIndex() throws Exception {
  byte[] headerBytes=new byte[12];
  ThreadLocalRandom.current().nextBytes(headerBytes);
  Consumer<PageCursor> headerWriter=pc -> pc.putBytes(headerBytes);
  PageCache pageCache=createPageCache(DEFAULT_PAGE_SIZE);
  try (GBPTree<MutableLong,MutableLong> ignore=index(pageCache).with(headerWriter).build()){
    byte[] readHeader=new byte[headerBytes.length];
    AtomicInteger length=new AtomicInteger();
    Header.Reader headerReader=headerData -> {
      length.set(headerData.limit());
      headerData.get(readHeader);
    }
;
    GBPTree.readHeader(pageCache,indexFile,headerReader);
    assertEquals(headerBytes.length,length.get());
    assertArrayEquals(headerBytes,readHeader);
  }
 }
