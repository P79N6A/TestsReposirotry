@Test(timeout=5_000L) public void cleanJobShouldLockOutCheckpoint() throws Exception {
  makeDirty();
  RecoveryCleanupWorkCollector cleanupWork=new ControlledRecoveryCleanupWorkCollector();
  CleanJobControlledMonitor monitor=new CleanJobControlledMonitor();
  try (GBPTree<MutableLong,MutableLong> index=index().with(monitor).with(cleanupWork).build()){
    Future<?> cleanup=executor.submit(throwing(cleanupWork::start));
    monitor.barrier.awaitUninterruptibly();
    index.writer().close();
    Future<?> checkpoint=executor.submit(throwing(() -> index.checkpoint(UNLIMITED)));
    shouldWait(checkpoint);
    monitor.barrier.release();
    cleanup.get();
    checkpoint.get();
  }
 }
