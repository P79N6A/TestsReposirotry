@Test public void takeLabelLockForQueryWithIndexUsages() throws Exception {
  String labelName="Human";
  Label human=Label.label(labelName);
  String propertyKey="name";
  createIndex(human,propertyKey);
  try (Transaction transaction=databaseRule.beginTx()){
    Node node=databaseRule.createNode(human);
    node.setProperty(propertyKey,RandomStringUtils.randomAscii(10));
    transaction.success();
  }
   String query="MATCH (n:" + labelName + ") where n."+ propertyKey+ " = \"Fry\" RETURN n ";
  List<LockOperationRecord> lockOperationRecords=traceQueryLocks(query);
  assertThat("Observed list of lock operations is: " + lockOperationRecords,lockOperationRecords,hasSize(1));
  LockOperationRecord operationRecord=lockOperationRecords.get(0);
  assertTrue(operationRecord.acquisition);
  assertFalse(operationRecord.exclusive);
  assertEquals(ResourceTypes.LABEL,operationRecord.resourceType);
}
