@Test public void shouldCreateConstraintIndexForSpecifiedProvider() throws Exception {
  IndexingService indexingService=mock(IndexingService.class);
  StubKernel kernel=new StubKernel();
  when(schemaRead.indexGetCommittedId(indexReference)).thenReturn(INDEX_ID);
  IndexProxy indexProxy=mock(IndexProxy.class);
  when(indexingService.getIndexProxy(INDEX_ID)).thenReturn(indexProxy);
  when(indexingService.getIndexProxy(descriptor)).thenReturn(indexProxy);
  NodePropertyAccessor nodePropertyAccessor=mock(NodePropertyAccessor.class);
  ConstraintIndexCreator creator=new ConstraintIndexCreator(() -> kernel,indexingService,nodePropertyAccessor,logProvider);
  IndexProviderDescriptor providerDescriptor=new IndexProviderDescriptor("Groovy","1.2");
  KernelTransactionImplementation transaction=createTransaction();
  creator.createUniquenessConstraintIndex(transaction,descriptor,providerDescriptor.name());
  assertEquals(1,kernel.transactions.size());
  KernelTransactionImplementation transactionInstance=kernel.transactions.get(0);
  verify(transactionInstance).indexUniqueCreate(eq(descriptor),eq(providerDescriptor.name()));
  verify(schemaRead).index(descriptor);
  verify(schemaRead).indexGetCommittedId(any());
  verifyNoMoreInteractions(schemaRead);
}
