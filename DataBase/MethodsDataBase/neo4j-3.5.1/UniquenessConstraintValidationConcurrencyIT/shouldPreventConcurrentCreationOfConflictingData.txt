@Test public void shouldPreventConcurrentCreationOfConflictingData() throws Exception {
  database.executeAndCommit(createUniquenessConstraint("Label1","key1"));
  Future<Boolean> created=database.executeAndCommit(db -> {
    db.createNode(label("Label1")).setProperty("key1","value1");
    try {
      return otherThread.execute(createNode(db,"Label1","key1","value1"));
    }
  finally {
      assertThat(otherThread,isWaiting());
    }
  }
);
  assertFalse("node creation should fail",created.get());
}
