@Test public void shouldWriteFailureMessage() throws Exception {
  PackOutput output=mock(PackOutput.class);
  Neo4jPack.Packer packer=mock(Neo4jPack.Packer.class);
  BoltResponseMessageWriterV1 writer=newWriter(output,packer);
  Status.Transaction errorStatus=Status.Transaction.DeadlockDetected;
  String errorMessage="Hi Deadlock!";
  writer.write(new FailureMessage(errorStatus,errorMessage));
  InOrder inOrder=inOrder(output,packer);
  inOrder.verify(output).beginMessage();
  inOrder.verify(packer).pack(errorStatus.code().serialize());
  inOrder.verify(packer).pack(errorMessage);
  inOrder.verify(output).messageSucceeded();
}
