@Test void shouldHandleAuthErrorWhenProcessingDiscardAllMessage() throws Exception {
  AuthorizationExpiredException error=new AuthorizationExpiredException("Hello");
  StatementProcessor statementProcessor=mock(StatementProcessor.class);
  doThrow(error).when(statementProcessor).streamResult(any());
  connectionState.setStatementProcessor(statementProcessor);
  BoltStateMachineState nextState=state.process(DiscardAllMessage.INSTANCE,context);
  assertEquals(failedState,nextState);
  verify(context).handleFailure(error,true);
}
