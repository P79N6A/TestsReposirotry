@Test void shouldHandleErrorWhenProcessingDiscardAllMessage() throws Exception {
  RuntimeException error=new RuntimeException("Hello");
  StatementProcessor statementProcessor=mock(StatementProcessor.class);
  doThrow(error).when(statementProcessor).streamResult(any());
  connectionState.setStatementProcessor(statementProcessor);
  BoltStateMachineState nextState=state.process(DiscardAllMessage.INSTANCE,context);
  assertEquals(failedState,nextState);
  verify(context).handleFailure(error,false);
}
