@Test public void mustDiscoverRelationshipInStoreMissingFromIndex() throws Exception {
  GraphDatabaseService db=createDatabase();
  try (Transaction tx=db.beginTx()){
    db.execute(format(RELATIONSHIP_CREATE,"rels",array("REL"),array("prop"))).close();
    tx.success();
  }
   StoreIndexDescriptor indexDescriptor;
  long relId;
  try (Transaction tx=db.beginTx()){
    db.schema().awaitIndexesOnline(1,TimeUnit.MINUTES);
    indexDescriptor=getIndexDescriptor(first(db.schema().getIndexes()));
    Node node=db.createNode();
    Relationship rel=node.createRelationshipTo(node,RelationshipType.withName("REL"));
    rel.setProperty("prop","value");
    relId=rel.getId();
    tx.success();
  }
   IndexingService indexes=getIndexingService(db);
  IndexProxy indexProxy=indexes.getIndexProxy(indexDescriptor.schema());
  try (IndexUpdater updater=indexProxy.newUpdater(IndexUpdateMode.ONLINE)){
    updater.process(IndexEntryUpdate.remove(relId,indexDescriptor,Values.stringValue("value")));
  }
   db.shutdown();
  ConsistencyCheckService.Result result=checkConsistency();
  assertFalse(result.isSuccessful());
}
