@Test public void shouldListIndexesByLabel() throws Exception {
  int wrongLabel;
  IndexReference inStore;
  IndexReference droppedInTx;
  IndexReference createdInTx;
  try (Transaction tx=beginTransaction()){
    wrongLabel=tx.tokenWrite().labelGetOrCreateForName("wrongLabel");
    tx.schemaWrite().uniquePropertyConstraintCreate(labelDescriptor(wrongLabel,prop1));
    inStore=tx.schemaWrite().indexCreate(labelDescriptor(label,prop1));
    droppedInTx=tx.schemaWrite().indexCreate(labelDescriptor(label,prop2));
    tx.success();
  }
   try (Transaction tx=beginTransaction()){
    createdInTx=tx.schemaWrite().indexCreate(labelDescriptor(label,prop3));
    tx.schemaWrite().indexCreate(labelDescriptor(wrongLabel,prop2));
    tx.schemaWrite().indexDrop(droppedInTx);
    Iterable<IndexReference> indexes=() -> tx.schemaRead().indexesGetForLabel(label);
    assertThat(indexes,containsInAnyOrder(inStore,createdInTx));
    tx.success();
  }
 }
