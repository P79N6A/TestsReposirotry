@Test public void shouldHandleMultipleConcurrentStoreCopyRequests() throws Throwable {
  Race race=new Race();
  CountingAction action=new CountingAction();
  int threads=Runtime.getRuntime().availableProcessors() * 10;
  race.addContestants(threads,throwing(() -> {
    parkARandomWhile();
    try (Resource lock=mutex.storeCopy(action)){
      parkARandomWhile();
    }
   }
));
  race.go();
  assertThat(action.count(),lessThan(threads));
}
