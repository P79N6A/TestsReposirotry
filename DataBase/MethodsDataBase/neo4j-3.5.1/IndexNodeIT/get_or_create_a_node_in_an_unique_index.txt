@Documented("Get or create unique node (create).\n" + "\n" + "The node is created if it doesn't exist in the unique index already.") @Test public void get_or_create_a_node_in_an_unique_index() throws Exception {
  final String index=indexes.newInstance();
  String key="name";
  String value="Tobias";
  helper.createNodeIndex(index);
  ResponseEntity response=gen().expectedStatus(201).payloadType(MediaType.APPLICATION_JSON_TYPE).payload("{\"key\": \"" + key + "\", \"value\": \""+ value+ "\", \"properties\": {\""+ key+ "\": \""+ value+ "\", \"sequence\": 1}}").post(functionalTestHelper.nodeIndexUri() + index + "?uniqueness=get_or_create");
  MultivaluedMap<String,String> headers=response.response().getHeaders();
  Map<String,Object> result=JsonHelper.jsonToMap(response.entity());
  assertEquals(result.get("indexed"),headers.getFirst("Location"));
  Map<String,Object> data=assertCast(Map.class,result.get("data"));
  assertEquals(value,data.get(key));
  assertEquals(1,data.get("sequence"));
}
