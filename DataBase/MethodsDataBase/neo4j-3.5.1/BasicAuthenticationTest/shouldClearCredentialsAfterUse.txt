@Test public void shouldClearCredentialsAfterUse() throws Exception {
  byte[] oldPassword=UTF8.encode("secret2");
  byte[] newPassword1=UTF8.encode("secret");
  byte[] newPassword2=UTF8.encode("secret");
  authentication.authenticate(map("scheme","basic","principal","mike","credentials",oldPassword,"new_credentials",newPassword1));
  authentication.authenticate(map("scheme","basic","principal","mike","credentials",newPassword2));
  assertThat(oldPassword,isCleared());
  assertThat(newPassword1,isCleared());
  assertThat(newPassword2,isCleared());
}
