@Test public void shouldFailOnMalformedToken() throws Exception {
  exception.expect(AuthenticationException.class);
  exception.expect(hasStatus(Status.Security.Unauthorized));
  exception.expectMessage("Unsupported authentication token, the value associated with the key `principal` " + "must be a String but was: SingletonList");
  authentication.authenticate(map("scheme","basic","principal",singletonList("bob"),"credentials",UTF8.encode("secret")));
}
