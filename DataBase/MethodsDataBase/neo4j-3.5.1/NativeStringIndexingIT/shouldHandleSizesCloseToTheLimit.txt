@Test public void shouldHandleSizesCloseToTheLimit(){
  createIndex(KEY);
  Map<String,Long> strings=new HashMap<>();
  try (Transaction tx=db.beginTx()){
    for (int i=0; i < 1_000; i++) {
      String string;
      do {
        string=random.nextAlphaNumericString(3_000,4_000);
      }
 while (strings.containsKey(string));
      Node node=db.createNode(LABEL);
      node.setProperty(KEY,string);
      strings.put(string,node.getId());
    }
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    for (    String string : strings.keySet()) {
      Node node=db.findNode(LABEL,KEY,string);
      assertEquals(strings.get(string).longValue(),node.getId());
    }
    tx.success();
  }
 }
