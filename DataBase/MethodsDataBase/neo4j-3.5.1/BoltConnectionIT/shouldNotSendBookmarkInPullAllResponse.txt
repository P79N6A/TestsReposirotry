@Test public void shouldNotSendBookmarkInPullAllResponse() throws Throwable {
  BoltStateMachine machine=env.newMachine(BOLT_CHANNEL);
  machine.process(new InitMessage(USER_AGENT,emptyMap()),nullResponseHandler());
  BoltResponseRecorder recorder=new BoltResponseRecorder();
  machine.process(new RunMessage("BEGIN",EMPTY_PARAMS),nullResponseHandler());
  machine.process(PullAllMessage.INSTANCE,nullResponseHandler());
  machine.process(new RunMessage("RETURN 1",EMPTY_PARAMS),nullResponseHandler());
  machine.process(PullAllMessage.INSTANCE,nullResponseHandler());
  machine.process(new RunMessage("COMMIT",EMPTY_PARAMS),nullResponseHandler());
  machine.process(PullAllMessage.INSTANCE,recorder);
  AnyValue bookmark=recorder.nextResponse().metadata("bookmark");
  assertNotNull(bookmark);
  String bookmarkStr=((TextValue)bookmark).stringValue();
  recorder.reset();
  machine.process(new RunMessage("BEGIN",map("bookmark",bookmarkStr)),nullResponseHandler());
  machine.process(PullAllMessage.INSTANCE,recorder);
  RecordedBoltResponse response=recorder.nextResponse();
  assertThat(response,succeeded());
  assertThat(response.hasMetadata("bookmark"),is(false));
}
