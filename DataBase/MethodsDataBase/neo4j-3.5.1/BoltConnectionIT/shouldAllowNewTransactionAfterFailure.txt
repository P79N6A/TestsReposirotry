@Test public void shouldAllowNewTransactionAfterFailure() throws Throwable {
  BoltStateMachine machine=env.newMachine(BOLT_CHANNEL);
  machine.process(new InitMessage(USER_AGENT,emptyMap()),nullResponseHandler());
  runAndPull(machine,"BEGIN");
  machine.process(new RunMessage("invalid",EMPTY_PARAMS),nullResponseHandler());
  machine.process(ResetMessage.INSTANCE,nullResponseHandler());
  runAndPull(machine,"BEGIN");
  Object[] stream=runAndPull(machine,"RETURN 1");
  assertThat(((Record)stream[0]).fields()[0],equalTo(longValue(1L)));
}
