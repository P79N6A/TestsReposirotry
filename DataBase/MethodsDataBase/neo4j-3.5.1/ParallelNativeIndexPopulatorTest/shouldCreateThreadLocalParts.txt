@Test void shouldCreateThreadLocalParts() throws ExecutionException, InterruptedException, IndexEntryConflictException {
  Thread mainThread=Thread.currentThread();
  ConcurrentMap<Thread,NativeIndexPopulator> partPopulators=new ConcurrentHashMap<>();
  ParallelNativeIndexPopulator<GenericKey,NativeIndexValue> populator=new ParallelNativeIndexPopulator<>(baseIndexFile,layout,mockPartSupplier(partPopulators,this::mockNativeIndexPopulator));
  int batchCountPerThread=10;
  applyBatchesInParallel(populator,batchCountPerThread);
  assertEquals(THREADS,partPopulators.size());
  for (  Thread thread : partPopulators.keySet()) {
    if (thread != mainThread) {
      NativeIndexPopulator partPopulator=partPopulators.get(thread);
      verify(partPopulator,times(batchCountPerThread)).add(anyCollection());
    }
  }
}
