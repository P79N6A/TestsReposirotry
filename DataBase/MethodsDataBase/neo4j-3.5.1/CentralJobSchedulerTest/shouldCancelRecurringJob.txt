@Test public void shouldCancelRecurringJob() throws Exception {
  long period=2;
  life.start();
  JobHandle jobHandle=scheduler.scheduleRecurring(Group.INDEX_POPULATION,countInvocationsJob,period,MILLISECONDS);
  awaitFirstInvocation();
  jobHandle.cancel(false);
  try {
    jobHandle.waitTermination();
    fail("Task should be terminated");
  }
 catch (  CancellationException ignored) {
  }
  int recorded=invocations.get();
  sleep(period * 100);
  assertThat(invocations.get(),both(greaterThanOrEqualTo(recorded)).and(lessThanOrEqualTo(recorded + 1)));
}
