@Test public void shouldStoreAndRestoreIds() throws Exception {
  StoreChannel channel=getStoreChannel();
  int batchSize=10;
  FreeIdKeeper keeper=getFreeIdKeeperAggressive(channel,batchSize);
  Set<Long> freeIds=new HashSet<>();
  for (long i=0; i < batchSize; i++) {
    keeper.freeId(i);
    freeIds.add(i);
  }
  int extraIds=3;
  for (long i=batchSize; i < batchSize + extraIds; i++) {
    keeper.freeId(i);
    freeIds.add(i);
  }
  keeper.close();
  channel.close();
  channel=fs.get().open(new File("id.file"),OpenMode.READ_WRITE);
  keeper=getFreeIdKeeperAggressive(channel,batchSize);
  assertEquals(batchSize + extraIds,keeper.getCount());
  assertEquals(freeIds.size(),keeper.getCount());
  for (int i=batchSize + extraIds - 1; i >= 0; i--) {
    long id=keeper.getId();
    assertTrue(freeIds.contains(id));
  }
}
