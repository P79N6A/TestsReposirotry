@Test void testHandleExceptionOnNext(){
  assertThrows(IllegalStateException.class,() -> Iterables.count(new ExceptionHandlingIterable(() -> new Iterator(){
    @Override public boolean hasNext(){
      return true;
    }
    @Override public Object next(){
      throw new RuntimeException("exception on next");
    }
    @Override public void remove(){
    }
  }
){
    @Override protected Object exceptionOnNext(    Throwable t){
      rethrow(new IllegalStateException());
      return super.exceptionOnNext(t);
    }
  }
));
}
