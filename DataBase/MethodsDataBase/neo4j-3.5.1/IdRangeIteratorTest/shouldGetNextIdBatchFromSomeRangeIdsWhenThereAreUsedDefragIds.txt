@Test public void shouldGetNextIdBatchFromSomeRangeIdsWhenThereAreUsedDefragIds(){
  IdRangeIterator iterator=new IdRange(new long[]{0,1,2},3,10).iterator();
  iterator.nextId();
  iterator.nextId();
  iterator.nextId();
  IdRangeIterator subRange=iterator.nextIdBatch(3).iterator();
  assertEquals(6,iterator.nextId());
  assertEquals(3,subRange.nextId());
  assertEquals(4,subRange.nextId());
  assertEquals(5,subRange.nextId());
  assertEquals(VALUE_REPRESENTING_NULL,subRange.nextId());
  subRange=iterator.nextIdBatch(3).iterator();
  assertEquals(10,iterator.nextId());
  assertEquals(7,subRange.nextId());
  assertEquals(8,subRange.nextId());
  assertEquals(9,subRange.nextId());
  assertEquals(VALUE_REPRESENTING_NULL,subRange.nextId());
}
