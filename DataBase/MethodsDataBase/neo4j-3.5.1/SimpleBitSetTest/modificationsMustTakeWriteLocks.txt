@Test public void modificationsMustTakeWriteLocks(){
  SimpleBitSet set=new SimpleBitSet(16);
  long stamp=set.tryOptimisticRead();
  set.put(8);
  assertFalse(set.validate(stamp));
  stamp=set.tryOptimisticRead();
  set.put(8);
  assertFalse(set.validate(stamp));
  stamp=set.tryOptimisticRead();
  SimpleBitSet other=new SimpleBitSet(16);
  other.put(3);
  set.put(other);
  assertFalse(set.validate(stamp));
  stamp=set.tryOptimisticRead();
  set.remove(3);
  assertFalse(set.validate(stamp));
  stamp=set.tryOptimisticRead();
  set.remove(3);
  assertFalse(set.validate(stamp));
  stamp=set.tryOptimisticRead();
  other.put(8);
  set.remove(other);
  assertFalse(set.validate(stamp));
  stamp=set.tryOptimisticRead();
  other.put(8);
  set.remove(other);
  assertFalse(set.validate(stamp));
}
