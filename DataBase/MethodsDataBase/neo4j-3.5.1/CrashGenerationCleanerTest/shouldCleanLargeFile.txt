@Test public void shouldCleanLargeFile() throws Exception {
  int numberOfPages=randomRule.intBetween(1_000,10_000);
  int corruptionPercent=randomRule.nextInt(90);
  MutableInt totalNumberOfCorruptions=new MutableInt(0);
  Page[] pages=new Page[numberOfPages];
  for (int i=0; i < numberOfPages; i++) {
    Page page=randomPage(corruptionPercent,totalNumberOfCorruptions);
    pages[i]=page;
  }
  initializeFile(pagedFile,pages);
  SimpleCleanupMonitor monitor=new SimpleCleanupMonitor();
  crashGenerationCleaner(pagedFile,0,numberOfPages,monitor).clean(executor);
  assertPagesVisited(monitor,numberOfPages);
  assertCleanedCrashPointers(monitor,totalNumberOfCorruptions.getValue());
}
