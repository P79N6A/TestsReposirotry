@Test public void upgradeShouldGiveProgressMonitorProgressMessages() throws Exception {
  PageCache pageCache=pageCacheRule.getPageCache(fileSystem);
  UpgradableDatabase upgradableDatabase=getUpgradableDatabase(pageCache);
  AssertableLogProvider logProvider=new AssertableLogProvider();
  newUpgrader(upgradableDatabase,pageCache,allowMigrateConfig,new VisibleMigrationProgressMonitor(logProvider.getLog("test"))).migrateIfNeeded(databaseLayout);
  logProvider.assertContainsLogCallContaining("Store files");
  logProvider.assertContainsLogCallContaining("Indexes");
  logProvider.assertContainsLogCallContaining("Counts store");
  logProvider.assertContainsLogCallContaining("Successfully finished");
}
